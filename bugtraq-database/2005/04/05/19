
Date: Tue, 5 Apr 2005 16:43:10 +0200
From: OpenPKG <openpkg@...npkg.org>
To: bugtraq@...urityfocus.com
Subject: [OpenPKG-SA-2005.005] OpenPKG Security Advisory (imapd)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

________________________________________________________________________

OpenPKG Security Advisory                            The OpenPKG Project
http://www.openpkg.org/security.html              http://www.openpkg.org
openpkg-security@...npkg.org                         openpkg@...npkg.org
OpenPKG-SA-2005.005                                          05-Apr-2005
________________________________________________________________________

Package:             imapd
Vulnerability:       arbitrary code execution
OpenPKG Specific:    no

Affected Releases:   Affected Packages:          Corrected Packages:
OpenPKG CURRENT      <= imapd-2.2.10-20050129    >= imapd-2.2.11-20050214
OpenPKG 2.2          <= imapd-2.2.8-2.2.1        >= imapd-2.2.8-2.2.2

Dependent Packages:  none

Description:
  Sean Larsson discovered several vulnerabilities in the Cyrus IMAP
  Server [0] that could allow a remote attacker to execute machine code
  in the context of the server process.

  The Cyrus Electronic Messaging Project identified the affected
  server logic and released a security advisory [1]. Essentially,
  the application is affected by multiple one byte buffer overflows
  affecting the IMAP annotate extension and cached header handling
  routines. Additionally, stack based overflows affecting the fetchnews,
  backend, and imapd logic exist as well. The Common Vulnerabilities and
  Exposures (CVE) project assigned the identifier CAN-2005-0546 [2] to
  the problem.

  Please check whether you are affected by running "<prefix>/bin/openpkg
  rpm -q imapd". If you have the "imapd" package installed and its
  version is affected (see above), we recommend that you immediately
  upgrade it (see Solution). [3][4]

Solution:
  Select the updated source RPM appropriate for your OpenPKG release
  [5], fetch it from the OpenPKG FTP service [6] or a mirror location,
  verify its integrity [7], build a corresponding binary RPM from it
  [3] and update your OpenPKG installation by applying the binary RPM
  [4]. For the most previous release OpenPKG 2.2, perform the following
  operations to permanently fix the security problem.

  $ ftp ftp.openpkg.org
  ftp> bin
  ftp> cd release/2.2/UPD
  ftp> get imapd-2.2.8-2.2.2.src.rpm
  ftp> bye
  $ <prefix>/bin/openpkg rpm -v --checksig imapd-2.2.8-2.2.2.src.rpm
  $ <prefix>/bin/openpkg rpm --rebuild imapd-2.2.8-2.2.2.src.rpm
  $ su -
  # <prefix>/bin/openpkg rpm -Fvh <prefix>/RPM/PKG/imapd-2.2.8-2.2.2.*.rpm
________________________________________________________________________

References:
  [0] http://asg.web.cmu.edu/cyrus/imapd/
  [1] http://asg.web.cmu.edu/archive/message.php?mailbox=archive.info-cyrus&msg=33723
  [2] http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2005-0546
  [3] http://www.openpkg.org/tutorial.html#regular-source
  [4] http://www.openpkg.org/tutorial.html#regular-binary
  [5] ftp://ftp.openpkg.org/release/2.2/UPD/imapd-2.2.8-2.2.2.src.rpm
  [6] ftp://ftp.openpkg.org/release/2.2/UPD/
  [7] http://www.openpkg.org/security.html#signature
________________________________________________________________________

For security reasons, this advisory was digitally signed with the
OpenPGP public key "OpenPKG <openpkg@...npkg.org>" (ID 63C4CB9F) of the
OpenPKG project which you can retrieve from http://pgp.openpkg.org and
hkp://pgp.openpkg.org. Follow the instructions on http://pgp.openpkg.org/
for details on how to verify the integrity of this advisory.
________________________________________________________________________

-----BEGIN PGP SIGNATURE-----
Comment: OpenPKG <openpkg@...npkg.org>

iD8DBQFCUqPxgHWT4GPEy58RAt+GAKDOatq1M0OtZNO4Jdq0prnrNrbDowCgzbfn
74UcLwGpm7wfbOoSpT7Nu4M=
=z4o5
-----END PGP SIGNATURE-----


