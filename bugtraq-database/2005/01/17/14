
Date: 17 Jan 2005 14:50:32 -0000
From: <chewkeong@...urity.org.sg>
To: bugtraq@...urityfocus.com
Subject: [SIG^2 G-TEC] NodeManager Professional V2.00 Buffer Overflow
    Vulnerability




SIG^2 Vulnerability Research Advisory

NodeManager Professional V2.00 Buffer Overflow Vulnerability

by Tan Chew Keong
Release Date: 17 Jan 2005 


ADVISORY URL
http://www.security.org.sg/vuln/nodemanager200.html


SUMMARY

NodeManager Professional (http://www.h4.dion.ne.jp/~you4707/NodeManagerPro.html) is a network management and monitoring tool. It receives SNMPv1 traps and displays them on screen and writes them to a log file. NodeManager Professional V2.00 has a stack overflow vulnerability that can be exploited by sending a specially crafted SNMPv1 trap.

 
TESTED SYSTEM

NodeManager Professional V2.00 on English Win2K SP4, WinXP SP1, SP2.

 
DETAILS

NodeManager Professional allows the user to use a format string to customize how each received SNMPv1 trap is logged. For example, the default format string for the LinkDown event is

"Snmp Trap LinkDown (EnterPrise=%EPRISE ObjectID=%OID Value=%DATA)"

When a LinkDown-Trap packet is received, the various placeholders (e.g. %OID, %DATA) will be replaced with the received values. When the format string is parsed, each received value is first copied to a 512-byte local stack buffer before it is concatenated to the final string. By sending a LinkDown-Trap packet containing an OCTET-STRING of more than 512 bytes in the Trap variable-bindings field, it is possible to overflow the stack buffer and overwrite the EIP. This happens when the %DATA placeholder is processed.


PATCH

Upgrade to version 2.01, which fixes this vulnerability. 

 
DISCLOSURE TIMELINE

20 Dec 04 - Vulnerability Discovered
21 Dec 04 - Initial Author Notification
22 Dec 04 - Received Author's Reply
07 Jan 05 - Second Author Notification
11 Jan 05 - Second Author Reply
15 Jan 05 - Author Released Fixed Version
17 Jan 05 - Public Release


GREETINGS

All guys at SIG^2 G-TEC Lab
http://www.security.org.sg/webdocs/g-tec.html 

"IT Security...the Gathering. By enthusiasts for enthusiasts."
 


