
Date: Wed, 19 Jan 2005 16:35:34 -0600
From: "Efrain Soto" <esoto@...tarricense.cr>
To: "NGSSoftware Insight Security Research" <nisr@...tgenss.com>,
	<bugtraq@...urityfocus.com>,
	<ntbugtraq@...tserv.ntbugtraq.com>,
	<vulnwatch@...nwatch.org>
Subject: RE: [VulnWatch] RealPlayer Arbitrary File Deletion Vulnerability (#NISR19012005f)


What kind of notice is this, the vulnerability is dated: September 28, 2004

-----Original Message-----
From: NGSSoftware Insight Security Research [mailto:nisr@...tgenss.com]
Sent: Mi√©rcoles, 19 de Enero de 2005 11:00 a.m.
To: bugtraq@...urityfocus.com; ntbugtraq@...tserv.ntbugtraq.com;
vulnwatch@...nwatch.org
Subject: [VulnWatch] RealPlayer Arbitrary File Deletion Vulnerability
(#NISR19012005f)


NGSSoftware Insight Security Research Advisory

Name: RealPlayer Arbitrary File Deletion Vulnerability
Systems Affected: RealPlayer 10.5 (6.0.12.1040) and older
Severity: High
Vendor URL: http://www.real.com/
Author: John Heasman [ john@...software.com ]
Date of Public Advisory: 19th January 2004
Advisory number: #NISR19012005f
Advisory URL: http://www.ngssoftware.com/advisories/real-02full.txt
Reference: http://www.ngssoftware.com/advisories/real-01.txt


Description
***********

A vulnerability has been discovered in RealPlayer which can allow an
attacker to delete arbitrary files from a users system through a specially
crafted webpage with little user interaction.


Details
*******

RealPlayer supports a proprietary package delivery file type, aptly named
Real Metadata Packages. These files contain an HTML style language which
contains information and resource urls for various packages and extensions
to RealPlayer.

One of the supported tags within the RMP file type is the <FILENAME> tag.
This is designed to point to a relative file which is to be downloaded.
If the file which is to be downloaded already exists on the system, it
will delete this file without warning.

It is also possible to insert directory traversal character sequences in
the file name to break out of the download directory, and to point to any
existing file on the system.

Before the the deletion takes place, RealPlayer ensures that the file
extension is among those listed in the formats.ini file located at:

C:\Program Files\Real\RealPlayer\DataCache\Formats\formats.ini

It is possible to bypass this file extension check in the follow manner
due to a lack in the file extension validation process:

<FILENAME>../../../../../windows/system32/notepad.exe?.mp3</FILENAME>


Fix Information
***************

RealNetworks have released an update for the Real Meta Package file
deletion vulnerability which can be downloaded from:

http://service.real.com/help/faq/security/040928_player/EN/

A check for this vulnerability has been added to Typhon III, NGSSoftware's
advanced vulnerability assessment scanner. For more information please
visit the NGSSoftware website at http://www.ngssoftware.com/


About NGSSoftware
*****************

NGSSoftware design, research and develop intelligent, advanced application
security assessment scanners. Based in the United Kingdom, NGSSoftware
have offices in the South of London and the East Coast of Scotland.
NGSSoftware's sister company NGSConsulting, offers best of breed security
consulting services, specialising in application, host and network
security assessments.

http://www.ngssoftware.com/

Telephone +44 208 401 0070
Fax +44 208 401 0076

enquiries@...software.com





