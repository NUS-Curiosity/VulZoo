
Date: Tue, 11 Oct 2005 14:38:36 -0400
From: "iDEFENSE Labs" <labs-no-reply@...fense.com>
To: <bugtraq@...urityfocus.com>, <vulnwatch@...nwatch.org>,
	<full-disclosure@...ts.grok.org.uk>
Subject: iDEFENSE Security Advisory 10.11.05: Microsoft
	Distributed Transaction Controller TIP DoS Vulnerability


Microsoft Distributed Transaction Controller TIP DoS Vulnerability

iDEFENSE Security Advisory 10.11.05
www.idefense.com/application/poi/display?id=320&type=vulnerabilities
October 11, 2005

I. BACKGROUND

The Distributed Transaction Controller provides a method for disparate 
processes to complete atomic transactions. The Transaction Internet 
Protocol (TIP) is one the ways that the DTC service can be accessed.
This service is part of a standard installation on Windows NT 4.0,
Windows 2000, Windows XP and Windows 2003.

II. DESCRIPTION

Remote exploitation of a denial of service vulnerability within various 
versions of Microsoft Corp.'s Windows operating system allows attackers
to cause the msdtc.exe process to crash.

The vulnerability specifically exists because of a flaw in processing 
responses from foreign servers. The DoS can be triggered by sending a 
command sequence that causes the DTC service to connect back to a
hostile server. If the hostile server sends an unexpected protocol
command during the reconnection request, the DTC service will throw an
exception and exit. This attack can be used to kill the DTC service and
prevent other applications from using the service to process
transactions.

The following commands can be sent over TCP port 3372 to force the DTC
service to connect to an arbitrary host and process commands:

  IDENTIFY 3 3 DST_IP:DST_PORT/ANYID -
  PUSH SOMESTRING
  PREPARE
  RECONNECT

III. ANALYSIS

Successful exploitation of this vulnerability will cause applications 
requiring the MSDTC service to fail. One such service is Microsoft SQL 
Server. Any other applications that rely on clustering to be functional 
will also fail. This service should not be exposed to public networks, 
thus mitigating the risk of this vulnerability.

IV. DETECTION

iDEFENSE has confirmed the existence and exploitability of this 
vulnerability in Microsoft Windows 2000 SP4. All versions of Microsoft 
Windows with the vulnerable service running are suspected vulnerable.

V. WORKAROUND

iDEFENSE is currently unaware of any workarounds for this issue.

VI. VENDOR RESPONSE

The vendor security advisory and appropriate patches are available at:

   http://www.microsoft.com/technet/security/Bulletin/MS05-051.mspx

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CAN-2005-1979 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

03/23/2005 Initial vendor notification
03/23/2005 Initial vendor response
10/11/2005 Coordinated public disclosure

IX. CREDIT

The discoverer of this vulnerability wishes to remain anonymous.

Get paid for vulnerability research
http://www.idefense.com/poi/teams/vcp.jsp

Free tools, research and upcoming events
http://labs.idefense.com

X. LEGAL NOTICES

Copyright (c) 2005 iDEFENSE, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDEFENSE. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically, please
email customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/


