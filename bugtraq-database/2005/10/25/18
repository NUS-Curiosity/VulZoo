
Date: Tue, 25 Oct 2005 17:02:27 -0400 (EDT)
From: Paul Laudanski <zx@...tlecops.com>
To: K-Gen Gen <alphakgen@...il.com>
Cc: full-disclosure@...ts.grok.org.uk, bugtraq@...urityfocus.com,
	webappsec@...urityfocus.com
Subject: phpBB 2.0.17 (and other BB systems as well)
	Cookie disclosure exploit.


On Sat, 22 Oct 2005, K-Gen Gen wrote:

> phpBB 2.0.17 (and other BB systems as well) Cookie disclosure exploit.
> 
> I sent the report to phpBB and they said that a patch will be available
> withing a few days and It will be integrated into 2.0.18 .
> 
> Note: This works like XSS, and requires the victim to use IE (Affects all
> versions of IE).

I've confirmed this in various webapp platforms and made contact with 
their vendors.  This isn't limited to just avatar remote uploads, but for 
attachments, and anything else that is permitted to render on the target 
example.com site.

One suggestion to a fix is deny the ability for any off site images to be 
rendered at all.  But then that means handling on site file input 
validation checking to see if an image is actually just that.

Off site file checking can still be spoofed.  For instance, the target 
example.com site may check a remote image and confirms it is just that.  
The remote server may then send altogether different content to the 
example.com member.

Safest thing at least right now is to IMVHO disable remote image 
rendering, and validate file input on the target on site example.com.

Anyone have other ideas on this?  I've already implemented some code to 
validate file input and its working.  But is this the right approach?

-- 
Paul Laudanski, Microsoft MVP Windows-Security
http://castlecops.com - http://wiki.castlecops.com

CastleCops Deutsch - German Internet Security coming online soon!

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/


