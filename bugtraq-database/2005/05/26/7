
Date: Thu, 26 May 2005 06:49:46 +0200 (CEST)
From: joey@...odrom.org (Martin Schulze)
To: bugtraq@...urityfocus.com
Subject: [SECURITY] [DSA 728-2] New qpopper packages fix arbitrary file overwriting


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- --------------------------------------------------------------------------
Debian Security Advisory DSA 728-2                     security@...ian.org
http://www.debian.org/security/                             Martin Schulze
May 26th, 2005                          http://www.debian.org/security/faq
- --------------------------------------------------------------------------

Package        : qpopper
Vulnerability  : missing privilege release
Problem-Type   : local
Debian-specific: no
CVE IDs        : CAN-2005-1151 CAN-2005-1152

This advisory does only covers updated packages for Debian 3.0 alias woody.

Two bugs have been discovered in qpopper, an enhanced Post Office
Protocol (POP3) server.  The Common Vulnerability and Exposures
project identifies the following problems:

CAN-2005-1151

    Jens Steube discovered that while processing local files owned or
    provided by a normal user privileges weren't dropped, which could
    lead to the overwriting or creation of arbitrary files as root.

CAN-2005-1152

    The upstream developers noticed that qpopper could be tricked to
    creating group- or world-writable files.

For the stable distribution (woody) these problems have been fixed in
version 4.0.4-2.woody.5.

For the testing distribution (sarge) these problems have been fixed in
version 4.0.5-4sarge1.

For the unstable distribution (sid) these problems will be fixed in
version 4.0.5-4sarge1.

We recommend that you upgrade your qpopper package.


Upgrade Instructions
- --------------------

wget url
        will fetch the file for you
dpkg -i file.deb
        will install the referenced file.

If you are using the apt-get package manager, use the line for
sources.list as given below:

apt-get update
        will update the internal database
apt-get upgrade
        will install corrected packages

You may use an automated update by adding the resources from the
footer to the proper configuration.


Debian GNU/Linux 3.0 alias woody
- --------------------------------

  Source archives:

    http://security.debian.org/pool/updates/main/q/qpopper/qpopper_4.0.4-2.woody.5.dsc
      Size/MD5 checksum:      648 def44918c6c690d26eccd5c558d1016b
    http://security.debian.org/pool/updates/main/q/qpopper/qpopper_4.0.4-2.woody.5.diff.gz
      Size/MD5 checksum:    18859 90a965ab2af550047250912d22a30aeb
    http://security.debian.org/pool/updates/main/q/qpopper/qpopper_4.0.4.orig.tar.gz
      Size/MD5 checksum:  2261992 77f0968cd10b0d5236114838d9f507e5

  Alpha architecture:

    http://security.debian.org/pool/updates/main/q/qpopper/qpopper_4.0.4-2.woody.5_alpha.deb
      Size/MD5 checksum:   459080 aff606da2562a6a412f653dad57c7907
    http://security.debian.org/pool/updates/main/q/qpopper/qpopper-drac_4.0.4-2.woody.5_alpha.deb
      Size/MD5 checksum:   459870 89cbc329cc9164799d2abbe6cd3fef36

  ARM architecture:

    http://security.debian.org/pool/updates/main/q/qpopper/qpopper_4.0.4-2.woody.5_arm.deb
      Size/MD5 checksum:   433692 59f04091f5dd07e9c0b996900730fc39
    http://security.debian.org/pool/updates/main/q/qpopper/qpopper-drac_4.0.4-2.woody.5_arm.deb
      Size/MD5 checksum:   434478 b528747b74b7cc0263139441e257cd75

  Intel IA-32 architecture:

    http://security.debian.org/pool/updates/main/q/qpopper/qpopper_4.0.4-2.woody.5_i386.deb
      Size/MD5 checksum:   423860 c9cbeff37020c746b50f2112d8a43cea
    http://security.debian.org/pool/updates/main/q/qpopper/qpopper-drac_4.0.4-2.woody.5_i386.deb
      Size/MD5 checksum:   424736 32043d5ed1e3a961898695490fb70d19

  Intel IA-64 architecture:

    http://security.debian.org/pool/updates/main/q/qpopper/qpopper_4.0.4-2.woody.5_ia64.deb
      Size/MD5 checksum:   485276 78d3d2b55b6845e489168aedc3596ed3
    http://security.debian.org/pool/updates/main/q/qpopper/qpopper-drac_4.0.4-2.woody.5_ia64.deb
      Size/MD5 checksum:   486244 77903abd88b80ef82b166787155bbe61

  HP Precision architecture:

    http://security.debian.org/pool/updates/main/q/qpopper/qpopper_4.0.4-2.woody.5_hppa.deb
      Size/MD5 checksum:   443344 167bb4e49490aaffced45df7b20beaea
    http://security.debian.org/pool/updates/main/q/qpopper/qpopper-drac_4.0.4-2.woody.5_hppa.deb
      Size/MD5 checksum:   444426 9f6a5ca936d98ac4ce3dbfc0b7287057

  Motorola 680x0 architecture:

    http://security.debian.org/pool/updates/main/q/qpopper/qpopper_4.0.4-2.woody.5_m68k.deb
      Size/MD5 checksum:   416806 f916161eb53d93ea5e228b8683e581f3
    http://security.debian.org/pool/updates/main/q/qpopper/qpopper-drac_4.0.4-2.woody.5_m68k.deb
      Size/MD5 checksum:   417642 d02b70e083c9ce83728dcf1e3db34cd2

  Big endian MIPS architecture:

    http://security.debian.org/pool/updates/main/q/qpopper/qpopper_4.0.4-2.woody.5_mips.deb
      Size/MD5 checksum:   439492 e74351f337454a3e3761e99535aea14e
    http://security.debian.org/pool/updates/main/q/qpopper/qpopper-drac_4.0.4-2.woody.5_mips.deb
      Size/MD5 checksum:   440410 0de3c0147af2b485ce2fe884db51299d

  Little endian MIPS architecture:

    http://security.debian.org/pool/updates/main/q/qpopper/qpopper_4.0.4-2.woody.5_mipsel.deb
      Size/MD5 checksum:   439928 3c8c5b6c2b3f19e579b100d8b9e0b035
    http://security.debian.org/pool/updates/main/q/qpopper/qpopper-drac_4.0.4-2.woody.5_mipsel.deb
      Size/MD5 checksum:   441100 462d53380308b5d3bb55eaf47283a79a

  PowerPC architecture:

    http://security.debian.org/pool/updates/main/q/qpopper/qpopper_4.0.4-2.woody.5_powerpc.deb
      Size/MD5 checksum:   433578 f34f8998261fa494058c9258567475d0
    http://security.debian.org/pool/updates/main/q/qpopper/qpopper-drac_4.0.4-2.woody.5_powerpc.deb
      Size/MD5 checksum:   434142 f2c5178a623aa55d2c15b1790cf4110f

  IBM S/390 architecture:

    http://security.debian.org/pool/updates/main/q/qpopper/qpopper_4.0.4-2.woody.5_s390.deb
      Size/MD5 checksum:   429138 dd824ff9c73c9c03b918c983a76c0e21
    http://security.debian.org/pool/updates/main/q/qpopper/qpopper-drac_4.0.4-2.woody.5_s390.deb
      Size/MD5 checksum:   430144 eba66e5007e2393992120b10f12a4a4d

  Sun Sparc architecture:

    http://security.debian.org/pool/updates/main/q/qpopper/qpopper_4.0.4-2.woody.5_sparc.deb
      Size/MD5 checksum:   434964 da69bd01cb5ff85ace75dfe0ea7ad421
    http://security.debian.org/pool/updates/main/q/qpopper/qpopper-drac_4.0.4-2.woody.5_sparc.deb
      Size/MD5 checksum:   435700 c09d3ecb11fb0971d69f36054af333c8



  These files will probably be moved into the stable distribution on
  its next update.

- ---------------------------------------------------------------------------------
For apt-get: deb http://security.debian.org/ stable/updates main
For dpkg-ftp: ftp://security.debian.org/debian-security dists/stable/updates/main
Mailing list: debian-security-announce@...ts.debian.org
Package info: `apt-cache show <pkg>' and http://packages.debian.org/<pkg>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.1 (GNU/Linux)

iD8DBQFClVVqW5ql+IAeqTIRAvWyAJ9k05aDeiEn/c7OUCBBzpCAjXQ1NgCgp40h
TFWgqO1vpDd4xzwmPR3YL8Q=
=xWVy
-----END PGP SIGNATURE-----



