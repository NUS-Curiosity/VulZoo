
Date: Wed, 27 Jul 2005 01:20:16 -0300
From: Francisco Amato <famato@...obyte.com.ar>
To: bugtraq@...urityfocus.com
Cc: full-disclosure@...ts.grok.org.uk
Subject: [ISR] - Novell GroupWise Client Remote Buffer
	Overflow


||
|| [ISR]
|| Infobyte Security Research
|| www.infobyte.com.ar
|| 07.27.2005
|| 


.:: SUMMARY 

Novell GroupWise Client Remote Buffer Overflow 

Version: GroupWise 6.5.3, It is suspected that all previous versions of 
Groupwise Client
are vulnerable. 

.:: BACKGROUND 

GroupWise Client is Novell's premier Intranet/Internet GroupWare solution 
for platform Windows. 

More info:    http://www.novell.com 

.:: DESCRIPTION 

This issue is due to a failure of the application to securely parse the file
that contain the labels of different views. 

To reproduce this, we have to modify the ofview file that corresponds to the
language of the postoffices. In spanish lenguage it is GWVW02ES.INI
([POSTOFFICES]\ofviews\win\GWVW02ES.INI) 

For example, we take the section [Group Task] and set the label
ES02TKS.VEW with the value ("A" x 174). 

Then, when we open the application client and make the authentication, after
that occur the buffer overflow. 

Information of Registers:
EAX 00000001
ECX 7FFDE000
EDX 00E80608
EBX 41414141
ESP 0012F74C
EBP 0012F7B0
ESI 00E80000
EDI 41414139
EIP 78495BA9 ntdll.78495BA9
C 0 ES 0023 32bit 0(FFFFFFFF)
P 1 CS 001B 32bit 0(FFFFFFFF)
A 0 SS 0023 32bit 0(FFFFFFFF)
Z 1 DS 0023 32bit 0(FFFFFFFF)
S 0 FS 0038 32bit 7FFDE000(FFF)
T 0 GS 0000 NULL
D 0
O 0 LastErr ERROR_SUCCESS (00000000)
EFL 00010246 (NO,NB,E,BE,NS,PE,GE,LE)
ST0 empty - NAN FFFF FFF8FCF8 FFF8FCF8
ST1 empty - ??? FFFF 00000000 00000000
ST2 empty - ??? FFFF 00FE00F7 00FB00F7
ST3 empty - ??? FFFF 00FE00F7 00FB00F7
ST4 empty - NAN FFFF FFF8FCF8 FFF8FCF8
ST5 empty - ??? FFFF 00FF00F8 00FC00F8
ST6 empty - ??? FFFF 00000000 00000000
ST7 empty 256.00000000000000000
3 2 1 0 E S P U O Z D I
FST 0000 Cond 0 0 0 0 Err 0 0 0 0 0 0 0 0 (GT)
FCW 027F Prec NEAR,53 Mask 1 1 1 1 1 1 

Asm code line:
78495BA9 0FB707 MOVZX EAX,WORD PTR DS:[EDI] 

If a attacker have access to the postoffices and put a evil GWVW02??.INI, He
could have the posibilite of compromise every user that use the Novell
GroupWise Windows Application. 

.:: VENDOR RESPONSE 

Vendor advisory:
   http://support.novell.com/cgi-bin/search/searchtid.cgi?/10098314.htm 

Vendor patch:
   http://support.novell.com/cgi-bin/search/searchtid.cgi?/2971927.htm

.:: DISCLOSURE TIMELINE 

07/05/2005  Initial vendor notification
07/06/2005  Initial vendor response
07/27/2005  Coordinated public disclosure 

.:: CREDIT 

Francisco Amato is credited with discovering this vulnerability.
famato][at][infobyte][dot][com][dot][ar 

.:: LEGAL NOTICES 

Copyright (c) 2005 by [ISR] Infobyte Security Research.
Permission to redistribute this alert electronically is granted as long as 
it is not
edited in any way unless authorized by Infobyte Security Research Response.
Reprinting the whole or part of this alert in any medium other than 
electronically
requires permission from infobyte com ar 

Disclaimer
The information in the advisory is believed to be accurate at the time of 
publishing
based on currently available information. Use of the information constitutes 
acceptance
for use in an AS IS condition. There are no warranties with regard to this 
information.
Neither the author nor the publisher accepts any liability for any direct, 
indirect, or
consequential loss or damage arising from use of, or reliance on, this 
information. 
_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/


