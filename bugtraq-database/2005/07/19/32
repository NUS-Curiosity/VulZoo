
Date: 19 Jul 2005 12:25:39 -0000
From: ak@...-database-security.com
To: bugtraq@...urityfocus.com
Subject: Oracle Security Advisory: Run any OS Command via unauthorized
 Oracle Forms


Dear Bugtraq Reader

3 months ago (15-april-2005) I informed the Oracle Security Team (secalert_us@...cle.com) that I will publish bug details if the bugs are not fixed with the next critical patch update (CPU July 2005). I know that Oracle products are complex and a good patch quality need some time. That's why I offered Oracle additional time if 3 months are not sufficient for fixing the bugs. Oracle never asked for more time.

Oracle's behaviour not fixing critical security bugs for a long time (over 650 days) is not acceptable for their customers. Oracle put their customers in danger. At least one critical vulnerability can be abused from any attacker via internet.

I decided to publish these vulnerabilities because it is possible to mitigate the risk of these vulnerabilities by using the workarounds provided in the advisories.


Kind Regards

 Alexander Kornbrust

 www.red-database-security.com

#################################################

Red-Database-Security GmbH  - Oracle Security Advisory

Run any OS Command via unauthorized Oracle Forms


 Name                Run any OS Command via unauthorized Oracle Forms
 Systems Affected    Oracle (Web) Forms 4.5, 5.0, 6.0, 6i, 9i, 10g
 Severity            High Risk  
 Category            OS command execution
 Vendor URL          http://www.oracle.com 
 Author              Alexander Kornbrust (ak at red-database-security.com) 
 Date                19 July 2005 (V 1.00) 
 Advisory            AKSEC2003-013
 Inital bug report   664 days ago
 Advisory-URL       
http://www.red-database-security.com/advisory/oracle_forms_run_any_os_command.ht
ml


Details
#######
Oracle Forms Services, a component of the Oracle Application Server, is Oracle's
long-established technology to design and build enterprise applications. Oracle
itself is using Oracle Forms for the E-Business Suite. Many large customers are
using Oracle Forms for their enterprise applications.

Oracle Forms Services starts forms executables (*.fmx) from any directory and
any user on the application server. These forms are executed as user Oracle or
System (Windows). An attacker which is able to upload a specially crafted forms
executable to the application server is able to run any OS command and can
overtake the application server. The upload could be done via Webdav (Part of
the Oracle Application Server), SMB, Webutil, SAMBA, NFS, FTP, ...

By using the form or module parameter with an absolute path it is possible to
execute forms executables from ANY directory and ANY user.


Testcase
########
1. Create or modify a simple forms module and add the following command to the
"WHEN_NEW_FORM_INSTANCE"-Trigger Host('ls > forms_is_unsecure.txt' , NO_SCREEN);

2. Generate the forms executable (e.g. hacker.fmx) for the destination platform
(e.g. Linux, Solaris, Windows, ...)

3. Copy the forms executable hacker.fmx to a directory on the Oracle Application
Server (e.g. via SMB, file upload, Webdav, Samba, NFS, Webutil, FTP, ...)

4. Run the form "hacker.fmx" as user Oracle and specify an absolute path for the
forms executable
http://myserver.com:7779/forms90/f90servlet?form=/public/johndoe/hacker.fmx
or
http://myserver.com:7779/forms90/f90servlet?module=/tmp/hacker.fmx

5. The host command is executed as user Oracle (Unix) or user SYTEM (Windows).



Workarounds
###########
Available at http://www.red-database-security.com/advisory/oracle_forms_run_any_os_command.html


Patch Information
#################
This bug is NOT FIXED with Critical Patch Update July 2005 (CPU July 2005). It
seems that Oracle is NOT INTERESTED to fix this issue and provide patches for
this issue.
They recommend to migrate to Oracle Forms 10g because 9i and 10g are binary
compatible.



History
#######
24-sep-2003 Oracle secalert was informed

25-sep-2003 Bug confirmed

15-apr-2005 Red-Database-Security informed Oracle secalert that this
vulnerability will publish after CPU July 2005 Red-Database-Security offered 
Oracle more time if it is not possible to provide a fix ==> NO FEEDBACK.

18-apr-2005 Oracle Forms Product Management contacted.

20-apr-2005 Email from Product Management that customers should migrate to Forms
10g. No patches for Forms 6i or 9i.

12-jul-2005 Oracle published CPU July 2005 without fixing this issue

19-jul-2005 Red-Database-Security published this advisory




ï¿½ 2005 by Red-Database-Security GmbH - last update 19-july-2005



