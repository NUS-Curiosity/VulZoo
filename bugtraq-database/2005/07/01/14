
Date: Fri, 01 Jul 2005 03:42:53 +0200
From: Michael Stone <mstone@...cker.debian.org>
To: bugtraq@...urityfocus.com
Subject: [SECURITY] [DSA 735-1] New sudo packages fix pathname validation race


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- ------------------------------------------------------------------------
Debian Security Advisory 735-1                       security@...ian.org
http://www.debian.org/security/                            Michael Stone
July 01, 2005                         http://www.debian.org/security/faq
- ------------------------------------------------------------------------

Package        : sudo
Vulnerability  : pathname validation race
Problem type   : local
Debian-specific: no
CVE Id(s)      : CAN-2005-1993
Debian Bug     : 315115

A local user who has been granted permission to run commands via sudo
could run arbitrary commands as a privileged user due to a flaw in
sudo's pathname validation. This bug only affects configurations which
have restricted user configurations prior to an ALL directive in the
configuration file. A workaround is to move any ALL directives to the
beginning of the sudoers file; see the advisory at
http://www.sudo.ws/sudo/alerts/path_race.html for more information.

For the old stable Debian distribution (woody), this problem has been
fixed in version 1.6.6-1.3woody1. For the current stable distribution
(sarge), this problem has been fixed in version 1.6.8p7-1.1sarge1. Note
that packages are not yet ready for certain architectures; these will be
released as they become available.

We recommend that you upgrade your sudo package.

Upgrade instructions
- --------------------

wget url
        will fetch the file for you
dpkg -i file.deb
        will install the referenced file.

If you are using the apt-get package manager, use the line for
sources.list as given below:

apt-get update
        will update the internal database
apt-get upgrade
        will install corrected packages

You may use an automated update by adding the resources from the
footer to the proper configuration.


Debian 3.0 (woody)
- ------------------

  woody was released for alpha, arm, hppa, i386, ia64, m68k, mips, mipsel, powerpc, s390 and sparc.

  Source archives:

    http://security.debian.org/pool/updates/main/s/sudo/sudo_1.6.6.orig.tar.gz
      Size/MD5 checksum:   333074 4da4bf6cf31634cc7a17ec3b69fdc333
    http://security.debian.org/pool/updates/main/s/sudo/sudo_1.6.6-1.3woody1.dsc
      Size/MD5 checksum:      663 9d642dfebcaa64925b0dc8222fdef8fb
    http://security.debian.org/pool/updates/main/s/sudo/sudo_1.6.6-1.3woody1.diff.gz
      Size/MD5 checksum:    32343 4e6a3617874f1a947073adbe8f5a8bd7

  alpha architecture (DEC Alpha)

    http://security.debian.org/pool/updates/main/s/sudo/sudo_1.6.6-1.3woody1_alpha.deb
      Size/MD5 checksum:   150074 adfd1c1e51dbe1dc66d5929c38035753

  hppa architecture (HP PA RISC)

    http://security.debian.org/pool/updates/main/s/sudo/sudo_1.6.6-1.3woody1_hppa.deb
      Size/MD5 checksum:   145954 62d30eb38b9605b3aeee404d7df6ad67

  i386 architecture (Intel ia32)

    http://security.debian.org/pool/updates/main/s/sudo/sudo_1.6.6-1.3woody1_i386.deb
      Size/MD5 checksum:   133990 cbeaf7f9f666dcd118b3e6a5aff980c5

  m68k architecture (Motorola Mc680x0)

    http://security.debian.org/pool/updates/main/s/sudo/sudo_1.6.6-1.3woody1_m68k.deb
      Size/MD5 checksum:   131568 0c43529165c66b41b1afee8a5fcab94c

  mips architecture (MIPS (Big Endian))

    http://security.debian.org/pool/updates/main/s/sudo/sudo_1.6.6-1.3woody1_mips.deb
      Size/MD5 checksum:   142726 fdd7c5c36fc97e6d43bd38c389eb6661

  mipsel architecture (MIPS (Little Endian))

    http://security.debian.org/pool/updates/main/s/sudo/sudo_1.6.6-1.3woody1_mipsel.deb
      Size/MD5 checksum:   142672 b569048607197ae6d1a6bda1b8678b28

  powerpc architecture (PowerPC)

    http://security.debian.org/pool/updates/main/s/sudo/sudo_1.6.6-1.3woody1_powerpc.deb
      Size/MD5 checksum:   139220 89f8dba75e485aa186892b7ff8cae0a9

  s390 architecture (IBM S/390)

    http://security.debian.org/pool/updates/main/s/sudo/sudo_1.6.6-1.3woody1_s390.deb
      Size/MD5 checksum:   138806 4ce4d39f104be67c037df435b2fbfcfa

  sparc architecture (Sun SPARC/UltraSPARC)

    http://security.debian.org/pool/updates/main/s/sudo/sudo_1.6.6-1.3woody1_sparc.deb
      Size/MD5 checksum:   141510 d09ac30ed8b11148616094bc11f6ff89

Debian 3.1 (sarge)
- ------------------

  sarge was released for alpha, arm, hppa, i386, ia64, m68k, mips, mipsel, powerpc, s390 and sparc.

  Source archives:

    http://security.debian.org/pool/updates/main/s/sudo/sudo_1.6.8p7-1.1sarge1.dsc
      Size/MD5 checksum:      647 727b653bb76115569d23a447b0886526
    http://security.debian.org/pool/updates/main/s/sudo/sudo_1.6.8p7-1.1sarge1.diff.gz
      Size/MD5 checksum:    22106 534fb1a1ed826d19585a210830b1b3e8
    http://security.debian.org/pool/updates/main/s/sudo/sudo_1.6.8p7.orig.tar.gz
      Size/MD5 checksum:   585302 ad65d24f20c736597360d242515e412c

  alpha architecture (DEC Alpha)

    http://security.debian.org/pool/updates/main/s/sudo/sudo_1.6.8p7-1.1sarge1_alpha.deb
      Size/MD5 checksum:   176226 9e39a081bcfb34bcc51b26d9a741cdcb

  hppa architecture (HP PA RISC)

    http://security.debian.org/pool/updates/main/s/sudo/sudo_1.6.8p7-1.1sarge1_hppa.deb
      Size/MD5 checksum:   170318 3f2cdd1fa837bfe741e2a00c2c7998ff

  i386 architecture (Intel ia32)

    http://security.debian.org/pool/updates/main/s/sudo/sudo_1.6.8p7-1.1sarge1_i386.deb
      Size/MD5 checksum:   159542 31bf940fb0e3efcfc3b6dd7a8d6183b7

  ia64 architecture (Intel ia64)

    http://security.debian.org/pool/updates/main/s/sudo/sudo_1.6.8p7-1.1sarge1_ia64.deb
      Size/MD5 checksum:   194802 2f256e875cd8af6341e9d9e70f6d594e

  m68k architecture (Motorola Mc680x0)

    http://security.debian.org/pool/updates/main/s/sudo/sudo_1.6.8p7-1.1sarge1_m68k.deb
      Size/MD5 checksum:   154864 c7bf16b5de02b5dc53de79b050d4b610

  mips architecture (MIPS (Big Endian))

    http://security.debian.org/pool/updates/main/s/sudo/sudo_1.6.8p7-1.1sarge1_mips.deb
      Size/MD5 checksum:   168270 950106a439c05ba869fab23e5173c0d6

  mipsel architecture (MIPS (Little Endian))

    http://security.debian.org/pool/updates/main/s/sudo/sudo_1.6.8p7-1.1sarge1_mipsel.deb
      Size/MD5 checksum:   168074 142d0e2675335cc3db32017057ae4fab

  powerpc architecture (PowerPC)

    http://security.debian.org/pool/updates/main/s/sudo/sudo_1.6.8p7-1.1sarge1_powerpc.deb
      Size/MD5 checksum:   164932 eb71691a92c039e51c8af2838d1b66cf

  s390 architecture (IBM S/390)

    http://security.debian.org/pool/updates/main/s/sudo/sudo_1.6.8p7-1.1sarge1_s390.deb
      Size/MD5 checksum:   167808 5a3b22d227258306b36e9e925e4a36b0

  sparc architecture (Sun SPARC/UltraSPARC)

    http://security.debian.org/pool/updates/main/s/sudo/sudo_1.6.8p7-1.1sarge1_sparc.deb
      Size/MD5 checksum:   162398 759a6f3d0facda5ca05037f40a4c0c64

- -------------------------------------------------------------------------------
For apt-get: deb http://security.debian.org/ stable/updates main
For dpkg-ftp: ftp://security.debian.org/debian-security dists/stable/updates/main
Mailing list: debian-security-announce@...ts.debian.org
Package info: `apt-cache show <pkg>' and http://packages.debian.org/<pkg>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.1 (GNU/Linux)

iQCVAwUBQsSdaA0hVr09l8FJAQJeIwP/RsNnnkEEwvGv8JTvXBg/UfLQhrIxog7b
T3pnGKwM1RajhQSsSipmZG43JkTRsKt4N3PtWLNup8+pIi03u8trMMKYcbQEU3ol
XJ5B/+QdOEL/iuUfkpREnrTxfomTN8cbWDoW+yf67AEFGbB6bsInKCO/IPFvIyLE
q/Jnf4yX2Wg=
=Npjy
-----END PGP SIGNATURE-----



