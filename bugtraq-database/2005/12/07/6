
Date: Wed, 7 Dec 2005 07:09:21 -0800 (PST)
From: alireza hassani <trueend5@...oo.com>
To: bugtraq@...urityfocus.com
Subject: [KAPDA::#15] - ThWboard multiple vulnerabilities


KAPDA New advisory

Vendor: http://www.thwboard.de
Vulnerable Version: 3 beta 2.8
Bug: HTML Injection , XSS , SQL Injection
Exploitation: Remote with browser

Description:
--------------------
ThWboard is a freely available German PHP-based
message board program that uses a MySQL database.

Vulnerability:
--------------------
HTML Injection: The software does not properly filter
HTML tags in "Wohnort" & "Beruf" fields in
'editprofile.php' that may allow a remote user to
inject HTML/javascript codes. The hostile code may be
rendered in the web browser of the victim user who
will visit the board (persistent).
 
XSS: XSS Vulnerability in 'v_profile.php' & 'misc.php'
that may allow a remote user to launch cross-site
scripting attacks.
This issue could permit a remote attacker to create a
malicious URI link that includes hostile HTML and
script code. If this link were to be followed, the
hostile code may be rendered in the web browser of the
victim user. This would occur in the security context
of the affected Web site.

Demonstration XSS URL :
-----------------------------
http://example.com/thwb/v_profile.php?user[userid]='%3Cscript%3Ealert('xss')%3C/script%3E
http://example.com/thwb/misc.php?action=getlastpost&userid='%3Cscript%3Ealert(document.cookie)%3C/script%3E

SQL Injection: Several scripts do not properly
validate user-supplied input that may allow a remote
user to launch Sql injection
attacks.('calendar.php'&'v_profile.php'&'misc.php')A
remote user can create specially crafted parameter
values that will execute SQL commands on the
underlying database.

Demonstration SQL URL :
-----------------------------
http://example.com/thwb/calendar.php?month=12&year='[SQL]
http://example.com/thwb/v_profile.php?user[userid]='[SQL]
http://example.com/thwb/misc.php?action=getlastpost&userid='[SQL]

Solution:
--------------------
Upgrade to new version 3 beta 2.84
(http://www.thwboard.de/downloads.php)

Original Advisories:
--------------------

IN Farsi: http://irannetjob.com/content/view/170/28/
http://kapda.ir/advisory-149.html

Credit :
--------------------
Discovered & released by trueend5 (trueend5 kapda ir)
Security Science Researchers Institute Of Iran
[http://www.KAPDA.ir]



		
__________________________________________ 
Yahoo! DSL Â– Something to write home about. 
Just $16.99/mo. or less. 
dsl.yahoo.com 



