
Date: Tue, 20 Dec 2005 16:23:04 +0100
From: Secunia Research <vuln@...unia.com>
To: vuln@...unia.com
Cc: bugtraq@...urityfocus.com
Subject: Secunia Research: Pegasus Mail Buffer Overflow and Off-by-One
	Vulnerabilities


====================================================================== 

                     Secunia Research 20/12/2005

   - Pegasus Mail Buffer Overflow and Off-by-One Vulnerabilities -

====================================================================== 
Table of Contents

Affected Software....................................................1
Severity.............................................................2
Description of Vulnerability.........................................3
Solution.............................................................4
Time Table...........................................................5
Credits..............................................................6
References...........................................................7
About Secunia........................................................8
Verification.........................................................9

====================================================================== 
1) Affected Software 

* Pegasus Mail version 4.21a, 4.21b, and 4.21c.
* Pegasus Mail version 4.30PB1 (Public Beta 1).

====================================================================== 
2) Severity 

Rating: Moderately Critical
Impact: System access
Where:  Remote

====================================================================== 
3) Description of Vulnerability

Secunia Research has discovered two vulnerabilities in Pegasus Mail,
which can be exploited by malicious people to compromise a user's
system.

1) A boundary error exists when using the reply from a POP3 server
to construct trace messages that are displayed to the user if an
error occurs when downloading emails. This can be exploited to
cause a stack-based buffer overflow via an overly long POP3 reply.

Successful exploitation allows arbitrary code execution but
requires that the user is e.g. tricked into connecting to a malicious
POP3 server.

2) An off-by-one error exists when displaying the RFC2822 message
headers of an email to the user. This can be exploited to overwrite
the least significant byte of the saved EBP via a email message
header that is 1022 bytes or longer. This allows code execution on a
Windows XP system.

Successful exploitation requires that the user is e.g. tricked
into viewing the headers of a malicious email via the 
"Message headers..." menu item in the context menu of the
email message.

The vulnerabilities have been confirmed in version 4.21c and 
4.30PB1 (Public Beta 1).

====================================================================== 
4) Solution 

Updated to version 4.31.

====================================================================== 
5) Time Table 

13/12/2005 - Initial vendor notification.
13/12/2005 - Initial vendor reply.
20/12/2005 - Public disclosure.

====================================================================== 
6) Credits 

Discovered by Tan Chew Keong, Secunia Research.

====================================================================== 
7) References

Pegasus Mail:
http://www.pmail.com/newsflash.htm#secunia

====================================================================== 
8) About Secunia 

Secunia collects, validates, assesses, and writes advisories regarding 
all the latest software vulnerabilities disclosed to the public. These 
advisories are gathered in a publicly available database at the 
Secunia website: 

http://secunia.com/

Secunia offers services to our customers enabling them to receive all 
relevant vulnerability information to their specific system 
configuration. 

Secunia offers a FREE mailing list called Secunia Security Advisories: 

http://secunia.com/secunia_security_advisories/

====================================================================== 
9) Verification 

Please verify this advisory by visiting the Secunia website:
http://secunia.com/secunia_research/2005-61/advisory/

Complete list of vulnerability reports published by Secunia Research:
http://secunia.com/secunia_research/

======================================================================





