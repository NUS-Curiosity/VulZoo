
Date: Tue, 20 Dec 2005 13:31:00 -0700
From: Mandriva Security Team <security@...driva.com>
To: bugtraq@...urityfocus.com
Subject: MDKSA-2005:234 - Updated sudo packages fix vulnerability


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

 _______________________________________________________________________
 
 Mandriva Linux Security Advisory                         MDKSA-2005:234
 http://www.mandriva.com/security/
 _______________________________________________________________________
 
 Package : sudo
 Date    : December 20, 2005
 Affected: 10.1, 10.2, 2006.0, Corporate 2.1, Corporate 3.0,
           Multi Network Firewall 2.0
 _______________________________________________________________________
 
 Problem Description:
 
 Charles Morris discovered a vulnerability in sudo versions prior to
 1.6.8p12 where, when the perl taint flag is off, sudo does not clear
 the PERLLIB, PERL5LIB, and PERL5OPT environment variables, which could
 allow limited local users to cause a perl script to include and execute
 arbitrary library files that have the same name as library files that
 included by the script.
 
 In addition, other environment variables have been included in the patch
 that remove similar environment variables that could be used in python
 and ruby, scripts, among others.
 
 The updated packages have been patched to correct this problem.
 _______________________________________________________________________

 References:
 
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2005-4158
 http://www.sudo.ws/sudo/alerts/perl_env.html
 _______________________________________________________________________
 
 Updated Packages:
 
 Mandriva Linux 10.1:
 2516e27be7da2de14cccef0a77adf35a  10.1/RPMS/sudo-1.6.8p1-1.4.101mdk.i586.rpm
 3c6e47db109ab754ecfd50037a163fe4  10.1/SRPMS/sudo-1.6.8p1-1.4.101mdk.src.rpm

 Mandriva Linux 10.1/X86_64:
 ba79d9f091d06ce3654584e97d6ea695  x86_64/10.1/RPMS/sudo-1.6.8p1-1.4.101mdk.x86_64.rpm
 3c6e47db109ab754ecfd50037a163fe4  x86_64/10.1/SRPMS/sudo-1.6.8p1-1.4.101mdk.src.rpm

 Mandriva Linux 10.2:
 8481507149ed3e20e2cb1ee2ac1aac2d  10.2/RPMS/sudo-1.6.8p1-2.3.102mdk.i586.rpm
 34401e963a063bd36d580b188fc7d5f4  10.2/SRPMS/sudo-1.6.8p1-2.3.102mdk.src.rpm

 Mandriva Linux 10.2/X86_64:
 d105ea0dcf161229cf18bd0b4ad49ae4  x86_64/10.2/RPMS/sudo-1.6.8p1-2.3.102mdk.x86_64.rpm
 34401e963a063bd36d580b188fc7d5f4  x86_64/10.2/SRPMS/sudo-1.6.8p1-2.3.102mdk.src.rpm

 Mandriva Linux 2006.0:
 da9c44f3f29809e72f0b3eac2ad08237  2006.0/RPMS/sudo-1.6.8p8-2.2.20060mdk.i586.rpm
 218a529af57212352cb76bb6dddff6f7  2006.0/SRPMS/sudo-1.6.8p8-2.2.20060mdk.src.rpm

 Mandriva Linux 2006.0/X86_64:
 497b26c02a39f889436af1233a3ccf17  x86_64/2006.0/RPMS/sudo-1.6.8p8-2.2.20060mdk.x86_64.rpm
 218a529af57212352cb76bb6dddff6f7  x86_64/2006.0/SRPMS/sudo-1.6.8p8-2.2.20060mdk.src.rpm

 Corporate Server 2.1:
 a2ff055e40e82badb298e5e43616fa7a  corporate/2.1/RPMS/sudo-1.6.6-2.4.C21mdk.i586.rpm
 757021ec14b8d6bbf5092a55717fed8e  corporate/2.1/SRPMS/sudo-1.6.6-2.4.C21mdk.src.rpm

 Corporate Server 2.1/X86_64:
 d8726687c4576fa798d9689a7ca1783f  x86_64/corporate/2.1/RPMS/sudo-1.6.6-2.4.C21mdk.x86_64.rpm
 757021ec14b8d6bbf5092a55717fed8e  x86_64/corporate/2.1/SRPMS/sudo-1.6.6-2.4.C21mdk.src.rpm

 Corporate 3.0:
 3f8e7d74cf2a9a1df4558aae11596186  corporate/3.0/RPMS/sudo-1.6.7-0.p5.2.4.C30mdk.i586.rpm
 9b06900a06ba7f5185c4d975d6cf5600  corporate/3.0/SRPMS/sudo-1.6.7-0.p5.2.4.C30mdk.src.rpm

 Corporate 3.0/X86_64:
 c5b266372ba22c8899e35051e844ddca  x86_64/corporate/3.0/RPMS/sudo-1.6.7-0.p5.2.4.C30mdk.x86_64.rpm
 9b06900a06ba7f5185c4d975d6cf5600  x86_64/corporate/3.0/SRPMS/sudo-1.6.7-0.p5.2.4.C30mdk.src.rpm

 Multi Network Firewall 2.0:
 13b9e27dd7f1811edce5bba617699ddc  mnf/2.0/RPMS/sudo-1.6.7-0.p5.2.4.M20mdk.i586.rpm
 65e7086a169fbf3200220e347d6824aa  mnf/2.0/SRPMS/sudo-1.6.7-0.p5.2.4.M20mdk.src.rpm
 _______________________________________________________________________

 To upgrade automatically use MandrivaUpdate or urpmi.  The verification
 of md5 checksums and GPG signatures is performed automatically for you.

 All packages are signed by Mandriva for security.  You can obtain the
 GPG public key of the Mandriva Security Team by executing:

  gpg --recv-keys --keyserver pgp.mit.edu 0x22458A98

 You can view other update advisories for Mandriva Linux at:

  http://www.mandriva.com/security/advisories

 If you want to report vulnerabilities, please contact

  security_(at)_mandriva.com
 _______________________________________________________________________

 Type Bits/KeyID     Date       User ID
 pub  1024D/22458A98 2000-07-10 Mandriva Security Team
  <security*mandriva.com>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQFDqDwCmqjQ0CJFipgRAn4HAKCdrQ1nbUpLDexupPOOnGlvmRUDbgCcCxu+
Naj1LKxE/BZ4ZbTw+9at6MA=
=miLy
-----END PGP SIGNATURE-----


