
Date: Thu, 1 Dec 2005 16:45:49 +0100
From: Uwe Hermann <uwe@...mann-uwe.de>
To: bugtraq@...urityfocus.com, full-disclosure@...ts.grok.org.uk,
	phpsec@...arch.com
Subject: [DRUPAL-SA-2005-007] Drupal 4.6.4 / 4.5.6 fixes
	XSS issue

----------------------------------------------------------------------------
Drupal security advisory                                  DRUPAL-SA-2005-007
----------------------------------------------------------------------------
Advisory ID:    DRUPAL-SA-2005-007
Project:        Drupal core
Date:           2005-11-30
Security risk:  less critical
Impact:         normal
Where:          from remote
Vulnerability:  XSS
----------------------------------------------------------------------------

Description
-----------
Ahmed Saad has brought to our attention a creative way to enter malicious
HTML content. Upon further investigation we found that interpretation of
broken HTML/SGML and various quirks in interpretation of correctly formed,
but non-sensical attribute values by various browsers also allows entering
malicious HTML content. These can lead to XSS attacks.

XSS can lead to theft of accounts and services, user tracking,
misinformation...

Versions affected
-----------------
Drupal 4.5.0, 4.5.1, 4.5.2, 4.5.3, 4.5.4, 4.5.5
Drupal 4.6.0, 4.6.1, 4.6.2, 4.6.3

Solution
--------
- If you are running Drupal 4.5.x, then upgrade to Drupal 4.5.6.
- If you are running Drupal 4.6.x, then upgrade to Drupal 4.6.4.

Important notes
---------------
We have developed a new XSS filtering system based on Ulf Harnhammar's kses
library http://sourceforge.net/projects/kses/ . This filtering only happens
for Filtered HTML content so if you are trusting a user to access the Full
HTML input format then said user can enter malicious content, so please
revise your input format settings.

Filtered HTML now filters the style attribute unconditionally.

And finally, filter writers can access this mechanism through the new
filter_xss() function.

Contact
-------
The security contact for Drupal can be reached at security at drupal.org
or using the form at http://drupal.org/contact.
More information is available from http://drupal.org/security or from
our security RSS feed http://drupal.org/security/rss.xml.


// Uwe Hermann, on behalf of the Drupal Security Team.
-- 
Uwe Hermann <uwe@...mann-uwe.de>
http://www.hermann-uwe.de                 | http://www.crazy-hacks.org
http://www.it-services-uh.de              | http://www.phpmeat.org
http://www.unmaintained-free-software.org | http://www.holsham-traders.de

Download attachment "signature.asc" of type "application/pgp-signature" (190 bytes)

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
