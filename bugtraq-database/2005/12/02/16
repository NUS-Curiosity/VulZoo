
Date: Thu, 01 Dec 2005 17:43:52 -0500
From: Cisco Systems Product Security Incident Response Team <psirt@...co.com>
To: bugtraq@...urityfocus.com
Cc: psirt@...co.com
Subject: Cisco Security Advisory: IOS HTTP Server Command Injection Vulnerability


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


Cisco Security Advisory: IOS HTTP Server Command Injection Vulnerability
========================================================================

Document ID: 68322

Advisory ID: cisco-sa-20051201-http

http://www.cisco.com/warp/public/707/cisco-sa-20051201-http.shtml

Revision 1.0

For Public Release 2005 December 01 2100 UTC (GMT)

- -----------------------------------------------------------------------

Contents
========

    Summary
    Affected Products
    Details
    Impact
    Software Versions and Fixes
    Workarounds
    Obtaining Fixed Software
    Exploitation and Public Announcements
    Status of This Notice: INTERIM
    Distribution
    Revision History
    Cisco Security Procedures

- -----------------------------------------------------------------------

Summary
=======

A vulnerability exists in the IOS HTTP server in which HTML code
inserted into dynamically generated output, such as the output from a
"show buffers" command, will be passed to the browser requesting the
page. This HTML code could be interpreted by the client browser and
potentially execute malicious commands against the device or other
possible cross-site scripting attacks. Successful exploitation of this
vulnerability requires that a user browse a page containing dynamic
content in which HTML commands have been injected.

Cisco will be making free software available to address this
vulnerability for affected customers. There are workarounds available
to mitigate the effects of the vulnerability.

This advisory is posted at 
http://www.cisco.com/warp/public/707/cisco-sa-20051201-http.shtml.

Affected Products
=================

This security advisory applies to all Cisco products that run Cisco IOS
Software versions 11.0 through 12.4 with the HTTP server enabled. A
system which contains the IOS HTTP server or HTTP secure server, but
does not have it enabled, is not affected.

To determine if the HTTP server is running on your device, issue the
"show ip http server status" and "show ip http server secure status"
commands at the prompt and look for output similar to:

    Router>show ip http server status
    HTTP server status: Enabled


If the device is not running the HTTP server, you should see output
similar to:

    Router>show ip http server status
    HTTP server status: Disabled


Any version of Cisco IOS prior to the versions which will be listed in
the Fixed Software section below may be vulnerable.

Cisco IOS XR is not affected.

To determine the software running on a Cisco product, log in to the
device and issue the "show version" command to display the system banner.
Cisco IOS Software will identify itself as "Internetwork Operating
System Software" or simply "IOS". On the next line of output, the image
name will be displayed between parentheses, followed by "Version" and
the IOS release name. Other Cisco devices will not have the "show
version" command or will give different output.

The following example identifies a Cisco product running IOS release
12.3(6) with an installed image name of C3640-I-M:

    Cisco Internetwork Operating System Software
    IOS (tm) 3600 Software (C3640-I-M), Version 12.3(6), RELEASE SOFTWARE (fc3)


The next example shows a product running IOS release 12.3(11)T3 with an
image name of C3845-ADVIPSERVICESK9-M:

    Cisco IOS Software, 3800 Software (C3845-ADVIPSERVICESK9-M), Version 12.3(11)T3, RELEASE SOFTWARE (fc4)
    Technical Support: http://www.cisco.com/techsupport
    Copyright (c) 1986-2005 by Cisco Systems, Inc.


Additional information about Cisco IOS release naming can be found at
http://www.cisco.com/warp/public/620/1.html.

No other Cisco products are currently known to be affected by the
vulnerability addressed in this advisory.

Details
=======

The Cisco IOS Web browser interface (which enables the device to
perform as an HTTP server) allows configuration and monitoring of a
router or access server using any web browser. This feature was
introduced in IOS 11.0.

A vulnerability exists in the IOS HTTP server in which HTML code
inserted into dynamically generated output, such as the output from a
"show buffers" command, will be passed to the browser requesting the
page. This HTML code could be interpreted by the browser and
potentially execute malicious commands against the device or other
possible cross-site scripting attacks.

In order to be vulnerable to the cross-site scripting attack, a user
must browse and view the content during the same period of time the
injected code exists in memory. On the other hand, if a user does not
browse contaminated dynamic content on the device, then exploitation is
not possible.

A proof of concept exploit exists for this vulnerability, in which the
exploit attempts to reset the enable password on the device. For the
attack to work against the device itself, the user browsing tainted
dynamic content on the router will only be able to execute commands at
or below the privilege level for which they are authenticated and
authorized for on the device.

This vulnerability is documented in Cisco Bug ID CSCsc64976.

Impact
======

Successful exploitation of the vulnerability may result in an attacker
executing commands on the device, including the possibility of gaining
full administrative privileges on the device which is dependent on the
privilege level of the authenticated user.

Software Versions and Fixes
===========================

No software fixes are currently available. This section will be updated
regularly as soon as software fixes are available.

Workarounds
===========

Disable the HTTP server
+----------------------

If the HTTP server is not used for any legitimate purposes on the
device, it is a best practice to disable it by issuing the following
commands in configure mode:

    no ip http server
    no ip http secure-server


Disable the HTTP WEB_EXEC service
+--------------------------------

A feature was introduced in 12.3(14)T and later in which selective HTTP
and HTTPS services could be enabled or disabled. Two typical services
are WEB_EXEC and the IOS Certificate Server (SCEP). The WEB_EXEC
service provides a facility to configure the box and retrieve current
state of the box from remote clients. The IOS Certificate Server
service provides a facility wherein remote clients can enroll and
obtain Crypto Certificates.

It is possible to disable the WEB_EXEC service while still leaving SCEP
running to serve Certificates. If an installation requires the use of
the SCEP service, the WEB_EXEC service may be disabled via the commands
in configure mode:

    no ip http active-session-modules WEB_EXEC
    no ip http secure-active-session-modules WEB_EXEC


Avoid the use of Web-based SHOW commands
+---------------------------------------

Successful exploitation of this vulnerability requires an unsuspecting
user to request dynamic content from the device via the "show" commands
which are available. Avoiding the use of those commands via the web
interface until an upgrade to fixed software is possible may be
perfectly legitimate for some installations.

Obtaining Fixed Software
========================

Cisco will make free software available to address this vulnerability
for affected customers. This advisory will be updated as fixed software
becomes available. Prior to deploying software, customers should
consult their maintenance provider or check the software for feature
set compatibility and known issues specific to their environment.

Customers may only install and expect support for the feature sets they
have purchased. By installing, downloading, accessing or otherwise
using such software upgrades, customers agree to be bound by the terms
of Cisco's software license terms found at 
http://www.cisco.com/public/sw-license-agreement.html, or as otherwise 
set forth at Cisco.com Downloads at 
http://www.cisco.com/public/sw-center/sw-usingswc.shtml.

Do not contact either "psirt@...co.com" or "security-alert@...co.com"
for software upgrades.

Customers with Service Contracts
+-------------------------------

Customers with contracts should obtain upgraded software through their
regular update channels. For most customers, this means that upgrades
should be obtained through the Software Center on Cisco's worldwide
website at http://www.cisco.com.

Customers using Third-party Support Organizations
+------------------------------------------------

Customers whose Cisco products are provided or maintained through prior
or existing agreement with third-party support organizations such as
Cisco Partners, authorized resellers, or service providers should
contact that support organization for guidance and assistance with the
appropriate course of action in regards to this advisory.

The effectiveness of any workaround or fix is dependent on specific
customer situations such as product mix, network topology, traffic
behavior, and organizational mission. Due to the variety of affected
products and releases, customers should consult with their service
provider or support organization to ensure any applied workaround or
fix is the most appropriate for use in the intended network before it
is deployed.

Customers without Service Contracts
+----------------------------------

Customers who purchase direct from Cisco but who do not hold a Cisco
service contract and customers who purchase through third-party vendors
but are unsuccessful at obtaining fixed software through their point of
sale should get their upgrades by contacting the Cisco Technical
Assistance Center (TAC). TAC contacts are as follows.

  * +1 800 553 2447 (toll free from within North America)
  * +1 408 526 7209 (toll call from anywhere in the world)
  * e-mail: tac@...co.com

Have your product serial number available and give the URL of this
notice as evidence of your entitlement to a free upgrade. Free upgrades
for non-contract customers must be requested through the TAC.

Refer to http://www.cisco.com/warp/public/687/Directory/DirTAC.shtml
for additional TAC contact information, including special localized
telephone numbers and instructions and e-mail addresses for use in
various languages.

Exploitation and Public Announcements
=====================================

This vulnerability was disclosed in a public posting to the Bugtraq
mailing list, and at the following URL: 
http://www.infohacking.com/INFOHACKING_RESEARCH/Our_Advisories/cisco/index.html.

The Cisco PSIRT is not aware of any malicious use of the vulnerability
described in this advisory.

Status of This Notice: INTERIM
==============================

THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY
KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF
MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE
INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT
YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS
DOCUMENT AT ANY TIME. CISCO EXPECTS TO UPDATE THIS DOCUMENT WITHIN FROM
THE ORIGINAL DATE OF THIS NOTICE.

A stand-alone copy or Paraphrase of the text of this document that
omits the distribution URL in the following section is an uncontrolled
copy, and may lack important information or contain factual errors.

Distribution
============

This advisory is posted on Cisco's worldwide website at 
http://www.cisco.com/warp/public/707/cisco-sa-20051201-http.shtml.

In addition to worldwide web posting, a text version of this notice is
clear-signed with the Cisco PSIRT PGP key and is posted to the
following e-mail and Usenet news recipients.

  * cust-security-announce@...co.com
  * first-teams@...st.org
  * bugtraq@...urityfocus.com
  * vulnwatch@...nwatch.org
  * cisco@...t.colorado.edu
  * cisco-nsp@...k.nether.net
  * full-disclosure@...ts.grok.org.uk
  * comp.dcom.sys.cisco@...sgate.cisco.com

Future updates of this advisory, if any, will be placed on Cisco's
worldwide website, but may or may not be actively announced on mailing
lists or newsgroups. Users concerned about this problem are encouraged
to check the above URL for any updates.

Revision History
================

+----------------------------------------+
| Revision | 1-December-2005. | Initial  |
| 1.0      |                  | draft.   |
+----------------------------------------+

Cisco Security Procedures

Complete information on reporting security vulnerabilities in Cisco
products, obtaining assistance with security incidents, and registering
to receive security information from Cisco, is available on Cisco's
worldwide website at 
http://www.cisco.com/en/US/products/products_security_vulnerability_policy.html.
This includes instructions for press inquiries regarding Cisco security 
notices. All Cisco security advisories are available at 
http://www.cisco.com/go/psirt/.

- -----------------------------------------------------------------------

All contents are Copyright 1992-2005 Cisco Systems, Inc. All rights
reserved. 
- -----------------------------------------------------------------------

Updated: Dec 01, 2005                                Document ID: 68322

- -----------------------------------------------------------------------
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.2 (GNU/Linux)

iD8DBQFDj3udezGozzK2tZARAmkwAJ4xrlLCF75ryXyuX2/62peJ1YAUegCfYdUS
jfZM0o9w1mRIAVF4C3uunRs=
=A852
-----END PGP SIGNATURE-----


