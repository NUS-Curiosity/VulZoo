
Date: Tue, 14 Jun 2005 22:55:08 +0200
From: Christoph 'knurd' Jeschke <christoph.jeschke@...il.com>
To: bugtraq@...urityfocus.com
Subject: Re: Arbitrary code execution in eping plugin


Jonathan Angliss schrieb:

> Won't match IPv6 addresses, but neither will the original code, and it
> matches IP addresses perfectly I believe.

My Suggestion for IPv4 is:

^(?!0+\.0+\.0+\.0+$)([01]?\d{1,2}|2[0-2][0-3])\.([01]?\d{1,2}|2[0-4]\d|25[0-5])\.([01]?\d{1,2}|2[0-4]\d|25[0-5])\.([01]?\d{1,2}|2[0-4]\d|25[0-5])$

So 0.0.0.0 (Internet) doesn't match, just as 224.0.0.0/4 (Multicast) and
240.0.0.0/4 (Future Use) as described in RFC3330.

(based on the Regex from Mastering Regular Expression, Jeffrey E.F. Friedl)

Any further suggestions?


