
Date: 15 Sep 2005 01:56:45 -0000
From: contact@...scanner.com
To: bugtraq@...urityfocus.com
Subject: Airscanner Mobile Security Advisory #05081102: vxFtpSrv 0.9.7
 Remote Code Execution Buffer Overflow Vulnerability


Airscanner Mobile Security Advisory #05081102:
vxFtpSrv 0.9.7 Remote Code Execution Buffer Overflow Vulnerability 

Product:
vxFtpSrv 0.9.7

Platform:
Tested on Windows Mobile Pocket PC 2003

Requirements:
Mobile device running Windows Mobile Pocket PC with vxFtpSrv 0.9.7 installed and running.

Credits:
Seth Fogie
Airscanner Mobile Security
http://www.airscanner.com
Mobile Antivirus Researchers Association
http://www.mobileav.org
August 12 2005

Risk Level:
High. Remote attacker can execute code.

Summary:
vxFtpSrv is a complete multi-threaded FTP server for Windows CE-based Handheld Pro, Pocket PC, Pocket PC 2002 and Windows Mobile 2003 devices. If an excessively long user name is provided, a buffer overflow will occur, thus causing either an instant crash of the program or code execution.

Details:
USER seth@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@J@@@I@@@H@@@G@@@F@@@E@
@@D@@@C@@@B@@@XXXX where XXXX represents the address of the return address that will be loaded into the Program Counter.

The bug is found in an sprintf function responsible for writing back a password request to the user. If the user provided name is excessively long, a buffer overflow will occur. Remote code execution is possible, assuming the attacker can guess what memory segment the program is located in. Generally, this will be 18,20,22, or 24. 

Workaround:
None

Vendor Response:
Waiting response.

Copyright (c) 2005 Airscanner Corp.

Permission is granted for the redistribution of this alert electronically. It may not be edited in any way without the express written consent of Airscanner Corp. If you wish to reprint the whole or any part of this alert in any other medium other than electronically, please contact Airscanner Corp. for permission.

Disclaimer: The information in the advisory is believed to be accurate at the time of publishing based on currently available information. Use of the information constitutes acceptance for use on an AS IS condition. There are no warranties with regard to this information. Neither the author nor the publisher accepts any liability for any direct, indirect, or consequential loss or damage arising from use of, or reliance on, this information.

advisory
http://www.airscanner.com/security/05081102_vxftpsrv.htm


