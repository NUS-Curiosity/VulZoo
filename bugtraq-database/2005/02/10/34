
Date: Thu, 10 Feb 2005 11:16:28 -0700
From: Shiva Persaud <shivapd@...ibm.com>
To: bugtraq@...urityfocus.com, vulnwatch@...nwatch.org
Subject: Re:iDEFENSE Security Advisory 02.10.05: IBM AIX ipl_varyon Local Buffer
 Overflow Vulnerability

The IBM Advisory:

By the way, you can subscribe to AIX Security Advisories by visiting the 
link in the advisory below. -- Shiva



-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

IBM SECURITY ADVISORY

First Issued: Wed Feb  9 15:16:37 CST 2005

=========================================================================
                           VULNERABILITY SUMMARY

VULNERABILITY:      A buffer overflow in the ipl_varyon command may
                    allow a local user in the system group to gain root
                    privileges.

PLATFORMS:          AIX 5.1, 5.2 and 5.3.

SOLUTION:           Apply the workaround, efix or APAR as described
                    below.

THREAT:             A local user in the system group may gain root
                    privileges.

CERT VU Number:     N/A
CVE Number:         N/A
=========================================================================
                           DETAILED INFORMATION


I.  Description
===============

A buffer overflow vulnerability was discovered in the ipl_varyon command.
This command is used to varyon the root volume group during the boot
process. A user in the system group may exploit this vulnerability to gain
root privileges.

The command affected by this issue ships as part of the bos.rte.lvm
fileset. To determine if this fileset is installed, execute the following
command:

# lslpp -L lslpp -L bos.rte.lvm

If the fileset is installed it will be listed along with its version
information, state, type and a description.


II. Impact
==========
A local user in the system group may gain root privileges.


III.  Solutions
===============

A. Official Fix

IBM provides the following fixes:

      APAR number for AIX 5.1.0: IY67812  (available approx. 03/23/05)
      APAR number for AIX 5.2.0: IY67750  (available approx. 04/15/05)
      APAR number for AIX 5.3.0: IY66933  (available approx. 04/15/05)

NOTE: Affected customers are urged to upgrade to 5.1.0, 5.2.0 or 5.3.0 at
the latest maintenance level.

B. Emergency Fix

Efixes are available for AIX 5.1.0, 5.2.0 and 5.3.0. The efixes can be
downloaded via ftp from:

     ftp://aix.software.ibm.com/aix/efixes/security/ipl_varyon_efix.tar.Z

ipl_varyon_efix.tar.Z is a compressed tarball containing this advisory,
three efix packages cleartext PGP signatures for each efix package.


Verify you have retrieved the efixes intact:
- --------------------------------------------
The checksums below were generated using the "sum" and "md5sum" commands
and are as follows:

Filename                 sum         md5
=====================================================================
IY67812.050209.epkg.Z    52730    11 df9cdc3bced511a2bc426edc487aec6e
IY67750.050209.epkg.Z    05037    11 d3d2e7cf6e05a092b3b292cffdd2b53c
IY66933.050209.epkg.Z    03588    12 1764bce34b7c1f47a957da5f6a9c3004


These sums should match exactly. The PGP signatures in the compressed
tarball and on this advisory can also be used to verify the integrity of
the various files they correspond to. If the sums or signatures cannot be
confirmed, double check the command results and the download site address.
If those are OK, contact IBM AIX Security at security-alert@...tin.ibm.com
and describe the discrepancy.

IMPORTANT: If possible, it is recommended that a mksysb backup of the
system is created. Verify it is both bootable, and readable before
proceeding.

These efixes have not been fully regression tested; thus, IBM does not
warrant the fully correct functioning of the efix.  Customers install the
efix and operate the modified version of AIX at their own risk.

Efix Installation Instructions:
- -------------------------------
These packages use the new Emergency Fix Management Solution to install
and manage efixes. More information can be found at:

     http://techsupport.services.ibm.com/server/aix.efixmgmt

To preview an epkg efix installation execute the following command:

# emgr -e epkg_name -p       # where epkg_name is the name of the
                             # efix package being previewed.

To install an epkg efix package, execute the following command:

# emgr -e epkg_name -X       # where epkg_name is the name of the
                             # efix package being installed.

The "X" flag will expand any filesystems if required.

C. Workaround

Setting the file mode bits to 500 will allow only the root user to execute
the netpmon command. This can be done by executing the following command
as root:

# chmod 500 /usr/bin/netpmon 

Verify that the file mode bits have been changed to 500:

# ls -la /usr/bin/netpmon
- -r-x------  1 root system 83454 2003-04-09 18:48 /usr/bin/netpmon


IV. Obtaining Fixes
===================

AIX Version 5 APARs can be downloaded from:

     http://www-1.ibm.com/servers/eserver/support/pseries/aixfixes.html

Security related Emergency Fixes can be downloaded from:

     ftp://aix.software.ibm.com/aix/efixes/security


V.  Acknowledgments
====================
This vulnerability was reported by iDEFENSE.


VI.  Contact Information
========================

If you would like to receive AIX Security Advisories via email, please
visit:
     https://techsupport.services.ibm.com/server/pseries.subscriptionSvcs

Comments regarding the content of this announcement can be directed to:

     security-alert@...tin.ibm.com

To request the PGP public key that can be used to communicate securely
with the AIX Security Team send email to security-alert@...tin.ibm.com
with a subject of "get key". The key can also be downloaded from a PGP
Public Key Server. The key id is 0x9391C1F2.

Please contact your local IBM AIX support center for any assistance.

eServer is a trademark of International Business Machines Corporation.
IBM, AIX and pSeries are registered trademarks of International Business
Machines Corporation. All other trademarks are property of their
respective holders.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.0 (MingW32)

iD8DBQFCCp4JxwSSvpORwfIRAggsAJ0TTQOsoNXNbqrQkBHZ6OmiJzYyRQCbBksn
GH7fwvFVJmpz9FWbqvziteg=
=/3Z7
-----END PGP SIGNATURE-----

Download attachment "smime.p7s" of type "application/x-pkcs7-signature" (5213 bytes)
