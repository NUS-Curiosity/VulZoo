
Date: 5 Aug 2005 23:28:01 -0000
From: manolisgavriil@...mail.com
To: bugtraq@...urityfocus.com
Subject: Design Flaw at Microsoft's AntiSpyware


Hi,

A possible design flaw i encountered during my research on Microsoft's AntiSpyware(Beta Version).

Summary:
Bypassing Microsoft's AntiSpyware alerting system on programs trying to access Registry.

Details:
When a program is trying to write to Registry Startup Keys like for example HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run a pop-up message is produced by Microsoft's AntiSpyware informing the user for a change at Windows Registry.Although this is working when the registry key has a file extention,Microsoft's AntiSpyware doesnt bother when the same Registry key doesnt have an extention.That wouldnt be a problem if Windows itself didnt execute the file in the registry key with no extention. But they do! So for example:
"HKEY_LOCAL_MACHINE/SOFTWARE/Microsoft/Windows/CurrentVersion/Run" With key "Emmgav", "C:\Windows\repair\svc.exe"
and
"HKEY_LOCAL_MACHINE/SOFTWARE/Microsoft/Windows/CurrentVersion/Run" With key "Emmgav", "C:\Windows\repair\svc"
For Microsoft AntiSpyware isnt exactly the same!

Vulnerable Versions:
Tested on Microsoft AntiSpyware (BETA) 1.0.615

Exploit:
Design Flaw, exploit not needed.

Cheers,

Emmanouil Gavriil(manolisgavriil@...mail.com)


