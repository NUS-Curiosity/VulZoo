
Date: Wed, 10 Aug 2005 15:59:30 +0200
From: <sitic@....se>
To: <full-disclosure@...ts.grok.org.uk>,
	<bugtraq@...urityfocus.com>
Subject: Evolution multiple remote format string bugs

* SITIC Vulnerability Advisory *

           Advisory Name: Evolution multiple remote format string bugs
      Advisory Reference: SA05-001
 Date of initial release: 2005-08-10
                 Product: Evolution 1.5, 2.0, 2.1, 2.2, 2.3
                Platform: Linux, BSD systems, Unix
                  Effect: Remote code execution
Vulnerability Identifier: Not assigned


Overview:

Evolution suffers from several format string bugs when handling data from
remote sources. These bugs lead to crashes or the execution of arbitrary
assembly language code.


Details:

1) The first format string bug occurs when viewing the full vCard data
attached to an e-mail message.

When opening an e-mail message, only a compact view of some of the fields
from the vCard is displayed, and this does not trigger the vulnerability.
To be affected, the user must click on Show Full vCard or perform similar
actions such as clicking on Save in Addressbook and then viewing the saved
data under the Contacts tab.

Why is this important? An attacker might notice that an organisation uses
Evolution, for instance after seeing the "X-Mailer: Evolution x.y.z" e-mail
header in their e-mails. He or she could then send out e-mail messages with
malicious vCards to many e-mail accounts at the organisation, in the hope
that some of the recipients will view the full vCard data sooner or later,
thus exposing the organisation to this format string bug.


2) The second format string bug occurs when displaying contact data from
remote LDAP servers.


3) The third format string bug occurs when displaying task list data from
remote servers.


4) The fourth, and least serious, format string bug occurs when the user
goes to the Calendars tab to save task list data that is vulnerable to
problem 3 above. Other calendar entries that do not come from task lists
are also affected.


Mitigating factors:

Users that never use any of the vulnerable features in Evolution are not
affected.


Affected versions:

  o  Evolution 1.5 to Evolution 2.3.6.1


Recommendations:

We recommend that users either upgrade to Evolution 2.3.7 (unstable) or
apply our unofficial patch to their Evolution installation.


Patch information:

Evolution 2.3.7 is available from the following source:

  o  http://ftp.gnome.org/pub/gnome/sources/evolution/

Our unofficial patch is available from our home page:

  o  http://www.sitic.se


Acknowledgments:

These vulnerabilities were discovered by Ulf Harnhammar for SITIC, Swedish
IT Incident Centre.


Contact information:

Swedish IT Incident Centre, SITIC
P O Box 5398, SE-102 49 Stockholm, Sweden
Telephone: +46-8-678 5799
Email: sitic at pts dot se
http://www.sitic.se


Revision history:

First published 2005-08-10


About SITIC:

The Swedish IT Incident Centre within the National Post and Telecom Agency
has the task to support society in working with protection against IT
incidents. SITIC facilitates exchange of information regarding IT incidents
between organisations in society, and disseminates information about new
problems which potentially may impede the functionality of IT systems. In
addition, SITIC provides information and advice regarding proactive measures
and compiles and publishes statistics.


Disclaimer:

The decision to follow or act on information or advice contained in this
Vulnerability Advisory is the responsibility of each user or organisation.
SITIC accepts no responsibility for any errors or omissions contained within
this Vulnerability Advisory, nor for any consequences which may arise from
following or acting on information or advice contained herein.

Download attachment "evolution.formatstring.patch" of type "application/octet-stream" (2146 bytes)

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
