
Date: Tue, 13 Jun 2006 14:07:08 -0400
From: labs-no-reply <labs-no-reply@...fense.com>
To: bugtraq@...urityfocus.com, vulnwatch@...nwatch.org,
	full-disclosure@...ts.grok.org.uk
Subject: iDefense Security Advisory 06.13.06: Windows
 MRXSMB.SYS MRxSmbCscIoctlOpenForCopyChunk Overflow


Windows MRXSMB.SYS MRxSmbCscIoctlOpenForCopyChunk Overflow

iDefense Security Advisory 06.13.06
http://www.idefense.com/application/poi/display?type=vulnerabilities
June 13, 2006

I. BACKGROUND

Microsoft Windows Operating System is system software for Intel based
PCs. More information can be found at the vendor website:

   http://www.microsoft.com

II. DESCRIPTION

Local exploitation of a buffer overflow vulnerability in Microsoft
Corp.'s Windows Operating System could allow attackers to gain SYSTEM
privileges.

The vulnerability specifically exists due to a logic error in the
Microsoft Client Side Caching (CSCDLL.DLL) and Microsoft Server Message
Block Redirector Driver (MRXSMB.SYS) code. The Microsoft Client Side
Caching infrastructure provides the user-mode portion of the "offline
files" subsystem, which allows interaction with network files while
offline and preserves file system permissions. The Microsoft Server
Message Block Redirector Driver is the kernel-mode file system driver
that provides the network redirector functionality utilized by CSC.

MRXSMB.SYS functions are exposed via IOCTL commands. An access
validation error exists in the MrxSmbCscIoctlOpenForCopyChunk()
function. In order to establish communication with the MRXSMB subsystem,
a file handle to a shadow device is created and DeviceIoControl() is
used to issue commands. If an attacker utilizes the METHOD_NEITHER
method flag, the address will be unchecked and an overwrite of kernel
memory can occur resulting in ring0 code execution.

III. ANALYSIS

Successful exploitation of this vulnerability could result in elevation
to SYSTEM privileges.

IV. DETECTION

iDefense has confirmed the existence of this vulnerability in Microsoft
Windows XP SP2. It is suspected that all versions of Microsoft Windows
are vulnerable.

V. WORKAROUND

iDefense is unaware of any effective workaround for this issue.

VI. VENDOR RESPONSE

The vendor security advisory and appropriate patches are available at:

   http://www.microsoft.com/technet/security/Bulletin/MS06-030.mspx

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CAN-2006-2373 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

12/09/2005  Initial vendor notification
12/13/2005  Initial vendor response
06/13/2006  Coordinated public disclosure

IX. CREDIT

iDefense credits Rubén Santamarta with the discovery of this
vulnerability.

Get paid for vulnerability research
http://www.idefense.com/poi/teams/vcp.jsp

Free tools, research and upcoming events
http://labs.idefense.com

X. LEGAL NOTICES

Copyright © 2006 iDefense, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDefense. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically, please
email customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.


_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/


