
Date: Mon, 24 Jul 2006 17:33:24 +0100
From: "Sec-Tec Lists" <zen31438@....co.uk>
To: <bugtraq@...urityfocus.com>
Subject: Check Point R55W Directory Traversal

Overview

Check Point Firewall-1 R55W contains a hard coded web server, which runs on
TCP port 18264. This server is there to deal with PKI requirements for Check
Point's VPN functionality.

During a routine penetration test of a client, Sec-Tec discovered a
directory traversal vulnerability that allows a potential attacker to
retrieve files from the underlying OS.

This issue is potentially serious for a number of reasons:

1. Check Point's "rule zero" will often by default allow access to this port
for external IP addresses.

2. It would currently seem that there are few restrictions as to what files
can be retrieved via this mechanism (Sec-Tec were able to obtain the
underlying OS' account repository).

Exploit

The issue can be exploited via a web browser using typical hex encoded
directory traversal strings.

Affected Version(s):

Check Point R55W
Check Point R55W HFA1
Check Point R55W HFA2

(Confirmed on Windows 2003 Server platform, other platforms may be
affected.)

Current Status

Check Point have confirmed that this issue was corrected in R55W HFA03.
However, Sec-Tec have been unable to find any publicly available references
to this issue, either within Check Point's knowledge base or HFA03 release
notes.

Updates to this issue will be found at:
http://www.sec-tec.co.uk/vulnerability/r55w_directory_traversal.html


Pete Foster
Senior Consultant
Sec-Tec Ltd

