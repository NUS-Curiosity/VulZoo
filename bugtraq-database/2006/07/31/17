
Date: Mon, 31 Jul 2006 14:00:12 +0100
From: "advisories" <advisories@...saire.com>
To: <bugtraq@...urityfocus.com>
Subject: Corsaire Security Advisory - VMware ESX Server Password Disclosure in Cookie issue


-- Corsaire Security Advisory --

Title: VMware ESX Server Password Disclosure in Cookie issue
Date: 12.05.06
Application: VMware ESX prior to 2.5.2 patch 4
             VMware ESX prior to 2.0.2
Environment: VMware ESX
Author: Martin O'Neal [martin.oneal@...saire.com]
Audience: General distribution
Reference: c060512-001


-- Scope --

The aim of this document is to clearly define an issue that exists with 
the VMware ESX Server product [1] that will allow a local attacker to 
gain access to users' (including root's) passwords under certain 
conditions.


-- History --

Discovered: 12.05.06 (Martin O'Neal)
Vendor notified: 19.05.06
Document released: 31.07.06


-- Overview --

VMware ESX Server is described [1] as virtual infrastructure software 
for partitioning, consolidating and managing servers in mission-critical 
environments.
 
The software provides a virtualization layer that allows multiple x86 
based operating systems to run on the same hardware concurrently.  The 
ESX Server product differs from other VMware products in that it does 
not require a "host" operating system to be provided by the user.  
Instead, it uses a custom x86 kernel as the host, along with a 
customised Linux operating system as a "console O/S". 

VMware ESX Server includes a number of network services and a web 
application, called the "VMware Management Interface" that can be used 
to perform remote administration of the system. 


-- Analysis --

The Management Interface is a traditional web application, which 
utilises a session ID contained within two cookies; vmware.mui.kid and 
vmware.mui.sid.  The Session ID format is proprietary and contains the 
user account and password in a simple (recursively) base64 encoded 
format.

If an attacker can gain access to the cookies by any mechanism, such as 
through a simple cross site scripting attack, then they will acquire not 
only the session ID, but the authentication credentials as well.


-- Recommendations --

Upgrade to a version of the VMware ESX product that does not exhibit 
this issue.


-- CVE --

The Common Vulnerabilities and Exposures (CVE) project has assigned the 
name CVE-2006-2481 to this issue.  This is a candidate for inclusion in 
the CVE list (http://cve.mitre.org), which standardises names for 
security problems.


-- References --

[1] http://www.vmware.com/products/esx/ 


-- Revision --

a. Initial release.
b. Minor edits.
c. Released.


-- Distribution --

The information contained within this advisory is supplied "as-is" with 
no warranties or guarantees of fitness of use or otherwise. Corsaire 
accepts no responsibility for any damage caused by the use or misuse of 
this information.


-- Disclaimer --

The information contained within this advisory is supplied "as-is" with 
no warranties or guarantees of fitness of use or otherwise. Corsaire 
accepts no responsibility for any damage caused by the use or misuse of 
this information.


-- About Corsaire --

Corsaire are a leading information security consultancy, founded in 1997 
in Guildford, Surrey, UK. Corsaire bring innovation, integrity and 
analytical rigour to every job, which means fast and dramatic security 
performance improvements. Our services centre on the delivery of 
information security planning, assessment, implementation, management 
and vulnerability research. 

A free guide to selecting a security assessment supplier is available at 
http://www.penetration-testing.com 


Copyright 2006 Corsaire Limited. All rights reserved.

