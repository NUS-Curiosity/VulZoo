
Date: 19 Jul 2006 08:11:24 -0000
From: sledge@...adise.net.nz
To: bugtraq@...urityfocus.com
Subject: AFCommerce Shopping Cart

The 'Demo Store' version of the AFCommerce Shopping Cart (www.afcommerce.com) is vulnerable to both SQL Injection and Cross Site Scripting (XSS).

SQL Injection can be tested by inserting the classic 'or 1=1-- into the search field.  The result is that the first record is returned.  We can also perform a UNION to return all the records.

The XSS vulnerability can be tested by registering as a new user and selecting to add a new review to a product.  In the 'new review' text box we can insert some text such as:

   <b>some text</b><script>alert("xxx")</script>

With this text inserted we can view the product and select 'reviews'.  Upon doing this our Alert box is executed with 'xxx' then the page is displayed with the 'some text' being displayed as bold.  

This are only simple example to test for these vulnerabilites.  An attacker could take full advantage of these two vulnerabilities to attack the database, include malicious code or deface the site.
