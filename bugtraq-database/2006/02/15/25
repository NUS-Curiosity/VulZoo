
Date: 14 Feb 2006 18:38:44 -0000
From: info@...italarmaments.com
To: bugtraq@...urityfocus.com
Subject: Digital Armaments Security Advisory 02.14.2006: Gallery web-based
 photo gallery remote file execution


Gallery web-based photo gallery remote file execution

Digital Armaments advisory is 02.14.2006
http://www.digitalarmaments.com/2006140293402395.html

I. Background

Gallery is a slick Web-based photo album written using PHP. It is easy to install, includes a config wizard, and provides users with the ability to create and maintain their own albums in the album collection via an intuitive Web interface. Photo management includes automatic thumbnail creation, image resizing, rotation, ordering, captioning and more. Albums can have read, write, and caption permissions per individual authenticated user for an additional level of privacy.
For further information or detail about the software you can refer to the vendor's homepage:

http://gallery.menalto.com


II. Problem Description

Every user with privileges (who can modify appareance of one Gallery's album) can include any file located on the server. This vulnerability can be found in util.php. It allows to an attacker to read files on the remote system or execute arbitrary PHP code with apache privileges if the attacker can upload files.

III. Detection

This problem has been detected on latest development and stable version of gallery 1.5 and on prior version.

IV. Impact analysis

Successful exploitation allow an attacker to execute arbitrary code on the system with apache privileges.

V. Solution

First notification 12.20.2005.
Second notification 01.14.2006.
The vendor answered second notification.
A new patched version is available.

VI. Credit

Seregorn - seregon@...hunter.net is credited with this discovery.

Get paid and get stocks by vulnerability submission
http://www.digitalarmaments.com/contribute.html 

VII. Legal Notices

Copyright ï¿½ 2006 Digital Armaments LLC. 

Redistribution of this alert electronically is allowed. It should not be edited in any way. Reprint the whole is allowed, partial reprint is not permitted. For any other request please email customerservice@...italarmaments.com for permission. Disclaimer: The information in the advisory is believed to be accurate at the time of publishing based on currently available information. Use of the information constitutes acceptance for use in an AS IS condition. There are no warranties with regard to this information. Neither the author nor the publisher accepts any liability for any direct, indirect, or consequential loss or damage arising from use of, or reliance on, this information.


