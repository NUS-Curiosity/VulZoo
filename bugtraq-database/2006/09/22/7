
Date: Fri, 22 Sep 2006 18:09:30 +1000
From: "Patrick Webster" <patrick@...hack.com>
To: bugtraq@...urityfocus.com
Subject: ContentKeeper Authenticated Access Password Disclosure

aushack.com - Vulnerability Advisory
-----------------------------------------------
Release Date:
 22-Sep-2006

Software:
 ContentKeeper Technologies - ContentKeeper
 http://www.contentkeeper.com/

 "ContentKeeper is an industry leading Internet content filter that allows
 organisations to monitor, manage, control & secure staff access to
 Internet resources."

Versions affected:
 ContentKeeper 123.25 and below.

Vulnerability discovered:

 A design flaw in the user administration interface reveals account
 passwords inside the HTML source code. Any authenticated user with
 appropriate access to the user administration page may use this
 information to compromise the accounts on other systems.

Vulnerability impact:

 Low - Unauthorised password disclosure may result in other system account
       breaches where the revealed password has been reused.

Vulnerability information

 The appliance is administered by use of a web browser HTML based front
 end. Authenticated users have access to the account administration page,
 whereby they can administer existing usernames, reset passwords, create
 and delete accounts etc. The appliance does not hash the existing user
 passwords. When the page is requested, the plaintext password for each
 account is inserted into the password input value of the FORM element
 and sent to the client.

 Example:
  https://contentkeeperbox/cgi-bin/ck/changepw.cgi

  This will return all user details. By viewing the page source,
  the password of each account is revealed.

  E.g. for user 'root' with a password of 'it_isAs3cret':

  <form>
  <input name="username" type="text" value="root">Username:
  <input type="password" name="password" value="it_isAs3cret">Password:
  ..
  <input name="username" type="text" value="rootBackup">Username:
  <input type="password" name="password" value="IamF0rgetful">Password:
  </form>

  It may be possible to extract this information from the browser cache,
  however the HTML content is set to expire immediately.

Solution:
 None yet, do not reuse passwords. Future versions may hash the value.

References:
 aushack.com advisory
 http://www.aushack.com/advisories/200606-contentkeeper.txt

Credit:
 Patrick Webster (patrick@...hack.com)

Disclosure timeline:
 15-Mar-2006 - Discovered during quick audit - common design flaw.
 08-Jun-2006 - Sent to ContentKeeper support.
 12-Jun-2006 - Vendor response, update expected July 2006.
 22-Sep-2006 - Public disclosure.

EOF
