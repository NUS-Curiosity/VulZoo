
Date: 7 Aug 2006 13:36:56 -0000
From: darkz.gsa@...il.com
To: bugtraq@...urityfocus.com
Subject: DeluxeBB Multiple Vulnerabilities

DeluxeBB Multiple Vulnerabilities

 
Author: Attila Gerendi (Darkz)
Date: July 30, 2006

Package: DeluxeBB (http://www.deluxebb.com/)
Versions Affected: 1.08 (Other versions may also be affected.)
Severity: Cross-Site Scripting, Cookie Manipulation, Login Bypass

 

 

Cross-Site Scripting:

 

When posting a new topic the topic title field (subject in newpost.php)  is not properly sanitised before being returned to the user. This can be used to stole users cookie and cookies contain username/password data usable to bypass login sequences.

 

Cookie Manipulation:

 

 The PM system (pm.php) is using a very poor or we can say it is not using at al a member validation. This file can be accessed directly, the remote attacker have just to set a valid username in the membercookie cookie parameter. This can be used to access/use everybody personal messenger.

 

Example of member validation used in the file:


$getpm = $db->query("SELECT type,hasread FROM ".$prefix."pm WHERE (whoto='$membercookie')");



Another weakness is the fact that the password md5 is always carried with the cookies and it can be stolen by sniffers or with XSS and even decrypted with rainbow tables.

 

There may be more  vulnerabilities there.

The Author was contacted via home page "personal messenger" module at July 30 2006. The problem was fixed on the product main website, and a new release is scheduled. 

Solution:
You may edit the source code to ensure that input is properly sanitised.

 
