
Date: Tue, 29 Aug 2006 08:27:51 +0200
From: Frank Reißner <mail@...nk-reissner.de>
To: <bugtraq@...urityfocus.com>
Subject: AW: JetBox cms (search_function.php) Remote File Include

The same 'vuln' was posted yesterday and it is definitly not exploitable.
You can't include any file there the include function is called in a
function and you can't call that function in any way by requesting
search_function.php. 

Search_function.php 

<?php

//comments

function phpdigSearch(){

Line: 423 <?php include $relative_script_path.'/libs/htmlheader.php' ?>

...
} 

?>

The variable $relative_script_path is also initialized in the function
header

function phpdigSearch($id_connect, $query_string, $option='start',
$refine=0, $refine_url='', $lim_start=0, $limite=10,
$browse=0,$site=0, $path='', 
			     $relative_script_path = '.', $template='',
                       $templates_links='')
{
...
}


Please explain us how that should be exploited.



-----Ursprüngliche Nachricht-----
Von: carcabotx@...oo.com [mailto:carcabotx@...oo.com] 
Gesendet: Montag, 28. August 2006 15:08
An: bugtraq@...urityfocus.com
Betreff: JetBox cms (search_function.php) Remote File Include

############################################

Found by : CarcaBot

--

E-mail : CarcaBotx [at] Yahoo [dot] com

--

$relative_script_path.'/libs/htmlheader.php

--

Exploit

--

# Google Dork: powered by Jetbox CMS

--

http://www.sitename.com/path/includes/phpdig/libs/search_function.php?relati
ve

_script_path=[Evil Code]

--

Greets goes to : CarcaBot Administrator of Romanian Electronic Network
Security Lab Team http://Hacking.CarcaBot.ro - Best Romanian Hacking Source

