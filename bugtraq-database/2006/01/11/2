
Date: 9 Jan 2006 18:36:32 -0000
From: info@...italarmaments.com
To: bugtraq@...urityfocus.com
Subject: Digital Armaments Security Advisory 01.09.2006: Apache auth_ldap
 module Multiple Format Strings Vulnerability


Digital Armaments advisory is 12.22.2005
http://www.digitalarmaments.com/2006090173928420.html

I. Background

auth_ldap is an LDAP authentication module for Apache, the world's most popular web server. auth_ldap has excellent performance, and supports Apache on both Unix and Windows NT. It also has support for LDAP over SSL, and a mode that lets Microsoft Frontpage clients manage their web permissions while still using LDAP for authentication. 
For many information or detail about the software you can refer to the vendor's homepage:

http://www.rudedog.org/auth_ldap/

II. Problem Description

Due to an insecure usage of the function apache logging function (ap_log_rerror) in auth_ldap_log_reason function it's possible to run abitrary code on the server running the module. For example this can generate a custom format string that can be supplied by the attacker throught the username given during the apache authentication process but several parts of the module are affected. 

III. Detection

This problem has been detected on latest version of auth_ldap 1.6.0 and on prior version from 1.2.x. It persist on all platforms where auth_ldap can be compiled.

IV. Impact analisys

Successful exploitation allow an attacker to gain access to the system. Exploit code is required.

V. Solution

First notification 12.22.2005.
Second notification 01.09.2006.
The vendor answered second notification.
A new patched version will be available.

VI. Credit

Seregorn - seregon@...hunter.net is credited with this discovery.

Get paid and get stocks by vulnerabiliy submission
http://www.digitalarmaments.com/contribute.html 

VII. Legal Notices

Copyright ï¿½ 2005 Digital Armaments LLC. 

Redistribution of this alert electronically is allowed. It should not be edited in any way. Reprint the whole is allowed, partial reprint is not permitted. For any other request please email customerservice@...italarmaments.com for permission. Disclaimer: The information in the advisory is believed to be accurate at the time of publishing based on currently available information. Use of the information constitutes acceptance for use in an AS IS condition. There are no warranties with regard to this information. Neither the author nor the publisher accepts any liability for any direct, indirect, or consequential loss or damage arising from use of, or reliance on, this information.


