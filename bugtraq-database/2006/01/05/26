
Date: Thu, 5 Jan 2006 13:32:45 -0600
From: "NaPa" <napa@...uritynation.com>
To: "'bipin gautam'" <visitbipin@...mail.com>,
	<bugtraq@...urityfocus.com>,
	"'Vulnerability Development'" <vuln@...uritynation.com>,
	<full-disclosure@...ts.grok.org.uk>,
	<vulnwatch@...nwatch.org>
Subject: RE: Download Accelerator Plus can be tricked to download malicious file



Here Is The investigation about DAP, as I see there's no problem and no flaw
at this time, but someone can act as a Proxy and replace some text mirrors
form the list that Mirrorssearch.speedbit.com response. On this way could a
user download some malicious file without knowledge.


Affected: Every version. This is not a flaw of the application, if is vuln
is a flaw with networking or other intrusion method.


All mirrors from DAP were in speedbit server, and were validated as
Application Servers like (twcows, downloads.com, etc) so there's no matter
about corrupted or backdoored file as I see.

Regards
Luis Alberto Cortes Zavala

Conection host: 212.143.22.20 speedbit.com

##REQUEST###################################################################
#################

GET
/cgi-bin/MirrorSearch.dll?ver9?Scheme=3&Site=domain.com&Path=path/to/file.zi
p&Filename=filename.zip&Size=4294967295&Pos=0&Country=&Region=&R=0&Advanced=
1&Checksum=&BPS=0&V=7.5.1.6&DMD=028b05e62dc625aa456c43ac286a9326&D4=X0VGUg==
&REF=&MID=ezI1Qzk5RjRBLTg5MUItNDUwNC05MEE5LUFDODg0NEY2MjExOH17NjU1NTk3NEMtN0
M4NS00ZTEzLUE5REUtNTBGNzdFRERBMkMyfQ==&SS=&SE=AAQAKgQAABAAKgIAABQAUgEAABUAUg
IAABYAUgMAABcAUgAA&SN=0&SV=3 HTTP/1.1
Host: mirrorsearch.speedbit.com
Accept: */*
User-Agent: DA 7.0 (L0)
Connection: Close
Range: bytes=0-

##RESPONSE##################################################################
#################
HTTP/1.1 302 Object Moved
Content-Length: 359
Content-Type: text/html
Location:
http://212.143.22.90/cgi-bin/FilenameSearch.dll?ver5?Filename=filename.ZIP&S
ize=-1&Country=&Region=&Scheme=3&Site=domain.net&Path=path/to/file.zip&R=0&A
dvanced=1&Checksum=&BPS=0&V=7.5.1.6&
X-Powered-By: ASP.NET
Date: Thu, 05 Jan 2006 19:02:49 GMT
Connection: close

<head><title>Document Moved</title></head>
<body><h1>Object Moved</h1>This document may be found <a
HREF="http://212.143.22.90/cgi-bin/FilenameSearch.dll?ver5?Filename=FILENAME
.ZIP&amp;Size=-1&amp;Country=&amp;Region=&amp;Scheme=3&amp;Site=DOMAIN.COM&a
mp;Path=PATH/TO/FILE.zip&amp;R=0&amp;Advanced=1&amp;Checksum=&amp;BPS=0&amp;
V=7.5.1.6&amp;">here</a></body>HTTP/1.1 200 OK
Connection: close
Date: Thu, 05 Jan 2006 19:02:50 GMT
X-Powered-By: ASP.NET

##REQUEST###################################################################
##############
GET
/cgi-bin/FilenameSearch.dll?ver5?Filename=filename.ZIP&Size=-1&Country=&Regi
on=&Scheme=3&Site=domain.com&Path=path/to/file.zip&R=0&Advanced=1&Checksum=&
BPS=0&V=7.5.1.6& HTTP/1.1
Host: 212.143.22.90
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; es-AR; rv:1.8)
Gecko/20051111 Firefox/1.5
Accept:
text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=
0.8,image/png,*/*;q=0.5
Accept-Language: es-ar,es;q=0.8,en-us;q=0.5,en;q=0.3
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Keep-Alive: 300
Proxy-Connection: keep-alive

###RESPONSE#################################################################
##############

HTTP/1.1 200 OK
Connection: close
Date: Thu, 05 Jan 2006 19:03:38 GMT
X-Powered-By: ASP.NET
<?xml version="1.0"?>
<RES>
<URLLIST>
</URLLIST>
<MISC>
<TOTALRETURNEDRESULTS> 0 </TOTALRETURNEDRESULTS>
<SEARCHTIME> 0</SEARCHTIME>
<COPYRIGHT>Copyright (C) 1999-2003 SpeedBit Ltd. All specifications are
subject to change. All trademarks are the property of their respective
owners</COPYRIGHT>
</MISC><DESCRIPTION/>
</RES>



#############################WINZIP EXAMPLE
##############################################
#############################REQUEST########################################
##############
GET
/cgi-bin/MirrorSearch.dll?ver9?Scheme=3&Site=download.winzip.com&Path=/winzi
p100.exe&Filename=winzip100.exe&Size=4294967295&Pos=0&Country=&Region=&R=0&A
dvanced=1&Checksum=&BPS=0&V=7.5.1.6&DMD=028b05e62dc625aa456c43ac286a9326&D4=
RV9YSQ==&REF=&MID=ezI1Qzk5RjRBLTg5MUItNDUwNC05MEE5LUFDODg0NEY2MjExOH17NjU1NT
k3NEMtN0M4NS00ZTEzLUE5REUtNTBGNzdFRERBMkMyfQ==&SS=&SE=AAwAKgIAAAoAKgQAAB4ALn
EXAB4ABQQAACQALjQnACQAMwQAACYAWwQAACgANwQAASkAN7sEAS8AWwEAAC8AWwIAADEABQQA&S
N=0&SV=3 HTTP/1.1
Host: mirrorsearch.speedbit.com
Accept: */*
User-Agent: DA 7.0 (L0)
Connection: Close
Range: bytes=0-
############################RESPONSE########################################
##############
HTTP/1.1 302 Object Moved
Content-Length: 368
Content-Type: text/html
Location:
http://212.143.22.130/cgi-bin/FilenameSearch.dll?ver5?Filename=WINZIP100.EXE
&Size=-1&Country=&Region=&Scheme=3&Site=download.winzip.com&Path=/winzip100.
exe&R=0&Advanced=1&Checksum=&BPS=0&V=7.5.1.6&
X-Powered-By: ASP.NET
Date: Thu, 05 Jan 2006 19:23:34 GMT
Connection: close

<head><title>Document Moved</title></head>
<body><h1>Object Moved</h1>This document may be found <a
HREF="http://212.143.22.130/cgi-bin/FilenameSearch.dll?ver5?Filename=WINZIP1
00.EXE&amp;Size=-1&amp;Country=&amp;Region=&amp;Scheme=3&amp;Site=download.w
inzip.com&amp;Path=/winzip100.exe&amp;R=0&amp;Advanced=1&amp;Checksum=&amp;B
PS=0&amp;V=7.5.1.6&amp;">here</a></body>HTTP/1.1 200 OK
Connection: close
Date: Thu, 05 Jan 2006 19:23:34 GMT
X-Powered-By: ASP.NET
#############################REQUEST########################################
#############
GET
/cgi-bin/FilenameSearch.dll?ver5?Filename=WINZIP100.EXE&Size=-1&Country=&Reg
ion=&Scheme=3&Site=download.winzip.com&Path=/winzip100.exe&R=0&Advanced=1&Ch
ecksum=&BPS=0&V=7.5.1.6& HTTP/1.1
ost: 212.143.22.130
Accept: */*
User-Agent: DA 7.0
Connection: Close
Range: bytes=0-
Referer:
http://mirrorsearch.speedbit.com/cgi-bin/MirrorSearch.dll?ver9?Scheme=3&Site
=download.winzip.com&Path=/winzip100.exe&Filename=winzip100.exe&Size=4294967
295&Pos=0&Country=&Region=&R=0&Advanced=1&Checksum=&BPS=0&V=7.5.1.6&DMD=028b
05e62dc625aa456c43ac286a9326&D4=RV9YSQ==&REF=&MID=ezI1Qzk5RjRBLTg5MUItNDUwNC
05MEE5LUFDODg0NEY2MjExOH17NjU1NTk3NEMtN0M4NS00ZTEzLUE5REUtNTBGNzdFRERBMkMyfQ
==&SS=&SE=AAwAKgIAAAoAKgQAAB4ALnEXAB4ABQQAACQALjQnACQAMwQAACYAWwQAACgANwQAAS
kAN7sEAS8AWwEAAC8AWwIAADEABQQA&SN=0&SV=3
############################FINAL
RESPONSE################################################


HTTP/1.1 200 OK
Connection: close
Date: Thu, 05 Jan 2006 19:23:53 GMT
X-Powered-By: ASP.NET

<?xml version="1.0"?>
<RES>
<URLLIST>
<URL size="5834344" fullurl
="http://winzip.softonic.com/free_download.phtml?step=down&id_file=9840&dest
url=http%3A%2F%2Fdownload.winzip.com%2Fwinzip100.exe"
checksum="272ca724810e28a8d548988b1b6b8ab1"></URL>
<URL size="5834344" fullurl
="http://chariot.tucows.com/files4/winzip100.exe"
checksum="272ca724810e28a8d548988b1b6b8ab1"></URL>
<URL size="5834344" fullurl
="http://tucows.easynet.net/files4/winzip100.exe"
checksum="272ca724810e28a8d548988b1b6b8ab1"></URL>
<URL size="5834344" fullurl
="http://www.softonic.com/free_download.phtml?step=down&id_file=9840&desturl
=http%3A%2F%2Fdownload.winzip.com%2Fwinzip100.exe"
checksum="272ca724810e28a8d548988b1b6b8ab1"></URL>
<URL size="5834344" fullurl
="http://downloads.pcworld.com/pub/new/utilities/compression/winzip100.exe"
checksum="272ca724810e28a8d548988b1b6b8ab1"></URL>
<URL size="5834344" fullurl
="http://veridas.tucows.com/files4/winzip100.exe"
checksum="272ca724810e28a8d548988b1b6b8ab1"></URL>
<URL size="5834344" fullurl
="http://descargas.entrebits.com/d1/100/1/15869/winzip100.exe"
checksum="bca5affe0259f4ff71c1c70ffa3af857"></URL>
<URL size="5834344" fullurl
="http://web.volftp.tiscali.it/pub/pc/windows/win98/utility/packing/zip/winz
ip100.exe" checksum="bca5affe0259f4ff71c1c70ffa3af857"></URL>
<URL size="5834344" fullurl ="http://dl.winzip.com/winzip100.exe"
checksum="272ca724810e28a8d548988b1b6b8ab1"></URL>
<URL size="5834344" fullurl
="http://linux4.wekanet-team.de/download/306/winzip100.exe"
checksum="bca5affe0259f4ff71c1c70ffa3af857"></URL>
<URL size="5834344" fullurl
="http://www.popularshareware.com/load.asp?item=&url=http://download.winzip.
com/winzip100.exe" checksum="272ca724810e28a8d548988b1b6b8ab1"></URL>
<URL size="5834344" fullurl
="http://www.uptodown.com/?redirecc=http://download.winzip.com/winzip100.exe
" checksum="272ca724810e28a8d548988b1b6b8ab1"></URL>
<URL size="3851880" fullurl ="http://download.winzip.com/ngs/winzip100.exe"
checksum="960f58327e1d9fb8b4a978fb2445988f"></URL>
<URL size="5834344" fullurl ="http://www.salem.ps/Pages/page7/winzip100.exe"
checksum="272ca724810e28a8d548988b1b6b8ab1"></URL>
<URL size="5834344" fullurl
="http://aspect1.tucows.com/files4/winzip100.exe"
checksum="272ca724810e28a8d548988b1b6b8ab1"></URL>
<URL size="5834344" fullurl
="http://bbo-windows.tucows.com/files4/winzip100.exe"
checksum="272ca724810e28a8d548988b1b6b8ab1"></URL>
<URL size="5834344" fullurl ="http://tucows.tierra.net/files4/winzip100.exe"
checksum="272ca724810e28a8d548988b1b6b8ab1"></URL>
<URL size="5834344" fullurl
="http://www.wilkinsonpc.com.co/cgi-bin/click/clickandgo.cgi?id=WinZip&url=h
ttp://download.winzip.com/winzip100.exe"
checksum="272ca724810e28a8d548988b1b6b8ab1"></URL>
<URL size="5834344" fullurl
="http://forthnet.tucows.com/files4/winzip100.EXE"
checksum="bca5affe0259f4ff71c1c70ffa3af857"></URL>
<URL size="5834344" fullurl
="http://power-net.tucows.com/files4/winzip100.EXE"
checksum="bca5affe0259f4ff71c1c70ffa3af857"></URL>
<URL size="5834344" fullurl
="http://linkdotnet.tucows.com/files4/winzip100.exe"
checksum="272ca724810e28a8d548988b1b6b8ab1"></URL>
<URL size="5834344" fullurl
="ftp://sunsite.icm.edu.pl/./vol/wojsyl/simtelnet/win95/compress/winzip100.e
xe"></URL>
<URL size="5834344" fullurl
="ftp://sunsite.cnlab-switch.ch/mirror/winsite/win95/dskutil/winzip100.exe">
</URL>
<URL size="5834344" fullurl
="ftp://sunsite.cnlab-switch.ch/mirror/simtelnet/win95/compress/winzip100.ex
e"></URL>
<URL size="5834344" fullurl
="ftp://nic.funet.fi/pub/mirrors/simtel.net/pub/simtelnet/win95/compress/win
zip100.exe"></URL>
<URL size="5834344" fullurl
="ftp://nic.funet.fi/pub/mirrors/ftp.simtel.net/pub/simtelnet/win95/compress
/winzip100.exe"></URL>
<URL size="5834344" fullurl
="ftp://mirrors.pandora.be/mirrors1/tucows/files4/winzip100.exe"></URL>
<URL size="5834344" fullurl
="ftp://gd.tuwien.ac.at/./zz4/pc/simtelnet/win95/compress/winzip100.exe"></U
RL>
<URL size="5834344" fullurl
="ftp://ftp.zcu.cz/./pub/win/winsite/win95/dskutil/winzip100.exe"></URL>
<URL size="5834344" fullurl
="ftp://ftp.wantree.com.au/pub/tucows/windows/files4/winzip100.exe"></URL>
<URL size="5834344" fullurl
="ftp://ftp.utl.pt/ftp/tucows/files4/winzip100.exe"></URL>
<URL size="5834344" fullurl
="ftp://ftp.urc.ac.ru/pub/OS/Windows/archivers/zip/winzip100.exe"></URL>
<URL size="5834344" fullurl
="ftp://ftp.univie.ac.at/mirror/tucows/files4/winzip100.exe"></URL>
<URL size="5834344" fullurl
="ftp://ftp.univie.ac.at/mirror/simtelnet/win95/compress/winzip100.exe"></UR
L>
<URL size="5834344" fullurl
="ftp://ftp.uni-oldenburg.de/misc/ftp.winzip.com/8931/winzip100.exe"></URL>
<URL size="5834344" fullurl
="ftp://ftp.unb.br/./pub/compress/winzip100.exe"></URL>
<URL size="5834344" fullurl
="ftp://ftp.u-aizu.ac.jp/pub/PC/./simtelnet/win95/compress/winzip100.exe"></
URL>
<URL size="5834344" fullurl
="ftp://ftp.tuwien.ac.at/./zz4/pc/simtelnet/win95/compress/winzip100.exe"></
URL>
<URL size="5834344" fullurl
="ftp://ftp.telusplanet.net/./pub/winsite/win95/dskutil/winzip100.exe"></URL
>
<URL size="5834344" fullurl
="ftp://ftp.telusplanet.net/./pub/simtelnet/win95/compress/winzip100.exe"></
URL>
</URLLIST>
<MISC>
<TOTALRETURNEDRESULTS> 40 </TOTALRETURNEDRESULTS>
<SEARCHTIME> 0</SEARCHTIME>
<COPYRIGHT>Copyright (C) 1999-2003 SpeedBit Ltd. All specifications are
subject to change. All trademarks are the property of their respective
owners</COPYRIGHT>
</MISC><DESCRIPTION/>
</RES>

________________________________________
De: bipin gautam [mailto:visitbipin@...mail.com] 
Enviado el: jueves, 05 de enero de 2006 10:38
Para: napa@...uritynation.com
Asunto: RE: Download Accelerator Plus can be tricked to download malicious
file

i figured it out....... DAP searches for mirror from         
mirrorsearch.speedbit.com/



