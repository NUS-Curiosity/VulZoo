
Date: Thu, 02 Nov 2006 22:06:19 +0200
From: Taneli Leppä <taneli@...sman.fi>
To: securfrog@...il.com
Cc: bugtraq@...urityfocus.com
Subject: Re: how to trick most of cms avatar upload filter [exemple for :
 RunCms (PoC)]

Taneli Leppä kirjoitti:
>> then you need to take a good file editor , like: notepad++ (you can 
>> take whatever picture , and edit it without destroying it .)
>> we need to put some php code AFTER the picture code . when  it's done 
>> , try the picture if it still work , if yes , we are ok :).
> This actually seems to work. A quick workaround is to disable PHP in the
> directory where the avatar images are stored (or any user-uploaded files
> for that matter) in Apache:
> 
> <Directory "/var/www/html/forum/avatardir">
>   php_admin_flag engine off
> </Directory>

Actually, your exploit only works if the avatar system strips the
.jpg extension for some reason. Unless you have configured .jpg
as a valid extension to be executed through PHP. But the above
still stands as a valid precaution for user uploaded material.

-- 
   Taneli Leppä         | Crasman Co Ltd
   <taneli@...sman.fi>  | <http://www.crasman.fi/>
