
Date: 18 Nov 2006 09:13:40 -0000
From: admin@...orsecurity.de
To: bugtraq@...urityfocus.com
Subject: [MajorSecurity Advisory #36]dev4u CMS - Multiple SQL Injection
 and Cross Site Scripting Issues

[MajorSecurity Advisory #36]dev4u CMS - Multiple SQL Injection and Cross Site Scripting Issues

Details
=======
Product: dev4u CMS
Security-Risk: moderated
Remote-Exploit: yes
Vendor-URL: http://www.dev4u.de/
Vendor-Status: informed
Advisory-Status: published

Credits
============
Discovered by: David Vieira-Kurz
http://www.majorsecurity.de

Original Advisory:
============
http://www.majorsecurity.de/index_2.php?major_rls=major_rls36

Introduction
============
dev4u CMS is a well known Content Management System.
More Details
============
Cross Site Scripting:
Input passed directly to the "user_name", "passwort" and "go_target" parameter in "index.php" is not properly sanitised before being returned to the user.
This can be exploited to execute arbitrary HTML and script code in a user's browser session in context of an affected site. 

SQL Injection:
Input passed directly to the "seite_id", "gruppe_id.php" and "go_target" parameter in "index.php" is not properly sanitised before being used in a SQL query.
This can be exploited to manipulate SQL queries by injecting arbitrary SQL code.

Fix
===
None known

Solution
=============
Edit the source code to ensure that input is properly sanitised.
You should work with "htmlspecialchars()" or "htmlentities()" php-function to ensure that html tags
are not going to be executed. You should also work with the "intval()" and "mysql_real_escape_string()" or "addslashes()" php-function to ensure that sql statements
can't be delivered over the "get" variables. Further it is recommend to set off the "register globals" option in the
"php.ini" on your webserver.

Example:
$pass = htmlentities($_POST['pass']);
$test = htmlspecialchars($_GET('test'));
$id = intval($_POST['id']);
?>

History/Timeline
================
11.11.2006 discovery of the vulnerabilities
11.11.2006 additional tests with other versions
12.11.2006 contacted the vendor
18.11.2006 advisory is written
18.11.2006 advisory released

MajorSecurity
=======
MajorSecurity is a German penetration testing and security research project
which consists of only one person at the present time.
You can find more Information on the MajorSecurity Project at
http://www.majorsecurity.de/
