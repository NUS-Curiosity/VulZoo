
Date: Tue, 31 Oct 2006 18:35:49 -0500
From: iDefense Labs <labs-no-reply@...fense.com>
To: idlabs-advisories@...fense.com, vulnwatch@...nwatch.org,
	full-disclosure@...ts.grok.org.uk, bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 10.31.06: Sophos Anti-Virus Petite File
 Denial of Service Vulnerability

Sophos Anti-Virus Petite File Denial of Service Vulnerability

iDefense Security Advisory 10.31.06
http://www.idefense.com/intelligence/vulnerabilities/
Oct 31, 2006

I. BACKGROUND

Sophos Anti-Virus is comprehensive scanning solution used to protect
users from viruses, malicious code, ad-ware, trojans, and more. For more
information see their website at http://sophos.com/

II. DESCRIPTION

Remote exploitation of a denial of service vulnerability in version 5.1
of Sophos Anti-Virus could result in unusable system conditions.

The problem manifests itself when the scanning engine encounters an
executable compressed with petite that contains a large number of
sections.

III. ANALYSIS

Successful exploitation would result in the scanning engine attempting
to allocate an extremely large amount of memory resulting in memory
exhaustion on the system in question. The auto-scan features of Sophos
Anti-Virus will attempt to scan files on access.

IV. DETECTION

iDefense has confirmed the existence of this issue with Sophos Anti-Virus
5.1 for Windows as well as version 5 for Linux. It is suspected that
earlier versions and other architectures are also vulnerable.

V. WORKAROUND

iDefense is unaware for any effective workarounds for this issue.

VI. VENDOR RESPONSE

Sophos recommends upgrading to an unaffected version of the scan engine.
For more information consult the following support article.
http://www.sophos.com/support/knowledgebase/article/7609.html

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2006-4839 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

09/15/2006  Initial vendor notification
09/19/2006  Initial vendor response
10/31/2006  Coordinated public disclosure

IX. CREDIT

This vulnerability was reported to iDefense by Damian Put
<pucik@...rflow.pl>.

Get paid for vulnerability research
http://www.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2006 iDefense, Inc.

Permission is granted for the redistribution of this alert electronically.
It may not be edited in any way without the express written consent of
iDefense. If you wish to reprint the whole or any part of this alert in
any other medium other than electronically, please email
customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate at
the time of publishing based on currently available information. Use of
the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on, this
information.


