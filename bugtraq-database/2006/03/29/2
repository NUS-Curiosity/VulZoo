
Date: Sun, 26 Mar 2006 19:26:36 -0500 (EST)
From: "Steven M. Christey" <coley@...re.org>
To: bugtraq@...urityfocus.com
Subject: Re: Sudo tricks



>So, in other words, all you need in order to get root access is a
>rootkit, your shell script, and root access? Ummm... I don't get it.

I was also confused by this.  However, one guess is that by
compromising an unprivileged account and creating command aliases to
run trojaned su and sudo programs, the attacker can hopefully gain
access to another account, then another, etc.  By using these sudo
"privilege chains" the attacker might eventually obtain root access.

This attack would be slightly virus-like in behavior, although local
to the system.  And it might accomplish less, and more slowly, than if
the attacker used some other means to determine the explicit su/sudo
relationships and exploit them directly (e.g. sudo -l to list allowed
commands?)  And this attack sounds like it's entirely dependent on
whether or not such a chain even exists on the system.  Insert
standard text about the likelihood of easier attack vectors here.

Just a guess, though.  Interesting notion of a local-only "virus" to
compromise users on a multi-user system, although it seems like just
another way to exploit trust relationships once you've gained access
to a local account.

- Steve


