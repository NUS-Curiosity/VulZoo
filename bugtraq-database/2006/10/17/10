
Date: 17 Oct 2006 06:43:06 -0000
From: 3cab7cc7@...sg.stevenroddis.com.au
To: bugtraq@...urityfocus.com
Subject: TorrentFlux file Script Insertion

TITLE:
TorrentFlux �file� Script Insertion

CRITICAL:
Moderate

IMPACT:
Cross Site Scripting

WHERE:
>From remote

SOFTWARE:
TorrentFlux 2.x

DESCRIPTION:
I have discovered a vulnerability in TorrentFlux, which can be exploited by malicious users to conduct script insertion attacks.

Input passed to the �file� variable is not properly sanitised before being used. This can be exploited to insert arbitrary HTML and script code, which will be executed in an administrator�s browser session in context of an affected site when the �Activity Log� is viewed. An example is attempting to login with an incorrect username or password. Where the username field of /login.php contains the arbitrary code.

The vulnerability has been confirmed in version 2.1. Other versions may also be affected.

SOLUTION:

Edit the source code to ensure that input is properly sanitised.

/admin.php

Line 338:

$output .= htmlentities($file, ENT_QUOTES); 

ORIGINAL ADVISORY:
http://www.stevenroddis.com.au/2006/10/17/torrentflux-file-script-insertion/
