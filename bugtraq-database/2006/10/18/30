
Date: Wed, 18 Oct 2006 17:35:02 +0200
From: Secunia Research <remove-vuln@...unia.com>
To: vuln@...unia.com
Cc: bugtraq@...urityfocus.com
Subject: Secunia Research: Joomla BSQ Sitestats Script Insertion and SQL
	Injection

====================================================================== 

                   Secunia Research 18/10/2006

      - Joomla BSQ Sitestats Script Insertion and SQL Injection -


====================================================================== 
Table of Contents

Affected Software....................................................1
Severity.............................................................2
Vendor's Description of Software.....................................3
Description of Vulnerability.........................................4
Solution.............................................................5
Time Table...........................................................6
Credits..............................................................7
References...........................................................8
About Secunia........................................................9
Verification........................................................10

====================================================================== 
1) Affected Software 

Joomla BSQ Sitestats 1.8.0 and 2.2.1.

NOTE: Other versions may also be affected.

====================================================================== 
2) Severity 

Rating: Moderately critical
Impact: Cross Site Scripting
        Manipulation of data
Where:  From remote

====================================================================== 
3) Vendor's Description of Software 

"BSQ Sitestats is a site stats module that is lightweight on the front
end but offers both tabular and graphical summaries of site visitors'
sessions on the backend".

Product Link:
http://developer.joomla.org/sf/projects/bsq_sitestats

====================================================================== 
4) Description of Vulnerability

Secunia Research has discovered some vulnerabilities in the BSQ
Sitestats component for Joomla, which can be exploited by malicious
people to conduct script insertion or SQL injection attacks.

1) Input passed via the "HTTP Referer" Header is not properly 
sanitised before being used. This can be exploited to insert arbitrary
HTML and script code, which is executed in an administrative user's
browser session in context of an affected site when the site
statistics are viewed.

2) Input passed via the URI string is not properly sanitised before
being used in SQL queries. This can be exploited to manipulate SQL
queries by injecting arbitrary SQL code.

Successful exploitation requires that "magic_quotes_gpc" is disabled.

====================================================================== 
5) Solution 

Update to version 2.2.2.

====================================================================== 
6) Time Table 

28/09/2006 - Vendor notified.
29/09/2006 - Vendor response.
18/10/2006 - Public disclosure.

====================================================================== 
7) Credits 

Discovered by Sven Krewitt, Secunia Research.

====================================================================== 
8) References

None.

====================================================================== 
9) About Secunia

Secunia offers vulnerability management solutions to corporate
customers with verified and reliable vulnerability intelligence
relevant to their specific system configuration:

http://corporate.secunia.com/

Secunia also provides a publicly accessible and comprehensive advisory
database as a service to the security community and private 
individuals, who are interested in or concerned about IT-security.

http://secunia.com/

Secunia believes that it is important to support the community and to
do active vulnerability research in order to aid improving the 
security and reliability of software in general:

http://corporate.secunia.com/secunia_research/33/

Secunia regularly hires new skilled team members. Check the URL below to
see currently vacant positions:

http://secunia.com/secunia_vacancies/

Secunia offers a FREE mailing list called Secunia Security Advisories:

http://secunia.com/secunia_security_advisories/ 

====================================================================== 
10) Verification 

Please verify this advisory by visiting the Secunia website:
http://secunia.com/secunia_research/2006-65/

Complete list of vulnerability reports published by Secunia Research:
http://secunia.com/secunia_research/

======================================================================



