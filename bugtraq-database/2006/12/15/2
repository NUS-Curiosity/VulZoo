
Date: Thu, 14 Dec 2006 06:58:03 +0100
From: Sune Kloppenborg Jeppesen <jaervosz@...too.org>
To: gentoo-announce@...too.org
Cc: bugtraq@...urityfocus.com, full-disclosure@...ts.grok.org.uk,
	security-alerts@...uxsecurity.com
Subject: [ GLSA 200612-15 ] McAfee VirusScan: Insecure DT_RPATH

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Gentoo Linux Security Advisory                           GLSA 200612-15
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
                                            http://security.gentoo.org/
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  Severity: High
     Title: McAfee VirusScan: Insecure DT_RPATH
      Date: December 14, 2006
      Bugs: #156989
        ID: 200612-15

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Synopsis
========

McAfee VirusScan for Linux is distributed with an insecure DT_RPATH,
potentially allowing a remote attacker to execute arbitrary code.

Background
==========

McAfee VirusScan for Linux is a commercial antivirus solution for
Linux.

Affected packages
=================

    -------------------------------------------------------------------
     Package             /  Vulnerable  /                   Unaffected
    -------------------------------------------------------------------
  1  app-antivirus/vlnx      <= 4510e                      Vulnerable!
    -------------------------------------------------------------------
     NOTE: Certain packages are still vulnerable. Users should migrate
           to another package if one is available or wait for the
           existing packages to be marked stable by their
           architecture maintainers.

Description
===========

Jakub Moc of Gentoo Linux discovered that McAfee VirusScan was
distributed with an insecure DT_RPATH which included the current
working directory, rather than $ORIGIN which was probably intended.

Impact
======

An attacker could entice a VirusScan user to scan an arbitrary file and
execute arbitrary code with the privileges of the VirusScan user by
tricking the dynamic loader into loading an untrusted ELF DSO. An
automated system, such as a mail scanner, may be subverted to execute
arbitrary code with the privileges of the process invoking VirusScan.

Workaround
==========

Do not scan files or execute VirusScan from an untrusted working
directory.

Resolution
==========

As VirusScan verifies that it has not been modified before executing,
it is not possible to correct the DT_RPATH. Furthermore, this would
violate the license that VirusScan is distributed under. For this
reason, the package has been masked in Portage pending the resolution
of this issue.

    # emerge --ask --verbose --unmerge "app-antivirus/vlnx"

References
==========

  [ 1 ] CVE-2006-6474
        http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-6474

Availability
============

This GLSA and any updates to it are available for viewing at
the Gentoo Security Website:

  http://security.gentoo.org/glsa/glsa-200612-15.xml

Concerns?
=========

Security is a primary focus of Gentoo Linux and ensuring the
confidentiality and security of our users machines is of utmost
importance to us. Any security concerns should be addressed to
security@...too.org or alternatively, you may file a bug at
http://bugs.gentoo.org.

License
=======

Copyright 2006 Gentoo Foundation, Inc; referenced text
belongs to its owner(s).

The contents of this document are licensed under the
Creative Commons - Attribution / Share Alike license.

http://creativecommons.org/licenses/by-sa/2.5

Content of type "application/pgp-signature" skipped
