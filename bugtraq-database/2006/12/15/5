
Date: Fri, 15 Dec 2006 16:01:30 +0100
From: <security@...ns.com>
To: "'BugTraq'" <bugtraq@...urityfocus.com>,
	<full-disclosure@...ts.grok.org.uk>
Subject: BitDefender AV Packed PE File Parsing Engine Heap Overflow

n.runs AG					   
http://www.nruns.com/			              security at nruns.com
n.runs-SA-2006.003                                           15-Dec-2006
________________________________________________________________________

Vendor:	               BitDefender, http://www.bitdefender.com
Affected Products:
			BitDefender Antivirus, 
			BitDefender Antivirus Plus, 
			BitDefender Internet Security, 
			BitDefender Mail Protection for Enterprises, 
			BitDefender Online Scanner, 
			BitDefender for ISA Server, 
			BitDefender for MS Exchange 2000, 
			BitDefender for MS Exchange 2003, 
			BitDefender for MS Exchange 5.5
Platforms:
			Fedora, 
			FreeBSD, 
			Mandrake, 
			Red Hat, 
			SUSE, 
			Slackware, 
			Windows 2000, 
			Windows 2003, 
			Windows 98, 
			Windows Me, 
			Windows NT, 
			Windows XP

Vulnerability:         Arbitrary Code Execution (remote) 

________________________________________________________________________

Vendor communication:

  2006/08/24		initial notification of BitDefender 
  2006/08/25		BitDefender Response
  2006/08/26		PGP keys exchange
  2006/08/28		PoC files sent to BitDefender
  2006/08/29		BitDefender confirmed the bug and fixed it.
  2006/08/30		BitDefender released fixes through automatic update.
________________________________________________________________________

Overview:
 
BitDefenderT provides security solutions to satisfy the protection
requirements of today's computing environment, delivering effective threat
management to over 41 million home and corporate users in more than 200
countries.
BitDefender has garnered many awards, accolades and certifications since its
inception in 2001. From the prestigious European IST Prize, to the #1 Best
Buy ranking from PC World, and most recently, the PC World "Best 100
Products of 2006," the Company is enjoying worldwide recognition for its
superior technology and product offering.



Description:
A remotely exploitable vulnerability has been found in the file parsing
engine.

In detail, the following flaw was determined:

- Heap Overflow through Integer Overflow in Packed PE File Parsing

This problem can lead to remote arbitrary code execution if an attacker
carefully crafts a file that exploits the aforementioned vulnerability.

Solution:
The vulnerabilities were reported on August 28 and an update has been issued
on August 29 to solve this vulnerability. The update has been delivered
immediately to all BitDefender users through the regular automatic update
mechanism, so no user action is required.

Note: We would like to thank BitDefender, who were available even during the
weekend to fix the problem, for their quick response. 

________________________________________________________________________

Credit: 
Bugs found by Sergio Alvarez of n.runs AG. 

________________________________________________________________________

References: 
http://www.bitdefender.com/KB323-en--cevakrnl.xmd-vulnerability.html

________________________________________________________________________

The information provided is released by n.runs "as is" without warranty of
any kind. n.runs disclaims all warranties, either express or implied, expect
for the warranties of merchantability. In no eventshall n.runs be liable for
any damages whatsever including direct, indirect, incidental, consequential,
loss of business profits or special damages, even if n.runs has been advised
of the possibility of such damages.
Distribution or Reproduction of the information is provided that the
advisory is not modified in any way.

Copyright 2006 n.runs. All rights reserved. Terms of use.

