
Date: Tue, 30 Nov 2004 17:28:42 +0000
From: Luigi Auriemma <aluigi@...istici.org>
To: bugtraq@...urityfocus.com, bugs@...uritytracker.com,
	news@...uriteam.com, full-disclosure@...ts.netsys.com,
	vuln@...unia.com
Subject: Endless loops in the http-server and pna-proxy modules of Jana
 server 2.4.4



#######################################################################

                             Luigi Auriemma

Application:  Jana server 2
              http://www.janaserver.de
Versions:     <= 2.4.4
Platforms:    Windows
Bug:          endless loops in the http-server and pna-proxy modules
Exploitation: remote
Date:         30 November 2004
Author:       Luigi Auriemma
              e-mail: aluigi@...ervista.org
              web:    http://aluigi.altervista.org


#######################################################################


1) Introduction
2) Bugs
3) The Code
4) Fix


#######################################################################

===============
1) Introduction
===============


Jana server 2 is a Windows server with a lot of modules to handle http,
ftp, mail, proxy and many other protocols.


#######################################################################

=======
2) Bugs
=======


The module http-server (port 2506) doesn't correctly handle too much %
chars with the temporary effect of continuing to allocate and free
memory until it is available and the conseguent CPU at 100%.

The module pna-proxy (port 1090), used to handle Real player requests,
instead is affected by an endless loop that happens when an attacker
specifies a data block size (a 16 bits value) bigger then the data
really sent.

Due to the type of vulnerabilities is possible to completely freeze the
entire server launching the attacks about 15 or more times.


#######################################################################

===========
3) The Code
===========


http://aluigi.altervista.org/poc/janados.zip


#######################################################################

======
4) Fix
======


Version 2.4.5


#######################################################################


--- 
Luigi Auriemma
http://aluigi.altervista.org



