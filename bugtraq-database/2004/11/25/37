
Date: Thu, 25 Nov 2004 22:33:27 +0000
From: James Youngman <bugtraq@...ession.spiral-arm.org>
To: Troy <tjk@...oft.com>
Cc: srevilak@...akeasy.net, parimiv@...haw.com, martin.buchholz@....com,
	levon@...ementarian.org, bugtraq@...urityfocus.com, bug-findutils@....org
Subject: Re: Changes to the filesystem while find is running - comments?


On Thu, Nov 25, 2004 at 02:24:16AM -0800, Troy wrote:

> I don't see any other solution but to save the inode of the
> directory which contains the newly chdir'ed directory. That
> way we can check that when we chdir back out. If it has changed,
> then we know there is a problem and we should abort.

GNU find already does this check.  It verifies that the device number
and inode of the parent directory once it's returned to it in an
upward direction are the same as the saved copy of that information
when find initially left that directory moving downward.  GNU find has
had this feature for years.

In fact, find has to take special steps up update the parent-directory
information when it has found that automount mounted that directory as
find moved downward.  That last feature is new in GNU find 4.2.8.

Regards,
James.

