
Date: Tue, 12 Oct 2004 20:31:28 +0200
From: "Amit Klein (AKsecurity)" <aksecurity@...pop.com>
To: bugtraq@...urityfocus.com
Subject: Microsoft IIS 5.x/6.0 WebDAV (XML parser) attribute blowup DoS


////////////////////////////////////////////////////////////////////
//====================>> Security Advisory <<=====================//
////////////////////////////////////////////////////////////////////

--------------------------------------------------------------------
-----[ IIS 5.x/6.0 WebDAV (XML parser) attribute blowup DoS
--------------------------------------------------------------------

--[ Author: Amit Klein

--[ Release Date: October 12, 2004

--[ Products: 

Microsoft IIS/5.0 (Windows/2000)
Microsoft IIS/5.1 (Windows XP)
Microsoft IIS/6.0 (Windows/2003)

--[ Severity: High

--[ Description

An attacker can craft a malicious WebDAV PROPFIND request, which
uses XML attributes in a way that inflicts a denial of service 
condition on the target machine (IIS web server).
The result of this attack is that the XML parser consumes all the 
CPU resources for a long period of time (from seconds to minutes, 
depending on the size of the payload). In our experiments, we were 
able to send attacks (of few hunderd KBs) that caused the target
machines to consume 100% CPU for several minutes.

--[ Solution

Microsoft security bulletin MS04-030 (October 12th, 2004)
http://www.microsoft.com/technet/security/bulletin/MS04-030.mspx

--[ Acknowledgements
To Ory Segal (Watchfire), for the his help with applying this 
attack to IIS.




