
Date: Fri, 1 Oct 2004 10:37:56 -0700
From: "Marc Maiffret" <mmaiffret@...e.com>
To: <BUGTRAQ@...URITYFOCUS.COM>
Subject: EEYE: RealPlayer pnen3260.dll Heap Overflow


RealPlayer pnen3260.dll Heap Overflow

Release Date:
October 1, 2004

Date Reported:
August 09, 2004

Severity:
High (Remote Code Execution)

Vendor:
RealNetworks

Systems Affected:
Windows:
RealPlayer 10.5 (6.0.12.1040 and earlier)
RealPlayer 10
RealPlayer 8 (Local Playback)
RealOne Player V2
RealOne Player V1

Mac Player:
RealPlayer 10 Beta for Mac OS X (Local Playback)
RealOne Player (Local Playback)

Linux Player:
Linux RealPlayer 10 (Local Playback)
Helix Player (Local Playback)

Overview:
eEye Digital Security has discovered a critical vulnerability in
RealPlayer. The vulnerability allows a remote attacker to reliably
overwrite heap memory with arbitrary data and execute arbitrary code in
the context of the user who executed the player.

This specific flaw exists within the pnen3260.dll file used by
RealPlayer. By specially crafting a malformed .rm movie file along with
a SMIL file, a direct heap overwrite is triggered, and reliable code
execution is then possible.

Technical Details:
The code in pnen3260.dll among other things is responsible for handling
.rm files. The vulnerability is triggered by setting the length field of
the VIDORV30 data chunk to 0xFFFFFFF8 - 0xFFFFFFFF this will cause an
integer overflow which leads to a small block of memory being allocated,
we call this movie from a SMIL file to handle the initial exception,
eventually overflowing the buffer.

Protection:
Retina Network Security Scanner has been updated to identify this
vulnerability.

Vendor Status:
RealNetworks has released a patch for this vulnerability. The patch is
available via the "Check for Update" menu item under Tools on the
RealPlayer menu bar.

Credit:
Discovery: Karl Lynn

Related Links:
Retina Network Security Scanner - Free 15 Day Trial
http://www.eeye.com/html/Products/Retina/download.html

Greetings:
Joel Degan, Mark Dowd, Bruce Felker, Mike Puterbaugh, Las Vegas craps
tables and the coolers.

Copyright (c) 1998-2004 eEye Digital Security
Permission is hereby granted for the redistribution of this alert
electronically. It is not to be edited in any way without express
consent of eEye. If you wish to reprint the whole or any part of this
alert in any other medium excluding electronic medium, please email
alert@...e.com for permission.

Disclaimer
The information within this paper may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are no warranties, implied or express, with regard to this information.
In no event shall the author be liable for any direct or indirect
damages whatsoever arising out of or in connection with the use or
spread of this information. Any use of this information is at the user's
own risk.


