
Date: Wed, 19 May 2004 22:55:33 +0200
From: OpenPKG <openpkg@...npkg.org>
To: bugtraq@...urityfocus.com
Subject: [OpenPKG-SA-2004.024] OpenPKG Security Advisory (neon)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

________________________________________________________________________

OpenPKG Security Advisory                            The OpenPKG Project
http://www.openpkg.org/security.html              http://www.openpkg.org
openpkg-security@...npkg.org                         openpkg@...npkg.org
OpenPKG-SA-2004.024                                          19-May-2004
________________________________________________________________________

Package:             neon, subversion, cadaver, sitecopy, tla
Vulnerability:       remote code execution
OpenPKG Specific:    no

Affected Releases:   Affected Packages:           Corrected Packages:
OpenPKG CURRENT      <= neon-0.24.5-20040414      >= neon-0.24.6-20040519
                     <= subversion-1.0.2-20040518 >= subversion-1.0.3-20040519
                     <= cadaver-0.22.1-20040415   >= cadaver-0.22.2-20040519
                     <= sitecopy-0.13.4-20040416  >= sitecopy-0.13.4-20040519
                     <= tla-1.2-20040416          >= tla-1.2-20040519
OpenPKG 2.0          <= neon-0.24.4-2.0.1         >= neon-0.24.4-2.0.2
                     <= subversion-1.0.0-2.0.1    >= subversion-1.0.0-2.0.2
                     <= cadaver-0.22.0-2.0.1      >= cadaver-0.22.0-2.0.2
                     <= sitecopy-0.13.4-2.0.1     >= sitecopy-0.13.4-2.0.2
OpenPKG 1.3          <= neon-0.24.0-1.3.1         >= neon-0.24.0-1.3.2
                     <= sitecopy-0.13.3-1.3.1     >= sitecopy-0.13.3-1.3.2

Dependent Packages:  none

Description:
  Stefan Esser discovered [1] a vulnerability within a date parsing
  function in the Neon HTTP and WebDAV client library [0]. If a special
  crafted date string is passed to the ne_rfc1036_parse() function it
  may trigger a sscanf() string overflow into static heap variables.
  Exploitability heavily depends on the application linked against
  Neon, but is considered trivial in cases where an out-of-memory
  condition can be triggered, because the overflowing variable is placed
  in front of the Neon out-of-memory callback function pointer. The
  Common Vulnerabilities and Exposures (CVE) project assigned the id
  CAN-2004-0398 [2] to the problem.

  Please check whether you are affected by running "<prefix>/bin/rpm
  -q neon" (respectively for "subversion", "cadaver", "sitecopy" and
  "tla"). If you have one of the packages installed and its version is
  affected (see above), we recommend that you immediately upgrade it
  (see Solution) [3][4].

Solution:
  Select the updated source RPM appropriate for your OpenPKG release
  [5][6][7][8][9], fetch it from the OpenPKG FTP service [11][12] or
  a mirror location, verify its integrity [13], build a corresponding
  binary RPM from it [3] and update your OpenPKG installation by
  applying the binary RPM [4]. For the most recent release OpenPKG 2.0,
  perform the following operations to permanently fix the security
  problem (for other releases adjust accordingly).

  $ ftp ftp.openpkg.org
  ftp> bin
  ftp> cd release/2.0/UPD
  ftp> get neon-0.24.4-2.0.2.src.rpm
  ftp> bye
  $ <prefix>/bin/openpkg rpm -v --checksig neon-0.24.4-2.0.2.src.rpm
  $ <prefix>/bin/openpkg rpm --rebuild neon-0.24.4-2.0.2.src.rpm
  $ su -
  # <prefix>/bin/openpkg rpm -Fvh <prefix>/RPM/PKG/neon-0.24.4-2.0.2.*.rpm

  Additionally, perform similar steps for the "subversion", "cadaver",
  "sitecopy" and "tla" packages.
________________________________________________________________________

References:
  [0]  http://www.webdav.org/neon/
  [1]  http://security.e-matters.de/advisories/062004.html
  [2]  http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-0398
  [3]  http://www.openpkg.org/tutorial.html#regular-source
  [4]  http://www.openpkg.org/tutorial.html#regular-binary
  [5]  ftp://ftp.openpkg.org/release/1.3/UPD/neon-0.24.0-1.3.2.src.rpm
  [6]  ftp://ftp.openpkg.org/release/1.3/UPD/sitecopy-0.13.3-1.3.2.src.rpm
  [7]  ftp://ftp.openpkg.org/release/2.0/UPD/neon-0.24.4-2.0.2.src.rpm
  [8]  ftp://ftp.openpkg.org/release/2.0/UPD/subversion-1.0.0-2.0.2.src.rpm
  [9]  ftp://ftp.openpkg.org/release/2.0/UPD/cadaver-0.22.0-2.0.2.src.rpm
  [10] ftp://ftp.openpkg.org/release/2.0/UPD/sitecopy-0.13.4-2.0.2.src.rpm
  [11] ftp://ftp.openpkg.org/release/1.3/UPD/
  [12] ftp://ftp.openpkg.org/release/2.0/UPD/
  [13] http://www.openpkg.org/security.html#signature
________________________________________________________________________

For security reasons, this advisory was digitally signed with the
OpenPGP public key "OpenPKG <openpkg@...npkg.org>" (ID 63C4CB9F) of the
OpenPKG project which you can retrieve from http://pgp.openpkg.org and
hkp://pgp.openpkg.org. Follow the instructions on http://pgp.openpkg.org/
for details on how to verify the integrity of this advisory.
________________________________________________________________________

-----BEGIN PGP SIGNATURE-----
Comment: OpenPKG <openpkg@...npkg.org>

iD8DBQFAq8mzgHWT4GPEy58RAt4UAJ9Rmkb2p8hUofMJK4D9WdDOvBnUegCgknv5
lfvBQWamox0hDjNA4Wa/uB8=
=fVnD
-----END PGP SIGNATURE-----


