
Date: Fri, 4 Jun 2004 19:24:11 +0000
From: Luigi Auriemma <aluigi@...ervista.org>
To: bugtraq@...urityfocus.com, bugs@...uritytracker.com, news@...uriteam.com,
   full-disclosure@...ts.netsys.com
Subject: Colin McRae Rally 04 broadcast clients crash



#######################################################################

                             Luigi Auriemma

Application:  Colin McRae Rally 04
              http://www.codemasters.com/colinmcraerally04/
Versions:     1.0
Platforms:    Windows
Bug:          bad allocation (?)
Risk:         medium
Exploitation: remote, versus clients (broadcast)
Date:         04 June 2004
Author:       Luigi Auriemma
              e-mail: aluigi@...ervista.org
              web:    http://aluigi.altervista.org


#######################################################################


1) Introduction
2) Bug
3) The Code
4) Fix


#######################################################################

===============
1) Introduction
===============


Colin McRae Rally 04 is the famous rally game developed by Codemasters
and released at the beginning of April 2004.


#######################################################################

======
2) Bug
======


The bug is in a value that the servers send back to the clients when
they enter in the multiplayer menu.
The bugged value is the number of players in the server ("numplayers"),
if it is too high it causes the crash of the client.

Due the location of the bug, any vulnerable client can't play online
because it automatically requests informations to all the online
servers so a single malicious server can passively block the entire
game network.


#######################################################################

===========
3) The Code
===========


http://aluigi.altervista.org/poc/cmr4cdos.zip


#######################################################################

======
4) Fix
======


No fix.
Two months for a patch is not what I mean with "quick fix".
The bug was found just two days after the pubblic release of the game
and quickly noticed to the developers, but no patch has been released
yet.


#######################################################################


--- 
Luigi Auriemma
http://aluigi.altervista.org

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.netsys.com/full-disclosure-charter.html


