
Date: Thu, 10 Jun 2004 15:03:09 +0200
From: Trustix Security Advisor <tsl@...stix.org>
To: bugtraq@...urityfocus.com
Subject: TSLSA-2004-0033 - squid


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- --------------------------------------------------------------------------
Trustix Secure Linux Security Advisory #2004-0033

Package name:      squid
Summary:           buffer overflow
Date:              2004-06-10
Affected versions: Trustix Secure Linux 2.0
                   Trustix Secure Linux 2.1
                   Trustix Secure Enterprise Linux 2

- --------------------------------------------------------------------------
Package description:
  Squid is a high-performance proxy caching server for Web clients,
  supporting FTP, gopher, and HTTP data objects. Unlike traditional
  caching software, Squid handles all requests in a single,
  non-blocking, I/O-driven process. Squid keeps meta data and especially
  hot objects cached in RAM, caches DNS lookups, supports non-blocking
  DNS lookups, and implements negative caching of failed requests.

Problem description:
  Remote exploitation of a buffer overflow vulnerability in Squid Web
  Proxy Cache could allow a remote attacker to execute arbitrary code.
  Squid Web Proxy Cache supports Basic, Digest and NTLM authentication.
  The vulnerability specifically exists within the NTLM authentication
  helper routine, ntlm_check_auth(), located in
  helpers/ntlm_auth/SMB/libntlmssp.c

  The function contains a buffer overflow vulnerability due to a lack of
  bounds checking on the values copied to the 'pass' variable. Both the
  'tmp.str' and 'tmp.l' variables used in the memcpy() call contain
  user-supplied data.

Action:
  We recommend that all systems with this package installed be upgraded.
  Please note that if you do not need the functionality provided by this
  package, you may want to remove it from your system.


Location:
  All Trustix Secure Linux updates are available from
  <URI:http://http.trustix.org/pub/trustix/updates/>
  <URI:ftp://ftp.trustix.org/pub/trustix/updates/>


About Trustix Secure Linux:
  Trustix Secure Linux is a small Linux distribution for servers. With focus
  on security and stability, the system is painlessly kept safe and up to
  date from day one using swup, the automated software updater.


Automatic updates:
  Users of the SWUP tool can enjoy having updates automatically
  installed using 'swup --upgrade'.


Public testing:
  Most updates for Trustix Secure Linux are made available for public
  testing some time before release.
  If you want to contribute by testing the various packages in the
  testing tree, please feel free to share your findings on the
  tsl-discuss mailinglist.
  The testing tree is located at
  <URI:http://tsldev.trustix.org/horizon/>

  You may also use swup for public testing of updates:
  
  site {
      class = 0
      location = "http://tsldev.trustix.org/horizon/rdfs/latest.rdf"
      regexp = ".*"
  }
  

Questions?
  Check out our mailing lists:
  <URI:http://www.trustix.org/support/>


Verification:
  This advisory along with all Trustix packages are signed with the
  TSL sign key.
  This key is available from:
  <URI:http://www.trustix.org/TSL-SIGN-KEY>

  The advisory itself is available from the errata pages at
  <URI:http://www.trustix.org/errata/trustix-2.0/> and
  <URI:http://www.trustix.org/errata/trustix-2.1/>
  or directly at
  <URI:http://www.trustix.org/errata/2004/0033>


MD5sums of the packages:
- --------------------------------------------------------------------------
75935d65dbd350b03ea66624261f6cb8  2.1/rpms/squid-2.5.STABLE5-5tr.i586.rpm
373da7728ac49b4e016a9a65baff787b  2.0/rpms/squid-2.5.STABLE5-0.2tr.i586.rpm
336f51181d8336a72e5e140e95b58a3d  TSEL-2/squid-2.5.STABLE5-5tr.i586.rpm
- --------------------------------------------------------------------------


Trustix Security Team

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.2 (GNU/Linux)

iD8DBQFAyFjki8CEzsK9IksRAsOCAJwKPixfrktQaCETx+DXoSBAQNN0DgCdH2+J
Zqlc2hv7K0ezXW9kYPyE1t0=
=gPAo
-----END PGP SIGNATURE-----


