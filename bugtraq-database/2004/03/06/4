
Date: Sat, 6 Mar 2004 08:28:25 +0100 (CET)
From: joey@...odrom.org (Martin Schulze)
To: bugtraq@...urityfocus.com
Subject: [SECURITY] [DSA 456-1] New Linux 2.2.19 packages fix local root exploit (arm)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- --------------------------------------------------------------------------
Debian Security Advisory DSA 456-1                     security@...ian.org
http://www.debian.org/security/                             Martin Schulze
March 6th, 2004                         http://www.debian.org/security/faq
- --------------------------------------------------------------------------

Package        : kernel-source-2.2.19, kernel-patch-2.2.19-arm, kernel-image-2.2.19-netwinder, kernel-image-2.2.19-riscpc
Vulnerability  : failing function and TLB flush
Problem-Type   : local
Debian-specific: no
CVE ID         : CAN-2004-0077

Paul Starzetz and Wojciech Purczynski of isec.pl discovered a critical
security vulnerability in the memory management code of Linux inside
the mremap(2) system call.  Due to flushing the TLB (Translation
Lookaside Buffer, an address cache) too early it is possible for an
attacker to trigger a local root exploit.

The attack vectors for 2.4.x and 2.2.x kernels are exclusive for the
respective kernel series, though.  We formerly believed that the
exploitable vulnerability in 2.4.x does not exist in 2.2.x which is
still true.  However, it turned out that a second (sort of)
vulnerability is indeed exploitable in 2.2.x, but not in 2.4.x, with a
different exploit, of course.

For the stable distribution (woody) this problem has been fixed in
version 20040303 of 2.2 kernel images for the arm architecture.

For the unstable distribution (sid) this problem will be fixed soon
for the architectures that still ship a 2.2.x kernel package.

We recommend that you upgrade your Linux kernel package.


Upgrade Instructions
- --------------------

wget url
        will fetch the file for you
dpkg -i file.deb
        will install the referenced file.

If you are using the apt-get package manager, use the line for
sources.list as given below:

apt-get update
        will update the internal database
apt-get upgrade
        will install corrected packages

You may use an automated update by adding the resources from the
footer to the proper configuration.


Debian GNU/Linux 3.0 alias woody
- --------------------------------

  Source archives:

    http://master.debian.org/~joey/stuff/2.2.19/kernel-source-2.2.19_2.2.19.1-4woody1.diff.gz
      Size/MD5 checksum:   164319 b9f8b9f3cb28a280475689c370f0c24f
    http://master.debian.org/~joey/stuff/2.2.19/kernel-source-2.2.19_2.2.19.1-4woody1.dsc
      Size/MD5 checksum:      667 c26b92b6c65d339de908d6e656f042fb
    http://master.debian.org/~joey/stuff/2.2.19/kernel-source-2.2.19_2.2.19.1.orig.tar.gz
      Size/MD5 checksum: 19144159 1537932c835e5a01bc2d6c3087706e30

    http://security.debian.org/pool/updates/main/k/kernel-patch-2.2.19-arm/kernel-patch-2.2.19-arm_20040303.dsc
      Size/MD5 checksum:      562 c8e2f35175c7ecba9028db915e37aef4
    http://security.debian.org/pool/updates/main/k/kernel-patch-2.2.19-arm/kernel-patch-2.2.19-arm_20040303.tar.gz
      Size/MD5 checksum:   532339 3b5e94100b2f572db8881b6341bb4757

    http://security.debian.org/pool/updates/main/k/kernel-image-2.2.19-netwinder/kernel-image-2.2.19-netwinder_20040303.dsc
      Size/MD5 checksum:      646 1e9e65289a4dc58ccbf9a075833d687a
    http://security.debian.org/pool/updates/main/k/kernel-image-2.2.19-netwinder/kernel-image-2.2.19-netwinder_20040303.tar.gz
      Size/MD5 checksum:    17807 2eccf623da43a398117926f5cca26774

    http://security.debian.org/pool/updates/main/k/kernel-image-2.2.19-riscpc/kernel-image-2.2.19-riscpc_20040303.dsc
      Size/MD5 checksum:      614 e228e1d3b31b0c4b1abbb792fc4bb781
    http://security.debian.org/pool/updates/main/k/kernel-image-2.2.19-riscpc/kernel-image-2.2.19-riscpc_20040303.tar.gz
      Size/MD5 checksum:    16222 ef1e334b6b9bfb274da499f4890060bf

  Architecture independent components:

    http://master.debian.org/~joey/stuff/2.2.19/kernel-doc-2.2.19_2.2.19.1-4woody1_all.deb
      Size/MD5 checksum:  1101030 58d45db197e8bad9dc95d9b9baf918e8
    http://master.debian.org/~joey/stuff/2.2.19/kernel-source-2.2.19_2.2.19.1-4woody1_all.deb

    http://security.debian.org/pool/updates/main/k/kernel-patch-2.2.19-arm/kernel-patch-2.2.19-arm_20040303_all.deb
      Size/MD5 checksum:   536998 1a1055497278f58956750e45c323a3d6

  ARM architecture:

    http://security.debian.org/pool/updates/main/k/kernel-image-2.2.19-netwinder/kernel-headers-2.2.19_20040303_arm.deb
      Size/MD5 checksum:  1879720 41e8e0e4b2f0797a1ffecd16d47505a1
    http://security.debian.org/pool/updates/main/k/kernel-image-2.2.19-netwinder/kernel-image-2.2.19-netwinder_20040303_arm.deb
      Size/MD5 checksum:  4017076 348d3e5be8f7ee1ac42ee0ad279497db

    http://security.debian.org/pool/updates/main/k/kernel-image-2.2.19-riscpc/kernel-image-2.2.19-riscpc_20040303_arm.deb
      Size/MD5 checksum:  1830102 ce66fad5186658470c0ffaf77f822a4c


  These files will probably be moved into the stable distribution on
  its next revision.

- ---------------------------------------------------------------------------------
For apt-get: deb http://security.debian.org/ stable/updates main
For dpkg-ftp: ftp://security.debian.org/debian-security dists/stable/updates/main
Mailing list: debian-security-announce@...ts.debian.org
Package info: `apt-cache show <pkg>' and http://packages.debian.org/<pkg>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQFASX2YW5ql+IAeqTIRAu2mAJ0RDBmmuJ8b8zwEvAQueMqJr0XdHwCdFuY4
a/Ma0mtIUyIbv94d+Hf7QYo=
=ky8L
-----END PGP SIGNATURE-----



