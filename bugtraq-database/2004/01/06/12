
Date: Tue, 6 Jan 2004 17:02:49 +0100 (CET)
From: joey@...odrom.org (Martin Schulze)
To: bugtraq@...urityfocus.com
Subject: [SECURITY] [DSA 413-1] New Linux 2.4.18 packages fix locate root exploit


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- --------------------------------------------------------------------------
Debian Security Advisory DSA 413-1                     security@...ian.org
http://www.debian.org/security/                             Martin Schulze
January 6th, 2004                       http://www.debian.org/security/faq
- --------------------------------------------------------------------------

Package        : kernel-source-2.4.18, kernel-image-2.4.18-1-i386
Vulnerability  : mising boundary check
Problem-Type   : local
Debian-specific: no
CVE ID         : CAN-2003-0985

Paul Starzetz discovered a flaw in bounds checking in mremap() in the
Linux kernel (present in version 2.2.x, 2.4.x and 2.6.x) which may allow
a local attacker to gain root privileges.

For the stable distribution (woody) this problem has been fixed in
kernel-source version 2.4.18-14.1 and kernel-images versions
2.4.18-12.1 and 2.4.18-5woody6 (bf) for the i386 architecture.

For the unstable distribution (sid) this problem will be fixed soon
with newly uploaded packages.

We recommend that you upgrade your kernel packages.  This problem has
been fixed in the upstream version 2.4.24 as well.


Upgrade Instructions
- --------------------

wget url
        will fetch the file for you
dpkg -i file.deb
        will install the referenced file.

If you are using the apt-get package manager, use the line for
sources.list as given below:

apt-get update
        will update the internal database
apt-get upgrade
        will install corrected packages

You may use an automated update by adding the resources from the
footer to the proper configuration.


Debian GNU/Linux 3.0 alias woody
- --------------------------------

  Source archives:

    http://security.debian.org/pool/updates/main/k/kernel-source-2.4.18/kernel-source-2.4.18_2.4.18-14.1.dsc
      Size/MD5 checksum:      664 fcb4f5a949cd17a2b528762db8c4a33e
    http://security.debian.org/pool/updates/main/k/kernel-source-2.4.18/kernel-source-2.4.18_2.4.18-14.1.diff.gz
      Size/MD5 checksum:    67239 0ff7d0053ffbf71a66290081300ff759
    http://security.debian.org/pool/updates/main/k/kernel-source-2.4.18/kernel-source-2.4.18_2.4.18.orig.tar.gz
      Size/MD5 checksum: 29818323 24b4c45a04a23eb4ce465eb326a6ddf2

    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-image-2.4.18-1-i386_2.4.18-12.1.dsc
      Size/MD5 checksum:     1193 cdce7e12e094de51f0c3e8baf0492bac
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-image-2.4.18-1-i386_2.4.18-12.1.tar.gz
      Size/MD5 checksum:    69900 a8543111fa965097e71112dbd8caa637

    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-i386bf/kernel-image-2.4.18-i386bf_2.4.18-5woody6.dsc
      Size/MD5 checksum:      656 37430a9bacd8c1b814306d2b0e396498
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-i386bf/kernel-image-2.4.18-i386bf_2.4.18-5woody6.tar.gz
      Size/MD5 checksum:    26175 486db2749031dd57f81e70f9a251e452

  Architecture independent components:

    http://security.debian.org/pool/updates/main/k/kernel-source-2.4.18/kernel-doc-2.4.18_2.4.18-14.1_all.deb
      Size/MD5 checksum:  1719652 cb20d668b1600ddcc336c48ccb02f9ca
    http://security.debian.org/pool/updates/main/k/kernel-source-2.4.18/kernel-source-2.4.18_2.4.18-14.1_all.deb
      Size/MD5 checksum: 24132116 8b06d229ce4861b1d4369bc5dec36588

  Intel IA-32 architecture:

    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-headers-2.4.18-1_2.4.18-12.1_i386.deb
      Size/MD5 checksum:  3413108 0a6e3d8c65686ab34ba27e7ed79590e0
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-headers-2.4.18-1-386_2.4.18-12.1_i386.deb
      Size/MD5 checksum:  3505080 ac13ca0a917bf9b3d9499a4cc33f1a5d
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-headers-2.4.18-1-586tsc_2.4.18-12.1_i386.deb
      Size/MD5 checksum:  3505652 7004b821ee15a5ede5ca5e42e8a9593f
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-headers-2.4.18-1-686_2.4.18-12.1_i386.deb
      Size/MD5 checksum:  3505770 5ee1efb1e377e836d4bda9d1dab07cdd
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-headers-2.4.18-1-686-smp_2.4.18-12.1_i386.deb
      Size/MD5 checksum:  3506916 44491cbfac2f95289f79d369c2e21e5e
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-headers-2.4.18-1-k6_2.4.18-12.1_i386.deb
      Size/MD5 checksum:  3505548 67d4e91b95ad433ef9fdcd20d5da7875
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-headers-2.4.18-1-k7_2.4.18-12.1_i386.deb
      Size/MD5 checksum:  3505798 3365e0518af36585927bf2fb16b1f05f
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-image-2.4.18-1-386_2.4.18-12.1_i386.deb
      Size/MD5 checksum:  8797862 ce91d7b108975eb6f6ea0650d26a6f78
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-image-2.4.18-1-586tsc_2.4.18-12.1_i386.deb
      Size/MD5 checksum:  8704152 e9ea2bb7d683421a969af5a25fa43f28
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-image-2.4.18-1-686_2.4.18-12.1_i386.deb
      Size/MD5 checksum:  8703368 37e7ffaf947195805028bc48a116d333
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-image-2.4.18-1-686-smp_2.4.18-12.1_i386.deb
      Size/MD5 checksum:  8959818 a4d75382cc604bc1430311d3202be419
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-image-2.4.18-1-k6_2.4.18-12.1_i386.deb
      Size/MD5 checksum:  8660958 0dc21476d147d35ba5a51c52333a6e5e
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-image-2.4.18-1-k7_2.4.18-12.1_i386.deb
      Size/MD5 checksum:  8863054 1c1e0e73a3a21e83272f066003df8035
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-pcmcia-modules-2.4.18-1-386_2.4.18-12.1_i386.deb
      Size/MD5 checksum:   228474 8aaa36501bd381a9818a2d2d8d0fc442
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-pcmcia-modules-2.4.18-1-586tsc_2.4.18-12.1_i386.deb
      Size/MD5 checksum:   228030 28f38795b063394f3c0d23cce2f34563
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-pcmcia-modules-2.4.18-1-686_2.4.18-12.1_i386.deb
      Size/MD5 checksum:   227470 97220060259b9f992d59a535c95115d6
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-pcmcia-modules-2.4.18-1-686-smp_2.4.18-12.1_i386.deb
      Size/MD5 checksum:   231132 c51bc7868477f35c86c2b8223fa7d955
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-pcmcia-modules-2.4.18-1-k6_2.4.18-12.1_i386.deb
      Size/MD5 checksum:   227126 cfc9d2336a1db612bb9ae26991195ed9
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-pcmcia-modules-2.4.18-1-k7_2.4.18-12.1_i386.deb
      Size/MD5 checksum:   230386 124ee872623959f72c4782ea68b67afb

    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-i386bf/kernel-headers-2.4.18-bf2.4_2.4.18-5woody6_i386.deb
      Size/MD5 checksum:  3410416 8098dd830ebaa8c2ba4f0bb1d28be26e
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-i386bf/kernel-image-2.4.18-bf2.4_2.4.18-5woody6_i386.deb
      Size/MD5 checksum:  6424802 0c281e78d53c6f759a5725d347c894ca


  These files will probably be moved into the stable distribution on
  its next revision.

- ---------------------------------------------------------------------------------
For apt-get: deb http://security.debian.org/ stable/updates main
For dpkg-ftp: ftp://security.debian.org/debian-security dists/stable/updates/main
Mailing list: debian-security-announce@...ts.debian.org
Package info: `apt-cache show <pkg>' and http://packages.debian.org/<pkg>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3 (GNU/Linux)

iD8DBQE/+twpW5ql+IAeqTIRAlgGAJ9nr3X+Z0eTVHE0qRjqa6rL1k39WQCdFuEG
YiCxr2o+kxWbE724tcYwQ6c=
=jbms
-----END PGP SIGNATURE-----



