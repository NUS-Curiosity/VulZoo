
Date: Thu, 22 Jul 2004 16:46:36 +0200
From: OpenPKG <openpkg@...npkg.org>
To: bugtraq@...urityfocus.com
Subject: [OpenPKG-SA-2004.034] OpenPKG Security Advisory (php)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

________________________________________________________________________

OpenPKG Security Advisory                            The OpenPKG Project
http://www.openpkg.org/security.html              http://www.openpkg.org
openpkg-security@...npkg.org                         openpkg@...npkg.org
OpenPKG-SA-2004.034                                          22-Jul-2004
________________________________________________________________________

Package:             php, apache [with_mod_php=yes]
Vulnerability:       cross-site scripting, remote code execution
OpenPKG Specific:    no

Affected Releases:   Affected Packages:        Corrected Packages:
OpenPKG CURRENT      <= php-4.3.7-20040611     >= php-4.3.8-20040714
                     <= apache-1.3.31-20040713 >= apache-1.3.31-20040714
OpenPKG 2.1          none                      N.A.
OpenPKG 2.0          <= php-4.3.4-2.0.0        >= php-4.3.4-2.0.1
                     <= apache-1.3.29-2.0.4    >= apache-1.3.29-2.0.5

Dependent Packages:  none

Description:
  According to a PHP [0] security advisory [1] from Stefan Esser the
  commonly used "memory_limit" functionality in PHP 4.x up to 4.3.7
  under certain conditions allows remote attackers to execute arbitrary
  code by triggering a "memory_limit" abort during execution of the
  zend_hash_init() function. The Common Vulnerabilities and Exposures
  (CVE) project assigned the id CAN-2004-0594 [2] to the problem.

  According to another security advisory [3] from Stefan Esser the
  strip_tags() function in PHP 4.x up to 4.3.7 does not filter NUL
  characters within tag names, allowing dangerous tags to be processed
  by certain web browsers and facilitate the exploitation of cross-site
  scripting (XSS) vulnerabilities. The Common Vulnerabilities and
  Exposures (CVE) project assigned the id CAN-2004-0595 [4] to the
  problem.

  Please check whether you are affected by running "<prefix>/bin/rpm
  -q php". If you have the "php" package installed and its version is
  affected (see above), we recommend that you immediately upgrade it
  (see Solution) [5][6].

Solution:
  Select the updated source RPM appropriate for your OpenPKG release
  [7], fetch it from the OpenPKG FTP service [8] or a mirror location,
  verify its integrity [9], build a corresponding binary RPM from it [5]
  and update your OpenPKG installation by applying the binary RPM [6].
  For the affected release OpenPKG 2.0, perform the following operations
  to permanently fix the security problem (for other releases adjust
  accordingly).

  $ ftp ftp.openpkg.org
  ftp> bin
  ftp> cd release/2.1/UPD
  ftp> get php-4.3.4-2.0.1.src.rpm
  ftp> bye
  $ <prefix>/bin/openpkg rpm -v --checksig php-4.3.4-2.0.1.src.rpm
  $ <prefix>/bin/openpkg rpm --rebuild php-4.3.4-2.0.1.src.rpm
  $ su -
  # <prefix>/bin/openpkg rpm -Fvh <prefix>/RPM/PKG/php-4.3.4-2.0.1.*.rpm
________________________________________________________________________

References:
  [0] http://www.php.net/
  [1] http://security.e-matters.de/advisories/112004.html
  [2] http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-0594
  [3] http://security.e-matters.de/advisories/122004.html
  [4] http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-0595
  [5] http://www.openpkg.org/tutorial.html#regular-source
  [6] http://www.openpkg.org/tutorial.html#regular-binary
  [7] ftp://ftp.openpkg.org/release/2.0/UPD/php-4.3.4-2.0.1.src.rpm
  [8] ftp://ftp.openpkg.org/release/2.0/UPD/
  [9] http://www.openpkg.org/security.html#signature
________________________________________________________________________

For security reasons, this advisory was digitally signed with the
OpenPGP public key "OpenPKG <openpkg@...npkg.org>" (ID 63C4CB9F) of the
OpenPKG project which you can retrieve from http://pgp.openpkg.org and
hkp://pgp.openpkg.org. Follow the instructions on http://pgp.openpkg.org/
for details on how to verify the integrity of this advisory.
________________________________________________________________________

-----BEGIN PGP SIGNATURE-----
Comment: OpenPKG <openpkg@...npkg.org>

iD8DBQFA/9MggHWT4GPEy58RAjUxAJ46ZgHCdPAijcOSW3DYaDXVM1E0ZACgg4oR
cX6Hz0LmxJcVgoHQNvF+SBY=
=uJ3k
-----END PGP SIGNATURE-----


