
Date: 15 Dec 2004 11:08:47 -0000
From: Hongzhen Zhou <felix__zhou@...mail.com>
To: bugtraq@...urityfocus.com
Subject: Re: RICOH Aficio 450/455 PCL 5e Printer ICMP DOS vulnerability


In-Reply-To: <20041214173439.24838.qmail@....securityfocus.com>

Sorry, I forgot something. The below is the correct description.

---------------------------------------
If it receives a icmp packet that:
1. icmp total length is bigger than 28(8 header + 20 data)
2. icmp[0] == 3 (or 4, 11 , 12. other value?)
3. (icmp[9] & 0x05) < 5 -- (ip header length < 5?)
4. icmp[17] == 17 or 6(other value?) -- (protocol field in ip header?)
then it reboots.
---------------------------------------

>
>   RICOH Aficio 450/455 PCL 5e Printer ICMP DOS vulnerability
>
>AUTHOR:
>(Fortinet, inc)
>Hongzhen Zhou<felix__zhou _at_ hotmail _dot_ com>
>
>DATE:
>14/12/2004
>
>PRODUCTS:
>RICOH Aficio 450/455 PCL 5e Printer(SAVIN 9945 DPE/2045 DPE)
>Other RICOH Aficio products (or Toshiba printer products?)may be vulnerable
>
>DETAILS:
>RICOH Aficio 450/455 PCL does not conduct some kinds of ICMP 
>packet properly.
>If it receives a icmp packet that:
>1. icmp total length is bigger than 28(8 header + 20 data)
>2. icmp[0] == 3 (or 4, 11 , 12. other value?)
>3. icmp[17] == 17 or 6(other value?) -- (protocol field in ip header?)
>then it reboots.


