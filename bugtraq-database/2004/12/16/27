
Date: Thu, 16 Dec 2004 22:23:13 +0100
From: OpenPKG <openpkg@...npkg.org>
To: bugtraq@...urityfocus.com
Subject: [OpenPKG-SA-2004.053] OpenPKG Security Advisory (php)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

________________________________________________________________________

OpenPKG Security Advisory                            The OpenPKG Project
http://www.openpkg.org/security.html              http://www.openpkg.org
openpkg-security@...npkg.org                         openpkg@...npkg.org
OpenPKG-SA-2004.053                                          16-Dec-2004
________________________________________________________________________

Package:             php
Vulnerability:       local and remote execution of arbitrary code
OpenPKG Specific:    no

Affected Releases:   Affected Packages:        Corrected Packages:
OpenPKG CURRENT      <= php-4.3.9-20041130     >= php-4.3.10-20041215
                     <= apache-1.3.33-20041215 >= apache-1.3.33-20041215  
OpenPKG 2.2          <= php-4.3.9-2.2.0        >= php-4.3.9-2.2.2
                     <= apache-1.3.31-2.2.1    >= apache-1.3.31-2.2.3    
OpenPKG 2.1          <= php-4.3.8-2.1.2        >= php-4.3.8-2.1.4
                     <= apache-1.3.31-2.1.6    >= apache-1.3.31-2.1.8

Dependent Packages:  none

Description:
  According to a PHP [0] vendor release announcement [1] and a security
  advisory [2] from Stefan Esser of the Hardened-PHP project, several
  very serious security issues were fixed in the 4.3.10 maintenance
  release. The OpenPKG project extracted and backported the fixes.

  Out of bounds memory write access in shmop_write() and integer
  overflow/underflow in pack() and unpack() functions. The Common
  Vulnerabilities and Exposures (CVE) project assigned the candidate id
  CAN-2004-1018 [3] to the problem and later rejected it because it was
  not considered to be a serious security issue.

  Possible information disclosure, double free and negative
  reference index array underflow in deserialization code. The
  Common Vulnerabilities and Exposures (CVE) project assigned the id
  CAN-2004-1019 [4] to the problem.

  The addslashes() function does not escape \0 correctly. The Common
  Vulnerabilities and Exposures (CVE) project assigned the canidate id
  CAN-2004-1020 [5] to the problem and later rejected it because it was
  not considered to be a serious security issue.

  Directory bypass in safe_mode execution. The Common Vulnerabilities
  and Exposures (CVE) project assigned the candidate id CAN-2004-1063
  [6] to the problem and later rejected it because it was not considered
  to be a serious security issue.

  Arbitrary file access through path truncation. The Common
  Vulnerabilities and Exposures (CVE) project assigned the candidate id
  CAN-2004-1064 [7] to the problem and later rejected it because it was
  not considered to be a serious security issue.

  Function exif_read_data() suffers from overflow on long sectionname.
  The Common Vulnerabilities and Exposures (CVE) project assigned the id
  CAN-2004-1065 [8] to the problem.

  The "magic_quotes_gpc" functionality could lead to one level directory
  traversal with file uploads. The Common Vulnerabilities and Exposures
  (CVE) project assigned no id to the problem.

  Please check whether you are affected by running "<prefix>/bin/openpkg
  rpm -q php". If you have the "php" package installed and its version
  is affected (see above), we recommend that you immediately upgrade it
  (see Solution) [9][10].

Solution:
  Select the updated source RPM appropriate for your OpenPKG release
  [11][12], fetch it from the OpenPKG FTP service [13][14] or a mirror
  location, verify its integrity [15], build a corresponding binary RPM
  from it [9] and update your OpenPKG installation by applying the
  binary RPM [10]. For the most recent release OpenPKG 2.2, perform the
  following operations to permanently fix the security problem (for
  other releases adjust accordingly).

  $ ftp ftp.openpkg.org
  ftp> bin
  ftp> cd release/2.2/UPD
  ftp> get php-4.3.9-2.2.2.src.rpm
  ftp> bye
  $ <prefix>/bin/openpkg rpm -v --checksig php-4.3.9-2.2.2.src.rpm
  $ <prefix>/bin/openpkg rpm --rebuild php-4.3.9-2.2.2.src.rpm
  $ su -
  # <prefix>/bin/openpkg rpm -Fvh <prefix>/RPM/PKG/php-4.3.9-2.2.2.*.rpm
________________________________________________________________________

References:
  [0]  http://www.php.net/
  [1]  http://www.php.net/release_4_3_10.php 
  [2]  http://www.hardened-php.net/advisories/012004.txt
  [3]  http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-1018
  [4]  http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-1019
  [5]  http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-1020
  [6]  http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-1063
  [7]  http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-1064
  [8]  http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-1065
  [9]  http://www.openpkg.org/tutorial.html#regular-source
  [10] http://www.openpkg.org/tutorial.html#regular-binary
  [11] ftp://ftp.openpkg.org/release/2.2/UPD/php-4.3.9-2.2.2.src.rpm
  [12] ftp://ftp.openpkg.org/release/2.1/UPD/php-4.3.8-2.1.4.src.rpm
  [13] ftp://ftp.openpkg.org/release/2.2/UPD/
  [14] ftp://ftp.openpkg.org/release/2.1/UPD/
  [15] http://www.openpkg.org/security.html#signature
________________________________________________________________________

For security reasons, this advisory was digitally signed with the
OpenPGP public key "OpenPKG <openpkg@...npkg.org>" (ID 63C4CB9F) of the
OpenPKG project which you can retrieve from http://pgp.openpkg.org and
hkp://pgp.openpkg.org. Follow the instructions on http://pgp.openpkg.org/
for details on how to verify the integrity of this advisory.
________________________________________________________________________

-----BEGIN PGP SIGNATURE-----
Comment: OpenPKG <openpkg@...npkg.org>

iD8DBQFBwfyrgHWT4GPEy58RAl92AKCCyJtcajHH+offSqSYHCTd3EktFgCgq5Np
K7JUISp/AjmwMCN/Gz7og7M=
=2l65
-----END PGP SIGNATURE-----


