
Date: Tue, 10 Aug 2004 18:40:15 +0000
From: Thomas Walpuski <thomas-bugtraq@...roved.org>
To: Neil Gierman <ngierman@...drunn.com>
Cc: Faro Poplar <faropoplar@...oo.com>, bugtraq@...urityfocus.com
Subject: Re: Windows doesn't verify digital signature of CRL files


* Neil Gierman wrote:
> If a person was able to inject a modified CRL into
> that CDP URL, or redirect the client machine to an alternate server for
> LDAP/HTTP CRL download, and CAPI is not validating signatures on CRL's
> then a person could use a revoked certificate for access to systems among
> other things.

You have to distinguish between CRL retrieval (which is not really
critical) and using a CRL in the process of verifying an certificate
chain. 

All parts of Microsoft's CryptoAPI use CertGetCRLFromStore with
CERT_STORE_SIGNATURE_FLAG, i.e. improperly signed CRLs won't be used in
the verification process.

So unless you're using Microsoft's CryptoAPI at a low level and you
don't know what you're doing there is no issue.

Thomas Walpuski


