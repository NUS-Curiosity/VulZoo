
Date: Thu, 5 Aug 2004 15:33:38 -0400
From: "Robillard, Nicolas" <nicolas.robillard@...lavalin.com>
To: bugtraq@...urityfocus.com, cert@...t.org, news@...uriteam.com,
	"vuln@...urity.nnov.ru " <vuln@...urity.nnov.ru>
Subject: Microsoft Internet Explorer 6 Protocol Handler Vulnerability


Description : Protocol Handler allow arbitrary switch to be passed to the
associated program.<BR>
 
Exploit :
 
The protocol handler are defined in HKEY_CLASSES_ROOT. We will use the MMS
protocol for this exemple. In the HKEY_CLASSES_ROOT\MMS\SHELL\OPEN\COMMAND
Registry key you can see that the program associated with the MMS protocol
is called through "C:\Program Files\Windows Media Player\wmplayer.exe" "%L".
(In this cases, this is windows media player).

Now if we pass in to IE this string mms:\\."%20/layout%20c , the "%L" in the
handler will now be  "." /layout c".
The /layout switch will open windows media player in Skin Mode. 


        <A HREF=mms:\\."%20/layout%20c>TRY IT</A>

Of course, the vulnerability is not to open WMP in Skin Mode but it reside
in the hability to pass extra command line switches where only one should be
accepted.


Nicolas Robillard, GSEC
Information Security Advisor, Systems Security Group
Global Information Technologies, SNC-LAVALIN INC.
Tel : (514) 393-8000 Ext. 6289
455 René-Lévesque Blvd. West, Montreal  (QC), Canada  H2Z 1Z3



