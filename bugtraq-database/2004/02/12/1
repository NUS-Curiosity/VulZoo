
Date: 11 Feb 2004 18:56:10 -0000
From: <bool@....net>
To: bugtraq@...urityfocus.com
Subject: Internet Explorer and Microsoft clipboard poor security policy




Overview:

Sensitive information can be unknowingly disclosed through use malicious web coding that exploits Internet Explorer and Microsoft clipboard. Recently, a brief test was run at a large corporation investigating means of execution and resulting security implications. Within this document you will find the code that was used for this research and a suggested solution.

This is not a new problem. A similar hole in IE 5 was documented in March, 1999:

http://www.ntbugtraq.com/default.asp?pid=36&sid=1&A2=ind9903&L=ntbugtraq&F=P&S=&P=6634

And again in January, 2002:

http://www.securityfocus.com/archive/1/250248/2004-02-07/2004-02-13/2 (links are now broken)

Nearly five years later IE still � by default � allows the clipboard to be made public.

Exploit:

I have a very simple example posted: http://www.infinitybit.com/comsec/clippy.html

Results:

Was this material displayed by the previous URL something you wanted to be disclosed publicly? According to our research on approximately 8% of visits by corporate users, those users had sensitive or otherwise embarrassing information stored in their clipboard. 

There is, however, one level of security present. If the element in which the TextRange is being created is non-displayed (having a CSS display property of 'none' or input type="hidden") it will ignore the execCommand("Paste") � though the command will return true regardless. Unfortunately, this is easily overcome by creating the textarea with a width and height of one pixel, or with a visibility of �hidden�.

Solution: 

Users can close this hole by changing the default Internet setting. Preferably, Microsoft should change the default option to prompt on the Internet zone.

To close this hole in ~7 clicks: Tools, Internet Options, Security, Internet Zone, Custom Level, Scripting, Allow paste options via scripting -> Disable.

Credits: Steven Vittitoe and Blake Sterzinger


