
Date: Wed, 23 Oct 2019 09:30:07 GMT
From: matthias.deeg@...s.de
To: bugtraq@...urityfocus.com
Subject: [SYSS-2019-009]: Fujitsu Wireless Keyboard Set LX390 - Missing
 Protection against Replay Attacks (CVE-2019-18199)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Advisory ID: SYSS-2019-009
Product: Wireless Keyboard Set LX390
Manufacturer: Fujitsu
Affected Version(s): Model No. GK381
Tested Version(s): Model No. GK381
Vulnerability Type: Cryptographic Issues (CWE-310)
                    Missing Protection against Replay Attacks
Risk Level: Medium
Solution Status: Open (product reached end-of-life (EOL) in May 2019)
Manufacturer Notification: 2019-03-22
Solution Date: -
Public Disclosure: 2019-10-23
CVE Reference: CVE-2019-18199
Author of Advisory: Matthias Deeg (SySS GmbH)

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Overview:

Fujitsu Wireless Keyboard Set LX390 is a wireless desktop set consisting
of a mouse and a keyboard.

The manufacturer describes the product as follows (see [1, 2]):

"The Wireless Keyboard Set LX390 is an excellent desktop solution for
users with ambition. This durable keyboard set is equipped with secure
2.4 GHz technology and plug and play technology. The elegant mouse
works on most surfaces due to its precise 1000 dpi sensor. It offers
fabulous features and ultra slim, portable design."

Due to an insecure implementation of the data communication, the
wireless keyboard LX390 is vulnerable to replay attacks.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Vulnerability Details:

SySS GmbH found out that the wireless keyboard Fujitsu LX390 is prone to
replay attacks.

An attacker can simply sniff the data packets of the 2.4 GHz radio
communication sent by the keyboard to the receiver (USB dongle) and
replay the recorded communication data at will causing the same effect
as the original data communication.

A replay attack against the keyboard can, for example, be used to gain
unauthorized access to a computer system that is operated with a
vulnerable Fujitsu LX390 keyboard. In this attack scenario, an attacker
records the radio communication during a password-based user
authentication of his or her victim, for instance during a login to the
operating system or during unlocking a screen lock. At an opportune
moment when the victim's computer system is unattended, the attacker
approaches the victim's computer and replays the previously recorded
data communication for the password-based user authentication and
thereby gets unauthorized access to the victim's system.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Proof of Concept (PoC):

SySS GmbH could successfully perform a replay attack as described in the
previous section using a software-defined radio in combination with the
software tool GNU Radio Companion.

It was also possible to perform successful replay attacks using an
in-house developed software tool in combination with the USB radio
dongle Crazyradio PA and the nrf-research-firmware by Bastille Networks
Internet Security written by Marc Newlin (see [3] and [4]).

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Solution:

The Fujitsu Wireless Keyboard Set LX390 reached its end-of-life (EOL) in
May 2019.

Fujitsu has released two new wireless keyboard sets named LX410 [5] and
LX960 [6] that are not affected by the described security issue.

SySS recommends replacing LX390 wireless keyboard sets used in
environments with higher security demands, for instance with one of the
newer successor models LX410 or LX960.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclosure Timeline:

2019-03-22: Vulnerability reported to manufacturer
2019-03-23: Fujitsu confirms receipt of security advisory
2019-04-02: Received question from manufacturer and answered them
2019-04-11: Received further questions from manufacturer
2019-04-18: Answered open questions and postponed disclosure date
2019-10-08: Reminded manufacturer of the upcoming release of the
            security advisory
2019-10-18: Discussed details of coordinated disclosure with manufacturer
2019-10-21: Public release of security advisory

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

References:

[1] Product website for Fujitsu Wireless Keyboard Set LX390 (not available anymore)
    http://www.fujitsu.com/global/products/computing/peripheral/accessories/input-devices/keyboards/keyboard-lx390.html
[2] Data sheet Fujitsu Wireless Keyboard Set LX390
    https://produktinfo.conrad.com/datenblaetter/1300000-1399999/001375431-da-01-en-FUJITSU_DESKTOP_SET_WIREL_LX390_WEISS.pdf
[3] Product website for Crazyradio PA
    https://www.bitcraze.io/crazyradio-pa/
[4] Bastille's nRF24 research firmware and tools
    https://github.com/BastilleResearch/nrf-research-firmware
[5] Product website for Fujitsu Wireless Keyboard Set LX410
    https://www.fujitsu.com/global/products/computing/peripheral/accessories/input-devices/keyboards/keyboard-lx410.html
[6] Product website for Fujitsu Wireless Keyboard Set LX960
    https://www.fujitsu.com/global/products/computing/peripheral/accessories/input-devices/keyboards/keyboard-lx960.html
[7] SySS Security Advisory SYSS-2019-009
    https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2019-009.txt
[8] SySS Responsible Disclosure Policy
    https://www.syss.de/en/responsible-disclosure-policy/

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Credits:

This security vulnerability was found by Matthias Deeg of SySS GmbH.

E-Mail: matthias.deeg (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Matthias_Deeg.asc
Key fingerprint = D1F0 A035 F06C E675 CDB9 0514 D9A4 BF6A 34AD 4DAB

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclaimer:

The information provided in this security advisory is provided "as is" 
and without warranty of any kind. Details of this security advisory may 
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web 
site.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Copyright:

Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEE0fCgNfBs5nXNuQUU2aS/ajStTasFAl2wGtYACgkQ2aS/ajSt
TasSMQ//bCaFN+1NLjXqLWcRfYUcdP+9leDesfPRdEWOuItrLzCxhN3BaSeQJoxc
F/U8jct5qnw7Ybc1NMNlzIMjyqThp00gZkmllLLrhQpmbl88KowrFalhfqnpwvQU
oOemWt0H7RhFpYY9qa+P1ZXQIahziIh9aPbSCXnEjnxBzf+i8kY13xmYJx5j8APY
zoU7IAWU0Ec6LHTZeNfy5KZc7n6jfsFH8qQunoKTzdPvA6VeLav0N/3blYJMWla7
OkOyqm37h7X8wCa16/E5caNTWuPdkXnVORGYk7QgzTk8bOnge+3alFWx5xkH2Chl
JjLu/RijcYauSrk6/TLDQcSk9xAAbPTk3xgbJPmmo6o+TqMp6EbELuSJ+g9i0ItJ
qqPVa/bgGWAS3EQdSLR4BVL7p9mpyajtUiOyonqb14gpNHKl0k8klrv424oBsEqb
XhloBSH5jEvByAch/E8rMuncxXVOvADhDyLZTJ+OXpNdtmKFMg3d5WP7cgArs4b+
sia6aCr2OAp5iXL34nSl9ruQr2UzueMy3SnIgt44EfccwlqvNmb8RRuMfQ0cgBPZ
D8AGupbz6ecLmMyINWA3FTh0i9H1WZUIO0XT3vJsOW+Bg1tglrPQYrASQNi6yz7U
+2j/v0u1/zcHLzwWpdjc982E7fcb/BxRbKY6jfwnyhQSvMAg9Eo=
=ZCt8
-----END PGP SIGNATURE-----
