
Date: Fri, 25 Jan 2008 12:38:27 -0500
From: "Eyal Udassin" <eyal.udassin@...security.com>
To: <bugtraq@...urityfocus.com>
Subject: C4 Security Advisory - GE Fanuc Proficy Information Portal 2.6 Arbitrary File Upload and Execution

Background
-----------------
GE-Fanuc's Proficy Information Portal 2.6 is a web based reporting
application for the SCADA environment. As such it will usually be installed
in a buffer zone between the SCADA and the corporate network, which makes it
a very sensitive application as it can reach both networks.
 
Description
----------------
Any authenticated user can use the "Add WebSource" option to upload any file
(including asp) to the server, to the main virtual directory where it can be
launched by simply requesting it with a web browser. This vulnerability
exists due to a faulty Java RMI call which is associated with the "Add
WebSource" which allows the user to set the name and path of where the file
should be placed, and another parameter is a base64 encoded content for the
file itself.

Impact
----------
An authenticated attacker can compromise the server running Proficy
Information Portal, enabling him to progress to the control/process network.
 
Affected Versions
-------------------------
Proficy Information Portal 2.6
Previous versions may be vulnerable, as they were not tested.
 
Workaround/Fix
-----------------------
Vendor fix will be available by Feb 15th.
A possible workaround is to remove the write permission of the IIS user from
the Proficy directory.
 
Additional Information
-------------------------------
For additional information please contact us at info@...security.com. Note
that we will respond only to verified utility personnel and governmental
agencies.
The CVE identifier assigned to this vulnerability by CERT is CVE-2008-0175
 
Credit
--------
This vulnerability was discovered and exploited by Eyal Udassin of C4.
 
Regards,
 
Eyal Udassin - C4 (Formerly Swift Coders)
33 Jabotinsky St. The Twin Towers #1, Ramat Gan, Israel
eyal.udassin@...security.com / www.c4-security.com
<http://www.c4-security.com/> 
+972-547-684989

