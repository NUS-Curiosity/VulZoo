
Date: Mon, 21 Jan 2008 18:19:02 +0100
From: Florian Weimer <fweimer@....de>
To: David Malone <dwmalone@...hs.tcd.ie>
Cc: Tavis Ormandy <taviso@....lonestar.org>,
	bugtraq@...urityfocus.com
Subject: Re: common dns misconfiguration can lead to "same site" scripting

* David Malone:

> On Mon, Jan 21, 2008 at 09:25:08AM +0100, Florian Weimer wrote:
>
>> | Note that all domains that contain hosts should have a "localhost" A
>> | record in them.
>
>> That RFC was obsoleted by RFC 1912 in 1996, so there's no RFC
>> conformance issue if you omit the domain names.  But it explains why
>> there are so many zones that contain them.
>
> I've always assumed that the reasoning for this is as "localhost"
> looks like an unqualified domain name, the search path in resolv.conf/...
> will be applied.

aProbably.  Most systems used here have got a a "localhost" line in
/etc/hosts, so this doesn't apply.

> Would it make sense to update RFC 2109's rules to special case
> records resolving to 127.0.0.1 or ::1 (or, more generally, any
> address space that is not considered globally unique) unless both
> names resolve to addresses in the same block.

It's usually not such a great idea to encode the IANA allocation
policies into client software.  There are numerous sites that run with
their own address allocation, and this could have an adverse impact on
them.  If intra-prefix attacks are still possible, you don't gain much
from inside attackers, either.

But we steer into the muddy terrain of DNS pinning issues here.  In my
opinion, it's foolish to expect that two networks (or applications)
which are connected through the same web browser can be separated in
any significant way.

-- 
Florian Weimer                <fweimer@....de>
BFK edv-consulting GmbH       http://www.bfk.de/
Kriegsstra√üe 100              tel: +49-721-96201-1
D-76133 Karlsruhe             fax: +49-721-96201-99
