
Date: Sat, 8 Nov 2008 18:54:06 -0700
From: support@...lprog.com
To: bugtraq@...urityfocus.com
Subject: BSOD in Win'2k3, Vista x86 and x64 by nonpriviledged user

BSOD or hard system hang due to race condition in win32k. sys code that processes UnhookWindowsHookEx. Reproduced when thread calls many times UnhookWindowsHookEx in the same time with switching active windows desktop object (SwitchDesktop) from desktop where hooks are unhooked and broadcasting windows messages to windows on that desktop. Sample exploit code can be downloaded from: http://killprog.com/whk.zip Works on Win'2k3 and Vista. XP seems to be immune to this.
