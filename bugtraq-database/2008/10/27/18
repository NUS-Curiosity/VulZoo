
Date: Mon, 27 Oct 2008 15:14:29 -0600
From: krzysztof.kozlowski@...ik.net.pl
To: bugtraq@...urityfocus.com
Subject: Re: MyBB 1.4.2: Multiple Vulnerabilties

And a solution for first bug (XSS):


File: functions.php, function redirect()

FIND:
----------------
function redirect($url, $message="", $title="")
{
global $header, $footer, $mybb, $theme, $headerinclude, $templates, $lang, $plugins;

$redirect_args = array(�url� => &$url, �message� => &$message, �title� => &$title);

$plugins->run_hooks_by_ref(�redirect�, $redirect_args);

if($mybb->input['ajax'])
----------------
REPLACE WITH:
----------------
function redirect($url, $message="", $title="")
{
global $header, $footer, $mybb, $theme, $headerinclude, $templates, $lang, $plugins;

$redirect_args = array(�url� => &$url, �message� => &$message, �title� => &$title);

$plugins->run_hooks_by_ref(�redirect�, $redirect_args);

$url = addslashes($url) ;
if($mybb->input['ajax'])
----------------
