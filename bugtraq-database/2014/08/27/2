
Date: Wed, 27 Aug 2014 13:41:45 +1000
From: paul.szabo@...ney.edu.au
To: bugtraq@...urityfocus.com, fulldisclosure@...lists.org
Subject: Mathematica10.0.0 on Linux /tmp/MathLink vulnerability

The problem reported for Mathematica is present still at version 10.0.0
for the GUI interface (the command-line interface may be "safe").

Cheers,

Paul Szabo   psz@...hs.usyd.edu.au   http://www.maths.usyd.edu.au/u/psz/
School of Mathematics and Statistics   University of Sydney    Australia


---

http://seclists.org/fulldisclosure/2010/May/176
http://seclists.org/fulldisclosure/2012/Apr/157
http://seclists.org/fulldisclosure/2013/Feb/31
http://www.securityfocus.com/archive/1/511298
http://www.securityfocus.com/archive/1/522354
http://www.securityfocus.com/archive/1/525613
http://www.securityfocus.com/bid/40169

Paraphrasing what I wrote on 14 May 2010:

"The world's definitive system for modern technical computing"
http://www.wolfram.com/mathematica/

Mathematica on Linux uses the /tmp/MathLink directory in insecure ways.
Mathematica creates or re-uses an existing /tmp/MathLink directory, and
overwrites files within and follows symlinks. This type of behaviour is
"known unsafe" on multi-user machines e.g. University login servers.
As a classic example of a symlink attack, while a "victim" is running
Mathematica, if an "attacker" uses:

  cd /tmp/MathLink; for x in *; do rm $x; ln -s /home/victim/.bashrc $x; done

then the victim's ~/.bashrc will be clobbered and permissions changed
to wide-open, allowing a complete compromise of the account. (If root
ever uses Mathematica then the damage is greater.)

There is no workaround. - The command-line math interface may be safe.

Notified support@...fram.com on 7 May 2010, was assigned [TS 16194].
