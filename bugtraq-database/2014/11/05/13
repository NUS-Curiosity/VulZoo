
Date: Wed,  5 Nov 2014 12:56:36 +0100 (CET)
From: High-Tech Bridge Security Research <advisory@...ridge.com>
To: bugtraq@...urityfocus.com
Subject: Two Reflected Cross-Site Scripting (XSS) Vulnerabilities in Forma Lms

Advisory ID: HTB23226
Product: Forma Lms
Vendor: http://www.formalms.org/
Vulnerable Version(s): 1.2.1 and probably prior
Tested Version: 1.2.1
Advisory Publication:  August 6, 2014  [without technical details]
Vendor Notification: August 6, 2014 
Vendor Patch: November 4, 2014 
Public Disclosure: November 5, 2014 
Vulnerability Type: Cross-Site Scripting [CWE-79]
CVE Reference: CVE-2014-5257
Risk Level: Medium 
CVSSv2 Base Score: 4.3 (AV:N/AC:M/Au:N/C:N/I:P/A:N)
Solution Status: Fixed by Vendor
Discovered and Provided: High-Tech Bridge Security Research Lab ( https://www.htbridge.com/advisory/ ) 

-----------------------------------------------------------------------------------------------

Advisory Details:

High-Tech Bridge Security Research Lab discovered two vulnerabilities in Forma Lms, which can be exploited to perform Cross-Site Scripting (XSS) attacks against vulnerable website.


1) Reflected Cross-Site Scripting (XSS) in Forma Lms: CVE-2014-5257

1.1 The vulnerability exists due to insufficient sanitization of input data passed via the "id_custom" HTTP GET parameter to "/appCore/index.php". A remote attacker can trick a logged-in user to open a specially crafted link and execute arbitrary HTML and script code in browser in context of the vulnerable website. Further exploitation of the vulnerability may allow an attacker to use advanced techniques to gain full control over the browser session and perform arbitrary tasks with privileges of the logged-in user.

The exploitation example below uses the "alert()" JavaScript function to display "immuniweb" word:

http://formalms/appCore/index.php?modname=amanmenu&op=modcustom&id_custom=%22%3E%3Cscript%3Ealert%28/immuniweb/%29;%3C/script%3E

1.2 The vulnerability exists due to insufficient sanitization of input data passed via the "id_game" HTTP GET parameter to "/appCore/index.php". A remote attacker can trick a logged-in user to open a specially crafted link and execute arbitrary HTML and script code in browser in context of the vulnerable website. Further exploitation of the vulnerability may allow an attacker to use advanced techniques to gain full control over the browser session and perform arbitrary tasks with privileges of the logged-in user.

The exploitation example below uses the "alert()" JavaScript function to display "immuniweb" word:

http://formalms/appCore/index.php?r=alms/games/edit&id_game=%22%3E%3Cscript%3Ealert%28/immuniweb/%29;%3C/script%3E



-----------------------------------------------------------------------------------------------

Solution:

Update to Forma Lms 1.2.1 p01

More Information:
http://sourceforge.net/projects/forma/files/version 1.x/

-----------------------------------------------------------------------------------------------

References:

[1] High-Tech Bridge Advisory HTB23226 - https://www.htbridge.com/advisory/HTB23226 - Two Reflected Cross-Site Scripting (XSS) Vulnerabilities in Forma Lms.
[2] Forma Lms - http://www.formalms.org/ - Forma.Lms is an open-source, web-based elearning platform (Learning Management System - LMS), used to manage and deliver online training courses.
[3] Common Vulnerabilities and Exposures (CVE) - http://cve.mitre.org/ - international in scope and free for public use, CVE® is a dictionary of publicly known information security vulnerabilities and exposures.
[4] Common Weakness Enumeration (CWE) - http://cwe.mitre.org - targeted to developers and security practitioners, CWE is a formal list of software weakness types.
[5] ImmuniWeb® SaaS - https://www.htbridge.com/immuniweb/ - hybrid of manual web application penetration test and cutting-edge vulnerability scanner available online via a Software-as-a-Service (SaaS) model.

-----------------------------------------------------------------------------------------------

Disclaimer: The information provided in this Advisory is provided "as is" and without any warranty of any kind. Details of this Advisory may be updated in order to provide as accurate information as possible. The latest version of the Advisory is available on web page [1] in the References.

