
Date: Wed,  1 Oct 2014 11:18:15 +0200 (CEST)
From: High-Tech Bridge Security Research <advisory@...ridge.com>
To: bugtraq@...urityfocus.com
Subject: Reflected Cross-Site Scripting (XSS) in Textpattern

Advisory ID: HTB23223
Product: Textpattern
Vendor: http://textpattern.com/
Vulnerable Version(s): 4.5.5 and probably prior
Tested Version: 4.5.5
Advisory Publication:  July 9, 2014  [without technical details]
Vendor Notification: July 9, 2014 
Vendor Patch: September 20, 2014 
Public Disclosure: October 1, 2014 
Vulnerability Type: Cross-Site Scripting [CWE-79]
CVE Reference: CVE-2014-4737
Risk Level: Medium 
CVSSv2 Base Score: 4.3 (AV:N/AC:M/Au:N/C:N/I:P/A:N)
Solution Status: Fixed by Vendor
Discovered and Provided: High-Tech Bridge Security Research Lab ( https://www.htbridge.com/advisory/ ) 

-----------------------------------------------------------------------------------------------

Advisory Details:

High-Tech Bridge Security Research Lab discovered XSS vulnerability in Textpattern, which can be exploited to perform Cross-Site Scripting attacks against users of vulnerable application.

1) Reflected Cross-Site Scripting (XSS) in Textpattern: CVE-2014-4737

The vulnerability exists due to insufficient sanitization of input data passed via URI after "/textpattern/setup/index.php" script that is not deleted by default. 

A remote attacker can trick a logged-in user to open a specially crafted link and execute arbitrary HTML and script code in browser in context of the vulnerable website. Further exploitation of the vulnerability may allow an attacker to perform phishing attacks and potentially gain unauthorized access to the website.

The following exploitation example uses the JavaScript "alert()" function to display "immuniweb" word:

http://[host]/textpattern/setup/index.php/%22%3E%3Cscript%3Ealert%28immuniweb%29;%3C/script%3E/index.php

-----------------------------------------------------------------------------------------------

Solution:

Update to Textpattern 4.5.7

More Information:
http://textpattern.com/weblog/379/textpattern-cms-457-released-ten-years-on

-----------------------------------------------------------------------------------------------

References:

[1] High-Tech Bridge Advisory HTB23223 - https://www.htbridge.com/advisory/HTB23223 - Cross-Site Scripting (XSS) in Textpattern.
[2] Textpattern - http://textpattern.com/ - A flexible, elegant and easy-to-use CMS.
[3] Common Vulnerabilities and Exposures (CVE) - http://cve.mitre.org/ - international in scope and free for public use, CVE® is a dictionary of publicly known information security vulnerabilities and exposures.
[4] Common Weakness Enumeration (CWE) - http://cwe.mitre.org - targeted to developers and security practitioners, CWE is a formal list of software weakness types.
[5] ImmuniWeb® SaaS - https://www.htbridge.com/immuniweb/ - hybrid of manual web application penetration test and cutting-edge vulnerability scanner available online via a Software-as-a-Service (SaaS) model.

-----------------------------------------------------------------------------------------------

Disclaimer: The information provided in this Advisory is provided "as is" and without any warranty of any kind. Details of this Advisory may be updated in order to provide as accurate information as possible. The latest version of the Advisory is available on web page [1] in the References.

