
Date: Wed, 12 Sep 2012 16:40:11 GMT
From: mattijs@...yon.nl
To: bugtraq@...urityfocus.com
Subject: Security Advisory AA-007: Arbitrary File Upload Vulnerability in
 Sitecom Home Storage Center

Security Advisory AA-007: Arbitrary File Upload Vulnerability in Sitecom Home Storage Center

Severity Rating: High
Discovery Date: July 29, 2012
Vendor Notification: July 30, 2012
Disclosure Date: September 11, 2012

Vulnerability Type=
Arbitrary file upload

Impact=
Loss of system integrity

Severity=
Alcyon rates the severity of this vulnerability as high due to the following properties:
- Ease of exploitation;
- No authentication credentials required;
- No knowledge about individual victims required;
- No interaction with the victim required.

Products and firmware versions affected=
- Sitecom MD-253 firmware version up to and including 2.4.17
- Sitecom MD-254 firmware version up to and including 2.4.17
- Possibly other rebranded Mapower network storage products

Risk Assessment=
An attacker can upload arbitrary files to the device. Combining the command injection vulnerability described in advisory AA-008 an attacker can obtain a remote root shell.

Vulnerability=
The CGI executable that is responsible for handling firmware updates allows arbitrary files to be uploaded to the /tmp folder. Furthermore the files are automatically assigned execute permissions and are owned by root.

Proof of Concept Exploit= 
PoC code exploiting this and other vulnerabilities to obtain an interactive root shell can be found here:
  - http://www.alcyon.nl/blog/sitecom-poc-exploit

Risk Mitigation=
At the time of disclosure no updated firmware version was available.

We recommend that you limit access to the web management UI of the device by utilizing proper packet filtering and/or NAT on your router in order to limit network access to your NAS. Note that this will not completely eliminate the risk of exploitation, since the product is affected by other vulnerabilities that can be leveraged using client side attacks.

Vendor responses=
None

Fixed Versions=
There is currently no vendor patch available. A third party solution is available on:
- http://www.alcyon.nl/blog/sitecom-nas-md-253-and-md-254-risk-mitigation/

Latest version of this advisory=
- http://www.alcyon.nl/advisories/aa-007

References=
Security Advisory AA-008: Command Injection Vulnerability in Sitecom Home Storage Center
- http://www.alcyon.nl/advisories/aa-008 
