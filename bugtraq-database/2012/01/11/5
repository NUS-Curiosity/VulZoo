
Date: Wed, 11 Jan 2012 11:50:25 +0100 (CET)
From: advisory@...ridge.ch
To: bugtraq@...urityfocus.com
Subject: Multiple XSS in KnowledgeTree Community Edition

Advisory ID: HTB23065
Reference: https://www.htbridge.ch/advisory/multiple_vulnerabilities_in_knowledgetree_community_edition.html
Product: KnowledgeTree Commercial and Community Editions
Vendor: KnowledgeTree Inc. ( http://knowledgetree.org ) 
Vulnerable Version: 3.7.0.2 and probably prior
Tested Version: 3.7.0.2
Vendor Notification: 21 December 2011 
Vendor Patch: 23 December 2011 
Vulnerability Type: XSS
Status: Fixed by Vendor
Risk Level: Medium 
Credit: High-Tech Bridge SA Security Research Lab ( https://www.htbridge.ch/advisory/ ) 


Advisory Details:

High-Tech Bridge SA Security Research Lab has discovered multiple vulnerabilities in KnowledgeTree Community Edition, which can be exploited to perform cross-site scripting attacks.

Input appended to the URL after multiple files is not properly sanitised before being returned to the user. 
This can be exploited to execute arbitrary HTML and script code in a user's browser session in context of an affected site

The following PoC code is available:

http://[host]/login.php/%22onmouseover=alert%28document.cookie%29;%3E
http://[host]/admin.php/%22onmouseover=alert%28document.cookie%29;%3E
http://[host]/admin.php/%22onmouseover=alert%28document.cookie%29;%3E
http://[host]/preferences.php/%22onmouseover=alert%28document.cookie%29;%3E

Successful exploitation of this vulnerabilities requires that Apache's directive "AcceptPathInfo" is set to "on" or "default" (default value is "default").



Solution:

Apply Vendor patch: 
http://www.knowledgetree.org/Security_advisory:_URL_Manipulation


Disclaimer: Details of this Advisory may be updated in order to provide as accurate information as possible. The latest version of the Advisory is available on the web page in Reference field.

