
Date: Fri, 13 Feb 2015 10:46:52 -0500 (EST)
From: security-alert@...com
To: bugtraq@...urityfocus.com
Subject: [security bulletin] HPSBGN03258 rev.1 - HP Insight Control server deployment Windows Pre-boot Execution Environment, Microsoft Schannel (Winshock) Remote Code Execution

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


Note: the current version of the following document is available here:
https://h20564.www2.hp.com/portal/site/hpsc/public/kb/
docDisplay?docId=emr_na-c04568731

SUPPORT COMMUNICATION - SECURITY BULLETIN

Document ID: c04568731
Version: 1

HPSBGN03258 rev.1 - HP Insight Control server deployment Windows Pre-boot
Execution Environment, Microsoft Schannel (Winshock) Remote Code Execution

NOTICE: The information in this Security Bulletin should be acted upon as
soon as possible.

Release Date: 2015-02-12
Last Updated: 2015-02-12

Potential Security Impact: Multiple vulnerabilities

Source: Hewlett-Packard Company, HP Software Security Response Team

VULNERABILITY SUMMARY
A potential security vulnerability has been identified with HP Insight
Control server deployment Windows Pre-boot Execution Environment that could
be exploited remotely resulting in arbitrary execution of code. This is the
vulnerability known as Winshock.

HP Insight Control server deployment uses the Windows Automated Installation
Kit 2.0 to generate the Windows Pre-boot Execution Environment service
operating system. WAIK 2.0 is vulnerable to CVE-2014-6321 (Microsoft Schannel
Remote Code Execution vulnerability). This bulletin provides instructions to
update the Windows Pre-boot Execution Environment with updates from
Microsoft.

References:

CVE-2014-6321
SSRT101856

SUPPORTED SOFTWARE VERSIONS*: ONLY impacted versions are listed.
HP Insight Control server deployment version 7.3.2 and earlier

BACKGROUND

CVSS 2.0 Base Metrics
===========================================================
  Reference              Base Vector             Base Score
CVE-2014-6321    (AV:N/AC:L/Au:N/C:C/I:C/A:C)       10.0
===========================================================
             Information on CVSS is documented
            in HP Customer Notice: HPSN-2008-002

RESOLUTION

HP has provided the following instructions to resolve this vulnerability.

Follow these steps to update the Microsoft Schannel HP Insight Control server
deployment Windows Pre-boot Execution Environment:

Download the patch for Windows Server 2008 R2 for x64-based Systems Service
Pack 1 from the following location:
http://www.microsoft.com/en-us/download/details.aspx?id=44618

Instructions to modify a Windows image using DISM can be found here:
https://technet.microsoft.com/en-in/library/hh824814.aspx

The following examples use the typical Insight Control server deployment
folder structure to update files in Windows Imaging File Format in Insight
Control server deployment server:

NOTE: The patches must be installed in the following order: KB3018238,
KB2992611

Mount an image:
c:\Program Files (x86)\Altiris\eXpress\Deployment
Server\WAIK\tools\PETools\amd64>Dism /Mount-wim /wimfile:"c:\Program Files
(x86)\Altiris\eXpress\Deployment Server\WAIK\tools\PETools\amd64\winpe.wim"
/index:1 /MountDir:C:\test\offline

NOTE:

C:\test\offline - Temp directory used to mount and update wim file
C:\Program Files (x86)\Altiris\eXpress\Deployment Server\ - Directory where
Insight Control server deployment is Installed.

Add updated package
c:\Program Files (x86)\Altiris\eXpress\Deployment
Server\WAIK\tools\PETools\amd64>dism /image:c:\test\offline /add-package
/PackagePath:"C:\program files"\Windows6.1-KB3018238-x64.msu
/packagepath:"c:\Program Files"\Windows6.1-KB2992611-x64.msu
Unmount an image
c:\Program Files (x86)\Altiris\eXpress\Deployment
Server\WAIK\tools\PETools\amd64>dism /unmount-wim /mountdir:c:\test\offline
/commit
Regenerate Boot Images (WinPE) using PXE Configuration Utility
a. Open the PXE Configuration Utility on the HP Insight Control server
deployment window

b. Check the WinPE option available under Regenerate Boot Images and click on
Regenerate

c. Click on Save and Ok option once regeneration is done.

HISTORY
Version:1 (rev.1) - 12 February 2015 Initial release

Third Party Security Patches: Third party security patches that are to be
installed on systems running HP software products should be applied in
accordance with the customer's patch management policy.

Support: For issues about implementing the recommendations of this Security
Bulletin, contact normal HP Services support channel.  For other issues about
the content of this Security Bulletin, send e-mail to security-alert@...com.

Report: To report a potential security vulnerability with any HP supported
product, send Email to: security-alert@...com

Subscribe: To initiate a subscription to receive future HP Security Bulletin
alerts via Email:
http://h41183.www4.hp.com/signup_alerts.php?jumpid=hpsc_secbulletins

Security Bulletin Archive: A list of recently released Security Bulletins is
available here:
https://h20564.www2.hp.com/portal/site/hpsc/public/kb/secBullArchive/

Software Product Category: The Software Product Category is represented in
the title by the two characters following HPSB.

3C = 3COM
3P = 3rd Party Software
GN = HP General Software
HF = HP Hardware and Firmware
MP = MPE/iX
MU = Multi-Platform Software
NS = NonStop Servers
OV = OpenVMS
PI = Printing and Imaging
PV = ProCurve
ST = Storage Software
TU = Tru64 UNIX
UX = HP-UX

Copyright 2015 Hewlett-Packard Development Company, L.P.
Hewlett-Packard Company shall not be liable for technical or editorial errors
or omissions contained herein. The information provided is provided "as is"
without warranty of any kind. To the extent permitted by law, neither HP or
its affiliates, subcontractors or suppliers will be liable for
incidental,special or consequential damages including downtime cost; lost
profits; damages relating to the procurement of substitute products or
services; or damages for loss of data, or software restoration. The
information in this document is subject to change without notice.
Hewlett-Packard Company and the names of Hewlett-Packard products referenced
herein are trademarks of Hewlett-Packard Company in the United States and
other countries. Other product and company names mentioned herein may be
trademarks of their respective owners.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (GNU/Linux)

iEYEARECAAYFAlTc/1MACgkQ4B86/C0qfVkS1ACfUxFa2XwaopmAFJFhnp58/LDt
qgQAnjQZLKJUuUUMdKxAztw0Vb5Qxhgs
=mELm
-----END PGP SIGNATURE-----
