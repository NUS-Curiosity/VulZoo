
Date: Mon, 24 Aug 2015 14:08:46 GMT
From: erlijn.vangenuchten@...s.de
To: bugtraq@...urityfocus.com
Subject: [SYSS-2015-032] Broken Authentication and Session Management
 (CWE-930) in Page2Flip Premium App 2.5

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Advisory ID: SYSS-2015-032
Product: Page2Flip
Vendor: w!ssenswerft GmbH
Affected Version(s): Premium App 2.5, probably also in Business App 
                     and Basic App, and in lower versions
Tested Version(s): Premium App 2.5
Vulnerability Type: Broken Authentication and Session Management (CWE-930)
Risk Level: High
Solution Status: Open
Vendor Notification: 2015-06-29
Solution Date: 
Public Disclosure: 
CVE Reference: Not yet assigned
Author of Advisory: Dr. Erlijn van Genuchten (SySS GmbH)

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Overview:

With the Page2Flip Web application, it is possible to create e-papers in
PDF format that can be flicked through digitally. Such e-papers can be
used for magazines, catalogues, flyers, etc. (see [1]).

The Page2Flip app allows users to log in with valid credentials, even 
when their user accounts have been deleted.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Vulnerability Details:

The SySS GmbH was as an administrative user able to delete user accounts.
However, these users were after that still able to login with their 
credentials when following the normal login procedure. 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Proof of Concept (PoC):

Create a user account with known credentials, delete this account and 
login with these credentials.

The POST request for deleting a user is:

POST /settings/users HTTP/1.1
Host: [host]
Faces-Request: partial/ajax
Content-Type: application/x-www-form-urlencoded;charset=UTF-8
Content-Length: 1042
Cookie: [cookies]

form_userSettings=form_userSettings&javax.faces.ViewState=-5924384961489816147%3A2243478473205355579&ice.window=9aib95sifa&ice.view=vvgml70e1&icefacesCssUpdates=&form_userSettings%3Aj_idcl=form_userSettings%3AuserTable%3A0%3AdeleteAccount%3Aactionicon&javax.faces.source=form_userSettings%3AuserTable%3A0%3AdeleteAccount%3Aactionicon&javax.faces.partial.event=click&javax.faces.partial.execute=%40all&javax.faces.partial.render=%40all&ice.window=9aib95sifa&ice.view=vvgml70e1&ice.focus=form_userSettings%3AuserTable%3A0%3AdeleteAccount%3Aactionicon&form_userSettings%3AuserTable%3A0%3AdeleteAccount%3Aactionicon=form_userSettings%3AuserTable%3A0%3AdeleteAccount%3Aactionicon&ice.event.target=bimg&ice.event.captured=form_userSettings%3AuserTable%3A0%3AdeleteAccount%3Aactionicon&ice.event.type=onclick&ice.event.alt=false&ice.event.ctrl=false&ice.event.shift=false&ice.event.meta=false&ice.event.x=1368&ice.event.y=373&ice.event.left=true&ice.event.right=false&ice.submit.type=ice.s&ice.sub
 mit.serialization=form&javax.faces.partial.ajax=true

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Solution:


~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclosure Timeline:

2015-06-23: Vulnerability discovered
2013-06-29: Vulnerability reported to vendor
2015-07-07: Reported vulnerabilities again as the vendor did not respond 
            to the first e-mail
2015-07-14: Reminder sent concerning reported vulnerabilities
2015-08-24: Public release of security advisory according to the SySS
            Responsible Disclosure Policy

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

References:

[1] Page2Flip homepage
    http://page2flip.de/
[2] SySS Responsible Disclosure Policy
    https://www.syss.de/en/news/responsible-disclosure-policy/

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Credits:

Security vulnerability found by Responsible Hacker of the SySS GmbH.

E-Mail: erlijn.vangenuchten@...s.de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Erlijn_vanGenuchten.asc
Key ID: 0xBD96FF2A
Key Fingerprint: 17BB 4CED 755A CBB3 2D47 C563 0CA5 8637 BD96 FF2A

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclaimer:

The information provided in this security advisory is provided "as is" 
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Copyright:

Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.e
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCgAGBQJV2x28AAoJEAylhje9lv8q/egP/0vkbb4a+ku5dw/cv9Hx69Ui
H0bdz1OrSrCQ9z1jXH8/b3mps4ZDxV87NNgxFyY0Z2DUp36JEIhdi/GpdgUUFPm4
XIe7J1u3HJ6z4M0PEWrFE/Uwx7stQi3nWAhXKKAL66ZwdT6nKlnHOmGTXf2EggS1
zvmd7nJkMPIfFZ0f1MEbAVMs90ofBqZlTEnB5Nv5sZVHyFnMdTMdfvgp5Xx4kNg/
ZYQqi/v2v3Zj79TfN0GPRJ+iWBfzinMVOnjLIRiX0i5+z99L5sQO7eELmQxiwbcm
4zq3smCGDSprguV5+WBarlH1uNGh+E6Rhfn3GkqkPpK622q6dkRSyzfDZ92Cqc6t
YBLohkR/ypy/HNLOTefG4IOagwWIBzsPlk1W6bMOF1nUdqLW0DqDRsV5Toh2Qv6T
n0ctOhTmEBi1vVGxEzGEjFgqjADuzXWpPVimZ/Zum4v2MgfN3QYAtkLTDaHIZMMB
LOYHUvyJm3okpekqHE2ZzUPA5fYq5L2KeNdOidNM7/oUQHj5WYLmRXUbK5glvU4X
+PTZcA6cxDsoK4rsu7AJR+H1lEEaCVbAP+7NOKi0geuVe98IKxuWU1BFOJiIa2Y8
qCh8Sz8HhzWrJDk81ob3fvFDdGrHuMBETlcs/m7EFPNvJMwkOY3BePAQacz+yGRt
dPO8s21bf54II194Db0a
=jPzu
-----END PGP SIGNATURE-----
