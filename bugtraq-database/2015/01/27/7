
Date: Tue, 27 Jan 2015 10:47:16 GMT
From: matthias.deeg@...s.de
To: bugtraq@...urityfocus.com
Subject: [SYSS-2014-013] FancyFon FAMOC - Use of a One-Way Hash without a Salt

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Advisory ID: SYSS-2014-013
Product(s): FAMOC
Vendor: FancyFon
Affected Version(s): 3.16.5 
Tested Version(s): 3.16.5
Vulnerability Type: Use of a One-Way Hash without a Salt (CWE-759)
Risk Level: Low
Solution Status: Fixed
Vendor Notification: 2014-12-19
Solution Date: 2015-01-23
Public Disclosure: 2015-01-23
CVE Reference: Not yet assigned
Author of Advisory: Matthias Deeg (SySS GmbH)

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Overview:

FAMOC is a mobile device management software by FancyFon supporting
different kinds of mobile devices.

The vendor FancyFon describes the product as follows (see [1]):

"FAMOC is a flexible and open mobile device lifecycle management 
solution, enabling any number of smartphones using a variety of 
operating  systems, to be centrally and remotely managed, over the 
Internet."

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Vulnerability Details:

The SySS GmbH found out that user passwords are stored as raw, unsalted
MD5 hash values in the table tb_user of the database of the FAMOC mobile 
device management software.

The use of a cryptographic one-way hash function MD5 without using a 
salt for storing sensitive data like user passwords allows an attacker
with access to this data to perform efficient password guessing attacks
using pre-computed dictionaries, for instance rainbow tables.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Proof of Concept (PoC):

By having access to the database of the FAMOC mobile device management 
software, for example by exploiting an SQL injection vulnerability, an 
attacker can extract hashed user passwords from the table tb_user, as
the following sqlmap output illustrates:

sql-shell> select pass from tb_user where login='syss'
[10:25:57] [INFO] fetching SQL SELECT statement query output: 'select pass from tb_user where login='syss''
[10:25:57] [INFO] retrieved: 1
[10:26:01] [INFO] retrieving the length of query output
[10:26:01] [INFO] retrieved: 32
[10:26:50] [INFO] retrieved: 3c7bdf8ab364c1ef5c951d1cc5d7239d             
select pass from tb_user where login='syss' [1]:
[*] 3c7bdf8ab364c1ef5c951d1cc5d7239d


The stored user passwords are raw MD5 hashes, as the following output
for the sample password "syss" shows:

$ echo -n "syss" | md5sum
3c7bdf8ab364c1ef5c951d1cc5d7239d  -

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Solution:

Update to FAMOC software version 3.17.4.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclosure Timeline:

2014-12-19: Vulnerability reported to vendor
2014-12-19: Vendor acknowledges e-mail with SySS security advisory
2015-01-16: Contacted vendor for status information about the reported
            vulnerability
2015-01-23: Vendor responds that this security vulnerability was 
            addressed in the FAMOC software version 3.17.4.
            Public release of security advisory
           
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

References:

[1] Product Web Site for FAMOC Mobile Device Management
    http://www.fancyfon.com/

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Credits:

This security vulnerability was found by Matthias Deeg of the SySS GmbH.

E-Mail: matthias.deeg (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Matthias_Deeg.asc
Key fingerprint = 5AE3 96EE A014 FB90 9D81 AF90 8C54 7E88 A34C CED8

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclaimer:

The information provided in this security advisory is provided "as is" 
and without warranty of any kind. Details of this security advisory may 
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web 
site.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Copyright:

Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en

-----BEGIN PGP SIGNATURE-----

iEYEAREKAAYFAlTCLPMACgkQjFR+iKNMztj7jACgje5zL22q1uWID9zIY6qGLfIQ
hFwAn0E1tFAQu+UcxdwO5L8Hs4JNq/o4
=5sjz
-----END PGP SIGNATURE-----
