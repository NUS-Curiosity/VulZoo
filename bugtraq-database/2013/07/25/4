
Date: Wed, 24 Jul 2013 20:25:54 +0100
From: Vulnerability Lab <research@...nerability-lab.com>
To: bugtraq@...urityfocus.com, bugs@...uritytracker.com
Subject: iPic Sharp v1.2.1 Wifi iOS - Persistent Foldername Web Vulnerability

Title:
======
iPic Sharp v1.2.1 Wifi iOS - Persistent Foldername Web Vulnerability


Date:
=====
2013-07-24


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=1031


VL-ID:
=====
1031


Common Vulnerability Scoring System:
====================================
3.6


Introduction:
=============
iPic Sharp Pro is a photos/video management app,can manage your photos/video into folders and subfolders, 
Compress photos/folders into zip file and extract photos from a compressed (zip/rar), Use password protect 
your files, and transfer photos/(zip/rar) between computer and your devices.

Password protect
Password lock entire app
Password lock wifi
Password lock individual folder

View Photos
Photo gallery
Slide show
Thumbnail preview
View Photos app

File Sharing
USB File Sharing via iTunes
Http File Sharing via WiFi, Support Safari, chrome, firefox and IE6/7/8/9 (Slide show )
Chrome and Firefox Supported upload multiple files
Email multiple files, folder Supported

Archives
Extract photos from a compressed zip/rar file
Compression files/folders to zip file
Archives rename, email, batch

( Copy of the Homepge: https://itunes.apple.com/en/app/ipic-sharp-pro/id449820537 )


Abstract:
=========
The Vulnerability Laboratory Research Team discovered a persistent input validation vulnerability in the iPic Sharp v1.2.1 application (Apple iOS - iPad & iPhone).


Report-Timeline:
================
2013-07-24:    Public Disclosure (Vulnerability Laboratory)


Status:
========
Published


Affected Products:
==================
Apple AppStore
Product: iPic Sharp - Application 1.2.1


Exploitation-Technique:
=======================
Local


Severity:
=========
Medium


Details:
========
A persistent input validation web vulnerability is detected  in the iPic Sharp v1.2.1 application (Apple iOS - iPad & iPhone).
The bug allows an attacker (remote) to implement/inject malicious script code to the application side (persistent) of the device.

The vulnerability is located in the index file dir listing module of the web-server (http://localhost:41493) when processing to 
request via POST method local manipulated `album folder names`. The persistent script code will be executed in the main 
index file dir listing module when the service lists the new malicious injected foldername as separate item. Attackers can locally 
change the normal album names inside of the apple iOS device (ipad or iphone) to execute the code when a user is requesting the 
mobile application index with the foldername listing.

Exploitation of the persistent web vulnerability requires low user interaction and a local privilege application & device account.
Successful exploitation of the vulnerability can lead to persistent session hijacking (customers), account steal via persistent 
web attacks, persistent phishing or stable (persistent) certificate mail notification context manipulation.

Vulnerable Application(s):
				[+] iPic Sharp v1.2.1 - ITunes or AppStore (Apple)

Vulnerable Module(s):
				[+] Index

Vulnerable Parameter(s):
				[+] foldername

Affected Module(s):
				[+] Index File Dir - Foldername Listing


Proof of Concept:
=================
The persistent input validation web vulnerability can be exploited by local attackers with low user interaction and no privilege 
mobile web application user account. For demonstration or reproduce ...

PoC: Root Parameter

{'isSecret'0,'isSame'1,'isDelete'0,'guid''136'','albumtype'137,'items'[{'PhotoSharp_System_Photo'[{'name''Camera 
Roll','isdir'1,'id'0,'filesize'0,'modDate''','url''(null)','section''PhotoSharp_System_Photo','localsection''System Photos','ispass'0}]},
{'PhotoSharp_Local_Photo'[{'name''.[PERSISTENT INJECTED SCRIPT CODE!]','isdir'1,'id'0,'filesize'102,'modDate''2013-07-20 
145009','url''','section''PhotoSharp_Local_Photo','localsection''Local Photos','ispass'0}]},
{'PhotoSharp_Local_Document'[{'name''PhotoSharp_Local_Document','isdir'1,'id'0,'filesize'0,'modDate''','url'''
,'section''PhotoSharp_Local_Document','localsection''[PERSISTENT INJECTED SCRIPT CODE!]','ispass'0}]}],'dir''','dirlocal'''}


PoC: Source

<tr><td class="photoTd" classname="photoTd"><div id="PhotoSharp_System_Photo_0" class="watermarkStart" 
classname="watermarkStart"><a href="javascript:loadDir('%2Fu%2FCamera%2520Roll%3FisSystem%3D1','PhotoSharp_System_Photo_0',
'%2Fu%2FCamera%2520Roll');"><img src="iPic%20Sharp_files/Camera%2520Roll_75_75.jpg" id="img_PhotoSharp_System_Photo_0" 
realurl="(null)" class="logoStart" classname="logoStart"></a><span class="spanAlbum" classname="spanAlbum">Camera Roll</span></div></td>
<td class="photoTd" classname="photoTd"><div id="PhotoSharp_Local_Photo_0" class="watermarkStart" classname="watermarkStart">
<a href="javascript:loadDir('%2Fu%2F.Default%2520Album%3FisSystem%3D0','PhotoSharp_Local_Photo_0','%2Fu%2F.[PERSISTENT INJECTED SCRIPT CODE!]');">
<img src="[PERSISTENT INJECTED SCRIPT CODE!]/a.jpg" id="img_PhotoSharp_Local_Photo_0" realurl="" class="logoStart" classname="logoStart"></a>
<span class="spanAlbum" classname="spanAlbum">Default Album</span></div></td><td class="photoTd" classname="photoTd">
<div id="PhotoSharp_Local_Document_0" class="watermarkStart" classname="watermarkStart">
<a href="javascript:loadDir('%2Fu%2FPhotoSharp_Local_Document%3FisSystem%3D0','PhotoSharp_Local_Document_0','%2Fu%2FPhotoSharp_Local_Document');">
<img src="iPic%20Sharp_files/PhotoSharp_Local_Document_75_75.jpg" id="img_PhotoSharp_Local_Document_0" realurl="" 
class="logoStart" classname="logoStart"></a><span class="spanAlbum" classname="spanAlbum">[PERSISTENT INJECTED SCRIPT CODE!]</span></div></td>
<td class="photoTd" classname="photoTd"></td><td class="photoTd" classname="photoTd"></td><td class="photoTd" classname="photoTd"></td>
<td class="photoTd" classname="photoTd"></td><td class="photoTd" classname="photoTd"></td><td class="photoTd" classname="photoTd"></td>
<td class="photoTd" classname="photoTd"></td></tr>


Solution:
=========
The vulnerability can be patched by a secure encoding of the foldername item input.
Encode, Filter or parse also the affected output at the file dir index listing location when processing to display the item foldername.


Risk:
=====
The security risk of the persistent input validation web vulnerability is estimated as medium.


Credits:
========
Vulnerability Laboratory [Research Team] - Benjamin Kunz Mejri (bkm@...lution-sec.com)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases 
or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       - www.evolution-sec.com
Contact:    admin@...nerability-lab.com 	- research@...nerability-lab.com 	       - admin@...lution-sec.com
Section:    www.vulnerability-lab.com/dev 	- forum.vulnerability-db.com 		       - magazine.vulnerability-db.com
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       - youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   - vulnerability-lab.com/rss/rss_news.php

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other 
media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and 
other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), 
modify, use or edit our material contact (admin@...nerability-lab.com or research@...nerability-lab.com) to get a permission.

				Copyright Â© 2013 | Vulnerability Laboratory [Evolution Security]

-- 
VULNERABILITY LABORATORY RESEARCH TEAM
DOMAIN: www.vulnerability-lab.com
CONTACT: research@...nerability-lab.com


