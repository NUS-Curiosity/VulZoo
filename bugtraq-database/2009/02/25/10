
Date: Wed, 25 Feb 2009 19:15:34 +0300
From: Digital Security Research Group <research@...c.ru>
To: bugtraq@...urityfocus.com, vuln@...unia.com,
	packet@...ketstormsecurity.org
Subject: [DSECRG-09-008] JOnAS(4.10.3) - Linked XSS Vulnerability


Digital Security Research Group [DSecRG] Advisory       #DSECRG-09-008
------------------link to original advisory --------------------------
http://www.dsecrg.com/pages/vul/show.php?id=81




Application:                    JOnAS (Java Open Application Server)
Versions Affected:              JOnAS(4.10.3) / Apache Tomcat (5.5.26) 
Vendor URL:                     http://wiki.jonas.objectweb.org/
Bugs:                           Linked XSS
Exploits:                       YES
Reported:                       21.01.2009
Vendor response:                NONE
Second Reported:                29.01.2009
Vendor response:                NONE
Date of Public Advisory:        25.02.2009
Author:                         Digital Security Research Group [DSecRG] (research [at] dsec [dot] ru)



Description
***********

JOnAS is a leading edge Open Source implementation by OW2 of the Java EE specification


Linked XSS vulnerability found in JOnAS  engine.
Using this vulnerabilities attacker can steal admin's cookie and then 
authentificate as administrator or perform certain administrative 
actions.


Details
*******

Linked XSS vulnerabilities found in script ListMBeanDetails.do. vulnerable parameter select.

In normal case "select" parameter looks like this:

select=jonas:j2eeType=EJBModule


when we try to include another variable with te same name, for example like this:


select=jonas:j2eeType=EJBModule,j2eeType=EJBModule


So we will see the error page which will tell us that "j2eeType" variable are also defined.
When we include javascipt code into variable name it will appear in error page:

select=jonas:j2eeType<script>alert()</script>=EJBModule,j2eeType<script>alert()</script>=EJBModule


Example
*******


http://localhost:9000/jonasAdmin/ListMBeanDetails.do?select=jonas%3Aj2eeType<script>alert('DSecRG%20XSS')</script>%3DEJBModule%2Cj2eeType<script>alert('DSecRG%20XSS')</script>%3DEJBModule


Fix Information
***************

No patches aviable.
We did not get any response from vendor for more than 2 weeks. 



About
*****


Digital Security is leading IT security company in Russia, providing information security consulting, audit and penetration testing services, risk analysis and ISMS-related services and certification for ISO/IEC 27001:2005 and PCI DSS standards. Digital Security Research Group focuses on web application and database security problems with vulnerability reports, advisories and whitepapers posted regularly on our website.


Contact:        research [at] dsecrg [dot] com
                http://www.dsecrg.com 
                http://www.dsec.ru











Digital Security Research Group
______________________
DIGITAL SECURITY
phone:  +7 812 703 1547
        +7 812 430 9130
e-mail: research@...crg.com
www.dsecrg.com


-----------------------------------
This message and any attachment are confidential and may be privileged or otherwise protected 
from disclosure. If you are not the intended recipient any use, distribution, copying or disclosure 
is strictly prohibited. If you have received this message in error, please notify the sender immediately 
either by telephone or by e-mail and delete this message and any attachment from your system. Correspondence 
via e-mail is for information purposes only. Digital Security neither makes nor accepts legally binding 
statements by e-mail unless otherwise agreed. 
-----------------------------------      

