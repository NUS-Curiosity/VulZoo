
Date: Thu, 19 Jul 2007 11:44:48 -0400
From: iDefense Labs <labs-no-reply@...fense.com>
To: vulnwatch@...nwatch.org, full-disclosure@...ts.grok.org.uk,
	bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 07.19.07: Opera Software Opera Web Browser
 BitTorrent Dangling Pointer Vulnerability

Opera Software Opera Web Browser BitTorrent Dangling Pointer Vulnerability

iDefense Security Advisory 07.19.07
http://labs.idefense.com/intelligence/vulnerabilities/
Jul 19, 2007

I. BACKGROUND

Opera is a cross-platform web browser. More information is available at
http://www.opera.com/

II. DESCRIPTION

Remote exploitation of a dangling pointer vulnerability in Opera
Software ASA's Opera web browser could allow an attacker to execute
arbitrary code with the privileges of the logged in user.

Opera 9.2 supports BitTorrent downloads. When parsing a specially
crafted BitTorrent header, Opera uses memory that has already been
freed. This can result in an invalid object pointer being dereferenced,
and may allow for the execution of arbitrary code.  The vulnerability is
triggered when the user right clicks on the transfer and removes it.

III. ANALYSIS

Exploitation of this vulnerability allows an attacker to execute
arbitrary code on the affected host with the privileges of the logged
in user.  

The attacker must persuade a vulnerable user into clicking a link to a
BitTorrent file. The targeted user must subsequently remove the entry
from the download pane. The requirement to remove the torrent is not
considered to be a mitigating factor since it is natural for a user to
attempt to do so when a transfer is not progressing.

IV. DETECTION

iDefense has confirmed the existence of this vulnerability in Opera
version 9.21 on Windows. Previous versions may also be affected.

V. WORKAROUND

iDefense is currently unaware of any workarounds for this issue.

VI. VENDOR RESPONSE

Version 9.22 of Opera has been released to address this issue. More
information can be found at the following URL.

http://www.opera.com/support/search/view/862/

VII. CVE INFORMATION

A Mitre Corp. Common Vulnerabilities and Exposures (CVE) number has not
been assigned yet.

VIII. DISCLOSURE TIMELINE

06/06/2007  Initial vendor notification
06/06/2007  Initial vendor response
07/19/2007  Coordinated public disclosure

IX. CREDIT

This vulnerability was reported to iDefense by enhalos.

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2007 iDefense, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDefense. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically,
please e-mail customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
 There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct,
indirect, or consequential loss or damage arising from use of, or
reliance on, this information.
