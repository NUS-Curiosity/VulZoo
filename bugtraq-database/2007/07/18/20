
Date: Wed, 18 Jul 2007 17:08:23 -0400
From: iDefense Labs <labs-no-reply@...fense.com>
To: vulnwatch@...nwatch.org, full-disclosure@...ts.grok.org.uk,
	bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 07.18.07: Ipswitch IMail Server 2006 IMAP
 Search Command Buffer Overflow Vulnerability

Ipswitch IMail Server 2006 Multiple IMAP Buffer Overflow Vulnerabilities

iDefense Security Advisory 07.18.07
http://labs.idefense.com/intelligence/vulnerabilities/
Jul 18, 2007

I. BACKGROUND

Ipswitch Inc.'s IMail Server is an e-mail server aimed at providing
easily configured and maintained e-mail services for small
organizations. More information is available on the vendor's site at
the following URL.

http://ipswitch.com/products/imail/index.asp

II. DESCRIPTION

Remote exploitation of multiple buffer overflow vulnerabilities in
Ipswitch Inc.'s IMail Server 2006 could allow attackers to execute
arbitrary code.

IMail includes an IMAP daemon that users can use to access their email.
The "Search" IMAP command contains an exploitable stack-based buffer
overflow vulnerability. Additionally, the "Search charset" contains an
exploitable heap-based buffer overflow vulnerability.

III. ANALYSIS

Exploitation allows an attacker to execute arbitrary code with SYSTEM
privileges.  

In order to exploit these issues, an attacker would need to login to a
vulnerable IMail IMAP Server using valid credentials.

The vulnerable component is installed with any IPSwitch product that
includes the IMail Server. This includes products such as its
Collaboration Suite packages.

IV. DETECTION

iDefense has confirmed the existence of these vulnerabilities in IMail
Server 2006. The vulnerable executable used was version 6.8.8.1 of
imapd32.exe.

V. WORKAROUND

Disabling the IMAP service prevents exploitation of these
vulnerabilities. Consider enabling POP3 or webmail as an alternative to
IMAP.

VI. VENDOR RESPONSE

Ipswitch Inc. has released version 2006.21 of its IMail product to
address these vulnerabilities. More information can be found at the
following URL.

http://docs.ipswitch.com/IMail%202006.21/ReleaseNotes/IMail_RelNotes.htm#NewRelease

VII. CVE INFORMATION

A Mitre Corp. Common Vulnerabilities and Exposures (CVE) number has not
been assigned yet.

VIII. DISCLOSURE TIMELINE

02/13/2007  Initial vendor notification
07/17/2007  Initial vendor response
07/18/2007  Coordinated public disclosure

IX. CREDIT

The stack-based buffer overflow vulnerability was reported to iDefense
by Manuel Santamarina Suarez. The heap-based buffer overflow discoverer
wishes to remain anonymous.

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2007 iDefense, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDefense. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically,
please e-mail customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
 There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct,
indirect, or consequential loss or damage arising from use of, or
reliance on, this information.
