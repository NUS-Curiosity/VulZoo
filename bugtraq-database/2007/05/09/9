
Date: Wed, 9 May 2007 09:52:13 -0600
From: "M. Burnett" <mb@...o.net>
To: <software@...ks.gov>, <bugtraq@...urityfocus.com>
Subject: RE: RDP TLS downgrade

This is such a widespread problem with so many applications that I always
prefer using STunnel (stunnel.org) rather than an application's built-in SSL
features. Many apps do not properly restrict--despite my many
complaints--the use of insecure ciphers and SSL/TLS versions, they use
self-signed certs, or they require a confusing set up as in the case of RDP.


Stunnel gives you many other features that many apps don't provide such as
the ability to enforce client certs, control the listening IP and port, and
the ability to set any SSL options. And you can easily use the same server
and client certs for all your SSL apps.

RDP's new encryption features are a welcome addition but it's also nice
having the control that stunnel provides. And it's cool knowing that you
need a client cert to connect to my terminal servers. 


Mark Burnett
xato.net





> -----Original Message-----
> From: software@...ks.gov [mailto:software@...ks.gov]
> Sent: Wednesday, May 09, 2007 6:45 AM
> To: bugtraq@...urityfocus.com
> Subject: RDP TLS downgrade
> 
> For those using TLS with Microsoft's Terminal server.
> 
> With Terminal server installed on Windows 2003 Server with current
> service packs and patches it is possible to bypass the server side
> setting that requires SSL with a self-signed cert.
> 
> You will automatically be downgraded to not using TLS and not be
> notified.  The padlock will be missing on the RDP banner.
> 
> Why is this a problem?
> 
> Using a cert and SSL was MS answer to prevent man in the middle attacks
> when using RDP.  You may think that you are protected but you are not.
> 
> This behavior exposes itself when you use the RDP 6.0 client.  Nothing
> else is required.
> 
> I have not tested it with a trusted cert via verisign or others but I
> expect the results will be the same.
> 
> To recreate:  Install MS Windows 2003 server, install Terminal
> services, set the server setting encryption level to high and require
> SSL.
> 
> Use RDP client 5.2, set to no authentication, should fail to connect.
> 
> Use RDP client 6.0 set to always connect even if authetication fails.
> This should bypass the server settings and connect downgraded.
> 
> It is interesting that the client side piece can control the server
> settings....
> 
> MS sec response contacted, did not see it as a problem.

