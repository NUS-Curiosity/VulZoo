
Date: Mon, 24 Dec 2007 15:20:44 +0330
From: admin@...report.ir
To: bugtraq@...urityfocus.com
Subject: PHP <= 5.2.5 Safe Mode Bypass

########################## WwW.BugReport.ir  
#########################################
#
#      AmnPardaz Security Research & Penetration Testing Group
#
# Title: PHP <= 5.2.5 Safe Mode Bypass
# Vendor: http://www.php.net
# Vulnerable Function: tempnam()
# Vulnerable Version: tested on 5.2.5 , 5.2.4 (prior versions also may  
be affected)
# Platform : any
# Exploitation: Local
# Exploit: Available
# Fix Available: No!
###################################################################################

####################
- Description:
####################

"PHP is a widely-used general-purpose scripting language that is  
especially suited for Web development and can be embedded into HTML."

####################
- Vulnerability:
####################

+--> Safe Mode Bypass
string tempnam ( string dir, string prefix )
Creates a file with a unique filename in the specified directory.
Quick review from the source shows that there is open_basedir check but not
Safe mode!
/main/php_open_temporary_file.c
See the related exploit for more details

####################
- POC
####################
http://www.bugreport.ir/?/22/exploit
Original advisory: http://www.bugreport.ir/?/22

####################
- Credit :
####################
AmnPardaz Security Research & Penetration Testing Group
Contact: admin[4t}bugreport{d0t]ir
WwW.BugReport.ir
WwW.AmnPardaz.com



