
Date: Fri, 05 Jan 2007 12:32:13 -0500
From: iDefense Labs <labs-no-reply@...fense.com>
To: vulnwatch@...nwatch.org, full-disclosure@...ts.grok.org.uk,
	bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 01.05.07: Opera Software Opera Web Browser
 JPG Image DHT Marker Heap Corruption Vulnerability

Opera Software Opera Web Browser JPG Image DHT Marker Heap Corruption
Vulnerability

iDefense Security Advisory 01.05.07
http://labs.idefense.com/intelligence/vulnerabilities/
Jan 05, 2007

I. BACKGROUND

Opera is a cross-platform web browser. More information is available at
http://www.opera.com/

II. DESCRIPTION

Remote exploitation of a heap overflow in Opera Software ASA's Opera Web
browser could allow an attacker to execute arbitrary code in the security
context of the current user.

The vulnerability specifically exists due to Opera improperly processing a
JPEG DHT marker. The DHT marker is used to define a Huffman Table which is
used for decoding the image data. An invalid number of index bytes in the
DHT marker will trigger a heap overflow with partially user controlled
data.

III. ANALYSIS

Exploitation of this vulnerability would allow an attacker to execute
arbitrary code on the affected host. The attacker would first need to
construct a website containing the malicious image and trick the vulnerable
user into visiting the site. This would trigger the vulnerability and allow
the code to execute with the privileges of the local user.

IV. DETECTION

iDefense has confirmed the existence of this vulnerability in Opera version
9.02 on both Windows and Linux. Previous versions may also be affected.

V. WORKAROUND

iDefense is currently unaware of any effective workarounds for this issue.

VI. VENDOR RESPONSE

Opera Software has addressed this vulnerability in version 9.10. More
information is available at the following link.

http://www.opera.com/support/search/supsearch.dml?index=852


VII. CVE INFORMATION

A Mitre Corp. Common Vulnerabilities and Exposures (CVE) number has not
been assigned yet.

VIII. DISCLOSURE TIMELINE

11/16/2006  Initial vendor notification
11/17/2006  Initial vendor response
01/05/2007  Coordinated public disclosure

IX. CREDIT

This vulnerability was reported to iDefense by Christoph Diehl.

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2006 iDefense, Inc.

Permission is granted for the redistribution of this alert electronically.
It may not be edited in any way without the express written consent of
iDefense. If you wish to reprint the whole or any part of this alert in
any other medium other than electronically, please e-mail
customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate at
the time of publishing based on currently available information. Use of
the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on, this
information.

