
Date: 19 Feb 2007 18:38:31 -0000
From: poplix@...uasia.org
To: bugtraq@...urityfocus.com
Subject: iTunes remote memory corruption vulnerability

Hi,
iTunes for both macosx and win is prone to a remote memory corruption vulnerability when parsing xml.
iTunes will parse xml when it contacts a touning server which will return the list of radio channels in that format.
To trigger this bug is sufficent to send to iTunes an xml file containing the following lines:

<?die with your boots on?> 
<kb:station_record>
<kb:station_url_record>
</kb:station_url_record>

Unfortunately i dont know how to trigger remote code execution (if it's possible).
Please let me know of someone is able to "do something" with this bug..

Note that iTunes will always contact pri.kts-af.net as touning server so dns spoofing is mandatory to exploit this issue.

Also note that in many cases the bug can be triggered only if iTunes had never parsed a valid xml file.

This bug has been tested against iTunes 7.0.2 on both ppc and intel architectures

cheers
-p
