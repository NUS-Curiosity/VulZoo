
Date: Thu, 01 Feb 2007 12:40:37 +0100
From: Matousec - Transparent security Research <research@...ousec.com>
To: bugtraq@...urityfocus.com
Subject: Comodo Multiple insufficient argument validation of hooked SSDT function
 Vulnerability

Hello,

We would like to inform you about a vulnerability in Comodo Firewall Pro.


Description:

Comodo Firewall Pro (former Comodo Personal Firewall) hooks many functions in SSDT and in at least seven cases it fails 
to validate arguments that come from the user mode. User calls to NtConnectPort (CFP 2.4.16.174 is not affected), 
NtCreatePort (CFP 2.4.16.174 is not affected), NtCreateSection, NtOpenProcess, NtOpenSection, NtOpenThread and 
NtSetValueKey with invalid argument values can cause system crashes because of errors in CFP driver cmdmon.sys. Further 
impacts of this bug (like arbitrary code execution in the kernel mode) were not examined.


Vulnerable software:

     * Comodo Firewall Pro 2.4.16.174
     * Comodo Personal Firewall 2.3.6.81
     * probably all older versions of Comodo Personal Firewall 2
     * possibly older versions of Comodo Personal Firewall


More details and a proof of concept including its source code are available here:
http://www.matousec.com/info/advisories/Comodo-Multiple-insufficient-argument-validation-of-hooked-SSDT-functions.php


Regards,

-- 
Matousec - Transparent security Research
http://www.matousec.com/

