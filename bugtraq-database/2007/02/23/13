
Date: Fri, 23 Feb 2007 02:29:00 +0100 (CET)
From: Michal Zalewski <lcamtuf@...ne.ids.pl>
To: bugtraq@...urityfocus.com
Cc: full-disclosure@...ts.grok.org.uk, security@...illa.org
Subject: MSIE7 browser entrapment vulnerability (probably Firefox, too)

There is a cool combination-type vulnerability in MSIE7 that allows the
attacker to:

  a) Trap the visitor in a Matrix-esque tarpit webpage that cannot be left
     by normal means (this is a known brain-damaged design of onUnload
     Javascript handlers),

  b) Spoof transitions between pages so that the user thinks he actually
     managed to leave the affected site, and so that the URL bar displays
     other addresses we didn't actually go to.

This opens a plethora of spoofing / phishing scenarios, and is generally
quite nasty. More information and a pretty demo is available here:

  http://lcamtuf.coredump.cx/ietrap/

Firefox isn't outright vulnerable to this problem, but judging from its
behavior, it is likely to be susceptible to a variant of this bug (it
exhibits the same behavior, but we end up with a corrupted page instead);
I will research it once I get some sleep.

Cheers,
/mz
