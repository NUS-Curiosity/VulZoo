
Date: 11 Feb 2007 23:20:18 -0000
From: raphael.huck@...e.fr
To: bugtraq@...urityfocus.com
Subject: DotClear Full Path Disclosure Vulnerability

I have contacted the developers 2 weeks ago, still no answer...

Vendor: DotClear
Vulnerable: DotClear 1.2.5 and below
Release Date: 2007-01-28

Full Path Disclosure

This vulnerability affects:
http://www.example.com/dotclear/themes/default/form.php
http://www.example.com/dotclear/themes/default/list.php
http://www.example.com/dotclear/themes/default/post.php
http://www.example.com/dotclear/themes/default/template.php

When they are called, the scripts do not check that they have been called by another page of the blog, so when they are called directly, they disclose the full path of the webroot.

Fatal error: Call to a member function fetch() on a non-object in
/home/users/xxxx/dotclear/themes/xxx/list.php on line 34
	


Solution

Edit the code. 

Advisory

http://zone14.free.fr/advisories/8/
