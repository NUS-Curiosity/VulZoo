
Date: 11 Feb 2007 19:11:57 -0000
From: raphael.huck@...e.fr
To: bugtraq@...urityfocus.com
Subject: MediaWiki Full Path Disclosure Vulnerability

 Vendor: MediaWiki
Vulnerable: MediaWiki 1.9.1 and below
Bugtraq ID:
Secunia Advisory:
Release Date: 2007-01-29

Full Path Disclosure

This vulnerability affects all the default skins:
http://www.example.com/wiki/skins/Simple.deps.php
http://www.example.com/wiki/skins/MonoBook.deps.php
http://www.example.com/wiki/skins/MySkin.deps.php
http://www.example.com/wiki/skins/Chick.deps.php

When they are called, the scripts do not check that they have been called by another page of the wiki, so when they are called directly, they disclose the full path of the webroot, and the directories searched for PHP includes.

Warning: main(includes/SkinTemplate.php): failed to open stream: No such
file or directory in /srv/xxx/xxx/wiki/skins/Simple.deps.php on line 8

Fatal error: main(): Failed opening required 'includes/SkinTemplate.php'
(include_path='.:/usr/share/php:/usr/share/pear') in
/srv/xxx/xxx/wiki/skins/Simple.deps.php on line 8
	


Solution

I've filed the bug (http://bugzilla.wikimedia.org/show_bug.cgi?id=8819), and it has been solved in revision 19681 (http://svn.wikimedia.org/viewvc/mediawiki?view=rev&revision=19681) very quickly. 

Advisory

http://zone14.free.fr/advisories/7/
