
Date: Thu, 27 Sep 2007 15:38:48 -0400
From: iDefense Labs <labs-no-reply@...fense.com>
To: vulnwatch@...nwatch.org, full-disclosure@...ts.grok.org.uk,
	bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 09.27.07: Computer Associates BrightStor
 HSM r11.5 Multiple Vulnerabilities

Computer Associates BrightStor HSM r11.5 Multiple Vulnerabilities

iDefense Security Advisory 09.27.07
http://labs.idefense.com/intelligence/vulnerabilities/
Sep 27, 2007

I. BACKGROUND

Computer Associates BrightStor Hierarchical Storage Manager (HSM) is an
application used to create a tiered storage solution for enterprises
that require on demand access to large quantities of data. The HSM
caches frequently used files on hard drives for fast access, and stores
seldom used files on tape. Access to files stored on tape is transparent
to the client applications. The CsAgent process (CsAgent.exe) is a
component of the HSM suite, and listens on TCP port 2000. More
information can be found at the following URL.

http://www3.ca.com/solutions/Product.aspx?ID=5586

II. DESCRIPTION

Remote exploitation of multiple buffer overflow vulnerabilities in
Computer Associates International Inc.'s (CA) BrightStor HSM allows
attackers to execute arbitrary code with SYSTEM privileges.

These problems specifically exist within various command handlers in the
CsAgent service. There are eleven command handlers that contain one or
more stack based buffer overflow vulnerabilities each. All of these
vulnerabilities are simple sprintf() calls that overflow fixed size
stack buffers with attacker supplied data.

Additionally, there are five command handlers that are vulnerable to
integer overflow vulnerabilities. In addition to this, the function
responsible for reading in and dispatching a request to the appropriate
handler also contains an integer overflow vulnerability. In each case, a
32-bit integer is taken from the packet and either added or multiplied
to determine how much memory to allocate. When these calculations cause
an integer wrap, a heap buffer of insufficient size is allocated. Later,
a heap overflow occurs when filling the buffer.

III. ANALYSIS

Exploitation of these vulnerabilities results in the execution of
arbitrary code with SYSTEM privileges. Unsuccessful attempts will crash
the service, but it will be restarted by a watchdog process soon
thereafter.

In order to exploit this vulnerability, an attacker must be able to
establish a TCP session on port 2000 with the vulnerable host. No
authentication is required.

IV. DETECTION

iDefense has confirmed the existence of these vulnerabilities in
Computer Associates BrightStor HSM version r11.5. Previous versions may
also be affected.

V. WORKAROUND

iDefense is currently unaware of any workarounds for this issue.

VI. VENDOR RESPONSE

Computer Associates has addressed these vulnerabilities with the release
of version r11.6. For more information, consult CA's security notice at
the following URL.

http://supportconnectw.ca.com/public/bstorhsm/infodocs/bstorhsm-secnot.asp

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2007-5082 to the stack-based buffer overflow issues.
Additionally, the name CVE-2007-5083 has been assigned to the integer
overflow issues. These identifiers are candidates for inclusion in the
CVE list (http://cve.mitre.org/) which standardizes names for security
problems.

VIII. DISCLOSURE TIMELINE

04/13/2007  Initial vendor notification
04/13/2007  Initial vendor response
09/27/2007  Coordinated public disclosure

IX. CREDIT

The discoverer of the stack-based buffer overflow vulnerabilities wishes
to remain anonymous. The integer overflow vulnerabilities were
discovered by Sean Larsson (VeriSign iDefense Labs).  

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2007 iDefense, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDefense. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically,
please e-mail customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
 There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct,
indirect, or consequential loss or damage arising from use of, or
reliance on, this information.
