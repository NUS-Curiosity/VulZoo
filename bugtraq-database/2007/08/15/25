
Date: Wed, 15 Aug 2007 14:40:55 -0400
From: iDefense Labs <labs-no-reply@...fense.com>
To: vulnwatch@...nwatch.org, full-disclosure@...ts.grok.org.uk,
	bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 08.15.07: ESRI ArcSDE Numeric Literal
 Buffer Overflow Vulnerability

ESRI ArcSDE Numeric Literal Buffer Overflow Vulnerability

iDefense Security Advisory 08.15.07
http://labs.idefense.com/intelligence/vulnerabilities/
Aug 15, 2007

I. BACKGROUND

ESRI Inc. ArcSDE is a multi-user database server bundled with ArcGIS to
provide access to Geographic Information Systems (GIS). More
information is available at the following URL.

http://www.esri.com/software/arcgis/arcsde/index.html

II. DESCRIPTION

Remote exploitation of a buffer overflow vulnerability within
Environmental Systems Research Institute (ESRI) Inc.'s ArcSDE service
allows attackers to crash the service or potentially execute arbitrary
code.

This vulnerability specifically exists due to insufficient buffer space
when representing user-supplied numeric values in ASCII. Certain
requests result in an sprintf() call using a static-sized 8 byte stack
buffer. If an attacker supplies a number that's ASCII value cannot be
represented within 8 bytes, a stack-based buffer overflow occurs.

III. ANALYSIS

Exploitation allows attackers to crash the service, or potentially
execute arbitrary code.

Since an attacker can only overflow the buffer with numeric values and a
single NUL byte, the execution of arbitrary may not be possible. Denial
of service is definitely possible.

No authentication is required to exploit this vulnerability.
Exploitation requires that attacker be able to communicate with the
server via the TCP port on which it is listening. By default the server
listens on port 5151.

IV. DETECTION

The vendor has confirmed that version 9.2 of ArcSDE, as bundled with
ArcGIS, is vulnerable to this attack. All versions are suspected to be
vulnerable.

V. WORKAROUND

Employing firewalls to limit access to the affected service can help
prevent potential exploitation of this vulnerability.

VI. VENDOR RESPONSE

ESRI has addressed this vulnerability by releasing ArcSDE 9.2 Service
Pack 3. More information is available from their Service Pack 3 release
notes at the following URL.

http://downloads.esri.com/support/downloads/other_/ArcSDE-92sp3-issues.htm

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2007-4278 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org/), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

05/14/2007  Initial vendor notification
05/14/2007  Initial vendor response
08/15/2007  Coordinated public disclosure

IX. CREDIT

The discoverer of this vulnerability wishes to remain anonymous.

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2007 iDefense, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDefense. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically,
please e-mail customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
 There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct,
indirect, or consequential loss or damage arising from use of, or
reliance on, this information.
