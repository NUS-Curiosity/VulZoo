
Date: Thu, 16 Aug 2007 18:55:39 -0400
From: iDefense Labs <labs-no-reply@...fense.com>
To: vulnwatch@...nwatch.org, full-disclosure@...ts.grok.org.uk,
	bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 08.16.07: IBM DB2 Universal Database Directory
 Creation Vulnerability

IBM DB2 Universal Database Directory Creation Vulnerability

iDefense Security Advisory 08.16.07
http://labs.idefense.com/intelligence/vulnerabilities/
Aug 16, 2007

I. BACKGROUND

IBM Corp.'s DB2 Universal Database product is a large database server
product commonly used for high end databases. For more information,
visit the following URL.

http://ibm.com/db2/

II. DESCRIPTION

Local exploitation of a directory creation vulnerability in IBM Corp.'s
DB2 Universal Database could allow attackers to elevate privileges to
the superuser.

This vulnerability exists due to insecure directory creation within
setuid-binaries included with DB2. While creating specific directory
structures, attacker created symbolic links will be followed. This
allows world-writable directories to be created anywhere on the file
system.

III. ANALYSIS

Exploitation allows local attackers to gain root privileges.

In order to execute arbitrary code, an attacker could create a
world-writable locale directory. By creating a specially crafted
localized message file, the attacker can cause a format string of their
choosing to be passed to a function in the printf(3) family. Using known
format string exploitation techniques, an attacker can then execute
arbitrary code as root. This should not be considered the only way to
gain root privileges with this vulnerability. However, iDefense has
confirmed this method in lab tests.

IV. DETECTION

iDefense confirmed the existence of this vulnerability in version 9.1
Fix Pack 2 of IBM Corp.'s DB2 Universal Database installed on a Linux
system. All prior versions, as well as builds for other UNIX-based
operating systems, are suspected to be vulnerable.

V. WORKAROUND

Setting more strict permissions on the DB2 instance directory can help
mitigate some of these vulnerabilities. Removing the setuid-bit from
all programs included with DB2 can also help mitigate exposure. Note,
these configuration changes have not been thoroughly tested and may
cause adverse behavior.

VI. VENDOR RESPONSE

IBM Corp. has addressed this vulnerability by releasing V9 Fix Pack 3
and version V8 FixPak 15 of its Universal Database product. More
information can be found at the following URLs.

V8: http://www-1.ibm.com/support/docview.wss?uid=swg21256235
V9: http://www-1.ibm.com/support/docview.wss?uid=swg21255572

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2007-4273 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org/), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

03/22/2007  Initial vendor notification
03/23/2007  Initial vendor response
08/16/2007  Coordinated public disclosure

IX. CREDIT

The discoverer of this vulnerability wishes to remain anonymous.

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2007 iDefense, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDefense. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically,
please e-mail customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
 There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct,
indirect, or consequential loss or damage arising from use of, or
reliance on, this information.
