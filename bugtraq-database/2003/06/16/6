
Date: Mon, 16 Jun 2003 17:15:06 +0100
From: "ac3" <ac3@....security-lab.org>
To: bugtraq@...urityfocus.com
Subject: Directory traversal vulnerability on Xoops/E-xoops CMS module "tutorials"


An attacker can use this flaw to execute arbitrary code of his choice on the 
remote system, run with the privileges of httpd.
The code can be written in any scripting language whose parser is run in the 
remote system in cooporation with httpd, whether as module or executable. 

Details: 

This vulnerability affects systems where Xoops or E-Xoops PHP CMS is 
installed, along with it's "Tutorials 2.0" module. Tutorials module normally 
allows users to submit HTML/BBcode formatted content to a site. Uploading of 
local image files is supported through php embedded uploader. It is however 
possible for a user to use this uploader to upload files of no image MIME 
type (e.x. PHP scripts), and then execute them by sending a simple http 
request. Retrieval or even deletion of sensitive System files on the remote 
machine may be possible this way, depending on the privileges under which the 
httpd is running and the configuration of PHP parser! 


Best solution: 
Update to version 2.1 in which the PHP uploader has included a MIME filetype 
check, prior to uploading. 

Other Possible Solutions: 
change the permissions to the /images/ directory to 555. 

Vendor Notified: Yes 

Update available: 
Yes, at http://www.mytutorials.info/modules/mydownloads 


Credits: 

ac3 (ac3@...urity-lab.org) 
GUSG Team 
www.hack-box.com 
www.security-lab.org 
with regards to Violator for testing








