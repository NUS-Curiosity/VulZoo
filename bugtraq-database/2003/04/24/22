
Date: Thu, 24 Apr 2003 16:58 -0400
From: bugzilla@...hat.com
To: redhat-watch-list@...hat.com, redhat-announce-list@...hat.com
Subject: [RHSA-2003:142-01] Updated LPRng packages fix psbanner vulnerability


---------------------------------------------------------------------
                   Red Hat Security Advisory

Synopsis:          Updated LPRng packages fix psbanner vulnerability
Advisory ID:       RHSA-2003:142-01
Issue date:        2003-04-24
Updated on:        2003-04-24
Product:           Red Hat Linux
Keywords:          
Cross references:  
Obsoletes:         
CVE Names:         CAN-2003-0136
---------------------------------------------------------------------

1. Topic:

Updated LPRng packages resolving a temporary file vulnerability are now
available.

2. Relevant releases/architectures:

Red Hat Linux 7.1 - i386
Red Hat Linux 7.2 - i386, ia64
Red Hat Linux 7.3 - i386
Red Hat Linux 8.0 - i386
Red Hat Linux 9 - i386

3. Problem description:

LPRng is a print spooler.  LPRng includes a program, psbanner, that can be
used to produce Postscript banner pages to separate print jobs.  

A vulnerability has been found in psbanner, which creates a temporary file
with a known filename in an insecure manner.  An attacker could create a
symbolic link and cause arbitrary files to be written as the 'lp' user.

Note: psbanner is not used by the default Red Hat Linux LPRng configuration.

Users that have configured LPRng to use psbanner should install these
updated packages, which contain a patch so that psbanner does not create
the temporary file.

4. Solution:

Before applying this update, make sure all previously released errata
relevant to your system have been applied.

To update all RPMs for your particular architecture, run:

rpm -Fvh [filenames]

where [filenames] is a list of the RPMs you wish to upgrade.  Only those
RPMs which are currently installed will be updated.  Those RPMs which are
not installed but included in the list will not be updated.  Note that you
can also use wildcards (*.rpm) if your current directory *only* contains the
desired RPMs.

Please note that this update is also available via Red Hat Network.  Many
people find this an easier way to apply updates.  To use Red Hat Network,
launch the Red Hat Update Agent with the following command:

up2date

This will start an interactive process that will result in the appropriate
RPMs being upgraded on your system.

5. RPMs required:

Red Hat Linux 7.1:

SRPMS:
ftp://updates.redhat.com/7.1/en/os/SRPMS/LPRng-3.7.4-23.2.src.rpm

i386:
ftp://updates.redhat.com/7.1/en/os/i386/LPRng-3.7.4-23.2.i386.rpm

Red Hat Linux 7.2:

SRPMS:
ftp://updates.redhat.com/7.2/en/os/SRPMS/LPRng-3.7.4-28.2.src.rpm

i386:
ftp://updates.redhat.com/7.2/en/os/i386/LPRng-3.7.4-28.2.i386.rpm

ia64:
ftp://updates.redhat.com/7.2/en/os/ia64/LPRng-3.7.4-28.2.ia64.rpm

Red Hat Linux 7.3:

SRPMS:
ftp://updates.redhat.com/7.3/en/os/SRPMS/LPRng-3.8.9-4.1.src.rpm

i386:
ftp://updates.redhat.com/7.3/en/os/i386/LPRng-3.8.9-4.1.i386.rpm

Red Hat Linux 8.0:

SRPMS:
ftp://updates.redhat.com/8.0/en/os/SRPMS/LPRng-3.8.9-6.1.src.rpm

i386:
ftp://updates.redhat.com/8.0/en/os/i386/LPRng-3.8.9-6.1.i386.rpm

Red Hat Linux 9:

SRPMS:
ftp://updates.redhat.com/9/en/os/SRPMS/LPRng-3.8.19-3.1.src.rpm

i386:
ftp://updates.redhat.com/9/en/os/i386/LPRng-3.8.19-3.1.i386.rpm



6. Verification:

MD5 sum                          Package Name
--------------------------------------------------------------------------
f4f70efc6363a4c2b6d06a3893e0ecdf 7.1/en/os/SRPMS/LPRng-3.7.4-23.2.src.rpm
b824dd8dc417d6caf64a1462cf3ee138 7.1/en/os/i386/LPRng-3.7.4-23.2.i386.rpm
4fcb04dd30b0b8144b31c3dc020f7bbf 7.2/en/os/SRPMS/LPRng-3.7.4-28.2.src.rpm
3eea2e52580beb8e2437855901995d11 7.2/en/os/i386/LPRng-3.7.4-28.2.i386.rpm
d017fc79c74f94d8809a63710658014d 7.2/en/os/ia64/LPRng-3.7.4-28.2.ia64.rpm
7ed2a78d5605ca8af15988f184f848b7 7.3/en/os/SRPMS/LPRng-3.8.9-4.1.src.rpm
105253d098ab618fc75b84d14eb4e7f4 7.3/en/os/i386/LPRng-3.8.9-4.1.i386.rpm
c39036850c236dbfad1818d0a7a50ff7 8.0/en/os/SRPMS/LPRng-3.8.9-6.1.src.rpm
6957f122cdae8d65ff23703e238d221a 8.0/en/os/i386/LPRng-3.8.9-6.1.i386.rpm
4033bde51dddedb0baa7d02d8f3b1e95 9/en/os/SRPMS/LPRng-3.8.19-3.1.src.rpm
2d07bfe130a9af58df5afb09b40a3181 9/en/os/i386/LPRng-3.8.19-3.1.i386.rpm


These packages are GPG signed by Red Hat for security.  Our key is
available at http://www.redhat.com/solutions/security/news/publickey/

You can verify each package with the following command:
    
    rpm --checksig -v <filename>

If you only wish to verify that each package has not been corrupted or
tampered with, examine only the md5sum with the following command:
    
    md5sum <filename>


7. References:

http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=188366
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2003-0136

8. Contact:

The Red Hat security contact is <security@...hat.com>.  More contact
details at http://www.redhat.com/solutions/security/news/contact/

Copyright 2003 Red Hat, Inc.



