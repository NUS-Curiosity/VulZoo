
Date: Thu, 24 Apr 2003 12:02:43 +0800
From: NSFOCUS Security Team <security@...ocus.com>
To: bugtraq@...urityfocus.com
Cc: vulnwatch@...nwatch.org, full-disclosure@...ts.netsys.com,
	NTBUGTRAQ@...TSERV.NTBUGTRAQ.COM
Subject: NSFOCUS SA2003-04 : Remote Buffer Overflow Vulnerability in Web Management Interface of Cisco Secure ACS


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

NSFOCUS Security Advisory(SA2003-04)

Topic: Remote Buffer Overflow Vulnerability in Web Management Interface of
       Cisco Secure ACS

Release Date: 2003-04-24

CVE CAN ID: CAN-2003-0210

Affected system:
===================

Cisco Secure ACS 2.6.4 for Windows and earlier
Cisco Secure ACS 3.0.3 for Windows and earlier
Cisco Secure ACS 3.1.1 for Windows and earlier

Summary:
=========

NSFOCUS Security Team has found a security vulnerability during the WEB
management interface of Cisco Secure ACS handling certain parameters. Exploiting
the vulnerability attackers could cause the service to hang or run arbitrary
code.

Description:
============

Cisco Secure Access Control Server(ACS) is a high-performance, highly scalable,
centralized user access control framework. It supports centralized access and
audit for dial access server, VPN and firewall, and IP voice(VoIP) solutions,
as well as user  based on standard IEEE 802.1x for wireless users of Cisco
Aironet 350 wireless integration solution.

The management of Cisco Secure ACS is implemented via WEB interface. Cisco
Secure ACS will install a service known as "CSAdmin"( the corresponding program
of which is CSAdmin.exe) on the system. Once the service is enabled it listens
on TCP/2002 port and accepts HTTP request.

A buffer overflow vulnerability occurs during CSAdmin.exe handling login.exe
request. Receiving the login request CSAdmin.exe will call wsprintfA to handle
the user parameter without any length check on the parameter. If attackers
send an extremely long user parameter to the server, they might cause a buffer
overflow, resulting in service hanging or restarting. With carefully
crafted data attacker could run arbitrary code with CSAdmin process
privilege(typically LocalSystem) on the server.

Workaround:
===========

Block access to the port TCP/2002 of the host running Cisco Secure ACS from 
untrusted IPs on the firewall.

Vendor Status:
==============

2003-03-16  Informed the vendor.
2003-03-23  The vendor confirmed the vulnerability.
2003-04-23  The vendor released an advisory and patches for this issue.

Cisco Bug ID: CSCea51366

The Cisco advisory is available at:
http://www.cisco.com/warp/public/707/cisco-sa-20030423-ACS.shtml


The patches:

Cisco ACS 3.1(1) - CSAdmin-Patch-3.1-1-27.zip
Cisco ACS 3.0(3) - CSAdmin-Patch-3.0-3-6.zip
Cisco ACS 2.6   -  CSAdmin-patch-2.6-4-4.zip

Fixes to the CSAdmin  will be included in ACS for windows versions 2.6.5,
3.0.4 and 3.1.2, and later.

Additional Information:
========================

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CAN-2003-0210 to this issue. This is a candidate for inclusion in the
CVE list (http://cve.mitre.org), which standardizes names for security
problems. Candidates may change significantly before they become official
CVE entries.

Credit:
=========

This vulnerability was discovered by Yang Yu of NSFOCUS Security Team.

DISCLAIMS:
==========
THE INFORMATION PROVIDED IS RELEASED BY NSFOCUS "AS IS" WITHOUT WARRANTY
OF ANY KIND. NSFOCUS DISCLAIMS ALL WARRANTIES, EITHER EXPRESS OR IMPLIED,
EXCEPT FOR THE WARRANTIES OF MERCHANTABILITY. IN NO EVENTSHALL NSFOCUS
BE LIABLE FOR ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT,
INCIDENTAL,CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES,
EVEN IF NSFOCUS HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.
DISTRIBUTION OR REPRODUCTION OF THE INFORMATION IS PROVIDED THAT THE
ADVISORY IS NOT MODIFIED IN ANY WAY.

Copyright 1999-2003 NSFOCUS. All Rights Reserved. Terms of use.


NSFOCUS Security Team <security@...ocus.com>
NSFOCUS INFORMATION TECHNOLOGY CO.,LTD
(http://www.nsfocus.com)

PGP Key: http://www.nsfocus.com/homepage/research/pgpkey.asc
Key fingerprint = F8F2 F5D1 EF74 E08C 02FE  1B90 D7BF 7877 C6A6 F6DA

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.0.7 (GNU/Linux)

iD4DBQE+p2Hj1794d8am9toRAqrJAJjJcfisX92LWRLtIDqttKf1OtM8AKCLGAIo
S1roMToCQsUgM+VXG1KGyQ==
=V7TY
-----END PGP SIGNATURE-----



