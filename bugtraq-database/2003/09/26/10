
Date: Thu, 25 Sep 2003 13:03:22 +0400
From: "Ilya Teterin"  <alienhard@...l.ru>
To: bugtraq@...urityfocus.com
Subject: Re: base64


David Wilson:

> So, there is ambiguity in RFC 2045, and this is the point of the
> original post. Different people, and therefore different
> implementations will have different interpretations. There is
> therefore potential for a vulnerability when checks are
> performed using one interpretation but the actual receiver
> uses another interpretation.

Thanks. It's exactly what I mean. Please note that if there is no "correct" interpretation of RFC 2045, then *any* implementation of decoding is "vulnerable" to ambiguity issue, and we need workaround when it's dangerous. So, at least all antiviral software which are not aware of this issue should be patched as soon as possible :-) We can meet mail worm, which is polymorphic at the attachment encoding level, and can't be detected without modification of core files of antiviral software.

> Or should we reject all these broken messages? ;-)

I believe we should reject ambiguous messages, if and only if it's ambiguity related to content-filtering rules.

So, if we check base64 attachments for viruses or spam, we should reject messages with malformed attachments. If timezone field is malformed and there are no filtering rules related to timezone - we have no reasons to reject this message.


