
Date: Thu, 29 May 2003 09:22:44 -0300
From: OTERO Hernan Gustavo       EDS <bazhgo@...hint.net>
To: bugtraq@...urityfocus.com, bugtraq@...urity.nnov.ru,
   vulnwatch@...nwatch.org
Subject: [VulnDiscuss] Abusing  DNS protocol


This mail has as objective show a form of possible abuse on the DNS
protocol.

As security consultant I have seen several times a DNS architecture where
the DNS of the organization makes the internal consultations and the
external consultations.

In this "schema" its certainly very easy pass information from inside to
outside of private network, even more, we can answer with four char´s
char.char.char.char ( As IP Address ).

With this simple communication channel we can send and receive information
through the Internet without practically any restriction, only the hostname
long.

This communication channel is very slow to share information bulk, but is
fast enough to control some distributed virus or worm.

In the client side we can send a Query type "A" like this:

INFORMATION-TO-PASS-TO-THE-INTERNET-SERVER.somerandom.foodomain.com

Where "INFORMATION-TO-PASS-TO-THE-INTERNET-SERVER" is the data that we want
to send and somerandom will ensure that all the query will be performed, and
not will be answered by the server cache or something like that.

In the server side

We will take the Query and answer with some four byte code as IP Adrress.

With four bytes we have 2^32 possible combinations, enough information to
launch some actions in the client side.

May be possible to send information..., and receive information too, but
relaying in the four bytes size could be imposible..., but ( Always thereis
a but ) if you use a register as an ALIAS you could answer with that ALIAS
name making posible extent the trivial four bytes to N bytes. Where N is
around MAXHOSTNAME.

Like always, I hope this can help to secure Internet "OUR" network



Hernán Otero
http://xss.com.ar


/***************************************************************************
/
The content of this mail expresses my personal opinion and research.


