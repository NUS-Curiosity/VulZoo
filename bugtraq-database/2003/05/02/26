
Date: 01 May 2003 14:15:38 -0400
From: Nicolas Couture <nc@...rmvault.net>
To: Ethan Benson <erbenson@...ska.net>
Subject: Re: OpenSSH/PAM timing attack allows remote users identification


On Thu, 2003-05-01 at 05:12, Ethan Benson wrote:
> On Wed, Apr 30, 2003 at 04:34:27PM +0200, Marco Ivaldi wrote:
> > root@...doo:~# ssh [valid_user]@lab.mediaservice.net
> > [valid_user]@lab.mediaservice.net's password:	<- arbitrary (non-null) string
> > [2 secs delay]
> > Permission denied, please try again.
> > 
> > root@...doo:~# ssh [no_such_user]@lab.mediaservice.net
> > [no_such_user]@lab.mediaservice.net's password:	<- arbitrary (non-null) string
> > [no delay]
> > Permission denied, please try again.
> 
> ive noticed something similar in its handling of PermitRootLogin, if
> this option is set to `no' you get the following behavior:

This is not only true in association with the ssh daemon's
configuration. Even if root login is allowed in it's configuration but
pam disallow root logins, it'll result in a 2 seconds delay on bad
password and reject instantly good password instead of login.

The problem is not in the handling of PermitRootLogin but in the
handling of login in sshd, adding a 2 seconds delay before login or
removing the 2 seconds delay on bad login before sending an error would
fix the problem.

> $ ssh root@...t
> root@...t's password: <- arbitrary (non-null) string
> [2 secs delay]
> Permission denied, please try again.a
> 
> $ ssh root@...t
> root@...t's password:  <- correct root password
> [no delay]
> Permission denied, please try again.
> 
> i haven't checked the current version to see if this is still true. 

I verified this on redhat 8, openssh-3.4p1-2(rpm) and sshd is acting
just like you described it.



