
Date: 18 Mar 2003 00:59:47 -0000
From: subj <r2subj3ct@...lan.org>
To: bugtraq@...urityfocus.com
Subject: SIPS (PHP)




Product : SIPS
Version : v0.2.2
WebSite : http://www.squishdot.org
Problem : Viewing users account

Description:
------------

 You could easily look throught any user's account without any 
permissions. Each of them is in dir names after first letter of his 
login. For example foo will have url like this 
one: /sipssys/users/f/foo/user
So user's info file could be saw - it gaves u md5-hash of password, that 
you can  try to crack by JtR or other any soft

 E.g:
  
  http://localhost/sips/sipssys/users/t/test/user
     
  Password::47bce5c74f589f4867dbd57e9ca9f808  //&#1055;&#1072;&#1088;&#1086;&#1083;&#1100; &#1079;&#1072;&#1096;&#1080;&#1092;&#1088;&#1086;&#1074;&#1072;&#1085;&#1085;&#1099;&#1081; 
&#1072;&#1083;&#1075;&#1086;&#1088;&#1080;&#1090;&#1084;&#1086;&#1084; MD5.
  Email::test@...alhost
  Theme::default 

==========
login.php:
==========
[...]

if ($action == "login") {
      if ($username) {
         if (file_exists($config["sipssys"] ."/users/$username[0]/
$username/user")) {  
            $cryptpass = md5($password);
            if (getUserValue($username, "Password") == $cryptpass) {
               $cryptuser = "$username:$cryptpass";
[...]


Exploit:
--------

http://[somehost]/[sips_directioy]/sipssys/users/[first_letter_of_UserID]/
[UserID]/user


Link:
=====
www.dwcgr0up.com
irc.dwcgr0up.biz:6667

Fixs:
=====

U can finf all our fix on our homepage [www.dwcgroup.com]

Thanks:
=======
GipsHack crew : DHGroup etc etc


