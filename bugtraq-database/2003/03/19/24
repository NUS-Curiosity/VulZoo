
Date: Wed, 19 Mar 2003 12:28:08 -0800
From: SGI Security Coordinator <agent99@....com>
To: agent99@....com
Subject: SMB/CIFS Security Vulnerability in Samba on IRIX


-----BEGIN PGP SIGNED MESSAGE-----

______________________________________________________________________________
                          SGI Security Advisory

Title    : SMB/CIFS Security Vulnerability in Samba
Number   : 20030302-01-I
Date     : March 19, 2003
Reference: CVE CAN-2003-0085
Reference: CVE CAN-2003-0086
Reference: SGI BUGS 883509 884044
Fixed in : Samba version 2.2.8

______________________________________________________________________________

- -----------------------
- --- Issue Specifics ---
- -----------------------

It's been reported that there is a SMB/CIFS packet fragment re-assembly code
vulnerability in versions of Samba prior to version 2.2.8.  A successful
exploit of this vulnerability could allow an external attacker to remotely
and anonymously gain root privilege on a system running the Samba server.

See http://us1.samba.org/samba/whatsnew/samba-2.2.8.html
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2003-0085
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2003-0086
for more details.

SGI has investigated the issues and recommends the following steps for
neutralizing the exposure.  It is HIGHLY RECOMMENDED that these measures be
implemented on ALL vulnerable SGI systems.

These issues have been corrected in Samba version 2.2.8.


- --------------
- --- Impact ---
- --------------

Samba is an optional product and is not installed by default on IRIX 6.5
systems.

To determine the version of IRIX you are running, execute the following
command:

  # /bin/uname -R

That will return a result similar to the following:

  # 6.5 6.5.16f

The first number ("6.5") is the release name, the second ("6.5.16f" in this
case) is the extended release name.  The extended release name is the
"version" we refer to throughout this document.

To see if Samba is installed, execute the following command:

% versions samba_irix
I = Installed, R = Removed

   Name                 Date        Description

   I  samba_irix           07/02/2002  Samba 2.2.4 for IRIX
   I  samba_irix.man       07/02/2002  Samba Online Documentation
   I  samba_irix.man.doc   07/02/2002  Samba 2.2.4 Documentation
   I  samba_irix.man.manpages  07/02/2002  Samba 2.2.4 Man Page
   I  samba_irix.man.relnotes  07/02/2002  Samba 2.2.4 Release Notes
   I  samba_irix.src       07/02/2002  Samba Source Code
   I  samba_irix.src.samba 07/02/2002  Samba 2.2.4 Source Code
   I  samba_irix.sw        07/02/2002  Samba Execution Environment
   I  samba_irix.sw.base   07/02/2002  Samba 2.2.4 Execution Environment

If the result is similar to the above and the version shown is less than
2.2.8, then the system is vulnerable.


- ----------------------------
- --- Temporary Workaround ---
- ----------------------------

Though it is possible to limit exposure by filtering what IPs can talk to
your Samba server, there is no effective workaround to fully address these
problems.  SGI recommends upgrading to Samba version 2.2.8.


- ----------------
- --- Solution ---
- ----------------

SGI has provided an instable version of Samba for this vulnerability. Our
recommendation is to upgrade to Samba version 2.2.8.

The free unsupported Samba 2.2.8 version can be currently downloaded
from the following websites:
http://freeware.sgi.com/beta/fw_samba-2.2.8.tardist
http://master.samba.org/samba/ftp/Binary_Packages/IRIX/

For customers who have purchased the SGI supported version of Samba
called samba_irix, please contact your SGI Support Representative and
request CD part number 812-0893-010 -- Samba 2.2.8 for IRIX on CD.


- ------------------------
- --- Acknowledgments ----
- ------------------------

SGI wishes to thank the Sebastian Krahmer, the SuSE security team, the Samba
Group and the users of the Internet Community at large for their assistance
in this matter.


- -------------
- --- Links ---
- -------------

SGI Security Advisories can be found at:
http://www.sgi.com/support/security/ and
ftp://patches.sgi.com/support/free/security/advisories/

SGI Security Patches can be found at:
http://www.sgi.com/support/security/ and
ftp://patches.sgi.com/support/free/security/patches/

SGI patches for IRIX can be found at the following patch servers:
http://support.sgi.com/irix/ and ftp://patches.sgi.com/

SGI freeware updates for IRIX can be found at:
http://freeware.sgi.com/

SGI fixes for SGI open sourced code can be found on:
http://oss.sgi.com/projects/

SGI patches and RPMs for Linux can be found at:
http://support.sgi.com/linux/ or
http://oss.sgi.com/projects/sgilinux-combined/download/security-fixes/

SGI patches for Windows NT or 2000 can be found at:
http://support.sgi.com/nt/

IRIX 5.2-6.4 Recommended/Required Patch Sets can be found at:
http://support.sgi.com/irix/ and ftp://patches.sgi.com/support/patchset/

IRIX 6.5 Maintenance Release Streams can be found at:
http://support.sgi.com/colls/patches/tools/relstream/index.html

IRIX 6.5 Software Update CDs can be obtained from:
http://support.sgi.com/irix/swupdates/

The primary SGI anonymous FTP site for security advisories and patches is
patches.sgi.com (216.32.174.211).  Security advisories and patches are
located under the URL ftp://patches.sgi.com/support/free/security/

For security and patch management reasons, ftp.sgi.com (mirrors
patches.sgi.com security FTP repository) lags behind and does not do a
real-time update.


- -----------------------------------------
- --- SGI Security Information/Contacts ---
- -----------------------------------------

If there are questions about this document, email can be sent to
security-info@....com.

                      ------oOo------

SGI provides security information and patches for use by the entire SGI
community.  This information is freely available to any person needing the
information and is available via anonymous FTP and the Web.

The primary SGI anonymous FTP site for security advisories and patches is
patches.sgi.com (216.32.174.211).  Security advisories and patches are
located under the URL ftp://patches.sgi.com/support/free/security/

The SGI Security Headquarters Web page is accessible at the URL:
http://www.sgi.com/support/security/

For issues with the patches on the FTP sites, email can be sent to
security-info@....com.

For assistance obtaining or working with security patches, please
contact your SGI support provider.

                      ------oOo------

SGI provides a free security mailing list service called wiretap and
encourages interested parties to self-subscribe to receive (via email) all
SGI Security Advisories when they are released. Subscribing to the mailing
list can be done via the Web
(http://www.sgi.com/support/security/wiretap.html) or by sending email to
SGI as outlined below.

% mail wiretap-request@....com
subscribe wiretap <YourEmailAddress such as midwatch@....com >
end
^d

In the example above, <YourEmailAddress> is the email address that you wish
the mailing list information sent to.  The word end must be on a separate
line to indicate the end of the body of the message. The control-d (^d) is
used to indicate to the mail program that you are finished composing the
mail message.


                      ------oOo------

SGI provides a comprehensive customer World Wide Web site. This site is
located at http://www.sgi.com/support/security/ .

                      ------oOo------

If there are general security questions on SGI systems, email can be sent to
security-info@....com.

For reporting *NEW* SGI security issues, email can be sent to
security-alert@....com or contact your SGI support provider.  A support
contract is not required for submitting a security report.

______________________________________________________________________________
      This information is provided freely to all interested parties
      and may be redistributed provided that it is not altered in any
      way, SGI is appropriately credited and the document retains and
      includes its valid PGP signature.

-----BEGIN PGP SIGNATURE-----
Version: 2.6.2

iQCVAwUBPnjRVbQ4cFApAP75AQEOYAP+JXQz1lctJ+e+qw79i/Xq/yYDXbO0QiF8
rPRiMiRBdzdM6AftmrafxtYlZBA6zAIpOKREdXmIqX0ugCRynwGke0EiC/p5IfLi
GMZoztzO78zk03n4rrAbWqFCBoxzcJOEo9dnuFVIxosx1zJB2LpXrfytZieLJpLh
t1m/MAoQn18=
=wxEX
-----END PGP SIGNATURE-----


