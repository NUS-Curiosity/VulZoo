
Date: Mon, 31 Mar 2003 12:21 -0500
From: bugzilla@...hat.com
To: redhat-watch-list@...hat.com, redhat-announce-list@...hat.com
Cc: bugtraq@...urityfocus.com, full-disclosure@...ts.netsys.com
Subject: [RHSA-2003:034-01] Updated dhcp packages fix possible packet storm


---------------------------------------------------------------------
                   Red Hat Security Advisory

Synopsis:          Updated dhcp packages fix possible packet storm
Advisory ID:       RHSA-2003:034-01
Issue date:        2003-03-31
Updated on:        2003-03-31
Product:           Red Hat Linux
Keywords:          
Cross references:  
Obsoletes:         RHSA-2003:011
CVE Names:         CAN-2003-0039
---------------------------------------------------------------------

1. Topic:

A potential remote denial of service attack affects version 3 of the ISC
DHCPD server.  This advisory provides fixed packages for Red Hat Linux 8.0.

2. Relevant releases/architectures:

Red Hat Linux 8.0 - i386

3. Problem description:

The dhcp package provides the ISC Dynamic Host Configuration Protocol
(DHCP) server and relay agent.  DHCP is a protocol that allows devices to
get their own network configuration information from a server.

Florian Lohoff reported that the ISC dhcrelay (dhcp-relay) in 3.0rc9 and
earlier allows remote attackers to cause a denial of service (packet
storm) by constructing a malicious BOOTP packet that is forwarded to a
broadcast MAC address, causing an infinite loop.

Red Hat Linux 8.0 shipped with a version of DHCP that is vulnerable to
this issue.  Other distributions of Red Hat Linux and Red Hat Linux
Advanced Server are based on version 2 of DHCP, and are not vulnerable to
this issue.

These erratum packages contain a patch that introduces a new command line
switch to dhcrelay, "-c maxcount".  This switch can be used to limit the
hopcount and so avoid any infinite loops.  We advise users of dhcp-relay to
specify a small number for the maximum hop count; for example "dhcrelay -c 10".

4. Solution:

Before applying this update, make sure all previously released errata
relevant to your system have been applied.

To update all RPMs for your particular architecture, run:

rpm -Fvh [filenames]

where [filenames] is a list of the RPMs you wish to upgrade.  Only those
RPMs which are currently installed will be updated.  Those RPMs which are
not installed but included in the list will not be updated.  Note that you
can also use wildcards (*.rpm) if your current directory *only* contains the
desired RPMs.

Please note that this update is also available via Red Hat Network.  Many
people find this an easier way to apply updates.  To use Red Hat Network,
launch the Red Hat Update Agent with the following command:

up2date

This will start an interactive process that will result in the appropriate
RPMs being upgraded on your system.

5. RPMs required:

Red Hat Linux 8.0:

SRPMS:
ftp://updates.redhat.com/8.0/en/os/SRPMS/dhcp-3.0pl1-26.src.rpm

i386:
ftp://updates.redhat.com/8.0/en/os/i386/dhcp-3.0pl1-26.i386.rpm
ftp://updates.redhat.com/8.0/en/os/i386/dhcp-devel-3.0pl1-26.i386.rpm
ftp://updates.redhat.com/8.0/en/os/i386/dhclient-3.0pl1-26.i386.rpm



6. Verification:

MD5 sum                          Package Name
--------------------------------------------------------------------------
c96c16fa9605745ca94d2acafea2862a 8.0/en/os/SRPMS/dhcp-3.0pl1-26.src.rpm
e9ef52a8859a1b9776ef9276495dea35 8.0/en/os/i386/dhclient-3.0pl1-26.i386.rpm
5a11c839e1824a5eecb71d098007fed8 8.0/en/os/i386/dhcp-3.0pl1-26.i386.rpm
3f6de3a2cbe96c7b8402e2fcb90fe0a8 8.0/en/os/i386/dhcp-devel-3.0pl1-26.i386.rpm


These packages are GPG signed by Red Hat for security.  Our key is
available at http://www.redhat.com/solutions/security/news/publickey/

You can verify each package with the following command:
    
    rpm --checksig -v <filename>

If you only wish to verify that each package has not been corrupted or
tampered with, examine only the md5sum with the following command:
    
    md5sum <filename>


7. References:

http://marc.theaimsgroup.com/?l=bugtraq&m=104310927813830
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2003-0039

8. Contact:

The Red Hat security contact is <security@...hat.com>.  More contact
details at http://www.redhat.com/solutions/security/news/contact/

Copyright 2003 Red Hat, Inc.

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.netsys.com/full-disclosure-charter.html


