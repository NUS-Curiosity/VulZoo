
Date: Fri, 7 Mar 2003 10:00 -0500
From: redhat-announce-list-admin@...hat.com
To: redhat-watch-list@...hat.com, redhat-announce-list@...hat.com
Cc: bugtraq@...urityfocus.com, full-disclosure@...ts.netsys.com
Subject: [RHSA-2003:086-07] Updated file packages fix vulnerability


---------------------------------------------------------------------
                   Red Hat, Inc. Red Hat Security Advisory

Synopsis:          Updated file packages fix vulnerability
Advisory ID:       RHSA-2003:086-07
Issue date:        2003-03-05
Updated on:        2003-03-07
Product:           Red Hat Linux
Keywords:          readelf.c flaw:buf
Cross references:  
Obsoletes:         
CVE Names:         CAN-2003-0102
---------------------------------------------------------------------

1. Topic:

Updated file packages are available to close a buffer overflow vulnerability.

2. Relevant releases/architectures:

Red Hat Linux 6.2 - i386
Red Hat Linux 7.0 - i386
Red Hat Linux 7.1 - i386
Red Hat Linux 7.2 - i386, ia64
Red Hat Linux 7.3 - i386
Red Hat Linux 8.0 - i386

3. Problem description:

The file command is used to identify a particular file according to the
type of data contained in the file.

The file utility before version 3.41 contains a buffer overflow
vulnerability in the ELF parsing routines. This vulnerability may
allow an attacker to create a carefully crafted binary which can allow
arbitrary code to be run if a victim runs the 'file' command on that
binary.

There are other ways that an attacker may be able to take advantage of
this vulnerability in the file command:

-- In Red Hat Linux 6.2 and 7.0, the rhs-printfilter package makes use
of the file command. This would allow an attacker who has the ability
to print to execute arbitrary commands (as the user 'lp') on the print
server by sending a malicious file.

-- On some Red Hat Linux distributions it may also be possible to
trigger this exploit by encouraging the victim to use the 'less'
command on a malicious file which is named so that it will be
processed by the 'lesspipe.sh' script.

All users are advised to update to these erratum packages, which contain a
backported patch to correct this vulnerability.  

Red Hat would like to thank iDefense for disclosing this issue and
zen-parse for discussion of some of the implications.

4. Solution:

Before applying this update, make sure all previously released errata
relevant to your system have been applied.

To update all RPMs for your particular architecture, run:

rpm -Fvh [filenames]

where [filenames] is a list of the RPMs you wish to upgrade.  Only those
RPMs which are currently installed will be updated.  Those RPMs which are
not installed but included in the list will not be updated.  Note that you
can also use wildcards (*.rpm) if your current directory *only* contains the
desired RPMs.

Please note that this update is also available via Red Hat Network.  Many
people find this an easier way to apply updates.  To use Red Hat Network,
launch the Red Hat Update Agent with the following command:

up2date

This will start an interactive process that will result in the appropriate
RPMs being upgraded on your system.

5. RPMs required:

Red Hat Linux 6.2:

SRPMS:
ftp://updates.redhat.com/6.2/en/os/SRPMS/file-3.39-8.6x.src.rpm

i386:
ftp://updates.redhat.com/6.2/en/os/i386/file-3.39-8.6x.i386.rpm

Red Hat Linux 7.0:

SRPMS:
ftp://updates.redhat.com/7.0/en/os/SRPMS/file-3.39-8.7x.src.rpm

i386:
ftp://updates.redhat.com/7.0/en/os/i386/file-3.39-8.7x.i386.rpm

Red Hat Linux 7.1:

SRPMS:
ftp://updates.redhat.com/7.1/en/os/SRPMS/file-3.39-8.7x.src.rpm

i386:
ftp://updates.redhat.com/7.1/en/os/i386/file-3.39-8.7x.i386.rpm

Red Hat Linux 7.2:

SRPMS:
ftp://updates.redhat.com/7.2/en/os/SRPMS/file-3.39-8.7x.src.rpm

i386:
ftp://updates.redhat.com/7.2/en/os/i386/file-3.39-8.7x.i386.rpm

ia64:
ftp://updates.redhat.com/7.2/en/os/ia64/file-3.39-8.7x.ia64.rpm

Red Hat Linux 7.3:

SRPMS:
ftp://updates.redhat.com/7.3/en/os/SRPMS/file-3.39-8.7x.src.rpm

i386:
ftp://updates.redhat.com/7.3/en/os/i386/file-3.39-8.7x.i386.rpm

Red Hat Linux 8.0:

SRPMS:
ftp://updates.redhat.com/8.0/en/os/SRPMS/file-3.39-9.src.rpm

i386:
ftp://updates.redhat.com/8.0/en/os/i386/file-3.39-9.i386.rpm



6. Verification:

MD5 sum                          Package Name
--------------------------------------------------------------------------
8cb16a37290c4714429eef117a56e551 6.2/en/os/SRPMS/file-3.39-8.6x.src.rpm
e84840bfb63e0807652b4c795a211b48 6.2/en/os/i386/file-3.39-8.6x.i386.rpm
15c75893938ec25e6ae872674560d782 7.0/en/os/SRPMS/file-3.39-8.7x.src.rpm
57ff358a59f9420cebf55059ab64300d 7.0/en/os/i386/file-3.39-8.7x.i386.rpm
15c75893938ec25e6ae872674560d782 7.1/en/os/SRPMS/file-3.39-8.7x.src.rpm
57ff358a59f9420cebf55059ab64300d 7.1/en/os/i386/file-3.39-8.7x.i386.rpm
15c75893938ec25e6ae872674560d782 7.2/en/os/SRPMS/file-3.39-8.7x.src.rpm
57ff358a59f9420cebf55059ab64300d 7.2/en/os/i386/file-3.39-8.7x.i386.rpm
4fe9b98179258155d4a3d4dc4e543d13 7.2/en/os/ia64/file-3.39-8.7x.ia64.rpm
15c75893938ec25e6ae872674560d782 7.3/en/os/SRPMS/file-3.39-8.7x.src.rpm
57ff358a59f9420cebf55059ab64300d 7.3/en/os/i386/file-3.39-8.7x.i386.rpm
76ee5aa939dc04cd3cae2fdd18019f3d 8.0/en/os/SRPMS/file-3.39-9.src.rpm
b0560e1725f28fe375f9885a7a6be684 8.0/en/os/i386/file-3.39-9.i386.rpm


These packages are GPG signed by Red Hat, Inc. for security.  Our key
is available at http://www.redhat.com/about/contact/pgpkey.html

You can verify each package with the following command:
    
    rpm --checksig -v <filename>

If you only wish to verify that each package has not been corrupted or
tampered with, examine only the md5sum with the following command:
    
    md5sum <filename>


7. References:

http://www.idefense.com/advisory/03.04.03.txt
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2003-0102

8. Contact:

The Red Hat security contact is <security@...hat.com>.  More contact
details at http://www.redhat.com/solutions/security/news/contact.html

Copyright 2003 Red Hat, Inc.

