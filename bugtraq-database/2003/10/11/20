
Date: Sat, 11 Oct 2003 18:33:45 +0200
From: "Lorenzo Hernandez Garcia-Hierro" <lorenzohgh@...g-security.com>
To: "Full-Disclosure" <full-disclosure@...ts.netsys.com>
Cc: "BUGTRAQ" <bugtraq@...urityfocus.com>
Subject: MySQL backend for BANNINIP System


Here is it !! :

<? 
$db = mysql_connect("localhost","user","pass"); 
mysql_select_db("dbname"); 
$doit = mysql_query("SELECT * FROM banninip WHERE ip='$ip'",$db); 
if(mysql_fetch_row($doit)) { 
echo "ACCESS DENIED<br>"; 
exit("WE SAY: DO NOT EAT DRUGS , THEY ARE BAD FOR YOUR MONKEY BRAIN."); 
} 
?>

And....

CREATE TABLE banninip ( 
ip char(20) NOT NULL default '0', 
PRIMARY KEY (ip) 
) TYPE=MyISAM;

Enjoy.
Best regards.
-------------------------------
0x00->Lorenzo Hernandez Garcia-Hierro
0x01->/* not csh but sh */
0x02->$ PATH=pretending!/usr/ucb/which sense
0x03-> no sense in pretending! 
__________________________________
PGP: Keyfingerprint
B6D7 5FCC 78B4 97C1  4010 56BC 0E5F 2AB2
ID: 0x9C38E1D7
**********************************
No Secure Root Group Security Research Team 
http://www.nsrg-security.com
______________________

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.netsys.com/full-disclosure-charter.html


