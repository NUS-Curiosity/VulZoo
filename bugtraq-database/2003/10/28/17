
Date: Tue, 28 Oct 2003 13:59:28 -0800
From: SGI Security Coordinator <agent99@....com>
To: agent99@....com
Cc: bugtraq@...urityfocus.com, full-disclosure@...ts.netsys.com,
	vulnwatch@...nwatch.org
Subject: Wildcard exportfs issue in NFS on IRIX


-----BEGIN PGP SIGNED MESSAGE-----

______________________________________________________________________________

                          SGI Security Advisory

Title:      Wildcard exportfs issue in NFS
Number:     20031004-01-P
Date:       October, 28 2003
Reference:  SGI BUG 902105
Reference:  CVE CAN-2003-0683
Fixed in:   Future release of IRIX or patches 5351 and 5352
______________________________________________________________________________

SGI provides this information freely to the SGI user community for its
consideration, interpretation, implementation and use.   SGI recommends
that this information be acted upon as soon as possible.

SGI provides the information in this Security Advisory on an "AS-IS"
basis only, and disclaims all warranties with respect thereto, express,
implied or otherwise, including, without limitation, any warranty of
merchantability or fitness for a particular purpose.  In no event shall
SGI be liable for any loss of profits, loss of business, loss of data or

for any indirect, special, exemplary, incidental or consequential damages
of any kind arising from your use of, failure to use or improper use of
any of the instructions or information in this Security Advisory.
_____________________________________________________________________________

- -----------------------
- --- Issue Specifics ---
- -----------------------

It has been reported on IRIX 6.5.21m/f when any of the root,rw or
access options in /etc/exports contains only wildcards (IP addresses
or domain suffixes) and no explicit hostnames or netgroups, the NFS
server has the potential to ignore access checks with some configurations.

This vulnerability was assigned the following CVE candidate:
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2003-0683

SGI has investigated the issue and recommends the following steps for
neutralizing the exposure.  It is HIGHLY RECOMMENDED that these measures

be implemented on ALL vulnerable SGI systems.  This issue has been
corrected in future releases of IRIX.


- --------------
- --- Impact ---
- --------------

To determine the version of IRIX you are running, execute the following
command:

  # /bin/uname -R

That will return a result similar to the following:

  # 6.5 6.5.21f

The first number ("6.5") is the release name, the second ("6.5.21f" in
this case) is the extended release name.  The extended release name
is the "version" we refer to throughout this document.


- --------------------------
- -- Temporary Workaround --
- --------------------------

The temporary workaround is to make sure that 'localhost' is added
at the beginning of the list of hosts being exported to.  For example,
if you have in /etc/exports:

/some/filesystem        -access={some wildcard}

then change it to:

/some/filesystem        -access=localhost:{some wildcard}


- ----------------
- --- Solution ---
- ----------------

SGI has provided a series of patches for these vulnerabilities. Our
recommendation is to upgrade to IRIX 6.5.22, or install the appropriate
patch.

OS Version     Vulnerable?     Patch #      Other Actions
- ----------     -----------     -------      -------------
IRIX 3.x        unknown                     Note 1
IRIX 4.x        unknown                     Note 1
IRIX 5.x        unknown                     Note 1
IRIX 6.0.x      unknown                     Note 1
IRIX 6.1        unknown                     Note 1
IRIX 6.2        unknown                     Note 1
IRIX 6.3        unknown                     Note 1
IRIX 6.4        unknown                     Note 1
IRIX 6.5          no                       Note 2
IRIX 6.5.1        no                       Note 2
IRIX 6.5.2        no                       Note 2
IRIX 6.5.3        no                       Note 2
IRIX 6.5.4        no                       Note 2
IRIX 6.5.5        no                       Note 2
IRIX 6.5.6        no                       Note 2
IRIX 6.5.7        no                       Note 2
IRIX 6.5.8        no                       Note 2
IRIX 6.5.9        no                       Note 2
IRIX 6.5.10       no                       Note 2
IRIX 6.5.11       no                       Note 2
IRIX 6.5.12       no                       Note 2
IRIX 6.5.13       no                       Note 2
IRIX 6.5.14       no                       Note 2
IRIX 6.5.15       no                       Note 2
IRIX 6.5.16       no                       Note 2
IRIX 6.5.17m      no                       Note 2
IRIX 6.5.17f      no                       Note 2
IRIX 6.5.18m      no                       Note 2
IRIX 6.5.18f      no                       Note 2
IRIX 6.5.19m      no                       Note 2
IRIX 6.5.19f      no                       Note 2
IRIX 6.5.20m      no                       Note 2
IRIX 6.5.20f      no                       Note 2
IRIX 6.5.21m      yes         5351         Notes 2 & 3
IRIX 6.5.21f      yes         5352         Notes 2 & 3

   NOTES

     1) This version of the IRIX operating has been retired. Upgrade to
        an actively supported IRIX operating system.  See
        http://support.sgi.com for more information.

     2) If you have not received an IRIX 6.5.X CD for IRIX 6.5, contact
        your SGI Support Provider or URL: http://support.sgi.com

     3) Install the required patch(es) based on your operating release.


                 ##### Patch File Checksums ####

The actual patch will be a tar file containing the following files:
Filename:                 README.patch.5351
Algorithm #1 (sum -r):    59207 9 README.patch.5351
Algorithm #2 (sum):       25490 9 README.patch.5351
MD5 checksum:             4A5E89BBEF3A137C1F11A36FAEE34415

Filename:                 patchSG0005351
Algorithm #1 (sum -r):    53741 4 patchSG0005351
Algorithm #2 (sum):       56934 4 patchSG0005351
MD5 checksum:             EF5A9CBF1235B2E976D49A7BDA25CD39

Filename:                 patchSG0005351.eoe_sw
Algorithm #1 (sum -r):    26982 2261 patchSG0005351.eoe_sw
Algorithm #2 (sum):       42984 2261 patchSG0005351.eoe_sw
MD5 checksum:             B0AED3E664D8683FE2A3CEFDB477AB8A

Filename:                 patchSG0005351.idb
Algorithm #1 (sum -r):    60159 27 patchSG0005351.idb
Algorithm #2 (sum):       33509 27 patchSG0005351.idb
MD5 checksum:             BBA759EA3C097F3515F5FDAB417BBF35

Filename:                 patchSG0005351.irix_dev_sw
Algorithm #1 (sum -r):    28303 6 patchSG0005351.irix_dev_sw
Algorithm #2 (sum):       61327 6 patchSG0005351.irix_dev_sw
MD5 checksum:             4620C4ABA9BF3C15750DEAF70C356BB0

Filename:                 patchSG0005351.nfs_sw
Algorithm #1 (sum -r):    23346 5366 patchSG0005351.nfs_sw
Algorithm #2 (sum):       27765 5366 patchSG0005351.nfs_sw
MD5 checksum:             BE98333C7D44E6DD7D5585DFEBD71E4F

Filename:                 README.patch.5352
Algorithm #1 (sum -r):    02915 9 README.patch.5352
Algorithm #2 (sum):       25190 9 README.patch.5352
MD5 checksum:             262FF1058795C7B65CFB0B4F733F6EC6

Filename:                 patchSG0005352
Algorithm #1 (sum -r):    12260 4 patchSG0005352
Algorithm #2 (sum):       57171 4 patchSG0005352
MD5 checksum:             6E3EE9929644619D068B04228EAA9EA2

Filename:                 patchSG0005352.eoe_sw
Algorithm #1 (sum -r):    62779 2280 patchSG0005352.eoe_sw
Algorithm #2 (sum):       30610 2280 patchSG0005352.eoe_sw
MD5 checksum:             3F01A8C85F88CEBDE726DEA3E10E6723

Filename:                 patchSG0005352.idb
Algorithm #1 (sum -r):    26157 27 patchSG0005352.idb
Algorithm #2 (sum):       33310 27 patchSG0005352.idb
MD5 checksum:             711EE67969FE5FCEAEF03A4F26AA915D

Filename:                 patchSG0005352.irix_dev_sw
Algorithm #1 (sum -r):    28303 6 patchSG0005352.irix_dev_sw
Algorithm #2 (sum):       61327 6 patchSG0005352.irix_dev_sw
MD5 checksum:             4620C4ABA9BF3C15750DEAF70C356BB0

Filename:                 patchSG0005352.nfs_sw
Algorithm #1 (sum -r):    52271 5470 patchSG0005352.nfs_sw
Algorithm #2 (sum):       25867 5470 patchSG0005352.nfs_sw
MD5 checksum:             DD27D2EAA93B94CB1D542096200F2CD1


- -------------
- --- Links ---
- -------------

Patches are available via the web, anonymous FTP and from your SGI
service/support provider.

SGI Security Advisories can be found at:
http://www.sgi.com/support/security/ and
ftp://patches.sgi.com/support/free/security/advisories/

SGI Security Patches can be found at:
http://www.sgi.com/support/security/ and
ftp://patches.sgi.com/support/free/security/patches/

SGI patches for IRIX can be found at the following patch servers:
http://support.sgi.com/ and ftp://patches.sgi.com/

SGI freeware updates for IRIX can be found at:
http://freeware.sgi.com/

SGI fixes for SGI open sourced code can be found on:
http://oss.sgi.com/projects/

SGI patches and RPMs for Linux can be found at:
http://support.sgi.com/ and
ftp://oss.sgi.com/projects/sgi_propack/download/

SGI patches for Windows NT or 2000 can be found at:
http://support.sgi.com/

IRIX 5.2-6.4 Recommended/Required Patch Sets can be found at:
http://support.sgi.com/ and ftp://patches.sgi.com/support/patchset/

IRIX 6.5 Maintenance Release Streams can be found at:
http://support.sgi.com/

IRIX 6.5 Software Update CDs can be obtained from:
http://support.sgi.com/

The primary SGI anonymous FTP site for security advisories and patches
is patches.sgi.com (216.32.174.211).  Security advisories and patches
are located under the URL ftp://patches.sgi.com/support/free/security/

For security and patch management reasons, ftp.sgi.com (mirrors
patches.sgi.com security FTP repository) lags behind and does not
do a real-time update.


- -----------------------------------------
- --- SGI Security Information/Contacts ---
- -----------------------------------------

If there are questions about this document, email can be sent to
security-info@....com.

                      ------oOo------

SGI provides security information and patches for use by the entire SGI
community.  This information is freely available to any person needing
the information and is available via anonymous FTP and the Web.

The primary SGI anonymous FTP site for security advisories and patches
is patches.sgi.com (216.32.174.211).  Security advisories and patches
are located under the URL ftp://patches.sgi.com/support/free/security/

The SGI Security Headquarters Web page is accessible at the URL:
http://www.sgi.com/support/security/

For issues with the patches on the FTP sites, email can be sent to
security-info@....com.

For assistance obtaining or working with security patches, please
contact your SGI support provider.

                      ------oOo------

SGI provides a free security mailing list service called wiretap and
encourages interested parties to self-subscribe to receive (via email)
all SGI Security Advisories when they are released. Subscribing to the
mailing list can be done via the Web
(http://www.sgi.com/support/security/wiretap.html)
or by sending email to SGI as outlined below.

% mail wiretap-request@....com
subscribe wiretap <YourEmailAddress such as midwatch@....com>
end
^d

In the example above, <YourEmailAddress> is the email address that you
wish the mailing list information sent to.  The word end must be on a
separate line to indicate the end of the body of the message. The
control-d (^d) is used to indicate to the mail program that you are
finished composing the mail message.


                      ------oOo------

SGI provides a comprehensive customer World Wide Web site. This site is
located at http://www.sgi.com/support/security/ .

                      ------oOo------

If there are gerneral security questions on SGI systems, email can be
sent to security-info@....com.

For reporting *NEW* SGI security issues, email can be sent to
security-alert@....com or contact your SGI support provider.  A
support contract is not required for submitting a security report.

______________________________________________________________________________

      This information is provided freely to all interested parties
      and may be redistributed provided that it is not altered in any
      way, SGI is appropriately credited and the document retains and
      includes its valid PGP signature.


-----BEGIN PGP SIGNATURE-----
Version: 2.6.2

iQCVAwUBP57hgLQ4cFApAP75AQEjkAP+JkoxCjwtgSoepEERY9nL0QWrMcEm+/4O
JCkAH1yPaPyXOAGUaqmLlVh3ridVJUdiQO+MentqQIXUBmofmx4yszLeJ+bIHrVN
w2RL/j8eWZnexmE5dqFaEpQfErPKf7Z6vFmSqZ5X7eHZDUwG5OLs0ML/BRm28M+K
Nf+uuNANFQ0=
=WCzx
-----END PGP SIGNATURE-----


