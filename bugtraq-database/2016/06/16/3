
Date: Thu, 16 Jun 2016 07:35:00 -0700 (PDT)
From: security-alert@....com
To: bugtraq@...urityfocus.com
Subject: [security bulletin] HPSBNS03625 rev.1 - HPE NonStop Application Server for Java (NSASJ) running SSL/TLS, Remote Disclosure of Information

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Note: the current version of the following document is available here:
https://h20564.www2.hpe.com/portal/site/hpsc/public/kb/docDisplay?docId=emr_n
a-c05176765

SUPPORT COMMUNICATION - SECURITY BULLETIN

Document ID: c05176765
Version: 1

HPSBNS03625 rev.1 - HPE NonStop Application Server for Java (NSASJ) running
SSL/TLS, Remote Disclosure of Information

NOTICE: The information in this Security Bulletin should be acted upon as
soon as possible.

Release Date: 2016-06-15
Last Updated: 2016-06-15

Potential Security Impact: Remote Disclosure of Information

Source: Hewlett Packard Enterprise, Product Security Response Team

VULNERABILITY SUMMARY
NonStop Application Server for Java (NSASJ) has addressed the cross-protocol
Attack on TLS using SSLv2 also known as "DROWN". This vulnerability could be
exploited remotely resulting in disclosure of information.

  Note: NSASJ configurations that have enabled SSL/TLS are vulnerable if
SSLv2 is enabled or they share private keys with systems that have it
enabled.

References:

  - CVE-2016-0800
  - HS03325
  - PSRT110146

SUPPORTED SOFTWARE VERSIONS*: ONLY impacted versions are listed.
NonStop Application Server for Java (NSASJ) - all versions

BACKGROUND

CVSS 2.0 Base Metrics
===========================================================
  Reference              Base Vector             Base Score
CVE-2016-0800    (AV:N/AC:M/Au:N/C:P/I:N/A:N)       4.3
===========================================================
             Information on CVSS is documented
            in HP Customer Notice: HPSN-2008-002

RESOLUTION

HPE has released the following information to resolve the vulnerability in
NonStop Application Server for Java (NSASJ).

To avoid the DROWN vulnerability, the SSLv2 protocol in NSASJ must explicitly
disabled.

The security protocol support in NSASJ is applied through security Realm
settings or through connectors that expose the interface. Disable the SSLv2
protocol either in the connector configuration or the security domain
configuration as shown below.

  **Secure Connector HTTPS and TLS/SSL**

  - To enable TLS/SSL support for a particular instance of a connector, the
secure attribute must be set to true. TLS/SSL support is enabled in the
default NSASJ HTTPS connector configuration.

  - Perform the following steps to complete the TLS/SSL setup:

    1. Create a certificate keystore:

             $JAVA_HOME/bin/keytool -genkey -alias tomcat -keyalg RSA
- -keystore /path/to/my/keystore

        Enter a password when prompted.

    2. Add a SSL tag in the connector configuration.

        If the protocol attribute is not specified, SSLv2 is supported by
default. To disable SSLv2, specify the protocol attribute and do not include
SSLv2.

  The following is a sample configuration that enables only TLSv1.2:

    <connector name="https" protocol="HTTP/1.1" scheme="https" socket
binding="https" secure="true">
      <ssl key-alias="tomcat" protocol="TLSv1.2" password="XXXX"
certificate-key-file="/path/to/my/keystore"/>
    </connector>

  Due to protocol weaknesses, HPE also recommends to disable SSLv3 and
TLSv1.0 by excluding them from the protocol list.

**Applying security restrictions through Security Domains and Realms**

  - Restricting access to all containers and management interfaces of NSASJ
can be done by configuring security domains in appropriate Realms configured
in domain.xml and host.xml files.

  - Each Realm has a server-identities tag which has an ssl element. The
protocols attribute of this tag must be explicitly set to a protocol list
that does not include SSLv2 in order to disable it.

  The following is a sample configuration that enables only TLS 1.2:

    <management>
    <security-realms>
        <security-realm name="ManagementRealm">
            <server-identities>
                <ssl protocol="TLSv1.2">
                    <keystore ..../>
                </ssl>
             </server-identities>
     ...

**Note:** Please see NonStop Hotstuff HS03325 for additional information.

HISTORY
Version:1 (rev.1) - 15 June 2016 Initial release

Third Party Security Patches: Third party security patches that are to be
installed on systems running Hewlett Packard Enterprise (HPE) software
products should be applied in accordance with the customer's patch management
policy.

Support: For issues about implementing the recommendations of this Security
Bulletin, contact normal HPE Services support channel. For other issues about
the content of this Security Bulletin, send e-mail to security-alert@....com.

Report: To report a potential security vulnerability with any HPE supported
product, send Email to: security-alert@....com

Subscribe: To initiate a subscription to receive future HPE Security Bulletin
alerts via Email: http://www.hpe.com/support/Subscriber_Choice

Security Bulletin Archive: A list of recently released Security Bulletins is
available here: http://www.hpe.com/support/Security_Bulletin_Archive

Software Product Category: The Software Product Category is represented in
the title by the two characters following HPSB.

3C = 3COM
3P = 3rd Party Software
GN = HPE General Software
HF = HPE Hardware and Firmware
MU = Multi-Platform Software
NS = NonStop Servers
OV = OpenVMS
PV = ProCurve
ST = Storage Software
UX = HP-UX

Copyright 2016 Hewlett Packard Enterprise

Hewlett Packard Enterprise shall not be liable for technical or editorial
errors or omissions contained herein. The information provided is provided
"as is" without warranty of any kind. To the extent permitted by law, neither
HP or its affiliates, subcontractors or suppliers will be liable for
incidental,special or consequential damages including downtime cost; lost
profits; damages relating to the procurement of substitute products or
services; or damages for loss of data, or software restoration. The
information in this document is subject to change without notice. Hewlett
Packard Enterprise and the names of Hewlett Packard Enterprise products
referenced herein are trademarks of Hewlett Packard Enterprise in the United
States and other countries. Other product and company names mentioned herein
may be trademarks of their respective owners.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQEcBAEBAgAGBQJXYb4xAAoJEGIGBBYqRO9/kJ0H/Rh5I1eZSLHrTNe00k9zqwv6
PcZXe5eeqOaDRSImq2DxR7HdASc05+GTxL9DzfNYLMGYUUk73IrAc4BYfxBEaHnC
W49nW4+GMdGu7OLtno4enUyI3KczBnIoWAZYrS5vWyCLr6wl6SL86H1CmfdPQ2c/
GsOdxgyV3NoXJt7NC6gDu+KlUNOSyHIULNqrVXDCt3wqVwhtZZaY0GT4M0bIkI0R
us4F+kTnDHh3sq6WUXchbEakic4/NK87GJ5fEE7rBy2lh4jlVI5Wv+G/tXloUxn9
skJHf8VmtxuEx9M3UE0+GvrS9Y/m+XeaqRYwSGjsJIa8uGl1j+ao60dMb8uSL+E=
=ZoSL
-----END PGP SIGNATURE-----
