
Date: Fri, 01 Jan 2016 13:02:05 +0100
From: Ralf Spenneberg <info@...t.de>
To: bugtraq@...urityfocus.com
Subject: OSS-2016-03: Insufficient Integrity Protection in Winkhaus Bluesmart locking systems using Hitag S

OS-S Security Advisory 2016-03

Date: January 1st,  2016
Updated: January 1st, 2016
Authors: Oguzhan Cicek, Hendrik Schwartke, Ralf Spenneberg
CVE: Not yet assigned
CVSS: 6.2 (AV:L/AC:L/Au:S/C:C/I:C/A:N)
Title: Insufficient Integrity Protection in Winkhaus Bluesmart locking systems 
using Hitag S
Severity: Critical. The locking permissions may be restored by the attacker 
after modification by the system
Ease of Exploitation: Trivial
Vulnerability: Insufficient integrity protection
Product: Winkhaus Bluesmart using Hitag S and Bluecontrol Virtuell 5.2.0

Abstract
The Winkhaus Bluesmart locking system stores the locking permissions and the 
time windows, when the permissions may be executed, on a Hitag S transponder 
located oin the tip of the plastic key. If an attacker is able to extract the 
data stored on the transponder according to our advisory 2016-2 he also has 
access to the locking permissions and time windows. Although the information 
is protected against manipulation via encryption, if the permissions or the 
time windows are modified by the system later the attacker is still able to 
restore the orginal permissions and time windows. The locks will not detect 
this manipulation.

Scenario
Often when deploying a new RFID based locking system not all required locking 
permissions are known. To ease the launch very often all users get initially 
global almost unlimited access. The actually required permissions are analyzed 
and then enforced in a second step. This is especially true in case of the 
Winkhaus Bluesmart system. Here the users may be required to retrieve new 
permissions and time windows in a daily routine using a special reader.
The attacker may restore his original permissions and time windows if such a 
restriction took place. The locks do not detect the modification of these 
permissions.

Technical Background
The memory layout of the transponder used by the Winkhaus Bluesmart is shown 
below:

see online pdf version: http://www.os-s.de/advisories/oss-advisory-2016-03.pdf

The red information is read-protected. The grey areas are encrypted using AES. 
The time windows and the locking permissions are stored in different areas. 
They may be read and written using a replay attack or if the actual Hitag-S 
key has been broken. Copying the data to a different key is detected by the 
system. 

Vendor contact
We reached out to Winkhaus on Juli 13th, 2015 via phone. On Juli 16th, 2015 we 
elaborated our findings in a personal meeting.
-- 
OpenSource Security Ralf Spenneberg         http://www.os-s.de
Am Bahnhof 3-5                          48565 Steinfurt         Germany
Fon:   +49(0)2552 638 755            Fax: +49(0)2552 638 757

