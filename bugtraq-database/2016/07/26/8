
Date: Tue, 26 Jul 2016 14:27:47 GMT
From: ak47464659484@...il.com
To: bugtraq@...urityfocus.com
Subject: Silurus Classifieds XSS Vulnerability

Title: Silurus Classifieds XSS Vulnerability
Software : Silurus Classifieds

Software Version : v2.0

Vendor: http://snowhall.com/slides/silurus

Vulnerability Published : 2016-07-25

Author&#65306;zhiwei_jiang 
Email:ak47464659484@...il.com
Impact : Medium(CVSS2 Base : 4.3, AV:N/AC:M/Au:N/C:N/I:P/A:N)

Bug Description :
Silurus is a professionally developed Open Source PHP Classifieds script that was built for you. Whether you are running classifieds for autos, motorcycles, bicycles, rvï¿½s, guns, horses, or general merchandise, our product is the right package for you. It has template system and no limit to usage with free for any changes.
Silurus Classifieds (ver v2.0) The server reads data directly from the HTTP request and reflects it back in the HTTP response. Reflected XSS exploits occur when an attacker causes a victim to supply dangerous content to a vulnerable web application, which is then reflected back to the victim and executed by the web browser. The most common mechanism for delivering malicious content is to include it as a parameter in a URL that is posted publicly or e-mailed directly to the victim. URLs constructed in this manner constitute the core of many phishing schemes, whereby an attacker convinces a victim to visit a URL that refers to a vulnerable site. After the site reflects the attacker's content back to the victim, the content is executed by the victim's browser. 

PoC:
Login DEMO
http://silurus.snowhall.com/admin/
Once logged in
POST:
http://silurus.snowhall.com/admin/test_mail.php

send=1&email=test%40email.tst%27%22%28%29%26%25%3C%3E%3CScRiPt%3Ealert%28%2Fxss%2F%29%3C%2FScRiPt%3E&go=Check+email+settings

Solution :
Using such encode functions as htmlencode() or filtering those certain symbols regarding JavaScript as well as Html.
