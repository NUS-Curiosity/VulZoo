
Date: Mon, 29 Feb 2016 14:28:06 GMT
From: matthias.deeg@...s.de
To: bugtraq@...urityfocus.com
Subject: [SYSS-2015-069] perfact::mpa - Insecure Direct Object References

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Advisory ID: SYSS-2015-069
Product: perfact::mpa
Manufacturer: PerFact Innovation GmbH & Co. KG
Affected Version(s): Custom versions using PerFact DB_Utils (Toolkit) < v3.2
Tested Version(s): Custom version with PerFact DB_Utils (Toolkit) < v3.2
Vulnerability Type: Insecure Direct Object References (CWE-932)
Risk Level: High
Solution Status: Fixed
Manufacturer Notification: 2015-12-18
Solution Date: 2016-01-18
Public Disclosure: 2016-02-29
CVE Reference: Not yet assigned
Authors of Advisory: Matthias Deeg and Sven Freund (SySS GmbH)

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Overview:

The software solution perfact::mpa is a software architecture that, for
instance, is used to build web applications for the secure and reliable
remote maintenance of machines via the Internet (see [1]).

According to the manufacturer, remote control software built with
perfact::mpa impresses through the following features:

* location-independent and central monitoring,
* maintenance and error management,
* authorized remote access, and
* integrated documentation of incidents and services.

Due to improper authorization checks, any logged in user can download
valid VPN configuration files of arbitrary existing remote sessions.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Vulnerability Details:

The SySS GmbH found out that any logged in user is able to download
valid VPN configuration files of arbitrary existing remote sessions.

All an intruder needs to know is the URL with the dynamic parameter 
"brsessid". Due to the modification of this incremental increasing
integer value, it is possible to enumerate and download a valid
VPN configuration file for every existing remote session.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Proof of Concept (PoC):

The following URL is an exemplary request to download a valid VPN
configuration file for the remote session identified by the ID
"brsessid":

https://<HOST>/<PATH>/MPA2/RoleSession/Link/connect?brsess_id=<BRSESSID>&brvpnnode_id=1

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Solution:

According to information by the PerFact Innovation GmbH & Co. KG, the
described security issue has been fixed in PerFact DB_Utils (toolkit)
software version 3.2.

Please contact the manufacturer for further information or support.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclosure Timeline:

2015-12-18: Vulnerability reported to manufacturer
2016-01-18: Response from manufacturer with detailed information about
            the reported security vulnerability and its solution status
2016-02-05: E-mail to manufacturer according two open questions
2016-02-05: Response from manufacturer with further information
2016-02-29: Public release of security advisory

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

References:

[1] Product Web Site for perfact::mpa
    http://perfact.de/mpa/index_html
[2] SySS Security Advisory SYSS-2015-069
    https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2015-069.txt
[3] SySS Responsible Disclosure Policy
    https://www.syss.de/en/responsible-disclosure-policy/

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Credits:

This security vulnerability was found by Matthias Deeg and Sven Freund
of the SySS GmbH.

E-Mail: matthias.deeg (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Matthias_Deeg.asc
Key fingerprint = D1F0 A035 F06C E675 CDB9 0514 D9A4 BF6A 34AD 4DAB

E-Mail: sven.freund (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Sven_Freund.asc
Key fingerprint = DCDB 7627 C1E3 9CE8 62DF 2666 8A5F A853 415D 46DC

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclaimer:

The information provided in this security advisory is provided "as is" 
and without warranty of any kind. Details of this security advisory may 
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web 
site.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Copyright:

Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en

-----BEGIN PGP SIGNATURE-----

iQIcBAEBCgAGBQJW0/AFAAoJENmkv2o0rU2rQSAP/0/zhmg+uzJaPxZJ0/N4y5Jz
IwNr+Dla9lPglGtkGOogmDImR7D10csqYXD4jDCgkJN/yxYCbJYv3anKOPy87yiY
/GNk6vGuzcbGCBmq3sxxF8cuuTygEshTDeGE8lY7HArWq30Kyf9ob2CA8dMPxpA2
SDCv5Glv0I8BFkd3JHlGrs/yLZ4HVRMv1Bnwqzv8PXDWcQPpy7Lhz0z3l3w60aK8
CZCvmgX2nfX1nTgopQqiB/kYqnOK6QkAxvudepfOZqn7cXgM94vd8fnwYW1HRVgK
H8ftEa+UQa0WmvtZ4tEBvav0mGgivw5yixXbZxt0OxyMz585MVHKAu4SgxKfTjNl
z83fvGkxIpSSwjSKNEgy57gHofN9rwOUdvFj35JnUiszcGT0WA1Np3CEGny5TA+N
wj7p7MgkiYglv0DMmHkgvdiow0fgN5Gz9At2D6EINZuw9KR9SdDPmn6utIFMBVbG
mltSyBnPok5jEnPV9KfrXH5XBBsUy2MM1pQla8HYMmaicAvbbfEHy9RboVJCSVKL
pkyMQx1quUph43E0hpPGnIQO7djJJ/bT4aZtFRWTI+tqdB3Z1FvGbzzuRKZabhTh
Sgh0uP+8UecrxG9YLXBb5JK8TKpPZbPXjX1Qlte1/U07XUpcWgXGqNzhVUU7dXHD
q6KQNEPgR3SgCO1bMo+9
=x2/v
-----END PGP SIGNATURE-----
