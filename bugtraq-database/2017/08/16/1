
Date: Wed, 16 Aug 2017 11:12:07 +0200
From: WhiteWinterWolf <bugtraq.lists@...tewinterwolf.com>
To: bugtraq@...urityfocus.com
Subject: FreeBSD <= 10.3 jail SHM hole

AFFECTED PRODUCTS

This issue affects FreeBSD from 7.0 to 10.3 included.


DESCRIPTION

FreeBSD jail incompletely protects the access to the IPC primitives.

The 'allow.sysvipc' setting only affects IPC queues, leaving other IPC
objects unprotected, making them reachable system-wide independently of
the system configuration.

This creates two main weaknesses:

- An attacker able to execute commands in one jail can attack processes
   located outside of the jail by directly accessing their IPC objects.

- An attacker can create a bi-directional covert-channel between two
   otherwise isolated jails.


MITIGATION

There is no mitigation measure available on vulnerable systems.

This issue is fixed in FreeBSD 11.0, the fix is also planned in the
upcoming FreeBSD 10.4 (the fix is already committed to the FreeBSD
STABLE branch, the release is currently scheduled for October, 2017).

There is not fix planned for FreeBSD 10.3.

If you are relying on FreeBSD jail for security purposes, I recommend
to upgrade to a fixed version.


REFERENCES

Details + POC:
https://www.whitewinterwolf.com/posts/2017/08/02/freebsd-jail-shm-hole/
