
Date: Wed, 3 Aug 2011 18:40:12 +0200 (CEST)
From: advisory@...ridge.ch
To: bugtraq@...urityfocus.com
Subject: XSS in WP e-Commerce

Vulnerability ID: HTB23031
Reference: http://www.htbridge.ch/advisory/xss_in_wp_e_commerce.html
Product: WP e-Commerce
Vendor: Instinct Entertainment ( http://getshopped.org/ ) 
Vulnerable Version: 3.8.5 and probably prior
Tested on: 3.8.5
Vendor Notification: 13 July 2011 
Vulnerability Type: XSS (Cross Site Scripting)
Risk level: Medium 
Credit: High-Tech Bridge SA Security Research Lab ( http://www.htbridge.ch/advisory/ ) 

Vulnerability Details:
High-Tech Bridge SA Security Research Lab has discovered vulnerability in WP e-Commerce, which can be exploited to perform cross-site scripting attacks.

Input passed via the cart_messages[] parameter to /wp-content/plugins/wp-e-commerce/wpsc-theme/wpsc-cart_widget.php is not properly sanitised before being returned to the user.
This can be exploited to execute arbitrary HTML and script code in a user's browser session in context of affected website.

The following PoC code is available:

http://[host]/wp-content/plugins/wp-e-commerce/wpsc-theme/wpsc-cart_widget.php?cart_messages[]=%3Cimg%20src=1%20onerror=javascript:alert%28document.cookie%29%3E

Successful exploitation of the vulnerability requires that "register_globals" is enabled.



