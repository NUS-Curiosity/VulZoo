diff --git a/framework/NEWS b/framework/NEWS
index f8f5ee7..f3b6173 100644
--- a/framework/NEWS
+++ b/framework/NEWS
@@ -1,3 +1,6 @@
+setroubleshoot 3.2.27                                      2016-06-21
+ - Do not use dangerous shell=True
+
 setroubleshoot 3.2.26.2                                    2016-06-03
  - bugfix
 
diff --git a/framework/configure.ac b/framework/configure.ac
index dd0407c..bfeb7d0 100644
--- a/framework/configure.ac
+++ b/framework/configure.ac
@@ -1,4 +1,4 @@
-AC_INIT([setroubleshoot], [3.2.26.2],
+AC_INIT([setroubleshoot], [3.2.27],
         [http://bugzilla.redhat.com/bugzilla/enter_bug.cgi?product=setroubleshoot])
 
 AC_CONFIG_SRCDIR(src/setroubleshoot/__init__.py)
diff --git a/framework/src/setroubleshoot/audit_data.py b/framework/src/setroubleshoot/audit_data.py
index 4644de9..043d202 100644
--- a/framework/src/setroubleshoot/audit_data.py
+++ b/framework/src/setroubleshoot/audit_data.py
@@ -864,12 +864,10 @@ def _set_tpath(self):
             else:
                 if path.startswith("/") == False and inodestr:
                     import subprocess
-                    command = "locate -b '\%s'" % path 
+                    command = ["locate", "-b", "\%s" % path]
                     try:
-                        output = subprocess.check_output(command, 
-                                                         stderr=subprocess.STDOUT,
-                                                         shell=True)
-                        ino = int(inodestr)
+                        output = subprocess.check_output(command,
+                                                         stderr=subprocess.STDOUT)
                         for file in output.split("\n"):
                             try:
                                 if int(os.lstat(file).st_ino) == ino:
diff --git a/framework/src/setroubleshoot/signature.py b/framework/src/setroubleshoot/signature.py
index 7e70bc4..eae517d 100755
--- a/framework/src/setroubleshoot/signature.py
+++ b/framework/src/setroubleshoot/signature.py
@@ -520,11 +520,11 @@ def format_details(self, replace=False):
             audit2allow = "/usr/bin/audit2allow"
             if os.path.exist(audit2allow):
                 newbuf = "\n\naudit2allow"
-                p =  Popen([audit2allow], shell=True,stdin=PIPE, stdout=PIPE)
+                p =  Popen([audit2allow], stdin=PIPE, stdout=PIPE)
                 newbuf += p.communicate(avcbuf)[0]
                 if os.path.exists("/var/lib/sepolgen/interface_info"):
                     newbuf += "\naudit2allow -R"
-                    p =  Popen(["%s -R" % audit2allow ], shell=True,stdin=PIPE, stdout=PIPE)
+                    p =  Popen([audit2allow, "-R"], stdin=PIPE, stdout=PIPE)
                     newbuf += p.communicate(avcbuf)[0]
                 avcbuf += newbuf
         except:
