diff --git a/login/login.php b/login/login.php
index 7cde8dd..5c0b439 100644
--- a/login/login.php
+++ b/login/login.php
@@ -84,8 +84,12 @@
 	        
 	        //--------------------------------------------------
 	        // Checking which URL we should redirect the user to
-	        if (isset($_POST["from"])) {
-	        	$from = urldecode($_POST["from"]);
+	        if (isset($_GET['from'])) {
+	        	$from = $_GET['from'];
+			if (preg_match('#^(?:https?:)?//#', $_GET['from'], $m)) {
+				$url = parse_url($_GET['from']);
+				$from = $url['path'] . (!empty($url['query']) ? '?' . $url['query'] : '') . (!empty($url['fragment']) ? '#' . $url['fragment'] : '');
+			}
 	            $redirectTo = ((isset($_SERVER["HTTPS"]) && $_SERVER["HTTPS"] === "on")? "https://" : "http://").$_SERVER["SERVER_NAME"].":".$_SERVER["SERVER_PORT"].$from;
 	        }
 	        else {
