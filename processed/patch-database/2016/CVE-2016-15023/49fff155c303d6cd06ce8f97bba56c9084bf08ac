diff --git a/VERSION b/VERSION
index 10abd6a..5db1411 100755
--- a/VERSION
+++ b/VERSION
@@ -1 +1 @@
-6.6.6
+6.6.7
diff --git a/www/getextension.php b/www/getextension.php
index baede07..f2d5e67 100755
--- a/www/getextension.php
+++ b/www/getextension.php
@@ -36,7 +36,10 @@
 include( 'functions.php' );
 
 $extension = $_GET['extension'];
-if( strpos($extension,'/') || strpos($extension,"\\") or !file_exists($path = $WEBCONFIG['sitefusionPath'].'/extensions/'.$extension) ) {
+$allowedRoot = realpath($WEBCONFIG['sitefusionPath'].'/extensions');
+$path = realpath($allowedRoot.'/'.$extension);
+
+if (!(substr($path, 0, strlen($allowedRoot)) == $allowedRoot && file_exists($path))) {
 	echo "Invalid extension: $extension";
 	exit(1);
 }
