From 8514068150759c1d6a46d4605d2351babfde1601 Mon Sep 17 00:00:00 2001
From: Johan Hedberg <johan.hedberg@intel.com>
Date: Wed, 7 Sep 2016 08:45:12 +0300
Subject: tools/csr: Fix possible buffer overflow

Make sure we don't write past the end of the array.
---
 tools/csr.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/tools/csr.c b/tools/csr.c
index 2c0918909c..15ae7c4fb6 100644
--- a/tools/csr.c
+++ b/tools/csr.c
@@ -2756,7 +2756,7 @@ static int parse_line(char *str)
 
 	off++;
 
-	while (1) {
+	while (length <= sizeof(array) - 2) {
 		value = strtol(off, &end, 16);
 		if (value == 0 && off == end)
 			break;
-- 
cgit 1.2.3-korg

