diff --git a/class.tx_mhhttpbl.php b/class.tx_mhhttpbl.php
index 36ef997..2309868 100644
--- a/class.tx_mhhttpbl.php
+++ b/class.tx_mhhttpbl.php
@@ -138,12 +138,16 @@ function stopOutput() {
 			t3lib_div::devlog('blocking user: ' . $_SERVER['REMOTE_ADDR'], $this->extKey, 1);
 
 		$remote_addr = $_SERVER['REMOTE_ADDR'];
+		$remote_host = gethostbyaddr($remote_addr);
+		$remote_addr_html = htmlspecialchars($remote_addr);
+		$remote_host_html = htmlspecialchars($remote_host);
+
 		$GLOBALS['TYPO3_DB']->exec_INSERTquery('tx_mhhttpbl_blocklog', array('crdate'=>time(), 'tstamp'=>time(), 'block_ip'=>$remote_addr, 'block_type'=>$this->type, 'block_score'=>$this->score));
 
 		$usrHash = t3lib_div::shortMD5(serialize($_SERVER));
 		$stdMsg = "<strong>You have been blocked.</strong><br />Your IP appears to be on the httpbl.org/projecthoneypot.org blacklist.<br /><br />###REQUEST_IP###<br /><br />###USER_TYPE###";
 		$message = (!empty($this->config['message']) ? $stdMsg : $this->pObj->csConvObj->utf8_encode($message, $this->pObj->renderCharset));
-		$message = str_replace('###REQUEST_IP###', '<strong>' . $remote_addr . '</strong> (' . gethostbyaddr($remote_addr) . ')', $message);
+		$message = str_replace('###REQUEST_IP###', '<strong>' . $remote_addr_html . '</strong> (' . $remote_host_html . ')', $message);
 		$message = str_replace('###USER_TYPE###', $this->codes[$this->type], $message);
 
 		$this->pObj->fe_user->setKey('ses','tx_mhhttpbl_hash', $usrHash);
@@ -230,4 +234,4 @@ function addHoneyPot(&$params, &$pObj) {
 	include_once($TYPO3_CONF_VARS[TYPO3_MODE]['XCLASS']['ext/mh_httpbl/class.tx_mhhttpbl.php']);
 }
 
-?>
\ No newline at end of file
+?>
