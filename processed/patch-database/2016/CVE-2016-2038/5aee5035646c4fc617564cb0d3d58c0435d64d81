diff --git a/setup/frames/form.inc.php b/setup/frames/form.inc.php
index e3cdf98f535a..0efb6429fb15 100644
--- a/setup/frames/form.inc.php
+++ b/setup/frames/form.inc.php
@@ -19,9 +19,9 @@
 
 require './libraries/config/setup.forms.php';
 
-$formset_id = isset($_GET['formset']) ? $_GET['formset'] : null;
+$formset_id = PMA_isValid($_GET['formset'], 'scalar') ? $_GET['formset'] : null;
 $mode = isset($_GET['mode']) ? $_GET['mode'] : null;
-if (! isset($forms[$formset_id])) {
+if (! isset($forms[$formset_id]) || substr($formset_id, 0, 1) === '_') {
     PMA_fatalError(__('Incorrect formset, check $formsets array in setup/frames/form.inc.php!'));
 }
 
diff --git a/setup/index.php b/setup/index.php
index 2f8f8a7b0eb2..0cc8edac684b 100644
--- a/setup/index.php
+++ b/setup/index.php
@@ -12,7 +12,7 @@
  */
 require './lib/common.inc.php';
 
-$page = isset($_GET['page']) ? $_GET['page'] : null;
+$page = PMA_isValid($_GET['page'], 'scalar') ? $_GET['page'] : null;
 $page = preg_replace('/[^a-z]/', '', $page);
 if ($page === '') {
     $page = 'index';
@@ -23,7 +23,7 @@
 }
 
 // Handle done action info
-$action_done = isset($_GET['action_done']) ? $_GET['action_done'] : null;
+$action_done = PMA_isValid($_GET['action_done'], 'scalar') ? $_GET['action_done'] : null;
 $action_done = preg_replace('/[^a-z_]/', '', $action_done);
 
 PMA_noCacheHeader();
diff --git a/setup/validate.php b/setup/validate.php
index 5759042aa5a9..6aa402e01533 100644
--- a/setup/validate.php
+++ b/setup/validate.php
@@ -16,9 +16,9 @@
 
 header('Content-type: application/json');
 
-$ids = isset($_POST['id']) ? $_POST['id'] : null;
+$ids = PMA_isValid($_POST['id'], 'scalar') ? $_POST['id'] : null;
 $vids = explode(',', $ids);
-$vals = isset($_POST['values']) ? $_POST['values'] : null;
+$vals = PMA_isValid($_POST['values'], 'scalar') ? $_POST['values'] : null;
 $values = json_decode($vals);
 if (!($values instanceof stdClass)) {
     PMA_fatalError(__('Wrong data'));
