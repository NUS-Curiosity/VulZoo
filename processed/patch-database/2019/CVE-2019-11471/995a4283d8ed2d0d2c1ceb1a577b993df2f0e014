diff --git a/fuzzing/corpus/uaf_heif_context.h_117_1.heic b/fuzzing/corpus/uaf_heif_context.h_117_1.heic
new file mode 100644
index 0000000000..c8826b452e
Binary files /dev/null and b/fuzzing/corpus/uaf_heif_context.h_117_1.heic differ
diff --git a/libheif/heif_context.cc b/libheif/heif_context.cc
index fac3bd9cf3..4fe9ba09d1 100644
--- a/libheif/heif_context.cc
+++ b/libheif/heif_context.cc
@@ -576,6 +576,11 @@ Error HeifContext::interpret_heif_file()
             image->set_is_alpha_channel_of(refs[0]);
 
             auto master_iter = m_all_images.find(refs[0]);
+            if (master_iter == m_all_images.end()) {
+              return Error(heif_error_Invalid_input,
+                           heif_suberror_Nonexisting_item_referenced,
+                           "Non-existing alpha image referenced");
+            }
             if (image.get() == master_iter->second.get()) {
               return Error(heif_error_Invalid_input,
                            heif_suberror_Nonexisting_item_referenced,
