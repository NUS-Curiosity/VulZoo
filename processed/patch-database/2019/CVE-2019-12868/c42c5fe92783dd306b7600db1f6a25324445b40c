diff --git a/app/Model/Server.php b/app/Model/Server.php
index 072505b1ec1..ffffea83d37 100644
--- a/app/Model/Server.php
+++ b/app/Model/Server.php
@@ -3076,6 +3076,9 @@ public function beforeHookBinExec($setting, $value)
 
     public function testForBinExec($value)
     {
+        if (substr($value, 0, 7) === "phar://") {
+            return 'Phar protocol not allowed.';
+        }
         $finfo = finfo_open(FILEINFO_MIME_TYPE);
         if ($value === '') {
             return true;
@@ -3094,6 +3097,9 @@ public function testForBinExec($value)
 
     public function testForWritableDir($value)
     {
+        if (substr($value, 0, 7) === "phar://") {
+            return 'Phar protocol not allowed.';
+        }
         if (!is_dir($value)) {
             return 'Not a valid directory.';
         }
