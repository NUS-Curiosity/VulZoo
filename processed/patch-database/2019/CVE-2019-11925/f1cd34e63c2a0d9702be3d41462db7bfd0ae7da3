diff --git a/hphp/runtime/ext/gd/ext_gd.cpp b/hphp/runtime/ext/gd/ext_gd.cpp
index 96db385c0a42f..df336ea9af08a 100644
--- a/hphp/runtime/ext/gd/ext_gd.cpp
+++ b/hphp/runtime/ext/gd/ext_gd.cpp
@@ -6964,7 +6964,7 @@ static void exif_process_APP12(image_info_type *ImageInfo,
     exif_iif_add_tag(ImageInfo, SECTION_APP12, "Company",
                      TAG_NONE, TAG_FMT_STRING, l1, buffer+2);
     if (length > 2+l1+1) {
-      l2 = php_strnlen(buffer+2+l1+1, length-2-l1+1);
+      l2 = php_strnlen(buffer+2+l1+1, length-2-l1-1);
       exif_iif_add_tag(ImageInfo, SECTION_APP12, "Info",
                        TAG_NONE, TAG_FMT_STRING, l2, buffer+2+l1+1);
     }
diff --git a/hphp/test/slow/ext_gd/exifreaddata_APP12.php b/hphp/test/slow/ext_gd/exifreaddata_APP12.php
new file mode 100644
index 0000000000000..d563a4814688c
--- /dev/null
+++ b/hphp/test/slow/ext_gd/exifreaddata_APP12.php
@@ -0,0 +1,8 @@
+<?hh
+
+<<__EntryPoint>>
+function main_exifreaddata() {
+  $jpeg = "\xff\xd8\xec\x00\x05\x58\x00\x17";
+  $data_stream = "data://text/plain;base64," . base64_encode($jpeg);
+  var_dump(exif_read_data($data_stream));
+}
diff --git a/hphp/test/slow/ext_gd/exifreaddata_APP12.php.expectf b/hphp/test/slow/ext_gd/exifreaddata_APP12.php.expectf
new file mode 100644
index 0000000000000..84a1dbec7b65d
--- /dev/null
+++ b/hphp/test/slow/ext_gd/exifreaddata_APP12.php.expectf
@@ -0,0 +1,4 @@
+Warning: File structure corrupted in %s/ext_gd/exifreaddata_APP12.php on line 7
+
+Warning: Invalid JPEG file in %s/ext_gd/exifreaddata_APP12.php on line 7
+bool(false)
