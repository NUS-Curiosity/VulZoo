diff --git a/DynmapCore/src/main/java/org/dynmap/servlet/MapStorageResourceHandler.java b/DynmapCore/src/main/java/org/dynmap/servlet/MapStorageResourceHandler.java
index 428911087..dccc7da4c 100644
--- a/DynmapCore/src/main/java/org/dynmap/servlet/MapStorageResourceHandler.java
+++ b/DynmapCore/src/main/java/org/dynmap/servlet/MapStorageResourceHandler.java
@@ -46,7 +46,11 @@ public void handle(String target, Request baseRequest, HttpServletRequest reques
         int soff = 0, eoff;
         // We're handling this request
         baseRequest.setHandled(true);
-
+        if(core.getLoginRequired()
+            && request.getSession(true).getAttribute(LoginServlet.USERID_ATTRIB) == null){
+            response.sendError(HttpStatus.UNAUTHORIZED_401);
+            return;
+        }
         if (path.charAt(0) == '/') soff = 1;
         eoff = path.indexOf('/', soff);
         if (soff < 0) {
