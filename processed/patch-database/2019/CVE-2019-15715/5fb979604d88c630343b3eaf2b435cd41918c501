diff --git a/core/graphviz_api.php b/core/graphviz_api.php
index 44b6aa52d2..96721fe2ed 100644
--- a/core/graphviz_api.php
+++ b/core/graphviz_api.php
@@ -352,7 +352,7 @@ function output( $p_format = 'dot', $p_headers = false ) {
 
 		# Start dot process
 
-		$t_command = $this->graphviz_tool . ' -T' . $p_format;
+		$t_command = escapeshellcmd( $this->graphviz_tool . ' -T' . $p_format );
 		$t_descriptors = array(
 			0 => array( 'pipe', 'r', ),
 			1 => array( 'pipe', 'w', ),
