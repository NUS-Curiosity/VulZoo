diff --git a/ChangeLog b/ChangeLog
index 45090302..d9b9546f 100755
--- a/ChangeLog
+++ b/ChangeLog
@@ -1,6 +1,7 @@
 2019-07-25
 - Rework nfpcapd and add it officially to the nfdump collection.
 - Add nfpcapd man page
+- Fix potential unsigned integer underflow #171
 
 2019-07-16
 - Add latency extension if dumping flowcache
diff --git a/bin/ipfix.c b/bin/ipfix.c
index 2d7d0844..b4757e57 100644
--- a/bin/ipfix.c
+++ b/bin/ipfix.c
@@ -1247,7 +1247,7 @@ int i;
 		uint32_t table_id, count, size_required;
 		uint32_t num_extensions = 0;
 
-		if ( size_left && size_left < 4 ) {
+		if ( size_left < 4 ) {
 			LogError("Process_ipfix [%u] Template size error at %s line %u" , 
 				exporter->info.id, __FILE__, __LINE__, strerror (errno));
 			size_left = 0;
@@ -1426,6 +1426,14 @@ ipfix_template_record_t *ipfix_template_record;
 	while ( size_left ) {
 		uint32_t id;
 
+		if ( size_left < 4 ) {
+			LogError("Process_ipfix [%u] Template withdraw size error at %s line %u" , 
+				exporter->info.id, __FILE__, __LINE__, strerror (errno));
+			size_left = 0;
+			continue;
+		}
+
+
 		// map next record.
 		ipfix_template_record = (ipfix_template_record_t *)DataPtr;
 		size_left 		-= 4;
