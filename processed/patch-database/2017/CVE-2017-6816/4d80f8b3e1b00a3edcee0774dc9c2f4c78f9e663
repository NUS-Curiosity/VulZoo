diff --git a/wp-admin/plugins.php b/wp-admin/plugins.php
index 2eeea4eb9f5..3d7ff016e50 100644
--- a/wp-admin/plugins.php
+++ b/wp-admin/plugins.php
@@ -246,6 +246,14 @@
 				exit;
 			}
 
+			// Bail on all if any paths are invalid.
+			// validate_file() returns truthy for invalid files
+			$invalid_plugin_files = array_filter( $plugins, 'validate_file' );
+			if ( $invalid_plugin_files ) {
+				wp_redirect( self_admin_url("plugins.php?plugin_status=$status&paged=$page&s=$s") );
+				exit;
+			}
+
 			include(ABSPATH . 'wp-admin/update.php');
 
 			$parent_file = 'plugins.php';
diff --git a/wp-includes/version.php b/wp-includes/version.php
index 656a2009194..9f9a17f942b 100644
--- a/wp-includes/version.php
+++ b/wp-includes/version.php
@@ -4,7 +4,7 @@
  *
  * @global string $wp_version
  */
-$wp_version = '4.8-alpha-40160';
+$wp_version = '4.8-alpha-40169';
 
 /**
  * Holds the WordPress DB revision, increments when changes are made to the WordPress DB schema.
