diff --git a/print-juniper.c b/print-juniper.c
index e8879ea7b..ff1de9c03 100644
--- a/print-juniper.c
+++ b/print-juniper.c
@@ -1367,6 +1367,7 @@ juniper_parse_header(netdissect_options *ndo,
             if (ndo->ndo_eflag) ND_PRINT((ndo, ": ")); /* print demarc b/w L2/L3*/
 
 
+            ND_TCHECK_16BITS(p+l2info->cookie_len);
             l2info->proto = EXTRACT_16BITS(p+l2info->cookie_len);
             break;
         }
diff --git a/tests/TESTLIST b/tests/TESTLIST
index 659827f81..c0a3f8dd8 100644
--- a/tests/TESTLIST
+++ b/tests/TESTLIST
@@ -493,6 +493,8 @@ pimv2-oobr-4		pimv2-oobr-4.pcap		pimv2-oobr-4.out		-vvv -e
 802_15_4-data		802_15_4-data.pcap		802_15_4-data.out	-vvv -e
 802_15_4_beacon		802_15_4_beacon.pcap		802_15_4_beacon.out	-vvv -e
 lmpv1_busyloop		lmpv1_busyloop.pcap		lmpv1_busyloop.out	-vvv -e
+juniper_atm1		juniper_atm1.pcap		juniper_atm1.out	-vvv -e
+juniper_es		juniper_es.pcap			juniper_es.out	-vvv -e
 
 # RTP tests
 # fuzzed pcap
diff --git a/tests/juniper_atm1.out b/tests/juniper_atm1.out
new file mode 100644
index 000000000..27f99bd00
--- /dev/null
+++ b/tests/juniper_atm1.out
@@ -0,0 +1,2 @@
+Out 
+	Juniper PCAP Flags [none]ATM1-PIC, cookie-len 4, cookie 0x30303030: [|juniper_hdr], length 808464432
diff --git a/tests/juniper_atm1.pcap b/tests/juniper_atm1.pcap
new file mode 100644
index 000000000..fc29d299a
Binary files /dev/null and b/tests/juniper_atm1.pcap differ
diff --git a/tests/juniper_es.out b/tests/juniper_es.out
new file mode 100644
index 000000000..e344d70ed
--- /dev/null
+++ b/tests/juniper_es.out
@@ -0,0 +1,2 @@
+Out 
+	Juniper PCAP Flags [none]ES-PIC, cookie-len 0: [|juniper_hdr], length 808464432
diff --git a/tests/juniper_es.pcap b/tests/juniper_es.pcap
new file mode 100644
index 000000000..8f28aa1fa
Binary files /dev/null and b/tests/juniper_es.pcap differ
