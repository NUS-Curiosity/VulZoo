diff --git a/rutil/dns/ares/ares_parse_a_reply.c b/rutil/dns/ares/ares_parse_a_reply.c
index 2733fe4424..100f3848d7 100644
--- a/rutil/dns/ares/ares_parse_a_reply.c
+++ b/rutil/dns/ares/ares_parse_a_reply.c
@@ -103,6 +103,12 @@ int ares_parse_a_reply(const unsigned char *abuf, int alen,
       rr_class = DNS_RR_CLASS(aptr);
       rr_len = DNS_RR_LEN(aptr);
       aptr += RRFIXEDSZ;
+      if (aptr + rr_len > abuf + alen)
+	{
+	  free(rr_name);
+	  status = ARES_EBADRESP;
+	  break;
+	}
 
       if (rr_class == C_IN && rr_type == T_A
 	  && rr_len == sizeof(struct in_addr)
