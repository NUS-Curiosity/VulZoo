diff --git a/public/viewer.php b/public/viewer.php
index c697dd7..d4e9625 100644
--- a/public/viewer.php
+++ b/public/viewer.php
@@ -21,7 +21,7 @@
 
 $filelocation = __DIR__ . "/images/$type/$file.$type";
 
-if ( ! file_exists($filelocation)) {
+if ( ! file_exists(realpath($filelocation)) || ! array_key_exists($type, $types) ) {
     header('HTTP/1.0 404 Not Found');
     include_once __DIR__ . '/protected/templates/error.phtml';
     die();
