diff --git a/contentmap.php b/contentmap.php
old mode 100755
new mode 100644
diff --git a/extras/lib_contentmap/json/articlesmarkers.php b/extras/lib_contentmap/json/articlesmarkers.php
index 4a0ff67..2d57702 100644
--- a/extras/lib_contentmap/json/articlesmarkers.php
+++ b/extras/lib_contentmap/json/articlesmarkers.php
@@ -355,7 +355,7 @@ protected function Load()
 		$query->from("#__content");
 
 		// Condition: content id passed py plugin
-		$query->where("id = '" . JRequest::getVar("contentid", 0, "GET") . "'");
+		$query->where("id = '" . intval(JRequest::getVar("contentid", 0, "GET")) . "'");
 
 		// Condition: metadata field contains "xreference":"coordinates"
 		// {\"xreference\":\"} the string "xreference":"
diff --git a/extras/lib_contentmap/language/cs-CZ/cs-CZ.contentmap.ini b/extras/lib_contentmap/language/cs-CZ/cs-CZ.contentmap.ini
old mode 100755
new mode 100644
diff --git a/extras/lib_contentmap/language/en-GB/en-GB.contentmap.ini b/extras/lib_contentmap/language/en-GB/en-GB.contentmap.ini
old mode 100755
new mode 100644
diff --git a/extras/lib_contentmap/language/es-ES/es-ES.contentmap.ini b/extras/lib_contentmap/language/es-ES/es-ES.contentmap.ini
old mode 100755
new mode 100644
diff --git a/extras/lib_contentmap/language/fr-FR/fr-FR.contentmap.ini b/extras/lib_contentmap/language/fr-FR/fr-FR.contentmap.ini
old mode 100755
new mode 100644
diff --git a/extras/lib_contentmap/language/it-IT/it-IT.contentmap.ini b/extras/lib_contentmap/language/it-IT/it-IT.contentmap.ini
old mode 100755
new mode 100644
diff --git a/extras/lib_contentmap/language/nb-NO/nb-NO.contentmap.ini b/extras/lib_contentmap/language/nb-NO/nb-NO.contentmap.ini
old mode 100755
new mode 100644
diff --git a/extras/lib_contentmap/language/nl-NL/nl-NL.contentmap.ini b/extras/lib_contentmap/language/nl-NL/nl-NL.contentmap.ini
old mode 100755
new mode 100644
diff --git a/extras/lib_contentmap/language/pt-BR/pt-BR.contentmap.ini b/extras/lib_contentmap/language/pt-BR/pt-BR.contentmap.ini
old mode 100755
new mode 100644
diff --git a/extras/lib_contentmap/language/ru-RU/ru-RU.contentmap.ini b/extras/lib_contentmap/language/ru-RU/ru-RU.contentmap.ini
old mode 100755
new mode 100644
diff --git a/extras/lib_contentmap/language/sv-SE/sv-SE.contentmap.ini b/extras/lib_contentmap/language/sv-SE/sv-SE.contentmap.ini
old mode 100755
new mode 100644
diff --git a/extras/lib_contentmap/media/js/markerclusterer.js b/extras/lib_contentmap/media/js/markerclusterer.js
old mode 100755
new mode 100644
diff --git a/extras/lib_contentmap/media/js/markerclusterer_compiled.js b/extras/lib_contentmap/media/js/markerclusterer_compiled.js
old mode 100755
new mode 100644
diff --git a/extras/mod_contentmap/mod_contentmap.xml b/extras/mod_contentmap/mod_contentmap.xml
old mode 100755
new mode 100644
diff --git a/extras/plg_contentmap/contentmap.xml b/extras/plg_contentmap/contentmap.xml
old mode 100755
new mode 100644
diff --git a/site/views/smartloader/view.html.php b/site/views/smartloader/view.html.php
index 5812c56..fd8c1ab 100644
--- a/site/views/smartloader/view.html.php
+++ b/site/views/smartloader/view.html.php
@@ -11,6 +11,10 @@ function display($tpl = null)
 		// Load module || component || plugin parameters. Defaults to plugin
 		$owner = JRequest::getVar("owner", "", "GET") or $owner = "plugin"; // getVar() default value doesn't work with ?owner=""
 
+		if (!in_array($owner,array('module','plugin','component','article'))){
+			die();
+		}
+		
 		$db = JFactory::getDbo();
 		jimport("joomla.database.databasequery");
 		$query = $db->getQuery(true);
