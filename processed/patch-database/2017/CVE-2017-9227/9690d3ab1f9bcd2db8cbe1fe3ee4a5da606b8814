diff --git a/src/regexec.c b/src/regexec.c
index d4e577d9..2fa0f3d3 100644
--- a/src/regexec.c
+++ b/src/regexec.c
@@ -3154,6 +3154,8 @@ forward_search_range(regex_t* reg, const UChar* str, const UChar* end, UChar* s,
     }
     else {
       UChar *q = p + reg->dmin;
+
+      if (q >= end) return 0; /* fail */
       while (p < q) p += enclen(reg->enc, p);
     }
   }
