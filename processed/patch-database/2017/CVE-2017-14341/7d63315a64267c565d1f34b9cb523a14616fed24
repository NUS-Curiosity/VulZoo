diff --git a/coders/wpg.c b/coders/wpg.c
index ae43f9cc364..4756dba3f4c 100644
--- a/coders/wpg.c
+++ b/coders/wpg.c
@@ -1035,6 +1035,8 @@ static Image *ReadWPGImage(const ImageInfo *image_info,
           if(i==EOF)
             break;
           Rd_WP_DWORD(image,&Rec.RecordLength);
+          if (Rec.RecordLength > GetBlobSize(image))
+            ThrowReaderException(CorruptImageError,"ImproperImageHeader");
           if(EOFBlob(image))
             break;
 
