diff --git a/src/test/java/io/scif/util/DefaultSampleFilesService.java b/src/test/java/io/scif/util/DefaultSampleFilesService.java
index b9e9f437e..548a47018 100644
--- a/src/test/java/io/scif/util/DefaultSampleFilesService.java
+++ b/src/test/java/io/scif/util/DefaultSampleFilesService.java
@@ -159,6 +159,9 @@ private void downloadAndUnpackResource(final Location source,
 				if (entry == null) break; // All done!
 				final String name = entry.getName();
 				final File outFile = new File(targetFolder, name);
+				if (!outFile.toPath().normalize().startsWith(targetFolder.toPath().normalize())) {
+					throw new RuntimeException("Bad zip entry");
+				}
 				if (entry.isDirectory()) {
 					outFile.mkdirs();
 				}
