diff --git a/src/indent.c b/src/indent.c
index 794fa2c3430bc..fa177bcf2c791 100644
--- a/src/indent.c
+++ b/src/indent.c
@@ -2029,6 +2029,8 @@ get_lisp_indent(void)
 			    }
 			}
 		    }
+		    if (*that == NUL)
+			break;
 		}
 		if (*that == '(' || *that == '[')
 		    ++parencount;
diff --git a/src/testdir/test_indent.vim b/src/testdir/test_indent.vim
index be55227bd20cb..3b5b643177b4e 100644
--- a/src/testdir/test_indent.vim
+++ b/src/testdir/test_indent.vim
@@ -144,6 +144,16 @@ func Test_lisp_indent()
   close!
 endfunc
 
+func Test_lisp_indent_quoted()
+  " This was going past the end of the line
+  new
+  setlocal lisp autoindent
+  call setline(1, ['"[', '='])
+  normal Gvk=
+
+  bwipe!
+endfunc
+
 " Test for setting the 'indentexpr' from a modeline
 func Test_modeline_indent_expr()
   let modeline = &modeline
diff --git a/src/version.c b/src/version.c
index 89e1fa1b7aff8..5411e1c189f3e 100644
--- a/src/version.c
+++ b/src/version.c
@@ -734,6 +734,8 @@ static char *(features[]) =
 
 static int included_patches[] =
 {   /* Add new patch number below this line */
+/**/
+    5122,
 /**/
     5121,
 /**/
