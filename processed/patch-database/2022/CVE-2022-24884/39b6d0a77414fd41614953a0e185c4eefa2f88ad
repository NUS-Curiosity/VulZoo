diff --git a/CMakeLists.txt b/CMakeLists.txt
index 2ddadc2..2656c60 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -1,6 +1,6 @@
 cmake_minimum_required(VERSION 2.8.3)
 project(ECDSAUTIL C)
-set(ECDSAUTIL_VERSION 0.4.0)
+set(ECDSAUTIL_VERSION 0.4.1)
 
 set(CMAKE_MODULE_PATH ${ECDSAUTIL_SOURCE_DIR})
 find_package(libuecc REQUIRED)
diff --git a/src/lib/ecdsa.c b/src/lib/ecdsa.c
index 8cd7722..a661b56 100644
--- a/src/lib/ecdsa.c
+++ b/src/lib/ecdsa.c
@@ -135,6 +135,12 @@ void ecdsa_sign_legacy(ecdsa_signature_t *signature, const ecc_int256_t *hash, c
 void ecdsa_verify_prepare_legacy(ecdsa_verify_context_t *ctx, const ecc_int256_t *hash, const ecdsa_signature_t *signature) {
   ecc_int256_t w, u1, tmp;
 
+  if (ecc_25519_gf_is_zero(&signature->s) || ecc_25519_gf_is_zero(&signature->r)) {
+    // Signature is invalid, mark by setting ctx->r to an invalid value
+    memset(&ctx->r, 0, sizeof(ctx->r));
+    return;
+  }
+
   ctx->r = signature->r;
 
   ecc_25519_gf_recip(&w, &signature->s);
@@ -149,6 +155,10 @@ bool ecdsa_verify_legacy(const ecdsa_verify_context_t *ctx, const ecc_25519_work
   ecc_25519_work_t s2, work;
   ecc_int256_t w, tmp;
 
+  // Signature was detected as invalid in prepare step
+  if (ecc_25519_gf_is_zero(&ctx->r))
+    return false;
+
   ecc_25519_scalarmult(&s2, &ctx->u2, pubkey);
   ecc_25519_add(&work, &ctx->s1, &s2);
   ecc_25519_store_xy_legacy(&w, NULL, &work);
