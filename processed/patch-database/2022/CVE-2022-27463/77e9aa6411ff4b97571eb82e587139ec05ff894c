diff --git a/objects/login.json.php b/objects/login.json.php
index 25461f09a8c0..e184cd8ad49f 100644
--- a/objects/login.json.php
+++ b/objects/login.json.php
@@ -30,7 +30,7 @@
 Category::clearCacheCount();
 TimeLogEnd($timeLog, __LINE__);
 
-if (!preg_match("|^" . $global['webSiteRootURL'] . "|", $_POST['redirectUri'])) {
+if(!isSameDomain($global['webSiteRootURL'], $_POST['redirectUri'])){
     $_POST['redirectUri'] = $global['webSiteRootURL'];
 }
 _error_log("Start Login Request redirectUri=" . $_POST['redirectUri']);
