diff --git a/composer.json b/composer.json
index cae52a5..a682cf1 100644
--- a/composer.json
+++ b/composer.json
@@ -16,7 +16,7 @@
 	},
 	"require": {
 		"ext-dom": "*",
-		"masterminds/html5": "^2.7",
+		"masterminds/html5": "^2.7.6",
 		"php": "^7.2 || ^8.0",
 		"psr/log": "^1.0 || ^2.0 || ^3.0"
 	},
diff --git a/tests/ScenarioTest.php b/tests/ScenarioTest.php
index 4ab7084..4df460f 100644
--- a/tests/ScenarioTest.php
+++ b/tests/ScenarioTest.php
@@ -21,6 +21,28 @@
 
 class ScenarioTest extends TestCase
 {
+    public static function allTagsAreRemovedOnMissingDeclarationDataProvider(): array
+    {
+        return [
+            ['<div class="content">value</div><span class="content">value</span>', ''],
+            ['<!--any--><div class="content">value</div>', '<!--any-->'],
+            ['<!--any--!><div class="content">value</div>', '<!--any-->'],
+        ];
+    }
+
+    /**
+     * @test
+     * @dataProvider allTagsAreRemovedOnMissingDeclarationDataProvider
+     */
+    public function allTagsAreRemovedOnMissingDeclaration(string $payload, string $expectation): void
+    {
+        $behavior = new Behavior();
+        $sanitizer = new Sanitizer(
+            new CommonVisitor($behavior)
+        );
+        self::assertSame($expectation, $sanitizer->sanitize($payload));
+    }
+
     public static function tagFlagsAreProcessedDataProvider(): array
     {
         return [
