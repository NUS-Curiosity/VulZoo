diff --git a/opendiamond/dataretriever/augment_store.py b/opendiamond/dataretriever/augment_store.py
index 00ed5bff..5d8cd8dd 100644
--- a/opendiamond/dataretriever/augment_store.py
+++ b/opendiamond/dataretriever/augment_store.py
@@ -24,7 +24,7 @@
 from flask import Blueprint, url_for, Response, stream_with_context, send_file, \
     jsonify
 from werkzeug.datastructures import Headers
-from werkzeug.utils import safe_join
+from werkzeug.security import safe_join
 from opendiamond.dataretriever.util import read_file_list, write_data
 
 
diff --git a/opendiamond/dataretriever/diamond_store.py b/opendiamond/dataretriever/diamond_store.py
index 0bcb1160..27c75184 100644
--- a/opendiamond/dataretriever/diamond_store.py
+++ b/opendiamond/dataretriever/diamond_store.py
@@ -17,6 +17,7 @@
 from flask import Blueprint, url_for, Response, stream_with_context, send_file, \
     jsonify
 from werkzeug.datastructures import Headers
+from werkzeug.security import safe_join
 
 from opendiamond.dataretriever.util import ATTR_SUFFIX
 
@@ -120,11 +121,11 @@ def _get_object_src_uri(object_path):
 
 
 def _get_obj_absolute_path(obj_path):
-    return os.path.join(DATAROOT, obj_path)
+    return safe_join(DATAROOT, obj_path)
 
 
 def _get_index_absolute_path(index):
-    return os.path.join(INDEXDIR, index)
+    return safe_join(INDEXDIR, index)
 
 
 @scope_blueprint.route('/obj/<path:obj_path>')
diff --git a/opendiamond/dataretriever/mixer_store.py b/opendiamond/dataretriever/mixer_store.py
index f816d870..a9b55ae0 100644
--- a/opendiamond/dataretriever/mixer_store.py
+++ b/opendiamond/dataretriever/mixer_store.py
@@ -24,6 +24,7 @@
 from flask import Blueprint, url_for, Response, stream_with_context, send_file, \
     jsonify
 from werkzeug.datastructures import Headers
+from werkzeug.security import safe_join
 
 BASEURL = 'cocktail'
 STYLE = False
@@ -249,11 +250,11 @@ def _get_obj_path(obj_path):
     return obj_path.replace(DATAROOT+'/', '')
 
 def _get_obj_absolute_path(obj_path):
-    return os.path.join(DATAROOT, obj_path)
+    return safe_join(DATAROOT, obj_path)
 
 
 def _get_index_absolute_path(index):
-    return os.path.join(INDEXDIR, index)
+    return safe_join(INDEXDIR, index)
 
 
 @scope_blueprint.route('/obj/<path:obj_path>')
diff --git a/opendiamond/dataretriever/test_store.py b/opendiamond/dataretriever/test_store.py
index 0b5d7307..c3dbbcb8 100644
--- a/opendiamond/dataretriever/test_store.py
+++ b/opendiamond/dataretriever/test_store.py
@@ -24,6 +24,8 @@
 from flask import Blueprint, url_for, Response, stream_with_context, send_file, \
     jsonify
 from werkzeug.datastructures import Headers
+from werkzeug.security import safe_join
+
 from opendiamond.dataretriever.test_utils import *
 
 
@@ -279,11 +281,11 @@ def _get_obj_path(obj_path):
     return obj_path.replace(DATAROOT+'/', '')
 
 def _get_obj_absolute_path(obj_path):
-    return os.path.join(DATAROOT, obj_path)
+    return safe_join(DATAROOT, obj_path)
 
 
 def _get_index_absolute_path(index):
-    return os.path.join(INDEXDIR, index)
+    return safe_join(INDEXDIR, index)
 
 
 @scope_blueprint.route('/obj/<path:obj_path>')
diff --git a/opendiamond/dataretriever/video_store.py b/opendiamond/dataretriever/video_store.py
index 7d36ec6c..00dfe1aa 100644
--- a/opendiamond/dataretriever/video_store.py
+++ b/opendiamond/dataretriever/video_store.py
@@ -21,6 +21,7 @@
 from flask import Blueprint, Response, request, stream_with_context, url_for
 from opendiamond.dataretriever.util import DiamondTextAttr
 from werkzeug.datastructures import Headers
+from werkzeug.security import safe_join
 
 # IMPORTANT: requires ffmpeg >= 3.3. Lower versions produce incorrect clipping.
 
@@ -122,11 +123,11 @@ def _get_object_element(start, span, video):
 
 
 def _get_obj_absolute_path(obj_path):
-    return os.path.join(DATAROOT, obj_path)
+    return safe_join(DATAROOT, obj_path)
 
 
 def _get_index_absolute_path(index):
-    return os.path.join(INDEXDIR, index)
+    return safe_join(INDEXDIR, index)
 
 
 def _ffprobe(video_path):
diff --git a/opendiamond/dataretriever/yfcc100m_mysql_store.py b/opendiamond/dataretriever/yfcc100m_mysql_store.py
index 8ee4634c..c8ac1b24 100644
--- a/opendiamond/dataretriever/yfcc100m_mysql_store.py
+++ b/opendiamond/dataretriever/yfcc100m_mysql_store.py
@@ -29,6 +29,7 @@
 import logging
 import mysql.connector
 from werkzeug.datastructures import Headers
+from werkzeug.security import safe_join
 from xml.sax.saxutils import quoteattr
 
 BASEURL = 'yfcc100m_mysql'
@@ -124,7 +125,7 @@ def get_object_id(dataset, seq_no):
 
 @scope_blueprint.route('/obj/<dataset>/<path:rel_path>')
 def get_object_src_http(dataset, rel_path):
-    path = _get_obj_abosolute_path(dataset, rel_path)
+    path = _get_obj_absolute_path(dataset, rel_path)
     response = send_file(path,
                          cache_timeout=datetime.timedelta(
                              days=365).total_seconds(),
@@ -133,8 +134,8 @@ def get_object_src_http(dataset, rel_path):
     return response
 
 
-def _get_obj_abosolute_path(dataset, rel_path):
-    return os.path.join(DATAROOT, dataset, rel_path)
+def _get_obj_absolute_path(dataset, rel_path):
+    return safe_join(DATAROOT, dataset, rel_path)
 
 
 def _get_object_element(dataset, seq_no, rel_path, download_link):
@@ -162,7 +163,7 @@ def _get_object_element(dataset, seq_no, rel_path, download_link):
         rel_path, download_link = row[0], row[1]
 
     if LOCAL_OBJ_URI:
-        src_uri = 'file://' + os.path.join(DATAROOT, dataset, rel_path)
+        src_uri = 'file://' + _get_obj_absolute_path(dataset, rel_path)
     else:
         src_uri = url_for('.get_object_src_http', dataset=dataset, rel_path=rel_path)
 
