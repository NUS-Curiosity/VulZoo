diff --git a/libsofia-sip-ua/sip/sip_parser.c b/libsofia-sip-ua/sip/sip_parser.c
index 0fa1cb7b..95a5efa7 100644
--- a/libsofia-sip-ua/sip/sip_parser.c
+++ b/libsofia-sip-ua/sip/sip_parser.c
@@ -454,6 +454,10 @@ sip_method_t sip_method_d(char **ss, char const **return_name)
 
 #undef MATCH
 
+  if (strlen(s) < n) {
+    return sip_method_invalid;
+  }
+
   if (IS_NON_WS(s[n]))
     /* Unknown method */
     code = sip_method_unknown;
