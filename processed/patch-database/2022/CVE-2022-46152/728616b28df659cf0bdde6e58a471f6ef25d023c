diff --git a/core/tee/entry_std.c b/core/tee/entry_std.c
index 0ec47e42745..d933d54d5d2 100644
--- a/core/tee/entry_std.c
+++ b/core/tee/entry_std.c
@@ -254,7 +254,7 @@ static void cleanup_shm_refs(const uint64_t *saved_attr,
 {
 	size_t n;
 
-	for (n = 0; n < num_params; n++) {
+	for (n = 0; n < MIN((unsigned int)TEE_NUM_PARAMS, num_params); n++) {
 		switch (saved_attr[n]) {
 		case OPTEE_MSG_ATTR_TYPE_TMEM_INPUT:
 		case OPTEE_MSG_ATTR_TYPE_TMEM_OUTPUT:
