diff --git a/application/controllers/IndexController.php b/application/controllers/IndexController.php
index cd3b2e3..dd967fc 100644
--- a/application/controllers/IndexController.php
+++ b/application/controllers/IndexController.php
@@ -154,6 +154,7 @@ public function topicAction()
 
         $form = new Application_Form_Comment();
         $form->topicId->setValue($post->id);
+        $form->getElement('csrfToken')->setValue($this->generateCommentToken());
 
         $this->view->form = $form;
 
@@ -234,7 +235,10 @@ public function ajaxaddcommentAction()
             if ($form->isValid($this->getRequest()->getPost())) {
                 $formData = $form->getValues();
 
-                $this->saveComment($topicId, $url, $formData);
+                if ($this->validCommentToken($formData['csrfToken'])) {
+                    $this->saveComment($topicId, $url, $formData);
+                }
+
                 $result['valid'] = true;
             } else {
                 $formView = new Zend_View;
@@ -413,4 +417,29 @@ protected function isCDN()
             && (stripos($_SERVER['HTTP_VIA'], 'BunnyCDN') !== false
                 || strpos($_SERVER['HTTP_VIA'], 'cdn77') !== false);
     }
+
+    private function generateCommentToken($time = null): string
+    {
+        $time = $time ?? time();
+        $userAgent = $_SERVER['HTTP_USER_AGENT'] ?? '';
+
+        return base64_encode($time . ':' . hash('md5', 'MD5_' . $userAgent . $time, true));
+    }
+
+    private function validCommentToken($token): bool
+    {
+        $raw = base64_decode($token, true);
+        if ($raw === false) {
+            return false;
+        }
+
+        $position = strpos($raw, ':');
+        if ($position === false) {
+            return false;
+        }
+
+        $time = substr($raw, 0, $position);
+
+        return hash_equals($this->generateCommentToken($time), $token);
+    }
 }
diff --git a/application/forms/Comment.php b/application/forms/Comment.php
index 6c6095e..f4afeea 100644
--- a/application/forms/Comment.php
+++ b/application/forms/Comment.php
@@ -85,6 +85,10 @@ public function init()
             $this->checkCookie();
         }
 
+        $csrfToken = new Zend_Form_Element_Hidden('csrfToken');
+        $csrfToken->addValidator('NotEmpty');
+        $this->addElement($csrfToken);
+
         $this->setElementDecorators($this->elementDecorators);
     }
 
diff --git a/application/views/scripts/index/formcomment.phtml b/application/views/scripts/index/formcomment.phtml
index 2802637..e9b3ea3 100644
--- a/application/views/scripts/index/formcomment.phtml
+++ b/application/views/scripts/index/formcomment.phtml
@@ -17,6 +17,7 @@
         <?php echo $this->form->topicId; ?>
         <?php echo $this->form->parentId; ?>
         <?php echo $this->form->cookie; ?>
+        <?php echo $this->form->csrfToken; ?>
     </div>
     <div class="ym-fbox-button">
         <button type="submit" class="ym-button ym-add" id="submit" name="submit">Добавить комментарий</button>
