diff --git a/src/main/java/com/github/junrar/Archive.java b/src/main/java/com/github/junrar/Archive.java
index 7af74a57c..47baa3edc 100644
--- a/src/main/java/com/github/junrar/Archive.java
+++ b/src/main/java/com/github/junrar/Archive.java
@@ -45,6 +45,7 @@
 import com.github.junrar.rarfile.RARVersion;
 import com.github.junrar.rarfile.SignHeader;
 import com.github.junrar.rarfile.SubBlockHeader;
+import com.github.junrar.rarfile.SubBlockHeaderType;
 import com.github.junrar.rarfile.UnixOwnersHeader;
 import com.github.junrar.rarfile.UnrarHeadertype;
 import com.github.junrar.unpack.ComprDataIO;
@@ -449,7 +450,9 @@ private void readHeaders(final long fileLength) throws IOException, RarException
                             final SubBlockHeader subHead = new SubBlockHeader(blockHead,
                                 subHeadbuffer);
                             subHead.print();
-                            switch (subHead.getSubType()) {
+                            SubBlockHeaderType subType = subHead.getSubType();
+                            if (subType == null) break;
+                            switch (subType) {
                                 case MAC_HEAD: {
                                     final byte[] macHeaderbuffer = safelyAllocate(MacInfoHeader.MacInfoHeaderSize, MAX_HEADER_SIZE);
                                     rawData.readFully(macHeaderbuffer, macHeaderbuffer.length);
diff --git a/src/test/java/com/github/junrar/AbnormalFilesTest.java b/src/test/java/com/github/junrar/AbnormalFilesTest.java
index 405bc9f32..fa09f4841 100644
--- a/src/test/java/com/github/junrar/AbnormalFilesTest.java
+++ b/src/test/java/com/github/junrar/AbnormalFilesTest.java
@@ -58,7 +58,8 @@ public void extractFromStream(String filePath, Class<?> expectedException) throw
     private static Stream<Arguments> provideFilesAndExpectedExceptionType() {
         return Stream.of(
             Arguments.of("abnormal/corrupt-header.rar", CorruptHeaderException.class),
-            Arguments.of("abnormal/mainHeaderNull.rar", BadRarArchiveException.class)
+            Arguments.of("abnormal/mainHeaderNull.rar", BadRarArchiveException.class),
+            Arguments.of("abnormal/loop.rar", CorruptHeaderException.class)
         );
     }
 }
diff --git a/src/test/resources/com/github/junrar/abnormal/loop.rar b/src/test/resources/com/github/junrar/abnormal/loop.rar
new file mode 100644
index 000000000..8f9db1f6f
Binary files /dev/null and b/src/test/resources/com/github/junrar/abnormal/loop.rar differ
