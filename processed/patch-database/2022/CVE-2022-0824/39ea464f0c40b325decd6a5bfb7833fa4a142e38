diff --git a/web-lib-funcs.pl b/web-lib-funcs.pl
index 984a2bf773..76826e2510 100755
--- a/web-lib-funcs.pl
+++ b/web-lib-funcs.pl
@@ -5144,7 +5144,8 @@ sub init_config
 	}
 
 if ($module_name && !$main::no_acl_check &&
-    !defined($ENV{'FOREIGN_MODULE_NAME'}) &&
+    (!defined($ENV{'FOREIGN_MODULE_NAME'}) ||
+      defined($ENV{'FOREIGN_MODULE_SEC_CHECK'})) &&
     $main::webmin_script_type eq 'web') {
 	# Check if the HTTP user can access this module
 	if (!&foreign_available($module_name)) {
