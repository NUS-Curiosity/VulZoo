diff --git a/lib/asciidoctor/include_ext/include_processor.rb b/lib/asciidoctor/include_ext/include_processor.rb
index 5bd52d0..c2723d0 100644
--- a/lib/asciidoctor/include_ext/include_processor.rb
+++ b/lib/asciidoctor/include_ext/include_processor.rb
@@ -113,10 +113,16 @@ def resolve_target_path(target, reader)
     #   the line number. If `nil` is given, all lines are passed.
     # @return [Array<String>] an array of read lines.
     def read_lines(path, selector)
-      if selector
-        IO.foreach(path).select.with_index(1, &selector)
-      else
-        URI.open(path, &:read)
+      # IO.open is deliberately not used directly to avoid potential security risks.
+      # TODO: Get rid of 'open-uri' (URI.open).
+      io = target_http?(path) ? URI : File
+
+      io.open(path) do |f|
+        if selector
+          f.each.select.with_index(1, &selector)
+        else
+          f.read
+        end
       end
     end
 
