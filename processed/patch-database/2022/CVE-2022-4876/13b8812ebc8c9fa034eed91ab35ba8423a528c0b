diff --git a/includes/DefaultSettings.php b/includes/DefaultSettings.php
index 592d3c91a6..b9b70d843e 100644
--- a/includes/DefaultSettings.php
+++ b/includes/DefaultSettings.php
@@ -10,8 +10,12 @@
 {
     // support multiple hosts (comma separated) in HTTP_X_FORWARDED_HOST
     $xForwardedHosts = explode(',', $_SERVER['HTTP_X_FORWARDED_HOST']);
-    $_SERVER["HTTP_HOST"] = $xForwardedHosts[0];
-    $_SERVER["SERVER_NAME"] = $xForwardedHosts[0];
+    $VALID_HOSTNAME_PATTERN = "/^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\\-]*[A-Za-z0-9])$/";
+    if (preg_match($VALID_HOSTNAME_PATTERN, $xForwardedHosts[0]) === 1)
+    {
+        $_SERVER["HTTP_HOST"] = $xForwardedHosts[0];
+        $_SERVER["SERVER_NAME"] = $xForwardedHosts[0];
+    }
 }
 
 // The default cache directory
