diff --git a/plugins/docman/include/Docman_Widget_MyDocmanSearch.class.php b/plugins/docman/include/Docman_Widget_MyDocmanSearch.class.php
index 047e49bd442..bfb020ab3a2 100644
--- a/plugins/docman/include/Docman_Widget_MyDocmanSearch.class.php
+++ b/plugins/docman/include/Docman_Widget_MyDocmanSearch.class.php
@@ -83,7 +83,10 @@ public function getContent()
                 $itemPerm = $dPm->userCanAccess($user, $docman_id);
 
                 if ($itemPerm) {
-                    $html .= '<p><a data-test="document-search-link" href="/plugins/docman/?group_id=' . $res['group_id'] . '&action=details&id=' . $docman_id . '&section=properties">Show &quot;' . $res['title'] . '&quot; Properties</a></p>';
+                    $purifier = Codendi_HTMLPurifier::instance();
+                    $html    .= '<p><a data-test="document-search-link" href="/plugins/docman/?group_id=' . urlencode((string) $res['group_id']) . '&action=details&id=' . urlencode((string) $docman_id) . '&section=properties">Show &quot;';
+                    $html    .=  $purifier->purify($res['title']);
+                    $html    .= '&quot; Properties</a></p>';
                     return $html;
                 }
             }
diff --git a/plugins/docman/include/view/Docman_View_Admin_LockInfos.class.php b/plugins/docman/include/view/Docman_View_Admin_LockInfos.class.php
index a9a4cfbb95e..e2374cb13d1 100644
--- a/plugins/docman/include/view/Docman_View_Admin_LockInfos.class.php
+++ b/plugins/docman/include/view/Docman_View_Admin_LockInfos.class.php
@@ -114,12 +114,16 @@ private function getTable($params)
                 }
                 $parent   = $dIF->getItemFromDb($item->getParentId());
                 $content .= '<tr>';
-                $content .= '<td>' . '<a href="/plugins/docman/?group_id=' . $params['group_id'] . '&action=details&id=' . $item->getId() . '">' . $item->getTitle() . '</a></td>';
+                $content .= '<td>' . '<a href="/plugins/docman/?group_id=' . urlencode((string) $params['group_id']) . '&action=details&id=' . urlencode((string) $item->getId()) . '">';
+                $content .= $hp->purify($item->getTitle());
+                $content .= '</a></td>';
                 $content .= '<td>';
                 if ($parent === null || $dIF->isRoot($parent)) {
                     $content .= '</td>';
                 } else {
-                    $content .=  '<a href="' . $this->defaultUrl . '&action=show&id=' . $parent->getId() . '">' . $parent->getTitle() . '</a></td>';
+                    $content .=  '<a href="' . $this->defaultUrl . '&action=show&id=' . urlencode((string) $parent->getId()) . '">';
+                    $content .= $hp->purify($parent->getTitle());
+                    $content .= '</a></td>';
                 }
                 $content .= '<td>' . $hp->purify($uH->getDisplayNameFromUserId($row['user_id'])) . '</td>';
                 $content .= '<td>' . format_date($GLOBALS['Language']->getText('system', 'datefmt'), $row['lock_date']) . '</td>';
