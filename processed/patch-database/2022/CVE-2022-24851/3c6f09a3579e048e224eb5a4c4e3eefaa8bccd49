diff --git a/lam/HISTORY b/lam/HISTORY
index 0e811fac7..789b2aa09 100644
--- a/lam/HISTORY
+++ b/lam/HISTORY
@@ -2,6 +2,7 @@ June 2022 8.0
   - Extended user account status and locking options
   - Fixed bugs:
    -> Hidden account is displayed (257)
+   -> Security issues in PDF editor and profile editor
 
 09.03.2022 7.9
   - Tree view:
diff --git a/lam/lib/html.inc b/lam/lib/html.inc
index 83e78b699..d05bb7c5a 100644
--- a/lam/lib/html.inc
+++ b/lam/lib/html.inc
@@ -558,10 +558,10 @@ class htmlInputField extends htmlElement {
 		}
 		if (isset($values[$this->fieldName])) {
 			if (isObfuscatedText($values[$this->fieldName][0])) {
-				$this->fieldValue = deobfuscateText($values[$this->fieldName][0]);
+				$this->fieldValue = htmlspecialchars(deobfuscateText($values[$this->fieldName][0]));
 			}
 			else {
-				$this->fieldValue = $values[$this->fieldName][0];
+				$this->fieldValue = htmlspecialchars($values[$this->fieldName][0]);
 			}
 		}
 		$validators = array();
diff --git a/lam/templates/pdfedit/pdfpage.php b/lam/templates/pdfedit/pdfpage.php
index 7b5be430b..7d11c44c3 100644
--- a/lam/templates/pdfedit/pdfpage.php
+++ b/lam/templates/pdfedit/pdfpage.php
@@ -13,6 +13,7 @@
 use \htmlResponsiveInputTextarea;
 use \htmlHiddenInput;
 use \htmlSpacer;
+use LAM\PDF\PdfLogo;
 use LAM\PDF\PdfStructurePersistenceManager;
 use LAM\PDF\PDFTextSection;
 use LAM\PDF\PDFEntrySection;
@@ -23,7 +24,7 @@
 /*
   This code is part of LDAP Account Manager (http://www.ldap-account-manager.org/)
   Copyright (C) 2003 - 2006  Michael Duergner
-                2007 - 2021  Roland Gruber
+                2007 - 2022  Roland Gruber
 
   This program is free software; you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
@@ -132,8 +133,9 @@
 	}
 }
 
+$logoFiles = $pdfStructurePersistenceManager->getPdfLogos($_SESSION['config']->getName(), true);
 if (!empty($_POST['form_submit'])) {
-	updateBasicSettings($_SESSION['currentPDFStructure']);
+	updateBasicSettings($_SESSION['currentPDFStructure'], $logoFiles);
 	updateSectionTitles($_SESSION['currentPDFStructure']);
 	addSection($_SESSION['currentPDFStructure']);
 	addSectionEntry($_SESSION['currentPDFStructure']);
@@ -228,7 +230,6 @@
 // headline
 $headline = $_SESSION['currentPDFStructure']->getTitle();
 // logo
-$logoFiles = $pdfStructurePersistenceManager->getPdfLogos($_SESSION['config']->getName(), true);
 $logos = array(_('No logo') => 'none');
 foreach($logoFiles as $logoFile) {
 	$logos[$logoFile->getName() . ' (' . $logoFile->getWidth() . ' x ' . $logoFile->getHeight() . ")"] = $logoFile->getName();
@@ -516,16 +517,28 @@ function translateFieldIDToName($id, $scope, $availablePDFFields) {
 /**
  * Updates basic settings such as logo and head line.
  *
- * @param PDFStructure $structure
+ * @param PDFStructure $structure PDF structure
+ * @param PdfLogo[] $logoFiles logos
  */
-function updateBasicSettings(PDFStructure &$structure) {
+function updateBasicSettings(PDFStructure &$structure, array $logoFiles) {
 	// set headline
 	if (isset($_POST['headline'])) {
 		$structure->setTitle(str_replace('<', '', str_replace('>', '', $_POST['headline'])));
 	}
 	// set logo
 	if (isset($_POST['logoFile'])) {
-		$structure->setLogo($_POST['logoFile']);
+	    $fileName = $_POST['logoFile'];
+	    $found = false;
+	    foreach ($logoFiles as $logoFile) {
+	        if ($logoFile->getName() === $fileName) {
+	            $found = true;
+            }
+        }
+	    if (!$found) {
+	        logNewMessage(LOG_ERR, 'Invalid PDF logo file: ' . $fileName);
+	        return;
+        }
+		$structure->setLogo($fileName);
 	}
 	// set folding marks
 	if (isset($_POST['foldingmarks'])) {
