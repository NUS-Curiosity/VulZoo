diff --git a/Products/ATContentTypes/skins/ATContentTypes/image_view_fullscreen.pt b/Products/ATContentTypes/skins/ATContentTypes/image_view_fullscreen.pt
index a22af266..e21f8500 100644
--- a/Products/ATContentTypes/skins/ATContentTypes/image_view_fullscreen.pt
+++ b/Products/ATContentTypes/skins/ATContentTypes/image_view_fullscreen.pt
@@ -46,15 +46,19 @@
 <body>
 
 <div id="content-core">
+  <tal:block define="referer request/HTTP_REFERER;
+                     url_tool nocall:context/portal_url;
+                     referer python:referer if referer and url_tool.isURLInPortal(referer) else '';">
     <a href=""
-       tal:attributes="href request/HTTP_REFERER"
-       tal:condition="request/HTTP_REFERER"
+       tal:attributes="href referer"
+       tal:condition="referer"
        ><span i18n:translate="label_back_to_site">Back to site</span><br /><tal:block replace="structure context/tag" /></a>
 
     <a href=""
-       tal:attributes="href context/portal_url"
-       tal:condition="not: request/HTTP_REFERER"
+       tal:attributes="href python:url_tool()"
+       tal:condition="not: referer"
        ><span i18n:translate="label_home">Home</span><br /><tal:block replace="structure context/tag" /></a>
+      </tal:block>
 </div>
 
 </body>
diff --git a/news/1.bugfix b/news/1.bugfix
new file mode 100644
index 00000000..0f70abe9
--- /dev/null
+++ b/news/1.bugfix
@@ -0,0 +1,3 @@
+Security fix: prevent cache poisoning with the Referer header.
+See `security advisory <https://github.com/plone/Products.ATContentTypes/security/advisories/GHSA-g4c2-ghfg-g5rh>`.
+[maurits]
