diff --git a/index.js b/index.js
index 769ae60..cb86d5f 100644
--- a/index.js
+++ b/index.js
@@ -1,3 +1,4 @@
+var timingSafeCompare = require('tsscmp');
 var http = require('http');
 
 /*!
@@ -53,7 +54,9 @@ module.exports = function basicAuth(callback, realm) {
     if ('string' != typeof password) throw new Error('password argument required');
     realm = arguments[2];
     callback = function(user, pass){
-      return user == username && pass == password;
+      const usernameValid = timingSafeCompare(user, username);
+      const passwordValid = timingSafeCompare(pass, password);
+      return usernameValid && passwordValid;
     }
   }
 
diff --git a/package.json b/package.json
index a5d7b00..749972b 100644
--- a/package.json
+++ b/package.json
@@ -18,12 +18,15 @@
     "url": "https://github.com/expressjs/basic-auth-connect/issues"
   },
   "devDependencies": {
+    "connect": "*",
     "mocha": "*",
     "should": "*",
-    "supertest": "*",
-    "connect": "*"
+    "supertest": "*"
   },
   "scripts": {
     "test": "make test"
+  },
+  "dependencies": {
+    "tsscmp": "^1.0.6"
   }
 }
