diff --git a/config/config.yaml b/config/config.yaml
index 892d7c3b91e..8dcbc51a2e5 100644
--- a/config/config.yaml
+++ b/config/config.yaml
@@ -244,3 +244,6 @@ assets:
     u2f_api:
         basePath: '%webroot%/library/js/'
         script: u2f-api.js
+    dompurify:
+        basePath: '%assets_static_relative%/'
+        script: dompurify/dist/purify.js
diff --git a/package-lock.json b/package-lock.json
index 9ec0d224f92..b552e513c70 100644
--- a/package-lock.json
+++ b/package-lock.json
@@ -28,6 +28,7 @@
         "datatables.net-jqui": "1.13.6",
         "datatables.net-scroller": "2.2.0",
         "datatables.net-scroller-jqui": "2.2.0",
+        "dompurify": "3.0.8",
         "dropzone": "5.9.3",
         "dwv": "0.27.1",
         "flot": "4.2.6",
@@ -4383,10 +4384,9 @@
       }
     },
     "node_modules/dompurify": {
-      "version": "2.4.7",
-      "resolved": "https://registry.npmjs.org/dompurify/-/dompurify-2.4.7.tgz",
-      "integrity": "sha512-kxxKlPEDa6Nc5WJi+qRgPbOAbgTpSULL+vI3NUXsZMlkJxTqYI9wg5ZTay2sFrdZRWHPWNi+EdAhcJf81WtoMQ==",
-      "optional": true
+      "version": "3.0.8",
+      "resolved": "https://registry.npmjs.org/dompurify/-/dompurify-3.0.8.tgz",
+      "integrity": "sha512-b7uwreMYL2eZhrSCRC4ahLTeZcPZxSmYfmcQGXGkXiZSNW1X85v+SDM5KsWcpivIiUBH47Ji7NtyUdpLeF5JZQ=="
     },
     "node_modules/download": {
       "version": "6.2.5",
@@ -9017,6 +9017,12 @@
         "html2canvas": "^1.0.0-rc.5"
       }
     },
+    "node_modules/jspdf/node_modules/dompurify": {
+      "version": "2.4.7",
+      "resolved": "https://registry.npmjs.org/dompurify/-/dompurify-2.4.7.tgz",
+      "integrity": "sha512-kxxKlPEDa6Nc5WJi+qRgPbOAbgTpSULL+vI3NUXsZMlkJxTqYI9wg5ZTay2sFrdZRWHPWNi+EdAhcJf81WtoMQ==",
+      "optional": true
+    },
     "node_modules/jszip": {
       "version": "3.10.1",
       "resolved": "https://registry.npmjs.org/jszip/-/jszip-3.10.1.tgz",
diff --git a/package.json b/package.json
index 96f2a6a9e0d..ff656d55c61 100644
--- a/package.json
+++ b/package.json
@@ -85,6 +85,7 @@
     "datatables.net-jqui": "1.13.6",
     "datatables.net-scroller": "2.2.0",
     "datatables.net-scroller-jqui": "2.2.0",
+    "dompurify": "3.0.8",
     "dropzone": "5.9.3",
     "dwv": "0.27.1",
     "flot": "4.2.6",
diff --git a/portal/messaging/messages.php b/portal/messaging/messages.php
index fade05437ac..e2aee857091 100644
--- a/portal/messaging/messages.php
+++ b/portal/messaging/messages.php
@@ -109,9 +109,9 @@ function getAuthPortalUsers()
     <meta charset="utf-8" />
     <?php
     if (IS_PORTAL) {
-        Header::setupHeader(['no_main-theme',  'portal-theme', 'ckeditor', 'angular', 'angular-sanitize', 'checklist-model']);
+        Header::setupHeader(['no_main-theme',  'portal-theme', 'ckeditor', 'angular', 'angular-sanitize', 'checklist-model', 'dompurify']);
     } else {
-        Header::setupHeader(['ckeditor', 'angular', 'angular-sanitize', 'checklist-model']);
+        Header::setupHeader(['ckeditor', 'angular', 'angular-sanitize', 'checklist-model', 'dompurify']);
     }
     ?>
     <title><?php echo xlt("Secure Messaging"); ?></title>
@@ -333,12 +333,13 @@ function getAuthPortalUsers()
                 };
 
                 $scope.renderMessageBody = function (html) {
+                    html = DOMPurify.sanitize(html, { USE_PROFILES: { html: true } });
                     return html;
                 };
 
                 $scope.htmlToText = function (html) {
                     const hold = document.createElement('DIV');
-                    hold.innerHTML = html;
+                    hold.innerHTML = DOMPurify.sanitize(html, { USE_PROFILES: { html: true } });
                     return jsText(hold.textContent || hold.innerText || '');
                 };
 
