diff --git a/share/h2o/mruby/acl.rb b/share/h2o/mruby/acl.rb
index 7a7ba53ef0..90d6062838 100644
--- a/share/h2o/mruby/acl.rb
+++ b/share/h2o/mruby/acl.rb
@@ -41,6 +41,9 @@ def acl(&block)
 
     class ACLHandler
 
+      class TooEarlyError < StandardError
+      end
+
       class ConditionalHandler
         def initialize(handler, cond)
           @handler = handler
@@ -63,9 +66,13 @@ def initialize(&block)
       end
 
       def call(env)
-        @acl.each {|ac|
-          return ac.call(env) if ac.satisfy?(env)
-        }
+        begin
+          @acl.each {|ac|
+            return ac.call(env) if ac.satisfy?(env)
+          }
+        rescue TooEarlyError => e
+          return [425, {}, []]
+        end
         return [399, {}, []]
       end
 
@@ -96,6 +103,7 @@ def initialize(env)
         end
 
         def addr(forwarded=true)
+          raise TooEarlyError if @env['HTTP_EARLY_DATA']
           addr = @env['REMOTE_ADDR']
           if forwarded && (xff = @env['HTTP_X_FORWARDED_FOR'])
             xaddr = xff.split(",")[0]
