diff --git a/include/lib/fileUploadLib.inc.php b/include/lib/fileUploadLib.inc.php
index df5e5518d3..206e4a8b16 100644
--- a/include/lib/fileUploadLib.inc.php
+++ b/include/lib/fileUploadLib.inc.php
@@ -541,6 +541,11 @@ function isWhitelistAllowed($filename) {
 
     $whitelist = explode(',', preg_replace('/\s+/', '', $wh)); // strip any whitespace
 
+    // Hard-code common PHP file extensions exclusion
+    if (preg_match('/\.(php.?|phtml|phar)$/i', $filename)) {
+        return false;
+    }
+
     if (in_array('*', $whitelist)) {
         return true;
     }
