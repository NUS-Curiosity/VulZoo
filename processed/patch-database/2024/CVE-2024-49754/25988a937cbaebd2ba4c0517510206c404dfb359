diff --git a/includes/html/forms/token-item-create.inc.php b/includes/html/forms/token-item-create.inc.php
index 21aa501ca2ac..64f74dc5a185 100644
--- a/includes/html/forms/token-item-create.inc.php
+++ b/includes/html/forms/token-item-create.inc.php
@@ -18,17 +18,13 @@
     exit('ERROR: You need to be admin');
 }
 
-if (! is_numeric($_POST['user_id']) || ! isset($_POST['token'])) {
+$token = bin2hex(openssl_random_pseudo_bytes(16));
+
+if (! is_numeric($_POST['user_id'])) {
     echo 'ERROR: error with data, please ensure a valid user and token have been specified.';
     exit;
-} elseif (strlen($_POST['token']) > 32) {
-    echo 'ERROR: The token is more than 32 characters';
-    exit;
-} elseif (strlen($_POST['token']) < 16) {
-    echo 'ERROR: The token is less than 16 characters';
-    exit;
 } else {
-    $create = dbInsert(['user_id' => $_POST['user_id'], 'token_hash' => $_POST['token'], 'description' => $_POST['description']], 'api_tokens');
+    $create = dbInsert(['user_id' => $_POST['user_id'], 'token_hash' => $token, 'description' => $_POST['description']], 'api_tokens');
     if ($create > '0') {
         echo 'API token has been created';
         Session::put('api_token', true);
diff --git a/includes/html/pages/api-access.inc.php b/includes/html/pages/api-access.inc.php
index 1a6898fb1d19..9777a68aef08 100644
--- a/includes/html/pages/api-access.inc.php
+++ b/includes/html/pages/api-access.inc.php
@@ -17,9 +17,7 @@
 use LibreNMS\Authentication\LegacyAuth;
 
 if (Auth::user()->hasGlobalAdmin()) {
-    if (empty($_POST['token'])) {
-        $_POST['token'] = bin2hex(openssl_random_pseudo_bytes(16));
-    } ?>
+?>
   <div class="modal fade" id="confirm-delete" tabindex="-1" role="dialog" aria-labelledby="Delete" aria-hidden="true">
     <div class="modal-dialog modal-sm">
       <div class="modal-content">
@@ -64,14 +62,6 @@
                 </select>
               </div>
             </div>
-            <div class="form-group">
-              <label for="token" class="col-sm-2 control-label">Token: </label>
-              <div class="col-sm-8">
-                <input type="text" class="form-control" id="token" name="token" value="<?php echo htmlspecialchars($_POST['token']); ?>" readonly>
-              </div>
-              <div class="col-sm-2">
-              </div>
-            </div>
             <div class="form-group">
               <label for="description" class="col-sm-2 control-label">Descr: </label>
               <div class="col-sm-10">
@@ -147,10 +137,10 @@
 
         echo '
         <tr id="' . $api->id . '" ' . $color . '>
-          <td>' . $user_details->username . '</td>
-          <td>' . $user_details->auth_type . '</td>
-          <td>' . $api->token_hash . '</td>
-          <td><button class="btn btn-info btn-xs" data-toggle="modal" data-target="#display-qr" data-token_hash="' . $api->token_hash . '"><i class="fa fa-qrcode" ></i></button></td>
+          <td>' . htmlentities($user_details->username) . '</td>
+          <td>' . htmlentities($user_details->auth_type) . '</td>
+          <td>' . htmlentities($api->token_hash) . '</td>
+          <td><button class="btn btn-info btn-xs" data-toggle="modal" data-target="#display-qr" data-token_hash="' . htmlentities($api->token_hash) . '"><i class="fa fa-qrcode" ></i></button></td>
           <td>' . htmlspecialchars($api->description) . '</td>
           <td><input type="checkbox" name="token-status" data-token_id="' . $api->id . '" data-off-text="No" data-on-text="Yes" data-on-color="danger" ' . $api_disabled . ' data-size="mini"></td>
           <td><button type="button" class="btn btn-danger btn-xs" id="' . $api->id . '" data-token_id="' . $api->id . '" data-toggle="modal" data-target="#confirm-delete">Delete</button></td>
