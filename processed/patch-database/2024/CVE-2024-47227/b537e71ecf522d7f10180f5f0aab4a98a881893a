diff --git a/ChangeLog b/ChangeLog
index 1e04ccb..d7a31ba 100644
--- a/ChangeLog
+++ b/ChangeLog
@@ -5,6 +5,8 @@
       Defaults to `False`.
 
 * Fixed issues:
+    - 2 possible XSS vulnerabilities.
+      Thanks to Simone Quatrini @surecloudcyber.com.
     - Incorrect time zone (America/Sao_Paulo, GMT-03:00).
       Thanks to Guilherme Rauth.
 
diff --git a/controllers/ldap/user.py b/controllers/ldap/user.py
index a423614..9e1f497 100644
--- a/controllers/ldap/user.py
+++ b/controllers/ldap/user.py
@@ -24,6 +24,11 @@ def GET(self, domain, cur_page=1, disabled_only=False):
         form = web.input()
 
         order_name = form.get('order_name')
+
+        # Currently only sorting by `name` and `quota` are supported.
+        if order_name not in ["name", "quota"]:
+            order_name = "name"
+
         order_by_desc = (form.get('order_by', 'asc').lower() == 'desc')
 
         first_char = None
diff --git a/controllers/sql/user.py b/controllers/sql/user.py
index 3dac540..69b4e64 100644
--- a/controllers/sql/user.py
+++ b/controllers/sql/user.py
@@ -23,7 +23,13 @@ def GET(self, domain, cur_page=1, disabled_only=False):
         cur_page = int(cur_page) or 1
 
         form = web.input(_unicode=False)
+
         order_name = form.get('order_name')
+
+        # Currently only sorting by `name` and `quota` are supported.
+        if order_name not in ["name", "quota"]:
+            order_name = "name"
+
         order_by_desc = (form.get('order_by', 'asc').lower() == 'desc')
 
         records = []
diff --git a/libs/sqllib/user.py b/libs/sqllib/user.py
index 72519e1..a0c5561 100644
--- a/libs/sqllib/user.py
+++ b/libs/sqllib/user.py
@@ -315,7 +315,6 @@ def get_paged_users(conn,
                 limit=settings.PAGE_SIZE_LIMIT,
                 offset=(cur_page - 1) * settings.PAGE_SIZE_LIMIT,
             )
-
         else:
             qr = conn.select(
                 'mailbox',
diff --git a/templates/default/ldap/user/list.html b/templates/default/ldap/user/list.html
index b3f917d..6678bb5 100644
--- a/templates/default/ldap/user/list.html
+++ b/templates/default/ldap/user/list.html
@@ -197,10 +197,19 @@ <h2>
                         {% set baseurl = ctx.homepath + '/users/' + cur_domain + '/disabled' %}
                     {% endif %}
 
+                    {% set url_suffix = "" %}
+
+                    {% if order_name in ["name", "quota"] %}
+                        {% set url_suffix = "?order_name=" + order_name %}
+                        {% if order_by_desc %}
+                            {% set url_suffix = url_suffix + "&order_by=desc" %}
+                        {% endif %}
+                    {% endif %}
+
                     {{ show_pages(baseurl=baseurl,
                                   total=total,
                                   cur_page=cur_page,
-                                  url_suffix=ctx.query) }}
+                                  url_suffix=url_suffix) }}
                 </div>
                 {% endif %}
             </form>
diff --git a/templates/default/sql/user/list.html b/templates/default/sql/user/list.html
index f2a31d4..644641f 100644
--- a/templates/default/sql/user/list.html
+++ b/templates/default/sql/user/list.html
@@ -230,10 +230,19 @@ <h2>
                           total=total,
                           cur_page=cur_page) }}
         {% else %}
+            {% set url_suffix = "" %}
+
+            {% if order_name in ["name", "quota"] %}
+                {% set url_suffix = "?order_name=" + order_name %}
+                {% if order_by_desc %}
+                    {% set url_suffix = url_suffix + "&order_by=desc" %}
+                {% endif %}
+            {% endif %}
+
             {{ show_pages(baseurl=baseurl,
                           total=total,
                           cur_page=cur_page,
-                          url_suffix=ctx.query) }}
+                          url_suffix=url_suffix) }}
         {% endif %}
     </div>
     {% endif %}
