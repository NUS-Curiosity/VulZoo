diff --git a/app/Controller/ProjectPermissionController.php b/app/Controller/ProjectPermissionController.php
index 21f0ddb0f9..02efcf51bd 100644
--- a/app/Controller/ProjectPermissionController.php
+++ b/app/Controller/ProjectPermissionController.php
@@ -66,6 +66,8 @@ public function index(array $values = array(), array $errors = array())
      */
     public function addUser()
     {
+        $this->checkCSRFForm();
+
         $project = $this->getProject();
         $values = $this->request->getValues();
 
@@ -75,7 +77,7 @@ public function addUser()
 
         if (empty($values['user_id'])) {
             $this->flash->failure(t('User not found.'));
-        } elseif ($this->projectUserRoleModel->addUser($values['project_id'], $values['user_id'], $values['role'])) {
+        } elseif ($this->projectUserRoleModel->addUser($project['id'], $values['user_id'], $values['role'])) {
             $this->flash->success(t('Project updated successfully.'));
         } else {
             $this->flash->failure(t('Unable to update this project.'));
@@ -144,6 +146,8 @@ public function changeUserRole()
      */
     public function addGroup()
     {
+        $this->checkCSRFForm();
+
         $project = $this->getProject();
         $values = $this->request->getValues();
 
diff --git a/app/Template/project_permission/groups.php b/app/Template/project_permission/groups.php
index 7a7c132fb2..72c18f388b 100644
--- a/app/Template/project_permission/groups.php
+++ b/app/Template/project_permission/groups.php
@@ -37,7 +37,6 @@
     <div class="panel">
         <form method="post" action="<?= $this->url->href('ProjectPermissionController', 'addGroup', array('project_id' => $project['id'])) ?>" autocomplete="off" class="form-inline">
             <?= $this->form->csrf() ?>
-            <?= $this->form->hidden('project_id', array('project_id' => $project['id'])) ?>
             <?= $this->form->hidden('group_id', $values) ?>
             <?= $this->form->hidden('external_id', $values) ?>
 
diff --git a/app/Template/project_permission/users.php b/app/Template/project_permission/users.php
index 78f2e9392d..350a0c7b0a 100644
--- a/app/Template/project_permission/users.php
+++ b/app/Template/project_permission/users.php
@@ -35,7 +35,6 @@
     <div class="panel">
         <form method="post" action="<?= $this->url->href('ProjectPermissionController', 'addUser', array('project_id' => $project['id'])) ?>" autocomplete="off" class="form-inline">
             <?= $this->form->csrf() ?>
-            <?= $this->form->hidden('project_id', array('project_id' => $project['id'])) ?>
             <?= $this->form->hidden('user_id', $values) ?>
             <?= $this->form->hidden('username', $values) ?>
             <?= $this->form->hidden('external_id', $values) ?>
