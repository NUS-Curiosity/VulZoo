diff --git a/xwiki-pro-macros-ui/src/main/resources/Confluence/Macros/ViewFile.xml b/xwiki-pro-macros-ui/src/main/resources/Confluence/Macros/ViewFile.xml
index d4f2d4c6..a5ba6a6e 100644
--- a/xwiki-pro-macros-ui/src/main/resources/Confluence/Macros/ViewFile.xml
+++ b/xwiki-pro-macros-ui/src/main/resources/Confluence/Macros/ViewFile.xml
@@ -266,19 +266,20 @@
 #macro (executeMacro)
   #set($hasPDFViewer = $xwiki.exists("XWiki.PDFViewerMacro"))
   #set($officeExtensions = [ 'ppt', 'pptx', 'odp', 'doc', 'docx', 'odt', 'xls', 'xlsx', 'ods' ])
-  #set($filename = $xcontext.macro.params.get('att--filename'))
-  #if(!$filename)
-    #set($filename = $xcontext.macro.params.get('name'))
+  #set($unescapedFilename = $xcontext.macro.params.get('att--filename'))
+  #if(!$unescapedFilename)
+    #set($unescapedFilename = $xcontext.macro.params.get('name'))
   #end
-  #set($extension = $filename.substring($mathtool.add($filename.lastIndexOf('.'), 1)).toLowerCase())
+  #set($extension = $unescapedFilename.substring($mathtool.add($unescapedFilename.lastIndexOf('.'), 1)).toLowerCase())
+  #set($escapedFilename = $services.rendering.escape($unescapedFilename, $xwiki.currentContentSyntaxId))
   #if($extension == 'pdf' &amp;&amp; $hasPDFViewer)
 
-    {{pdfviewer file="${filename}" /}}
+    {{pdfviewer file="$escapedFilename" /}}
   #elseif($officeExtensions.contains($extension))
 
-    {{office reference="attach:${filename}" /}}
-  #elseif($doc.getAttachment($filename))
-    [[attach:${filename}]]
+    {{office reference="attach:$escapedFilename" /}}
+  #elseif($doc.getAttachment($unescapedFilename))
+    [[attach:$escapedFilename]]
   #end
 #end
 {{/velocity}}
diff --git a/xwiki-pro-macros-ui/src/main/resources/Confluence/Macros/Viewdoc.xml b/xwiki-pro-macros-ui/src/main/resources/Confluence/Macros/Viewdoc.xml
index 952b883b..936832cb 100644
--- a/xwiki-pro-macros-ui/src/main/resources/Confluence/Macros/Viewdoc.xml
+++ b/xwiki-pro-macros-ui/src/main/resources/Confluence/Macros/Viewdoc.xml
@@ -256,11 +256,12 @@
     <property>
       <code>{{velocity output="false"}}
 #macro (executeMacro)
-  #set ($filename = $xcontext.macro.params.get('att--filename'))
-  #if (!$filename)
-    #set ($filename = $xcontext.macro.params.get('name'))
+  #set ($unescapedFilename = $xcontext.macro.params.get('att--filename'))
+  #if (!$unescapedFilename)
+    #set ($unescapedFilename = $xcontext.macro.params.get('name'))
   #end
-  {{office reference="$filename" /}}
+  #set($escapedFilename = $services.rendering.escape($unescapedFilename, $xwiki.currentContentSyntaxId))
+  {{office reference="$escapedFilename" /}}
 #end
 {{/velocity}}
 
diff --git a/xwiki-pro-macros-ui/src/main/resources/Confluence/Macros/Viewpdf.xml b/xwiki-pro-macros-ui/src/main/resources/Confluence/Macros/Viewpdf.xml
index 04a2247e..d5c6fe81 100644
--- a/xwiki-pro-macros-ui/src/main/resources/Confluence/Macros/Viewpdf.xml
+++ b/xwiki-pro-macros-ui/src/main/resources/Confluence/Macros/Viewpdf.xml
@@ -256,14 +256,15 @@
     <property>
       <code>{{velocity}}
 #set ($hasPDFViewer = $xwiki.exists('XWiki.PDFViewerMacro'))
-#set ($filename = $xcontext.macro.params.get('att--filename'))
-#if (!$filename)
-  #set ($filename = $xcontext.macro.params.get('name'))
+#set ($unescapedFilename = $xcontext.macro.params.get('att--filename'))
+#if (!$unescapedFilename)
+  #set ($unescapedFilename = $xcontext.macro.params.get('name'))
 #end
+#set($escapedFilename = $services.rendering.escape($unescapedFilename, $xwiki.currentContentSyntaxId))
 #if ($hasPDFViewer)
-  {{pdfviewer file="$filename" /}}
+  {{pdfviewer file="$escapedFilename" /}}
 #else
-  {{office reference="$filename" /}}
+  {{office reference="$escapedFilename" /}}
 #end
 {{/velocity}}</code>
     </property>
diff --git a/xwiki-pro-macros-ui/src/main/resources/Confluence/Macros/Viewppt.xml b/xwiki-pro-macros-ui/src/main/resources/Confluence/Macros/Viewppt.xml
index 2b518678..f0b7f520 100644
--- a/xwiki-pro-macros-ui/src/main/resources/Confluence/Macros/Viewppt.xml
+++ b/xwiki-pro-macros-ui/src/main/resources/Confluence/Macros/Viewppt.xml
@@ -256,11 +256,12 @@
     <property>
       <code>{{velocity output="false"}}
 #macro (executeMacro)
-  #set ($filename = $xcontext.macro.params.get('att--filename'))
-  #if (!$filename)
-    #set ($filename = $xcontext.macro.params.get('name'))
+  #set ($unescapedFilename = $xcontext.macro.params.get('att--filename'))
+  #if (!$unescapedFilename)
+    #set ($unescapedFilename = $xcontext.macro.params.get('name'))
   #end
-  {{office reference="$filename" /}}
+  #set($escapedFilename = $services.rendering.escape($unescapedFilename, $xwiki.currentContentSyntaxId))
+  {{office reference="$escapedFilename" /}}
 #end
 {{/velocity}}
 
diff --git a/xwiki-pro-macros-ui/src/main/resources/Confluence/Macros/Viewxls.xml b/xwiki-pro-macros-ui/src/main/resources/Confluence/Macros/Viewxls.xml
index ea0277b2..7b041e60 100644
--- a/xwiki-pro-macros-ui/src/main/resources/Confluence/Macros/Viewxls.xml
+++ b/xwiki-pro-macros-ui/src/main/resources/Confluence/Macros/Viewxls.xml
@@ -256,11 +256,12 @@
     <property>
       <code>{{velocity output="false"}}
 #macro (executeMacro)
-  #set ($filename = $xcontext.macro.params.get('att--filename'))
-  #if (!$filename)
-    #set ($filename = $xcontext.macro.params.get('name'))
+  #set ($unescapedFilename = $xcontext.macro.params.get('att--filename'))
+  #if (!$unescapedFilename)
+    #set ($unescapedFilename = $xcontext.macro.params.get('name'))
   #end
-  {{office reference="$filename" /}}
+  #set($escapedFilename = $services.rendering.escape($unescapedFilename, $xwiki.currentContentSyntaxId))
+  {{office reference="$escapedFilename" /}}
 #end
 {{/velocity}}
 
