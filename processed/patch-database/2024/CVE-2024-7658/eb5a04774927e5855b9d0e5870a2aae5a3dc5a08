diff --git a/process.php b/process.php
index 6a52e09d..b4b7e2e2 100644
--- a/process.php
+++ b/process.php
@@ -48,6 +48,9 @@
     case 'get_preview':
         $return = [];
         if (!empty($_GET['file_id'])) {
+            if (!user_can_download_file(CURRENT_USER_ID, $_GET['file_id'])) {
+                exit_with_error_code(403);
+            }
             $file = new \ProjectSend\Classes\Files($_GET['file_id']);
             if ($file->existsOnDisk() && $file->embeddable) {
                 $return = json_decode($file->getEmbedData());
