diff --git a/lib/Service/ZipService.php b/lib/Service/ZipService.php
index 91e26a7..07b856f 100644
--- a/lib/Service/ZipService.php
+++ b/lib/Service/ZipService.php
@@ -29,6 +29,7 @@
 use Exception;
 use Icewind\Streams\CountWrapper;
 use OC\User\NoUserException;
+use OCA\Files_Sharing\SharedStorage;
 use OCA\FilesZip\AppInfo\Application;
 use OCA\FilesZip\BackgroundJob\ZipJob;
 use OCA\FilesZip\Exceptions\MaximumSizeReachedException;
@@ -44,6 +45,8 @@
 use OCP\IConfig;
 use OCP\IUserSession;
 use OCP\Lock\LockedException;
+use OCP\Share\IAttributes;
+use OCP\Share\IShare;
 use ZipStreamer\ZipStreamer;
 
 class ZipService {
@@ -154,7 +157,20 @@ private function verifyAndGetFiles($uid, $fileIds, $target): array {
 				continue;
 			}
 
+			/** @var Node $node */
 			$node = array_pop($nodes);
+
+			// Skip incoming shares without download permission
+			$storage = $node->getStorage();
+			if ($node->isShared() && $storage->instanceOfStorage(SharedStorage::class) && method_exists(IShare::class, 'getAttributes')) {
+				/** @var SharedStorage $storage */
+				$share = $storage->getShare();
+				$hasShareAttributes = $share && $share->getAttributes() instanceof IAttributes;
+				if ($hasShareAttributes && $share->getAttributes()->getAttribute('permissions', 'download') === false) {
+					continue;
+				}
+			}
+
 			$files[] = $node;
 			$size += $node->getSize();
 		}
