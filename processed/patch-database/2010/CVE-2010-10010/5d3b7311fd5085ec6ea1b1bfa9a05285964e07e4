diff --git a/upload/admin/login.php b/upload/admin/login.php
index 8c622bc..a95c53a 100644
--- a/upload/admin/login.php
+++ b/upload/admin/login.php
@@ -27,6 +27,7 @@
 include("./common.php");
 $cms->theme->assign('page', basename(__FILE__, '.php'));
 
+$_GET['ref'] = htmlspecialchars($_GET['ref']); //XSS Fix. Thanks to JS2007
 $validfields = array('submit','cancel','ref');
 $cms->theme->assign_request_vars($validfields, true);
 
