diff --git a/src/MicroweberPackages/FileManager/Http/Controllers/PluploadController.php b/src/MicroweberPackages/FileManager/Http/Controllers/PluploadController.php
index 286e0b3f459..9890f301aa0 100644
--- a/src/MicroweberPackages/FileManager/Http/Controllers/PluploadController.php
+++ b/src/MicroweberPackages/FileManager/Http/Controllers/PluploadController.php
@@ -358,9 +358,9 @@ public function upload()
         $fileName = preg_replace('/\s+\d+%|\)/', '', $fileName);
         $fileName = preg_replace("/[\/\&%#\$]/", "_", $fileName);
         $fileName = preg_replace("/[\"\']/", " ", $fileName);
-        $fileName = str_replace(array('(', ')', "'", "!", "`", "*", "#"), '_', $fileName);
-        $fileName = str_replace(' ', '_', $fileName);
-        $fileName = str_replace('..', '.', $fileName);
+        $fileName = str_replace(array('(', ')', "'", "!", "`", "*", "#", "<", ">"), '-', $fileName);
+        $fileName = str_replace(' ', '-', $fileName);
+        $fileName = str_replace('..', '-', $fileName);
         $fileName = strtolower($fileName);
         $fileName = mw()->url_manager->clean_url_wrappers($fileName);
         $fileName = substr($fileName, 0, -(strlen($fileNameExtension)));
diff --git a/src/MicroweberPackages/Media/MediaManager.php b/src/MicroweberPackages/Media/MediaManager.php
index d0722500a50..e93b89f9726 100644
--- a/src/MicroweberPackages/Media/MediaManager.php
+++ b/src/MicroweberPackages/Media/MediaManager.php
@@ -380,7 +380,7 @@ public function get($params)
     public function save($data)
     {
         $data = app()->html_clean->cleanArray($data);
-
+        $data = xss_clean($data);
         $s = array();
 
         if (isset($data['content-id'])) {
@@ -513,6 +513,9 @@ public function save($data)
 
             $s['filename'] = $data['src'];
         }
+        if (isset($s['filename']) && !is_string($s['filename'])) {
+           return false;
+        }
 
         if (!isset($data['position']) and !isset($s['id'])) {
             $s['position'] = 9999999;
@@ -525,6 +528,7 @@ public function save($data)
 
         if ((!isset($s['id']) or (isset($s['id']) and $s['id'] == 0))
             and isset($s['filename'])
+            and is_string($s['filename'])
             and isset($s['rel_id'])
             and isset($s['rel_type'])
         ) {
@@ -540,7 +544,7 @@ public function save($data)
             }
         }
 
-        if (!isset($s['id']) and isset($s['filename']) and !isset($data['media_type'])) {
+        if (!isset($s['id']) and isset($s['filename']) and is_string($s['filename']) and !isset($data['media_type'])) {
             $ext = get_file_extension($s['filename']);
             $data['media_type'] = $this->_guess_media_type_from_file_ext($ext);
         }
@@ -559,11 +563,6 @@ public function save($data)
             $s['image_options'] = @json_encode($data['image_options']);
         }
 
-        if (isset($s['filename']) && is_array($s['filename'])) {
-            if (isset($s['filename']['error'])) {
-                return false;
-            }
-        }
 
         if (isset($s['rel_type']) and isset($s['rel_id'])) {
             $s['rel_id'] = trim($s['rel_id']);
diff --git a/src/MicroweberPackages/Media/Traits/MediaTrait.php b/src/MicroweberPackages/Media/Traits/MediaTrait.php
index 91a293d0107..31db8f786e6 100644
--- a/src/MicroweberPackages/Media/Traits/MediaTrait.php
+++ b/src/MicroweberPackages/Media/Traits/MediaTrait.php
@@ -82,7 +82,7 @@ public static function bootMediaTrait()
                                 'rel_id' => $model->id,
                                 'title' => 'Picture',
                                 'media_type' => 'picture',
-                                'src' => $url,
+                                'filename' => $url,
                             ));
                         }
                     }
diff --git a/src/MicroweberPackages/Media/migrations/2020_07_02_000000_create_media_table.php b/src/MicroweberPackages/Media/migrations/2020_07_02_000000_create_media_table.php
index aba927dbe8a..e5a86958f44 100644
--- a/src/MicroweberPackages/Media/migrations/2020_07_02_000000_create_media_table.php
+++ b/src/MicroweberPackages/Media/migrations/2020_07_02_000000_create_media_table.php
@@ -18,7 +18,7 @@ public function up()
                 $table->id();
                 $table->text('title')->nullable();
                 $table->text('description')->nullable();
-                $table->text('embed_code')->nullable();
+                //$table->text('embed_code')->nullable();
                 $table->text('filename')->nullable();
                 $table->text('media_type')->nullable()->index();
 
diff --git a/src/MicroweberPackages/Media/tests/MediaTestLegacy.php b/src/MicroweberPackages/Media/tests/LegacyMediaTest.php
similarity index 51%
rename from src/MicroweberPackages/Media/tests/MediaTestLegacy.php
rename to src/MicroweberPackages/Media/tests/LegacyMediaTest.php
index 43be36bc4c3..267a88e0000 100644
--- a/src/MicroweberPackages/Media/tests/MediaTestLegacy.php
+++ b/src/MicroweberPackages/Media/tests/LegacyMediaTest.php
@@ -4,7 +4,7 @@
 
 use MicroweberPackages\Core\tests\TestCase;
 
-class MediaTest extends TestCase
+class LegacyMediaTest extends TestCase
 {
     public function testSaveMedia()
     {
@@ -13,7 +13,7 @@ public function testSaveMedia()
             'rel_id' => 3,
             'title' => 'My new pic',
             'media_type' => 'picture',
-            'src' => 'http://lorempixel.com/400/200/',
+            'filename' => 'http://lorempixel.com/400/200/',
         );
         $saved_pic_id = save_media($picture);
 
@@ -35,7 +35,7 @@ public function testDeleteMedia()
             'rel_id' => 3,
             'title' => 'My new pic to del',
             'media_type' => 'picture',
-            'src' => 'http://lorempixel.com/400/200/',
+            'filename' => 'http://lorempixel.com/400/200/',
         );
         $saved_pic_id = save_media($picture);
         $picture_data = get_media_by_id($saved_pic_id);
@@ -48,5 +48,42 @@ public function testDeleteMedia()
         $this->assertEquals(is_array($picture_data), true);
         $this->assertEquals($title, 'My new pic to del');
         $this->assertEquals(!($delete), false);
+    }
+
+    public function testSaveMediaArrayInFilename()
+    {
+        $picture = array(
+            'rel_type' => 'content',
+            'rel_id' => 3,
+            'title' => 'My new pic',
+            'media_type' => 'picture',
+            'filename' => ['http://lorempixel.com/400/200/', 'http://lorempixel.com/400/200/'],
+        );
+        $saved_pic_id = save_media($picture);
+
+        $this->assertFalse($saved_pic_id);
+    }
+    public function testSaveMediaXssFilename()
+    {
+        $xss = '<style>@keyframes x{}</style><xss style="animation-name:x" onanimationend="alert(document.cookie)"></xss>';
+
+        $picture = array(
+            'rel_type' => 'content',
+            'rel_id' => 3,
+            'title' => 'My new pic to xss'.$xss,
+            'description' => 'My new pic description xss'.$xss,
+            'media_type' => 'picture',
+            'filename' => 'http://lorempixel.com/400/200/'.$xss,
+        );
+        $saved_pic_id = save_media($picture);
+        $picture_data = get_media_by_id($saved_pic_id);
+
+        $this->assertNotEquals($picture_data['title'], $picture['title']);
+        $this->assertNotEquals($picture_data['description'], $picture['description']);
+        $this->assertNotEquals($picture_data['filename'], $picture['filename']);
+
+
+
+
     }
 }
