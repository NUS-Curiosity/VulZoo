diff --git a/phpmyfaq/admin/category.main.php b/phpmyfaq/admin/category.main.php
index 34e8d0d1d7..d55552c716 100644
--- a/phpmyfaq/admin/category.main.php
+++ b/phpmyfaq/admin/category.main.php
@@ -79,8 +79,8 @@
                 $categoryLang = Filter::filterInput(INPUT_POST, 'lang', FILTER_UNSAFE_RAW);
                 $categoryData = [
                     'lang' => $categoryLang,
-                    'name' => Filter::filterInput(INPUT_POST, 'name', FILTER_UNSAFE_RAW),
-                    'description' => Filter::filterInput(INPUT_POST, 'description', FILTER_UNSAFE_RAW),
+                    'name' => Filter::filterInput(INPUT_POST, 'name', FILTER_SANITIZE_SPECIAL_CHARS),
+                    'description' => Filter::filterInput(INPUT_POST, 'description', FILTER_SANITIZE_SPECIAL_CHARS),
                     'user_id' => Filter::filterInput(INPUT_POST, 'user_id', FILTER_VALIDATE_INT),
                     'group_id' => Filter::filterInput(INPUT_POST, 'group_id', FILTER_VALIDATE_INT),
                     'active' => Filter::filterInput(INPUT_POST, 'active', FILTER_VALIDATE_INT),
diff --git a/phpmyfaq/admin/news.php b/phpmyfaq/admin/news.php
index a055c4fe5d..b2a97d5dc6 100644
--- a/phpmyfaq/admin/news.php
+++ b/phpmyfaq/admin/news.php
@@ -7,13 +7,13 @@
  * v. 2.0. If a copy of the MPL was not distributed with this file, You can
  * obtain one at http://mozilla.org/MPL/2.0/.
  *
- * @package phpMyFAQ
- * @author Thorsten Rinne <thorsten@phpmyfaq.de>
- * @author Matteo Scaramuccia <matteo@phpmyfaq.de>
+ * @package   phpMyFAQ
+ * @author    Thorsten Rinne <thorsten@phpmyfaq.de>
+ * @author    Matteo Scaramuccia <matteo@phpmyfaq.de>
  * @copyright 2003-2022 phpMyFAQ Team
- * @license http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0
- * @link https://www.phpmyfaq.de
- * @since 2003-02-23
+ * @license   http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0
+ * @link      https://www.phpmyfaq.de
+ * @since     2003-02-23
  */
 
 use phpMyFAQ\Comments;
@@ -21,7 +21,7 @@
 use phpMyFAQ\Entity\CommentType;
 use phpMyFAQ\Filter;
 use phpMyFAQ\Helper\LanguageHelper;
-use phpMyFAQ\News;
+use phpMyFAQ\News;use phpMyFAQ\Strings;
 
 if (!defined('IS_VALID_PHPMYFAQ')) {
     http_response_code(400);
@@ -66,7 +66,9 @@
                     </div>
 
                     <div class="form-group row">
-                        <label class="col-3 col-form-label" for="authorName"><?= $PMF_LANG['ad_news_author_name'] ?></label>
+                        <label class="col-3 col-form-label" for="authorName">
+                        <?= $PMF_LANG['ad_news_author_name'] ?>
+                        </label>
                         <div class="col-9">
                             <input class="form-control" type="text" name="authorName" id="authorName"
                                    value="<?= $user->getUserData('display_name') ?>">
@@ -74,7 +76,9 @@
                     </div>
 
                     <div class="form-group row">
-                        <label class="col-3 col-form-label" for="authorEmail"><?= $PMF_LANG['ad_news_author_email'] ?></label>
+                        <label class="col-3 col-form-label" for="authorEmail">
+                        <?= $PMF_LANG['ad_news_author_email'] ?>
+                        </label>
                         <div class="col-9">
                             <input class="form-control" type="email" name="authorEmail" id="authorEmail"
                                    value="<?= $user->getUserData('email') ?>">
@@ -94,7 +98,9 @@
                     </div>
 
                     <div class="form-group row">
-                        <label class="col-3 col-form-label" for="comment"><?= $PMF_LANG['ad_news_allowComments'] ?></label>
+                        <label class="col-3 col-form-label" for="comment">
+                        <?= $PMF_LANG['ad_news_allowComments'] ?>
+                        </label>
                         <div class="col-9 checkbox">
                             <label>
                                 <input type="checkbox" name="comment" id="comment" value="y">
@@ -106,12 +112,15 @@
                     <div class="form-group row">
                         <label class="col-3 col-form-label" for="link"><?= $PMF_LANG['ad_news_link_url'] ?></label>
                         <div class="col-9">
-                            <input class="form-control" type="text" name="link" id="link" placeholder="http://www.example.com/">
+                            <input class="form-control" type="text" name="link" id="link"
+                            placeholder="http://www.example.com/">
                         </div>
                     </div>
 
                     <div class="form-group row">
-                        <label class="col-3 col-form-label" for="linkTitle"><?= $PMF_LANG['ad_news_link_title'] ?></label>
+                        <label class="col-3 col-form-label" for="linkTitle">
+                        <?= $PMF_LANG['ad_news_link_title'] ?>
+                        </label>
                         <div class="col-9">
                             <input type="text" name="linkTitle" id="linkTitle" class="form-control">
                         </div>
@@ -207,7 +216,7 @@
         foreach ($newsHeader as $newsItem) {
             ?>
                     <tr>
-                        <td><?= $newsItem['header'] ?></td>
+                        <td><?= Strings::htmlentities($newsItem['header']) ?></td>
                         <td><?= $date->format($newsItem['date']) ?></td>
                         <td>
                             <a class="btn btn-primary" href="?action=edit-news&amp;id=<?= $newsItem['id'] ?>">
@@ -254,7 +263,7 @@
                         <label class="col-3 col-form-label" for="newsheader"><?= $PMF_LANG['ad_news_header'] ?></label>
                         <div class="col-9">
                             <input type="text" name="newsheader" id="newsheader" class="form-control"
-                                   value="<?= $newsData['header'] ?? '' ?>">
+                                   value="<?= Strings::htmlentities($newsData['header']) ?? '' ?>">
                         </div>
                     </div>
 
@@ -270,16 +279,20 @@
                     </div>
 
                     <div class="form-group row">
-                        <label class="col-3 col-form-label" for="authorName"><?= $PMF_LANG['ad_news_author_name'] ?></label>
+                        <label class="col-3 col-form-label" for="authorName">
+                        <?= $PMF_LANG['ad_news_author_name'] ?>
+                        </label>
                         <div class="col-9">
-                            <input type="text" name="authorName" value="<?= $newsData['authorName'] ?>" class="form-control">
+                            <input type="text" name="authorName" class="form-control"
+                                value="<?= Strings::htmlentities($newsData['authorName']) ?>">
                         </div>
                     </div>
 
                     <div class="form-group row">
                         <label class="col-3 col-form-label" for="authorEmail"><?= $PMF_LANG['ad_news_author_email'] ?></label>
                         <div class="col-9">
-                            <input type="email" name="authorEmail" value="<?= $newsData['authorEmail'] ?>" class="form-control">
+                            <input type="email" name="authorEmail" class="form-control"
+                                value="<?= Strings::htmlentities($newsData['authorEmail']) ?>">
                         </div>
                     </div>
 
@@ -315,15 +328,16 @@
                     <div class="form-group row">
                         <label class="col-3 col-form-label" for="link"><?= $PMF_LANG['ad_news_link_url'] ?></label>
                         <div class="col-9">
-                            <input type="text" id="link" name="link" value="<?= $newsData['link'] ?>" class="form-control">
+                            <input type="text" id="link" name="link"
+                            value="<?= Strings::htmlentities($newsData['link']) ?>" class="form-control">
                         </div>
                     </div>
 
                     <div class="form-group row">
                         <label class="col-3 col-form-label" for="linkTitle"><?= $PMF_LANG['ad_news_link_title'] ?></label>
                         <div class="col-9">
-                            <input type="text" id="linkTitle" name="linkTitle" value="<?= $newsData['linkTitle'] ?>"
-                            class="form-control">
+                            <input type="text" id="linkTitle" name="linkTitle"
+                            value="<?= Strings::htmlentities($newsData['linkTitle']) ?>" class="form-control">
                         </div>
                     </div>
 
@@ -429,14 +443,14 @@ class="form-control">
     <?php
     $dateStart = Filter::filterInput(INPUT_POST, 'dateStart', FILTER_UNSAFE_RAW);
     $dateEnd = Filter::filterInput(INPUT_POST, 'dateEnd', FILTER_UNSAFE_RAW);
-    $header = Filter::filterInput(INPUT_POST, 'newsheader', FILTER_UNSAFE_RAW);
+    $header = Filter::filterInput(INPUT_POST, 'newsheader', FILTER_SANITIZE_SPECIAL_CHARS);
     $content = Filter::filterInput(INPUT_POST, 'news', FILTER_SANITIZE_SPECIAL_CHARS);
     $author = Filter::filterInput(INPUT_POST, 'authorName', FILTER_UNSAFE_RAW);
     $email = Filter::filterInput(INPUT_POST, 'authorEmail', FILTER_VALIDATE_EMAIL);
     $active = Filter::filterInput(INPUT_POST, 'active', FILTER_UNSAFE_RAW);
     $comment = Filter::filterInput(INPUT_POST, 'comment', FILTER_UNSAFE_RAW);
-    $link = Filter::filterInput(INPUT_POST, 'link', FILTER_UNSAFE_RAW);
-    $linkTitle = Filter::filterInput(INPUT_POST, 'linkTitle', FILTER_UNSAFE_RAW);
+    $link = Filter::filterInput(INPUT_POST, 'link', FILTER_SANITIZE_SPECIAL_CHARS);
+    $linkTitle = Filter::filterInput(INPUT_POST, 'linkTitle', FILTER_SANITIZE_SPECIAL_CHARS);
     $newsLang = Filter::filterInput(INPUT_POST, 'langTo', FILTER_UNSAFE_RAW);
     $target = Filter::filterInput(INPUT_POST, 'target', FILTER_UNSAFE_RAW);
 
diff --git a/phpmyfaq/faq.php b/phpmyfaq/faq.php
index a88abf69b6..3b3807fe87 100644
--- a/phpmyfaq/faq.php
+++ b/phpmyfaq/faq.php
@@ -7,13 +7,13 @@
  * v. 2.0. If a copy of the MPL was not distributed with this file, You can
  * obtain one at http://mozilla.org/MPL/2.0/.
  *
- * @package phpMyFAQ
- * @author Thorsten Rinne <thorsten@phpmyfaq.de>
- * @author Lars Tiedemann <larstiedemann@yahoo.de>
+ * @package   phpMyFAQ
+ * @author    Thorsten Rinne <thorsten@phpmyfaq.de>
+ * @author    Lars Tiedemann <larstiedemann@yahoo.de>
  * @copyright 2002-2022 phpMyFAQ Team
- * @license http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0
- * @link https://www.phpmyfaq.de
- * @since 2002-08-27
+ * @license   http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0
+ * @link      https://www.phpmyfaq.de
+ * @since     2002-08-27
  */
 
 use phpMyFAQ\Attachment\AttachmentException;
@@ -338,7 +338,7 @@
         'baseHref' => $faqSystem->getSystemUri($faqConfig),
         'solutionId' => $faq->faqRecord['solution_id'],
         'solutionIdLink' => Link::getSystemRelativeUri() . '?solution_id=' . $faq->faqRecord['solution_id'],
-        'question' => $question,
+        'question' => Strings::htmlentities($question),
         'answer' => $answer,
         'faqDate' => $date->format($faq->faqRecord['date']),
         'faqAuthor' => $author,
diff --git a/phpmyfaq/index.php b/phpmyfaq/index.php
index bb2dba5850..9f449aeb70 100755
--- a/phpmyfaq/index.php
+++ b/phpmyfaq/index.php
@@ -539,7 +539,7 @@
     'metaTitle' => Strings::htmlspecialchars(str_replace('"', '', $faqConfig->getTitle() . $title)),
     'metaDescription' => Strings::htmlspecialchars($metaDescription ?? ''),
     'metaKeywords' => Strings::htmlspecialchars($keywords),
-    'metaPublisher' => $faqConfig->get('main.metaPublisher'),
+    'metaPublisher' => Strings::htmlspecialchars($faqConfig->get('main.metaPublisher')),
     'metaLanguage' => $PMF_LANG['metaLanguage'],
     'metaRobots' => $faqSeo->getMetaRobots($action),
     'phpmyfaqversion' => $faqConfig->getVersion(),
diff --git a/phpmyfaq/news.php b/phpmyfaq/news.php
index d0e6fe9ac1..dae42e8634 100644
--- a/phpmyfaq/news.php
+++ b/phpmyfaq/news.php
@@ -8,13 +8,13 @@
  * v. 2.0. If a copy of the MPL was not distributed with this file, You can
  * obtain one at http://mozilla.org/MPL/2.0/.
  *
- * @package phpMyFAQ
- * @author Thorsten Rinne <thorsten@phpmyfaq.de>
- * @author Matteo Scaramuccia <matteo@scaramuccia.com>
+ * @package   phpMyFAQ
+ * @author    Thorsten Rinne <thorsten@phpmyfaq.de>
+ * @author    Matteo Scaramuccia <matteo@scaramuccia.com>
  * @copyright 2006-2022 phpMyFAQ Team
- * @license http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0
- * @link https://www.phpmyfaq.de
- * @since 2006-07-23
+ * @license   http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0
+ * @link      https://www.phpmyfaq.de
+ * @since     2006-07-23
  */
 
 use phpMyFAQ\Captcha;
@@ -25,6 +25,7 @@
 use phpMyFAQ\Glossary;
 use phpMyFAQ\Helper\CaptchaHelper;
 use phpMyFAQ\News;
+use phpMyFAQ\Strings;
 use phpMyFAQ\User\CurrentUser;
 
 if (!defined('IS_VALID_PHPMYFAQ')) {
@@ -74,9 +75,9 @@
     $newsContent .= sprintf(
         '</p><p>%s<a href="%s" target="%s">%s</a>',
         $PMF_LANG['msgInfo'],
-        $news['link'],
+        Strings::htmlentities($news['link']),
         $news['target'],
-        $news['linkTitle']
+        Strings::htmlentities($news['linkTitle'])
     );
 }
 
@@ -121,11 +122,11 @@
     'mainPageContent',
     [
         'writeNewsHeader' => $newsMainHeader,
-        'writeHeader' => $newsHeader,
-        'mainPageContent' => $newsContent,
+        'writeHeader' => Strings::htmlentities($newsHeader),
+        'mainPageContent' => Strings::htmlentities($newsContent),
         'writeDateMsg' => $newsDate,
         'msgAboutThisNews' => $PMF_LANG['msgAboutThisNews'],
-        'writeAuthor' => ($news['active'] && (!$expired)) ? $PMF_LANG['msgAuthor'] . ': ' . $news['authorName'] : '',
+        'writeAuthor' => ($news['active'] && (!$expired)) ? $PMF_LANG['msgAuthor'] . ': ' . Strings::htmlentities($news['authorName']) : '',
         'editThisEntry' => $editThisEntry,
         'writeCommentMsg' => $commentMessage,
         'msgWriteComment' => $PMF_LANG['newsWriteComment'],
diff --git a/phpmyfaq/src/Bootstrap.php b/phpmyfaq/src/Bootstrap.php
index b364cc0859..a43c284901 100644
--- a/phpmyfaq/src/Bootstrap.php
+++ b/phpmyfaq/src/Bootstrap.php
@@ -25,7 +25,7 @@
 // Debug mode:
 // - false debug mode disabled
 // - true  debug mode enabled
-const DEBUG = false;
+const DEBUG = true;
 if (DEBUG) {
     ini_set('display_errors', '1');
     ini_set('display_startup_errors', '1');
diff --git a/phpmyfaq/src/phpMyFAQ/Category.php b/phpmyfaq/src/phpMyFAQ/Category.php
index 90669b0199..824f7bd949 100755
--- a/phpmyfaq/src/phpMyFAQ/Category.php
+++ b/phpmyfaq/src/phpMyFAQ/Category.php
@@ -787,13 +787,13 @@ public function addCategoryLink(
 
         $oLink = new Link($url, $this->config);
         $oLink->id = 'category_' . $categoryId;
-        $oLink->itemTitle = $categoryName;
-        $oLink->text = $categoryName;
+        $oLink->itemTitle = Strings::htmlentities($categoryName);
+        $oLink->text = Strings::htmlentities($categoryName);
 
         if ($hasChildren) {
             $oLink->text .= sprintf(
                 '<i aria-hidden="true" class="fa fa-caret-right" title="%s"></i>',
-                $categoryName
+                Strings::htmlentities($categoryName)
             );
         }
 
@@ -890,8 +890,8 @@ public function getPath(
                 );
                 $oLink = new Link($url, $this->config);
                 $oLink->text = sprintf('<span>%s</span>', $category);
-                $oLink->itemTitle = $category;
-                $oLink->tooltip = $description[$key];
+                $oLink->itemTitle = Strings::htmlentities($category);
+                $oLink->tooltip = Strings::htmlentities($description[$key]);
                 if (0 === $key) {
                     $oLink->setRelation('index');
                 }
diff --git a/phpmyfaq/src/phpMyFAQ/Database/DatabaseHelper.php b/phpmyfaq/src/phpMyFAQ/Database/DatabaseHelper.php
index ec73722f6d..64dc72f533 100644
--- a/phpmyfaq/src/phpMyFAQ/Database/DatabaseHelper.php
+++ b/phpmyfaq/src/phpMyFAQ/Database/DatabaseHelper.php
@@ -31,7 +31,7 @@ class DatabaseHelper
     /**
      * @var Configuration
      */
-    private $config;
+    private Configuration $config;
 
     /**
      * Constructor.
diff --git a/phpmyfaq/src/phpMyFAQ/Helper/CategoryHelper.php b/phpmyfaq/src/phpMyFAQ/Helper/CategoryHelper.php
index 0b61c3ab45..68d572b3f2 100644
--- a/phpmyfaq/src/phpMyFAQ/Helper/CategoryHelper.php
+++ b/phpmyfaq/src/phpMyFAQ/Helper/CategoryHelper.php
@@ -241,9 +241,9 @@ public function renderCategoryDropDown(): string
                     $parent
                 );
                 $oLink = new Link($url, $this->config);
-                $oLink->itemTitle = $categoryName;
-                $oLink->text = $categoryName;
-                $oLink->tooltip = $description;
+                $oLink->itemTitle = Strings::htmlentities($categoryName);
+                $oLink->text = Strings::htmlentities($categoryName);
+                $oLink->tooltip = !is_null($description) ?? Strings::htmlentities($description);
 
                 $output .= $oLink->toHtmlAnchor();
                 $open = $level;
@@ -274,7 +274,7 @@ public function renderMainCategories(): string
                 $categories .= sprintf(
                     '<li><a href="?action=show&cat=%d">%s</a></li>',
                     $cat['id'],
-                    $cat['name']
+                    Strings::htmlentities($cat['name'])
                 );
             }
         }
@@ -323,7 +323,7 @@ public function renderOptions($categoryId): string
             }
 
             $categories .= '>';
-            $categories .= $indent . $cat['name'] . "</option>\n";
+            $categories .= $indent . Strings::htmlentities($cat['name']) . "</option>\n";
             ++$i;
         }
 
@@ -355,7 +355,7 @@ public function renderStartPageCategories(array $categories): string
                 '<a href="' . Strings::htmlentities($category['url']) . '">' .
                 Strings::htmlentities($category['name']) . '</a>' .
                 '</h4>' .
-                '<p class="card-text">' . $category['description'] . '</p>' .
+                '<p class="card-text">' . Strings::htmlentities($category['description']) . '</p>' .
                 '</div>' .
                 '</div>';
             if ($key % 2 === 0) {
@@ -504,9 +504,9 @@ public function renderCategoryTree(): string
                 $parent
             );
             $oLink = new Link($url, $this->config);
-            $oLink->itemTitle = $categoryName;
-            $oLink->text = $categoryName;
-            $oLink->tooltip = $description;
+            $oLink->itemTitle = Strings::htmlentities($categoryName);
+            $oLink->text = Strings::htmlentities($categoryName);
+            $oLink->tooltip = !is_null($description) ?? Strings::htmlentities($description);
 
             $output .= $oLink->toHtmlAnchor() . $numFaqs;
             $open = $level;
diff --git a/phpmyfaq/src/phpMyFAQ/Helper/FaqHelper.php b/phpmyfaq/src/phpMyFAQ/Helper/FaqHelper.php
index 70178d9a54..114d5e29cf 100644
--- a/phpmyfaq/src/phpMyFAQ/Helper/FaqHelper.php
+++ b/phpmyfaq/src/phpMyFAQ/Helper/FaqHelper.php
@@ -163,12 +163,12 @@ public function renderAnswerPreview(string $answer, int $numWords): string
      * Creates an overview with all categories with their FAQs.
      *
      * @param Category $category
-     * @param Faq $faq
-     * @param string $language
+     * @param Faq      $faq
+     * @param string   $language
      * @return string
      * @throws Exception
      */
-    public function createOverview(Category $category, Faq $faq, $language = ''): string
+    public function createOverview(Category $category, Faq $faq, string $language = ''): string
     {
         global $PMF_LANG;
 
@@ -209,8 +209,8 @@ public function createOverview(Category $category, Faq $faq, $language = ''): st
      * Creates a list of links with available languages to edit a FAQ
      * in the admin backend.
      *
-     * @param  $faqId
-     * @param  $faqLang
+     * @param int    $faqId
+     * @param string $faqLang
      * @return string
      */
     public function createFaqTranslationLinkList(int $faqId, string $faqLang): string
diff --git a/phpmyfaq/src/phpMyFAQ/Helper/QuestionHelper.php b/phpmyfaq/src/phpMyFAQ/Helper/QuestionHelper.php
index 674a28bdca..131bcb41c4 100644
--- a/phpmyfaq/src/phpMyFAQ/Helper/QuestionHelper.php
+++ b/phpmyfaq/src/phpMyFAQ/Helper/QuestionHelper.php
@@ -31,13 +31,13 @@
 class QuestionHelper
 {
     /** @var Configuration */
-    private $config;
+    private Configuration $config;
 
     /** @var Category */
-    private $category;
+    private Category $category;
 
     /** @var array */
-    private $translation;
+    private array $translation;
 
     /**
      * QuestionHelper constructor.
diff --git a/phpmyfaq/src/phpMyFAQ/Helper/TagsHelper.php b/phpmyfaq/src/phpMyFAQ/Helper/TagsHelper.php
index d44c430c66..98a19a5488 100644
--- a/phpmyfaq/src/phpMyFAQ/Helper/TagsHelper.php
+++ b/phpmyfaq/src/phpMyFAQ/Helper/TagsHelper.php
@@ -7,8 +7,7 @@
  * v. 2.0. If a copy of the MPL was not distributed with this file, You can
  * obtain one at http://mozilla.org/MPL/2.0/.
  *
- * @package    phpMyFAQ\Helper
- * @subpackage TagsHelper
+ * @package    phpMyFAQ
  * @author     Thorsten Rinne <thorsten@phpmyfaq.de>
  * @copyright  2013-2022 phpMyFAQ Team
  * @license    http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0
@@ -20,6 +19,7 @@
 
 use phpMyFAQ\Filter;
 use phpMyFAQ\Helper;
+use phpMyFAQ\Strings;
 
 /**
  * Class TagsHelper
@@ -32,7 +32,7 @@ class TagsHelper extends Helper
      *
      * @var array
      */
-    private $taggingIds;
+    private array $taggingIds;
 
     /**
      * Renders the tag list.
@@ -61,7 +61,7 @@ public function renderTagList(array $tags): string
      */
     public function renderSearchTag(int $tagId, string $tagName): string
     {
-        $taggingIds = str_replace($tagId, '', $this->getTaggingIds());
+        $taggingIds = str_replace((string) $tagId, '', $this->getTaggingIds());
         $taggingIds = str_replace(' ', '', $taggingIds);
         $taggingIds = str_replace(',,', ',', $taggingIds);
         $taggingIds = trim(implode(',', $taggingIds), ',');
@@ -70,11 +70,11 @@ public function renderSearchTag(int $tagId, string $tagName): string
             '<a class="btn btn-primary m-1" href="?action=search&amp;tagging_id=%s">%s ' .
             '<i aria-hidden="true" class="fa fa-minus-square"></i></a> ',
             $taggingIds,
-            $tagName
+            Strings::htmlentities($tagName)
         ) : sprintf(
             '<a class="btn btn-primary m-1" href="?action=search&amp;search=">%s ' .
             '<i aria-hidden="true" class="fa fa-minus-square"></i></a> ',
-            $tagName
+            Strings::htmlentities($tagName)
         );
     }
 
@@ -83,7 +83,7 @@ public function renderSearchTag(int $tagId, string $tagName): string
      *
      * @return array
      */
-    public function getTaggingIds()
+    public function getTaggingIds(): array
     {
         return $this->taggingIds;
     }
@@ -93,7 +93,7 @@ public function getTaggingIds()
      *
      * @param array $taggingIds The tag IDs as array
      */
-    public function setTaggingIds(array $taggingIds)
+    public function setTaggingIds(array $taggingIds): void
     {
         $this->taggingIds = array_filter($taggingIds, function ($tagId) {
             return Filter::filterVar($tagId, FILTER_VALIDATE_INT);
@@ -117,7 +117,7 @@ public function renderRelatedTag(int $tagId, string $tagName, int $relevance): s
             '<span class="badge badge-dark">%d</span></a>',
             implode(',', $this->getTaggingIds()) . ',' . $tagId,
             '<i aria-hidden="true" class="fa fa-plus-square"></i> ',
-            $tagName,
+            Strings::htmlentities($tagName),
             $relevance
         );
     }
diff --git a/phpmyfaq/src/phpMyFAQ/News.php b/phpmyfaq/src/phpMyFAQ/News.php
index e37bb8cd6c..b6569b5239 100644
--- a/phpmyfaq/src/phpMyFAQ/News.php
+++ b/phpmyfaq/src/phpMyFAQ/News.php
@@ -59,7 +59,7 @@ public function __construct(Configuration $config)
      * @return string
      * @throws Exception
      */
-    public function getNews($showArchive = false, $active = true): string
+    public function getNews(bool $showArchive = false, bool $active = true): string
     {
         $output = '';
         $news = $this->getLatestData($showArchive, $active);
@@ -75,7 +75,7 @@ public function getNews($showArchive = false, $active = true): string
             $oLink = new Link($url, $this->config);
 
             if (isset($item['header'])) {
-                $oLink->itemTitle = $item['header'];
+                $oLink->itemTitle = Strings::htmlentities($item['header']);
             }
 
             $output .= sprintf(
@@ -83,7 +83,7 @@ public function getNews($showArchive = false, $active = true): string
                 ' class="pmf-news-heading"',
                 $item['id'],
                 $oLink->toString(),
-                $item['header']
+                Strings::htmlentities($item['header'])
             );
 
             $output .= sprintf('%s', $item['content']);
@@ -303,16 +303,16 @@ public function addNewsEntry(array $data): bool
             $this->config->getDb()->nextId(Database::getTablePrefix() . 'faqnews', 'id'),
             $data['date'],
             $data['lang'],
-            $data['header'],
-            $data['content'],
-            $data['authorName'],
+            $this->config->getDb()->escape($data['header']),
+            $this->config->getDb()->escape($data['content']),
+            $this->config->getDb()->escape($data['authorName']),
             $data['authorEmail'],
             $data['dateStart'],
             $data['dateEnd'],
             $data['active'],
             $data['comment'],
-            $data['link'],
-            $data['linkTitle'],
+            $this->config->getDb()->escape($data['link']),
+            $this->config->getDb()->escape($data['linkTitle']),
             $data['target']
         );
 
@@ -355,16 +355,16 @@ public function updateNewsEntry(int $id, array $data): bool
             Database::getTablePrefix(),
             $data['date'],
             $data['lang'],
-            $data['header'],
-            $data['content'],
-            $data['authorName'],
+            $this->config->getDb()->escape($data['header']),
+            $this->config->getDb()->escape($data['content']),
+            $this->config->getDb()->escape($data['authorName']),
             $data['authorEmail'],
             $data['dateStart'],
             $data['dateEnd'],
             $data['active'],
             $data['comment'],
-            $data['link'],
-            $data['linkTitle'],
+            $this->config->getDb()->escape($data['link']),
+            $this->config->getDb()->escape($data['linkTitle']),
             $data['target'],
             $id
         );
diff --git a/phpmyfaq/src/phpMyFAQ/Utils.php b/phpmyfaq/src/phpMyFAQ/Utils.php
index bd966337f1..c4000c7fd7 100644
--- a/phpmyfaq/src/phpMyFAQ/Utils.php
+++ b/phpmyfaq/src/phpMyFAQ/Utils.php
@@ -232,7 +232,7 @@ public static function debug(string $string): string
     {
         // sometimes Zend Optimizer causes segfaults with debug_backtrace()
         if (extension_loaded('Zend Optimizer')) {
-            $ret = '<code>' . $string . "</code><br>\n";
+            $ret = '<code>' . Strings::htmlentities($string) . "</code><br>\n";
         } else {
             $debug = debug_backtrace();
             $ret = '';
@@ -240,7 +240,7 @@ public static function debug(string $string): string
                 $ret = $debug[2]['file'] . ':<br>';
                 $ret .= $debug[2]['class'] . $debug[1]['type'];
                 $ret .= $debug[2]['function'] . '() in line ' . $debug[2]['line'];
-                $ret .= ': <code>' . $string . "</code><br>\n";
+                $ret .= ': <code>' . Strings::htmlentities($string) . "</code><br>\n";
             }
         }
 
diff --git a/phpmyfaq/startpage.php b/phpmyfaq/startpage.php
index 75283f5571..bacb8aa8ba 100755
--- a/phpmyfaq/startpage.php
+++ b/phpmyfaq/startpage.php
@@ -36,6 +36,7 @@
 } else {
     $writeNewsHeader = ' ' . $PMF_LANG['msgNews'];
     $showAllNews = sprintf('<a href="?%snewsid=0">%s</a>', $sids, $PMF_LANG['newsShowArchive']);
+    $archived = false;
 }
 
 $startPageCategories = $category->getHomeCategories();
