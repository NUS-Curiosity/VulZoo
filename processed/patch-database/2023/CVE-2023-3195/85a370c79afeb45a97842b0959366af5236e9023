diff --git a/ChangeLog b/ChangeLog
index 3566ccfcb8..1687a04ca6 100644
--- a/ChangeLog
+++ b/ChangeLog
@@ -6,6 +6,8 @@
     https://github.com/ImageMagick/ImageMagick/issues/4372).
   * fix possible unitialized values (reference
     https://github.com/ImageMagick/ImageMagick/issues/4379).
+  * fix stack overflow when parsing malicious tiff image file (report from
+    Muhammad Aldo Firmansyah).
 
 2021-10-10  6.9.12-25  <quetzlzacatenango@image...>
   * Release ImageMagick version 6.9.12-25 GIT revision 16849:2c96ab5d0:20211010
diff --git a/coders/tiff.c b/coders/tiff.c
index 43432cd1db..8c89fd9e10 100644
--- a/coders/tiff.c
+++ b/coders/tiff.c
@@ -1892,6 +1892,11 @@ static Image *ReadTIFFImage(const ImageInfo *image_info,
         if (HeapOverflowSanityCheck(rows,sizeof(*tile_pixels)) != MagickFalse)
           ThrowTIFFException(ResourceLimitError,"MemoryAllocationFailed");
         extent=MagickMax(rows*TIFFTileRowSize(tiff),TIFFTileSize(tiff));
+#if defined(TIFF_VERSION_BIG)
+        extent+=image->columns*sizeof(uint64);
+#else
+        extent+=image->columns*sizeof(uint32);
+#endif
         tile_pixels=(unsigned char *) AcquireQuantumMemory(extent,
           sizeof(*tile_pixels));
         if (tile_pixels == (unsigned char *) NULL)
