diff --git a/ChangeLog b/ChangeLog
index 4cf399afad5..c2477c457cd 100644
--- a/ChangeLog
+++ b/ChangeLog
@@ -6,6 +6,8 @@
     https://github.com/ImageMagick/ImageMagick/issues/4372).
   * fix possible unitialized values (reference
     https://github.com/ImageMagick/ImageMagick/issues/4379).
+  * fix stack overflow when parsing malicious tiff image file (report from
+    Muhammad Aldo Firmansyah).
 
 2021-10-10  7.1.0-10  <quetzlzacatenango@image...>
   * Release ImageMagick version 7.1.0-10 GIT revision 19236:07ebe6b6e:20211010
diff --git a/coders/tiff.c b/coders/tiff.c
index 3d59f0e6972..81f50082fd1 100644
--- a/coders/tiff.c
+++ b/coders/tiff.c
@@ -2001,6 +2001,11 @@ static Image *ReadTIFFImage(const ImageInfo *image_info,
         if (HeapOverflowSanityCheck(rows,sizeof(*tile_pixels)) != MagickFalse)
           ThrowTIFFException(ResourceLimitError,"MemoryAllocationFailed");
         extent=MagickMax(rows*TIFFTileRowSize(tiff),TIFFTileSize(tiff));
+#if defined(TIFF_VERSION_BIG)
+        extent+=image->columns*sizeof(uint64);
+#else
+        extent+=image->columns*sizeof(uint32);
+#endif
         tile_pixels=(unsigned char *) AcquireQuantumMemory(extent,
           sizeof(*tile_pixels));
         if (tile_pixels == (unsigned char *) NULL)
