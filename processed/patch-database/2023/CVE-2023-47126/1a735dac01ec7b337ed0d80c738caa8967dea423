diff --git a/typo3/sysext/install/Classes/Controller/LoginController.php b/typo3/sysext/install/Classes/Controller/LoginController.php
index 51fa29eca922..f8e8046aa82b 100644
--- a/typo3/sysext/install/Classes/Controller/LoginController.php
+++ b/typo3/sysext/install/Classes/Controller/LoginController.php
@@ -20,7 +20,6 @@
 use Psr\Http\Message\ResponseInterface;
 use Psr\Http\Message\ServerRequestInterface;
 use TYPO3\CMS\Core\Configuration\ConfigurationManager;
-use TYPO3\CMS\Core\Core\Environment;
 use TYPO3\CMS\Core\FormProtection\FormProtectionFactory;
 use TYPO3\CMS\Core\Http\JsonResponse;
 use TYPO3\CMS\Install\Service\EnableFileService;
@@ -42,8 +41,7 @@ public function __construct(
     public function showEnableInstallToolFileAction(ServerRequestInterface $request): ResponseInterface
     {
         $view = $this->initializeView($request);
-        $path = str_replace(Environment::getPublicPath() . '/', '', dirname(EnableFileService::getBestLocationForInstallToolEnableFile())) . '/';
-        $view->assign('enableInstallToolPath', $path);
+        $view->assign('enableInstallToolPath', EnableFileService::getStaticLocationForInstallToolEnableFileDirectory());
         return new JsonResponse([
             'success' => true,
             'html' => $view->render('Login/ShowEnableInstallToolFile'),
diff --git a/typo3/sysext/install/Classes/Service/EnableFileService.php b/typo3/sysext/install/Classes/Service/EnableFileService.php
index 458a0834382c..510f1b83ac9b 100644
--- a/typo3/sysext/install/Classes/Service/EnableFileService.php
+++ b/typo3/sysext/install/Classes/Service/EnableFileService.php
@@ -158,6 +158,15 @@ protected static function extendInstallToolEnableFileLifetime()
         }
     }
 
+    /**
+     * Returns a static directory path that is suitable to be presented to
+     * unauthenticated visitors, in order to circumvent "Full Path Disclosure" issues.
+     */
+    public static function getStaticLocationForInstallToolEnableFileDirectory(): string
+    {
+        return Environment::isComposerMode() ? 'var/transient/' : 'typo3conf/';
+    }
+
     public static function getBestLocationForInstallToolEnableFile(): string
     {
         $possibleLocations = [
