diff --git a/fsck/fsck.c b/fsck/fsck.c
index f529eea..77272aa 100644
--- a/fsck/fsck.c
+++ b/fsck/fsck.c
@@ -774,7 +774,7 @@ static int read_file_dentry_set(struct exfat_de_iter *iter,
 	if (!node)
 		return -ENOMEM;
 
-	for (i = 2; i <= file_de->file_num_ext; i++) {
+	for (i = 2; i <= MIN(file_de->file_num_ext, 1 + MAX_NAME_DENTRIES); i++) {
 		ret = exfat_de_iter_get(iter, i, &dentry);
 		if (ret || dentry->type != EXFAT_NAME) {
 			if (i > 2 && repair_file_ask(iter, NULL, ER_DE_NAME,
diff --git a/include/exfat_ondisk.h b/include/exfat_ondisk.h
index b976e3d..42cdadf 100644
--- a/include/exfat_ondisk.h
+++ b/include/exfat_ondisk.h
@@ -40,6 +40,7 @@
 /* exFAT allows 8388608(256MB) directory entries */
 #define MAX_EXFAT_DENTRIES	8388608
 #define MIN_FILE_DENTRIES	3
+#define MAX_NAME_DENTRIES	17
 
 /* dentry types */
 #define MSDOS_DELETED		0xE5	/* deleted mark */
