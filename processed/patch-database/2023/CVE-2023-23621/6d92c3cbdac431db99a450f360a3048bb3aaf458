diff --git a/lib/mobile_detection.rb b/lib/mobile_detection.rb
index b92523059e1c2f..aa4a8056eb1912 100644
--- a/lib/mobile_detection.rb
+++ b/lib/mobile_detection.rb
@@ -36,7 +36,9 @@ def self.ios_device?(user_agent)
     Firefox\/1[0-9][0-9]
   }x
 
+  USER_AGENT_MAX_LENGTH = 400
+
   def self.modern_mobile_device?(user_agent)
-    user_agent.match?(MODERN_MOBILE_REGEX)
+    user_agent[0...USER_AGENT_MAX_LENGTH].match?(MODERN_MOBILE_REGEX)
   end
 end
