diff --git a/ajax/pin_savedsearches.php b/ajax/pin_savedsearches.php
index 86ed5bfbc02..c43e64c4d3d 100644
--- a/ajax/pin_savedsearches.php
+++ b/ajax/pin_savedsearches.php
@@ -40,6 +40,11 @@
 
 Session::checkLoginUser();
 
+if (!is_string($_POST['itemtype']) || getItemForItemtype($_POST['itemtype']) === false) {
+    echo json_encode(['success' => false]);
+    exit();
+}
+
 $all_pinned = importArrayFromDB($_SESSION['glpisavedsearches_pinned']);
 $already_pinned = $all_pinned[$_POST['itemtype']] ?? 0;
 $all_pinned[$_POST['itemtype']] = $already_pinned ? 0 : 1;
