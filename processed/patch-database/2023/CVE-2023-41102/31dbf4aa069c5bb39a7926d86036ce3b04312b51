diff --git a/src/client_list.c b/src/client_list.c
index 23a20d1..1d46b43 100644
--- a/src/client_list.c
+++ b/src/client_list.c
@@ -173,10 +173,14 @@ void client_reset(t_client *client)
 	client->hid = safe_strdup(hash);
 	free(hash);
 
-	// Reset custom and client_type
+	// Reset custom, client_type and cpi_query
 	client->custom = safe_calloc(MID_BUF);
 	client->client_type = safe_calloc(STATUS_BUF);
 
+	if (!client->cpi_query) {
+		client->cpi_query = safe_calloc(STATUS_BUF);
+	}
+
 	//Reset cid and remove cidfile using rmcid
 	if (client->cid) {
 
@@ -188,10 +192,10 @@ void client_reset(t_client *client)
 			free(msg);
 			free(cidinfo);
 		}
-
-		client->cid = safe_calloc(SMALL_BUF);
 	}
 
+	client->cid = safe_calloc(SMALL_BUF);
+
 }
 
 /**
@@ -428,6 +432,16 @@ _client_list_free_node(t_client *client)
 		}
 	}
 
+	free(client->token);
+	free(client->hid);
+	free(client->custom);
+	free(client->client_type);
+	free(client->cid);
+
+	if (strcmp(client->cpi_query, "") == 0) {
+		free(client->cpi_query);
+	}
+
 	free(client);
 }
 
diff --git a/src/http_microhttpd.c b/src/http_microhttpd.c
index d680785..13a29f4 100644
--- a/src/http_microhttpd.c
+++ b/src/http_microhttpd.c
@@ -1385,8 +1385,6 @@ static int redirect_to_splashpage(struct MHD_Connection *connection, t_client *c
 	if (strcmp(url, "/login") == 0) {
 		client->cpi_query = safe_strdup(originurl);
 		debug(LOG_DEBUG, "RFC8910 request: %s", client->cpi_query);
-	} else {
-		client->cpi_query = "none";
 	}
 
 	debug(LOG_DEBUG, "originurl_raw: %s", originurl_raw);
