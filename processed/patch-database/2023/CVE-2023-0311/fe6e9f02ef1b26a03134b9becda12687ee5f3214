diff --git a/phpmyfaq/src/phpMyFAQ/Captcha.php b/phpmyfaq/src/phpMyFAQ/Captcha.php
index 1a6b606e5d..050e68b21a 100755
--- a/phpmyfaq/src/phpMyFAQ/Captcha.php
+++ b/phpmyfaq/src/phpMyFAQ/Captcha.php
@@ -434,7 +434,7 @@ private function drawText()
         $codeLength = Strings::strlen($this->code);
         $numFonts = count($this->fonts);
         $w1 = 15;
-        $w2 = $this->width / ($codeLength + 1);
+        $w2 = floor($this->width / ($codeLength + 1));
 
         for ($p = 0; $p < $codeLength; ++$p) {
             $letter = $this->code[$p];
@@ -515,7 +515,7 @@ public function checkCaptchaCode(string $code): bool
     public function validateCaptchaCode(string $captchaCode): bool
     {
         // Sanity check
-        if (0 === Strings::strlen($captchaCode)) {
+        if (Strings::strlen($captchaCode) !== $this->captchaLength) {
             return false;
         }
 
