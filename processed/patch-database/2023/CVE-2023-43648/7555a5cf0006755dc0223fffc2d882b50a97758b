diff --git a/lib/Baser/Plugin/Mail/Controller/MailMessagesController.php b/lib/Baser/Plugin/Mail/Controller/MailMessagesController.php
index 73418f2a81..6828a629fd 100644
--- a/lib/Baser/Plugin/Mail/Controller/MailMessagesController.php
+++ b/lib/Baser/Plugin/Mail/Controller/MailMessagesController.php
@@ -264,7 +264,14 @@ public function admin_attachment()
 		unset($args[0]);
 		$file = implode('/', $args);
 		$settings = $this->MailMessage->Behaviors->BcUpload->BcFileUploader['MailMessage']->settings;
-		$filePath = WWW_ROOT . 'files' . DS . $settings['saveDir'] . DS . $file;
+		$basePath = realpath(WWW_ROOT . 'files' . DS . $settings['saveDir']);
+		$filePath = realpath($basePath . DS . $file);
+
+		// basePath配下出ない場合は表示しない
+		if (strpos($filePath, $basePath) !== 0) {
+			$this->notFound();
+		}
+
 		$ext = decodeContent(null, $file);
 		$mineType = 'application/octet-stream';
 		if ($ext !== 'gif' && $ext !== 'jpg' && $ext !== 'png') {
