diff --git a/phpmyfaq/admin/ajax.user.php b/phpmyfaq/admin/ajax.user.php
index 639b1449ae..13f2bdf19b 100644
--- a/phpmyfaq/admin/ajax.user.php
+++ b/phpmyfaq/admin/ajax.user.php
@@ -22,6 +22,7 @@
 use phpMyFAQ\Helper\HttpHelper;
 use phpMyFAQ\Helper\MailHelper;
 use phpMyFAQ\Permission;
+use phpMyFAQ\Strings;
 use phpMyFAQ\User;
 
 if (!defined('IS_VALID_PHPMYFAQ')) {
@@ -63,7 +64,7 @@
             $userdata = [];
             $userdata = $user->userdata->get('*');
             $userdata['status'] = $user->getStatus();
-            $userdata['login'] = $user->getLogin();
+            $userdata['login'] = Strings::htmlentities($user->getLogin());
             $userdata['is_superadmin'] = $user->isSuperAdmin();
             $http->sendJsonWithHeaders($userdata);
             break;
diff --git a/phpmyfaq/ajaxservice.php b/phpmyfaq/ajaxservice.php
index 2d0044b8fe..4ad6d05a8a 100644
--- a/phpmyfaq/ajaxservice.php
+++ b/phpmyfaq/ajaxservice.php
@@ -758,7 +758,7 @@
         }
 
         $userId = Filter::filterInput(INPUT_POST, 'userid', FILTER_VALIDATE_INT);
-        $userName = Filter::filterInput(INPUT_POST, 'name', FILTER_UNSAFE_RAW);
+        $userName = Filter::filterInput(INPUT_POST, 'name', FILTER_SANITIZE_SPECIAL_CHARS);
         $email = Filter::filterInput(INPUT_POST, 'email', FILTER_VALIDATE_EMAIL);
         $isVisible = Filter::filterInput(INPUT_POST, 'is_visible', FILTER_UNSAFE_RAW);
         $password = Filter::filterInput(INPUT_POST, 'password', FILTER_UNSAFE_RAW);
diff --git a/phpmyfaq/index.php b/phpmyfaq/index.php
index 36268534aa..4e3c30c2f7 100755
--- a/phpmyfaq/index.php
+++ b/phpmyfaq/index.php
@@ -565,7 +565,7 @@
         $PMF_LANG['msgRegistration'] . '</a>' : '',
     'sendPassword' => '<a href="?action=password">' . $PMF_LANG['lostPassword'] . '</a>',
     'msgFullName' => $PMF_LANG['ad_user_loggedin'] . $user->getLogin(),
-    'msgLoginName' => $user->getUserData('display_name'),
+    'msgLoginName' => Strings::htmlentities($user->getUserData('display_name')),
     'loginHeader' => $PMF_LANG['msgLoginUser'],
     'loginMessage' => $loginMessage,
     'writeLoginPath' => Strings::htmlentities($faqSystem->getSystemUri($faqConfig)) . '?' . Filter::getFilteredQueryString(),
diff --git a/phpmyfaq/ucp.php b/phpmyfaq/ucp.php
index b4e894c75b..d8ba5547ba 100644
--- a/phpmyfaq/ucp.php
+++ b/phpmyfaq/ucp.php
@@ -16,6 +16,7 @@
  */
 
 use phpMyFAQ\Services\Gravatar;
+use phpMyFAQ\Strings;
 
 if (!defined('IS_VALID_PHPMYFAQ')) {
     http_response_code(400);
@@ -51,7 +52,7 @@
             'csrf' => $user->getCsrfTokenFromSession(),
             'readonly' => $faqConfig->isLdapActive() ? 'readonly' : '',
             'msgRealName' => $PMF_LANG['ad_user_name'],
-            'realname' => $user->getUserData('display_name'),
+            'realname' => Strings::htmlentities($user->getUserData('display_name')),
             'msgEmail' => $PMF_LANG['msgNewContentMail'],
             'email' => $user->getUserData('email'),
             'msgIsVisible' => $PMF_LANG['ad_user_data_is_visible'],
