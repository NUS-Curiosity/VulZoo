diff --git a/src/octoprint/settings/__init__.py b/src/octoprint/settings/__init__.py
index 4ca274dda0..0a0d5eb930 100644
--- a/src/octoprint/settings/__init__.py
+++ b/src/octoprint/settings/__init__.py
@@ -593,9 +593,10 @@ def _get_default_folder(self, type):
         return folder
 
     def _init_script_templating(self):
-        from jinja2 import BaseLoader, ChoiceLoader, Environment, TemplateNotFound
+        from jinja2 import BaseLoader, ChoiceLoader, TemplateNotFound
         from jinja2.ext import Extension
         from jinja2.nodes import Include
+        from jinja2.sandbox import SandboxedEnvironment
 
         from octoprint.util.jinja import FilteredFileSystemLoader
 
@@ -664,9 +665,9 @@ def get_source(self, environment, template):
             def list_templates(self):
                 return self._default.list_templates()
 
-        class RelEnvironment(Environment):
+        class RelEnvironment(SandboxedEnvironment):
             def __init__(self, prefix_sep=":", *args, **kwargs):
-                Environment.__init__(self, *args, **kwargs)
+                super().__init__(*args, **kwargs)
                 self._prefix_sep = prefix_sep
 
             def join_path(self, template, parent):
