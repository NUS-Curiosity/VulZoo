diff --git a/phpmyfaq/admin/ajax.config.php b/phpmyfaq/admin/ajax.config.php
index 7c72fba29a..86b65f0ab2 100644
--- a/phpmyfaq/admin/ajax.config.php
+++ b/phpmyfaq/admin/ajax.config.php
@@ -64,6 +64,13 @@
             exit(1);
         }
 
+        $url = 'https://' . $url . '.' . $_SERVER['SERVER_NAME'];
+        if (!Filter::filterVar($url, FILTER_VALIDATE_URL)) {
+            $http->setStatus(400);
+            $http->sendJsonWithHeaders(['error' => 'Cannot create instance: wrong URL']);
+            exit(1);
+        }
+
         $data = [
             'url' => 'https://' . $url . '.' . $_SERVER['SERVER_NAME'],
             'instance' => $instance,
diff --git a/phpmyfaq/admin/instances.php b/phpmyfaq/admin/instances.php
index a2374dfa57..05496994b0 100644
--- a/phpmyfaq/admin/instances.php
+++ b/phpmyfaq/admin/instances.php
@@ -70,7 +70,7 @@
 
         // Collect updated data for database
         $updatedData = [];
-        $updatedData['url'] = Filter::filterInput(INPUT_POST, 'url', FILTER_UNSAFE_RAW);
+        $updatedData['url'] = Filter::filterInput(INPUT_POST, 'url', FILTER_VALIDATE_URL);
         $updatedData['instance'] = Filter::filterInput(INPUT_POST, 'instance', FILTER_UNSAFE_RAW);
         $updatedData['comment'] = Filter::filterInput(INPUT_POST, 'comment', FILTER_UNSAFE_RAW);
 
@@ -81,27 +81,36 @@
             $moveInstance = true;
         }
 
-        if ($updatedClient->updateInstance($instanceId, $updatedData)) {
+        if (is_null($updatedData['url'])) {
+            printf(
+                '<p class="alert alert-danger">%s%s<br/>%s</p>',
+                '<a class="close" data-dismiss="alert" href="#">&times;</a>',
+                $PMF_LANG['ad_entryins_fail'],
+                 $faqConfig->getDb()->error()
+            );
+        } else {
+          if ($updatedClient->updateInstance($instanceId, $updatedData)) {
             if ($moveInstance) {
-                try {
-                    $updatedClient->moveClientFolder($originalData->url, $updatedData['url']);
-                    $updatedClient->deleteClientFolder($originalData->url);
-                } catch (Exception $e) {
-                    // handle exception
-                }
+              try {
+                $updatedClient->moveClientFolder($originalData->url, $updatedData['url']);
+                $updatedClient->deleteClientFolder($originalData->url);
+              } catch (Exception $e) {
+                // handle exception
+              }
             }
             printf(
                 '<p class="alert alert-success">%s%s</p>',
                 '<a class="close" data-dismiss="alert" href="#">&times;</a>',
                 $PMF_LANG['ad_config_saved']
             );
-        } else {
+          } else {
             printf(
                 '<p class="alert alert-danger">%s%s<br/>%s</p>',
                 '<a class="close" data-dismiss="alert" href="#">&times;</a>',
                 $PMF_LANG['ad_entryins_fail'],
                 $faqConfig->getDb()->error()
             );
+          }
         }
     }
     ?>
