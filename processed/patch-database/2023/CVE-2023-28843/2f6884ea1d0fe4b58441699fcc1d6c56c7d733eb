diff --git a/ipn.php b/ipn.php
index 45525e992..e78082331 100644
--- a/ipn.php
+++ b/ipn.php
@@ -255,5 +255,5 @@ public function getResult()
     }
 } elseif (Tools::isSubmit('custom') && (int)Configuration::get('PAYPAL_PAYMENT_METHOD') == HSS) {
     $custom = Tools::jsonDecode(Tools::getValue('custom'), true);
-    Db::getInstance()->insert('paypal_hss_email_error', array('id_cart' => $custom['id_cart'], 'email' => Tools::getValue('receiver_email')));
+    Db::getInstance()->insert('paypal_hss_email_error', array('id_cart' => (int) $custom['id_cart'], 'email' => pSQL(Tools::getValue('receiver_email', ''))));
 }
diff --git a/paypal.php b/paypal.php
index dd05918f9..1a2e4a9e6 100644
--- a/paypal.php
+++ b/paypal.php
@@ -1926,7 +1926,7 @@ private function _postProcess()
                 }
 
                 $new_hss_email = Tools::getValue('api_business_account');
-                Db::getInstance()->delete('paypal_hss_email_error', 'email = "'.$new_hss_email.'"');
+                Db::getInstance()->delete('paypal_hss_email_error', 'email = "'. pSQL($new_hss_email) .'"');
 
                 Configuration::updateValue('PAYPAL_BUSINESS', (int) Tools::getValue('business'));
                 Configuration::updateValue('PAYPAL_PAYMENT_METHOD', (int) Tools::getValue('paypal_payment_method'));
