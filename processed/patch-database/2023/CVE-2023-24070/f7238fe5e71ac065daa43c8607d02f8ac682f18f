diff --git a/app/Controller/Component/CRUDComponent.php b/app/Controller/Component/CRUDComponent.php
index fb276e34d38..81ad2bfb1a7 100644
--- a/app/Controller/Component/CRUDComponent.php
+++ b/app/Controller/Component/CRUDComponent.php
@@ -114,7 +114,7 @@ public function add(array $params = [])
                     $this->Controller->Flash->success($message);
                     if (!empty($params['displayOnSuccess'])) {
                         $this->Controller->set('entity', $data);
-                        $this->Controller->set('referer', $this->Controller->referer());
+                        $this->Controller->set('referer', $this->Controller->referer(['action' => 'view', $model->id], true));
                         $this->Controller->render($params['displayOnSuccess']);
                         return;
                     }
diff --git a/app/View/AuthKeys/authkey_display.ctp b/app/View/AuthKeys/authkey_display.ctp
index 5cd4161d310..f64321798f0 100644
--- a/app/View/AuthKeys/authkey_display.ctp
+++ b/app/View/AuthKeys/authkey_display.ctp
@@ -12,7 +12,7 @@
                 <pre class="quickSelect"><?= h($entity['AuthKey']['authkey_raw']) ?></pre>
             </div>
             <div class="modal-footer">
-                <a href="<?= $referer ?>" class="btn btn-primary"><?= __('I have noted down my key, take me back now') ?></a>
+                <a href="<?= h($referer) ?>" class="btn btn-primary"><?= __('I have noted down my key, take me back now') ?></a>
             </div>
         </div>
 <?php
@@ -22,7 +22,7 @@
         <p><?= __('Please make sure that you note down the auth key below, this is the only time the auth key is shown in plain text, so make sure you save it. If you lose the key, simply remove the entry and generate a new one.'); ?></p>
         <p><?=__('MISP will use the first and the last 4 characters for identification purposes.')?></p>
         <pre class="quickSelect"><?= h($entity['AuthKey']['authkey_raw']) ?></pre>
-        <a href="<?= $referer ?>" class="btn btn-primary"><?= __('I have noted down my key, take me back now') ?></a>
+        <a href="<?= h($referer) ?>" class="btn btn-primary"><?= __('I have noted down my key, take me back now') ?></a>
 <?php
     }
 ?>
