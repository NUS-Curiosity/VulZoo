diff --git a/includes/core/load.js.php b/includes/core/load.js.php
index ccf317871..c6e049034 100755
--- a/includes/core/load.js.php
+++ b/includes/core/load.js.php
@@ -784,7 +784,7 @@ function() {
             $(".fade").removeClass("out");
 
             // Is user not ready
-            if (typeof store.get('teampassUser').is_ready_for_usage !== 'undefined' && parseInt(store.get('teampassUser').is_ready_for_usage) === 0) {
+            if (typeof store.get('teampassUser') !== 'undefined' && typeof store.get('teampassUser').is_ready_for_usage !== 'undefined' && parseInt(store.get('teampassUser').is_ready_for_usage) === 0) {
                 $('#user_not_ready').removeClass('hidden');
             }
         },
diff --git a/pages/items.js.php b/pages/items.js.php
index af3f2ff8d..104e3efd2 100755
--- a/pages/items.js.php
+++ b/pages/items.js.php
@@ -1679,13 +1679,30 @@ function(data) {
         userDidAChange = false;
         userUploadedFile = false;
 
+        // Sanitize text fields
+        let formLabel = fieldSanitizeStep1('#form-folder-add-label', false, false, false),
+            formIcon = fieldSanitizeStep1('#form-folder-add-icon', false, false, false),
+            formIconSelected = fieldSanitizeStep1('#form-folder-add-icon-selected', false, false, false);
+        if (formLabel === false || formIcon === false || formIconSelected === false) {
+            // Label is empty
+            toastr.remove();
+            toastr.warning(
+                'XSS attempt detected. Field has been emptied.',
+                'Error', {
+                    timeOut: 5000,
+                    progressBar: true
+                }
+            );
+            return false;
+        }
+
         var data = {
-            'title': DOMPurify.sanitize($('#form-folder-add-label').val(), {USE_PROFILES: {html: false}}),
+            'title': formLabel,
             'parentId': $('#form-folder-add-parent option:selected').val(),
             'complexity': $('#form-folder-add-complexicity option:selected').val(),
             //'access_rights_strategy': $('#form-folder-add-rights option:selected').val(),
-            'icon': DOMPurify.sanitize($('#form-folder-add-icon').val(), {USE_PROFILES: {html: false}}),
-            'iconSelected': DOMPurify.sanitize($('#form-folder-add-icon-selected').val(), {USE_PROFILES: {html: false}}),
+            'icon': formIcon,
+            'iconSelected': formIconSelected,
             'id': selectedFolderId,
         }
         if (debugJavascript === true) console.log(data);
diff --git a/pages/users.js.php b/pages/users.js.php
index 499435ea4..7b08685a6 100755
--- a/pages/users.js.php
+++ b/pages/users.js.php
@@ -884,7 +884,7 @@ function(data) {
             let formLogin = fieldSanitizeStep1('#form-login', false, false, false),
                 formName = fieldSanitizeStep1('#form-name', false, false, false),
                 formLastname = fieldSanitizeStep1('#form-lastname', false, false, false),
-                formEmail = fieldSanitizeStep1('#form-email', false, false, false),
+                formEmail = fieldSanitizeStep1('#form-email', false, false, false);
             if (formLogin === false || formName === false || formLastname === false || formEmail === false) {
                 // Label is empty
                 toastr.remove();
diff --git a/sources/identify.php b/sources/identify.php
index 110faf014..78686a196 100755
--- a/sources/identify.php
+++ b/sources/identify.php
@@ -386,7 +386,11 @@ function identifyUser(string $sentData, array $SETTINGS): bool
         if ($userMfa['error'] === true) {
             echo prepareExchangedData(
                 $SETTINGS['cpassman_dir'],
-                $userMfa['mfaData'],
+                [
+                    'error' => true,
+                    'message' => $userMfa['mfaData']['message'],
+                    'mfaStatus' => $userMfa['mfaData']['mfaStatus'],
+                ],
                 'encode'
             );
             return false;
