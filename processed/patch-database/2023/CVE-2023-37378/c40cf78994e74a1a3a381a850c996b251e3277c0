diff --git a/Source/exehead/Main.c b/Source/exehead/Main.c
index 78ff558c6e..e39c631671 100644
--- a/Source/exehead/Main.c
+++ b/Source/exehead/Main.c
@@ -376,10 +376,10 @@ EXTERN_C void NSISWinMainNOCRT()
 
         if (ec)
         {
-          // Delete previous uninstaller
-          if (DeleteFile(unexe))
+          // Delete previous uninstaller (if it is safe to do so)
+          if (!(GetFileAttributes(unexe) & FILE_ATTRIBUTE_REPARSE_POINT) && DeleteFile(unexe))
           {
-            myDelete(state_temp_dir, DEL_DIR|DEL_RECURSE);
+            myDelete(state_temp_dir, DEL_DIR);
             if (!retry++) goto retry_un_dir;
           }
         }
