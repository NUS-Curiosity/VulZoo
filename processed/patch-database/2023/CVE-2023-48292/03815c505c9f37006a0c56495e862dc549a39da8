diff --git a/src/main/resources/Admin/RunShellCommand.xml b/src/main/resources/Admin/RunShellCommand.xml
index 3955440..340a324 100644
--- a/src/main/resources/Admin/RunShellCommand.xml
+++ b/src/main/resources/Admin/RunShellCommand.xml
@@ -49,6 +49,7 @@ if (services.security.authorization.hasAccess(Right.PROGRAM)) {
   def shellCmd = request.getParameter("command");
   def htmlForm = """
     &lt;form class="form-horizontal" action="" method="POST"&gt;
+      &lt;input type="hidden" name="form_token" value="${services.csrf.token}" /&gt;
       &lt;div class="form-group"&gt;
         &lt;div class="col-sm-10"&gt;
           &lt;input type="text" name="command" value="${shellCmd != null ? escapeTool.xml(shellCmd) : ''}" class="form-control col-md-12" style="width: 100%;" placeholder="${placeHolder}"&gt;
@@ -60,14 +61,19 @@ if (services.security.authorization.hasAccess(Right.PROGRAM)) {
   &lt;/form&gt;""";
   println("{{warning}}${services.localization.render('admintools.server.tools.shellCommand.warning')}{{/warning}}\n\n");
   println("{{html}}${htmlForm}{{/html}}\n\n");
-  if (shellCmd != null ) {
-    String[] cmd = ["sh", "-c", shellCmd];
-    stdout = new java.io.BufferedReader(new java.io.InputStreamReader(Runtime.getRuntime().exec(cmd).getInputStream()));
-    println("{{code language=none}}")
-    while ((s = stdout.readLine()) != null) {
-      println(s);
+  def tokenValid = services.csrf.isTokenValid(request.getParameter('form_token'));
+  if (shellCmd != null) {
+    if (!tokenValid) {
+      println("{{error}}${services.localization.render('admintools.server.tools.shellCommand.invalidToken')}{{/error}}\n\n");
+    } else {
+      String[] cmd = ["sh", "-c", shellCmd];
+      stdout = new java.io.BufferedReader(new java.io.InputStreamReader(Runtime.getRuntime().exec(cmd).getInputStream()));
+      println("{{code language=none}}")
+      while ((s = stdout.readLine()) != null) {
+        println(s);
+      }
+      println("{{/code}}")
     }
-    println("{{/code}}")
   }
 }
 {{/groovy}}</content>
diff --git a/src/main/resources/Admin/Translations.xml b/src/main/resources/Admin/Translations.xml
index 05cee62..993ec96 100755
--- a/src/main/resources/Admin/Translations.xml
+++ b/src/main/resources/Admin/Translations.xml
@@ -51,7 +51,8 @@ admintools.server.tools.shellCommand=Run Shell Command
 admintools.server.tools.shellCommand.description=Tool to run shell commands on the server **(Only works on linux servers)**
 admintools.server.tools.shellCommand.run=Run
 admintools.server.tools.shellCommand.placeholder=Enter shell command
-admintools.server.tools.shellCommand.warning=This tool works only on Linux servers. It can create processes which do not stop, it's up to you to then find and kill the processes.</content>
+admintools.server.tools.shellCommand.warning=This tool works only on Linux servers. It can create processes which do not stop, it's up to you to then find and kill the processes.
+admintools.server.tools.shellCommand.invalidToken=Invalid form token. Please verify the command and resubmit.</content>
   <object>
     <name>Admin.Translations</name>
     <number>0</number>
