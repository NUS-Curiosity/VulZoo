diff --git a/includes/core/load.js.php b/includes/core/load.js.php
index 90046065c..ccf317871 100755
--- a/includes/core/load.js.php
+++ b/includes/core/load.js.php
@@ -54,6 +54,20 @@
         debugJavascript = true;
     let hourInMinutes = 60;
 
+
+    $(document).ready(function() {
+        //console.log('-- PAGE LOADED --'+$(location).attr('href').includes('?')+" -- "+store.get('teampassUser'));
+        if ($(location).attr('href').includes('?') === true && (store.get('teampassUser') === undefined || parseInt(store.get('teampassUser').user_id) <= 0)) {
+            $(location).attr('href', 'index.php?session=expired');
+            return false;
+        }
+
+        // prevent a resubmit on refresh and back button
+        if (window.history.replaceState) {
+            window.history.replaceState(null, null, window.location.href);
+        }
+    });
+
     /**
     *   Add 1 hour to session duration
     **/
diff --git a/includes/core/logout.php b/includes/core/logout.php
index f0d7698f4..29e48e1b6 100755
--- a/includes/core/logout.php
+++ b/includes/core/logout.php
@@ -95,6 +95,7 @@
         store.remove("teampassUser");
         store.remove("teampassItem");
         sessionStorage.clear();
+        localStorage.clear();
         
         setTimeout(function() {
             document.location.href="../../index.php"
diff --git a/index.php b/index.php
index b9f44bf7f..fddce48c4 100755
--- a/index.php
+++ b/index.php
@@ -26,6 +26,9 @@
 
 header('X-XSS-Protection: 1; mode=block');
 header('X-Frame-Options: SameOrigin');
+header("Cache-Control: no-cache, no-store, must-revalidate");
+header("Pragma: no-cache");
+header("Expires: 0");
 // **PREVENTING SESSION HIJACKING**
 // Prevents javascript XSS attacks aimed to steal the session ID
 //ini_set('session.cookie_httponly', 1);
@@ -218,6 +221,14 @@
                 location.replace('./includes/core/logout.php');
             }
         }
+
+        //history.pushState(null, null, 'index.php?session=expired');
+        /*function preventBack() {
+            window.history.forward(); 
+        }        
+        setTimeout("preventBack()", 0);        
+        window.onunload = function () { null };
+        */
         //]]>
     </script>
 
diff --git a/pages/users.js.php b/pages/users.js.php
index 4649494c8..499435ea4 100755
--- a/pages/users.js.php
+++ b/pages/users.js.php
@@ -880,6 +880,24 @@ function(data) {
                 }
             });
 
+            // Sanitize text fields
+            let formLogin = fieldSanitizeStep1('#form-login', false, false, false),
+                formName = fieldSanitizeStep1('#form-name', false, false, false),
+                formLastname = fieldSanitizeStep1('#form-lastname', false, false, false),
+                formEmail = fieldSanitizeStep1('#form-email', false, false, false),
+            if (formLogin === false || formName === false || formLastname === false || formEmail === false) {
+                // Label is empty
+                toastr.remove();
+                toastr.warning(
+                    'XSS attempt detected. Field has been emptied.',
+                    'Error', {
+                        timeOut: 5000,
+                        progressBar: true
+                    }
+                );
+                return false;
+            }
+
             if (arrayQuery.length > 0) {
                 // Now save
                 // get lists
@@ -960,10 +978,10 @@ function(teampassUser) {
                 //prepare data
                 var data = {
                     'user_id': store.get('teampassApplication').formUserId,
-                    'login': DOMPurify.sanitize($('#form-login').val()),
-                    'name': DOMPurify.sanitize($('#form-name').val()),
-                    'lastname': DOMPurify.sanitize($('#form-lastname').val()),
-                    'email': DOMPurify.sanitize($('#form-email').val()),
+                    'login': formLogin,
+                    'name': formName,
+                    'lastname': formLastname,
+                    'email': formEmail,
                     'admin': $('#privilege-admin').prop('checked'),
                     'manager': $('#privilege-manager').prop('checked'),
                     'hr': $('#privilege-hr').prop('checked'),
diff --git a/sources/main.queries.php b/sources/main.queries.php
index 65f9a7ef8..76805a9df 100755
--- a/sources/main.queries.php
+++ b/sources/main.queries.php
@@ -86,7 +86,7 @@
 function mainQuery(array $SETTINGS)
 {
     header('Content-type: text/html; charset=utf-8');
-    header('Cache-Control: no-cache, must-revalidate');
+    header('Cache-Control: no-cache');
     error_reporting(E_ERROR);
 
 
