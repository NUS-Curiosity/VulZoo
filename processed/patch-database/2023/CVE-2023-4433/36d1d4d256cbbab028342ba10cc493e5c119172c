diff --git a/CHANGELOG.md b/CHANGELOG.md
index 3753d109..fe9f6277 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -1,5 +1,9 @@
 # Release Notes
 
+## WIP
+
+- Fix mime type detection on asset upload
+
 ## 2.6.3 (2023-08-15)
 
 - Prevent uploading .phps + .(x)html files in assets manager
diff --git a/modules/Assets/bootstrap.php b/modules/Assets/bootstrap.php
index 868a5260..f4bffbec 100644
--- a/modules/Assets/bootstrap.php
+++ b/modules/Assets/bootstrap.php
@@ -81,13 +81,15 @@
             for ($i = 0; $i < $cnt; $i++) {
 
                 $_file  = $this->app->path('#tmp:').'/'.$files['name'][$i];
-                $_mime = finfo_file($finfo, $_file);
+                $_mime = $finfo->file($files['tmp_name'][$i]);
                 $_isAllowed = $allowed === true ? true : preg_match("/\.({$allowed})$/i", $_file);
                 $_sizeAllowed = $max_size ? filesize($files['tmp_name'][$i]) < $max_size : true;
 
+                $extension = strtolower(pathinfo(parse_url($_file, PHP_URL_PATH), PATHINFO_EXTENSION));
+
                 // prevent uploading php / html files
                 if ($_isAllowed && (
-                    in_array(strtolower(pathinfo($_file, PATHINFO_EXTENSION)), $forbiddenExtension) ||
+                    in_array($extension, $forbiddenExtension) ||
                     in_array(strtolower($_mime), $forbiddenMime)
                 )) {
                     $_isAllowed = false;
