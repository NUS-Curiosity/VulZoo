diff --git a/src/AuthLDAP.php b/src/AuthLDAP.php
index 3c5c3edfa77..222dd765546 100644
--- a/src/AuthLDAP.php
+++ b/src/AuthLDAP.php
@@ -3589,6 +3589,8 @@ public static function searchUserDn($ds, $options = [], ?bool &$error = null)
         $filter_value = $values['user_params']['value'];
         if ($values['login_field'] == 'objectguid' && self::isValidGuid($filter_value)) {
             $filter_value = self::guidToHex($filter_value);
+        } else {
+            $filter_value = ldap_escape($filter_value, '', LDAP_ESCAPE_FILTER);
         }
         $filter = "(" . $values['login_field'] . "=" . $filter_value . ")";
 
