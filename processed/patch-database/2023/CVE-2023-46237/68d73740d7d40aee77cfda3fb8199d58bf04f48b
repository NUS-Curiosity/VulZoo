diff --git a/packages/web/status/getfiles.php b/packages/web/status/getfiles.php
index 285d2bd695..30f9c6daeb 100644
--- a/packages/web/status/getfiles.php
+++ b/packages/web/status/getfiles.php
@@ -22,6 +22,16 @@
  * @link     https://fogproject.org
  */
 require '../commons/base.inc.php';
+
+// Prevent file enumeration by an unauthenticated user
+$unauthorized = !$currentUser->isValid() || empty($_SERVER['HTTP_X_REQUESTED_WITH'])
+    || strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) !== 'xmlhttprequest';
+
+if ($unauthorized) {
+    echo _('Unauthorized');
+    exit;
+}
+
 if (!is_string($_GET['path'])) {
     echo json_encode(
         _('Invalid')
