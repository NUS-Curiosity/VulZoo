diff --git a/.github/workflows/build-container.yaml b/.github/workflows/build-container.yaml
index 6af8bc26aa..adc15c7e27 100644
--- a/.github/workflows/build-container.yaml
+++ b/.github/workflows/build-container.yaml
@@ -11,7 +11,7 @@ jobs:
   build:
     name: Build Containers
     if: github.repository == 'xibosignage/xibo-cms'
-    runs-on: ubuntu-18.04
+    runs-on: ubuntu-22.04
     steps:
       - name: Checkout
         uses: actions/checkout@v1
@@ -48,4 +48,4 @@ jobs:
     steps:
       - name: Skip
         run: |
-          echo 'Skipped while in a fork'
\ No newline at end of file
+          echo 'Skipped while in a fork'
diff --git a/.github/workflows/build-cypress.yaml b/.github/workflows/build-cypress.yaml
index 9a9b107515..d2d16fe88e 100644
--- a/.github/workflows/build-cypress.yaml
+++ b/.github/workflows/build-cypress.yaml
@@ -9,7 +9,7 @@ jobs:
   build:
     name: Build Cypress
     if: github.repository == 'xibosignage/xibo-cms'
-    runs-on: ubuntu-18.04
+    runs-on: ubuntu-22.04
     steps:
       - name: Checkout
         uses: actions/checkout@v1
@@ -30,4 +30,4 @@ jobs:
     steps:
       - name: Skip
         run: |
-          echo 'Skipped while in a fork'
\ No newline at end of file
+          echo 'Skipped while in a fork'
diff --git a/.github/workflows/build-tag.yaml b/.github/workflows/build-tag.yaml
index a4a30168e0..1cc630e6b6 100644
--- a/.github/workflows/build-tag.yaml
+++ b/.github/workflows/build-tag.yaml
@@ -9,7 +9,7 @@ jobs:
   build:
     name: Build Containers
     if: github.repository == 'xibosignage/xibo-cms'
-    runs-on: ubuntu-18.04
+    runs-on: ubuntu-22.04
     steps:
       - name: Checkout
         uses: actions/checkout@v1
@@ -17,14 +17,14 @@ jobs:
           fetch-depth: 1
       - name: Build Image
         run: |
-          docker build . -t xibosignage/xibo-cms:release-${GITHUB_REF##*/} --build-arg GIT_COMMIT=${GITHUB_SHA}
+          docker build . -t ghcr.io/xibosignage/xibo-cms:release-${GITHUB_REF##*/} --build-arg GIT_COMMIT=${GITHUB_SHA}
       - name: Push Image
         run: |
-          docker login --username ${{ secrets.DOCKER_HUB_USERNAME }} --password ${{ secrets.DOCKER_HUB_TOKEN }}
-          docker push xibosignage/xibo-cms:release-${GITHUB_REF##*/}
+          docker login --username ${{ github.actor }} --password ${{ secrets.GITHUB_TOKEN }}
+          docker push ghcr.io/xibosignage/xibo-cms:release-${GITHUB_REF##*/}
       - name: Build archive
         run: |
-          CONTAINER=$(docker create xibosignage/xibo-cms:release-${GITHUB_REF##*/})
+          CONTAINER=$(docker create ghcr.io/xibosignage/xibo-cms:release-${GITHUB_REF##*/})
           echo 'Copying from container.'
           docker cp "$CONTAINER":/var/www/cms/ xibo-cms-${GITHUB_REF##*/}
           tar -czf xibo-cms-${GITHUB_REF##*/}.tar.gz xibo-cms-${GITHUB_REF##*/}
@@ -48,4 +48,4 @@ jobs:
     steps:
       - name: Skip
         run: |
-          echo 'Skipped while in a fork'
\ No newline at end of file
+          echo 'Skipped while in a fork'
diff --git a/.github/workflows/test-suite.yaml b/.github/workflows/test-suite.yaml
index a52cc298b7..c2afe2d063 100644
--- a/.github/workflows/test-suite.yaml
+++ b/.github/workflows/test-suite.yaml
@@ -5,7 +5,7 @@ on: [pull_request]
 jobs:
   test-suite:
     name: Build Containers and Run Tests
-    runs-on: ubuntu-18.04
+    runs-on: ubuntu-22.04
     steps:
       - name: Checkout
         uses: actions/checkout@v1
@@ -40,4 +40,4 @@ jobs:
         run: |
           docker exec cms-db mysql -ucms -pjenkins cms -e "INSERT INTO oauth_clients (id, secret, name, userId, authCode, clientCredentials) VALUES ('MrGPc7e3IL1hA6w13l7Ru5giygxmNiafGNhFv89d', 'Pk6DdDgu2HzSoepcMHRabY60lDEvQ9ucTejYvc5dOgNVSNaOJirCUM83oAzlwe0KBiGR2Nhi6ltclyNC1rmcq0CiJZXzE42KfeatQ4j9npr6nMIQAzMal8O8RiYrIoono306CfyvSSJRfVfKExIjj0ZyE4TUrtPezJbKmvkVDzh8aj3kbanDKatirhwpfqfVdfgsqVNjzIM9ZgKHnbrTX7nNULL3BtxxNGgDMuCuvKiJFrLSyIIz1F4SNrHwHz', 'cypress', 1, 0, 1)"
           docker exec cms-db mysql -ucms -pjenkins cms -e "INSERT INTO oauth_client_scopes (clientId, scopeId) VALUES ('MrGPc7e3IL1hA6w13l7Ru5giygxmNiafGNhFv89d', 'all') ON DUPLICATE KEY UPDATE scopeId = scopeId"
-          docker run --ipc=host --name cms-cypress --link=cms-web:web -v $(pwd)/cypress.json:/app/cypress.json -v $(pwd)/cypress:/app/cypress xibosignage/xibo-cms:cypress bash -c "CYPRESS_baseUrl=http://web /app/node_modules/.bin/cypress run --config screenshotsFolder=/app/results,video=false --reporter junit --reporter-options 'mochaFile=/app/results/results_cypress_[hash].xml,toConsole=true'"
\ No newline at end of file
+          docker run --ipc=host --name cms-cypress --link=cms-web:web -v $(pwd)/cypress.json:/app/cypress.json -v $(pwd)/cypress:/app/cypress xibosignage/xibo-cms:cypress bash -c "CYPRESS_baseUrl=http://web /app/node_modules/.bin/cypress run --config screenshotsFolder=/app/results,video=false --reporter junit --reporter-options 'mochaFile=/app/results/results_cypress_[hash].xml,toConsole=true'"
diff --git a/lib/Entity/DataSet.php b/lib/Entity/DataSet.php
index aa38a7d39c..1bdfbc5bae 100644
--- a/lib/Entity/DataSet.php
+++ b/lib/Entity/DataSet.php
@@ -432,7 +432,7 @@ public function getData($filterBy = [], $options = [])
         foreach ($this->getColumn() as $column) {
             /* @var DataSetColumn $column */
             $allowedOrderCols[] = $column->heading;
-            
+
             if ($column->dataSetColumnTypeId == 2 && !$options['includeFormulaColumns'])
                 continue;
 
@@ -445,7 +445,7 @@ public function getData($filterBy = [], $options = [])
                     continue;
                 }
 
-                $formula = str_replace($this->blackList, '', htmlspecialchars_decode($column->formula, ENT_QUOTES));
+                $formula = str_ireplace($this->blackList, '', htmlspecialchars_decode($column->formula, ENT_QUOTES));
                 $formula = str_replace('[DisplayId]', $displayId, $formula);
 
                 $heading = str_replace('[DisplayGeoLocation]', $displayGeoLocation, $formula) . ' AS `' . $column->heading . '`';
@@ -462,7 +462,7 @@ public function getData($filterBy = [], $options = [])
         // Filtering
         if ($filter != '') {
             // Support display filtering.
-            $filter = str_replace('[DisplayId]', $displayId, $filter);
+            $filter = str_ireplace('[DisplayId]', $displayId, $filter);
             $filter = str_replace($this->blackList, '', $filter);
 
             $body .= ' AND ' . $filter;
@@ -1070,4 +1070,4 @@ public function copyRows($dataSetIdSource, $dataSetIdTarget)
     {
         $this->getStore()->insert('INSERT INTO `dataset_' . $dataSetIdTarget . '`  SELECT * FROM `dataset_' . $dataSetIdSource . '` ' ,[]);
     }
-}
\ No newline at end of file
+}
diff --git a/lib/Factory/LayoutFactory.php b/lib/Factory/LayoutFactory.php
index a6b0394b08..47f0f2a801 100644
--- a/lib/Factory/LayoutFactory.php
+++ b/lib/Factory/LayoutFactory.php
@@ -1114,14 +1114,22 @@ public function createFromZip($zipFile, $layoutName, $userId, $template, $replac
         foreach ($mappings as $file) {
             // Import the Media File
             $intendedMediaName = $file['name'];
-            $temporaryFileName = $libraryLocation . $file['file'];
+
+            // Validate the file name
+            $fileName = basename($file['file']);
+            if (empty($fileName) || $fileName == '.') {
+                $this->getLog()->error('Skipping file on import due to invalid filename. ' . $fileName);
+                continue;
+            }
+
+            $temporaryFileName = $libraryLocation . $fileName;
 
             // Get the file from the ZIP
-            $fileStream = $zip->getStream('library/' . $file['file']);
+            $fileStream = $zip->getStream('library/' . $fileName);
 
             if ($fileStream === false) {
                 // Log out the entire ZIP file and all entries.
-                $log = 'Problem getting library/' . $file['file'] . '. Files: ';
+                $log = 'Problem getting library/' . $fileName . '. Files: ';
                 for ($i = 0; $i < $zip->numFiles; $i++) {
                     $log .= $zip->getNameIndex($i) . ', ';
                 }
@@ -1161,9 +1169,9 @@ public function createFromZip($zipFile, $layoutName, $userId, $template, $replac
 
             } catch (NotFoundException $e) {
                 // Create it instead
-                $this->getLog()->debug('Media does not exist in Library, add it. %s', $file['file']);
+                $this->getLog()->debug('Media does not exist in Library, add it. %s', $fileName);
 
-                $media = $this->mediaFactory->create($intendedMediaName, $file['file'], $file['type'], $userId, $file['duration']);
+                $media = $this->mediaFactory->create($intendedMediaName, $fileName, $file['type'], $userId, $file['duration']);
                 $media->tags[] = $this->tagFactory->tagFromString('imported');
 
                 // Get global stat setting of media to set to on/off/inherit
@@ -1293,7 +1301,7 @@ public function createFromZip($zipFile, $layoutName, $userId, $template, $replac
 
                 // We must null the ID so that we don't try to load the dataset when we assign columns
                 $dataSet->dataSetId = null;
-                
+
                 // Hydrate the columns
                 foreach ($item['columns'] as $columnItem) {
                     $this->getLog()->debug('Assigning column: %s', json_encode($columnItem));
@@ -2217,4 +2225,4 @@ public function concurrentRequestRelease(Layout $layout, bool $force = false)
     }
 
     // </editor-fold>
-}
\ No newline at end of file
+}
diff --git a/lib/Helper/Environment.php b/lib/Helper/Environment.php
index 9cd0ef8812..700ffd2b46 100644
--- a/lib/Helper/Environment.php
+++ b/lib/Helper/Environment.php
@@ -29,7 +29,7 @@
  */
 class Environment
 {
-    public static $WEBSITE_VERSION_NAME = '2.3.16';
+    public static $WEBSITE_VERSION_NAME = '2.3.17';
     public static $XMDS_VERSION = '5';
     public static $XLF_VERSION = 3;
     public static $VERSION_REQUIRED = '7.0.8';
