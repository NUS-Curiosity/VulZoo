diff --git a/fizz/server/ServerProtocol.cpp b/fizz/server/ServerProtocol.cpp
index 486c266ee78..52f12aafc5b 100644
--- a/fizz/server/ServerProtocol.cpp
+++ b/fizz/server/ServerProtocol.cpp
@@ -1214,6 +1214,12 @@ EventHandler<ServerTypes, StateEnum::ExpectingClientHello, Event::ClientHello>::
 
   auto cipher = negotiateCipher(chlo, state.context()->getSupportedCiphers());
 
+  if (state.cipher().has_value() && cipher != *state.cipher()) {
+    throw FizzException(
+        "cipher mismatch with previous negotiation",
+        AlertDescription::illegal_parameter);
+  }
+
   verifyCookieState(cookieState, *version, cipher);
 
   auto resStateResult = getResumptionState(
@@ -1284,12 +1290,6 @@ EventHandler<ServerTypes, StateEnum::ExpectingClientHello, Event::ClientHello>::
             std::move(state.handshakeContext()),
             version);
 
-        if (state.cipher().has_value() && cipher != *state.cipher()) {
-          throw FizzException(
-              "cipher mismatch with previous negotiation",
-              AlertDescription::illegal_parameter);
-        }
-
         auto alpn = negotiateAlpn(chlo, folly::none, *state.context());
 
         auto clockSkew = getClockSkew(
