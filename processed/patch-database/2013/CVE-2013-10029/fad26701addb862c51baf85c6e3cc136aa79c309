diff --git a/wordpress-exit-box-lite.php b/wordpress-exit-box-lite.php
index 27219ac..a2557ff 100644
--- a/wordpress-exit-box-lite.php
+++ b/wordpress-exit-box-lite.php
@@ -3,18 +3,21 @@
 /**
  * @package Wordpress Exit Box Lite
  * @author Bouzid Nazim Zitouni
- * @version 1.06
+ * @version 1.10
  */
 /*
 Plugin Name: Wordpress Exit Box Lite
 Plugin URI: http://angrybyte.com/wordpress-plugins/wordpress-exit-box-finally-released/
 Description: Wordpress exit box is used design and display your exit box, a ThickBox page that will be shown to your users when they click a external link.
 Author: Bouzid Nazim Zitouni
-Version: 1.06
+Version: 1.10
 Author URI: http://angrybyte.com
 */
 
-
+if(!function_exists('add_action')){
+    echo ""; // someone is trying to run the plugin directly, added to avoid full path disclosure.
+    die;
+}
 add_option("exitboxcontents",
     '<h2 style="text-align: center;">It was nice having you! We hope you enjoyed your stay.</h2>',
     'Contents of the Exit page', 'yes');
@@ -88,8 +91,7 @@ function exitboxadmin()
 }
 function exit_box_admin()
 {
-
-    if ($_POST['xx'])
+     if (($_POST["xx"])&& (is_admin())&& check_admin_referer( 'exit_box_save', 'exit_box_nonce' ))
     {
 
         if (is_numeric($_POST['exitboxwidth']) || $_POST['exitboxwidth'] == "auto")
@@ -129,7 +131,7 @@ function exit_box_admin()
     {
         echo "<textarea name='xx' cols='150' rows='20'>$oldtemp</textarea>";
     }
-
+    wp_nonce_field( 'exit_box_save','exit_box_nonce' ); 
     echo <<< EOFT
 
   <br/>
