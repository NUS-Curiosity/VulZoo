diff --git a/exitpage.php b/exitpage.php
index 659f9dd..b813c7c 100644
--- a/exitpage.php
+++ b/exitpage.php
@@ -3,18 +3,21 @@
 /**
  * @package Wordpress Exit Strategy
  * @author Bouzid Nazim Zitouni
- * @version 1.55
+ * @version 1.59
  */
 /*
 Plugin Name: Wordpress Exit Strategy
 Plugin URI: http://angrybyte.com/wordpress-plugins/wordpress-exit-strategy/
 Description: Exit Strategy will pass all outgoing links from your site through a nofollow link to an exit page before finally being redirected to the external link. You may place anything in your exit page: Ads, Subscribtion buttons, etc. Using Wordpress Exit Strategy you improve your SEO score by not linking directly to external pages, you get more subscribers & more revenues if you use Ads.
 Author: Bouzid Nazim Zitouni
-Version: 1.55
+Version: 1.59
 Author URI: http://angrybyte.com
 */
 
-
+if(!function_exists('add_action')){
+    echo ""; // someone is trying to run the plugin directly, added to avoid full path disclosure.
+    die;
+}
 add_option("exitpagecontents",
     'Thank you for your visit, You`ll be redirected in %n% seconds <br> <a href="%link%">Click here if you are not redirected automatically</a>',
     'Contents of the Exit page', 'yes');
@@ -35,7 +38,7 @@ function exitpageadmin()
 function exit_page_admin()
 {
 
-    if ($_POST['xx'])
+    if (($_POST["xx"])&& (is_admin())&& check_admin_referer( 'exit_strategy_save', 'exit_strategy_nonce' ))
     {
         update_option('exitpagecontents', $_POST['xx']);
         update_option('redirecttoparent', $_POST['redirectpar']);
@@ -83,7 +86,7 @@ function exit_page_admin()
     {
         echo "<textarea name='xx' cols='150' rows='20'>$oldtemp</textarea>";
     }
-
+     wp_nonce_field( 'exit_strategy_save','exit_strategy_nonce' ); 
     echo <<< EOFT
 
   <br/>
