diff --git a/lib/grit_adapter/git_layer_grit.rb b/lib/grit_adapter/git_layer_grit.rb
index f607a7a..e677ca6 100644
--- a/lib/grit_adapter/git_layer_grit.rb
+++ b/lib/grit_adapter/git_layer_grit.rb
@@ -136,6 +136,8 @@ def exist?
       
       def grep(query, options={})
         ref = options[:ref] ? options[:ref] : "HEAD"
+        query = Shellwords.split(query).select {|q| !(q =~ /^(-O)|(--open-files-in-pager)/) }
+        query = Shellwords.join(query)
         args = [{}, '-I', '-i', '-c', query, ref, '--']
         args << options[:path] if options[:path]
         result = @git.grep(*args).split("\n")
@@ -165,6 +167,7 @@ def rev_list(options, *refs)
       
       def ls_files(query, options = {})
         options[:ref] = options[:ref] ? options[:ref] : "HEAD"
+        query = Shellwords.shellescape(query)
         @git.ls_files({}, "*#{query}*").split("\n")
       end
       
