diff --git a/scrypt.go b/scrypt.go
index 71a5a4a..c378826 100644
--- a/scrypt.go
+++ b/scrypt.go
@@ -4,6 +4,7 @@ import (
 	"bytes"
 	"crypto/rand"
 	"crypto/sha256"
+	"crypto/subtle"
 	"encoding/binary"
 	"log"
 
@@ -117,8 +118,12 @@ func VerifyPassphrase(passphrase string, keylen_bytes int, target_key []byte) (r
 	}
 	source_hash := hash_digest.Sum(nil)
 
-	result = bytes.Equal(source_master_key, target_master_key) &&
-		bytes.Equal(target_hash, source_hash)
+	// ConstantTimeCompare returns ints. Converting it to bool
+	key_comp := subtle.ConstantTimeCompare(source_master_key,
+		target_master_key) != 0
+	hash_comp := subtle.ConstantTimeCompare(target_hash,
+		source_hash) != 0
+	result = key_comp && hash_comp
 	return
 }
 
