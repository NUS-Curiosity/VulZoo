diff --git a/lib/InternalChatProtocol.fe b/lib/InternalChatProtocol.fe
index 18039de..18568e2 100644
--- a/lib/InternalChatProtocol.fe
+++ b/lib/InternalChatProtocol.fe
@@ -91,8 +91,16 @@ namespace ChatMCAM {
 	}
 	
 	function _formatBody( string body ) {
-		object r = new Regexp('(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])', 'i');
-		return r.replaceAll(body, '<a style="color:#333399;" target="_blank" href="\1">\1</a>');
+		object r;
+		body = Regexp.replaceAll('&', body, '&amp;');
+		body = Regexp.replaceAll('<', body, '&lt;');
+		body = Regexp.replaceAll('>', body, '&gt;');
+		body = Regexp.replaceAll('"', body, '&quot;');
+		body = Regexp.replaceAll("'", body, '&#x27;');
+		body = Regexp.replaceAll('/', body, '&#x2F;');
+		r = new Regexp('(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])', 'i');
+		body = r.replaceAll(body, '<a style="color:#333399;" target="_blank" href="\1">\1</a>');
+		return body;
 	}
 	
 	function _getList( array area_ids, array user_ids) {
