diff --git a/announce.php b/announce.php
index 20b1dc0..1a598cc 100644
--- a/announce.php
+++ b/announce.php
@@ -108,12 +108,12 @@
 $state = 'state';
 $attempt = 'attempt';
 if (isset($_GET['event'])){
-	$state = "'" . $_GET['event'] . "'";
+	$state = "'" . mysql_real_escape_string($_GET['event']) . "'";
 	$attempt = 'LAST_INSERT_ID(peer_torrent.id)';
 }
 
-mysql_query('INSERT INTO peer_torrent (peer_id, torrent_id, uploaded, downloaded, `left`, state, attempt, `last_updated`) '
-	. 'SELECT ' . $pk_peer . ', `torrent`.`id`, ' . intval($_GET['uploaded']) . ', ' . intval($_GET['downloaded']) . ', ' . intval($_GET['left']) . ', ' . $state .  ', ' . 0 . ', UTC_TIMESTAMP() '
+mysql_query('INSERT INTO peer_torrent (peer_id, torrent_id, uploaded, downloaded, `left`, attempt, `last_updated`) '
+	. 'SELECT ' . $pk_peer . ', `torrent`.`id`, ' . intval($_GET['uploaded']) . ', ' . intval($_GET['downloaded']) . ', ' . intval($_GET['left']) . ', ' . 0 . ', UTC_TIMESTAMP() '
 	. 'FROM `torrent` '
 	. "WHERE `torrent`.`hash` = '" . mysql_real_escape_string(bin2hex($_GET['info_hash'])) . "' "
 	. 'ON DUPLICATE KEY UPDATE `uploaded` = VALUES(`uploaded`), `downloaded` = VALUES(`downloaded`), `left` = VALUES(`left`), ' 
