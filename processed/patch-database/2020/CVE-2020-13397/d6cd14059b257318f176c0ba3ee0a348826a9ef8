diff --git a/libfreerdp/core/security.c b/libfreerdp/core/security.c
index bce1855c4c6e..e6571c36dfac 100644
--- a/libfreerdp/core/security.c
+++ b/libfreerdp/core/security.c
@@ -816,6 +816,9 @@ BOOL security_fips_decrypt(BYTE* data, size_t length, rdpRdp* rdp)
 {
 	size_t olen;
 
+	if (!rdp || !rdp->fips_decrypt)
+		return FALSE;
+
 	if (!winpr_Cipher_Update(rdp->fips_decrypt, data, length, data, &olen))
 		return FALSE;
 
