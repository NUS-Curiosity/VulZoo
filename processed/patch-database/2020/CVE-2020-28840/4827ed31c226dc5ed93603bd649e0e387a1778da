diff --git a/jpgfile.c b/jpgfile.c
index 3bf757f..45d97dc 100644
--- a/jpgfile.c
+++ b/jpgfile.c
@@ -48,7 +48,7 @@ static void process_COM (const uchar * Data, int length)
     for (a=2;a<length;a++){
         ch = Data[a];
 
-        if (ch == '\r' && Data[a+1] == '\n') continue; // Remove cr followed by lf.
+        if (ch == '\r' && a < length-1 && Data[a+1] == '\n') continue; // Remove cr followed by lf.
 
         if (ch >= 32 || ch == '\n' || ch == '\t'){
             Comment[nch++] = (char)ch;
