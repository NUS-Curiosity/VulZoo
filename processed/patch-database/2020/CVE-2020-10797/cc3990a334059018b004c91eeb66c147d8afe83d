diff --git a/src/usr/local/www/diag_ping.php b/src/usr/local/www/diag_ping.php
index 096fac536f0..995903ccdf9 100644
--- a/src/usr/local/www/diag_ping.php
+++ b/src/usr/local/www/diag_ping.php
@@ -68,6 +68,9 @@
 	if (($ipproto == "ipv6") && is_ipaddrv4($host)) {
 		$input_errors[] = gettext("When using IPv6, the target host must be an IPv6 address or hostname.");
 	}
+	if (!is_ipaddr($host) && !is_hostname($host)) {
+		$input_errors[] = gettext("Hostname must be a valid hostname or IP address.");
+	}
 
 	if (!$input_errors) {
 		if ($_POST) {
@@ -185,7 +188,7 @@
 		</div>
 
 		<div class="panel-body">
-			<pre><?= $result ?></pre>
+			<pre><?= htmlspecialchars($result) ?></pre>
 		</div>
 	</div>
 <?php
diff --git a/src/usr/local/www/diag_traceroute.php b/src/usr/local/www/diag_traceroute.php
index 34a198a6e18..f04d05453e2 100644
--- a/src/usr/local/www/diag_traceroute.php
+++ b/src/usr/local/www/diag_traceroute.php
@@ -71,6 +71,9 @@
 	if (($ipproto == "ipv6") && is_ipaddrv4($host)) {
 		$input_errors[] = gettext("When using IPv6, the target host must be an IPv6 address or hostname.");
 	}
+	if (!is_ipaddr($host) && !is_hostname($host)) {
+		$input_errors[] = gettext("Hostname must be a valid hostname or IP address.");
+	}
 
 	$sourceip = $_REQUEST['sourceip'];
 	$ttl = $_REQUEST['ttl'];
@@ -183,7 +186,7 @@
 		<div class="panel-heading"><h2 class="panel-title"><?=gettext('Results')?></h2></div>
 		<div class="panel-body">
 <?php
-	print('<pre>' . $result . '</pre>');
+	print('<pre>' . htmlspecialchars($result) . '</pre>');
 ?>
 		</div>
 	</div>
