diff --git a/freewvs b/freewvs
index 2c16e23..36f89e7 100755
--- a/freewvs
+++ b/freewvs
@@ -109,7 +109,11 @@ if opts.xml:
 # start the search
 
 for fdir in opts.dirs:
-    for root, _, files in os.walk(fdir):
+    for root, dirs, files in os.walk(fdir):
+        # this protects us against nested directories causing
+        # an exception
+        if root.count(os.sep) > 500:
+            del dirs[:]
         for filename in scanfiles.intersection(files):
             for item in jconfig:
                 if not opts.thirdparty and 'thirdparty' in item:
