diff --git a/ChangeLog b/ChangeLog
index 0004e3584..3585f430f 100644
--- a/ChangeLog
+++ b/ChangeLog
@@ -1,5 +1,6 @@
 0.21.3
 	update: add a log entry limit to the object page (Mantis#769)
+	bugfix: fix an XSS issue in an error message
 0.21.2 2019-03-25
 	update: enable CSS and JavaScript from external URLs (GH#231)
 	update: 802.1Q: do permission check for changing native vlan while keeping the allowed vlans list unchanged
diff --git a/wwwroot/index.php b/wwwroot/index.php
index 95ec62518..ca360b406 100644
--- a/wwwroot/index.php
+++ b/wwwroot/index.php
@@ -219,12 +219,14 @@
 			if ($op == 'addFile' && !isset($_FILES['file']['error']))
 				throw new RackTablesError ('File upload error, check upload_max_filesize in php.ini', RackTablesError::MISCONFIGURED);
 			fixContext();
+			// This could be a malformed request rather than an internal error, but spelling
+			// that in proper detail would require finer checks.
 			if
 			(
 				! isset ($ophandler[$pageno][$tabno][$op]) ||
 				! is_callable ($ophandler[$pageno][$tabno][$op])
 			)
-				throw new RackTablesError ("Invalid navigation data for '${pageno}-${tabno}-${op}'", RackTablesError::INTERNAL);
+				throw new RackTablesError ('This request has no ophandler function.', RackTablesError::INTERNAL);
 			// We have a chance to handle an error before starting HTTP header.
 			if (!isset ($delayauth["${pageno}-${tabno}-${op}"]))
 				assertPermission();
