diff --git a/miniserv.pl b/miniserv.pl
index f8f97bdbaa..23cad440f1 100755
--- a/miniserv.pl
+++ b/miniserv.pl
@@ -2603,8 +2603,9 @@ sub handle_request
 		if ($on_windows) {
 			# Run the CGI program, and feed it input
 			chdir($ENV{"PWD"});
-			local $qqueryargs = join(" ", map { "\"$_\"" }
-						 split(/\s+/, $queryargs));
+			local $qqueryargs = join(" ",
+				map { s/([<>|&"^])/^$1/g; "\"$_\"" }
+				    split(/\s+/, $queryargs));
 			if ($first =~ /(perl|perl.exe)$/i) {
 				# On Windows, run with Perl
 				open(CGIOUTr, "$perl_path \"$full\" $qqueryargs <$infile |");
diff --git a/status/ping-monitor.pl b/status/ping-monitor.pl
index 1e6f05830c..6650852814 100755
--- a/status/ping-monitor.pl
+++ b/status/ping-monitor.pl
@@ -10,7 +10,8 @@ sub get_ping_status
 local $ip = &to_ipaddress($_[0]->{'host'}) ||
 	    &to_ip6address($_[0]->{'host'});
 return { 'up' => 0 } if (!$ip);
-local $ipv6 = &to_ip6address($_[0]->{'host'}) &&
+local $ipv6 = &check_ip6address($_[0]->{'host'}) ||
+	      &to_ip6address($_[0]->{'host'}) &&
 	      !&to_ipaddress($_[0]->{'host'});
 if ($config{'pinger'} || $ipv6) {
 	# Call a ping command if configured, or if using IPv6 since the built-
