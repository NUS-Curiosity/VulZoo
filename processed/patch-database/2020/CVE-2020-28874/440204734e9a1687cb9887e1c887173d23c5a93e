diff --git a/reset-password.php b/reset-password.php
index 4f88ea5cb..d2c5ebd74 100644
--- a/reset-password.php
+++ b/reset-password.php
@@ -55,6 +55,11 @@
         }
     }
 
+    /** Fix CVE-2020-28874 */
+    if (!empty($errorstate)) {
+        unset($user_data);
+    }
+
     /** The form was submitted */
     if ($_POST) {
         /**
