diff --git a/programs/pluto/ikev1.c b/programs/pluto/ikev1.c
index 78d5c3eca14..244b00f5cca 100644
--- a/programs/pluto/ikev1.c
+++ b/programs/pluto/ikev1.c
@@ -2129,7 +2129,7 @@ void process_packet_tail(struct msg_digest *md)
 						"%smessage ignored because it contains a payload type (%s) unexpected by state %s",
 						excuse,
 						enum_show(&ikev1_payload_names, np),
-						st->st_state->name);
+						finite_states[smc->state]->name);
 					if (!md->encrypted) {
 						SEND_NOTIFICATION(INVALID_PAYLOAD_TYPE);
 					}
