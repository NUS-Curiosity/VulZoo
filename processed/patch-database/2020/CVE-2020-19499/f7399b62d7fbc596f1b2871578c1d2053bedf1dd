diff --git a/fuzzing/corpus/github_138.heic b/fuzzing/corpus/github_138.heic
new file mode 100644
index 0000000000..75fdc979d2
Binary files /dev/null and b/fuzzing/corpus/github_138.heic differ
diff --git a/libheif/heif_context.cc b/libheif/heif_context.cc
index b5dabd6353..decbe836bb 100644
--- a/libheif/heif_context.cc
+++ b/libheif/heif_context.cc
@@ -813,6 +813,12 @@ Error HeifContext::get_id_of_non_virtual_child_image(heif_item_id id, heif_item_
       image_type=="iden" ||
       image_type=="iovl") {
     auto iref_box = m_heif_file->get_iref_box();
+    if (!iref_box) {
+      return Error(heif_error_Invalid_input,
+                   heif_suberror_No_item_data,
+                   "Derived image does not reference any other image items");
+    }
+
     std::vector<heif_item_id> image_references = iref_box->get_references(id, fourcc("dimg"));
 
     // TODO: check whether this really can be recursive (e.g. overlay of grid images)
