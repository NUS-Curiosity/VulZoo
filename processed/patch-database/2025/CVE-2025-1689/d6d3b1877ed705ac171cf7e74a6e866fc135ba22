diff --git a/css/styles.css b/css/styles.css
deleted file mode 100644
index cd8ba1c..0000000
--- a/css/styles.css
+++ /dev/null
@@ -1,53 +0,0 @@
-.sel {
-	height: 26px;
-	position: relative;
-	display: inline-block;
-	margin-right: 2px;
-	vertical-align: top;
-}
-
-	.sel select {
-		border: 1px solid #D5D6D6;
-		color: #8F9194;
-		display: inline-block;
-		height: 26px;
-		margin: 0;
-		padding: 4px 10px;
-		-webkit-border-radius: 3px;
-				border-radius: 3px;
-		 -webkit-box-sizing: border-box;
-		   -moz-box-sizing: border-box;
-				box-sizing: border-box;
-		-webkit-transition: all 0.25s linear 0s;
-				transition: all 0.25s linear 0s;
-	}
-
-	.sel select {
-		background: #fff;
-		cursor: pointer;
-		width: 100%;
-		-webkit-box-shadow: none;
-				box-shadow: none;
-		-webkit-appearance: none;
-		   -moz-appearance: none;
-				appearance: none;
-	}
-
-	.sel select:hover {
-		background: #fff;
-		border-color: #f2a500;
-	}
-
-	.sel:after {
-		content: '';
-		width: 22px;
-		height: 20px;
-		top: 1px;
-		right: 7px;
-		display: block;
-		background: url(images/select-pointer.png) 0 0 no-repeat;
-		position: absolute;
-		pointer-events: none;
-	}
-	
-	.sel:hover:after {background-position: 0 -24px;}
\ No newline at end of file
diff --git a/form-handler.php b/form-handler.php
index ba90750..d20af68 100644
--- a/form-handler.php
+++ b/form-handler.php
@@ -9,25 +9,21 @@
 require_once TMM_PAYPAL_PLUGIN_PATH . '/classes/paypalApi.php';
 
 if (isset($_POST['func']) && $_POST['func'] === 'start') {
-
 	paypalApi::startExpressCheckout();
-
 } else if (isset($_GET['func']) && $_GET['func'] == 'confirm' && isset($_GET['token']) && isset($_GET['PayerID'])) {
 
 	$message_num = 0;
 	$paypal_data = paypalApi::confirmExpressCheckout();
 	$config = paypalConfig::getInstance();
 
-	if ( isset($paypal_data['ACK']) && ($paypal_data['ACK'] == 'Success' || $paypal_data['ACK'] == 'SuccessWithWarning') ) {
+	if (isset($paypal_data['ACK']) && ($paypal_data['ACK'] == 'Success' || $paypal_data['ACK'] == 'SuccessWithWarning')) {
 		$message_num = TMM_Cardealer_User::user_paid_money($paypal_data);
 		header('Location: ' . $config->getItem('success_page'));
 	} else {
 		$message_num = $paypal_data['L_ERRORCODE0'];
 		header('Location: ' . $config->getItem('cancel_page') . '?errorcode=' . $message_num);
 	}
-
 } else {
 
 	header('Location: ' . $config->getItem('cancel_page'));
-
 }
diff --git a/images/select-pointer.png b/images/select-pointer.png
deleted file mode 100644
index 0cde790..0000000
Binary files a/images/select-pointer.png and /dev/null differ
diff --git a/index.php b/index.php
index cd24e4a..bc51218 100644
--- a/index.php
+++ b/index.php
@@ -5,7 +5,7 @@
  * Plugin URI: http://webtemplatemasters.com
  * Description: Integration of PayPal Express Checkout
  * Author: ThemeMakers
- * Version: 1.1.9
+ * Version: 1.2.0
  * Author URI: http://themeforest.net/user/ThemeMakers
  * Text Domain: tmm_paypal_checkout
  */
@@ -17,7 +17,8 @@
 require_once TMM_PAYPAL_PLUGIN_PATH . '/classes/paypalShortcode.php';
 require_once TMM_PAYPAL_PLUGIN_PATH . '/classes/paypalAdmin.php';
 
-function tmm_paypal_init () {
+function tmm_paypal_init()
+{
 
 	/* Set base configuration */
 	$config = paypalConfig::getInstance();
@@ -43,12 +44,13 @@ function tmm_paypal_init () {
 	$config->addItem('checkout_button_src', 'https://www.paypalobjects.com/en_US/i/btn/btn_xpressCheckout.gif');
 	// default currency
 	if (defined('TMM_APP_CARDEALER_PREFIX')) {
-		$config->addItem('default_currency', TMM::get_option('default_currency', TMM_APP_CARDEALER_PREFIX) );
-	}else {
+		$config->addItem('default_currency', TMM::get_option('default_currency', TMM_APP_CARDEALER_PREFIX));
+	} else {
 		$config->addItem('default_currency', false);
 	}
 	// supported currencies
-	$config->addItem('supported_currencies',
+	$config->addItem(
+		'supported_currencies',
 		array(
 			'AUD',
 			'BRL',
@@ -93,7 +95,6 @@ function tmm_paypal_init () {
 
 	/* create shortcode */
 	add_shortcode('paypal', array('paypalShortcode', 'frontendIndex'));
-
 }
 
 add_action('init', 'tmm_paypal_init', 2);
@@ -101,20 +102,22 @@ function tmm_paypal_init () {
 /**
  * Load plugin textdomain.
  */
-function tmm_paypal_load_textdomain() {
-	load_plugin_textdomain( 'tmm_paypal_checkout', false, plugin_basename( dirname( __FILE__ ) ) . '/languages' );
+function tmm_paypal_load_textdomain()
+{
+	load_plugin_textdomain('tmm_paypal_checkout', false, plugin_basename(dirname(__FILE__)) . '/languages');
 }
 
-add_action( 'plugins_loaded', 'tmm_paypal_load_textdomain' );
+add_action('plugins_loaded', 'tmm_paypal_load_textdomain');
 
 /**
  * Create admin menus
  */
-function adminMenu() {
-    $config = paypalConfig::getInstance();
+function adminMenu()
+{
+	$config = paypalConfig::getInstance();
 
-    add_menu_page($config->getItem('plugin_name'), $config->getItem('plugin_name'), 'level_10', $config->getItem('plugin_id'), array('paypalAdmin', 'adminConfiguration'), TMM_PAYPAL_PLUGIN_URL . '/images/icon.png');
-    add_submenu_page($config->getItem('plugin_id'), __('Payments history', $config->getItem('plugin_id')), __('Payments history', $config->getItem('plugin_id')), 'level_10', $config->getItem('plugin_history_id'), array('paypalAdmin', 'adminHistory'));
+	add_menu_page($config->getItem('plugin_name'), $config->getItem('plugin_name'), 'level_10', $config->getItem('plugin_id'), array('paypalAdmin', 'adminConfiguration'), TMM_PAYPAL_PLUGIN_URL . '/images/icon.png');
+	add_submenu_page($config->getItem('plugin_id'), __('Payments history', $config->getItem('plugin_id')), __('Payments history', $config->getItem('plugin_id')), 'level_10', $config->getItem('plugin_history_id'), array('paypalAdmin', 'adminHistory'));
 }
 
 add_action('admin_menu', 'adminMenu');
@@ -122,16 +125,17 @@ function adminMenu() {
 /**
  * Display amount in currency that supported by Paypal
  */
-function tmm_paypal_default_currency($amount) {
+function tmm_paypal_default_currency($amount)
+{
 	if ($amount <= 0) {
 		return;
 	}
 
-    $currency = TMM_Ext_Car_Dealer::$default_currency['name'];
+	$currency = TMM_Ext_Car_Dealer::$default_currency['name'];
 	$checked = apply_filters('tmm_paypal_currency', $currency, (float)$amount);
 
 	if ($currency !== $checked['currency']) {
-		if (TMM::get_option( 'car_price_symbol_pos', TMM_APP_CARDEALER_PREFIX ) === 'right') {
+		if (TMM::get_option('car_price_symbol_pos', TMM_APP_CARDEALER_PREFIX) === 'right') {
 			$price = $checked['amount'] . ' ' . $checked['currency'];
 		} else {
 			$price = $checked['currency'] . ' ' . $checked['amount'];
@@ -146,10 +150,11 @@ function tmm_paypal_default_currency($amount) {
  * Check currency.
  * If currency is not supported by Paypal convert it to default
  */
-function tmm_paypal_currency($currency, $amount) {
+function tmm_paypal_currency($currency, $amount)
+{
 	$config = paypalConfig::getInstance();
 
-	if ( !in_array($currency, $config->getItem('supported_currencies')) ){
+	if (!in_array($currency, $config->getItem('supported_currencies'))) {
 
 		$def_currency = get_option('paypal_currency');
 
@@ -161,12 +166,10 @@ function tmm_paypal_currency($currency, $amount) {
 				$amount = $new_amount;
 				$currency = $def_currency;
 			}
-
 		}
-
 	}
 
-	return array('currency'=>$currency, 'amount'=>$amount);
+	return array('currency' => $currency, 'amount' => $amount);
 }
 
 add_filter('tmm_paypal_currency', 'tmm_paypal_currency', 10, 2);
diff --git a/views/adminconfiguration.php b/views/adminconfiguration.php
index 1a4f7e7..29fd9de 100644
--- a/views/adminconfiguration.php
+++ b/views/adminconfiguration.php
@@ -1,11 +1,11 @@
-<?php if ( !defined('ABSPATH') ) exit; ?>
+<?php if (!defined('ABSPATH')) exit; ?>
 
 <div class="wrap">
-	<h2><?php _e('PayPal Express Checkout - Configuration', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></h2>
+	<h2><?php esc_html_e('PayPal Express Checkout - Configuration', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></h2>
 
 	<?php if (isset($config_saved) && $config_saved === TRUE) { ?>
-	    <div class="updated" id="message">
-			<p><strong><?php _e('Configuration updated.', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></p>
+		<div class="updated" id="message">
+			<p><strong><?php esc_html_e('Configuration updated.', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></p>
 		</div>
 	<?php } ?>
 
@@ -13,46 +13,45 @@
 		<table class="form-table">
 			<tbody>
 				<tr class="form-field">
-					<th scope="row"><label for="environment"><strong><?php _e('PayPal environment', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>:</strong></label></th>
+					<th scope="row"><label for="environment"><strong><?php esc_html_e('PayPal environment', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>:</strong></label></th>
 					<td>
 						<select id="environment" name="environment">
-							<!--<option value=""><?php //_e('Please select', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></option>-->
-							<option value="sandbox" <?php echo get_option('paypal_environment') == 'sandbox' ? 'selected="selected"' : ''; ?>><?php _e('Sandbox - Testing', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></option>
-							<option value="live" <?php echo get_option('paypal_environment') == 'live' ? 'selected="selected"' : ''; ?>><?php _e('Live - Production', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></option>
+							<option value="sandbox" <?php echo get_option('paypal_environment') == 'sandbox' ? 'selected="selected"' : ''; ?>><?php esc_html_e('Sandbox - Testing', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></option>
+							<option value="live" <?php echo get_option('paypal_environment') == 'live' ? 'selected="selected"' : ''; ?>><?php esc_html_e('Live - Production', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></option>
 						</select>
 					</td>
 				</tr>
 			</tbody>
 		</table>
-        <hr>
-        <h3 class="title"><?php _e('PayPal API credentials', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>:</h3>
+		<hr>
+		<h3 class="title"><?php esc_html_e('PayPal API credentials', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>:</h3>
 		<table class="form-table">
 			<tbody>
 				<tr class="form-field form-required">
-					<th scope="row"><label for="api_username"><?php _e('API Username', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?> <span class="description">(<?php _e('required', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>)</span></label></th>
-					<td><input type="text"  value="<?php echo get_option('paypal_api_username'); ?>" id="api_username" name="api_username" autocomplete="off"></td>
+					<th scope="row"><label for="api_username"><?php esc_html_e('API Username', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?> <span class="description">(<?php esc_html_e('required', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>)</span></label></th>
+					<td><input type="text" value="<?php echo get_option('paypal_api_username'); ?>" id="api_username" name="api_username" autocomplete="off"></td>
 				</tr>
 				<tr class="form-field form-required">
-					<th scope="row"><label for="api_password"><?php _e('API Password', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?><span class="description">(<?php _e('required', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>)</span></label></th>
-					<td><input type="password"  value="<?php echo get_option('paypal_api_password'); ?>" id="api_password" name="api_password" autocomplete="off"></td>
+					<th scope="row"><label for="api_password"><?php esc_html_e('API Password', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?><span class="description">(<?php esc_html_e('required', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>)</span></label></th>
+					<td><input type="password" value="<?php echo get_option('paypal_api_password'); ?>" id="api_password" name="api_password" autocomplete="off"></td>
 				</tr>
 				<tr class="form-field form-required">
-					<th scope="row"><label for="api_signature"><?php _e('API Signature', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?><span class="description">(<?php _e('required', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>)</span></label></th>
+					<th scope="row"><label for="api_signature"><?php esc_html_e('API Signature', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?><span class="description">(<?php esc_html_e('required', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>)</span></label></th>
 					<td><input type="text" aria-required="true" value="<?php echo get_option('paypal_api_signature'); ?>" id="api_signature" name="api_signature" autocomplete="off"></td>
 				</tr>
 			</tbody>
 		</table>
-        <hr>
+		<hr>
 		<table class="form-table">
 			<tbody>
 				<tr class="form-field">
-					<th scope="row"><label for="success_page"><strong><?php _e('Thank you page', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?> - <br /><?php _e('successful payment', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>:</strong></label></th>
+					<th scope="row"><label for="success_page"><strong><?php esc_html_e('Thank you page', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?> - <br /><?php esc_html_e('successful payment', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>:</strong></label></th>
 					<td>
 						<?php wp_dropdown_pages(array('name' => 'success_page', 'selected' => get_option('paypal_success_page'), 'show_option_none' => 'Please select')); ?>
 					</td>
 				</tr>
 				<tr class="form-field">
-					<th scope="row"><label for="cancel_page"><strong><?php _e('Error page', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?> - <br /><?php _e('failed payment', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>:</strong></label></th>
+					<th scope="row"><label for="cancel_page"><strong><?php esc_html_e('Error page', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?> - <br /><?php esc_html_e('failed payment', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>:</strong></label></th>
 					<td>
 						<?php wp_dropdown_pages(array('name' => 'cancel_page', 'selected' => get_option('paypal_cancel_page'), 'show_option_none' => __('Please select', TMM_PAYPAL_PLUGIN_TEXTDOMAIN))); ?>
 					</td>
@@ -63,50 +62,50 @@
 		<hr>
 		<table class="form-table">
 			<tbody>
-			<tr class="form-field form-required">
-				<th scope="row"><label for="paypal_solutiontype"><strong><?php _e('Type of checkout flow', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></label></th>
-				<td>
-					<select id="paypal_solutiontype" name="paypal_solutiontype">
-						<?php
+				<tr class="form-field form-required">
+					<th scope="row"><label for="paypal_solutiontype"><strong><?php esc_html_e('Type of checkout flow', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></label></th>
+					<td>
+						<select id="paypal_solutiontype" name="paypal_solutiontype">
+							<?php
 							$selected = get_option('paypal_solutiontype');
 							if (!$selected) {
 								$selected = 'Sole';
 							}
 							?>
-							<option value="Sole" <?php selected($selected, 'Sole');?>><?php _e('Buyer does not need to create a PayPal account to check out.', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></option>
-							<option value="Mark" <?php selected($selected, 'Mark');?>><?php _e('Buyer must have a PayPal account to check out.', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></option>
-					</select>
-				</td>
-			</tr>
+							<option value="Sole" <?php selected($selected, 'Sole'); ?>><?php esc_html_e('Buyer does not need to create a PayPal account to check out.', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></option>
+							<option value="Mark" <?php selected($selected, 'Mark'); ?>><?php esc_html_e('Buyer must have a PayPal account to check out.', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></option>
+						</select>
+					</td>
+				</tr>
 			</tbody>
 		</table>
 
 		<?php if (!in_array($config->getItem('default_currency'), $config->getItem('supported_currencies'))) { ?>
-		<hr>
-		<h3 class="title"><?php _e('PayPal currency', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>:</h3>
-		<table class="form-table">
-			<tbody>
-			<tr class="form-field form-required">
-				<th scope="row"><label for="paypal_currency"><strong><?php _e('Currency', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></label></th>
-				<td>
-					<select id="paypal_currency" name="paypal_currency">
-					<?php foreach ( $config->getItem('supported_currencies') as $val ) {
-						$selected = get_option('paypal_currency');
-						if (!$selected) {
-							$selected = 'USD';
-						}
-						?>
-						<option value="<?php echo $val; ?>" <?php selected($selected, $val);?>><?php echo $val; ?></option>
-					<?php } ?>
-					</select>
-				</td>
-			</tr>
-			</tbody>
-		</table>
+			<hr>
+			<h3 class="title"><?php esc_html_e('PayPal currency', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>:</h3>
+			<table class="form-table">
+				<tbody>
+					<tr class="form-field form-required">
+						<th scope="row"><label for="paypal_currency"><strong><?php esc_html_e('Currency', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></label></th>
+						<td>
+							<select id="paypal_currency" name="paypal_currency">
+								<?php foreach ($config->getItem('supported_currencies') as $val) {
+									$selected = get_option('paypal_currency');
+									if (!$selected) {
+										$selected = 'USD';
+									}
+								?>
+									<option value="<?php echo $val; ?>" <?php selected($selected, $val); ?>><?php echo $val; ?></option>
+								<?php } ?>
+							</select>
+						</td>
+					</tr>
+				</tbody>
+			</table>
 		<?php } ?>
 
 		<p class="submit">
-			<input type="submit" value="<?php _e('Save', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>" class="button-primary" />
+			<input type="submit" value="<?php esc_html_e('Save', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>" class="button-primary" />
 		</p>
 	</form>
-</div><!-- .wrap -->
+</div><!-- .wrap -->
\ No newline at end of file
diff --git a/views/adminhistory.php b/views/adminhistory.php
index 1b609b1..f03ff7d 100644
--- a/views/adminhistory.php
+++ b/views/adminhistory.php
@@ -1,34 +1,30 @@
-<?php
-if ( !defined('ABSPATH') ) exit;
-
-wp_enqueue_style("thememakers_paypal", TMM_PAYPAL_PLUGIN_URL . '/css/styles.css');
-?>
+<?php if (!defined('ABSPATH')) exit; ?>
 
 <div class="wrap">
-	<h2><?php _e('PayPal Express Checkout - Payments history', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></h2>
+	<h2><?php esc_html_e('PayPal Express Checkout - Payments history', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></h2>
 
 	<?php if (isset($config_saved) && $config_saved === TRUE) { ?>
 		<div class="updated" id="message">
-			<p><strong><?php _e('Payment updated.', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></p>
+			<p><strong><?php esc_html_e('Payment updated.', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></p>
 		</div>
 	<?php } ?>
 
 	<p>
-		<?php _e('Here you can see all payments made on your website.', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>
+		<?php esc_html_e('Here you can see all payments made on your website.', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>
 	</p>
 
 
 	<?php
 	unset($_GET['page']);
-	
+
 	$orderby = '';
 	$orderdir = '&order=' .  (isset($_GET['order']) ? $_GET['order'] : 'DESC');
-	if(isset($_GET['orderby'])){
+	if (isset($_GET['orderby'])) {
 		$orderby .= '&orderby=' . $_GET['orderby'] . $orderdir;
 	}
-	
+
 	$paged = '&paged=' . (isset($_GET['paged']) ? (int) $_GET['paged'] : 1);
-			
+
 	//***
 	$links = array(
 		'status_link' => 'status',
@@ -38,17 +34,17 @@
 		'email_link' => 'email',
 		'date_link' => 'created',
 	);
-	
-	if(isset($order)){
-        if ($order == 'DESC') {
-            $_GET['order'] = 'ASC';
-        } else {
-            $_GET['order'] = 'DESC';
-        }
-    }
-	
+
+	if (isset($order)) {
+		if ($order == 'DESC') {
+			$_GET['order'] = 'ASC';
+		} else {
+			$_GET['order'] = 'DESC';
+		}
+	}
+
 	foreach ($links as $k => $v) {
-		$links[$k] = $config->getItem('plugin_history_url') . $paged. '&orderby=' . $v . '&order=' . $_GET['order'];
+		$links[$k] = $config->getItem('plugin_history_url') . $paged . '&orderby=' . $v . '&order=' . $_GET['order'];
 	}
 
 	?>
@@ -57,12 +53,12 @@
 		<div class="alignleft actions">
 			<form method="post" action="<?php echo $config->getItem('plugin_history_url'); ?>" style="display: inline-block;">
 
-                <select name="y">
-                    <option value="-1" selected="selected"><?php _e('Show all years', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></option>
-                    <?php for ($y = intval(date('Y')); $y >= 2014; $y--): ?>
-                        <option <?php if ($year == $y): ?>selected=""<?php endif; ?> value="<?php echo $y ?>"><?php echo $y ?></option>
-                    <?php endfor; ?>
-                </select>
+				<select name="y">
+					<option value="-1" selected="selected"><?php esc_html_e('Show all years', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></option>
+					<?php for ($y = intval(date('Y')); $y >= 2014; $y--): ?>
+						<option <?php if ($year == $y): ?>selected="" <?php endif; ?> value="<?php echo $y ?>"><?php echo $y ?></option>
+					<?php endfor; ?>
+				</select>
 
 				<?php
 				$monthes = array(
@@ -81,14 +77,14 @@
 				);
 				?>
 
-                <select name="m">
-                    <option value="-1" selected="selected"><?php _e('Show all months', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></option>
-                    <?php for ($m = 0; $m < 12; $m++): ?>
-                        <option <?php if ($month == $m): ?>selected=""<?php endif; ?> value="<?php echo $m ?>"><?php echo $monthes[$m] ?></option>
-                    <?php endfor; ?>
-                </select>
+				<select name="m">
+					<option value="-1" selected="selected"><?php esc_html_e('Show all months', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></option>
+					<?php for ($m = 0; $m < 12; $m++): ?>
+						<option <?php if ($month == $m): ?>selected="" <?php endif; ?> value="<?php echo $m ?>"><?php echo $monthes[$m] ?></option>
+					<?php endfor; ?>
+				</select>
 
-				<input type="submit" value="<?php _e('Filter', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>" class="button" id="post-query-submit" name="">
+				<input type="submit" value="<?php esc_html_e('Filter', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>" class="button" id="post-query-submit" name="">
 			</form>
 
 		</div>
@@ -96,22 +92,22 @@
 		<div class="tablenav-pages">
 
 			<form method="post" action="<?php echo $config->getItem('plugin_history_url') ?>" style="display: inline-block;">
-				<input type="text" value="<?php echo isset($user_email) ? $user_email : '' ?>" name="user_email" placeholder="<?php _e('enter user email', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>">
-				<input type="submit" value="<?php _e('Search', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>" class="button">
+				<input type="text" value="<?php echo isset($user_email) ? $user_email : '' ?>" name="user_email" placeholder="<?php esc_html_e('enter user email', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>">
+				<input type="submit" value="<?php esc_html_e('Search', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>" class="button">
 			</form>
 
 			<?php if (isset($rows_count) && $limit < $rows_count): ?>
-				<span class="displaying-num"><?php echo $rows_count ?> <?php _e('items', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></span>
+				<span class="displaying-num"><?php echo $rows_count ?> <?php esc_html_e('items', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></span>
 				<span class="pagination-links">
-					<a href="<?php echo($pagenum > 1 ? $config->getItem('plugin_history_url').'&paged=1'.$orderby : '#') ?>" title="<?php _e('Go to the first page', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>" class="first-page <?php if ($pagenum == 1): ?>disabled<?php endif; ?>">«</a>
-					<a href="<?php echo($pagenum > 1 ? $config->getItem('plugin_history_url').'&paged='.($pagenum>1 ? ($pagenum - 1) : 1).$orderby : '#') ?>" title="<?php _e('Go to the previous page', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>" class="prev-page <?php if ($pagenum == 1): ?>disabled<?php endif; ?>">‹</a>
+					<a href="<?php echo ($pagenum > 1 ? $config->getItem('plugin_history_url') . '&paged=1' . $orderby : '#') ?>" title="<?php esc_html_e('Go to the first page', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>" class="first-page <?php if ($pagenum == 1): ?>disabled<?php endif; ?>">«</a>
+					<a href="<?php echo ($pagenum > 1 ? $config->getItem('plugin_history_url') . '&paged=' . ($pagenum > 1 ? ($pagenum - 1) : 1) . $orderby : '#') ?>" title="<?php esc_html_e('Go to the previous page', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>" class="prev-page <?php if ($pagenum == 1): ?>disabled<?php endif; ?>">‹</a>
 					<span class="paging-input">
-						<form style="display: inline-block;" method="post" action="<?php echo $config->getItem('plugin_history_url').$orderby; ?>">
-							<input type="text" size="1" value="<?php echo $pagenum ?>" name="paged" title="<?php _e('Current page', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>" class="current-page"> <?php _e('of', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?> <span class="total-pages"><?php echo ceil($rows_count / $limit) ?></span>
+						<form style="display: inline-block;" method="post" action="<?php echo $config->getItem('plugin_history_url') . $orderby; ?>">
+							<input type="text" size="1" value="<?php echo $pagenum ?>" name="paged" title="<?php esc_html_e('Current page', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>" class="current-page"> <?php esc_html_e('of', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?> <span class="total-pages"><?php echo ceil($rows_count / $limit) ?></span>
 						</form>
 					</span>
-					<a href="<?php echo($pagenum < ceil($rows_count / $limit) ? $config->getItem('plugin_history_url').'&paged='.($pagenum + 1).$orderby : '#') ?>" title="<?php _e('Go to the next page', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>" class="next-page <?php if ($pagenum >= ceil($rows_count / $limit)): ?>disabled<?php endif; ?>">›</a>
-					<a href="<?php echo($pagenum < ceil($rows_count / $limit) ? $config->getItem('plugin_history_url').'&paged='.(ceil($rows_count / $limit)).$orderby : '#') ?>" title="<?php _e('Go to the last page', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>" class="last-page <?php if ($pagenum >= ceil($rows_count / $limit)): ?>disabled<?php endif; ?>">»</a>
+					<a href="<?php echo ($pagenum < ceil($rows_count / $limit) ? $config->getItem('plugin_history_url') . '&paged=' . ($pagenum + 1) . $orderby : '#') ?>" title="<?php esc_html_e('Go to the next page', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>" class="next-page <?php if ($pagenum >= ceil($rows_count / $limit)): ?>disabled<?php endif; ?>">›</a>
+					<a href="<?php echo ($pagenum < ceil($rows_count / $limit) ? $config->getItem('plugin_history_url') . '&paged=' . (ceil($rows_count / $limit)) . $orderby : '#') ?>" title="<?php esc_html_e('Go to the last page', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>" class="last-page <?php if ($pagenum >= ceil($rows_count / $limit)): ?>disabled<?php endif; ?>">»</a>
 				</span>
 			<?php endif; ?>
 		</div>
@@ -123,34 +119,34 @@
 		<thead>
 			<tr>
 				<th width="20" class="manage-column">
-					<?php _e('ID', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>
+					<?php esc_html_e('ID', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>
 				</th>
 				<th class="manage-column">
-					<a href="<?php echo $links['status_link'] ?>"><?php _e('Status', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
+					<a href="<?php echo $links['status_link'] ?>"><?php esc_html_e('Status', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
 				</th>
 				<th class="manage-column">
-					<a href="<?php echo $links['amount_link'] ?>"><?php _e('Amount', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
+					<a href="<?php echo $links['amount_link'] ?>"><?php esc_html_e('Amount', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
 				</th>
 				<th class="manage-column">
-					<?php _e('Currency', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>
+					<?php esc_html_e('Currency', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>
 				</th>
 				<th class="manage-column">
-					<?php _e('Package ID', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>
+					<?php esc_html_e('Package ID', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>
 				</th>
 				<th class="manage-column">
-					<?php _e('Description', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>
+					<?php esc_html_e('Description', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>
 				</th>
 				<th class="manage-column">
-					<a href="<?php echo $links['firstname_link'] ?>"><?php _e('Firstname', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
+					<a href="<?php echo $links['firstname_link'] ?>"><?php esc_html_e('Firstname', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
 				</th>
 				<th class="manage-column">
-					<a href="<?php echo $links['lastname_link'] ?>"><?php _e('Lastname', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
+					<a href="<?php echo $links['lastname_link'] ?>"><?php esc_html_e('Lastname', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
 				</th>
 				<th class="manage-column">
-					<a href="<?php echo $links['email_link'] ?>"><?php _e('E-mail', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
+					<a href="<?php echo $links['email_link'] ?>"><?php esc_html_e('E-mail', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
 				</th>
 				<th class="manage-column">
-					<a href="<?php echo $links['date_link'] ?>"><?php _e('Date', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
+					<a href="<?php echo $links['date_link'] ?>"><?php esc_html_e('Date', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
 				</th>
 			</tr>
 		</thead>
@@ -158,34 +154,34 @@
 		<tfoot>
 			<tr>
 				<th width="20" class="manage-column">
-					<?php _e('ID', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>
+					<?php esc_html_e('ID', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>
 				</th>
 				<th class="manage-column">
-					<a href="<?php echo $links['status_link'] ?>"><?php _e('Status', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
+					<a href="<?php echo $links['status_link'] ?>"><?php esc_html_e('Status', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
 				</th>
 				<th class="manage-column">
-					<a href="<?php echo $links['amount_link'] ?>"><?php _e('Amount', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
+					<a href="<?php echo $links['amount_link'] ?>"><?php esc_html_e('Amount', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
 				</th>
 				<th class="manage-column">
-					<?php _e('Currency', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>
+					<?php esc_html_e('Currency', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>
 				</th>
 				<th class="manage-column">
-					<?php _e('Package ID', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>
+					<?php esc_html_e('Package ID', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>
 				</th>
 				<th class="manage-column">
-					<?php _e('Description', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>
+					<?php esc_html_e('Description', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>
 				</th>
 				<th class="manage-column">
-					<a href="<?php echo $links['firstname_link'] ?>"><?php _e('Firstname', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
+					<a href="<?php echo $links['firstname_link'] ?>"><?php esc_html_e('Firstname', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
 				</th>
 				<th class="manage-column">
-					<a href="<?php echo $links['lastname_link'] ?>"><?php _e('Lastname', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
+					<a href="<?php echo $links['lastname_link'] ?>"><?php esc_html_e('Lastname', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
 				</th>
 				<th class="manage-column">
-					<a href="<?php echo $links['email_link'] ?>"><?php _e('E-mail', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
+					<a href="<?php echo $links['email_link'] ?>"><?php esc_html_e('E-mail', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
 				</th>
 				<th class="manage-column">
-					<a href="<?php echo $links['date_link'] ?>"><?php _e('Date', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
+					<a href="<?php echo $links['date_link'] ?>"><?php esc_html_e('Date', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
 				</th>
 			</tr>
 		</tfoot>
@@ -196,45 +192,45 @@
 			$feature_packets = TMM_Cardealer_User::get_features_packets();
 			?>
 			<?php
-            if(isset($rows)){
-            foreach ($rows as $kk => $row) { ?>
-				<?php
-				$is_price_red = false;
-				$is_key_red = false;
-				if ((float) @$roles[$row->packet_id]['packet_price'] !== (float) $row->amount) {
-					if ((float) @$feature_packets[$row->packet_id]['packet_price'] !== (float) $row->amount) {
-						$is_price_red = true;
+			if (isset($rows)) {
+				foreach ($rows as $kk => $row) { ?>
+					<?php
+					$is_price_red = false;
+					$is_key_red = false;
+					if ((float) @$roles[$row->packet_id]['packet_price'] !== (float) $row->amount) {
+						if ((float) @$feature_packets[$row->packet_id]['packet_price'] !== (float) $row->amount) {
+							$is_price_red = true;
+						}
 					}
-				}
-				//***
-				if (@!isset($roles[$row->packet_id])) {
-					if (@!isset($feature_packets[$row->packet_id])) {
-						$is_key_red = true;
+					//***
+					if (@!isset($roles[$row->packet_id])) {
+						if (@!isset($feature_packets[$row->packet_id])) {
+							$is_key_red = true;
+						}
 					}
-				}
-				if(time() != current_time('timestamp')){
-					$row->created += current_time('timestamp') - time();
-				}
-				?>
-				<tr class="alternate">
-					<td width="20"><?php echo $row->id; ?></td>
-					<td class="username column-username">
-						<strong style="<?php echo $row->status == 'success' ? 'color:#339900;' : ''; ?>"><?php echo $row->status; ?></strong><br />
-						<div class="row-actions">
-							<span class="edit"><a href="<?php echo $config->getItem('plugin_history_url') . '&action=edit&id=' . $row->id; ?>"><?php _e('Edit', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a></span> |
-							<span class="edit"><a href="<?php echo $config->getItem('plugin_history_url') . '&action=details&id=' . $row->id; ?>"><?php _e('View details', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a></span>
-						</div>
-					</td>
-					<td class="role column-role" style="color:<?php if ($is_price_red): ?>red<?php else: ?>green<?php endif; ?>"><?php echo(number_format($row->amount, 2)); ?></td>
-					<td class="role column-role"><?php echo $row->currency; ?></td>
-					<td class="role column-role" style="color: <?php if ($is_key_red): ?>red<?php else: ?>green<?php endif; ?>;"><?php echo $row->packet_id; ?></td>
-					<td class="role column-role"><?php echo $row->description; ?></td>
-					<td class="role column-role"><?php echo $row->firstname; ?></td>
-					<td class="role column-role"><?php echo $row->lastname; ?></td>
-					<td class="role column-role"><?php echo $row->email; ?></td>
-					<td class="role column-role"><?php echo date('Y-m-d H:i', $row->created); ?></td>
+					if (time() != current_time('timestamp')) {
+						$row->created += current_time('timestamp') - time();
+					}
+					?>
+					<tr class="alternate">
+						<td width="20"><?php echo $row->id; ?></td>
+						<td class="username column-username">
+							<strong style="<?php echo $row->status == 'success' ? 'color:#339900;' : ''; ?>"><?php echo $row->status; ?></strong><br />
+							<div class="row-actions">
+								<span class="edit"><a href="<?php echo $config->getItem('plugin_history_url') . '&action=edit&id=' . $row->id; ?>"><?php esc_html_e('Edit', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a></span> |
+								<span class="edit"><a href="<?php echo $config->getItem('plugin_history_url') . '&action=details&id=' . $row->id; ?>"><?php esc_html_e('View details', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a></span>
+							</div>
+						</td>
+						<td class="role column-role" style="color:<?php if ($is_price_red): ?>red<?php else: ?>green<?php endif; ?>"><?php echo (number_format($row->amount, 2)); ?></td>
+						<td class="role column-role"><?php echo $row->currency; ?></td>
+						<td class="role column-role" style="color: <?php if ($is_key_red): ?>red<?php else: ?>green<?php endif; ?>;"><?php echo $row->packet_id; ?></td>
+						<td class="role column-role"><?php echo $row->description; ?></td>
+						<td class="role column-role"><?php echo $row->firstname; ?></td>
+						<td class="role column-role"><?php echo $row->lastname; ?></td>
+						<td class="role column-role"><?php echo $row->email; ?></td>
+						<td class="role column-role"><?php echo date('Y-m-d H:i', $row->created); ?></td>
 				<?php }
-                }?>
+			} ?>
 		</tbody>
 	</table>
-</div><!-- .wrap -->
+</div><!-- .wrap -->
\ No newline at end of file
diff --git a/views/adminhistorydetails.php b/views/adminhistorydetails.php
index e323e04..83fc466 100644
--- a/views/adminhistorydetails.php
+++ b/views/adminhistorydetails.php
@@ -1,51 +1,51 @@
-<?php if ( !defined('ABSPATH') ) exit; ?>
+<?php if (!defined('ABSPATH')) exit; ?>
 
 <div class="wrap">
-	<h2><?php _e('PayPal Express Checkout - Payment details', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></h2>
+	<h2><?php esc_html_e('PayPal Express Checkout - Payment details', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></h2>
 
 	<p>
-		<a href="<?php echo $config->getItem('plugin_history_url'); ?>" title="Back to the payments history">&laquo; <?php _e('Back to the payments history', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
+		<a href="<?php echo $config->getItem('plugin_history_url'); ?>" title="Back to the payments history">&laquo; <?php esc_html_e('Back to the payments history', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
 	</p>
 
 	<table class="form-table">
 		<tr>
-			<th><strong><?php _e('Status', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></th>
+			<th><strong><?php esc_html_e('Status', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></th>
 			<td style="<?php echo $details->status == 'success' ? 'color:#339900;' : ''; ?>"><?php echo $details->status; ?></td>
 		</tr>
 		<tr>
-			<th><strong><?php _e('Date', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></th>
+			<th><strong><?php esc_html_e('Date', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></th>
 			<td><?php echo date('Y-m-d H:i', $details->created); ?></td>
 		</tr>
 		<tr>
-			<th><strong><?php _e('Amount', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></th>
+			<th><strong><?php esc_html_e('Amount', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></th>
 			<td><?php echo number_format($details->amount, 2); ?></td>
 		</tr>
 		<tr>
-			<th><strong><?php _e('Currency', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></th>
+			<th><strong><?php esc_html_e('Currency', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></th>
 			<td><?php echo $details->currency; ?></td>
 		</tr>
 		<tr>
-			<th><strong><?php _e('Package ID', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></th>
+			<th><strong><?php esc_html_e('Package ID', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></th>
 			<td><?php echo $details->packet_id; ?></td>
-		</tr> 
+		</tr>
 		<tr>
-			<th><strong><?php _e('Description', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></th>
+			<th><strong><?php esc_html_e('Description', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></th>
 			<td><?php echo $details->description; ?></td>
 		</tr>
 		<tr>
-			<th><strong><?php _e('Firstname', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></th>
+			<th><strong><?php esc_html_e('Firstname', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></th>
 			<td><?php echo $details->firstname; ?></td>
 		</tr>
 		<tr>
-			<th><strong><?php _e('Lastname', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></th>
+			<th><strong><?php esc_html_e('Lastname', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></th>
 			<td><?php echo $details->lastname; ?></td>
 		</tr>
 		<tr>
-			<th><strong><?php _e('E-mail', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></th>
+			<th><strong><?php esc_html_e('E-mail', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></th>
 			<td><?php echo $details->email; ?></td>
 		</tr>
 		<tr>
-			<th><strong><?php _e('API call result', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></th>
+			<th><strong><?php esc_html_e('API call result', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></strong></th>
 			<td>
 				<?php
 				if (is_serialized($details->summary)) {
@@ -62,6 +62,6 @@
 	</table>
 
 	<p>
-		<a href="<?php echo $config->getItem('plugin_history_url'); ?>" title="<?php _e('Back to the payments history', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>">&laquo; <?php _e('Back to the payments history', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
+		<a href="<?php echo $config->getItem('plugin_history_url'); ?>" title="<?php esc_html_e('Back to the payments history', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>">&laquo; <?php esc_html_e('Back to the payments history', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
 	</p>
 </div><!-- .wrap -->
\ No newline at end of file
diff --git a/views/adminhistoryedit.php b/views/adminhistoryedit.php
index db37b6f..fca8867 100644
--- a/views/adminhistoryedit.php
+++ b/views/adminhistoryedit.php
@@ -1,22 +1,22 @@
-<?php if ( !defined('ABSPATH') ) exit; ?>
+<?php if (!defined('ABSPATH')) exit; ?>
 
 <div class="wrap">
-  <h2><?php _e('PayPal Express Checkout - Edit payment status', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></h2>
-  
+  <h2><?php esc_html_e('PayPal Express Checkout - Edit payment status', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></h2>
+
   <p>
-    <a href="<?php echo $config->getItem('plugin_history_url'); ?>" title="Back to the payments history">&laquo; <?php _e('Back to the payments history', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
+    <a href="<?php echo $config->getItem('plugin_history_url'); ?>" title="Back to the payments history">&laquo; <?php esc_html_e('Back to the payments history', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
   </p>
-  
+
   <form method="post" action="<?php echo $config->getItem('plugin_history_url'); ?>">
     <table class="form-table">
       <tbody>
         <tr class="form-field">
-          <th scope="row"><label for="status"><strong><?php _e('Payment status', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>:</strong></label></th>
+          <th scope="row"><label for="status"><strong><?php esc_html_e('Payment status', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>:</strong></label></th>
           <td>
             <select name="status">
-              <option <?php echo $details->status == 'success' ? 'selected="selected"' : ''; ?> value="success"><?php _e('Success', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></option>
-              <option <?php echo $details->status == 'pending' ? 'selected="selected"' : ''; ?> value="pending"><?php _e('Pending', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></option>
-              <option <?php echo $details->status == 'failed' ? 'selected="selected"' : ''; ?> value="failed"><?php _e('Failed', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></option>
+              <option <?php echo $details->status == 'success' ? 'selected="selected"' : ''; ?> value="success"><?php esc_html_e('Success', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></option>
+              <option <?php echo $details->status == 'pending' ? 'selected="selected"' : ''; ?> value="pending"><?php esc_html_e('Pending', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></option>
+              <option <?php echo $details->status == 'failed' ? 'selected="selected"' : ''; ?> value="failed"><?php esc_html_e('Failed', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></option>
             </select>
           </td>
         </tr>
@@ -26,8 +26,8 @@
       <input type="hidden" name="id" value="<?php echo (int)$_GET['id']; ?>" />
       <input type="submit" value="Save" class="button-primary" />
     </p>
-  
-  <p>
-    <a href="<?php echo $config->getItem('plugin_history_url'); ?>" title="Back to the payments history">&laquo; <?php _e('Back to the payments history', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
-  </p>
+
+    <p>
+      <a href="<?php echo $config->getItem('plugin_history_url'); ?>" title="Back to the payments history">&laquo; <?php esc_html_e('Back to the payments history', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?></a>
+    </p>
 </div><!-- .wrap -->
\ No newline at end of file
diff --git a/views/frontendshortcode.php b/views/frontendshortcode.php
index 6ba0af7..083a571 100644
--- a/views/frontendshortcode.php
+++ b/views/frontendshortcode.php
@@ -1,58 +1,73 @@
 <?php
-if ( !defined('ABSPATH') ) exit;
+if (!defined('ABSPATH')) exit;
+
 $config = paypalConfig::getInstance();
+
+// Validate Form Handler URL
+$form_handler_url = esc_url_raw($config->getItem('plugin_form_handler_url'));
 ?>
 
-<form method="post" action="<?php echo $config->getItem('plugin_form_handler_url'); ?>">
-	<?php if (isset($atts['amount'])) { ?>
-	<input type="hidden" name="AMT" value="<?php echo $atts['amount']; ?>" autocomplete="off" />
+<form method="post" action="<?php echo $form_handler_url; ?>">
+	<?php wp_nonce_field('tmm_paypal_nonce', 'tmm_paypal_security'); // Nonce for CSRF protection 
+	?>
+
+	<?php if (!empty($atts['amount'])) { ?>
+		<input type="hidden" name="AMT" value="<?php echo esc_attr($atts['amount']); ?>" autocomplete="off" />
 	<?php } ?>
 
-	<?php if (isset($atts['currency'])) { ?>
-	<input type="hidden" name="CURRENCYCODE" value="<?php echo $atts['currency']; ?>" autocomplete="off" />
+	<?php if (!empty($atts['currency'])) { ?>
+		<input type="hidden" name="CURRENCYCODE" value="<?php echo esc_attr($atts['currency']); ?>" autocomplete="off" />
 	<?php } ?>
 
-	<?php if (isset($atts['packet_id'])) { ?>
-	    <input type="hidden" name="PAYMENTREQUEST_0_CUSTOM" value="<?php echo $atts['packet_id']; ?>" autocomplete="off" />
+	<?php if (!empty($atts['packet_id'])) { ?>
+		<input type="hidden" name="PAYMENTREQUEST_0_CUSTOM" value="<?php echo esc_attr($atts['packet_id']); ?>" autocomplete="off" />
 	<?php } ?>
 
-	<?php if (isset($atts['description'])) { ?>
-	    <input type="hidden" name="PAYMENTREQUEST_0_DESC" value="<?php echo $atts['description']; ?>" autocomplete="off" />
+	<?php if (!empty($atts['description'])) { ?>
+		<input type="hidden" name="PAYMENTREQUEST_0_DESC" value="<?php echo esc_attr($atts['description']); ?>" autocomplete="off" />
 	<?php } ?>
 
-	<?php if (isset($atts['tax'])) { ?>
-	    <input type="hidden" name="TAXAMT" value="<?php echo $atts['tax']; ?>" autocomplete="off" />
+	<?php if (!empty($atts['tax'])) { ?>
+		<input type="hidden" name="TAXAMT" value="<?php echo esc_attr($atts['tax']); ?>" autocomplete="off" />
 	<?php } ?>
 
-	<?php if (isset($atts['shipping'])) { ?>
-	    <input type="hidden" name="SHIPPINGAMT" value="<?php echo $atts['shipping']; ?>" autocomplete="off" />
+	<?php if (!empty($atts['shipping'])) { ?>
+		<input type="hidden" name="SHIPPINGAMT" value="<?php echo esc_attr($atts['shipping']); ?>" autocomplete="off" />
 	<?php } ?>
 
-	<?php if (isset($atts['handling'])) { ?>
-	    <input type="hidden" name="HANDLINGAMT" value="<?php echo $atts['handling']; ?>" autocomplete="off" />
+	<?php if (!empty($atts['handling'])) { ?>
+		<input type="hidden" name="HANDLINGAMT" value="<?php echo esc_attr($atts['handling']); ?>" autocomplete="off" />
 	<?php } ?>
 
-	<?php if (isset($atts['qty'])) { ?>
-	    <input type="hidden" name="PAYMENTREQUEST_0_QTY" value="<?php echo $atts['qty']; ?>" autocomplete="off" />
+	<?php if (!empty($atts['qty'])) { ?>
+		<input type="hidden" name="PAYMENTREQUEST_0_QTY" value="<?php echo esc_attr($atts['qty']); ?>" autocomplete="off" />
 	<?php } ?>
 
-	<?php if (isset($atts['return_url'])) { ?>
-	    <input type="hidden" name="RETURN_URL" value="<?php echo $atts['return_url']; ?>" autocomplete="off" />
+	<?php if (!empty($atts['return_url'])) { ?>
+		<input type="hidden" name="RETURN_URL" value="<?php echo esc_url_raw($atts['return_url']); ?>" autocomplete="off" />
 	<?php } ?>
 
-	<?php if (isset($atts['cancel_url'])) { ?>
-	    <input type="hidden" name="CANCEL_URL" value="<?php echo $atts['cancel_url']; ?>" autocomplete="off" />
+	<?php if (!empty($atts['cancel_url'])) { ?>
+		<input type="hidden" name="CANCEL_URL" value="<?php echo esc_url_raw($atts['cancel_url']); ?>" autocomplete="off" />
 	<?php } ?>
 
 	<input type="hidden" name="func" value="start" />
 
-	<?php if (isset($atts['button_style'])) { ?>
-		<?php if ($atts['button_style'] == 'buy_now') { ?>
-			<input type="image" value="" src="<?php echo $config->getItem('buy_now_button_src'); ?>" alt="button" />
-		<?php } elseif ($atts['button_style'] == 'checkout') { ?>
-			<input type="image" value="" src="<?php echo $config->getItem('checkout_button_src'); ?>" alt="button" />
-		<?php } ?>
+	<?php
+	// Secure Button Selection
+	$button_style = !empty($atts['button_style']) ? $atts['button_style'] : '';
+	if ($button_style === 'buy_now') {
+		$button_src = esc_url($config->getItem('buy_now_button_src'));
+	} elseif ($button_style === 'checkout') {
+		$button_src = esc_url($config->getItem('checkout_button_src'));
+	} else {
+		$button_src = '';
+	}
+	?>
+
+	<?php if (!empty($button_src)) { ?>
+		<input type="image" src="<?php echo $button_src; ?>" alt="PayPal Button" />
 	<?php } else { ?>
-	    <input type="submit" value="<?php _e('Pay with PayPal', TMM_PAYPAL_PLUGIN_TEXTDOMAIN) ?>" />
+		<input type="submit" value="<?php esc_attr_e('Pay with PayPal', TMM_PAYPAL_PLUGIN_TEXTDOMAIN); ?>" />
 	<?php } ?>
 </form>
\ No newline at end of file
