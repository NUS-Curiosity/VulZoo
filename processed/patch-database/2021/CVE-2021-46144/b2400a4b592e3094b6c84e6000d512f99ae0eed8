diff --git a/CHANGELOG b/CHANGELOG
index 410fb519732..a9597b9cb37 100644
--- a/CHANGELOG
+++ b/CHANGELOG
@@ -1,6 +1,8 @@
 CHANGELOG Roundcube Webmail
 ===========================
 
+- Security: Fix cross-site scripting (XSS) via HTML messages with malicious CSS content
+
 RELEASE 1.4.12
 --------------
 - Enigma: Fix bug where signature verification could fail for non-ascii bodies (#7919)
diff --git a/program/lib/Roundcube/rcube_washtml.php b/program/lib/Roundcube/rcube_washtml.php
index 60fdf9c2fd1..7725ded0cf4 100644
--- a/program/lib/Roundcube/rcube_washtml.php
+++ b/program/lib/Roundcube/rcube_washtml.php
@@ -338,7 +338,7 @@ private function wash_attribs($node)
                             if ($url = $this->wash_uri($match[2])) {
                                 $result .= ' ' . $attr->nodeName . '="' . $match[1]
                                     . '(' . htmlspecialchars($url, ENT_QUOTES, $this->config['charset']) . ')'
-                                    . substr($val, strlen($match[0])) . '"';
+                                    . htmlspecialchars(substr($val, strlen($match[0])), ENT_QUOTES, $this->config['charset']) . '"';
                                 continue;
                             }
                         }
diff --git a/tests/Framework/Washtml.php b/tests/Framework/Washtml.php
index 5d62890b3b0..ec4f4a39b7d 100644
--- a/tests/Framework/Washtml.php
+++ b/tests/Framework/Washtml.php
@@ -447,6 +447,10 @@ function data_wash_xss_tests()
                 '<html><body background="javascript:alert(1)">',
                 '<!-- html ignored --><body x-washed="background"></body>'
             ],
+            [
+                '<html><body><img fill=\'asd:url(#asd)" src="x" onerror="alert(1)\' />',
+                '<body><img fill="asd:url(#asd)&quot; src=&quot;x&quot; onerror=&quot;alert(1)" /></body>'
+            ],
             [
                 '<html><math href="javascript:alert(location);"><mi>clickme</mi></math>',
                 '<!-- html ignored --><body><math x-washed="href"><mi>clickme</mi></math></body>',
