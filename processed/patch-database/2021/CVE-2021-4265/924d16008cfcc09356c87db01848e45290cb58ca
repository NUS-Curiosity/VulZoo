diff --git a/app/models/common.rb b/app/models/common.rb
index 0c70c1da..388d7811 100644
--- a/app/models/common.rb
+++ b/app/models/common.rb
@@ -31,6 +31,10 @@ class Common < ActiveRecord::Base
   validates :email,
     format: {with: /\A([a-zA-Z0-9_\-\.]+)@([a-zA-Z0-9_\-\.]+)\.([a-zA-Z]{2,})\z/i,
              message: "Only valid emails"}, allow_blank: true
+  validates :invoicing_address, format: { without: /<(.*)>.*?|<(.*) \/>/,
+    message: "wrong format" }
+  validates :shipping_address, format: { without: /<(.*)>.*?|<(.*) \/>/,
+    message: "wrong format" }
 
   # Events
   after_save :purge_items
diff --git a/app/models/customer.rb b/app/models/customer.rb
index 2d6f8e5e..78640a36 100644
--- a/app/models/customer.rb
+++ b/app/models/customer.rb
@@ -11,6 +11,10 @@ class Customer < ActiveRecord::Base
   # Validation
   validate :valid_customer_identification
   validates_uniqueness_of :name,  scope: :identification
+  validates :invoicing_address, format: { without: /<(.*)>.*?|<(.*) \/>/,
+    message: "Wrong address format" }
+  validates :shipping_address, format: { without: /<(.*)>.*?|<(.*) \/>/,
+    message: "Wrong address format" }
 
   # Behaviors
   acts_as_taggable
diff --git a/config/environments/production.rb b/config/environments/production.rb
index 6bd81a65..ca506e77 100644
--- a/config/environments/production.rb
+++ b/config/environments/production.rb
@@ -47,7 +47,7 @@
   # config.action_cable.allowed_request_origins = [ 'http://example.com', /http:\/\/example.*/ ]
 
   # Force all access to the app over SSL, use Strict-Transport-Security, and use secure cookies.
-  # config.force_ssl = true
+  config.force_ssl = ENV['NO_FORCE_SSL'].present? ? false : true
 
   # Use the lowest log level to ensure availability of diagnostic information
   # when problems arise.
diff --git a/db/migrate/20160907152236_default_for_enabled.rb b/db/migrate/20160907152236_default_for_enabled.rb
index 648734db..d60244db 100644
--- a/db/migrate/20160907152236_default_for_enabled.rb
+++ b/db/migrate/20160907152236_default_for_enabled.rb
@@ -1,4 +1,4 @@
-class DefaultForEnabled < ActiveRecord::Migration
+class DefaultForEnabled < ActiveRecord::Migration[4.2]
   def change
     change_column_default(:commons, :enabled, true)
     change_column_default(:commons, :draft, false)
diff --git a/db/migrate/20160908093323_add_indexes_on_deleted_column.rb b/db/migrate/20160908093323_add_indexes_on_deleted_column.rb
index 2a9c5c29..60667c1d 100644
--- a/db/migrate/20160908093323_add_indexes_on_deleted_column.rb
+++ b/db/migrate/20160908093323_add_indexes_on_deleted_column.rb
@@ -1,4 +1,4 @@
-class AddIndexesOnDeletedColumn < ActiveRecord::Migration
+class AddIndexesOnDeletedColumn < ActiveRecord::Migration[4.2]
   def change
     add_index :commons, :deleted_at
     add_index :customers, :deleted_at
diff --git a/db/migrate/20160913081503_remove_status_from_commons.rb b/db/migrate/20160913081503_remove_status_from_commons.rb
index 5a755b6b..ecf1b42a 100644
--- a/db/migrate/20160913081503_remove_status_from_commons.rb
+++ b/db/migrate/20160913081503_remove_status_from_commons.rb
@@ -1,4 +1,4 @@
-class RemoveStatusFromCommons < ActiveRecord::Migration
+class RemoveStatusFromCommons < ActiveRecord::Migration[4.2]
   def change
     remove_column :commons, :status
   end
diff --git a/db/migrate/20160915000824_add_active_to_customer.rb b/db/migrate/20160915000824_add_active_to_customer.rb
index c5602cb5..4999ec61 100644
--- a/db/migrate/20160915000824_add_active_to_customer.rb
+++ b/db/migrate/20160915000824_add_active_to_customer.rb
@@ -1,4 +1,4 @@
-class AddActiveToCustomer < ActiveRecord::Migration
+class AddActiveToCustomer < ActiveRecord::Migration[4.2]
   def up
     add_column :customers, :active, :boolean, default: true
     Customer.update_all ["active = ?", true]
diff --git a/db/migrate/20160915094942_add_failed_to_commons.rb b/db/migrate/20160915094942_add_failed_to_commons.rb
index 458edc16..c6d1b36b 100644
--- a/db/migrate/20160915094942_add_failed_to_commons.rb
+++ b/db/migrate/20160915094942_add_failed_to_commons.rb
@@ -1,4 +1,4 @@
-class AddFailedToCommons < ActiveRecord::Migration
+class AddFailedToCommons < ActiveRecord::Migration[4.2]
   def change
     add_column :commons, :failed, :boolean, default: false
   end
diff --git a/db/migrate/20160923100618_series_first_number.rb b/db/migrate/20160923100618_series_first_number.rb
index 27c64933..5432762c 100644
--- a/db/migrate/20160923100618_series_first_number.rb
+++ b/db/migrate/20160923100618_series_first_number.rb
@@ -1,4 +1,4 @@
-class SeriesFirstNumber < ActiveRecord::Migration
+class SeriesFirstNumber < ActiveRecord::Migration[4.2]
   def change
   	add_column :series, :first_number, :integer, default: 1
   	remove_column :series, :next_number
diff --git a/db/migrate/20160929124104_email_and_print_template_to_common.rb b/db/migrate/20160929124104_email_and_print_template_to_common.rb
index 91b7d307..f399d69d 100644
--- a/db/migrate/20160929124104_email_and_print_template_to_common.rb
+++ b/db/migrate/20160929124104_email_and_print_template_to_common.rb
@@ -1,4 +1,4 @@
-class EmailAndPrintTemplateToCommon < ActiveRecord::Migration
+class EmailAndPrintTemplateToCommon < ActiveRecord::Migration[4.2]
   def change
   	rename_column :commons, :template_id, :print_template_id
   	add_column :commons, :email_template_id, :integer
diff --git a/db/migrate/20160929133954_email_and_print_default_templates_to_template.rb b/db/migrate/20160929133954_email_and_print_default_templates_to_template.rb
index c84dcc19..b2b75128 100644
--- a/db/migrate/20160929133954_email_and_print_default_templates_to_template.rb
+++ b/db/migrate/20160929133954_email_and_print_default_templates_to_template.rb
@@ -1,4 +1,4 @@
-class EmailAndPrintDefaultTemplatesToTemplate < ActiveRecord::Migration
+class EmailAndPrintDefaultTemplatesToTemplate < ActiveRecord::Migration[4.2]
   def change
   	rename_column :templates, :default, :print_default
   	add_column :templates, :email_default, :boolean, default: false
diff --git a/db/migrate/20161025134552_change_customer_index.rb b/db/migrate/20161025134552_change_customer_index.rb
index 8427ef87..8059c0e2 100644
--- a/db/migrate/20161025134552_change_customer_index.rb
+++ b/db/migrate/20161025134552_change_customer_index.rb
@@ -1,4 +1,4 @@
-class ChangeCustomerIndex < ActiveRecord::Migration
+class ChangeCustomerIndex < ActiveRecord::Migration[4.2]
   def change
   	remove_index "customers", name: "cstm_idx"
   	add_index "customers", ["name", "identification"], name: "cstm_idx", unique: true, using: :btree
diff --git a/db/migrate/20161026092553_add_template_subject.rb b/db/migrate/20161026092553_add_template_subject.rb
index 08b35aa7..3f970202 100644
--- a/db/migrate/20161026092553_add_template_subject.rb
+++ b/db/migrate/20161026092553_add_template_subject.rb
@@ -1,4 +1,4 @@
-class AddTemplateSubject < ActiveRecord::Migration
+class AddTemplateSubject < ActiveRecord::Migration[4.2]
   def change
   	add_column :templates, :subject, :string, limit: 200
   end
diff --git a/db/migrate/20161028103504_add_invoice_number_unique_number.rb b/db/migrate/20161028103504_add_invoice_number_unique_number.rb
index 27f3b05d..12f09d5b 100644
--- a/db/migrate/20161028103504_add_invoice_number_unique_number.rb
+++ b/db/migrate/20161028103504_add_invoice_number_unique_number.rb
@@ -1,4 +1,4 @@
-class AddInvoiceNumberUniqueNumber < ActiveRecord::Migration
+class AddInvoiceNumberUniqueNumber < ActiveRecord::Migration[4.2]
   def change
   	add_index "commons", ["number", "series_id"], name: "common_unique_number_idx", unique: true, using: :btree
   end
diff --git a/db/migrate/20161207184222_remove_tax_amount.rb b/db/migrate/20161207184222_remove_tax_amount.rb
index 27bc371e..130d3132 100644
--- a/db/migrate/20161207184222_remove_tax_amount.rb
+++ b/db/migrate/20161207184222_remove_tax_amount.rb
@@ -1,4 +1,4 @@
-class RemoveTaxAmount < ActiveRecord::Migration
+class RemoveTaxAmount < ActiveRecord::Migration[4.2]
   def change
     remove_column :commons, :tax_amount
   end
diff --git a/db/migrate/20161208171651_remove_commons_amounts.rb b/db/migrate/20161208171651_remove_commons_amounts.rb
index 22f9500c..dba0a63e 100644
--- a/db/migrate/20161208171651_remove_commons_amounts.rb
+++ b/db/migrate/20161208171651_remove_commons_amounts.rb
@@ -1,4 +1,4 @@
-class RemoveCommonsAmounts < ActiveRecord::Migration
+class RemoveCommonsAmounts < ActiveRecord::Migration[4.2]
   def change
     remove_column :commons, :discount_amount
     remove_column :commons, :base_amount
diff --git a/db/migrate/20170112115658_remove_invoice_unique_number.rb b/db/migrate/20170112115658_remove_invoice_unique_number.rb
index 3ffa0625..24c698d9 100644
--- a/db/migrate/20170112115658_remove_invoice_unique_number.rb
+++ b/db/migrate/20170112115658_remove_invoice_unique_number.rb
@@ -1,4 +1,4 @@
-class RemoveInvoiceUniqueNumber < ActiveRecord::Migration
+class RemoveInvoiceUniqueNumber < ActiveRecord::Migration[4.2]
   def change
     remove_index "commons", name: "common_unique_number_idx"
   end
diff --git a/db/migrate/20170209101048_remove_customers_unique_name.rb b/db/migrate/20170209101048_remove_customers_unique_name.rb
index 6f9adafb..b7c1512e 100644
--- a/db/migrate/20170209101048_remove_customers_unique_name.rb
+++ b/db/migrate/20170209101048_remove_customers_unique_name.rb
@@ -1,4 +1,4 @@
-class RemoveCustomersUniqueName < ActiveRecord::Migration
+class RemoveCustomersUniqueName < ActiveRecord::Migration[4.2]
   def change
     remove_index "customers", name: "cstm_idx"
   end
diff --git a/db/migrate/20170216122053_add_unique_index_to_invoice_series_and_number.rb b/db/migrate/20170216122053_add_unique_index_to_invoice_series_and_number.rb
index 9e64d24c..2d486866 100644
--- a/db/migrate/20170216122053_add_unique_index_to_invoice_series_and_number.rb
+++ b/db/migrate/20170216122053_add_unique_index_to_invoice_series_and_number.rb
@@ -1,4 +1,4 @@
-class AddUniqueIndexToInvoiceSeriesAndNumber < ActiveRecord::Migration
+class AddUniqueIndexToInvoiceSeriesAndNumber < ActiveRecord::Migration[4.2]
   def change
     add_index "commons", ["series_id", "number"], name: "common_unique_number_idx", unique: true, using: :btree
   end
diff --git a/db/migrate/20170217120023_add_deleted_number_to_commons.rb b/db/migrate/20170217120023_add_deleted_number_to_commons.rb
index 8c860aa6..d4ce1baf 100644
--- a/db/migrate/20170217120023_add_deleted_number_to_commons.rb
+++ b/db/migrate/20170217120023_add_deleted_number_to_commons.rb
@@ -1,4 +1,4 @@
-class AddDeletedNumberToCommons < ActiveRecord::Migration
+class AddDeletedNumberToCommons < ActiveRecord::Migration[4.2]
   def change
     add_column :commons, :deleted_number, :integer, default: nil
     add_index "commons", ["series_id", "deleted_number"], name: "common_deleted_number_idx", using: :btree
diff --git a/db/migrate/20170223101022_add_commons_customer_id_not_null.rb b/db/migrate/20170223101022_add_commons_customer_id_not_null.rb
index 62e7b53f..b7baeb93 100644
--- a/db/migrate/20170223101022_add_commons_customer_id_not_null.rb
+++ b/db/migrate/20170223101022_add_commons_customer_id_not_null.rb
@@ -1,4 +1,4 @@
-class AddCommonsCustomerIdNotNull < ActiveRecord::Migration
+class AddCommonsCustomerIdNotNull < ActiveRecord::Migration[4.2]
   def change
       change_column :commons, :customer_id, :integer, :null => false
   end
diff --git a/db/migrate/20170608155530_add_currency_to_commons.rb b/db/migrate/20170608155530_add_currency_to_commons.rb
index cfdef374..62c1b5cc 100644
--- a/db/migrate/20170608155530_add_currency_to_commons.rb
+++ b/db/migrate/20170608155530_add_currency_to_commons.rb
@@ -1,4 +1,4 @@
-class AddCurrencyToCommons < ActiveRecord::Migration
+class AddCurrencyToCommons < ActiveRecord::Migration[4.2]
   def up
     add_column :commons, :currency, :string, limit: 3
     currency = Settings.currency
