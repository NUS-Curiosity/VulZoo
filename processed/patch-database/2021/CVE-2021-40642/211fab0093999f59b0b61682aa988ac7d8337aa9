diff --git a/textpattern/lib/txplib_misc.php b/textpattern/lib/txplib_misc.php
index e323307e93..9677bf1c57 100644
--- a/textpattern/lib/txplib_misc.php
+++ b/textpattern/lib/txplib_misc.php
@@ -1033,7 +1033,7 @@ function set_cookie($name, $value = '', $options = array())
         'expires' => time() - 3600,
         'path' => '',
         'domain' => '',
-        'secure' => false,
+        'secure' => strtolower(PROTOCOL) == 'https://',
         'httponly' => false,
         'samesite' => 'Lax' // None || Lax  || Strict
     );
