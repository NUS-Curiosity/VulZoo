diff --git a/Changes b/Changes
index 2c7bc7a..39e0bc1 100644
--- a/Changes
+++ b/Changes
@@ -1,8 +1,12 @@
 # Revision history for Perl extension Encode.
 #
-# $Id: Changes,v 3.11 2021/07/23 02:26:54 dankogai Exp dankogai $
+# $Id: Changes,v 3.12 2021/08/09 14:17:04 dankogai Exp dankogai $
 #
-$Revision: 3.11 $ $Date: 2021/07/23 02:26:54 $
+$Revision: 3.12 $ $Date: 2021/08/09 14:17:04 $
+! Encode.pm
+  Address CVE-2021-36770
+  <9639159a-d070-4762-9cbd-f1622f10449c@beta.fastmail.com>
+3.11 2021/07/23 02:26:54
 ! Unicode/Unicode.xs
 + t/Unicode_trailing_nul.t
   Pulled: Ensure that UTF-16 decode always includes a trailing NUL.
diff --git a/Encode.pm b/Encode.pm
index 1502a16..841ec23 100644
--- a/Encode.pm
+++ b/Encode.pm
@@ -1,5 +1,5 @@
 #
-# $Id: Encode.pm,v 3.11 2021/07/23 02:26:02 dankogai Exp $
+# $Id: Encode.pm,v 3.12 2021/08/09 14:17:04 dankogai Exp dankogai $
 #
 package Encode;
 use strict;
@@ -7,7 +7,7 @@ use warnings;
 use constant DEBUG => !!$ENV{PERL_ENCODE_DEBUG};
 our $VERSION;
 BEGIN {
-    $VERSION = sprintf "%d.%02d", q$Revision: 3.11 $ =~ /(\d+)/g;
+    $VERSION = sprintf "%d.%02d", q$Revision: 3.12 $ =~ /(\d+)/g;
     require XSLoader;
     XSLoader::load( __PACKAGE__, $VERSION );
 }
@@ -65,8 +65,8 @@ require Encode::Config;
 eval {
     local $SIG{__DIE__};
     local $SIG{__WARN__};
-    local @INC = @INC || ();
-    pop @INC if $INC[-1] eq '.';
+    local @INC = @INC;
+    pop @INC if @INC && $INC[-1] eq '.';
     require Encode::ConfigLocal;
 };
 
diff --git a/Unicode/Unicode.xs b/Unicode/Unicode.xs
index 0db4f4e..cc4817e 100644
--- a/Unicode/Unicode.xs
+++ b/Unicode/Unicode.xs
@@ -1,5 +1,5 @@
 /*
- $Id: Unicode.xs,v 2.20 2021/07/23 02:26:54 dankogai Exp dankogai $
+ $Id: Unicode.xs,v 2.20 2021/07/23 02:26:54 dankogai Exp $
  */
 
 #define IN_UNICODE_XS
diff --git a/t/Unicode.t b/t/Unicode.t
index cac6c7d..61cef42 100644
--- a/t/Unicode.t
+++ b/t/Unicode.t
@@ -1,5 +1,5 @@
 #
-# $Id: Unicode.t,v 2.4 2021/07/23 02:26:54 dankogai Exp dankogai $
+# $Id: Unicode.t,v 2.4 2021/07/23 02:26:54 dankogai Exp $
 #
 # This script is written entirely in ASCII, even though quoted literals
 # do include non-BMP unicode characters -- Are you happy, jhi?
