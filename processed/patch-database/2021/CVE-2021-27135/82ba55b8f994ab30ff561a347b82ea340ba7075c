diff --git a/MANIFEST b/MANIFEST
index 47e1318d..3ed1c73c 100644
--- a/MANIFEST
+++ b/MANIFEST
@@ -1,4 +1,4 @@
-MANIFEST for xterm, version xterm-365c
+MANIFEST for xterm, version xterm-365d
 --------------------------------------------------------------------------------
 MANIFEST                        this file
 256colres.h                     resource-definitions for 256-color mode
diff --git a/button.c b/button.c
index fba85567..37c513b9 100644
--- a/button.c
+++ b/button.c
@@ -1,4 +1,4 @@
-/* $XTermId: button.c,v 1.631 2021/02/04 01:00:26 tom Exp $ */
+/* $XTermId: button.c,v 1.634 2021/02/09 23:04:41 tom Exp $ */
 
 /*
  * Copyright 1999-2020,2021 by Thomas E. Dickey
@@ -4323,6 +4323,7 @@ SaltTextAway(XtermWidget xw,
     int i;
     int eol;
     int need = 0;
+    size_t have = 0;
     Char *line;
     Char *lp;
     CELL first = *cellc;
@@ -4357,7 +4358,11 @@ SaltTextAway(XtermWidget xw,
 
     /* UTF-8 may require more space */
     if_OPT_WIDE_CHARS(screen, {
-	need *= 4;
+	if (need > 0) {
+	    if (screen->max_combining > 0)
+		need += screen->max_combining;
+	    need *= 6;
+	}
     });
 
     /* now get some memory to save it in */
@@ -4395,10 +4400,20 @@ SaltTextAway(XtermWidget xw,
     }
     *lp = '\0';			/* make sure we have end marked */
 
-    TRACE(("Salted TEXT:%u:%s\n", (unsigned) (lp - line),
-	   visibleChars(line, (unsigned) (lp - line))));
+    have = (size_t) (lp - line);
+    /*
+     * Scanning the buffer twice is unnecessary.  Discard unwanted memory if
+     * the estimate is too-far off.
+     */
+    if ((have * 2) < (size_t) need) {
+	scp->data_limit = have + 1;
+	line = realloc(line, scp->data_limit);
+    }
+
+    TRACE(("Salted TEXT:%u:%s\n", (unsigned) have,
+	   visibleChars(line, (unsigned) have)));
 
-    scp->data_length = (size_t) (lp - line);
+    scp->data_length = have;
 }
 
 #if OPT_PASTE64
diff --git a/xterm.log.html b/xterm.log.html
index 5e637b20..fd186a24 100644
--- a/xterm.log.html
+++ b/xterm.log.html
@@ -30,7 +30,7 @@
  * sale, use or other dealings in this Software without prior written        *
  * authorization.                                                            *
  *****************************************************************************
-  $XTermId: xterm.log.html,v 1.2309 2021/02/09 01:30:44 tom Exp $
+  $XTermId: xterm.log.html,v 1.2311 2021/02/09 21:59:33 tom Exp $
   -->
 <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
 <html>
@@ -1013,6 +1013,9 @@ <h1>Contents</h1>
   <h1><a name="xterm_dev" id="xterm_dev">Development</a></h1>
 
   <ul>
+    <li>correct upper-limit for selection buffer, accounting for
+    combining characters (report by Tavis Ormandy).</li>
+
     <li>with <code>alwaysHighlight</code> true, xterm does not
     properly track focus. The <em>screen-&gt;select</em>
     <code>FOCUS</code> flag remains always on, which prevents
