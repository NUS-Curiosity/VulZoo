diff --git a/editor/elfinder/php/connector.php b/editor/elfinder/php/connector.php
index 10f1cbb4ce..986a67eb9f 100644
--- a/editor/elfinder/php/connector.php
+++ b/editor/elfinder/php/connector.php
@@ -39,7 +39,7 @@
 $rootpath = $_REQUEST['uploadDir'];
 $rooturl = $_REQUEST['uploadURL'];
 
-if (strpos($rootpath, 'USER-FILES') === false || strpos($rooturl, 'USER-FILES') === false)
+if (strpos($rootpath, 'USER-FILES') === false  || strpos($rootpath, '../') !== false || strpos($rooturl, 'USER-FILES') === false)
 {
     die("Invalid upload location");
 }
diff --git a/editor/uploadImage.php b/editor/uploadImage.php
index 2893e12e5a..27db524934 100644
--- a/editor/uploadImage.php
+++ b/editor/uploadImage.php
@@ -72,7 +72,7 @@ function sanitizeName($file, &$response)
 }
 
 // Check upload path, should contain USER-FILES
-if (strpos($_REQUEST['uploadURL'], 'USER-FILES') === false)
+if (strpos($_REQUEST['uploadPath'], 'USER-FILES') === false || strpos($_REQUEST['uploadPath'], '../') !== false || strpos($_REQUEST['uploadURL'], 'USER-FILES') === false)
 {
     // Invalid folder, reject!
     $response->uploaded = 0;
diff --git a/modules/decision/engine/upload.php b/modules/decision/engine/upload.php
index e8922bf5c6..96840ea2ea 100644
--- a/modules/decision/engine/upload.php
+++ b/modules/decision/engine/upload.php
@@ -96,7 +96,7 @@
     $pass = false;
 if (strpos($_FILES['Filedata']['name'], '...') !== false)
     $pass = false;
-if (strpos($_GET['path'], 'USER-FILES') === false)
+if (strpos($_GET['path'], 'USER-FILES') === false || strpos($_GET['path'], '../') !== false)
     $pass = false;
 
 if ($pass === false) {
diff --git a/modules/site/engine/upload.php b/modules/site/engine/upload.php
index 6f266e9857..239211c421 100644
--- a/modules/site/engine/upload.php
+++ b/modules/site/engine/upload.php
@@ -79,7 +79,7 @@
     $pass = false;
 if (strpos($_FILES['Filedata']['name'], '...') !== false)
     $pass = false;
-if (strpos($_GET['path'], 'USER-FILES') === false)
+if (strpos($_GET['path'], 'USER-FILES') === false || strpos($_GET['path'], '../') !== false)
     $pass = false;
 
 if ($pass === false) {
diff --git a/website_code/php/import/fileupload.php b/website_code/php/import/fileupload.php
index 8d52d16504..c812050c4f 100644
--- a/website_code/php/import/fileupload.php
+++ b/website_code/php/import/fileupload.php
@@ -55,7 +55,7 @@ function convertToBytes(string $from): ?int {
     _debug("Session is invalid or expired");
     die("Session is invalid or expired");
 }
-if (strpos($_POST['mediapath'], 'USER-FILES') === false)
+if (strpos($_POST['mediapath'], 'USER-FILES') === false || strpos($_POST['mediapath'], '../') !== false)
 {
     // Invalid upload path
     _debug("Invalid or illegal mediapath");
