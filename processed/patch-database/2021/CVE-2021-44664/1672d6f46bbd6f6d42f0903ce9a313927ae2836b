diff --git a/editor/uploadImage.php b/editor/uploadImage.php
index 4488f29157..2893e12e5a 100644
--- a/editor/uploadImage.php
+++ b/editor/uploadImage.php
@@ -71,6 +71,17 @@ function sanitizeName($file, &$response)
     exit(-1);
 }
 
+// Check upload path, should contain USER-FILES
+if (strpos($_REQUEST['uploadURL'], 'USER-FILES') === false)
+{
+    // Invalid folder, reject!
+    $response->uploaded = 0;
+    $response->error = IMAGEUPOLOAD_NOT_UPLOADED;
+
+    echo json_encode($response);
+    exit(-1);
+}
+
 if (isset($_FILES['upload']['error']) && $_FILES['upload']['error'] != 0)
 {
     switch($_FILES['upload']['error']) {
diff --git a/modules/decision/engine/upload.php b/modules/decision/engine/upload.php
index cec4180c67..e8922bf5c6 100644
--- a/modules/decision/engine/upload.php
+++ b/modules/decision/engine/upload.php
@@ -96,6 +96,8 @@
     $pass = false;
 if (strpos($_FILES['Filedata']['name'], '...') !== false)
     $pass = false;
+if (strpos($_GET['path'], 'USER-FILES') === false)
+    $pass = false;
 
 if ($pass === false) {
     receive_message($_SESSION['toolkits_logon_username'], "UPLOAD", "CRITICAL", "Invalid filename: " . $_FILES['Filedata']['name'], "Invalid filename: " . $_FILES['Filedata']['name']);
diff --git a/modules/site/engine/upload.php b/modules/site/engine/upload.php
index 4ba77c0eeb..6f266e9857 100644
--- a/modules/site/engine/upload.php
+++ b/modules/site/engine/upload.php
@@ -79,6 +79,8 @@
     $pass = false;
 if (strpos($_FILES['Filedata']['name'], '...') !== false)
     $pass = false;
+if (strpos($_GET['path'], 'USER-FILES') === false)
+    $pass = false;
 
 if ($pass === false) {
     receive_message($_SESSION['toolkits_logon_username'], "UPLOAD", "CRITICAL", "Invalid filename: " . $_FILES['Filedata']['name'], "Invalid filename: " . $_FILES['Filedata']['name']);
diff --git a/website_code/php/import/fileupload.php b/website_code/php/import/fileupload.php
index 43997854da..8d52d16504 100644
--- a/website_code/php/import/fileupload.php
+++ b/website_code/php/import/fileupload.php
@@ -55,6 +55,12 @@ function convertToBytes(string $from): ?int {
     _debug("Session is invalid or expired");
     die("Session is invalid or expired");
 }
+if (strpos($_POST['mediapath'], 'USER-FILES') === false)
+{
+    // Invalid upload path
+    _debug("Invalid or illegal mediapath");
+    die("Invalid or illegal mediapath");
+}
 
 _load_language_file("/website_code/php/import/fileupload.inc");
 
