diff --git a/plugins/tracker/include/Tracker/Artifact/Tracker_Artifact_ChangesetValue_File.class.php b/plugins/tracker/include/Tracker/Artifact/Tracker_Artifact_ChangesetValue_File.class.php
index 5eeae799625..37b24d7b884 100644
--- a/plugins/tracker/include/Tracker/Artifact/Tracker_Artifact_ChangesetValue_File.class.php
+++ b/plugins/tracker/include/Tracker/Artifact/Tracker_Artifact_ChangesetValue_File.class.php
@@ -242,7 +242,8 @@ private function formatDiff($changeset_value, $format, $is_for_mail)
                 $removed[] = $fi->getFilename();
             }
             if ($removed = implode(', ', $removed)) {
-                $result .= $removed . ' ' . dgettext('tuleap-tracker', 'removed');
+                $purifier = Codendi_HTMLPurifier::instance();
+                $result  .= $purifier->purify($removed) . ' ' . dgettext('tuleap-tracker', 'removed');
             }
 
             $added = $this->fetchAddedFiles(array_diff($this->files, $changeset_value->getFiles()), $format, $is_for_mail);
diff --git a/plugins/tracker/include/Tracker/FormElement/Tracker_FormElement_Field_File.php b/plugins/tracker/include/Tracker/FormElement/Tracker_FormElement_Field_File.php
index 7fd0f35a245..2f86cea009e 100644
--- a/plugins/tracker/include/Tracker/FormElement/Tracker_FormElement_Field_File.php
+++ b/plugins/tracker/include/Tracker/FormElement/Tracker_FormElement_Field_File.php
@@ -310,7 +310,7 @@ public function fetchAllAttachment(
             $uh    = UserHelper::instance();
             $added = [];
             foreach ($values as $fileinfo) {
-                $query_link            = $this->getFileHTMLUrl($fileinfo);
+                $query_link            = $hp->purify($this->getFileHTMLUrl($fileinfo));
                 $sanitized_description = $hp->purify($fileinfo->getDescription(), CODENDI_PURIFIER_CONVERT_HTML);
 
                 $link_show = '<a href="' . $query_link . '"' .
@@ -326,7 +326,7 @@ public function fetchAllAttachment(
                 if ($submitter_needed) {
                     $add .= '<div class="tracker_artifact_attachment_submitter">' . 'By ' . $uh->getLinkOnUserFromUserId($fileinfo->getSubmittedBy()) . '</div>';
                 }
-                $add .= '<div class="tracker_artifact_attachment_size">(' . $fileinfo->getHumanReadableFilesize() . ')</div>';
+                $add .= '<div class="tracker_artifact_attachment_size">(' . $hp->purify($fileinfo->getHumanReadableFilesize()) . ')</div>';
                 $add .= '<div>';
                 $add .= $link_show . '<i class="fa fa-eye"></i></a>';
                 $add .= '<a href="' . $query_link . '" download><i class="fa fa-download"></i></a>';
@@ -334,7 +334,7 @@ public function fetchAllAttachment(
                 $add .= '</div>';
 
                 if ($fileinfo->isImage()) {
-                    $query_add = $this->getFileHTMLPreviewUrl($fileinfo);
+                    $query_add = $hp->purify($this->getFileHTMLPreviewUrl($fileinfo));
 
                     $add .= '<div class="tracker_artifact_preview_attachment image">';
                     $add .= '<div style="background-image: url(\'' . $query_add . '\')"></div>';
@@ -508,13 +508,13 @@ protected function fetchMailAllAttachment($artifact_id, $values, $format)
             $hp    = Codendi_HTMLPurifier::instance();
             $added = [];
             foreach ($values as $fileinfo) {
-                $query_link            = $this->getFileHTMLUrl($fileinfo);
+                $query_link            = $hp->purify($this->getFileHTMLUrl($fileinfo));
                 $sanitized_description = $hp->purify($fileinfo->getDescription(), CODENDI_PURIFIER_CONVERT_HTML);
                 $link_show             = '<a href="' . $url . $query_link . '"
                                  title="' . $sanitized_description . '">';
 
                 $info  = $link_show . $hp->purify($fileinfo->getFilename(), CODENDI_PURIFIER_CONVERT_HTML) . '</a>';
-                $info .= ' (' . $fileinfo->getHumanReadableFilesize() . ')';
+                $info .= ' (' . $hp->purify($fileinfo->getHumanReadableFilesize()) . ')';
 
                 $add     = '<div class="tracker_artifact_attachment">';
                 $add    .= '<table><tr><td>';
@@ -660,7 +660,7 @@ protected function fetchTooltipValue(Artifact $artifact, ?Tracker_Artifact_Chang
 
                     if ($file_info->isImage()) {
                         $query = $this->getFileHTMLPreviewUrl($file_info);
-                        $add  .= '<img src="' . $query . '"
+                        $add  .= '<img src="' . $hp->purify($query) . '"
                                       alt="' .  $hp->purify($file_info->getDescription(), CODENDI_PURIFIER_CONVERT_HTML)  . '"
                                  >';
                     } elseif ($file_info->getDescription()) {
