diff --git a/Changes b/Changes
index 19aa83150..cf6d6645f 100644
--- a/Changes
+++ b/Changes
@@ -1,5 +1,8 @@
 Revision history for perl distribution Convos
 
+6.32 Not Released
+ - Fix vulnerability: Cannot upload svg with javascript #623
+
 6.31 2021-10-02T06:51:00+0900
  - Fix turning channel names with "-" into links
  - Have to build a different tag for arm64 (for now) #464
diff --git a/lib/Convos/Controller/Files.pm b/lib/Convos/Controller/Files.pm
index 2da2a345d..cfc042a3d 100644
--- a/lib/Convos/Controller/Files.pm
+++ b/lib/Convos/Controller/Files.pm
@@ -30,6 +30,9 @@ sub upload {
   return $self->reply->errors([[$err, '/file']], 400)
     if $err = !$upload ? 'No upload.' : !$upload->filename ? 'Unknown filename.' : '';
 
+  return $self->reply->errors([['SVG contains script.', '/file']], 400)
+    if $upload->asset->contains('<script') != -1;
+
   my %args = (filename => $upload->filename);
   $args{id}         = $self->param('id')         if defined $self->param('id');
   $args{write_only} = $self->param('write_only') if defined $self->param('write_only');
diff --git a/t/data/js.svg b/t/data/js.svg
new file mode 100644
index 000000000..cf4f33cac
--- /dev/null
+++ b/t/data/js.svg
@@ -0,0 +1,9 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+
+<svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg">
+   <rect width="300" height="100" style="fill:rgb(0,0,255);stroke-width:3;stroke:rgb(0,0,0)" />
+   <script type="text/javascript">
+      alert(document.cookie);
+   </script>
+</svg>
\ No newline at end of file
diff --git a/t/web-files.t b/t/web-files.t
index a6f43830b..5d4004578 100644
--- a/t/web-files.t
+++ b/t/web-files.t
@@ -111,6 +111,11 @@ subtest 'binary' => sub {
     ->header_is('Content-Type' => 'application/octet-stream');
 };
 
+subtest 'svg with javasript' => sub {
+  $t->post_ok('/api/file', form => {file => {file => 't/data/js.svg'}})->status_is(400)
+    ->json_is('/errors/0/message', 'SVG contains script.');
+};
+
 subtest 'write_only' => sub {
   $t->post_ok('/api/file',
     form => {id => 'irc-localhost-key', file => {file => $asset}, write_only => true})
