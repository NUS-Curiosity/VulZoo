diff --git a/CHANGELOG b/CHANGELOG
index 7c02e83c663..26b4a1420a7 100644
--- a/CHANGELOG
+++ b/CHANGELOG
@@ -11,6 +11,7 @@ CHANGELOG Roundcube Webmail
 - Fix handling of custom sender addresses with names (#8106)
 - Fix shift + drag'n'drop menu not working in Elastic skin with Chrome browser (#8107)
 - Fix Firefox infinate loading display on mail screen (#8128)
+- Fix XSS issue in handling attachment filename extension in mimetype mismatch warning (#8193)
 
 RELEASE 1.4.11
 --------------
diff --git a/program/steps/mail/get.inc b/program/steps/mail/get.inc
index bca41322857..8e3647f363b 100644
--- a/program/steps/mail/get.inc
+++ b/program/steps/mail/get.inc
@@ -187,8 +187,8 @@ if (empty($_GET['_thumb']) && $attachment->is_valid()) {
                         $RCMAIL->gettext(array(
                                 'name' => 'attachmentvalidationerror',
                                 'vars' => array(
-                                    'expected' => $mimetype . ($file_extension ? " (.$file_extension)" : ''),
-                                    'detected' => $real_mimetype . ($extensions[0] ? " (.$extensions[0])" : ''),
+                                    'expected' => $mimetype . (!empty($file_extension) ? rcube::Q(" (.{$file_extension})") : ''),
+                                    'detected' => $real_mimetype . (!empty($extensions[0]) ? " (.{$extensions[0]})" : ''),
                                 )
                             )
                         ),
