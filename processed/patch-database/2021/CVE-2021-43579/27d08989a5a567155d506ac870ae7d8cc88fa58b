diff --git a/CHANGES.md b/CHANGES.md
index 7a5caf2a..e77833e8 100644
--- a/CHANGES.md
+++ b/CHANGES.md
@@ -6,6 +6,7 @@
 - Fixed a crash bug when a HTML comment contains an invalid nul character
   (Issue #439)
 - Fixed a crash bug with bogus BMP images (Issue #444)
+- Fixed a stack overflow bug with bogus BMP images (Issue #453)
 
 
 # Changes in HTMLDOC v1.9.12
diff --git a/htmldoc/image.cxx b/htmldoc/image.cxx
index d44d1ba3..a62a06f6 100644
--- a/htmldoc/image.cxx
+++ b/htmldoc/image.cxx
@@ -919,12 +919,16 @@ image_load_bmp(image_t *img,	/* I - Image to load into */
     return (-1);
 
   if (info_size > 40)
+  {
     for (info_size -= 40; info_size > 0; info_size --)
       getc(fp);
+  }
 
   // Get colormap...
   if (colors_used == 0 && depth <= 8)
     colors_used = 1 << depth;
+  else if (colors_used > 256)
+    return (-1);
 
   fread(colormap, (size_t)colors_used, 4, fp);
 
