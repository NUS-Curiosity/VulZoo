diff --git a/main/inc/ajax/model.ajax.php b/main/inc/ajax/model.ajax.php
index 961b8f252b5..ee3bf6f569c 100755
--- a/main/inc/ajax/model.ajax.php
+++ b/main/inc/ajax/model.ajax.php
@@ -109,6 +109,8 @@ function getWhereClause($col, $oper, $val)
         'nc' => 'NOT LIKE',  //doesn't contain
     ];
 
+    $col = Database::escapeField($col);
+
     if (empty($col)) {
         return '';
     }
diff --git a/main/inc/lib/database.lib.php b/main/inc/lib/database.lib.php
index ea9752776cf..c45d2663940 100755
--- a/main/inc/lib/database.lib.php
+++ b/main/inc/lib/database.lib.php
@@ -833,4 +833,9 @@ public static function listTableColumns($table)
     {
         return self::getManager()->getConnection()->getSchemaManager()->listTableColumns($table);
     }
+
+    public static function escapeField($field)
+    {
+        return self::escape_string(preg_replace("/[^a-zA-Z0-9_]/", '', $field));
+    }
 }
diff --git a/main/inc/lib/extra_field.lib.php b/main/inc/lib/extra_field.lib.php
index 2861d99274a..f6cb70c26df 100755
--- a/main/inc/lib/extra_field.lib.php
+++ b/main/inc/lib/extra_field.lib.php
@@ -2620,6 +2620,7 @@ public function getExtraFieldRules($filters, $stringToSearch = 'extra_', $condit
                     }
                 } else {
                     // Extra fields
+                    $ruleField = Database::escapeField($rule->field);
                     if (false === strpos($rule->field, '_second')) {
                         // No _second
                         $original_field = str_replace($stringToSearch, '', $rule->field);
@@ -2642,7 +2643,7 @@ public function getExtraFieldRules($filters, $stringToSearch = 'extra_', $condit
                                     $conditionArray[] = ' ('
                                         .$this->get_where_clause($rule->field, $rule->op, $rule->data)
                                         .') ';
-                                    $extraFields[] = ['field' => $rule->field, 'id' => $field_option['id']];
+                                    $extraFields[] = ['field' => $ruleField, 'id' => $field_option['id']];
                                 }
                                 break;
                             case self::FIELD_TYPE_TAG:
@@ -2654,7 +2655,7 @@ public function getExtraFieldRules($filters, $stringToSearch = 'extra_', $condit
                                     //$where = $this->get_where_clause($rule->field, $rule->op, $rule->data, 'OR');
                                     //$conditionArray[] = " ( $where ) ";
                                     $extraFields[] = [
-                                        'field' => $rule->field,
+                                        'field' => $ruleField,
                                         'id' => $field_option['id'],
                                         'data' => $rule->data,
                                     ];
@@ -2668,7 +2669,7 @@ public function getExtraFieldRules($filters, $stringToSearch = 'extra_', $condit
                                     $where = $this->get_where_clause($rule->field, $rule->op, $rule->data, 'OR');
                                     $conditionArray[] = " ( $where ) ";
                                     $extraFields[] = [
-                                        'field' => $rule->field,
+                                        'field' => $ruleField,
                                         'id' => $field_option['id'],
                                         'data' => $rule->data,
                                     ];
@@ -2680,7 +2681,7 @@ public function getExtraFieldRules($filters, $stringToSearch = 'extra_', $condit
                         $original_field = str_replace($stringToSearch, '', $my_field);
                         $field_option = $this->get_handler_field_info_by_field_variable($original_field);
                         $extraFields[] = [
-                            'field' => $rule->field,
+                            'field' => $ruleField,
                             'id' => $field_option['id'],
                         ];
                     }
@@ -2701,9 +2702,12 @@ public function getExtraFieldRules($filters, $stringToSearch = 'extra_', $condit
      */
     public function get_where_clause($col, $oper, $val, $conditionBetweenOptions = 'OR')
     {
+        $col = Database::escapeField($col);
+
         if (empty($col)) {
             return '';
         }
+
         $conditionBetweenOptions = in_array($conditionBetweenOptions, ['OR', 'AND']) ? $conditionBetweenOptions : 'OR';
         if ('bw' === $oper || 'bn' === $oper) {
             $val .= '%';
