diff --git a/CHANGELOG.md b/CHANGELOG.md
index 5c273e20a..2825d8254 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -1,4 +1,6 @@
-## 8.12.7 (Unreleased)
+## 8.12.7 (2021-10-25)
+
+This is a bugfix release that includes a fix to a severe security vulnerability. It is recommended that all users that have Mycodo exposed to the internet and allow guest access upgrade to patch this vulnerability. Users that only run Mycodo on a local network and/or don't allow unknown user (i.e. guest) access likely won't be affected.
 
 ### Bugfixes
 
@@ -7,6 +9,7 @@
  - Fix error when unauthenticated users attempting to land on the home page
  - Fix Gauge Widget dependencies ([#1100](https://github.com/kizniche/mycodo/issues/1100))
  - Fix installation of pigpiod
+ - Fix file exploit vulnerability ([#1105](https://github.com/kizniche/mycodo/issues/1105))
 
 ### Features
 
diff --git a/mycodo/mycodo_flask/routes_general.py b/mycodo/mycodo_flask/routes_general.py
index c513c36d8..498a622e4 100644
--- a/mycodo/mycodo_flask/routes_general.py
+++ b/mycodo/mycodo_flask/routes_general.py
@@ -117,7 +117,8 @@ def send_note_attachment(filename):
     file_path = os.path.join(PATH_NOTE_ATTACHMENTS, filename)
     if file_path is not None:
         try:
-            return send_file(file_path, as_attachment=True)
+            if os.path.abspath(file_path).startswith(PATH_NOTE_ATTACHMENTS):
+                return send_file(file_path, as_attachment=True)
         except Exception:
             logger.exception("Send note attachment")
 
@@ -149,7 +150,8 @@ def camera_img_return_path(camera_unique_id, img_type, filename):
         files = []
     if filename in files:
         path_file = os.path.join(path, filename)
-        return send_file(path_file, mimetype='image/jpeg')
+        if os.path.abspath(path_file).startswith(path):
+            return send_file(path_file, mimetype='image/jpeg')
 
     return "Image not found"
 
