diff --git a/README.txt b/README.txt
index 1106eba..3e02895 100755
--- a/README.txt
+++ b/README.txt
@@ -3,11 +3,11 @@ Contributors: phbernard
 Tags: favicon, apple-touch-icon, realfavicongenerator
 Requires at least: 3.5
 Tested up to: 4.1.1
-Stable tag: 1.2.12
+Stable tag: 1.2.13
 License: GPLv2
 License URI: http://www.gnu.org/licenses/gpl-2.0.html
 
-Create and install your favicon for all platforms: PC/Mac of course, but also iPhone/iPad, Android devices, Windows 8 tablets...
+Create and install your favicon for all platforms: PC/Mac, iPhone/iPad, Android devices, Windows 8 tablets...
 
 == Description ==
 
@@ -72,6 +72,10 @@ This screen presents you a preview of the favicon you various platforms, so you
 
 == Changelog ==
 
+= 1.2.13 =
+
+- XSS vulnerability fixed, reported by [Kacper Szurek](http://security.szurek.pl/)
+
 = 1.2.12 =
 
 - Performance improvements: favicon update checking is now done in the Admin section (not the Public section), locales are not loaded in the Public section anymore.
diff --git a/admin/class-favicon-by-realfavicongenerator-admin.php b/admin/class-favicon-by-realfavicongenerator-admin.php
index e5b6df3..98782ba 100755
--- a/admin/class-favicon-by-realfavicongenerator-admin.php
+++ b/admin/class-favicon-by-realfavicongenerator-admin.php
@@ -9,6 +9,7 @@ class Favicon_By_RealFaviconGenerator_Admin extends Favicon_By_RealFaviconGenera
 	const DISMISS_UPDATE_NOTIICATION = 'fbrfg_dismiss_update_notification';
 	const DISMISS_UPDATE_ALL_UPDATE_NOTIICATIONS = 'fbrfg_dismiss_all_update_notifications';
 	const SETTINGS_FORM = 'fbrfg_settings_form';
+	const NONCE_ACTION_NAME = 'favicon_generation';
 
 	protected static $instance = null;
 
@@ -125,6 +126,9 @@ public function create_favicon_appearance_page() {
 			$new_favicon_params_url = NULL;
 		}
 
+		// Nonce
+		$nonce = wp_create_nonce( NONCE_ACTION_NAME );
+
 		// External files
 		wp_enqueue_script( 'jquery' );
 		wp_enqueue_script( 'jquery-ui' );
@@ -161,21 +165,31 @@ public function install_new_favicon() {
 
 			$response = new Favicon_By_RealFaviconGenerator_Api_Response( $result );
 
-			$zip_path = Favicon_By_RealFaviconGenerator_Common::get_tmp_dir();
-			if ( ! file_exists( $zip_path ) ) {
-				mkdir( $zip_path, 0755, true );
+			if ( ! wp_verify_nonce( $response->getCustomParameter(), NONCE_ACTION_NAME ) ) {
+				// Attack in progress?
+?>
+{
+	"status": "error",
+	"message": "<?php _e( 'Nonce was not recognized. This case is supposed to happen only in case of XSS attack. If you feel like something is wrong, please <a href=\"mailto:contact@realfavicongenerator.net\">contact us</a>.', FBRFG_PLUGIN_SLUG ) ?>"
+}
+<?php
 			}
-			$response->downloadAndUnpack( $zip_path );
+			else {
+				$zip_path = Favicon_By_RealFaviconGenerator_Common::get_tmp_dir();
+				if ( ! file_exists( $zip_path ) ) {
+					mkdir( $zip_path, 0755, true );
+				}
+				$response->downloadAndUnpack( $zip_path );
 
-			$this->store_pictures( $response );
+				$this->store_pictures( $response );
 
-			$this->store_preview( $response->getPreviewPath() );
+				$this->store_preview( $response->getPreviewPath() );
 
-			Favicon_By_RealFaviconGenerator_Common::remove_directory( $zip_path );
+				Favicon_By_RealFaviconGenerator_Common::remove_directory( $zip_path );
 
-			update_option( Favicon_By_RealFaviconGenerator_Common::OPTION_HTML_CODE, $response->getHtmlCode() );
-			
-			$this->set_favicon_configured( true, $response->isFilesInRoot(), $response->getVersion() );
+				update_option( Favicon_By_RealFaviconGenerator_Common::OPTION_HTML_CODE, $response->getHtmlCode() );
+				
+				$this->set_favicon_configured( true, $response->isFilesInRoot(), $response->getVersion() );
 ?>
 {
 	"status": "success",
@@ -183,6 +197,7 @@ public function install_new_favicon() {
 	"favicon_in_root": <?php echo json_encode( $this->is_favicon_in_root() ) ?>
 }
 <?php
+			}
 		}
 		catch(Exception $e) {
 ?>
diff --git a/admin/views/appearance.php b/admin/views/appearance.php
index 84feaf6..87cf395 100755
--- a/admin/views/appearance.php
+++ b/admin/views/appearance.php
@@ -184,6 +184,7 @@ function computeJson() {
 			: 'favicon-by-realfavicongenerator/admin/class-favicon-by-realfavicongenerator-admin.phpfavicon_appearance_menu' ) ) ?>";
 		params.favicon_generation.callback.short_url = 'true';
 		params.favicon_generation.callback.path_only = 'true';
+		params.favicon_generation.callback.custom_parameter = "<?php echo $nonce ?>";
 
 		return params;
 	}
diff --git a/favicon-by-realfavicongenerator.php b/favicon-by-realfavicongenerator.php
index 483b3a1..0b14e0d 100755
--- a/favicon-by-realfavicongenerator.php
+++ b/favicon-by-realfavicongenerator.php
@@ -12,7 +12,7 @@
  * Plugin Name:       Favicon by RealFaviconGenerator
  * Plugin URI:        http://realfavicongenerator.net/extensions/wordpress
  * Description:       Create and install your favicon for all platforms: PC/Mac of course, but also iPhone/iPad, Android devices, Windows 8 tablets, etc. 
- * Version:           1.2.12
+ * Version:           1.2.13
  * Author:            Philippe Bernard
  * Author URI:        http://realfavicongenerator.net/
  * License:           GPLv2
