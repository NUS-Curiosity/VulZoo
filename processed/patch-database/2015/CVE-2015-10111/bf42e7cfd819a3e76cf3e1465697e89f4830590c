diff --git a/controllers/exam.php b/controllers/exam.php
index 541890d..c15fcd1 100644
--- a/controllers/exam.php
+++ b/controllers/exam.php
@@ -7,9 +7,9 @@ function watu_exams() {
 	if( isset($_REQUEST['grade']) )  print '<div id="message" class="updated fade"><p>' . $_REQUEST['grade']. '</p></div>';
 	
 	if(!empty($_GET['action']) and $_GET['action'] == 'delete') {
-		$wpdb->get_results("DELETE FROM ".WATU_EXAMS." WHERE ID='$_REQUEST[quiz]'");
-		$wpdb->get_results("DELETE FROM ".WATU_ANSWERS." WHERE question_id IN (SELECT ID FROM ".WATU_QUESTIONS." WHERE exam_id='$_REQUEST[quiz]')");
-		$wpdb->get_results("DELETE FROM ".WATU_QUESTIONS." WHERE exam_id='$_REQUEST[quiz]'");
+		$wpdb->get_results($wpdb->prepare("DELETE FROM ".WATU_EXAMS." WHERE ID=%d", $_REQUEST['quiz']));
+		$wpdb->get_results($wpdb->prepare("DELETE FROM ".WATU_ANSWERS." WHERE question_id IN (SELECT ID FROM ".WATU_QUESTIONS." WHERE exam_id=%d", $_REQUEST['quiz']));
+		$wpdb->get_results($wpdb->prepare("DELETE FROM ".WATU_QUESTIONS." WHERE exam_id=%d", $_REQUEST['quiz']));
 		print '<div id="message" class="updated fade"><p>' . __('Test deleted', 'watu') . '</p></div>';
 	}
 	
diff --git a/controllers/show_exam.php b/controllers/show_exam.php
index 969446d..7cd4d79 100644
--- a/controllers/show_exam.php
+++ b/controllers/show_exam.php
@@ -196,7 +196,7 @@
 		if(empty($taking_id)) {
 			$wpdb->query($wpdb->prepare("INSERT INTO ".WATU_TAKINGS." SET exam_id=%d, user_id=%d, ip=%s, date=CURDATE(), 
 				points=%d, grade_id=%d, result=%s, snapshot='', start_time=%s", 
-				$exam_id, $uid, $_SERVER['REMOTE_ADDR'], $achieved, $g_id, $grade, $_POST['start_time']));
+				$exam_id, $uid, $_SERVER['REMOTE_ADDR'], $achieved, $g_id, $grade, @$_POST['start_time']));
 			$taking_id = $wpdb->insert_id;
 		}
 	}
diff --git a/readme.txt b/readme.txt
index 4c6b414..8f39e9a 100644
--- a/readme.txt
+++ b/readme.txt
@@ -126,7 +126,7 @@ Yes. You can create a folder called "watu" under your active WP theme folder. Th
 
 == Changelog ==
 
-= Changes in 2.6.7 =
+= Changes in 2.6.8 =
 - Added option to limit the number of logged in user attempts for quizzes that require login.
 - You can specify one or more email addresses that will receive user's results (instead of just using the admin email from your WP Settings page)
 - You can now specify different content for the email sent to you when someone takes a quiz
@@ -134,6 +134,7 @@ Yes. You can create a folder called "watu" under your active WP theme folder. Th
 - You can specify different email contents of the email sent to user than the contents of the email sent to admin
 - All views /  templates can now be overriden by placing their copy under a folder called "watu" in your theme folder.
 - Added option to switch off Ajax submitting for certain quizzes. This is useful if you are embedding javascript via shortcodes from other plugins in the final screen of the quiz as some javascripts won't work when loaded by Ajax.
+- Fixed security exploit
 
 = Changes in 2.6 =
 - Added optional text-based "captcha" to prevent spam bot submissions on quizzes which do not require user login
diff --git a/script.js b/script.js
index 2e9df38..44aea36 100644
--- a/script.js
+++ b/script.js
@@ -179,6 +179,7 @@ Watu.submitResult = function(e) {
 	}
 	
 	data['post_id'] = Watu.post_id;
+	data['start_time'] = jQuery('#watuStartTime').val();
 	
 	// no ajax? In this case only return true to allow submitting the form	
 	if(e && e.no_ajax && e.no_ajax.value == 1) return true;	
diff --git a/views/show_exam.html.php b/views/show_exam.html.php
index 34aba7a..7cb2cc1 100644
--- a/views/show_exam.html.php
+++ b/views/show_exam.html.php
@@ -71,7 +71,7 @@
 <input type="hidden" name="post_id" value="<?php echo $post->ID?>">
 <?php endif; // end if(!empty($exam->no_ajax))?>
 <input type="hidden" name="quiz_id" value="<?php echo $exam_id ?>" />
-<input type="hidden" name="start_time" value="<?php echo current_time('mysql'); ?>" />
+<input type="hidden" id="watuStartTime" name="start_time" value="<?php echo current_time('mysql'); ?>" />
 </form>
 </div>
 <script type="text/javascript">
diff --git a/watu.php b/watu.php
index 308f6e3..55bb46e 100644
--- a/watu.php
+++ b/watu.php
@@ -4,7 +4,7 @@
 Plugin URI: http://calendarscripts.info/watu-wordpress.html
 Description: Create exams and quizzes and display the result immediately after the user takes the exam. Watu for Wordpress is a light version of <a href="http://calendarscripts.info/watupro/" target="_blank">WatuPRO</a>. Check it if you want to run fully featured exams with data exports, student logins, timers, random questions and more. Free support and upgrades are available. Go to <a href="options-general.php?page=watu.php">Watu Settings</a> or <a href="tools.php?page=watu_exams">Manage Your Exams</a> 
 
-Version: 2.6.7
+Version: 2.6.8
 Author: Kiboko Labs
 License: GPLv2 or later
 
@@ -326,7 +326,7 @@ function watu_vc_scripts() {
 			'watu-script',
 			WATU_URL.'script.js',
 			array(),
-			'2.3.2'
+			'2.3.3'
 		);
 		
 		$translation_array = array(
