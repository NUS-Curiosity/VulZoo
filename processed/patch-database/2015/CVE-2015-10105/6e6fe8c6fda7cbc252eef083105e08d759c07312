diff --git a/ip_blacklist_cloud.php b/ip_blacklist_cloud.php
index f5272b8..78e5311 100644
--- a/ip_blacklist_cloud.php
+++ b/ip_blacklist_cloud.php
@@ -3,7 +3,7 @@
 Plugin Name: IP Blacklist Cloud
 Plugin URI: http://wordpress.org/extend/plugins/ip-blacklist-cloud/
 Description: Blacklist IP Addresses from visiting your WordPress website and block usernames from spamming. View details of all failed login attempts.
-Version: 3.42
+Version: 3.43
 Author: Adeel Ahmed
 Author URI: http://www.ip-finder.me/
 */
@@ -1881,26 +1881,47 @@ function valid_js_identifier( $callback ){
 		//-----Import Database-----
 		if($_REQUEST['action']=="importCSVIPCloud")
 		{
-			if(current_user_can( 'manage_options' ) && $_REQUEST['filename'])
+			if(current_user_can( 'manage_options' ) && isset($_REQUEST['filename']))
 			{
 				$js_url =get_bloginfo('template_directory');
 				$upload_d = wp_upload_dir();
 				$upload_url=$upload_d['baseurl'];
 				$upload_dir=$upload_d['basedir'];
-				$filename= $upload_dir."/ipblc_csv/".$_REQUEST['filename'];
+				$file_req=$_REQUEST['filename'];
+
+				//---remove ../ or ./ from direct access---
+
+				$file_req=str_replace("../","",$file_req);
+				$file_req=str_replace("./","",$file_req);
+
+				$filename= $upload_dir."/ipblc_csv/".$file_req;
+
+
 				//echo "file: $filename<BR>";
+
+				$exp=explode(".",$filename);
+				$ext=strtolower($exp[count($exp)-1]);
 				$row = 1;
-				if (($handle = fopen("$filename", "r")) !== FALSE)
-				{
-					$AllData=array();
-					while (($data = fgetcsv($handle, 5242880, ",")) !== FALSE)
+				$file_type=filetype($filename);
+				
+				if($ext=="csv" && $file_type=="file")
+				{ 
+					if (($handle = fopen("$filename", "r")) !== FALSE)
+					{
+						$AllData=array();
+						while (($data = fgetcsv($handle, 5242880, ",")) !== FALSE)
+						{
+							$field=$data[0];
+							$value=$data[1];
+							$AllData[]=array("$field"=>$value);
+						}
+						fclose($handle);
+						echo json_encode($AllData);
+					}
+					else
 					{
-						$field=$data[0];
-						$value=$data[1];
-						$AllData[]=array("$field"=>$value);
+						echo "-1";
 					}
-					fclose($handle);
-					echo json_encode($AllData);
 				}
 				else
 				{
diff --git a/readme.txt b/readme.txt
index 32e1c2a..d8af7ad 100644
--- a/readme.txt
+++ b/readme.txt
@@ -4,7 +4,7 @@ Donate link:
 Tags: comments, spam, IP, blacklist, cloud, IP cloud, block, spamming, secure, failed login, hack attempt, auto block login
 Requires at least: 3.3
 Tested up to: 4.1.1
-Stable tag: 3.42
+Stable tag: 3.43
 License: GPLv2 or later
 License URI: http://www.gnu.org/licenses/gpl-2.0.html
 
@@ -91,6 +91,9 @@ http://demo.ip-finder.me/demo-details/
 
 == Changelog ==
 
+= 3.43 =
+* Quick Fix - Fixed CSV import vulnerability found by g0blin
+
 = 3.42 =
 * Quick Fix - Fixed mysql_real_escape_string() warning
 
