diff --git a/Kernel/Modules/AdminSupportDataCollector.pm b/Kernel/Modules/AdminSupportDataCollector.pm
index 1ab0a11a053..4b8489c969a 100644
--- a/Kernel/Modules/AdminSupportDataCollector.pm
+++ b/Kernel/Modules/AdminSupportDataCollector.pm
@@ -280,6 +280,8 @@ sub _SupportDataCollectorView {
 sub _GenerateSupportBundle {
     my ( $Self, %Param ) = @_;
 
+    $Kernel::OM->Get('Kernel::Output::HTML::Layout')->ChallengeTokenCheck();
+
     my $MainObject = $Kernel::OM->Get('Kernel::System::Main');
     my $RandomID   = $MainObject->GenerateRandomString(
         Length     => 8,
@@ -350,12 +352,23 @@ sub _DownloadSupportBundle {
 
     my $ParamObject  = $Kernel::OM->Get('Kernel::System::Web::Request');
     my $LayoutObject = $Kernel::OM->Get('Kernel::Output::HTML::Layout');
+
+    $LayoutObject->ChallengeTokenCheck();
+
     my $Filename     = $ParamObject->GetParam( Param => 'Filename' ) || '';
     my $RandomID     = $ParamObject->GetParam( Param => 'RandomID' ) || '';
 
-    if ( !$Filename ) {
+    # Validate simple file name.
+    if ( !$Filename || $Filename !~ m{^[a-z0-9._-]+$}smxi  ) {
+        return $LayoutObject->ErrorScreen(
+            Message => "Need Filename or Filename invalid!",
+        );
+    }
+
+    # Validate simple RandomID.
+    if ( !$RandomID || $RandomID !~ m{^[a-f0-9]+$}smx  ) {
         return $LayoutObject->ErrorScreen(
-            Message => "Need Filename!",
+            Message => "Need RandomID or RandomID invalid!",
         );
     }
 
diff --git a/var/httpd/htdocs/js/Core.Agent.Admin.SupportDataCollector.js b/var/httpd/htdocs/js/Core.Agent.Admin.SupportDataCollector.js
index 418e7dae2ae..97986399e80 100644
--- a/var/httpd/htdocs/js/Core.Agent.Admin.SupportDataCollector.js
+++ b/var/httpd/htdocs/js/Core.Agent.Admin.SupportDataCollector.js
@@ -160,7 +160,7 @@ Core.Agent.Admin = Core.Agent.Admin || {};
                     }
 
                     $('#DownloadSupportBundle').on('click', function () {
-                        window.location.href = Core.Config.Get('Baselink') + 'Action=' + Core.Config.Get('Action') + ';Subaction=DownloadSupportBundle;Filename=' + Response.Filename + ';RandomID=' + Response.RandomID;
+                        window.location.href = Core.Config.Get('Baselink') + 'Action=' + Core.Config.Get('Action') + ';Subaction=DownloadSupportBundle;Filename=' + Response.Filename + ';RandomID=' + Response.RandomID + ';ChallengeToken=' + Core.Config.Get('ChallengeToken');
                         Core.UI.Dialog.CloseDialog($('#SupportBundleOptionsDialog'));
                     });
                 }
