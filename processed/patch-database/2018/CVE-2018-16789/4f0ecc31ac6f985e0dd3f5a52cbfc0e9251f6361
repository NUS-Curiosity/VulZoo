diff --git a/debian/changelog b/debian/changelog
index 4d2f7cd..52e8aa4 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -1,3 +1,9 @@
+shellinabox (2.21) unstable; urgency=medium
+
+  * Patched DoS vulnerability reported by Imre Rad.
+
+ -- Marc Singer <elf@debian.org>  Sun, 09 Sep 2018 12:10:40 -0700
+
 shellinabox (2.20) unstable; urgency=medium
 
   * Fixed issue #222, LOGIN service
diff --git a/libhttp/url.c b/libhttp/url.c
index ed29475..a73cde9 100644
--- a/libhttp/url.c
+++ b/libhttp/url.c
@@ -313,6 +313,21 @@ static void urlParsePostBody(struct URL *url,
             }
           }
         }
+        /* elf-2018.09.09: Detection of broken multipart/form-data
+           fixes DoS vulnerability.
+
+           On 9/9/18 10:43 AM, Imre Rad wrote:
+           Hi Markus, Marc!
+
+           I identified a vulnerability today in Shellinabox, it is
+           remote a denial of service, shellinaboxd eating up 100% cpu
+           and not processing subsequent requests after the attack was
+           mounted.
+        */
+        else {
+          warn ("[http] Ignorning broken multipart/form-data");
+          break;
+        }
       }
       if (lastPart) {
         warn("[http] Missing final \"boundary\" for \"multipart/form-data\"!");
