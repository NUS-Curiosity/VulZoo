
Date: Wed, 25 Jun 2014 15:07:36 +0100
From: Portcullis Advisories <advisories@...tcullis-security.com>
To: bugtraq@...urityfocus.com, fulldisclosure@...lists.org,
  moderators@...db.org, vuln@...unia.com
Subject: CVE-2014-3752 - Arbitrary Code Execution in G Data TotalProtection
 2014

Vulnerability title: Arbitrary Code Execution in G Data TotalProtection 2014
CVE: CVE-2014-3752
Vendor: G Data
Product: TotalProtection 2014
Affected version: v24.0.2.1
Fixed version: N/A
Reported by: Kyriakos Economou

Details:

G Data TotalProtection 2014 v24.0.2.1 and possibly earlier versions are
vulnerable to arbitrary code execution.
A local attacker is able to execute code as SYSTEM by exploiting a bug
in the MiniIcpt.sys (v1.013046.218) device driver.
Other software from the same vendor using the affected driver may also
be vulnerable to the same attack.

This vulnerability doesn’t currently allow elevation of privileges as
the attacker needs administrator rights to trigger the bug.

In particular, IOCTL 0×83170180 leads to:
OR ECX, -1
LOCK XADD DWORD PTR [EAX], ECX

These two instructions are used to decrement a value stored in a memory
location pointed by EAX, but in this case the value of EAX can be
controlled through the IOCTL input buffer from userland.
Any value in writeable memory can be decremented at will by triggering
the vulnerability multiple times.

The challenge in a scenario like this is to find a pointer that could
later be used to control the EIP.
For example, a pointer to another function of the same module could be
used through another IOCTL, if that pointer is stored to a known address
such as in the range of the driver module itself.


Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-3752/


Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.

Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information.
