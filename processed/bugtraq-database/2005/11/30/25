
Date: Wed, 30 Nov 2005 15:11:00 -0700
From: Mandriva Security Team <security@...driva.com>
To: bugtraq@...urityfocus.com
Subject: MDKSA-2005:219 - Updated kernel packages fix numerous vulnerabilities


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

 _______________________________________________________________________
 
 Mandriva Linux Security Advisory                         MDKSA-2005:219
 http://www.mandriva.com/security/
 _______________________________________________________________________
 
 Package : kernel
 Date    : November 30, 2005
 Affected: 10.1
 _______________________________________________________________________
 
 Problem Description:
 
 Multiple vulnerabilities in the Linux 2.6 kernel have been discovered
 and corrected in this update:
 
 An integer overflow in vc_resize (CAN-2004-1333).
 
 A race condition in the sysfs_read_file and sysfs_write_file functions
 in 2.6.10 and earlier allows local users to read kernel memory and
 cause a DoS (crash) via large offsets in sysfs files (CAN-2004-2302).
 
 An integer signedness error in scsi_ioctl.c (CVE-2005-0180).
 
 Netfilter allows a local user to cause a DoS (memory consumption) via
 certain packet fragments that are reassembled twice, which causes a
 data structure to be allocated twice (CVE-2005-0210).
 
 A DoS in pkt_ioctl in pktcdvc.c (CVE-2005-1589).
 
 An array index overflow in the xfrm_sk_policy_insert function in
 xfrm_user.c allows local users to cause a DoS (oops or deadlock) and
 possibly execute arbitrary code (CVE-2005-2456).
 
 The zisofs driver in versions prior to 2.6.12.5 allows local users and
 remove attackers to cause a DoS (crash) via a crafted compressed ISO
 filesystem (CVE-2005-2457).
 
 inflate.c in the zlib routines in versions prior to 2.6.12.5 allow
 remove attackers to cause a DoS (crash) via a compressed file with
 "improper tables" (CVE-2005-2458).
 
 The huft_build function in inflate.c in the zlib routines in versions
 prior to 2.6.12.5 returns the wrong value, allowing remote attackers to
 cause a DoS (crash) via a certain compressed file that leads to a null
 pointer dereference (CVE-2005-2459).
 
 A stack-based buffer overflow in the sendmsg function call in versions
 prior to 2.6.13.1 allow local users to execute arbitrary code by
 calling sendmsg and modifying the message contents in another thread
 (CVE-2005-2490).
 
 vlan_dev.c in version 2.6.8 allows remote attackers to cause a DoS
 (oops from null dereference) via certain UDP packets that lead to
 a function call with the wrong argument (CVE-2005-2548).
 
 The kernel does not properly restrict socket policy access to users
 with the CAP_NET_ADMIN capability, which could allow local users to
 conduct unauthorized activities via ipv4/ip_sockglue.c and
 ipv6/ipv6_sockglue.c (CVE-2005-2555).
 
 A memory leak in the seq_file implementation in the SCSI procfs
 interface (sg.c) in 2.6.13 and earlier allows a local user to cause a
 DoS (memory consumption) via certain repeated reads from
 /proc/scsi/gs/devices file which is not properly handled when the
 next() interator returns NULL or an error (CVE-2005-2800).
 
 xattr.c in the ext2 and ext3 file system code does not properly compare
 the name_index fields when sharing xattr blocks which could prevent
 ACLs from being applied (CVE-2005-2801).
 
 The ipt_recent module in versions prior to 2.6.12 when running on 64bit
 processors allows remote attackers to cause a DoS (kernel panic) via
 certain attacks such as SSH brute force (CVE-2005-2872).
 
 The ipt_recent module in versions prior to 2.6.12 does not properly
 perform certain tests when the jiffies value is greater than LONG_MAX,
 which can cause ipt_recent netfilter rules to block too early
 (CVE-2005-2873).
 
 Multiple vulnerabilities in versions prior to 2.6.13.2 allow local
 users to cause a DoS (oops from null dereference) via fput in a 32bit
 ioctl on 64-bit x86 systems or sockfd_put in the 32-bit routing_ioctl
 function on 64-bit systems (CVE-2005-3044).
 
 The sys_set_mempolicy function in mempolicy.c allows local users to
 cause a DoS via a negative first argument (CVE-2005-3053).
 
 Versions 2.6.8 to 2.6.14-rc2 allow local users to cause a DoS (oops)
 via a userspace process that issues a USB Request Block (URB) to a USB
 device and terminates before the URB is finished, which leads to a
 stale pointer reference (CVE-2005-3055).
 
 The Orinoco driver in 2.6.13 and earlier does not properly clear memory
 from a previously used packet whose length is increased, allowing
 remote attackers to obtain sensitive information (CVE-2005-3180).
 
 Kernels 2.6.13 and earlier, when CONFIG_AUDITSYSCALL is enabled, use an
 incorrect function to free names_cache memory, preventing the memory
 from being tracked by AUDITSYSCALL code and leading to a memory leak
 (CVE-2005-3181).
 
 The VT implementation in version 2.6.12 allows local users to use
 certain IOCTLs on terminals of other users and gain privileges
 (CVE-2005-3257).
 
 Exec does not properly clear posix-timers in multi-threaded
 environments, which result in a resource leak and could allow a large
 number of multiple local users to cause a DoS by using more posix-
 timers than specified by the quota for a single user (CVE-2005-3271).
 
 The rose_rt_ioctl function rose_route.c in versions prior to 2.6.12
 does not properly verify the ndigis argument for a new route, allowing
 an attacker to trigger array out-of-bounds errors with a large number
 of digipeats (CVE-2005-3273).
 
 A race condition in ip_vs_conn_flush in versions prior to 2.6.13, when
 running on SMP systems, allows local users to cause a DoS (null
 dereference) by causing a connection timer to expire while the
 connection table is being flushed before the appropriate lock is
 acquired (CVE-2005-3274).
 
 The NAT code in versions prior to 2.6.13 incorrectly declares a
 variable to be static, allowing remote attackers to cause a DoS (memory
 corruption) by causing two packets for the same protocol to be NATed at
 the same time (CVE-2005-3275).
 
 The sys_get_thread_area function in process.c in versions prior to
 2.6.12.4 and 2.6.13 does not clear a data structure before copying it
 to userspace, which may allow a user process to obtain sensitive
 information (CVE-2005-3276).
 
 The following non-security fixes are also applied:
 
 Driver updates were made to the aic97xx and sata_sil modules.
 
 Support was added for ATI ipx400 chipsets, for IDE and sound.
 
 A build problem with icecream on the x86_64 platform was fixed.
 
 The pin1 APIC timer on RS480-based motherboards was disabled.
 
 The provided packages are patched to fix these vulnerabilities.  All
 users are encouraged to upgrade to these updated kernels.
 
 To update your kernel, please follow the directions located at:
 
   http://www.mandriva.com/en/security/kernelupdate
 _______________________________________________________________________

 References:
 
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-1333
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-2302
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-0180
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-0210
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1589
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2456
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2457
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2458
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2459
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2490
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2548
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2555
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2800
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2801
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2872
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2873
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3044
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3053
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3055
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3180
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3181
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3257
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3271
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3273
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3274
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3275
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3276
 _______________________________________________________________________
 
 Updated Packages:
 
 Mandriva Linux 10.1:
 cc60a0c2a5c0425db63a625526475898  10.1/RPMS/kernel-2.6.8.1.26mdk-1-1mdk.i586.rpm
 9c85d79e18e3dec0bd80605ab4ed7bc6  10.1/RPMS/kernel-enterprise-2.6.8.1.26mdk-1-1mdk.i586.rpm
 619c620342e4786903ad174827a78982  10.1/RPMS/kernel-i586-up-1GB-2.6.8.1.26mdk-1-1mdk.i586.rpm
 bdfc653a5ca1e456d3c15c2f8f35d98d  10.1/RPMS/kernel-i686-up-64GB-2.6.8.1.26mdk-1-1mdk.i586.rpm
 a9241f9cd330bc79360f0dda4fa1eec5  10.1/RPMS/kernel-secure-2.6.8.1.26mdk-1-1mdk.i586.rpm
 29bbd09a962d59cd92e60ab644439b6f  10.1/RPMS/kernel-smp-2.6.8.1.26mdk-1-1mdk.i586.rpm
 cae06806ff7412caa156fcea3d86c78f  10.1/RPMS/kernel-source-2.6-2.6.8.1-26mdk.i586.rpm
 34122459890fa39f27a81cec4c3e56e6  10.1/RPMS/kernel-source-stripped-2.6-2.6.8.1-26mdk.i586.rpm
 104478404575b1903f8ca961a0e68a21  10.1/SRPMS/kernel-2.6.8.1.26mdk-1-1mdk.src.rpm

 Mandriva Linux 10.1/X86_64:
 d8d56fcbe9daa46d35e80aa61ba6a6ce  x86_64/10.1/RPMS/kernel-2.6.8.1.26mdk-1-1mdk.x86_64.rpm
 f784c422b1f5874e6456d8fc3eeb2449  x86_64/10.1/RPMS/kernel-secure-2.6.8.1.26mdk-1-1mdk.x86_64.rpm
 1566275e89bb4087535f9de77157a5b6  x86_64/10.1/RPMS/kernel-smp-2.6.8.1.26mdk-1-1mdk.x86_64.rpm
 d30568e225088db18fe1bc72fc108ea9  x86_64/10.1/RPMS/kernel-source-2.6-2.6.8.1-26mdk.x86_64.rpm
 e1b2c9cf2feb58611eb7d48d8216bb45  x86_64/10.1/RPMS/kernel-source-stripped-2.6-2.6.8.1-26mdk.x86_64.rpm
 104478404575b1903f8ca961a0e68a21  x86_64/10.1/SRPMS/kernel-2.6.8.1.26mdk-1-1mdk.src.rpm
 _______________________________________________________________________

 To upgrade automatically use MandrivaUpdate or urpmi.  The verification
 of md5 checksums and GPG signatures is performed automatically for you.

 All packages are signed by Mandriva for security.  You can obtain the
 GPG public key of the Mandriva Security Team by executing:

  gpg --recv-keys --keyserver pgp.mit.edu 0x22458A98

 You can view other update advisories for Mandriva Linux at:

  http://www.mandriva.com/security/advisories

 If you want to report vulnerabilities, please contact

  security_(at)_mandriva.com
 _______________________________________________________________________

 Type Bits/KeyID     Date       User ID
 pub  1024D/22458A98 2000-07-10 Mandriva Security Team
  <security*mandriva.com>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQFDjffWmqjQ0CJFipgRAqT9AKCj6LQEho3qcisjiq7+8ongRHGzJACg5Cuy
MD+4kCb7IPC636s6mwpEITY=
=TuUh
-----END PGP SIGNATURE-----


