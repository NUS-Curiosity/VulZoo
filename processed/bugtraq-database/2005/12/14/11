
Date: Wed, 14 Dec 2005 14:45:32 -0500
From: "labs-no-reply@...fense.com" <labs-no-reply@...fense.com>
To: bugtraq@...urityfocus.com, vulnwatch@...nwatch.org,
	full-disclosure@...ts.grok.org.uk
Subject: iDefense Security Advisory 12.14.05: Trend Micro
 ServerProtect Crystal Reports ReportServer File Disclosure



Trend Micro ServerProtect Crystal Reports ReportServer File Disclosure

iDefense Security Advisory 12.14.05
www.idefense.com/application/poi/display?id=352&type=vulnerabilities
December 14, 2005

I. BACKGROUND

Trend Micro Inc.'s ServerProtect provides antivirus scanning with
centralized management of virus outbreaks, scanning, patter file
updates, notifications and remote installations. More information about
the product set is available at:

 www.trendmicro.com/en/products/file-server/sp/evaluate/overview.htm

II. DESCRIPTION

Remote exploitation of an input validation vulnerability in Trend Micro
Inc.'s ServerProtect Management Console allows remote attackers to view
the contents of arbitrary files on the underlying system.

The problem specifically exists within the handling of the IMAGE
parameter in the script rptserver.asp. The vulnerable area of code is
outlined in the following snippet:

 Set session("oEMF") = Server.CreateObject("CREmfgen.CREmfgen.2")
 Call ParseQS()
 if IMAGE <> "" then
  Call session("oEMF").StreamImage(IMAGE, DEL)
  Response.End
 end if

An attacker can utilize directory traversal modifiers to traverse
outside the system temporary directory and access any file on the same
volume.

III. ANALYSIS

Successful exploitation of the described vulnerability allows remote
attackers to view the contents of arbitrary files on the underlying
system. Exploitation does not require credentials thereby exacerbating
the impact of this vulnerability.

IV. DETECTION

iDefense has confirmed the existence of this vulnerability in Trend
Micro ServerProtect for Windows Management Console 5.58 running with
Trend Micro Control Manager 2.5/3.0 and Trend Micro Damage Cleanup
Server 1.1. It is suspected that earlier versions and versions for other
platforms are vulnerable as well.

V. WORKAROUND

Employ firewalls, access control lists or other TCP/UDP restriction
mechanism to limit access to the vulnerable system on the configured
port, generally TCP port 80.

VI. VENDOR RESPONSE

"Trend Micro has become aware of a vulnerability related to Crystal
Report, a reporting component found in Trend Micro Control Manager (v2.5
and v3.0). Under certain conditions, arbitrary files on the
ReportServer volume inside Trend Micro Control Manager software could be
viewed or accessed remotely. Trend Micro is currently consulting with
Crystal Report regarding permanent solutions to this reporting
component. A temporary workaround solution can be recommended through
contacting Trend Micro customer and technical support."

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2005-1930 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

06/03/2005 Initial vendor notification
06/06/2005 Initial vendor response
12/14/2005 Public disclosure

IX. CREDIT

The discoverer of this vulnerability wishes to remain anonymous.

Get paid for vulnerability research
http://www.iDefense.com/poi/teams/vcp.jsp

Free tools, research and upcoming events
http://labs.iDefense.com

X. LEGAL NOTICES

Copyright Â© 2005 iDefense, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDefense. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically, please
email customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/


