
Date: Fri, 23 Feb 2007 15:35:01 -0500
From: iDefense Labs <labs-no-reply@...fense.com>
To: vulnwatch@...nwatch.org, full-disclosure@...ts.grok.org.uk,
	bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 02.23.07: Mozilla Network Security Services
 SSLv2 Server Stack Overflow Vulnerability

Apologies... The correct advisory text follows.

Mozilla Network Security Services SSLv2 Server Stack Overflow Vulnerability

iDefense Security Advisory 02.23.07
http://labs.idefense.com/intelligence/vulnerabilities/
Feb 23, 2007

I. BACKGROUND

Network Security Services (NSS) is a set of libraries designed to support
cross-platform development of security-enabled client and server
applications, providing support for, among others, SSL (Secure Socket
Layer) protocol version 2 and 3. For more information visit the following
URL.

http://www.mozilla.org/projects/security/pki/nss/tools/

II. DESCRIPTION

Remote exploitation of an input validation error causing an integer
underflow in version 3.10 of the Mozilla Foundation's Network Security
Services (NSS) may allow an attacker to cause a stack-based buffer
overflow and execute arbitrary code on the affected application.

The vulnerability specifically exists in code responsible for handling the
client master key. While negotiating an SSLv2 session, a client can specify
invalid parameters which causes an integer underflow. The resulting value
is used as the amount of memory to copy into a fixed size stack buffer. As
a result, a potentially exploitable stack-based buffer overflow condition
occurs.

III. ANALYSIS

Successful exploitation of this vulnerability would allow an attacker to
execute arbitrary code in the context of the affected server. No
authentication is required to reach the vulnerable code. No user
interaction is required.

Since this vulnerability is in library code used by multiple applications,
the details of how an attacker would exploit it vary. In all cases, an
attacker would need to specify invalid parameters as part of the SSLv2
handshake.

Code execution has been demonstrated to be possible under Windows 2000
with a server utilizing the affected library. Depending on the precise
details of the server, this vulnerability may also be exploitable on other
platforms.

IV. DETECTION

iDefense has confirmed this vulnerability exists in versions 3.10 and
3.11.3 of the Mozilla Network Security Services. These libraries are used
in a variety of products from multiple vendors including Sun Microsystems,
Red Hat and Mozilla. Previous versions are also likely to be affected. The
names 'libnss3.so' on Linux based systems or 'nss3.dll' on Windows based
systems may indicate the library is being used by an application.

V. WORKAROUND

iDefense is not aware of any effective workaround for this vulnerability.
With some servers it may be possible to prevent exposure by disabling
SSLv2 support and employing a different protocol. However, this workaround
may prevent some clients from being able to access the server.

VI. VENDOR RESPONSE

The Mozilla Foundation has addressed this vulnerability in Mozilla
Foundation Security Advisory 2007-06. For more information, view their
advisory at the following URL.

http://www.mozilla.org/security/announce/2007/mfsa2007-06.html

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2007-0009 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org/), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

12/18/2006  Initial vendor notification
12/19/2006  Initial vendor response
02/23/2007  Coordinated public disclosure

IX. CREDIT

This vulnerability was reported to iDefense by regenrecht.

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2007 iDefense, Inc.

Permission is granted for the redistribution of this alert electronically.
It may not be edited in any way without the express written consent of
iDefense. If you wish to reprint the whole or any part of this alert in
any other medium other than electronically, please e-mail
customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate at
the time of publishing based on currently available information. Use of
the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on, this
information.
