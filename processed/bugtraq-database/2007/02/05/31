
Date: Sun, 04 Feb 2007 20:37:37 +0330
From: "Omid" <omid@...kers.ir>
To: <bugtraq@...urityfocus.com>
Subject: Sql injection bugs in Virtuemart and Letterman

Hi,

These bugs were published in full-disclosure about 2 weeks ago (CVE :
CVE-2006-6945, CVE-2007-0376 and CVE-2007-0382) .

One sql injection and one XSS bugs exist in Virtuemart 1.0.7 . These can be
exploitable and are not described here . Two new versions have been released
in a short time .

Also 3 sql injection bugs exist in Letterman 1.2.3 (and maybe other versions):

The 'id' parameter in "lm_sendMail()" function is not checked properly
before be used in the sql query :

File components/com_letterman/letterman.class.php, Line 251 :
** 	$id  = mosGetParam( $_POST, "id", '' );

File components/com_letterman/letterman.class.php, Line 452 :
** 	$database->setQuery( "UPDATE `#__letterman` SET send=NOW() WHERE id=$id" );
:: 	$database->query();

Other bugs are in "saveNewsletter()" and "cancelNewsletter()" functions .
Again, the 'id' parameter is used without checking . This doesnt work in
Joomla 1.0.12 .

The original advisory (in Persian) is located at :
http://www.hackers.ir/advisories/festival.txt


- Omid
