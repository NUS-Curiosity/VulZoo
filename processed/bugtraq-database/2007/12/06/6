
Date: Thu, 6 Dec 2007 13:44:53 +0800
From: NSFOCUS Security Team <security@...ocus.com>
To: bugtraq@...urityfocus.com, full-disclosure@...ts.netsys.com,
	vulnwatch@...nwatch.org
Subject:  NSFOCUS SA2007-02 : Cisco Security Agent Remote Buffer Overflow Vulnerability

NSFOCUS Security Advisory (SA2007-02)

Cisco Security Agent Remote Buffer Overflow Vulnerability

Release Date: 2007-12-06

CVE ID: CVE-2007-5580

http://www.nsfocus.com/english/homepage/research/0702.htm

Affected systems & software
===================

 Cisco Security Agent for Windows < 4.5.1.672
 Cisco Security Agent for Windows < 5.0.0.225
 Cisco Security Agent for Windows < 5.1.0.106
 Cisco Security Agent for Windows < 5.2.0.238

Unaffected systems & software
===================


Summary
=========

NSFOCUS Security Team discovered a remote buffer overflow vulnerability in 
Cisco Security Agent for Windows which allows remote code execution by sending 
a malicious SMB request. 

Description
============

Cisco Security Agent is a security software agent that provides threat protection 
for server and desktop computing systems. 

A driver bundled with Cisco Security Agent for Windows does not correctly 
check the data length provided by users when processing a SMB packet, which 
might trigger a stack buffer overflow in the system kernel. A remote attacker 
might cause system with CSA installed to restart or BSOD. By sending carefully 
crafted data an attacker might cause remote code execution, thus gains complete 
control over the system. 

By default CSA allows access to TCP ports 139 and 445. After establishing a 
session to TCP ports 139 and 445, an attacker can complete an exploitation 
without any authentication simply by sending a single packet. 

Cisco Security Agent for Windows version 5.2.0.225 and prior are affected. 
Other Cisco software that uses CSA component is also affected.

Workaround
=============

* Restrict access to TCP ports 139 and 445.
    
Vendor Status
==============

2007.09.27  Informed the vendor
2007.10.23  Vendor confirmed the vulnerability
2007.12.05  Vendor released a security advisory (cisco-sa-20071205-csa) and 
            related patches. 
            
For more details about the Cisco security advisory, please refer to:
http://www.cisco.com/warp/public/707/cisco-sa-20071205-csa.shtml

Additional Information
========================

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2007-5580 to this issue. This is a candidate for inclusion in the 
CVE list (http://cve.mitre.org), which standardizes names for security problems.
Candidates may change significantly before they become official CVE entries.

Acknowledgment
===============

NSFOCUS Security Team

DISCLAIMS
==========
THE INFORMATION PROVIDED IS RELEASED BY NSFOCUS "AS IS" WITHOUT WARRANTY
OF ANY KIND. NSFOCUS DISCLAIMS ALL WARRANTIES, EITHER EXPRESSED OR IMPLIED,
EXCEPT FOR THE WARRANTIES OF MERCHANTABILITY. IN NO EVENT SHALL NSFOCUS
BE LIABLE FOR ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT,
INCIDENTAL,CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES,
EVEN IF NSFOCUS HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.
DISTRIBUTION OR REPRODUCTION OF THE INFORMATION IS PROVIDED THAT THE
ADVISORY IS NOT MODIFIED IN ANY WAY.

Copyright 1999-2007 NSFOCUS. All Rights Reserved. Terms of use.

NSFocus Security Team <security@...ocus.com>
NSFOCUS INFORMATION TECHNOLOGY CO.,LTD
(http://www.nsfocus.com)
