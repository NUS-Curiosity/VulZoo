
Date: Mon, 27 Aug 2007 11:01:47 -0400
From: iDefense Labs <labs-no-reply@...fense.com>
To: vulnwatch@...nwatch.org, full-disclosure@...ts.grok.org.uk,
	bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 08.27.07: Motorola Timbuktu Multiple Buffer
 Overflow Vulnerabilities

Motorola Timbuktu Multiple Buffer Overflow Vulnerabilities

iDefense Security Advisory 08.27.07
http://labs.idefense.com/intelligence/vulnerabilities/
Aug 27, 2007

I. BACKGROUND

Motorola Inc.'s Timbuktu Pro is a remote control software which allows
remote access to a computer's desktop. It is available for Mac OS X and
Windows systems and provides integration with Skype and SSH. More
information is available from the product web site at the following
URL.

http://netopia.com/software/products/tb2/

II. DESCRIPTION

Remote exploitation of multiple buffer overflow vulnerabilities within
Motorola Inc.'s Timbuktu allows attackers to crash the service or
potentially execute arbitrary code with SYSTEM privileges.

The first issue exists within the handling of malformed application
level protocol requests. Certain requests lead to an arbitrary length
overflow of a buffer located on the heap.

The second vulnerability exists within the processing of log in
requests. By specifying an overly long user name, it is possible to
cause heap corruption.

The third vulnerability specifically exists within the "Scanner"
functionally. By running a malicious socket server on TCP port 407, an
attacker is able to cause a buffer overflow with a malformed "HELLO"
response packet.

III. ANALYSIS

Exploitation of these vulnerabilities allows attackers to crash the
Timbuktu Pro server or potentially execute arbitrary code with SYSTEM
privileges.

In all cases, no authentication credentials are required to access the
vulnerable code. In order to exploit the first two vulnerabilities, the
attacker needs only the ability to initiate a session with the Timbuktu
service. This service typically runs on TCP or UDP port 407.

The third vulnerability requires access to the local network since the
problem lies in the handling of a response from a scanned server.
Additionally, an attacker would need to persuade a user to attempt to
connect to the malicious server.

IV. DETECTION

iDefense has confirmed the existence of these vulnerabilities within
version 8.6.3.1367 of Motorola Inc.'s Timbuktu Pro for Windows. Older
versions are suspected to be vulnerable.

V. WORKAROUND

Employing firewalls to limit access to the affected service's open ports
(TCP and UDP port 407) can help prevent potential exposure to these
vulnerabilities.

VI. VENDOR RESPONSE

Motorola Inc. has addressed these vulnerabilities by releasing version
8.6.5 of Timbuktu Pro for Windows. For more information, consult the
release notes at the following URL.

ftp://ftp-xo.netopia.com/evaluation/docs/timbuktu/win/865/relnotes/TB2Win865Evalrn.pdf

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2007-4221 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org/), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

07/18/2007  Initial vendor notification
07/19/2007  Initial vendor response
08/27/2007  Coordinated public disclosure

IX. CREDIT

These vulnerabilities was reported to iDefense by Titon of BastardLabs
and two anonymous researchers.

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2007 iDefense, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDefense. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically,
please e-mail customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
 There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct,
indirect, or consequential loss or damage arising from use of, or
reliance on, this information.
