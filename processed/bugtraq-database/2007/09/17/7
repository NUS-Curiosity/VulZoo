
Date: Mon, 17 Sep 2007 15:44:47 +0100
From: Trustix Security Advisor <tsl@...stix.org>
To: bugtraq@...urityfocus.com
Subject: TSLSA-2007-0026 - multi

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- --------------------------------------------------------------------------
Trustix Secure Linux Security Advisory #2007-0026

Package names:	   apache, clamav, kerberos5, php, rsync, tar, vim
Summary:           Multiple vulnerabilities
Date:              2007-09-17
Affected versions: Trustix Secure Linux 2.2
                   Trustix Secure Linux 3.0
                   Trustix Secure Linux 3.0.5
                   Trustix Operating System - Enterprise Server 2

- --------------------------------------------------------------------------
Package description:
  apache
  Apache is a full featured web server that is freely available, and also
  happens to be the most widely used. Built with loadable modules (all
  standard modules enabled). This verion is intended as a replacement for
  a standard apache, the configuration files provided with apache and
  apache-ssl are unchanged.

  clamav
  Clam AntiVirus is a GPL anti-virus toolkit for UNIX. The main purpose
  of this software is the integration with mail servers (attachment
  scanning). The package provides a flexible and scalable multi-threaded
  daemon, a command line scanner, and a tool for automatic updating via
  Internet. The programs are based on a shared library distributed with
  package, which you can use with your own software. Most importantly,
  the virus database is kept up to date.

  kerberos5
  (MIT) Kerberos is a network authentication protocol. It is designed to
  provide strong authentication for client/server applications by using
  secret-key cryptography. A free implementation of this protocol is
  available from the Massachusetts Institute of Technology. Kerberos is
  available in many commercial products as well.

  php
  PHP is an HTML-embedded scripting language. PHP attempts to make it
  easy for developers to write dynamically generated web pages. PHP
  also offers built-in database integration for several commercial
  and non-commercial database management systems, so writing a
  database-enabled web page with PHP is fairly simple. The most common
  use of PHP coding is probably as a replacement for CGI scripts. The
  mod_php module enables the Apache web server to understand and process
  the embedded PHP language in web pages.

  rsync
  Rsync uses a quick and reliable algorithm to very quickly bring
  remote and host files into sync. Rsync is fast because it just sends
  the differences in the files over the network (instead of sending the
  complete files). Rsync is often used as a very powerful mirroring
  process or just as a more capable replacement for the rcp command.
  A technical report which describes the rsync algorithm is included
  in this package.

  tar
  The GNU tar program saves many files together in one archive and can
  restore individual files (or all of the files) from that archive. Tar
  can also be used to add supplemental files to an archive and to update
  or list files in the archive. Tar includes multivolume support,
  automatic archive compression/decompression, the ability to perform
  remote archives, and the ability to perform incremental and full
  backups.

  vim
  VIM (VIsual editor iMproved) is an updated and improved version of the
  vi editor. Vi was the first real screen-based editor for UNIX, and is
  still very popular. VIM improves on vi by adding new features: multiple
  windows, multi-level undo, block highlighting and more.

Problem description:
  apache < TSL 3.0.5 > < TSL 3.0 > < TSL 2.2 > < TSEL 2>
  - SECURITY Fix: A cross-site scripting vulnerability exits in
    mod_status.c, when ExtendedStatus is enabled and a public
    server-status page is used. This allows remote attackers to inject
    arbitrary web script or HTML via unspecified vectors involving
    charsets with browsers that perform "charset detection" when the
    content-type is not specified.
  - Fixes an error in the Multi-Processing Module (MPM) which could be
    exploited to send signals to arbitrary processes and cause them to
    be terminated.
  - A bug was found in the mod_cache module. On sites where caching is
    enabled, a remote attacker could send a carefully crafted request
    that would cause the Apache child process handling that request to
    crash. This could lead to a denial of service if using a threaded
    Multi-Processing Module.

    The Common Vulnerabilities and Exposures project has assigned the
    names CVE-2006-5752, CVE-2007-3304 and CVE-2007-1863 to these issues.

  clamav < TSL 3.0.5 > < TSL 3.0 > < TSL 2.2 >
  - SECURITY Fix: Some vulnerabilities have been reported in ClamAV,
    which can potentially be exploited by malicious people to cause a
    DoS (Denial of Service) or to compromise a vulnerable system.
  - Included fixes for CVE-2007-4510 and CVE-2007-4560.
 
  kerberos5 < TSL 3.0.5 > < TSL 3.0 >
  - SECURITY Fix: A boundary error within the implementation of the
    RPCSEC_GSS authentication type exists in the "svcauth_gss_validate()"
    function in src/lib/rpc/svc_auth_gss.c. This can be exploited to
    cause a stack-based buffer overflow by sending a specially crafted
    RPC message to a vulnerable server.

    The Common Vulnerabilities and Exposures project (cve.mitre.org)
    has assigned the name CVE-2007-3999 to this issue.

  php < TSL 3.0.5 > < TSL 3.0 > < TSL 2.2 >
  - New Upstream.
  - SECURITY Fix. Some vulnerabilities have been reported in PHP, where
    some have unknown impacts and others can be exploited by malicious
    users to bypass certain security restrictions (SA26642).
  - Includes fixes for CVE-2007-3996, CVE-2007-3378 and CVE-2007-3997.

  rsync < TSL 3.0.5 > < TSL 3.0 > < TSL 2.2 > < TSEL 2>
  - SECURITY Fix: Sebastian Krahmer has reported a vulnerability in
    rsync, caused due to an off-by-one error within the "f_name()"
    function in flist.c. This can be exploited to cause a one-byte
    stack-based buffer overflow via an overly long directory name.

    The Common Vulnerabilities and Exposures project has assigned the
    name CVE-2007-4091 this issue.

  tar < TSL 3.0.5 > < TSL 3.0 > < TSL 2.2 >
  - SECURITY Fix: A vulnerability has been reported in GNU tar, caused
    due to an input validation error when extracting tar archives. This
    can be exploited to extract files to arbitrary locations outside the
    specified directory with the permissions of the user running GNU tar
    by using the "//.." directory traversal sequence in a specially
    crafted tar archive.

    The Common Vulnerabilities and Exposures project has assigned the
    name CVE-2007-4131 to this issue.

  vim < TSL 3.0.5 > < TSL 3.0 > < TSL 2.2 > < TSEL 2>
  - SECURITY Fix: Format string vulnerability in the helptags_one
    function in src/ex_cmds.c in Vim, allows user-assisted remote
    attackers to execute arbitrary code via format string specifiers
    in a help-tags tag in a help file, related to the helptags command.

    The Common Vulnerabilities and Exposures project (cve.mitre.org)
    has assigned the name CVE-2007-2953 to this issue.

Action:
  We recommend that all systems with this package installed be upgraded.
  Please note that if you do not need the functionality provided by this
  package, you may want to remove it from your system.


Location:
  All Trustix Secure Linux updates are available from
  <URI:http://http.trustix.org/pub/trustix/updates/>
  <URI:ftp://ftp.trustix.org/pub/trustix/updates/>


About Trustix Secure Linux:
  Trustix Secure Linux is a small Linux distribution for servers. With focus
  on security and stability, the system is painlessly kept safe and up to
  date from day one using swup, the automated software updater.


Automatic updates:
  Users of the SWUP tool can enjoy having updates automatically
  installed using 'swup --upgrade'.


Questions?
  Check out our mailing lists:
  <URI:http://www.trustix.org/support/>


Verification:
  This advisory along with all Trustix packages are signed with the
  TSL sign key.
  This key is available from:
  <URI:http://www.trustix.org/TSL-SIGN-KEY>

  The advisory itself is available from the errata pages at
  <URI:http://www.trustix.org/errata/trustix-2.2/>
  <URI:http://www.trustix.org/errata/trustix-3.0/> and
  <URI:http://www.trustix.org/errata/trustix-3.0.5/>
  or directly at
  <URI:http://www.trustix.org/errata/2007/0026/>


MD5sums of the packages:
- --------------------------------------------------------------------------
925097a0e9cc738b08396adf5feb00d0  3.0.5/rpms/apache-2.0.59-3tr.i586.rpm
22443efd217adaaba09a447090ce963d  3.0.5/rpms/apache-dbm-2.0.59-3tr.i586.rpm
f10a5f5d01f07218e9650271c527c2e0  3.0.5/rpms/apache-devel-2.0.59-3tr.i586.rpm
64d451329de36bf8cd6d2c4454f2a8d1  3.0.5/rpms/apache-html-2.0.59-3tr.i586.rpm
c6b386e66d94e98aff9859ac5435ea46  3.0.5/rpms/apache-manual-2.0.59-3tr.i586.rpm
e8072ea1c9b5a0d29b6247adf269c395  3.0.5/rpms/apache-suexec-2.0.59-3tr.i586.rpm
b2d98595c5c1594665e9697937108423  3.0.5/rpms/clamav-0.91.2-1tr.i586.rpm
009cb0c6903ad47f2547bfa611b1cea0  3.0.5/rpms/clamav-devel-0.91.2-1tr.i586.rpm
927f2723a88687b5d54172123c70b47e  3.0.5/rpms/kerberos5-1.4.3-6tr.i586.rpm
00161c51a944ec9af05837ff4d7d0cbd  3.0.5/rpms/kerberos5-devel-1.4.3-6tr.i586.rpm
f3b99cda0b1e0880888c57b04de31dec  3.0.5/rpms/kerberos5-libs-1.4.3-6tr.i586.rpm
a5bfe518189022302574ce95b97a4b9c  3.0.5/rpms/php-5.2.4-1tr.i586.rpm
aa189a150d408481a46f55da2d26eb22  3.0.5/rpms/php-calendar-5.2.4-1tr.i586.rpm
6bcc8fe3c839f4f0c5386dd61c3bbe2c  3.0.5/rpms/php-cli-5.2.4-1tr.i586.rpm
4c51051dde2ffdd0b5bbc17748a815fe  3.0.5/rpms/php-curl-5.2.4-1tr.i586.rpm
6fb92cef9b66f14fbfb3fc61bb2238ef  3.0.5/rpms/php-dba-5.2.4-1tr.i586.rpm
088f0cc5b60e21513fcbdb0632599f3c  3.0.5/rpms/php-devel-5.2.4-1tr.i586.rpm
9940cfef05fe6d845d046025f7ae7264  3.0.5/rpms/php-exif-5.2.4-1tr.i586.rpm
c34ba0f46cd2f68dc0f8a7e4bfa30adb  3.0.5/rpms/php-fcgi-5.2.4-1tr.i586.rpm
960e7ff904aeaf205ba7897018eb7a0b  3.0.5/rpms/php-gd-5.2.4-1tr.i586.rpm
bc62ba4aaae5fa713bb83cb95f7a3335  3.0.5/rpms/php-imap-5.2.4-1tr.i586.rpm
4a3d2980771b4f5e3e711e8a1bc0ca3b  3.0.5/rpms/php-ldap-5.2.4-1tr.i586.rpm
781bb47a50bff9418942e783128dbb68  3.0.5/rpms/php-mcrypt-5.2.4-1tr.i586.rpm
3be4aaf8607672e6f542af1a7129b8ad  3.0.5/rpms/php-mhash-5.2.4-1tr.i586.rpm
1d2638051aaf91c4a93b7f9cf8ea15a8  3.0.5/rpms/php-mssql-5.2.4-1tr.i586.rpm
a408123de53d8144b542a217be945313  3.0.5/rpms/php-mysql-5.2.4-1tr.i586.rpm
f61701b13485b2f867e7c7f2e9363a8c  3.0.5/rpms/php-mysqli-5.2.4-1tr.i586.rpm
df8f7200461d849f52efab549f699be5  3.0.5/rpms/php-openssl-5.2.4-1tr.i586.rpm
4d32d136f98f852a1b2bc79e6e58b673  3.0.5/rpms/php-pdo-mysql-5.2.4-1tr.i586.rpm
7bc079c316028edf85a028b4e3835656  3.0.5/rpms/php-pdo-sqlite-5.2.4-1tr.i586.rpm
113360c6947c651dfe48216a14f5717f  3.0.5/rpms/php-pgsql-5.2.4-1tr.i586.rpm
e5af8d602e410812f76fddf98d0f5322  3.0.5/rpms/php-pspell-5.2.4-1tr.i586.rpm
17296da5524f734e51fdb0aa48d7b109  3.0.5/rpms/php-snmp-5.2.4-1tr.i586.rpm
325aa3f7e818a3d861e1cad2c8d0f83c  3.0.5/rpms/php-sqlite-5.2.4-1tr.i586.rpm
b2bed1c8dbe4682bc0a5ee135216c4d6  3.0.5/rpms/php-xslt-5.2.4-1tr.i586.rpm
8e1aedef442e3794cdf7104fa2b46656  3.0.5/rpms/php-zlib-5.2.4-1tr.i586.rpm
521a5b05b21940c92debfc021b0d9bb3  3.0.5/rpms/rsync-2.6.9-1tr.i586.rpm
2e81625c2daf6622dd72256c17364515  3.0.5/rpms/rsync-server-2.6.9-1tr.i586.rpm
469a3f244d0da7e5efef1f8dc0afeb8a  3.0.5/rpms/tar-1.16-3tr.i586.rpm
093dc15f021eb63f64a89ac90f051a41  3.0.5/rpms/vim-7.0.241-1tr.i586.rpm
20d4a8b74c9de93d1f7f263bf3b548ee  3.0.5/rpms/vim-doc-7.0.241-1tr.i586.rpm
5101b59b27da1d851cad9116119313fa  3.0.5/rpms/vim-syntax-7.0.241-1tr.i586.rpm
7dc83045b7aa8110f3cb4849f20019d2  3.0.5/rpms/vim-tools-7.0.241-1tr.i586.rpm

cb18f9bf9ab99dfd2f3e0dccb105f678  3.0/rpms/apache-2.0.59-2tr.i586.rpm
87a36ef5f7be278d74df4a622615786f  3.0/rpms/apache-dbm-2.0.59-2tr.i586.rpm
a106a00f7dace16028dd5bb3a130a607  3.0/rpms/apache-devel-2.0.59-2tr.i586.rpm
6b8298d0d36ccfd7cf358fb1537aaba6  3.0/rpms/apache-html-2.0.59-2tr.i586.rpm
c4dccb6bfca2502904021ff21fd65af2  3.0/rpms/apache-manual-2.0.59-2tr.i586.rpm
6f3024e1c651e3b4abdeeec31bacf8d5  3.0/rpms/apache-suexec-2.0.59-2tr.i586.rpm
11e78ebce91af49bb9e636724145c2e9  3.0/rpms/clamav-0.91.2-1tr.i586.rpm
8848948e19bf2708e6414a60352e585a  3.0/rpms/clamav-devel-0.91.2-1tr.i586.rpm
331caf8b43aeaf01785e86118d875f2e  3.0/rpms/kerberos5-1.4.1-10tr.i586.rpm
610e8565c264524c07c03bec8c13e0d3  3.0/rpms/kerberos5-devel-1.4.1-10tr.i586.rpm
cc4f647aa8e366b3bda7f85e9e7e4afd  3.0/rpms/kerberos5-libs-1.4.1-10tr.i586.rpm
aba8972cd4e851f209a4a91de3fdd461  3.0/rpms/php-5.2.4-1tr.i586.rpm
5ca545194ca7c3d49209eb59470c9dc5  3.0/rpms/php-calendar-5.2.4-1tr.i586.rpm
850d110c301258797a90078b612ffe12  3.0/rpms/php-cli-5.2.4-1tr.i586.rpm
d5b2beca2ebde05c8134b978acda72b7  3.0/rpms/php-curl-5.2.4-1tr.i586.rpm
5c4a576e21ebabc9f8f4a29f5270a356  3.0/rpms/php-dba-5.2.4-1tr.i586.rpm
298669d77aed7e6c7d1d899a2896424b  3.0/rpms/php-devel-5.2.4-1tr.i586.rpm
b290449b8606ff78f7dcd6916c35941d  3.0/rpms/php-exif-5.2.4-1tr.i586.rpm
28851f7a8c0b306e50e54b84e449c2d7  3.0/rpms/php-fcgi-5.2.4-1tr.i586.rpm
72a1cf3ff7d821bae25cc695ff12a7f7  3.0/rpms/php-gd-5.2.4-1tr.i586.rpm
0d02fc26c10326b96e03d35dd54ce8e9  3.0/rpms/php-imap-5.2.4-1tr.i586.rpm
450b0aa97e665a56e0ceca442ba98858  3.0/rpms/php-ldap-5.2.4-1tr.i586.rpm
b07c77ce7b5c975ec566205188a28b88  3.0/rpms/php-mcrypt-5.2.4-1tr.i586.rpm
a3260021c0c20c4f22c1175e7011878b  3.0/rpms/php-mhash-5.2.4-1tr.i586.rpm
04068dd1fd96fa05d47421bd1b12c818  3.0/rpms/php-mssql-5.2.4-1tr.i586.rpm
47d7168adcb9ef456235565a8bb8a3c6  3.0/rpms/php-mysql-5.2.4-1tr.i586.rpm
24f6160e3ec02d86727ec77f0d3c26e8  3.0/rpms/php-mysqli-5.2.4-1tr.i586.rpm
1465471a88e798aa1e4f06766d6400c5  3.0/rpms/php-openssl-5.2.4-1tr.i586.rpm
a4ac3044ce2b2a6874fc42cf087868fc  3.0/rpms/php-pdo-mysql-5.2.4-1tr.i586.rpm
7385f884011e2d63dd7143fb8b582b7d  3.0/rpms/php-pdo-sqlite-5.2.4-1tr.i586.rpm
f5e9a219e469a13c9f5f38e7ca505955  3.0/rpms/php-pgsql-5.2.4-1tr.i586.rpm
047dab5e0d4cb4a95ea1ffaf81729dc2  3.0/rpms/php-pspell-5.2.4-1tr.i586.rpm
b8d6523e68e1e4fb48030cf8cac01517  3.0/rpms/php-snmp-5.2.4-1tr.i586.rpm
fd8300d2eea24f7249abeab38900019b  3.0/rpms/php-sqlite-5.2.4-1tr.i586.rpm
1654c76961d3b1d48a28252b152dd436  3.0/rpms/php-xslt-5.2.4-1tr.i586.rpm
aa1f63edafdd6357aa2664a1c2e89aee  3.0/rpms/php-zlib-5.2.4-1tr.i586.rpm
59aeebeeada8fc89e8ec3262fe649aeb  3.0/rpms/rsync-2.6.9-2tr.i586.rpm
4512442144fd55092baa307c1f76bc50  3.0/rpms/rsync-server-2.6.9-2tr.i586.rpm
594f9437e076be2754174ed947f3a923  3.0/rpms/tar-1.16-2tr.i586.rpm
7918c8f883533eeb6d80ec17d759b5d5  3.0/rpms/vim-7.0.241-1tr.i586.rpm
2bc2b47999fa2d8d21a14bc7d6e3a627  3.0/rpms/vim-doc-7.0.241-1tr.i586.rpm
70e2b21c0ebf490ef860bbb6818c1dc2  3.0/rpms/vim-syntax-7.0.241-1tr.i586.rpm
ef191f44282e6b44ff0429bc45865ce3  3.0/rpms/vim-tools-7.0.241-1tr.i586.rpm

2995a1b2609ad9796e5c4b1352ff2d17  2.2/rpms/apache-2.0.59-2tr.i586.rpm
57cbdb859516564e2f725cb17a875f12  2.2/rpms/apache-dbm-2.0.59-2tr.i586.rpm
52f083b7aa7cfaf2e265b2459d61ca92  2.2/rpms/apache-devel-2.0.59-2tr.i586.rpm
024d9e48529dfd1fef4fecfb644b1df6  2.2/rpms/apache-html-2.0.59-2tr.i586.rpm
4d573dc062d3ab7dd89bdd9ed9e8600d  2.2/rpms/apache-manual-2.0.59-2tr.i586.rpm
deda7edcd8a0a40933f3e531b0860649  2.2/rpms/apache-suexec-2.0.59-2tr.i586.rpm
43331ea3abcb7bab2864bc03e8244b00  2.2/rpms/clamav-0.91.2-1tr.i586.rpm
64cea04effad000ce913819b09f7e3c1  2.2/rpms/clamav-devel-0.91.2-1tr.i586.rpm
1de0b8a9caca11562699938b9392fc3d  2.2/rpms/php-5.2.4-1tr.i586.rpm
768104d896847cc2ee881ff7b5d2a718  2.2/rpms/php-cli-5.2.4-1tr.i586.rpm
12bfa64fbd7aa7668ca9a6bcc9aaccf5  2.2/rpms/php-curl-5.2.4-1tr.i586.rpm
a0074bad3eb9beb67d0badb552c0bcbe  2.2/rpms/php-devel-5.2.4-1tr.i586.rpm
8b332938eadcc8018617e5e39b52a3ae  2.2/rpms/php-exif-5.2.4-1tr.i586.rpm
a64986b681db85e9f85b881030c27323  2.2/rpms/php-fcgi-5.2.4-1tr.i586.rpm
381af5e5092805200703e490551698c3  2.2/rpms/php-gd-5.2.4-1tr.i586.rpm
3e9e6a940b75360dc993de4928e04ba3  2.2/rpms/php-imap-5.2.4-1tr.i586.rpm
a91b16f3e14895f5f4581551f1ac28bc  2.2/rpms/php-ldap-5.2.4-1tr.i586.rpm
76836871810dd6526bff144440fd6460  2.2/rpms/php-mcrypt-5.2.4-1tr.i586.rpm
9ed9897df8e2f7e439d5c15f5b30c633  2.2/rpms/php-mhash-5.2.4-1tr.i586.rpm
fdb4239aebaeee1cb77bd05e19740b5c  2.2/rpms/php-mssql-5.2.4-1tr.i586.rpm
a87710fae7f6bd4a730714e2ce900db5  2.2/rpms/php-mysql-5.2.4-1tr.i586.rpm
7034fc78dc51fabeec88d755e9ae5e0e  2.2/rpms/php-mysqli-5.2.4-1tr.i586.rpm
0642e4cf71221b51e802d953bf1e5fad  2.2/rpms/php-openssl-5.2.4-1tr.i586.rpm
5db5f044a4becd35e75e540967111824  2.2/rpms/php-pdo-mysql-5.2.4-1tr.i586.rpm
778b86af596af6997c857f25f06b3ac5  2.2/rpms/php-pdo-sqlite-5.2.4-1tr.i586.rpm
683d6168d6333ce1a02f2fc9ad5f7a9b  2.2/rpms/php-pgsql-5.2.4-1tr.i586.rpm
341f13a32989398a4cea0fcb092f8482  2.2/rpms/php-sqlite-5.2.4-1tr.i586.rpm
852c5d906b425b110bd000bcfde843f4  2.2/rpms/php-zlib-5.2.4-1tr.i586.rpm
a42e364d9d1fa1469fabe336fe387c66  2.2/rpms/rsync-2.6.9-1tr.i586.rpm
8cd7d5223e4920c28ab25d1f1d6a837a  2.2/rpms/rsync-server-2.6.9-1tr.i586.rpm
5e2bdd39c515aa03882412482d27068e  2.2/rpms/tar-1.16-2tr.i586.rpm
6df16fe1b5fbabde69867a1e508c678f  2.2/rpms/vim-6.4.009-3tr.i586.rpm
f9c94bd758cd72309402b07533d588d9  2.2/rpms/vim-doc-6.4.009-3tr.i586.rpm
fccda6ba42401eb79e95dcd9bc65aa6c  2.2/rpms/vim-syntax-6.4.009-3tr.i586.rpm
61ec075caf4c29a4884b717a850362da  2.2/rpms/vim-tools-6.4.009-3tr.i586.rpm
- --------------------------------------------------------------------------


Trustix Security Team


-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.6 (GNU/Linux)

iD8DBQFG7pDri8CEzsK9IksRAkcGAJ9KqCAN/kS5igAieSvZ8AZ946omWgCgg9Sn
HZqOi+Is+nCsvf9iVQKe8QA=
=npjz
-----END PGP SIGNATURE-----
