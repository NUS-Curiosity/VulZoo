
Date: Wed, 13 Feb 2019 16:08:22 -0500
From: David Coomber <davidcoomber.infosec@...il.com>
To: bugtraq@...urityfocus.com
Subject: Qkr! with MasterPass iOS Application - MITM SSL Certificate
 Vulnerability (CVE-2019-6702)

Qkr! with MasterPass iOS Application - MITM SSL Certificate
Vulnerability (CVE-2019-6702)
--
https://www.info-sec.ca/advisories/Qkr-MasterCard.html

Overview

"Qkr! with MasterPass is the secure and easy way to order and pay for
food and drinks from you iOS device.

With Qkr you can:

• Discover Qkr merchants nearby.
• Pre-order: Guests can order off the menu and pay ahead of time, then
collect their order from a pick-up point or have it delivered to their
seat or table
• Create a free MasterPass account: Qkr uses MasterPass, MasterCard’s
secure digital wallet solution that accepts MasterCard, Visa, American
Express and Discover Cards. The Apple Pay checkout option is coming
later this year
• Access your eReceipts: you can easily review your Qkr order history
in the app or from emailed receipts.

Qkr is brought to you by MasterCard who processes 65,000 secure
transactions a minute so you know that your transaction is safe. No
card data is stored on your phone."

(https://itunes.apple.com/us/app/qkr-with-masterpass/id589799471)

Issue

The Qkr! with MasterPass iOS application (version 5.0.6 and below),
does not validate the SSL certificate it receives when connecting to
the application login server.

Impact

An attacker who can perform a man in the middle attack may present a
bogus SSL certificate which the application will accept silently.
Sensitive information could be captured by an attacker without the
user's knowledge.

Timeline

October 26, 2016 - Notified MasterCard via security@...tercard.com
November 1, 2016 - Asked MasterCard to confirm that they received the
vulnerability details
November 1, 2016 - MasterCard confirmed that they received the report
and provided it to the Qkr! team for remediation
December 9, 2016 - Asked MasterCard if they have a release date for
the new version
January 2, 2017 - Advised MasterCard that the version released on
December 19th (5.0.8) resolves the issue
February 4, 2019 - Published an advisory to document the issue

Solution

Upgrade to version 5.0.8 or later

Acknowledgements

Thanks to the MasterCard Security team for their timely response
