
Date: Wed, 16 Dec 2015 19:25:06 +0100
From: "Securify B.V." <lists@...urify.nl>
To: bugtraq@...urityfocus.com
Subject: Shutdown UX DLL side loading vulnerability

------------------------------------------------------------------------
Shutdown UX DLL side loading vulnerability
------------------------------------------------------------------------
Yorick Koster, November 2015

------------------------------------------------------------------------
Abstract
------------------------------------------------------------------------
A DLL side loading vulnerability was found in the Shutdown UX DLL. This
issue can be exploited by loading the Authentication UI Shutdown Choices
object as an embedded OLE object. When instantiating the object Windows
will try to load the DLL wuaext.dll from the current working directory.
If an attacker convinces the user to open a specially crafted (Office)
document from a directory also containing the attacker's DLL file, it is
possible to execute arbitrary code with the privileges of the target
user. This can potentially result in the attacker taking complete
control of the affected system.

------------------------------------------------------------------------
See also
------------------------------------------------------------------------
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-6128
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-6132
https://technet.microsoft.com/library/security/MS15-132
https://securify.nl/blog/SFY20151201/there_s_a_party_in_ole__and_you_are_invited.html

------------------------------------------------------------------------
Tested versions
------------------------------------------------------------------------
This issue was successfully verified on Windows 10 + Office 2016 64-bit.

------------------------------------------------------------------------
Fix
------------------------------------------------------------------------
Microsoft released MS15-132 [4] that fixes this vulnerability.

------------------------------------------------------------------------
Details
------------------------------------------------------------------------
https://www.securify.nl/advisory/SFY20151102/shutdown_ux_dll_side_loading_vulnerability.html
