
Date: Thu, 07 Feb 2008 18:00:10 -0500
From: iDefense Labs <labs-no-reply@...fense.com>
To: vulnwatch@...nwatch.org, full-disclosure@...ts.grok.org.uk,
	bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 02.07.08: IBM DB2 Universal Database Administration
 Server Memory Corruption Vulnerability

iDefense Security Advisory 02.07.08
http://labs.idefense.com/intelligence/vulnerabilities/
Feb 07, 2008

I. BACKGROUND

IBM Corp.'s DB2 Universal Database product is a large database server
product commonly used for high end databases. The DB2 Administration
Server (DAS) provides functionality that implements the Java-based DB2
Control Center GUI. For more information, visit IBM's DB2 product site
at the following URL.

http://ibm.com/db2/

II. DESCRIPTION

Remote exploitation of a memory corruption vulnerability within version
9.1 of IBM Corp.'s DB2 Universal Database Administration Server (DAS)
allows attackers to crash the service or potentially execute arbitrary
code in the context of the affected service.

When handling certain remote administration requests, the Administration
Server uses a 32-bit pointer value supplied by the remote client. By
supplying carefully chosen address values, an attacker can cause memory
corruption or force the program to access invalid memory locations.

III. ANALYSIS

Exploitation allows attackers to crash the service or execute arbitrary
code within the context of the affected service. No authentication
credentials are required. The attacker only needs the ability to
establish a TCP session with the DAS on TCP port 523.

By default this service runs as "dasusr1" on Linux and "db2admin" on
Windows. In the Linux version of the DAS, the process is monitored by a
fault monitoring process and will restart automatically after a few
seconds. This monitoring process does not exist in the Windows version.

IV. DETECTION

iDefense has confirmed the existence of this vulnerability in the DAS
(db2dassrm) as included with DB2 9.1 with Fix Pack 2 for both Linux and
Windows platforms. Previous versions, as well as builds for other
platforms, are suspected to be vulnerable.

V. WORKAROUND

Employing firewalls to limit access to the affected service will
mitigate exposure to this vulnerability.

VI. VENDOR RESPONSE

IBM Corp. has addressed these vulnerabilities by releasing V9 Fix Pack 4
and V8 FixPak 16 of its Universal Database product. More information can
be found at the following URLs.

V8: http://www-1.ibm.com/support/docview.wss?uid=swg21256235
V9: http://www-1.ibm.com/support/docview.wss?uid=swg21255572

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2007-3676 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org/), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

06/18/2007  Initial vendor notification
06/20/2007  Initial vendor response
08/14/2007  V8 Fix Pack 15 made available
08/15/2007  V9 Fix Pack 3 made available
10/10/2007  V9 Fix Pack 3a made available
11/13/2007  V9 Fix Pack 4 made available
01/28/2008  V8 Fix Pack 16 made available
02/05/2008  V8 Fix Pack 16 fix list made available
02/07/2008  Public disclosure

IX. CREDIT

The discoverer of this vulnerability wishes to remain anonymous.

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2008 iDefense, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDefense. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically,
please e-mail customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
 There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct,
indirect, or consequential loss or damage arising from use of, or
reliance on, this information.
