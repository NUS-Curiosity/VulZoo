
Date: Mon, 21 Jan 2013 16:29:53 GMT
From: security_alert@....com
To: bugtraq@...urityfocus.com
Subject: Re: EMC Avamar: World writable cache files

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

ESA-2013-003: EMC Avamar Client Elevation of Privilege Vulnerability

EMC Identifier: ESA-2013-003

CVE Identifier: CVE-2012-2291



Severity Rating: CVSS v2 Base Score: 6.8 (AV:L/AC:L/Au:S/C:C/I:C/A:C)



Affected Products:


EMC Avamar HP-UX Client 4.x, 5.x and 6.x
EMC Avamar Mac OS Client 4.x, 5.x and 6.x
EMC Avamar Plugin for Oracle 4.x, 5.x and 6.x

Note: Other Linux and Unix Avamar client systems could also be affected as a result of a support or locally-performed procedure that incorrectly sets the permission of the Avamar var directory (/usr/local/avamar/var or /opt/AVMRclnt/var).


Summary:  

Due to a vulnerability, described in detail below, the Avamar client leaves certain directories and files as world writable.  The presence of world writable directories and files may inadvertently result in elevation of privileges by a user who has access to the local file system. 


Details:  

The Avamar affected client process runs as root and after each backup it leaves the cache files as world readable and writable. While the cache files themselves do not contain sensitive information, when the parent directory is world-writable, the cache files could be used by an attacker to elevate the privileges when a system-level backup is performed.  The non-root user can create symbolic links to obtain unauthorized access to files on the affected system.

Note: This vulnerability information is currently public. EMC is not aware of any instance in which the vulnerability has been exploited maliciously.


Resolution:  

The following workaround steps must be performed to mitigate the risk until the full fix is available from EMC.

For HP-UX clients:
The permissions of the /opt/AVMRclnt/var directory should be set to 0755. 
Log into the HP-UX client as the �root� user and type the following command:
chmod 0755 /opt/AVMRclnt/var

For Mac OS clients:
The permissions of the /var/avamar directory should be set to 0755. 
Log into the Mac client as the �root� user and type the following command:
chmod 0755 /var/avamar

For Oracle clients:
The following procedure only applies to clients where the directory permissions of the Avamar var directory (/usr/local/avamar/var or /opt/AVMRclnt/var) have been manually changed after installation of the Avamar plugin for Oracle:
The permissions of the /usr/local/avamar/var should be set to 0775 with the group ownership set to the oracle group. Log into the Oracle client as the �root� user and type either of the following pairs of commands:

On Linux and Unix Oracle clients other than Solaris and HP-UX:

chmod 0775 /usr/local/avamar/var
chgrp oracle /usr/local/avamar/var

On Solaris and HP-UX Oracle clients:

chmod 0775 /opt/AVMRclnt/var
chgrp oracle /opt/AVMRclnt/var

Other Avamar clients:

Verify that the permissions of the Avamar var directory (/usr/local/avamar/var or /opt/AVMRclnt/var) on Linux and Unix clients are not modified as a result of a support or locally-performed procedure. The permissions should be set to 0755.


If you have any questions or concerns about running the above commands please contact EMC Technical Support at http://www.emc.com/contact.



Read and use the information in this EMC Security Advisory to assist in avoiding any situation that might arise from the problems described herein. If you have any questions regarding this product alert, contact EMC Software Technical Support at 1-877-534-2867.

Because the view is restricted based on customer agreements, you may not have permission to view certain downloads. Should you not see a software download you believe you should have access to, follow the instructions in EMC Knowledgebase solution emc116045.

For an explanation of Severity Ratings, refer to EMC Knowledgebase solution emc218831. EMC recommends all customers take into account both the base score and any relevant temporal and environmental scores which may impact the potential severity associated with particular security vulnerability.

EMC Corporation distributes EMC Security Advisories, in order to bring to the attention of users of the affected EMC products, important security information. EMC recommends that all users determine the applicability of this information to their individual situations and take appropriate action. The information set forth herein is provided "as is" without warranty of any kind. EMC disclaims all warranties, either express or implied, including the warranties of merchantability, fitness for a particular purpose, title and non-infringement. In no event, shall EMC or its suppliers, be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if EMC or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages, so the foregoing limitation may not apply.

EMC Product Security Response Center

Security_Alert@....COM

http://www.emc.com/contact-us/contact/product-security-response-center.html 
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (Cygwin)

iEYEARECAAYFAlD5pCUACgkQtjd2rKp+ALwMFACgnLq53HoHUZp9b+oWbL1Z6RHq
ZakAnjedCQIEXto4r6dgCALoSkWBOQm5
=gIkA
-----END PGP SIGNATURE-----
