
Date: Wed, 16 Oct 2013 12:04:26 +0200 (CEST)
From: High-Tech Bridge Security Research <advisory@...ridge.com>
To: bugtraq@...urityfocus.com
Subject: Remote Code Execution in Microweber

Advisory ID: HTB23175
Product: Microweber
Vendor: Microweber
Vulnerable Version(s): 0.8 and probably prior
Tested Version: 0.8
Advisory Publication:  September 25, 2013  [without technical details]
Vendor Notification: September 25, 2013 
Vendor Patch: September 26, 2013 
Public Disclosure: October 16, 2013 
Vulnerability Type: Improper Access Control [CWE-284]
CVE Reference: CVE-2013-5984
Risk Level: Critical 
CVSSv2 Base Score: 10 (AV:N/AC:L/Au:N/C:C/I:C/A:C)
Solution Status: Fixed by Vendor
Discovered and Provided: High-Tech Bridge Security Research Lab ( https://www.htbridge.com/advisory/ ) 

-----------------------------------------------------------------------------------------------

Advisory Details:

High-Tech Bridge Security Research Lab discovered vulnerability in Microweber, which can be exploited to delete arbitrary files and compromise vulnerable system as a consequence.


1) Improper Access Control in Microweber: CVE-2013-5984

Vulnerability exists due to improper access restriction to "/userfiles/modules/admin/backup/delete.php" script and insufficient validation of user-supplied input passed via "file" HTTP GET parameter. 

A remote unauthenticated attacker can delete arbitrary files on the target system with privileges of the web server using directory traversal sequences and NULL byte. 

The exploitation example below deletes the application's configuration file "config.php":
http://[host]/userfiles/modules/admin/backup/delete.php?file=../../../../../config.php%00

After deletion of the "config.php" file the application will suggest to re-install it from scratch when accessing "/index.php" file. Further exploitation of this vulnerability allows the attacker to reinstall the application and get full administrative access to it. 

After successful re-installation the attacker can use "Admin Console" module of the application to execute arbitrary PHP code on the target system. 

Simple exploit below displays output of "phpinfo()" PHP function after successful re-installation of application:

POST /module/ HTTP/1.1

module=admin%2Fconsole%2Fterm&data-type=admin%2Fconsole%2Fterm&id=mw_exec_term_command&class=+module++&exec_command=cGhwaW5mbw==&exec_command_params=MQ%3D%3D


-----------------------------------------------------------------------------------------------

Solution:

Update to Microweber version 0.830

More Information:
https://github.com/microweber/microweber/commit/9177d134960c24cb642d5cf3b42a1fba286219cc

-----------------------------------------------------------------------------------------------

References:

[1] High-Tech Bridge Advisory HTB23175 - https://www.htbridge.com/advisory/HTB23175 - Remote Code Execution in Microweber.
[2] Microweber - http://microweber.com - Microweber is free drag and drop cms and website builder.
[3] Common Vulnerabilities and Exposures (CVE) - http://cve.mitre.org/ - international in scope and free for public use, CVE® is a dictionary of publicly known information security vulnerabilities and exposures.
[4] Common Weakness Enumeration (CWE) - http://cwe.mitre.org - targeted to developers and security practitioners, CWE is a formal list of software weakness types.
[5] ImmuniWeb® - http://www.htbridge.com/immuniweb/ - is High-Tech Bridge's proprietary web application security assessment solution with SaaS delivery model that combines manual and automated vulnerability testing.

-----------------------------------------------------------------------------------------------

Disclaimer: The information provided in this Advisory is provided "as is" and without any warranty of any kind. Details of this Advisory may be updated in order to provide as accurate information as possible. The latest version of the Advisory is available on web page [1] in the References.

