
Date: Tue, 19 Mar 2013 10:18:40 +0100
From: VUPEN Security Research <advisories@...en.com>
To: bugtraq@...urityfocus.com
Subject: VUPEN Security Research - Mozilla Firefox "nsHTMLEditRules" Use-After-Free
 (MFSA-2013-29 / CVE-2013-0787)

VUPEN Security Research - Mozilla Firefox "nsHTMLEditRules"
Use-After-Free (MFSA-2013-29 / CVE-2013-0787)

Website : http://www.vupen.com

Twitter : http://twitter.com/vupen


I. BACKGROUND
---------------------

Mozilla Firefox is a free and open source web browser coordinated by
Mozilla Corporation and Mozilla Foundation. As of August 2012, Firefox
has approximately 23% of worldwide usage share of web browsers (Wikipedia)


II. DESCRIPTION
---------------------

VUPEN Vulnerability Research Team discovered a critical vulnerability
in Mozilla Firefox.

The vulnerability is caused by a use-after-free error within the XUL
"nsHTMLEditRules::nsHTMLEditRules()" function when processing certain
objects, which could be exploited by remote attackers to compromise
a vulnerable system via a malicious web page.

The vulnerability has been exploited during Pwn2Own 2013.


III. AFFECTED PRODUCTS
---------------------------

Mozilla Firefox version 19.0.1 and prior
Mozilla Firefox ESR version 17.0.3 and prior
Mozilla Thunderbird version 17.0.3 and prior
Mozilla Thunderbird ESR version 17.0.3 and prior
Mozilla SeaMonkey version 2.16 and prior


IV. Binary Analysis & Exploits/PoCs
---------------------------------------

In-depth technical analysis of the vulnerability and a fully functional
remote code execution exploit are available through the VUPEN BAE
(Binary Analysis & Exploits) portal:

http://www.vupen.com/english/services/ba-index.php

VUPEN Binary Analysis & Exploits Service provides private exploits and
in-depth technical analysis of the most significant public vulnerabilities
based on disassembly, reverse engineering, protocol analysis, and code
audit.

The service allows governments and major corporations to evaluate risks, and
protect infrastructures and assets against new threats. The service also
allows security vendors (IPS, IDS, AntiVirus) to supplement their internal
research efforts and quickly develop both vulnerability-based and
exploit-based signatures to proactively protect their customers from attacks
and emerging threats.


V. VUPEN Threat Protection Program
-----------------------------------

Governments and major corporations which are members of the VUPEN Threat
Protection Program (TPP) have been proactively alerted about the
vulnerability
when it was discovered by VUPEN in advance of its public disclosure, and
have received a detailed attack detection guidance to protect national and
critical infrastructures against potential 0-day attacks exploiting this
vulnerability:

http://www.vupen.com/english/services/tpp-index.php


VI. SOLUTION
----------------

Upgrade to the following versions:

Firefox 19.0.2 or later
Firefox ESR 17.0.4 or later
Thunderbird 17.0.4 or later
Thunderbird ESR 17.0.4 or later
SeaMonkey 2.16.1 or later


VII. CREDIT
--------------

This vulnerability was discovered and exploited by Chaouki Bekrar, Jordan
Gruskovnjak, and Nicolas Joly of VUPEN Security


VIII. ABOUT VUPEN Security
---------------------------

VUPEN is the leading provider of defensive and offensive cybersecurity
intelligence and advanced vulnerability research. VUPEN solutions enable
corporations and governments to manage risks, and protect critical networks
and infrastructures against known and unknown vulnerabilities.

VUPEN solutions include:

* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php

* VUPEN Threat Protection Program (TPP) :
http://www.vupen.com/english/services/tpp-index.php


IX. REFERENCES
----------------------

https://www.mozilla.org/security/announce/2013/mfsa2013-29.html
http://www.vupen.com/english/research.php


X. DISCLOSURE TIMELINE
-----------------------------

2013-02-26 - Vulnerability Discovered by VUPEN
2013-03-06 - Vulnerability Reported to Mozilla by VUPEN During Pwn2Own 2013
2013-03-07 - MFSA-2013-29 security bulletin released
2013-03-18 - Public disclosure

