
Date: 13 Oct 2006 21:02:39 -0000
From: research@...antec.com
To: bugtraq@...urityfocus.com
Subject: SYMSA-2006-010: Directory Traversal in IronWebMail

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1



                   Symantec Vulnerability Research
                   http://www.symantec.com/research
                         Security Advisory

   Advisory ID: SYMSA-2006-010
Advisory Title: Directory Traversal in IronWebMail
        Author: Derek Callaway
  Release Date: 16-10-2006
   Application: IronWebMail(tm)
      Platform: IronMail appliance, FreeBSD 4.10 / IA-32
      Severity: Remotely exploitable/ database credential retrieval
 Vendor status: Verified by vendor. Resolved in IronMail 6.1.1 HotFix-17
    CVE Number: CVE-2006-5210
     Reference: http://www.securityfocus.com/bid/20436


Overview: 

IronMail is an Internet e-mail security appliance marketed by
CipherTrust, Inc. a company specializing in messaging security.
IronMail's features include anti-spam mechanisms, zero day anti-virus
protection, intrusion prevention techniques, and a Secure WebMail
component. Secure WebMail implements Single Sign-On and integrates
RSA SecurID; it operates in conjunction with the IronWebMail HTTPS
server.


Details: 

The web server under IronWebMail employes a simple macro language
for evaluating pathname references. A loss of confidentiality occurs
as a result of faulty pathname evaluation, causing unauthenticated
access violation.

After a connection to TCP port 443 has been accepted and an SSL
session has been negotiated, a specially crafted HTTP GET request is
sent. An exploit request contains the IM_FILE identifier that can be
gleaned from the HTML source of the main IronWebMail login page:

GET /IM_FILE(.) HTTP/1.0[CRLF][CRLF]
[Current Working Directory Data Received From Web Server..]

A request for the current working directory was made using custom
IronWebMail server pathname syntax. The returned response payload
is the byte-wise representation of the web root directory. This is
the base case; other directories can be viewed as well as file
contents. For example:

GET /IM_FILE(%252e%252e/%252e%252e/%252e%252e) HTTP/1.0[CRLF][CRLF]
[Directory Data for Great-Grandparent of CWD..]

This request will display the contents of the ufs directory three-levels
up from the current working directory of the web server process.
Although literal pathnames can be provided, doubly encoding the file
location with URI ASCII escaping allows for deeper directory traversals.

This technique can be used to retrieve any file or directory accessible
by the web server process. An attacker with novice programming skills
is capable of writing a script to automate remote file system
reconnaissance by taking advantage of this issue.


Vendor Response:

The above vulnerability is fixed and applicable to the following
versions:
- - - -IronMail 6.1.1  HotFix-17
      Please download this HotFix to patch the specified Version.

- - - -IronMail 5.0.1
      Please Upgrade your device to Version 6.1.1 and install the
      appropriate HotFix to resolve this issue.
 
Customers who have prior versions of IronMail are requested to
upgrade to 6.1.1 version.  Please visit Support Center on this
issue or follow the following link:
 
https://supportcenter.ciphertrust.com/vulnerability/IWM501-01.html
 
Please note that this applies to only customers that have IronWebMail
Enabled under the specified versions.
 

Recommendation:

Upgrade to IronMail 6.1.1 HotFix-17 to address this issue.


Common Vulnerabilities and Exposures (CVE) Information:

The Common Vulnerabilities and Exposures (CVE) project has assigned the
following names to these issues.  These are candidates for inclusion in
the CVE list (http://cve.mitre.org), which standardizes names for security
problems.


  CVE-2006-5210 Requested

- - - -------Symantec Vulnerability Research Advisory Information-------

For questions about this advisory, or to report an error:
research@...antec.com

For details on Symantec's Vulnerability Reporting Policy:
http://www.symantec.com/research/Symantec-Responsible-Disclosure.pdf

Symantec Vulnerability Research Advisory Archive:
http://www.symantec.com/research/

Symantec Vulnerability Research GPG Key:
http://www.symantec.com/research/Symantec_Vulnerability_Research_GPG.asc

- - - -------------Symantec Product Advisory Information-------------

To Report a Security Vulnerability in a Symantec Product:
secure@...antec.com 

For general information on Symantec's Product Vulnerability
reporting and response:
http://www.symantec.com/security/

Symantec Product Advisory Archive:
http://www.symantec.com/avcenter/security/SymantecAdvisories.html

Symantec Product Advisory PGP Key:
http://www.symantec.com/security/Symantec-Vulnerability-Management-Key.asc

- - - ---------------------------------------------------------------

Copyright (c) 2006 by Symantec Corp.
Permission to redistribute this alert electronically is granted
as long as it is not edited in any way unless authorized by
Symantec Consulting Services. Reprinting the whole or part of
this alert in any medium other than electronically requires
permission from cs_advisories@...antec.com.

Disclaimer
The information in the advisory is believed to be accurate at the
time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS
condition. There are no warranties with regard to this information.
Neither the author nor the publisher accepts any liability for any
direct, indirect, or consequential loss or damage arising from use
of, or reliance on, this information.

Symantec, Symantec products, and Symantec Consulting Services are
registered trademarks of Symantec Corp. and/or affiliated companies
in the United States and other countries. All other registered and
unregistered trademarks represented in this document are the sole
property of their respective companies/owners.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.2.2 (GNU/Linux)

iD8DBQFFL/8Muk7IIFI45IARAoV4AJwIuLq3SNw4qQ+Y+tydi2XQK+Wq+QCZAe8X
e0Mbm3+ua5PdURAmS1quM5A=
=dON4
-----END PGP SIGNATURE-----
