
Date: Mon, 30 Oct 2006 19:02:46 +0100
From: Raphael Marichez <falco@...too.org>
To: gentoo-announce@...too.org
Cc: bugtraq@...urityfocus.com, full-disclosure@...ts.grok.org.uk,
	security-alerts@...uxsecurity.com
Subject: [ GLSA 200610-15 ] Asterisk: Multiple vulnerabilities

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Gentoo Linux Security Advisory                           GLSA 200610-15
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
                                            http://security.gentoo.org/
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  Severity: High
     Title: Asterisk: Multiple vulnerabilities
      Date: October 30, 2006
      Bugs: #144941, #151881
        ID: 200610-15

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Synopsis
========

Asterisk is vulnerable to the remote execution of arbitrary code or a
Denial of Service.

Background
==========

Asterisk is an open source implementation of a telephone private branch
exchange (PBX).

Affected packages
=================

    -------------------------------------------------------------------
     Package            /  Vulnerable  /                    Unaffected
    -------------------------------------------------------------------
  1  net-misc/asterisk      < 1.2.13                         >= 1.2.13

Description
===========

Asterisk contains buffer overflows in channels/chan_mgcp.c from the
MGCP driver and in channels/chan_skinny.c from the Skinny channel
driver for Cisco SCCP phones. It also dangerously handles
client-controlled variables to determine filenames in the Record()
function. Finally, the SIP channel driver in channels/chan_sip.c could
use more resources than necessary under unspecified circumstances.

Impact
======

A remote attacker could execute arbitrary code by sending a crafted
audit endpoint (AUEP) response, by sending an overly large Skinny
packet even before authentication, or by making use of format strings
specifiers through the client-controlled variables. An attacker could
also cause a Denial of Service by resource consumption through the SIP
channel driver.

Workaround
==========

There is no known workaround for the format strings vulnerability at
this time. You can comment the lines in /etc/asterisk/mgcp.conf,
/etc/asterisk/skinny.conf and /etc/asterisk/sip.conf to deactivate the
three vulnerable channel drivers. Please note that the MGCP channel
driver is disabled by default.

Resolution
==========

All Asterisk users should upgrade to the latest version:

    # emerge --sync
    # emerge --ask --oneshot --verbose ">=net-misc/asterisk-1.2.13"

References
==========

  [ 1 ] CVE-2006-4345
        http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-4345
  [ 2 ] CVE-2006-4346
        http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-4346
  [ 3 ] CVE-2006-5444
        http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5444
  [ 4 ] CVE-2006-5445
        http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5445

Availability
============

This GLSA and any updates to it are available for viewing at
the Gentoo Security Website:

  http://security.gentoo.org/glsa/glsa-200610-15.xml

Concerns?
=========

Security is a primary focus of Gentoo Linux and ensuring the
confidentiality and security of our users machines is of utmost
importance to us. Any security concerns should be addressed to
security@...too.org or alternatively, you may file a bug at
http://bugs.gentoo.org.

License
=======

Copyright 2006 Gentoo Foundation, Inc; referenced text
belongs to its owner(s).

The contents of this document are licensed under the
Creative Commons - Attribution / Share Alike license.

http://creativecommons.org/licenses/by-sa/2.5

Content of type "application/pgp-signature" skipped
