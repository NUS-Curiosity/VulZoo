
Date: Mon, 25 Sep 2006 17:51:46 -0400
From: iDefense Labs <labs-no-reply@...fense.com>
To: bugtraq@...urityfocus.com, vulnwatch@...nwatch.org,
	full-disclosure@...ts.grok.org.uk
Subject: iDefense Security Advisory 09.23.06: FreeBSD i386_set_ldt Integer
 Overflow Vulnerability

FreeBSD i386_set_ldt Integer Overflow Vulnerability

iDefense Security Advisory 09.23.06
http://www.idefense.com/intelligence/vulnerabilities/
Sep 23, 2006

I. BACKGROUND

FreeBSD is a modern operating system for x86, amd64, Alpha, IA-64, PC-98
and SPARC architectures. It's based on the UNIX operating system, BSD,
which was created at the University of California, Berkeley.  More
information can be obtained from the FreeBSD Project web site at
http://www.FreeBSD.org/

II. DESCRIPTION

Local exploitation of a input validation error in the FreeBSD Project's
i386_set_ldt() kernel implementation could allow attackers to create a
kernel panic, leading to a denial of service condition on the affected
computer.

III. ANALYSIS

Exploitation of this vulnerability would result in a denial of service
condition on the affected host.  There is a potential for arbitrary code
execution in kernel context due to the way this function manipulates
kernel heap memory. 

IV. DETECTION

iDefense has confirmed the existence of this problem in FreeBSD 5.5. It
is suspected that versions as early as 5.2 are also affected.

V. WORKAROUND

iDefense is not aware of any workaround for this issue.

VI. VENDOR RESPONSE

"It appears that the problem you have discovered was fixed in revision
1.96 of src/sys/i386/i386/sys_machdep.c on March 23, 2005, after being
found by the Coverity Prevent analysis tool; the commit message at the
time documented this as a local denial of service bug.

The policy of the FreeBSD Security Team is that local denial of service bugs
not be treated as security issues; it is possible that this problem will be
corrected in a future Erratum."

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2006-4172 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

08/16/2006  Initial vendor notification
08/16/2006  Initial vendor response
09/23/2006  Public disclosure

IX. CREDIT

The discoverer of this vulnerability wishes to remain anonymous.

Get paid for vulnerability research
http://www.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2006 iDefense, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDefense. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically, please
email customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.

