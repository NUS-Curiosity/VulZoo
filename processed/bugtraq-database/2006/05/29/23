
Date: Mon, 29 May 2006 21:29:19 +0200
From: Moritz Muehlenhoff <jmm@...ian.org>
To: bugtraq@...urityfocus.com
Subject: [SECURITY] [DSA 1082-1] New Linux kernel 2.4.17 packages fix several vulnerabilities


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- --------------------------------------------------------------------------
Debian Security Advisory DSA 1082-1                    security@...ian.org
http://www.debian.org/security/               Martin Schulze, Dann Frazier
May 29th, 2006                          http://www.debian.org/security/faq
- --------------------------------------------------------------------------

Package        : kernel-image-2.4.17-hppa kernel-image-2.4.17-ia64 kernel-image-2.4.17-s390 kernel-patch-2.4.17-apus kernel-patch-2.4.17-mips kernel-patch-2.4.17-s390 kernel-source-2.4.17
Vulnerability  : several
Problem-Type   : local/remote
Debian-specific: no
CVE IDs        : CVE-2004-0427 CVE-2005-0489 CVE-2004-0394 CVE-2004-0447 CVE-2004-0554 CVE-2004-0565 CVE-2004-0685  CVE-2005-0001 CVE-2004-0883 CVE-2004-0949 CVE-2004-1016 CVE-2004-1333 CVE-2004-0997 CVE-2004-1335 CVE-2004-1017 CVE-2005-0124 CVE-2005-0528 CVE-2003-0984 CVE-2004-1070 CVE-2004-1071 CVE-2004-1072 CVE-2004-1073 CVE-2004-1074 CVE-2004-0138 CVE-2004-1068 CVE-2004-1234 CVE-2005-0003 CVE-2004-1235 CVE-2005-0504 CVE-2005-0384 CVE-2005-0135

Several local and remote vulnerabilities have been discovered in the Linux
kernel that may lead to a denial of service or the execution of arbitrary
code. The Common Vulnerabilities and Exposures project identifies the
following problems:


 CVE-2004-0427

     A local denial of service vulnerability in do_fork() has been found.     

 CVE-2005-0489

     A local denial of service vulnerability in proc memory handling has
     been found.

 CVE-2004-0394

     A buffer overflow in the panic handling code has been found.

 CVE-2004-0447

     A local denial of service vulnerability through a null pointer
     dereference in the IA64 process handling code has been found.

 CVE-2004-0554

     A local denial of service vulnerability through an infinite loop in
     the signal handler code has been found.

 CVE-2004-0565

     An information leak in the context switch code has been found on
     the IA64 architecture.

 CVE-2004-0685

     Unsafe use of copy_to_user in USB drivers may disclose sensitive
     information.

 CVE-2005-0001

     A race condition in the i386 page fault handler may allow privilege
     escalation.

 CVE-2004-0883

     Multiple vulnerabilities in the SMB filesystem code may allow denial
     of service of information disclosure.

 CVE-2004-0949

     An information leak discovered in the SMB filesystem code.

 CVE-2004-1016

     A local denial of service vulnerability has been found in the SCM layer.

 CVE-2004-1333

     An integer overflow in the terminal code may allow a local denial of
     service vulnerability.

 CVE-2004-0997

     A local privilege escalation in the MIPS assembly code has been found.
 
 CVE-2004-1335
 
     A memory leak in the ip_options_get() function may lead to denial of
     service.
      
 CVE-2004-1017

     Multiple overflows exist in the io_edgeport driver which might be usable
     as a denial of service attack vector.
 
 CVE-2005-0124

     Bryan Fulton reported a bounds checking bug in the coda_pioctl function
     which may allow local users to execute arbitrary code or trigger a denial
     of service attack.

 CVE-2005-0528

     A local privilege escalation in the mremap function has been found

 CVE-2003-0984

     Inproper initialization of the RTC may disclose information.

 CVE-2004-1070

     Insufficient input sanitising in the load_elf_binary() function may
     lead to privilege escalation.

 CVE-2004-1071

     Incorrect error handling in the binfmt_elf loader may lead to privilege
     escalation.

 CVE-2004-1072

     A buffer overflow in the binfmt_elf loader may lead to privilege
     escalation or denial of service.

 CVE-2004-1073

     The open_exec function may disclose information.

 CVE-2004-1074

     The binfmt code is vulnerable to denial of service through malformed
     a.out binaries.

 CVE-2004-0138

     A denial of service vulnerability in the ELF loader has been found.

 CVE-2004-1068

     A programming error in the unix_dgram_recvmsg() function may lead to
     privilege escalation.

 CVE-2004-1234

     The ELF loader is vulnerable to denial of service through malformed
     binaries.

 CVE-2005-0003

     Crafted ELF binaries may lead to privilege escalation, due to 
     insufficient checking of overlapping memory regions.

 CVE-2004-1235

     A race condition in the load_elf_library() and binfmt_aout() functions
     may allow privilege escalation.

 CVE-2005-0504

     An integer overflow in the Moxa driver may lead to privilege escalation.

 CVE-2005-0384

     A remote denial of service vulnerability has been found in the PPP
     driver.

 CVE-2005-0135

     An IA64 specific local denial of service vulnerability has been found
     in the unw_unwind_to_user() function.

The following matrix explains which kernel version for which architecture
fix the problems mentioned above:

                                     Debian 3.1 (sarge)
     Source                          2.4.17-1woody4
     HP Precision architecture       32.5
     Intel IA-64 architecture        011226.18
     IBM S/390 architecture/image    2.4.17-2.woody.5
     IBM S/390 architecture/patch    0.0.20020816-0.woody.4
     PowerPC architecture (apus)     2.4.17-6
     MIPS architecture               2.4.17-0.020226.2.woody7


We recommend that you upgrade your kernel package immediately and reboot
the machine.

Upgrade Instructions
- --------------------

wget url
        will fetch the file for you
dpkg -i file.deb
        will install the referenced file.

If you are using the apt-get package manager, use the line for
sources.list as given below:

apt-get update
        will update the internal database
apt-get dist-upgrade
        will install corrected packages

You may use an automated update by adding the resources from the
footer to the proper configuration.


Debian GNU/Linux 3.0 alias woody
- --------------------------------

  Source archives:

    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.17-hppa/kernel-image-2.4.17-hppa_32.5.dsc
      Size/MD5 checksum:      713 6ff55b14d3ae957c55bbed7fabf4c047
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.17-hppa/kernel-image-2.4.17-hppa_32.5.tar.gz
      Size/MD5 checksum: 30437486 86601103169da686167972e5e560e3d4
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.17-ia64/kernel-image-2.4.17-ia64_011226.18.dsc
      Size/MD5 checksum:      736 f97d95c6ecc26401f8f2fc2ead6cf421
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.17-ia64/kernel-image-2.4.17-ia64_011226.18.tar.gz
      Size/MD5 checksum: 25419305 9bc354f889edd4964840475400b088b7
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.17-s390/kernel-image-2.4.17-s390_2.4.17-2.woody.5.dsc
      Size/MD5 checksum:      800 d20db4ab99e311150734b70519cc31e9
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.17-s390/kernel-image-2.4.17-s390_2.4.17-2.woody.5.tar.gz
      Size/MD5 checksum:    12283 f51a7e01941baca7010fb8c2f0f67fe3
    http://security.debian.org/pool/updates/main/k/kernel-patch-2.4.17-apus/kernel-patch-2.4.17-apus_2.4.17-6.dsc
      Size/MD5 checksum:      694 2d48f4cfa4917904b6c1f806ecc1bdb4
    http://security.debian.org/pool/updates/main/k/kernel-patch-2.4.17-apus/kernel-patch-2.4.17-apus_2.4.17-6.tar.gz
      Size/MD5 checksum:   491935 94638c0c03b6b163f46319e777d4aa71
    http://security.debian.org/pool/updates/main/k/kernel-patch-2.4.17-mips/kernel-patch-2.4.17-mips_2.4.17-0.020226.2.woody7.dsc
      Size/MD5 checksum:      805 b48cbc9c2cd59eee3a52f54cfa5356e0
    http://security.debian.org/pool/updates/main/k/kernel-patch-2.4.17-mips/kernel-patch-2.4.17-mips_2.4.17-0.020226.2.woody7.tar.gz
      Size/MD5 checksum:  1150966 6748462e7bce7c917e066e0594d42571
    http://security.debian.org/pool/updates/main/k/kernel-patch-2.4.17-s390/kernel-patch-2.4.17-s390_0.0.20020816-0.woody.4.dsc
      Size/MD5 checksum:      664 f49e9cba55a8a4b098e5dc522f2a07fc
    http://security.debian.org/pool/updates/main/k/kernel-patch-2.4.17-s390/kernel-patch-2.4.17-s390_0.0.20020816-0.woody.4.tar.gz
      Size/MD5 checksum:   344642 3a488cc38ffc619bfff4bfbb75eff4cd
    http://security.debian.org/pool/updates/main/k/kernel-source-2.4.17/kernel-source-2.4.17_2.4.17-1woody4.dsc
      Size/MD5 checksum:      609 4e0f66c1811cfb9e926c21566e55b202
    http://security.debian.org/pool/updates/main/k/kernel-source-2.4.17/kernel-source-2.4.17_2.4.17-1woody4.tar.gz
      Size/MD5 checksum: 29768549 bc1f8eab880a33bfe2ebeb3ef8b6557a

  Architecture independent components:

    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.17-hppa/kernel-source-2.4.17-hppa_32.5_all.deb
      Size/MD5 checksum: 24455128 ed5362b12c6327295cd89027ff8e80ab
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.17-ia64/kernel-source-2.4.17-ia64_011226.18_all.deb
      Size/MD5 checksum: 24735538 cf9ddb702811464ac2dd2231512053f9
    http://security.debian.org/pool/updates/main/k/kernel-patch-2.4.17-mips/kernel-patch-2.4.17-mips_2.4.17-0.020226.2.woody7_all.deb
      Size/MD5 checksum:  1151866 6f2575f26e7800e1e7a7cafdaf02b3a6
    http://security.debian.org/pool/updates/main/k/kernel-patch-2.4.17-s390/kernel-patch-2.4.17-s390_0.0.20020816-0.woody.4_all.deb
      Size/MD5 checksum:   300202 0f5db53cdab20024b4a3a75bd0799b1a
    http://security.debian.org/pool/updates/main/k/kernel-source-2.4.17/kernel-doc-2.4.17_2.4.17-1woody4_all.deb
      Size/MD5 checksum:  1708122 7d18878351662289ac0841e0ad8f10f4
    http://security.debian.org/pool/updates/main/k/kernel-source-2.4.17/kernel-source-2.4.17_2.4.17-1woody4_all.deb
      Size/MD5 checksum: 23972270 a0bf4a2796a9b49c36579166e6a72d62

  HP Precision architecture:

    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.17-hppa/kernel-headers-2.4.17-hppa_32.5_hppa.deb
      Size/MD5 checksum:  3523044 63c790a70164e579c8bb3b8a08ea69b5
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.17-hppa/kernel-image-2.4.17-32_32.5_hppa.deb
      Size/MD5 checksum:  2869994 e9e2be22d5fdf40f2e879570adc1132d
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.17-hppa/kernel-image-2.4.17-32-smp_32.5_hppa.deb
      Size/MD5 checksum:  3006192 cf53ac718c6ed26a59802e74c5926f00
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.17-hppa/kernel-image-2.4.17-64_32.5_hppa.deb
      Size/MD5 checksum:  3029436 d0e0fd747af9ff7a3633ee9cc6b1f1e6
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.17-hppa/kernel-image-2.4.17-64-smp_32.5_hppa.deb
      Size/MD5 checksum:  3170356 ca408698a580463da3a547b2f87006e4
    http://security.debian.org/pool/updates/main/k/kernel-source-2.4.17/mkcramfs_2.4.17-1woody3_hppa.deb
      Size/MD5 checksum:    16886 437018078d9d01e25702cf1a20c23414

  Intel IA-64 architecture:

    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.17-ia64/kernel-headers-2.4.17-ia64_011226.18_ia64.deb
      Size/MD5 checksum:  3638280 b6cd4e0d4129b6f4d0734253818cd828
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.17-ia64/kernel-image-2.4.17-itanium_011226.18_ia64.deb
      Size/MD5 checksum:  7026800 55e4cd610c06297c7132ce2aeb88d029
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.17-ia64/kernel-image-2.4.17-itanium-smp_011226.18_ia64.deb
      Size/MD5 checksum:  7172892 a66f94c18d8ee4354e9446655837c72a
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.17-ia64/kernel-image-2.4.17-mckinley_011226.18_ia64.deb
      Size/MD5 checksum:  7014470 d99cc0f293c747a295230de934328007
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.17-ia64/kernel-image-2.4.17-mckinley-smp_011226.18_ia64.deb
      Size/MD5 checksum:  7165570 997a9dbf17821067de6ceb65548e7c2b
    http://security.debian.org/pool/updates/main/k/kernel-source-2.4.17/mkcramfs_2.4.17-1woody4_ia64.deb
      Size/MD5 checksum:    21616 1eab80187061fbd304b6328533d7dc33

  IBM S/390 architecture:

    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.17-s390/kernel-headers-2.4.17_2.4.17-2.woody.5_s390.deb
      Size/MD5 checksum:  3379418 74817217abf90896eb63d6c6792839fe
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.17-s390/kernel-image-2.4.17-s390_2.4.17-2.woody.5_s390.deb
      Size/MD5 checksum:  1346190 39433c757763336b6c14bf0d00652596
    http://security.debian.org/pool/updates/main/k/kernel-source-2.4.17/mkcramfs_2.4.17-1woody3_s390.deb
      Size/MD5 checksum:    16404 9cfcf10a2a2ef99bbb009a650cddd227

  PowerPC architecture:

    http://security.debian.org/pool/updates/main/k/kernel-patch-2.4.17-apus/kernel-headers-2.4.17-apus_2.4.17-6_powerpc.deb
      Size/MD5 checksum:  3409712 698750e3998ee3792db43f445a8a8d96
    http://security.debian.org/pool/updates/main/k/kernel-patch-2.4.17-apus/kernel-image-2.4.17-apus_2.4.17-6_powerpc.deb
      Size/MD5 checksum:  2211146 103890e43508a5913a10ff8be80e9cdc
    http://security.debian.org/pool/updates/main/k/kernel-patch-2.4.17-apus/kernel-image-apus_2.4.17-6_powerpc.deb
      Size/MD5 checksum:     4602 31ef3f45675fc13836337dee97486e20
    http://security.debian.org/pool/updates/main/k/kernel-patch-2.4.17-apus/kernel-patch-2.4.17-apus_2.4.17-6_powerpc.deb
      Size/MD5 checksum:   490842 799441a4e49b88f780353d7aff9f29d2
    http://security.debian.org/pool/updates/main/k/kernel-source-2.4.17/mkcramfs_2.4.17-1woody3_powerpc.deb
      Size/MD5 checksum:    16280 4e54c040bc83523d8122287bab6df7a5

  Big endian MIPS architecture:

    http://security.debian.org/pool/updates/main/k/kernel-patch-2.4.17-mips/kernel-headers-2.4.17_2.4.17-0.020226.2.woody7_mips.deb
      Size/MD5 checksum:  3523520 45f001c255a3a66f22148d84d035abb1
    http://security.debian.org/pool/updates/main/k/kernel-patch-2.4.17-mips/kernel-image-2.4.17-r4k-ip22_2.4.17-0.020226.2.woody7_mips.deb
      Size/MD5 checksum:  2045436 c840c6ff8c9e3ab455d38021d09a391d
    http://security.debian.org/pool/updates/main/k/kernel-patch-2.4.17-mips/kernel-image-2.4.17-r5k-ip22_2.4.17-0.020226.2.woody7_mips.deb
      Size/MD5 checksum:  2045226 709ccbc6754644fa448c93058f0df504
    http://security.debian.org/pool/updates/main/k/kernel-source-2.4.17/mkcramfs_2.4.17-1woody3_mips.deb
      Size/MD5 checksum:    16556 019623b1dbc75bff84d7f056435dc6db

  Little endian MIPS architecture:

    http://security.debian.org/pool/updates/main/k/kernel-patch-2.4.17-mips/kernel-headers-2.4.17_2.4.17-0.020226.2.woody7_mipsel.deb
      Size/MD5 checksum:  3522422 2118440d1658730fd93f47867848573c
    http://security.debian.org/pool/updates/main/k/kernel-patch-2.4.17-mips/kernel-image-2.4.17-r3k-kn02_2.4.17-0.020226.2.woody7_mipsel.deb
      Size/MD5 checksum:  2200968 63bc732deee6df19b83f10a50485a476
    http://security.debian.org/pool/updates/main/k/kernel-patch-2.4.17-mips/kernel-image-2.4.17-r4k-kn04_2.4.17-0.020226.2.woody7_mipsel.deb
      Size/MD5 checksum:  2195278 697eb9b05f765c332eca175284eb24b8
    http://security.debian.org/pool/updates/main/k/kernel-patch-2.4.17-mips/mips-tools_2.4.17-0.020226.2.woody7_mipsel.deb
      Size/MD5 checksum:    17836 61df1f292dccb4e64cb956a629f729fc
    http://security.debian.org/pool/updates/main/k/kernel-source-2.4.17/mkcramfs_2.4.17-1woody3_mipsel.deb
      Size/MD5 checksum:    16558 f8382b01aca2c535988b5ab5709dae90

  Alpha architecture:

    http://security.debian.org/pool/updates/main/k/kernel-source-2.4.17/mkcramfs_2.4.17-1woody3_alpha.deb
      Size/MD5 checksum:    17180 7d1cf8fb24431c01f45fadf7becb6d2e

  ARM architecture:

    http://security.debian.org/pool/updates/main/k/kernel-source-2.4.17/mkcramfs_2.4.17-1woody3_arm.deb
      Size/MD5 checksum:    15878 fcf97ed103c205699fb5396c3a49e293

  Intel IA-32 architecture:

    http://security.debian.org/pool/updates/main/k/kernel-source-2.4.17/mkcramfs_2.4.17-1woody3_i386.deb
      Size/MD5 checksum:    15518 2e7d50090a469a84ef7f3ae8aa97b85f

  Motorola 680x0 architecture:

    http://security.debian.org/pool/updates/main/k/kernel-source-2.4.17/mkcramfs_2.4.17-1woody3_m68k.deb
      Size/MD5 checksum:    15368 41a11620bf7ea34b15742ccf59ff6895

  Sun Sparc architecture:

    http://security.debian.org/pool/updates/main/k/kernel-source-2.4.17/mkcramfs_2.4.17-1woody3_sparc.deb
      Size/MD5 checksum:    18356 71b076d3eeff837bfb54a7f538b11b58


  These files will probably be moved into the stable distribution on
  its next update.

- ---------------------------------------------------------------------------------
For apt-get: deb http://security.debian.org/ stable/updates main
For dpkg-ftp: ftp://security.debian.org/debian-security dists/stable/updates/main
Mailing list: debian-security-announce@...ts.debian.org
Package info: `apt-cache show <pkg>' and http://packages.debian.org/<pkg>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.3 (GNU/Linux)

iD8DBQFEe0tRXm3vHE4uyloRApvAAKDaFRbetrDKY5EG5vPOA8VmTCxz/gCdEfrK
cJdrQoYno419ID3QGeL7XLc=
=1YKA
-----END PGP SIGNATURE-----



