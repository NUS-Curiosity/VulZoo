
Date: Fri, 25 Aug 2006 14:55:02 +0800
From: NSFOCUS Security Team <security@...ocus.com>
To: bugtraq@...urityfocus.com, full-disclosure@...ts.netsys.com,
	vulnwatch@...nwatch.org
Subject:  NSFOCUS SA2006-08 : Microsoft IE6 urlmon.dll Long URL Buffer Overflow Vulnerability

NSFOCUS Security Advisory (SA2006-08)

Microsoft IE6 urlmon.dll Long URL Buffer Overflow Vulnerability

Release Date: 2006-08-25

CVE ID: CVE-2006-3869

http://www.nsfocus.com/english/homepage/research/0608.htm

Affected systems & software
===================

Internet Explorer 6 SP1 with MS06-042

 - Microsoft Windows XP SP1
 - Microsoft Windows 2000 SP4

Unaffected systems & software
===================


Summary
=========

NSFocus Security Team discovered a buffer overflow in IE 6.0SP1 which allows 
remote code execution via an over-long URL.

Description
============

Security Bulletin MS06-042 released by Microsoft on August 8th, 2006 fixed 
multiple vulnerabilities, but the update for IE 6 introduced a new vulnerability. 

When visiting websites with HTTP/1.1 protocol and data compression enabled, 
a buffer overflow might occur if an over-long URL is passed to IE 6. This 
overflow arises due to an incorrect call to function lstrncpyA, possibly
resulting in heap data structure corruption. Carefully crafted data might 
lead to arbitrary code execution. 

Attackers might craft a malicious WEB page and allure users to visit it in 
order to run arbitrary code with the users' privilege. If the user is the 
administrator, the attacker might gain complete control over the system. 
Attackers might host malicious web servers of their own, or exploit certain 
servers that enable HTTP/1.1 protocol and data compression in order to launch 
attacks. 

Workaround
=============

* Temporarily disable HTTP 1.1 support in IE. 
    
Vendor Status
==============

2006.08.10  Informed the vendor
2006.08.17  Vendor confirmed the vulnerability
2006.08.24  Microsoft released related patch and re-released MS06-042.

Detailed Microsoft Security Bulletin is available at:

http://www.microsoft.com/technet/security/bulletin/MS06-042.mspx

Additional Information
========================

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2006-3869 to this issue. This is a candidate for inclusion in the 
CVE list (http://cve.mitre.org), which standardizes names for security problems.
Candidates may change significantly before they become official CVE entries.

Acknowledgment
===============

Hu Qianwei of NSFocus Security Team found the vulnerability.

DISCLAIMS
==========
THE INFORMATION PROVIDED IS RELEASED BY NSFOCUS "AS IS" WITHOUT WARRANTY
OF ANY KIND. NSFOCUS DISCLAIMS ALL WARRANTIES, EITHER EXPRESSED OR IMPLIED,
EXCEPT FOR THE WARRANTIES OF MERCHANTABILITY. IN NO EVENT SHALL NSFOCUS
BE LIABLE FOR ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT,
INCIDENTAL,CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES,
EVEN IF NSFOCUS HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.
DISTRIBUTION OR REPRODUCTION OF THE INFORMATION IS PROVIDED THAT THE
ADVISORY IS NOT MODIFIED IN ANY WAY.

Copyright 1999-2006 NSFOCUS. All Rights Reserved. Terms of use.


NSFOCUS Security Team <security@...ocus.com>
NSFOCUS INFORMATION TECHNOLOGY CO.,LTD
(http://www.nsfocus.com)

PGP Key: http://www.nsfocus.com/homepage/research/pgpkey.asc
Key fingerprint = F8F2 F5D1 EF74 E08C 02FE 1B90 D7BF 7877 C6A6 F6DA

