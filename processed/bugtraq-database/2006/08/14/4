
Date: Mon, 14 Aug 2006 17:22:38 +0100
From: "NGSSoftware Insight Security Research" <nisr@...tgenss.com>
To: <bugtraq@...urityfocus.com>, <dbsec@...elists.org>
Subject: Error logging buffer overflow in Informix

NGSSoftware Insight Security Research Advisory

Name: Error logging buffer overflow in Informix
Systems Affected: Informix 9.40.xC7 and xC8, 10.00.xC3 and xC4
Severity: Critical
Vendor URL: http://www.ibm.com/
Author: David Litchfield [ davidl@...software.com ]
Date of Public Advisory: 2nd August 2006
Advisory number: #NISR02082006B
CVEID: http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3854
Advisory URL: http://www.ngssoftware.com/research/

Description
***********
Informix Dynamic Server is a database developed by IBM. When IBM released a 
patch for the overly long username buffer overflow (CVE-2006-3853) it was 
discovered that the patch introduced a new buffer overflow vulnerability.


Details
*******
If the username is longer than 32 bytes an error is logged. A message ("%s : 
username is longer than usersize(32).") is logged with a call to 
_mt_logprintf(). _mt_logprintf() creates a 960 byte buffer on the stack and 
then passes this as argument for the destination in a call to vsprintf(). 
Thus if the username is longer than 960 bytes it is possible to overflow the 
buffer, overwriting the saved return address, gaining control of the 
process' path of execution.


Fix Information
***************
IBM was alerted to this flaw on the 21st July 2006; a fix has now been made 
available - both 9.40.xC9 and 10.00.xC5 fix this issue.

NGSSQuirreL for Informix, an advanced vulnerability assessment scanner 
designed specifically for Informix, can be used to accurately determine 
whether your servers are vulnerable to this flaw. More information about 
NGSSQuirreL for Informix can be found here 
http://www.ngssoftware.com/products/database-security/ngs-squirrel-informix.php

About NGSSoftware
*****************

NGSSoftware develops vulnerability assessment and compliancy tools for 
database servers including Oracle, Microsoft SQL Server, DB2, Sybase and 
Informix. Headquartered in the United Kingdom NGS has offices in London, St. 
Andrews (UK), Sydney, Brisbane, and Perth (Australia) and Texas in the 
United States; NGSConsulting provide services to some of the largest and 
most demanding organizations around the globe.

http://www.ngssoftware.com/

Telephone +44 208 401 0070
Fax +44 208 401 0076

enquiries@...software.com


