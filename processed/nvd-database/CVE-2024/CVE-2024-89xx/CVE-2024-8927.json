{
  "id": "CVE-2024-8927",
  "sourceIdentifier": "security@php.net",
  "published": "2024-10-08T04:15:10.867",
  "lastModified": "2025-03-18T17:15:44.707",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "In PHP versions 8.1.* before 8.1.30, 8.2.* before 8.2.24, 8.3.* before 8.3.12,\u00a0HTTP_REDIRECT_STATUS variable is used to check whether or not CGI binary is being run by the HTTP server. However, in certain scenarios, the content of this variable can be controlled by the request submitter via HTTP headers, which can lead to\u00a0cgi.force_redirect option not being correctly applied. In certain configurations this may lead to arbitrary file inclusion in PHP."
    },
    {
      "lang": "es",
      "value": "En las versiones de PHP 8.1.* anteriores a 8.1.30, 8.2.* anteriores a 8.2.24, 8.3.* anteriores a 8.3.12, la variable HTTP_REDIRECT_STATUS se utiliza para comprobar si el servidor HTTP est\u00e1 ejecutando o no el binario CGI. Sin embargo, en determinados escenarios, el remitente de la solicitud puede controlar el contenido de esta variable a trav\u00e9s de los encabezados HTTP, lo que puede provocar que la opci\u00f3n cgi.force_redirect no se aplique correctamente. En determinadas configuraciones, esto puede provocar la inclusi\u00f3n arbitraria de archivos en PHP."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security@php.net",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "baseScore": 7.5,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "baseScore": 7.5,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "NVD-CWE-noinfo"
        }
      ]
    },
    {
      "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-1220"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:php-fpm:php-fpm:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "8.1.0",
              "versionEndExcluding": "8.1.30",
              "matchCriteriaId": "3AB97B3F-78E0-412D-A29A-2086C84EC2A2"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:php-fpm:php-fpm:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "8.2.0",
              "versionEndExcluding": "8.2.24",
              "matchCriteriaId": "30CA7A9A-B2B8-4A3E-981B-E94536DAFD89"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:php-fpm:php-fpm:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "8.3.0",
              "versionEndExcluding": "8.3.12",
              "matchCriteriaId": "8F7936E2-4290-48A4-A857-929E9CEDBDF5"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/php/php-src/security/advisories/GHSA-94p6-54jq-9mwp",
      "source": "security@php.net",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ]
}