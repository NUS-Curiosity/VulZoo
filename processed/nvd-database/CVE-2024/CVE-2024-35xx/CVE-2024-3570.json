{
  "id": "CVE-2024-3570",
  "sourceIdentifier": "security@huntr.dev",
  "published": "2024-04-10T17:15:58.543",
  "lastModified": "2024-11-21T09:29:54.003",
  "vulnStatus": "Awaiting Analysis",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "A stored Cross-Site Scripting (XSS) vulnerability exists in the chat functionality of the mintplex-labs/anything-llm repository, allowing attackers to execute arbitrary JavaScript in the context of a user's session. By manipulating the ChatBot responses, an attacker can inject malicious scripts to perform actions on behalf of the user, such as creating a new admin account or changing the user's password, leading to a complete takeover of the AnythingLLM application. The vulnerability stems from the improper sanitization of user and ChatBot input, specifically through the use of `dangerouslySetInnerHTML`. Successful exploitation requires convincing an admin to add a malicious LocalAI ChatBot to their AnythingLLM instance."
    },
    {
      "lang": "es",
      "value": "Existe una vulnerabilidad de Cross Site Scripting (XSS) almacenado en la funcionalidad de chat del repositorio mintplex-labs/anything-llm, que permite a los atacantes ejecutar JavaScript arbitrario en el contexto de la sesi\u00f3n de un usuario. Al manipular las respuestas de ChatBot, un atacante puede inyectar secuencias de comandos maliciosas para realizar acciones en nombre del usuario, como crear una nueva cuenta de administrador o cambiar la contrase\u00f1a del usuario, lo que lleva a una toma de control completa de la aplicaci\u00f3n AnythingLLM. La vulnerabilidad se origina en la desinfecci\u00f3n incorrecta de la entrada del usuario y del ChatBot, espec\u00edficamente mediante el uso de `dangerouslySetInnerHTML`. Para explotarla con \u00e9xito, es necesario convencer a un administrador de que agregue un LocalAI ChatBot malicioso a su instancia de AnythingLLM."
    }
  ],
  "metrics": {
    "cvssMetricV30": [
      {
        "source": "security@huntr.dev",
        "type": "Secondary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:L/AC:H/PR:H/UI:R/S:U/C:N/I:N/A:N",
          "baseScore": 0.0,
          "baseSeverity": "NONE",
          "attackVector": "LOCAL",
          "attackComplexity": "HIGH",
          "privilegesRequired": "HIGH",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 0.3,
        "impactScore": 0.0
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security@huntr.dev",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-79"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/mintplex-labs/anything-llm/commit/a4ace56a401ffc8ce0082d7444159dfd5dc28834",
      "source": "security@huntr.dev"
    },
    {
      "url": "https://huntr.com/bounties/f0eaf552-aaf3-42b6-a5df-cfecd2de15ee",
      "source": "security@huntr.dev"
    },
    {
      "url": "https://github.com/mintplex-labs/anything-llm/commit/a4ace56a401ffc8ce0082d7444159dfd5dc28834",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://huntr.com/bounties/f0eaf552-aaf3-42b6-a5df-cfecd2de15ee",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    }
  ]
}