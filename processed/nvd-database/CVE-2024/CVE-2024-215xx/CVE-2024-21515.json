{
  "id": "CVE-2024-21515",
  "sourceIdentifier": "report@snyk.io",
  "published": "2024-06-22T05:15:10.730",
  "lastModified": "2024-06-24T19:58:28.987",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "This affects versions of the package opencart/opencart from 4.0.0.0. A reflected XSS issue was identified in the filename parameter of the admin tool/log route. An attacker could obtain a user's token by tricking the user to click on a maliciously crafted URL. The user is then prompted to login and redirected again upon authentication with the payload automatically executing. If the attacked user has admin privileges, this vulnerability could be used as the start of a chain of exploits like Zip Slip or arbitrary file write vulnerabilities in the admin functionality.\r\r**Notes:**\r\r1) This is only exploitable if the attacker knows the name or path of the admin directory. The name of the directory is \"admin\" by default but there is a pop-up in the dashboard warning users to rename it.\r\r2) The fix for this vulnerability is incomplete. The redirect is removed so that it is not possible for an attacker to control the redirect post admin login anymore, but it is still possible to exploit this issue in admin if the user is authenticated as an admin already."
    },
    {
      "lang": "es",
      "value": "Esto afecta a las versiones del paquete opencart/opencart desde 4.0.0.0. Se identific\u00f3 un problema XSS reflejado en el par\u00e1metro de nombre de archivo de la herramienta de administraci\u00f3n/ruta de registro. Un atacante podr\u00eda obtener el token de un usuario enga\u00f1\u00e1ndolo para que haga clic en una URL creada con fines malintencionados. Luego se solicita al usuario que inicie sesi\u00f3n y se le redirige nuevamente tras la autenticaci\u00f3n y la carga \u00fatil se ejecuta autom\u00e1ticamente. Si el usuario atacado tiene privilegios de administrador, esta vulnerabilidad podr\u00eda usarse como el inicio de una cadena de exploits como Zip Slip o vulnerabilidades de escritura de archivos arbitrarios en la funcionalidad de administraci\u00f3n. **Notas:** 1) Esto solo se puede explotar si el atacante conoce el nombre o la ruta del directorio de administraci\u00f3n. El nombre del directorio es \"admin\" de forma predeterminada, pero hay una ventana emergente en el panel que advierte a los usuarios que le cambien el nombre. 2) La soluci\u00f3n para esta vulnerabilidad est\u00e1 incompleta. El redireccionamiento se elimina para que un atacante ya no pueda controlar el inicio de sesi\u00f3n del administrador posterior al redireccionamiento, pero a\u00fan es posible explotar este problema en el administrador si el usuario ya est\u00e1 autenticado como administrador."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE",
          "baseScore": 4.7,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1.6,
        "impactScore": 2.7
      },
      {
        "source": "report@snyk.io",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE",
          "baseScore": 4.2,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1.6,
        "impactScore": 2.5
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-79"
        }
      ]
    },
    {
      "source": "report@snyk.io",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-79"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:opencart:opencart:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "4.0.0.0",
              "matchCriteriaId": "60390C89-394D-4A4E-BD1C-C91F57B73CFD"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/opencart/opencart/commit/c546199e8f100c1f3797a7a9d3cf4db1887399a2",
      "source": "report@snyk.io",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://security.snyk.io/vuln/SNYK-PHP-OPENCARTOPENCART-7266573",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ]
}