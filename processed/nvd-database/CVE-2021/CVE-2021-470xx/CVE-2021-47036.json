{
  "id": "CVE-2021-47036",
  "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
  "published": "2024-02-28T09:15:39.800",
  "lastModified": "2024-02-28T14:06:45.783",
  "vulnStatus": "Awaiting Analysis",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nudp: skip L4 aggregation for UDP tunnel packets\n\nIf NETIF_F_GRO_FRAGLIST or NETIF_F_GRO_UDP_FWD are enabled, and there\nare UDP tunnels available in the system, udp_gro_receive() could end-up\ndoing L4 aggregation (either SKB_GSO_UDP_L4 or SKB_GSO_FRAGLIST) at\nthe outer UDP tunnel level for packets effectively carrying and UDP\ntunnel header.\n\nThat could cause inner protocol corruption. If e.g. the relevant\npackets carry a vxlan header, different vxlan ids will be ignored/\naggregated to the same GSO packet. Inner headers will be ignored, too,\nso that e.g. TCP over vxlan push packets will be held in the GRO\nengine till the next flush, etc.\n\nJust skip the SKB_GSO_UDP_L4 and SKB_GSO_FRAGLIST code path if the\ncurrent packet could land in a UDP tunnel, and let udp_gro_receive()\ndo GRO via udp_sk(sk)->gro_receive.\n\nThe check implemented in this patch is broader than what is strictly\nneeded, as the existing UDP tunnel could be e.g. configured on top of\na different device: we could end-up skipping GRO at-all for some packets.\n\nAnyhow, that is a very thin corner case and covering it will add quite\na bit of complexity.\n\nv1 -> v2:\n - hopefully clarify the commit message"
    },
    {
      "lang": "es",
      "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: udp: omitir la agregaci\u00f3n L4 para paquetes de t\u00fanel UDP Si NETIF_F_GRO_FRAGLIST o NETIF_F_GRO_UDP_FWD est\u00e1n habilitados y hay t\u00faneles UDP disponibles en el sistema, udp_gro_receive() podr\u00eda terminar realizando la agregaci\u00f3n L4 (ya sea SKB_GSO_UDP_L4 o SKB_GSO_FRAGLIST) en el nivel del t\u00fanel UDP externo para paquetes que transportan efectivamente un encabezado de t\u00fanel UDP. Eso podr\u00eda causar corrupci\u00f3n del protocolo interno. Si, por ejemplo, los paquetes relevantes llevan un encabezado vxlan, se ignorar\u00e1n/agregar\u00e1n diferentes ID de vxlan al mismo paquete GSO. Los encabezados internos tambi\u00e9n se ignorar\u00e1n, de modo que, por ejemplo, los paquetes push TCP sobre vxlan se mantendr\u00e1n en el motor GRO hasta el pr\u00f3ximo lavado, etc. Simplemente omita la ruta de c\u00f3digo SKB_GSO_UDP_L4 y SKB_GSO_FRAGLIST si el paquete actual podr\u00eda aterrizar en un t\u00fanel UDP, y deje que udp_gro_receive() haga GRO a trav\u00e9s de udp_sk(sk)-&gt;gro_receive. La verificaci\u00f3n implementada en este parche es m\u00e1s amplia de lo estrictamente necesario, ya que el t\u00fanel UDP existente podr\u00eda configurarse, por ejemplo, encima de un dispositivo diferente: podr\u00edamos terminar omitiendo GRO para algunos paquetes. De todos modos, se trata de una carcasa de esquina muy delgada y cubrirla agregar\u00e1 bastante complejidad. v1 -&gt; v2: - con suerte aclarar el mensaje de confirmaci\u00f3n"
    }
  ],
  "metrics": {},
  "references": [
    {
      "url": "https://git.kernel.org/stable/c/18f25dc399901426dff61e676ba603ff52c666f7",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/450687386cd16d081b58cd7a342acff370a96078",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    }
  ]
}