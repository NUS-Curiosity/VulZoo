{
  "id": "CVE-2012-0158",
  "sourceIdentifier": "secure@microsoft.com",
  "published": "2012-04-10T21:55:01.687",
  "lastModified": "2018-10-12T22:02:11.400",
  "vulnStatus": "Modified",
  "cisaExploitAdd": "2021-11-03",
  "cisaActionDue": "2022-05-03",
  "cisaRequiredAction": "Apply updates per vendor instructions.",
  "cisaVulnerabilityName": "Microsoft MSCOMCTL.OCX Remote Code Execution Vulnerability",
  "descriptions": [
    {
      "lang": "en",
      "value": "The (1) ListView, (2) ListView2, (3) TreeView, and (4) TreeView2 ActiveX controls in MSCOMCTL.OCX in the Common Controls in Microsoft Office 2003 SP3, 2007 SP2 and SP3, and 2010 Gold and SP1; Office 2003 Web Components SP3; SQL Server 2000 SP4, 2005 SP4, and 2008 SP2, SP3, and R2; BizTalk Server 2002 SP1; Commerce Server 2002 SP4, 2007 SP2, and 2009 Gold and R2; Visual FoxPro 8.0 SP1 and 9.0 SP2; and Visual Basic 6.0 Runtime allow remote attackers to execute arbitrary code via a crafted (a) web site, (b) Office document, or (c) .rtf file that triggers \"system state\" corruption, as exploited in the wild in April 2012, aka \"MSCOMCTL.OCX RCE Vulnerability.\""
    },
    {
      "lang": "es",
      "value": "Los controles ActiveX (1) ListView, (2) ListView2, (3) TreeView, y (4) TreeView2 en MSCOMCTL.OCX en the Common Controls en Microsoft Office 2003 SP3, 2007 SP2 y SP3, y 2010 Gold y SP1; Office 2003 Web Components SP3; SQL Server 2000 SP4, 2005 SP4, y 2008 SP2, SP3, y R2; BizTalk Server 2002 SP1; Commerce Server 2002 SP4, 2007 SP2, y 2009 Gold y R2; Visual FoxPro 8.0 SP1 y 9.0 SP2; y Visual Basic 6.0 Runtime \r\npermita a atacantes remotos ejecutar c\u00f3digo a trav\u00e9s de la manipulaci\u00f3n de: (a) sitios web, (b) documento de Office, o (c) fichero .rtf que provoca una corrupci\u00f3n \"system state\", como la explotada en April del 2012, tambi\u00e9n conocida como vulnerabilidad \"MSCOMCTL.OCX RCE\"."
    }
  ],
  "metrics": {
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:N/C:C/I:C/A:C",
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "NONE",
          "confidentialityImpact": "COMPLETE",
          "integrityImpact": "COMPLETE",
          "availabilityImpact": "COMPLETE",
          "baseScore": 9.3
        },
        "baseSeverity": "HIGH",
        "exploitabilityScore": 8.6,
        "impactScore": 10.0,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": true
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-94"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:office:2003:sp3:*:*:*:*:*:*",
              "matchCriteriaId": "A332D04D-CC8C-4F68-A261-BA2F2D8EAD1E"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:office:2007:sp2:*:*:*:*:*:*",
              "matchCriteriaId": "08AF794A-435D-4171-9DBB-EB7FAED96DBA"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:office:2007:sp3:*:*:*:*:*:*",
              "matchCriteriaId": "FEECD12A-5BEF-4675-B62E-86CF4A7474D7"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:office:2010:*:x86:*:*:*:*:*",
              "matchCriteriaId": "A0CF7572-79BA-4576-ADED-528D17809071"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:office:2010:sp1:x86:*:*:*:*:*",
              "matchCriteriaId": "8383FADC-9391-4570-AAF9-92A952A4F04F"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:office_web_components:2003:sp3:*:*:*:*:*:*",
              "matchCriteriaId": "0A9C5BA7-0ECB-4101-9DAD-ECAA42C9E0A3"
            }
          ]
        }
      ]
    },
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:sql_server:2000:sp4:*:*:*:*:*:*",
              "matchCriteriaId": "A7A5116E-BD37-4539-B815-F1B70EC4D45D"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:sql_server:2000:sp4:analysis_services:*:*:*:*:*",
              "matchCriteriaId": "6A74FD84-90B6-41DF-B7E2-8774A8F1ADA8"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:sql_server:2005:sp4:express_advanced_services:*:*:*:*:*",
              "matchCriteriaId": "6CE40B2B-E1A0-4BBE-9A3B-5E7B14F83554"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:sql_server:2005:sp4:itanium:*:*:*:*:*",
              "matchCriteriaId": "7E387893-EBA4-448A-9687-400F50A5A2F0"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:sql_server:2005:sp4:x64:*:*:*:*:*",
              "matchCriteriaId": "9916AE10-8EBF-4BB9-885C-1FD0C20ED71C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:sql_server:2005:sp4:x86:*:*:*:*:*",
              "matchCriteriaId": "4F8BF453-1436-4031-9774-B3E53B40BB46"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:sql_server:2008:r2:itanium:*:*:*:*:*",
              "matchCriteriaId": "597E44EF-D336-40C4-BB2B-0C8735B96721"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:sql_server:2008:r2:x64:*:*:*:*:*",
              "matchCriteriaId": "63DD17D8-8A29-48EE-8B71-ED3991D94E63"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:sql_server:2008:r2:x86:*:*:*:*:*",
              "matchCriteriaId": "5A75C0F3-D945-450B-9E63-794AC8F571E5"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:sql_server:2008:sp2:itanium:*:*:*:*:*",
              "matchCriteriaId": "5FA2E5E9-A530-4EBA-863A-322C10EFB82C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:sql_server:2008:sp2:x64:*:*:*:*:*",
              "matchCriteriaId": "00F271BE-E397-4DAB-894E-EBA5CD7C465F"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:sql_server:2008:sp2:x86:*:*:*:*:*",
              "matchCriteriaId": "A30C7019-68AD-4538-8250-EFDDC4FCBC32"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:sql_server:2008:sp3:itanium:*:*:*:*:*",
              "matchCriteriaId": "21B670E0-E991-4884-9D98-D9A74C95903B"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:sql_server:2008:sp3:x64:*:*:*:*:*",
              "matchCriteriaId": "46B0D444-0B3F-4430-9374-BFA7D5F44726"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:sql_server:2008:sp3:x86:*:*:*:*:*",
              "matchCriteriaId": "C561C66B-18EB-4926-8FF1-489D1934E5C8"
            }
          ]
        }
      ]
    },
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:biztalk_server:2002:sp1:*:*:*:*:*:*",
              "matchCriteriaId": "047B2685-4776-4831-8314-68DB07B3F1C3"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:commerce_server:2002:sp4:*:*:*:*:*:*",
              "matchCriteriaId": "707A0633-6324-4D85-AF73-CEB2205D836B"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:commerce_server:2007:sp2:*:*:*:*:*:*",
              "matchCriteriaId": "206FBC72-5535-46F3-B5B8-2FC765C382B3"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:commerce_server:2009:*:*:*:*:*:*:*",
              "matchCriteriaId": "39CC1FE4-69DC-4F7D-B0C1-E1B074B2908F"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:commerce_server:2009:r2:*:*:*:*:*:*",
              "matchCriteriaId": "7CC3C563-408F-487B-8D0F-FDEB1D39B2B6"
            }
          ]
        }
      ]
    },
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:visual_basic:6.0:*:runtime_extended_files:*:*:*:*:*",
              "matchCriteriaId": "DD65D7E8-016B-44EC-A416-E9247810CFF3"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:visual_foxpro:8.0:sp1:*:*:*:*:*:*",
              "matchCriteriaId": "E5DE8B76-FA09-4EA2-9535-758C56C4C099"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:visual_foxpro:9.0:sp2:*:*:*:*:*:*",
              "matchCriteriaId": "5E711CC3-9094-4C54-A794-9C7A3E7F4AFA"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "http://opensources.info/comment-on-the-curious-case-of-a-cve-2012-0158-exploit-by-chris-pierce/",
      "source": "secure@microsoft.com"
    },
    {
      "url": "http://www.securityfocus.com/bid/52911",
      "source": "secure@microsoft.com"
    },
    {
      "url": "http://www.securitytracker.com/id?1026899",
      "source": "secure@microsoft.com"
    },
    {
      "url": "http://www.securitytracker.com/id?1026900",
      "source": "secure@microsoft.com"
    },
    {
      "url": "http://www.securitytracker.com/id?1026902",
      "source": "secure@microsoft.com"
    },
    {
      "url": "http://www.securitytracker.com/id?1026903",
      "source": "secure@microsoft.com"
    },
    {
      "url": "http://www.securitytracker.com/id?1026904",
      "source": "secure@microsoft.com"
    },
    {
      "url": "http://www.securitytracker.com/id?1026905",
      "source": "secure@microsoft.com"
    },
    {
      "url": "http://www.us-cert.gov/cas/techalerts/TA12-101A.html",
      "source": "secure@microsoft.com",
      "tags": [
        "US Government Resource"
      ]
    },
    {
      "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2012/ms12-027",
      "source": "secure@microsoft.com"
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/74372",
      "source": "secure@microsoft.com"
    },
    {
      "url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A15462",
      "source": "secure@microsoft.com"
    }
  ]
}