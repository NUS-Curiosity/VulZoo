{
  "id": "CVE-2022-39344",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2022-11-04T20:15:10.437",
  "lastModified": "2022-11-07T17:22:44.320",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Azure RTOS USBX is a USB host, device, and on-the-go (OTG) embedded stack, that is fully integrated with Azure RTOS ThreadX. Prior to version 6.1.12, the USB DFU UPLOAD functionality may be utilized to introduce a buffer overflow resulting in overwrite of memory contents. In particular cases this may allow an attacker to bypass security features or execute arbitrary code. The implementation of `ux_device_class_dfu_control_request` function prevents buffer overflow during handling of DFU UPLOAD command when current state is `UX_SYSTEM_DFU_STATE_DFU_IDLE`. This issue has been patched, please upgrade to version 6.1.12. As a workaround, add the `UPLOAD_LENGTH` check in all possible states."
    },
    {
      "lang": "es",
      "value": "Azure RTOS USBX es una pila integrada de host, dispositivo y en movimiento (OTG) USB que est\u00e1 completamente integrada con Azure RTOS ThreadX. Antes de la versi\u00f3n 6.1.12, la funcionalidad USB DFU UPLOAD se puede utilizar para introducir un desbordamiento del b\u00fafer que provoca la sobrescritura del contenido de la memoria. En casos particulares, esto puede permitir que un atacante eluda las funciones de seguridad o ejecute c\u00f3digo arbitrario. La implementaci\u00f3n de la funci\u00f3n `ux_device_class_dfu_control_request` evita el desbordamiento del b\u00fafer durante el manejo del comando DFU UPLOAD cuando el estado actual es `UX_SYSTEM_DFU_STATE_DFU_IDLE`. Este problema ha sido solucionado; actualice a la versi\u00f3n 6.1.12. Como workaround, agregue la verificaci\u00f3n `UPLOAD_LENGTH` en todos los estados posibles."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 9.8,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.9
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 9.8,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-120"
        }
      ]
    },
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-120"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:microsoft:azure_rtos_usbx:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "6.1.12",
              "matchCriteriaId": "97B22C9E-110C-4F07-A481-8B6466F5D1E5"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/azure-rtos/usbx/security/advisories/GHSA-m9p8-xrp7-vvqp",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ]
}