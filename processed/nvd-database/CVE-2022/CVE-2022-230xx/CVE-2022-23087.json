{
  "id": "CVE-2022-23087",
  "sourceIdentifier": "secteam@freebsd.org",
  "published": "2024-02-15T05:15:09.337",
  "lastModified": "2024-05-14T10:18:03.900",
  "vulnStatus": "Awaiting Analysis",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "The e1000 network adapters permit a variety of modifications to an Ethernet packet when it is being transmitted.  These include the insertion of IP and TCP checksums, insertion of an Ethernet VLAN header, and TCP segmentation offload (\"TSO\").  The e1000 device model uses an on-stack buffer to generate the modified packet header when simulating these modifications on transmitted packets.\n\nWhen checksum offload is requested for a transmitted packet, the e1000 device model used a guest-provided value to specify the checksum offset in the on-stack buffer.  The offset was not validated for certain packet types.\n\nA misbehaving bhyve guest could overwrite memory in the bhyve process on the host, possibly leading to code execution in the host context.\n\nThe bhyve process runs in a Capsicum sandbox, which (depending on the FreeBSD version and bhyve configuration) limits the impact of exploiting this issue."
    },
    {
      "lang": "es",
      "value": "Los adaptadores de red e1000 permiten una variedad de modificaciones a un paquete Ethernet cuando se transmite. Estos incluyen la inserci\u00f3n de sumas de verificaci\u00f3n de IP y TCP, la inserci\u00f3n de un encabezado VLAN Ethernet y la descarga de segmentaci\u00f3n de TCP (\"TSO\"). El modelo de dispositivo e1000 utiliza un b\u00fafer en la pila para generar el encabezado del paquete modificado al simular estas modificaciones en los paquetes transmitidos. Cuando se solicita la descarga de la suma de verificaci\u00f3n para un paquete transmitido, el modelo de dispositivo e1000 utiliza un valor proporcionado por el hu\u00e9sped para especificar el desplazamiento de la suma de verificaci\u00f3n en el b\u00fafer en la pila. El desplazamiento no se valid\u00f3 para ciertos tipos de paquetes. Un invitado de bhyve que se comporte mal podr\u00eda sobrescribir la memoria en el proceso de bhyve en el host, lo que posiblemente lleve a la ejecuci\u00f3n de c\u00f3digo en el contexto del host. El proceso bhyve se ejecuta en un entorno limitado de Capsicum, lo que (dependiendo de la versi\u00f3n de FreeBSD y la configuraci\u00f3n de bhyve) limita el impacto de explotar este problema."
    }
  ],
  "metrics": {},
  "references": [
    {
      "url": "https://security.freebsd.org/advisories/FreeBSD-SA-22:05.bhyve.asc",
      "source": "secteam@freebsd.org"
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20240415-0005/",
      "source": "secteam@freebsd.org"
    }
  ]
}