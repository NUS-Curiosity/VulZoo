
Date: Wed, 9 Jan 2013 09:47:11 +0000
From: Context IS - Disclosure <disclosure@...textis.co.uk>
To: "bugtraq@...urityfocus.com" <bugtraq@...urityfocus.com>,
	"full-disclosure@...ts.grok.org.uk" <full-disclosure@...ts.grok.org.uk>
Subject: Context Advisory - .NET 1.1 through .NET 4.5
	Elevation of Privilege

===============================ADVISORY===============================
Systems Affected:   .NET 1.1 through .NET 4.5
Severity:           Important
Category:           Elevation of Privilege
Author:             Context Information Security
Reported to vendor: 23th April 2012
Advisory Issued:    9th January 2013
Reference:          CVE-2013-0004 
===============================ADVISORY===============================

Description
-----------
The Microsoft .NET framework is containeds an error in the Intermediate Language (IL) verifier which could allow hosted partial trust code to elevate privileges to escape a sandboxed environment resulting in arbitrary code execution with the permissions of the user. 

Analysis
--------
The .NET framework contains a verifier for IL code which is enabled in partial trust scenarios. This is used to ensure that the code that is to be JIT’ed is logically consistent and does not permit any mechanism of circumventing type safety. 
The vulnerability addressed in the security bulletin is due to a bug in that verification process which allows malicious code to call an object’s constructor more than once which would allow an otherwise immutable object’s state to be changed leading to common time-of-check/time-of-use issues. 

Technologies Affected
---------------------
Microsoft .Net Frameworks 1.1 through 4.5
Vendor Response
---------------
Microsoft advises users to patch the .NeETt Framework to the latest version.  See the following Microsoft security bulletin for more details:
http://technet.microsoft.com/en-us/security/bulletin/ms13-004
There are a number of mitigations which reduce the severity of the issues which are also detailed in Microsoft’s bulletin. 

Disclosure Timeline
-------------------
23rd April 2012 – Vendor Notification
8th January 2013 – Vendor Patch Released

Credits
--------
James Forshaw of Context Information Security

About Context Information Security
----------------------------------
Context Information Security is an independent security consultancy specialising in both technical security and information assurance services.
The company was founded in 1998. Its client base has grown steadily over the years, thanks in large part to personal recommendations from existing clients who value us as business partners. We believe our success is based on the value our clients place on our product-agnostic, holistic approach; the way we work closely with them to develop a tailored service; and to the independence, integrity and technical skills of our consultants.

The company’s client base now includes some of the most prestigious blue chip companies in the world, as well as government organisations. 
The best security experts need to bring a broad portfolio of skills to the job, so Context has always sought to recruit staff with extensive business experience as well as technical expertise. Our aim is to provide effective and practical solutions, advice and support: when we report back to clients we always communicate our findings and recommendations in plain terms at a business level as well as in the form of an in-depth technical report.

Web:  www.contextis.com
Email:  disclosure@...textis.co.uk
_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
