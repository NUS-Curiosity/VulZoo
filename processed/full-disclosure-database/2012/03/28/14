
Date: Wed, 28 Mar 2012 12:20:57 -0400
From: Cisco Systems Product Security Incident Response Team <psirt@...co.com>
To: full-disclosure@...ts.grok.org.uk
Cc: psirt@...co.com
Subject: Cisco Security Advisory: Cisco IOS Software
	Zone-Based Firewall Vulnerabilities

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Cisco Security Advisory: Cisco IOS Software Zone-Based Firewall Vulnerabilities

Advisory ID: cisco-sa-20120328-zbfw

Revision 1.0

For Public Release 2012 March 28 16:00  UTC (GMT)
+---------------------------------------------------------------------

Summary
=======

Cisco IOS Software contains four vulnerabilities related to Cisco IOS
Zone-Based Firewall features. These vulnerabilities are as follows:

  * Memory Leak Associated with Crafted IP Packets 
  * Memory Leak in HTTP Inspection 
  * Memory Leak in H.323 Inspection 
  * Memory Leak in SIP Inspection 

Workarounds that mitigate these vulnerabilities are not available.

Cisco has released free software updates that address these
vulnerabilities.

This advisory is available at the following link: 
http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20120328-zbfw


Note: The March 28, 2012, Cisco IOS Software Security Advisory
bundled publication includes nine Cisco Security Advisories. Each
advisory lists the Cisco IOS Software releases that correct the
vulnerability or vulnerabilities detailed in the advisory as well as
the Cisco IOS Software releases that correct all vulnerabilities in
the March 2012 bundled publication.

Individual publication links are in "Cisco Event Response:
Semi-Annual Cisco IOS Software Security Advisory Bundled Publication"
at the following link:

http://www.cisco.com/web/about/security/intelligence/Cisco_ERP_mar12.html

Affected Products
=================


Vulnerable Products
+------------------

Cisco IOS devices running vulnerable versions of Cisco IOS Software
are affected by four vulnerabilities in the Cisco IOS Zone-Based
Firewall. The vulnerabilities are independent of each other. Details
to confirm affected configurations are provided below.

To determine whether a device is configured with Zone-Based Firewall,
log in to the device and issue the show zone security command-line
interface (CLI) command. If the output shows a member interface under
a zone name, the device is vulnerable. The following example shows a
device with Zone-Based Firewall rules configured on both
GigabitEthernet0/0 and GigabitEthernet0/1:

    Router#show zone security
    zone self
      Description: System defined zone
    
    zone inside
      Description: *** Inside Network ***
      Member Interfaces:
        GigabitEthernet0/0
    
    zone outside
      Description: *** Outside Network ***
      Member Interfaces:
        GigabitEthernet0/1
    
    Router#

The following sections provide more details on the specific features
containing the vulnerabilities.

Memory Leak Associated with Crafted IP Packets
+---------------------------------------------
There is no specific configuration necessary for a device to be
vulnerable to the memory leak associated with crafted IP packets. If
the Zone-Based Firewall is configured, the device is vulnerable.

Memory Leak in HTTP Inspection
+-----------------------------
For the device to be vulnerable to the memory leak associated with
HTTP inspection, the Zone-Based Firewall must be configured to
perform HTTP inspection with the Zone-Based Firewall.

To determine whether a device is configured for HTTP inspection,
enter the command show policy-map type inspect zone-pair | include
Match: protocol http. The following example shows a vulnerable device
configured with Cisco IOS Zone-Based Policy Firewall HTTP inspection:

Router#show policy-map type inspect zone-pair | include Match: protocol http 
       Match: protocol http
 
Memory Leak in H.323 Inspection
+------------------------------
For a device to be vulnerable to the memory leak associated with
H.323 inspection, the Zone-Based Firewall must be configured to
perform H.323 inspection. To determine if a device is configured for
H.323 inspection enter the command show policy-map type inspect
zone-pair | include Match: protocol h323. If the output contains
"Match: protocol h323" the device is vulnerable. The following
example shows a vulnerable device configured with Cisco IOS
Zone-Based Policy Firewall H.323 inspection:

Router# show policy-map type inspect zone-pair | include Match: protocol h323
        Match: protocol h323

Memory Leak in SIP Inspection
+----------------------------
The device is vulnerable if the configuration has either a Layer 4 or
Layer 7 Session Initiation Protocol (SIP) application-specific policy
configured, and the policy is applied to any firewall zone. To
determine whether a device is configured for SIP inspection enter the
command show policy-map type inspect zone-pair | include Match:
protocol sip. If the output contains "Match: protocol sip" the device
is vulnerable. The following example shows a vulnerable device
configured with Cisco IOS Zone-Based Policy Firewall SIP inspection:

Router# show policy-map type inspect zone-pair | include Match: protocol sip    
        Match: protocol sip

To determine the Cisco IOS Software release that is running on a
Cisco product, administrators can log in to the device and issue the 
show version command to display the system banner. The system banner
confirms that the device is running Cisco IOS Software by displaying
text similar to "Cisco Internetwork Operating System Software" or
"Cisco IOS Software." The image name displays in parentheses,
followed by "Version" and the Cisco IOS Software release name. Other
Cisco devices do not have the show version command or may provide
different output.

The following example identifies a Cisco product that is running
Cisco IOS Software Release 15.0(1)M1 with an installed image name of
C3900-UNIVERSALK9-M:

Router> show version 
Cisco IOS Software, C3900 Software (C3900-UNIVERSALK9-M), Version 15.0(1)M1, RELEASE SOFTWARE (fc1)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2009 by Cisco Systems, Inc.
Compiled Wed 02-Dec-09 17:17 by prod_rel_team
!--- output truncated 

Additional information about Cisco IOS Software release naming
conventions is available in "White Paper: Cisco IOS and NX-OS
Software Reference Guide" at http://www.cisco.com/web/about/security/
intelligence/ios-ref.html.



Products Confirmed Not Vulnerable
+--------------------------------

The following products are confirmed not vulnerable:

  * Cisco PIX 500 Series Firewall
  * Cisco ASA 5500 Series Adaptive Security Appliance
  * Firewall Services Module (FWSM) for Catalyst 6500 Series Switches
    and 7600 Series Routers
  * Virtual Firewall (VFW) application on the multiservice blade
    (MSB) on the Cisco XR 12000 Series Router
  * Cisco ACE Application Control Engine Module
  * Cisco IOS devices configured with legacy Cisco IOS Firewall
    support 
  * Cisco IOS XR Software
  * Cisco IOS XE Software
  * Cisco Catalyst 6500 Series ASA Services Module
  * Context-Based Access Control (CBAC) 

No other Cisco products are currently known to be affected by these
vulnerabilities.

Details
=======

Firewalls are networking devices that control access to the network
assets of an organization. Firewalls are often positioned at the
entrance points of networks. Cisco IOS Software provides a set of
security features that allow the configuration of a firewall policy
to match an organization's requirements. 

The vulnerabilities described in this advisory affect the Zone-Based
Firewall feature. The Zone-Based Policy Firewall (also known as
Zone-Policy Firewall or ZFW) updates the firewall configuration from
the older interface-based model to a more flexible, more easily
understood zone-based model. Interfaces are assigned to zones, and
inspection policy is applied to traffic moving between the zones.
Inter-zone policies offer considerable flexibility and granularity,
so different inspection policies can be applied to multiple host
groups connected to the same router interface.

More information on the Zone-Based Firewall is available at:
http://www.cisco.com/en/US/products/ps6441/products_feature_guide09186a008060f6dd.html

Memory Leak Associated with Crafted IP Packets
+---------------------------------------------

A vulnerability exists in the Zone-Based Firewall implementation in
Cisco IOS Software that could allow a remote attacker to cause an
affected device to reload or to trigger memory leaks that may result
in system instabilities. These vulnerabilities are triggered when the
device that is running Cisco IOS Software processes crafted IP
packets. Only traffic destined to an IP address configured on the
device can trigger the vulnerability; transit traffic is not an
exploit vector.

This vulnerability is documented in Cisco bug ID CSCto89536 
and has been assigned the Common Vulnerabilities and Exposures 
(CVE) identifier CVE-2012-1310.

Memory Leak in HTTP Inspection
+---------------------------------------------

The HTTP Inspection Engine feature allows users to configure their
Cisco IOS Firewall to detect and filter HTTP connections-such as
tunneling over port 80, unauthorized request methods, and non-HTTP
compliant file transfers-that are not authorized within the scope of
the security policy configuration.

A vulnerability exists in the implementation of the Cisco IOS
Software HTTP inspection feature that could allow a remote attacker
to cause an affected device to reload or to trigger memory leaks that
may result in system instabilities. This vulnerability is triggered
when the device that is running Cisco IOS Software processes certain
HTTP messages. Transit HTTP traffic is an exploit vector.

This vulnerability is documented in Cisco bug ID CSCtq36153 
and has been assigned CVE ID CVE-2012-0387.

More information on HTTP inspection is available at:
http://www.cisco.com/en/US/docs/ios/12_3t/12_3t14/feature/guide/gt_fwapc.html

Memory Leak in H.323 Inspection
+---------------------------------------------
H.323 is the ITU standard for real-time multimedia communications and
conferencing over packet-based (IP) networks. A vulnerability exists
in the implementation of the Cisco IOS Software H.323 inspection
feature that could allow a remote attacker to cause an affected
device to reload or to trigger memory leaks that may result in system
instabilities. This vulnerability is triggered when the device that
is running Cisco IOS Software processes malformed H.323 messages.
Transit H.323 traffic is an exploit vector.

This vulnerability is documented in Cisco bug ID CSCtq45553 
and has been assigned the CVE ID CVE-2012-0388.

More information on H.323 inspection is available at: 
http://www.cisco.com/en/US/docs/ios-xml/ios/sec_data_zbf/configuration/15-2mt/fw-h323-v3v4-sup.html

Memory Leak in SIP Inspection
+---------------------------------------------
SIP is a popular signaling protocol that is used to manage voice and
video calls across IP networks, such as the Internet. SIP is
responsible for handling all aspects of call setup and termination.
Voice and video are the most popular types of sessions that SIP
handles, but the protocol has the flexibility to accommodate other
applications that require call setup and termination. SIP call
signaling can use UDP (port 5060), TCP (port 5060), or Transport
Layer Security (TLS; TCP port 5061) as the underlying transport
protocol.

A vulnerability exists in the implementation of the Cisco IOS SIP
inspection feature that could allow a remote attacker to cause an
affected device to reload or to trigger memory leaks that may result
in system instabilities. This vulnerability is triggered when the
device that is running Cisco IOS Software processes crafted SIP
messages. Transit SIP traffic is an exploit vector.

This vulnerability is documented in Cisco bug ID CSCti46171 
and has been assigned CVE ID CVE-2012-1315.

More information on SIP inspection is available at: 
http://www.cisco.com/en/US/docs/ios/security/configuration/guide/sec_sip_alg_aic.html

Memory Leak Detection
+---------------------------------------------
Detected memory leaks can be viewed using the command show memory
debug leaks chunks in privileged EXEC mode, as shown in the following
example:

    Router# show memory debug leaks chunks 

    Adding blocks for GD... I/O memory Address Size Alloc_pc PID
    Alloc-Proc Name Chunk Elements:
    AllocPC Address Size Parent Name Processor memory Address Size
    Alloc_pc PID Alloc-Proc Name
    4733113C 188 419CB164 129 IP Input FW h225 tpkt

The previous example shows a memory leak in the process FW h225 tpkt.
The show memory debug leaks command was introduced in Cisco IOS
Software versions 12.3(8)T1 and 12.2(25)S.

Caution: All show memory debug commands must be used on customer
networks only to diagnose the router for memory leaks when memory
depletion is observed. These commands may cause high CPU utilization
and may cause time-sensitive protocols to flap. These commands are
recommended to be used in maintenance windows.

Vulnerability Scoring Details
=============================

Cisco has scored the vulnerabilities in this advisory based on the
Common Vulnerability Scoring System (CVSS). The CVSS scoring in this
security advisory is in accordance with CVSS version 2.0.

CVSS is a standards-based scoring method that conveys vulnerability
severity and helps organizations determine the urgency and priority
of a response.

Cisco has provided a base and temporal score. Customers can also
compute environmental scores that help determine the impact of the
vulnerability in their own networks.

Cisco has provided additional information regarding CVSS at the
following link:

http://www.cisco.com/web/about/security/intelligence/cvss-qandas.html

Cisco has also provided a CVSS calculator to compute the
environmental impact for individual networks at the following link:

http://intellishield.cisco.com/security/alertmanager/cvss


* Memory Leak associated with crafted IP packets

CVSS Base Score - 7.8
    Access Vector -            Network
    Access Complexity -        Low
    Authentication -           None
    Confidentiality Impact -   None
    Integrity Impact -         None
    Availability Impact -      Complete

CVSS Temporal Score - 6.4
    Exploitability -           Functional
    Remediation Level -        Official-Fix
    Report Confidence -        Confirmed

* Memory Leak in HTTP inspection

CVSS Base Score - 7.8
    Access Vector -            Network
    Access Complexity -        Low
    Authentication -           None
    Confidentiality Impact -   None
    Integrity Impact -         None
    Availability Impact -      Complete

CVSS Temporal Score - 6.4
    Exploitability -           Functional
    Remediation Level -        Official-Fix
    Report Confidence -        Confirmed

*  Memory Leak in H.323 inspection

CVSS Base Score - 7.8
    Access Vector -            Network
    Access Complexity -        Low
    Authentication -           None
    Confidentiality Impact -   None
    Integrity Impact -         None
    Availability Impact -      Complete

CVSS Temporal Score - 6.4
    Exploitability -           Functional
    Remediation Level -        Official-Fix
    Report Confidence -        Confirmed


* Memory Leak in SIP Inspection

CVSS Base Score - 7.8
    Access Vector -            Network
    Access Complexity -        Low
    Authentication -           None
    Confidentiality Impact -   None
    Integrity Impact -         None
    Availability Impact -      Complete

CVSS Temporal Score - 6.4
    Exploitability -           Functional
    Remediation Level -        Official-Fix
    Report Confidence -        Confirmed


Impact
======

Successful exploitation of these vulnerabilities may result in a
reload of the affected device. Repeated exploit attempts may result
in a sustained denial of service (DoS) attack.

Software Versions and Fixes
===========================

When considering software upgrades, customers are advised to consult
the Cisco Security Advisories and Responses archive at:
http://www.cisco.com/go/psirt and review subsequent advisories to determine
exposure and a complete upgrade solution.

In all cases, customers should ensure that the devices to be upgraded
contain sufficient memory and confirm that current hardware and
software configurations will continue to be supported properly by the
new release. If the information is not clear, customers are advised
to contact the Cisco Technical Assistance Center (TAC) or their
contracted maintenance providers. 

Cisco IOS Software
+-----------------
Each row of the following Cisco IOS Software table corresponds to a
Cisco IOS Software train. If a particular train is vulnerable, the
earliest releases that contain the fix are listed in the First Fixed
Release column. The First Fixed Release for All Advisories in the
March 2012 Bundled Publication column lists the earliest possible
releases that correct all the published vulnerabilities in the Cisco
IOS Software Security Advisory bundled publication. Cisco recommends
upgrading to the latest available release, where possible.

The Cisco IOS Software Checker allows customers to search for Cisco
Security Advisories that address specific Cisco IOS Software
releases. This tool is available on the Cisco Security Intelligence
Operations (SIO) portal at:
http://tools.cisco.com/security/center/selectIOSVersion.x

+------------------------------------------+
|   Major    |         Availability of     |
|  Release   |      Repaired Releases      |
|------------+-----------------------------|
|            |              | First Fixed  |
|            |              | Release for  |
|            |              |     All      |
|            |              |  Advisories  |
|  Affected  | First Fixed  | in the March |
| 12.0-Based |   Release    |  2012 Cisco  |
|  Releases  |              | IOS Software |
|            |              |   Security   |
|            |              |   Advisory   |
|            |              |   Bundled    |
|            |              | Publication  |
|------------------------------------------|
|     There are no affected 12.0 based     |
|                 releases                 |
|------------------------------------------|
|            |              | First Fixed  |
|            |              | Release for  |
|            |              |     All      |
|            |              |  Advisories  |
|  Affected  | First Fixed  | in the March |
| 12.2-Based |   Release    |  2012 Cisco  |
|  Releases  |              | IOS Software |
|            |              |   Security   |
|            |              |   Advisory   |
|            |              |   Bundled    |
|            |              | Publication  |
|------------------------------------------|
|     There are no affected 12.2 based     |
|                 releases                 |
|------------------------------------------|
|            |              | First Fixed  |
|            |              | Release for  |
|            |              |     All      |
|            |              |  Advisories  |
|  Affected  | First Fixed  | in the March |
| 12.3-Based |   Release    |  2012 Cisco  |
|  Releases  |              | IOS Software |
|            |              |   Security   |
|            |              |   Advisory   |
|            |              |   Bundled    |
|            |              | Publication  |
|------------------------------------------|
|     There are no affected 12.3 based     |
|                 releases                 |
|------------------------------------------|
|            |              | First Fixed  |
|            |              | Release for  |
|            |              |     All      |
|            |              |  Advisories  |
|  Affected  | First Fixed  | in the March |
| 12.4-Based |   Release    |  2012 Cisco  |
|  Releases  |              | IOS Software |
|            |              |   Security   |
|            |              |   Advisory   |
|            |              |   Bundled    |
|            |              | Publication  |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
| 12.4       | Not          | First fixed  |
|            | vulnerable   | in Release   |
|            |              | 15.0M        |
|------------+--------------+--------------|
|            | Vulnerable;  | Vulnerable;  |
|            | contact your | contact your |
|            | support      | support      |
|            | organization | organization |
|            | per the      | per the      |
| 12.4GC     | instructions | instructions |
|            | in Obtaining | in Obtaining |
|            | Fixed        | Fixed        |
|            | Software     | Software     |
|            | section of   | section of   |
|            | this         | this         |
|            | advisory.    | advisory.    |
|------------+--------------+--------------|
| 12.4JA     | Not          | 12.4(23c)JA4 |
|            | vulnerable   | 12.4(25e)JA  |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
| 12.4JAX    | Not          | First fixed  |
|            | vulnerable   | in Release   |
|            |              | 12.4JA       |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
|            |              | contact your |
|            |              | support      |
|            |              | organization |
|            |              | per the      |
| 12.4JDA    | Not          | instructions |
|            | vulnerable   | in Obtaining |
|            |              | Fixed        |
|            |              | Software     |
|            |              | section of   |
|            |              | this         |
|            |              | advisory.    |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
|            |              | contact your |
|            |              | support      |
|            |              | organization |
|            |              | per the      |
| 12.4JDC    | Not          | instructions |
|            | vulnerable   | in Obtaining |
|            |              | Fixed        |
|            |              | Software     |
|            |              | section of   |
|            |              | this         |
|            |              | advisory.    |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
|            |              | contact your |
|            |              | support      |
|            |              | organization |
|            |              | per the      |
| 12.4JDD    | Not          | instructions |
|            | vulnerable   | in Obtaining |
|            |              | Fixed        |
|            |              | Software     |
|            |              | section of   |
|            |              | this         |
|            |              | advisory.    |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
|            |              | contact your |
|            |              | support      |
|            |              | organization |
|            |              | per the      |
| 12.4JDE    | Not          | instructions |
|            | vulnerable   | in Obtaining |
|            |              | Fixed        |
|            |              | Software     |
|            |              | section of   |
|            |              | this         |
|            |              | advisory.    |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
|            |              | contact your |
|            |              | support      |
|            |              | organization |
|            |              | per the      |
| 12.4JHA    | Not          | instructions |
|            | vulnerable   | in Obtaining |
|            |              | Fixed        |
|            |              | Software     |
|            |              | section of   |
|            |              | this         |
|            |              | advisory.    |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
|            |              | contact your |
|            |              | support      |
|            |              | organization |
|            |              | per the      |
| 12.4JHB    | Not          | instructions |
|            | vulnerable   | in Obtaining |
|            |              | Fixed        |
|            |              | Software     |
|            |              | section of   |
|            |              | this         |
|            |              | advisory.    |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
|            |              | contact your |
|            |              | support      |
|            |              | organization |
|            |              | per the      |
| 12.4JHC    | Not          | instructions |
|            | vulnerable   | in Obtaining |
|            |              | Fixed        |
|            |              | Software     |
|            |              | section of   |
|            |              | this         |
|            |              | advisory.    |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
|            |              | contact your |
|            |              | support      |
|            |              | organization |
|            |              | per the      |
| 12.4JK     | Not          | instructions |
|            | vulnerable   | in Obtaining |
|            |              | Fixed        |
|            |              | Software     |
|            |              | section of   |
|            |              | this         |
|            |              | advisory.    |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
|            |              | contact your |
|            |              | support      |
|            |              | organization |
|            |              | per the      |
| 12.4JL     | Not          | instructions |
|            | vulnerable   | in Obtaining |
|            |              | Fixed        |
|            |              | Software     |
|            |              | section of   |
|            |              | this         |
|            |              | advisory.    |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
| 12.4JX     | Not          | First fixed  |
|            | vulnerable   | in Release   |
|            |              | 12.4JA       |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
| 12.4JY     | Not          | First fixed  |
|            | vulnerable   | in Release   |
|            |              | 12.4JA       |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
| 12.4JZ     | Not          | First fixed  |
|            | vulnerable   | in Release   |
|            |              | 12.4JA       |
|------------+--------------+--------------|
|            | 12.4(22)MD3; | 12.4(22)MD3; |
| 12.4MD     | Available on | Available on |
|            | 30-MAR-12    | 30-MAR-12    |
|------------+--------------+--------------|
| 12.4MDA    | 12.4(24)     | 12.4(24)     |
|            | MDA11        | MDA11        |
|------------+--------------+--------------|
| 12.4MDB    | 12.4(24)     | 12.4(24)     |
|            | MDB5a        | MDB5a        |
|------------+--------------+--------------|
| 12.4MDC    | Not          | Not          |
|            | vulnerable   | vulnerable   |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
|            |              | contact your |
|            |              | support      |
|            | Releases up  | organization |
|            | to and       | per the      |
| 12.4MR     | including    | instructions |
|            | 12.4(19)MR3  | in Obtaining |
|            | are not      | Fixed        |
|            | vulnerable.  | Software     |
|            |              | section of   |
|            |              | this         |
|            |              | advisory.    |
|------------+--------------+--------------|
|            | Vulnerable;  | Vulnerable;  |
|            | contact your | contact your |
|            | support      | support      |
|            | organization | organization |
|            | per the      | per the      |
| 12.4MRA    | instructions | instructions |
|            | in Obtaining | in Obtaining |
|            | Fixed        | Fixed        |
|            | Software     | Software     |
|            | section of   | section of   |
|            | this         | this         |
|            | advisory.    | advisory.    |
|------------+--------------+--------------|
|            | Vulnerable;  | Vulnerable;  |
| 12.4MRB    | First fixed  | First fixed  |
|            | in Release   | in Release   |
|            | 15.0M        | 15.0M        |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
| 12.4SW     | Not          | First fixed  |
|            | vulnerable   | in Release   |
|            |              | 15.0M        |
|------------+--------------+--------------|
|            | 12.4(24)T7   |              |
|            |              |              |
|            | Releases up  | 12.4(15)T17  |
| 12.4T      | to and       | 12.4(24)T7   |
|            | including    |              |
|            | 12.4(15)T17  |              |
|            | are not      |              |
|            | vulnerable.  |              |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
| 12.4XA     | Not          | First fixed  |
|            | vulnerable   | in Release   |
|            |              | 15.0M        |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
| 12.4XB     | Not          | First fixed  |
|            | vulnerable   | in Release   |
|            |              | 12.4T        |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
| 12.4XC     | Not          | First fixed  |
|            | vulnerable   | in Release   |
|            |              | 15.0M        |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
| 12.4XD     | Not          | First fixed  |
|            | vulnerable   | in Release   |
|            |              | 15.0M        |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
| 12.4XE     | Not          | First fixed  |
|            | vulnerable   | in Release   |
|            |              | 15.0M        |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
| 12.4XF     | Not          | First fixed  |
|            | vulnerable   | in Release   |
|            |              | 15.0M        |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
| 12.4XG     | Not          | First fixed  |
|            | vulnerable   | in Release   |
|            |              | 15.0M        |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
| 12.4XJ     | Not          | First fixed  |
|            | vulnerable   | in Release   |
|            |              | 15.0M        |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
| 12.4XK     | Not          | First fixed  |
|            | vulnerable   | in Release   |
|            |              | 15.0M        |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
|            |              | contact your |
|            |              | support      |
|            |              | organization |
|            |              | per the      |
| 12.4XL     | Not          | instructions |
|            | vulnerable   | in Obtaining |
|            |              | Fixed        |
|            |              | Software     |
|            |              | section of   |
|            |              | this         |
|            |              | advisory.    |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
| 12.4XM     | Not          | First fixed  |
|            | vulnerable   | in Release   |
|            |              | 15.0M        |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
|            |              | contact your |
|            |              | support      |
|            |              | organization |
|            |              | per the      |
| 12.4XN     | Not          | instructions |
|            | vulnerable   | in Obtaining |
|            |              | Fixed        |
|            |              | Software     |
|            |              | section of   |
|            |              | this         |
|            |              | advisory.    |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
|            |              | contact your |
|            |              | support      |
|            |              | organization |
|            |              | per the      |
| 12.4XP     | Not          | instructions |
|            | vulnerable   | in Obtaining |
|            |              | Fixed        |
|            |              | Software     |
|            |              | section of   |
|            |              | this         |
|            |              | advisory.    |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
| 12.4XQ     | Not          | First fixed  |
|            | vulnerable   | in Release   |
|            |              | 15.0M        |
|------------+--------------+--------------|
|            | Vulnerable;  |              |
|            | First fixed  |              |
|            | in Release   |              |
|            | 12.4T        | Vulnerable;  |
| 12.4XR     | Releases up  | First fixed  |
|            | to and       | in Release   |
|            | including    | 12.4T        |
|            | 12.4(15)XR10 |              |
|            | are not      |              |
|            | vulnerable.  |              |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
| 12.4XT     | Not          | First fixed  |
|            | vulnerable   | in Release   |
|            |              | 15.0M        |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
|            |              | contact your |
|            |              | support      |
|            |              | organization |
|            |              | per the      |
| 12.4XV     | Not          | instructions |
|            | vulnerable   | in Obtaining |
|            |              | Fixed        |
|            |              | Software     |
|            |              | section of   |
|            |              | this         |
|            |              | advisory.    |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
| 12.4XW     | Not          | First fixed  |
|            | vulnerable   | in Release   |
|            |              | 15.0M        |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
| 12.4XY     | Not          | First fixed  |
|            | vulnerable   | in Release   |
|            |              | 15.0M        |
|------------+--------------+--------------|
|            | Vulnerable;  | Vulnerable;  |
| 12.4XZ     | First fixed  | First fixed  |
|            | in Release   | in Release   |
|            | 15.0M        | 15.0M        |
|------------+--------------+--------------|
|            | Vulnerable;  | Vulnerable;  |
| 12.4YA     | First fixed  | First fixed  |
|            | in Release   | in Release   |
|            | 15.0M        | 15.0M        |
|------------+--------------+--------------|
|            | Vulnerable;  | Vulnerable;  |
|            | contact your | contact your |
|            | support      | support      |
|            | organization | organization |
|            | per the      | per the      |
| 12.4YB     | instructions | instructions |
|            | in Obtaining | in Obtaining |
|            | Fixed        | Fixed        |
|            | Software     | Software     |
|            | section of   | section of   |
|            | this         | this         |
|            | advisory.    | advisory.    |
|------------+--------------+--------------|
|            | Vulnerable;  | Vulnerable;  |
|            | contact your | contact your |
|            | support      | support      |
|            | organization | organization |
|            | per the      | per the      |
| 12.4YD     | instructions | instructions |
|            | in Obtaining | in Obtaining |
|            | Fixed        | Fixed        |
|            | Software     | Software     |
|            | section of   | section of   |
|            | this         | this         |
|            | advisory.    | advisory.    |
|------------+--------------+--------------|
| 12.4YE     | 12.4(24)YE3d | 12.4(24)YE3d |
|------------+--------------+--------------|
| 12.4YG     | 12.4(24)YG4  | 12.4(24)YG4  |
|------------+--------------+--------------|
|            |              | First Fixed  |
|            |              | Release for  |
|            |              |     All      |
|            |              |  Advisories  |
|  Affected  | First Fixed  | in the March |
| 15.0-Based |   Release    |  2012 Cisco  |
|  Releases  |              | IOS Software |
|            |              |   Security   |
|            |              |   Advisory   |
|            |              |   Bundled    |
|            |              | Publication  |
|------------+--------------+--------------|
| 15.0M      | 15.0(1)M8    | 15.0(1)M8    |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
|            |              | contact your |
|            |              | support      |
|            |              | organization |
|            |              | per the      |
| 15.0MR     | Not          | instructions |
|            | vulnerable   | in Obtaining |
|            |              | Fixed        |
|            |              | Software     |
|            |              | section of   |
|            |              | this         |
|            |              | advisory.    |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
|            |              | contact your |
|            |              | support      |
|            |              | organization |
|            |              | per the      |
| 15.0MRA    | Not          | instructions |
|            | vulnerable   | in Obtaining |
|            |              | Fixed        |
|            |              | Software     |
|            |              | section of   |
|            |              | this         |
|            |              | advisory.    |
|------------+--------------+--------------|
|            |              | 15.0(1)S5    |
|            |              | Cisco IOS XE |
|            | Not          | devices:     |
| 15.0S      | vulnerable   | Please see   |
|            |              | Cisco IOS XE |
|            |              | Software     |
|            |              | Availability |
|------------+--------------+--------------|
| 15.0SA     | Not          | Not          |
|            | vulnerable   | vulnerable   |
|------------+--------------+--------------|
| 15.0SE     | Not          | 15.0(1)SE1   |
|            | vulnerable   |              |
|------------+--------------+--------------|
|            |              | 15.0(2)SG2   |
|            |              | Cisco IOS XE |
|            | Not          | devices:     |
| 15.0SG     | vulnerable   | Please see   |
|            |              | Cisco IOS XE |
|            |              | Software     |
|            |              | Availability |
|------------+--------------+--------------|
| 15.0SY     | Not          | 15.0(1)SY1   |
|            | vulnerable   |              |
|------------+--------------+--------------|
|            | Vulnerable;  | Vulnerable;  |
| 15.0XA     | First fixed  | First fixed  |
|            | in Release   | in Release   |
|            | 15.1T        | 15.1T        |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
|            |              | First fixed  |
|            |              | in Release   |
|            |              | 15.0SG Cisco |
| 15.0XO     | Not          | IOS XE       |
|            | vulnerable   | devices:     |
|            |              | Please see   |
|            |              | Cisco IOS XE |
|            |              | Software     |
|            |              | Availability |
|------------+--------------+--------------|
|            |              | First Fixed  |
|            |              | Release for  |
|            |              |     All      |
|            |              |  Advisories  |
|  Affected  | First Fixed  | in the March |
| 15.1-Based |   Release    |  2012 Cisco  |
|  Releases  |              | IOS Software |
|            |              |   Security   |
|            |              |   Advisory   |
|            |              |   Bundled    |
|            |              | Publication  |
|------------+--------------+--------------|
| 15.1EY     | Not          | 15.1(2)EY2   |
|            | vulnerable   |              |
|------------+--------------+--------------|
| 15.1GC     | 15.1(2)GC2   | 15.1(2)GC2   |
|------------+--------------+--------------|
|            | 15.1(4)M3    | 15.1(4)M4;   |
| 15.1M      |              | Available on |
|            |              | 30-MAR-12    |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
|            |              | contact your |
|            |              | support      |
|            |              | organization |
|            |              | per the      |
| 15.1MR     | Not          | instructions |
|            | vulnerable   | in Obtaining |
|            |              | Fixed        |
|            |              | Software     |
|            |              | section of   |
|            |              | this         |
|            |              | advisory.    |
|------------+--------------+--------------|
|            |              | 15.1(3)S2    |
|            |              | Cisco IOS XE |
|            | Not          | devices:     |
| 15.1S      | vulnerable   | Please see   |
|            |              | Cisco IOS XE |
|            |              | Software     |
|            |              | Availability |
|------------+--------------+--------------|
| 15.1SG     | Not          | Not          |
|            | vulnerable   | vulnerable   |
|------------+--------------+--------------|
|            |              | Vulnerable;  |
|            |              | contact your |
|            |              | support      |
|            |              | organization |
|            |              | per the      |
| 15.1SNG    | Not          | instructions |
|            | vulnerable   | in Obtaining |
|            |              | Fixed        |
|            |              | Software     |
|            |              | section of   |
|            |              | this         |
|            |              | advisory.    |
|------------+--------------+--------------|
| 15.1SNH    | Not          | Not          |
|            | vulnerable   | vulnerable   |
|------------+--------------+--------------|
| 15.1T      | 15.1(3)T3    | 15.1(3)T3    |
|------------+--------------+--------------|
|            | Vulnerable;  | Vulnerable;  |
| 15.1XB     | First fixed  | First fixed  |
|            | in Release   | in Release   |
|            | 15.1T        | 15.1T        |
|------------+--------------+--------------|
|            |              | First Fixed  |
|            |              | Release for  |
|            |              |     All      |
|            |              |  Advisories  |
|  Affected  | First Fixed  | in the March |
| 15.2-Based |   Release    |  2012 Cisco  |
|  Releases  |              | IOS Software |
|            |              |   Security   |
|            |              |   Advisory   |
|            |              |   Bundled    |
|            |              | Publication  |
|------------+--------------+--------------|
| 15.2GC     | 15.2(1)GC2   | 15.2(1)GC2   |
|------------+--------------+--------------|
|            |              | 15.2(1)S1    |
|            |              | Cisco IOS XE |
|            |              | devices:     |
| 15.2S      | Not          | Please see   |
|            | vulnerable   | Cisco IOS XE |
|            |              | Software     |
|            |              | Availability |
|            |              |              |
|------------+--------------+--------------|
|            |              | 15.2(1)T2    |
|            | 15.2(1)T2    | 15.2(2)T1    |
| 15.2T      | 15.2(2)T     | 15.2(3)T;    |
|            | 15.2(2)T1    | Available on |
|            |              | 30-MAR-12    |
+------------------------------------------+

* Cisco Catalyst 3550 Series Switches support the Internet Key
Exchange (IKE) feature and are vulnerable to Cisco bug ID CSCts38429
when the devices are running Layer 3 images; however, this product
reached the End of Software Maintenance milestone.  Cisco 3550 Series
SMI Switches that are running Layer 2 images do not support IKE and
are not vulnerable.  No other Cisco devices that run 12.2SE-based
software are vulnerable.

Cisco IOS XE Software
+--------------------

Cisco IOS XE Software is not affected by the vulnerabilities that are
disclosed in this document. 

For a mapping of Cisco IOS XE Software releases to Cisco IOS Software
releases, refer to Cisco IOS XE 2 Release Notes, Cisco IOS XE 3S
Release Notes, and Cisco IOS XE 3SG Release Notes.

Cisco IOS XR Software
+--------------------

Cisco IOS XR Software is not affected by any of the vulnerabilities
disclosed in the March 2012 Cisco IOS Software Security Advisory
Bundled Publication.



Workarounds
===========

There are no workarounds that mitigate the vulnerabilities described
in this advisory.

Obtaining Fixed Software
========================

Cisco has released free software updates that address the
vulnerabilities described in this advisory. Prior to deploying
software, customers are advised to consult their maintenance
providers or check the software for feature set compatibility and
known issues that are specific to their environments.

Customers may only install and expect support for feature sets they
have purchased. By installing, downloading, accessing, or otherwise
using such software upgrades, customers agree to follow the terms of
the Cisco software license at:
http://www.cisco.com/en/US/docs/general/warranty/English/EU1KEN_.html
or as set forth at http://www.cisco.com/public/sw-center/sw-usingswc.shtml

Do not contact psirt@...co.com or security-alert@...co.com for
software upgrades.

Customers with Service Contracts
+-------------------------------

Customers with contracts should obtain upgraded software through
their regular update channels. For most customers, upgrades should be
obtained through the Software Center on Cisco.com at:
http://www.cisco.com

Customers Using Third-Party Support Organizations
+------------------------------------------------

Customers with Cisco products that are provided or maintained through
prior or existing agreements with third-party support organizations,
such as Cisco Partners, authorized resellers, or service providers,
should contact that organization for assistance with the appropriate
course of action.

The effectiveness of any workaround or fix depends on specific
customer situations, such as product mix, network topology, traffic
behavior, and organizational mission. Because of the variety of
affected products and releases, customers should consult their
service providers or support organizations to ensure that any applied
workaround or fix is the most appropriate in the intended network
before it is deployed.

Customers Without Service Contracts
+----------------------------------

Customers who purchase directly from Cisco but do not hold a Cisco
service contract and customers who make purchases through third-party
vendors but are unsuccessful in obtaining fixed software through
their point of sale should obtain upgrades by contacting the Cisco
Technical Assistance Center (TAC):

  * +1 800 553 2447 (toll free from within North America)
  * +1 408 526 7209 (toll call from anywhere in the world)
  * e-mail: tac@...co.com

Customers should have the product serial number available and be
prepared to provide the URL of this advisory as evidence of
entitlement to a free upgrade. Customers without service contracts
should request free upgrades through the TAC.

Refer to Cisco Worldwide Contacts at:
http://www.cisco.com/en/US/support/tsd_cisco_worldwide_contacts.html 
for additional TAC contact information, including localized telephone 
numbers, instructions, and e-mail addresses for support in various languages.

Exploitation and Public Announcements
=====================================

The Cisco Product Security Incident Response Team (PSIRT) is not
aware of any public announcements or malicious use of the
vulnerabilities that are described in this advisory. 

These vulnerabilities were discovered by Cisco during normal internal
security testing.

Status of This Notice: Final

THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY
KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF
MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE
INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS
AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS
DOCUMENT AT ANY TIME.

A stand-alone copy or Paraphrase of the text of this document that
omits the distribution URL in the following section is an
uncontrolled copy, and may lack important information or contain
factual errors.


Distribution
============

This advisory is posted on Cisco Security Intelligence Operations at
the following link:

http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20120328-zbfw

Additionally, a text version of this advisory is clear signed with
the Cisco PSIRT PGP key and circulated among the following e-mail
addresses:

  * cust-security-announce@...co.com
  * first-bulletins@...ts.first.org
  * bugtraq@...urityfocus.com
  * vulnwatch@...nwatch.org
  * cisco@...t.colorado.edu
  * cisco-nsp@...k.nether.net
  * full-disclosure@...ts.grok.org.uk

Future updates of this advisory, if any, will reside on Cisco.com but
may not be announced on mailing lists. Users can monitor this
advisory's URL for any updates. 


Revision History
================

+---------------------------------------+
| Revision |               | Initial    |
| 1.0      | 2012-March-28 | public     |
|          |               | release    |
+---------------------------------------+

Cisco Security Procedures
=========================

Complete information about reporting security vulnerabilities in
Cisco products, obtaining assistance with security incidents, and
registering to receive security information from Cisco is available
on Cisco.com at:
http://www.cisco.com/en/US/products/products_security_vulnerability_policy.html
This web page includes instructions for press inquiries regarding Cisco 
Security Advisories.

All Cisco Security Advisories are available at:
http://www.cisco.com/go/psirt


+--------------------------------------------------------------------
Copyright 2010-2012 Cisco Systems, Inc. All rights reserved.
+--------------------------------------------------------------------
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.5 (SunOS)

iFcDBQFPcSUMQXnnBKKRMNARCA3iAP48lwmrPR8E6Wi6CVHpEpqoDUnfuHJA/e4E
tz+jl1voLwD+NNC2Y5SFONTzfed+n4Ib3cxVLPAwafgVDlr+HhITJgc=
=Na2V
-----END PGP SIGNATURE-----

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
