
Date: Mon, 04 Jun 2012 05:50:34 -0700
From: Larissa Shapiro <larissas@....org>
To: bugtraq@...urityfocus.com, full-disclosure@...ts.grok.org.uk
Subject: ISC Security Advisory: Handling of zero length
 rdata can cause named to terminate, unexpectedly



-------- Original Message --------
Subject: 	ISC Security Advisory: Handling of zero length rdata can cause
named to terminate,unexpectedly
Date: 	Mon, 04 Jun 2012 05:25:50 -0700
From: 	Larissa Shapiro <larissas@....org>
To: 	bind-announce@...ts.isc.org


ISC Security Advisory:

Note: This email advisory is provided for your information. The most up to date advisory information 
will always be at: http://www.isc.org/software/bind/advisories/cve-2012-1667 please use this URL for 
the most up to date advisory information.


Title: Handling of zero length rdata can cause named to terminate
unexpectedly

Processing of DNS resource records where the rdata field is zero length
may cause various issues for the servers handling them.

CVE: CVE-2012-1667

Document Version: 1.0

Posting date: 4 June 2012

Program Impacted: BIND

Versions affected: 9.0.x -> 9.6.x, 9.4-ESV->9.4-ESV-R5-P1,
9.6-ESV->9.6-ESV-R7, 9.7.0->9.7.6, 9.8.0->9.8.3, 9.9.0->9.9.1

Severity: Critical

Exploitable: Remotely

Description:

This problem was uncovered while testing with experimental DNS record
types. It is possible to add records to BIND with null (zero length)
rdata fields.

Processing of these records may lead to unexpected outcomes. Recursive
servers may crash or disclose some portion of memory to the client.
Secondary servers may crash on restart after transferring a zone
containing these records. Master servers may corrupt zone data if the
zone option "auto-dnssec" is set to "maintain". Other unexpected
problems that are not listed here may also be encountered.

Impact: This issue primarily affects recursive nameservers.
Authoritative nameservers will only be impacted if an administrator
configures experimental record types with no data. If the server is
configured this way, then secondaries can crash on restart after
transferring that zone. Zone data on the master can become corrupted if
the zone with those records has named configured to manage the DNSSEC
key rotation.

CVSS Score: 8.5

CVSS Equation: (AV:N/AC:L/Au:N/C:P/I:N/A:C)

For more information on the Common Vulnerability Scoring System and to
obtain your specific environmental score please visit:
http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2&vector=(AV:N/AC:L/Au:N/C:P/I:N/A:C)

Workarounds:

Workarounds are under investigation, but none are known at this time.

Solution:

Upgrade to one of the following versions:
https://www.isc.org/software/bind/96-esv-r7-p1
https://www.isc.org/software/bind/976-p1
https://www.isc.org/software/bind/983-p1
https://www.isc.org/software/bind/991-p1

Exploit Status: No known active exploits but a public discussion of the
issue has taken place on a public mailing list.

Acknowledgment: Dan Luther, Level3 Communications, for finding the
issue, Jeffrey A. Spain, Cincinnati Day School, for replication and testing.


*Document Revision History: *
1.0 Released to Public 4 June, 2012
1.1 Updated Severity to Critical

References:

- Do you have questions? Questions regarding this advisory should go to
security-officer@....org.

- ISC Security Vulnerability Disclosure Policy: Details of our current
security advisory policy and practice can be found here:
https://www.isc.org/security-vulnerability-disclosure-policy

See our BIND Security Matrix for a complete listing of Security
Vulnerabilites and versions affected.
Note: ISC patches only Currently supported versions. When possible we
indicate EOL versions affected.
Legal Disclaimer:

Internet Systems Consortium (ISC) is providing this notice on an "AS IS"
basis. No warranty or guarantee of any kind is expressed in this notice
and none should be inferred. ISC expressly excludes and disclaims any
warranties regarding this notice or materials referred to in this
notice, including, without limitation, any inferred warranty of
merchantability, fitness for a particular purpose, absence of hidden
defects, or of non-infringement. Your use of, or reliance on, this
notice or materials referred to in this notice is at your own risk. ISC
may change this notice at any time.

A stand-alone copy or paraphrase of the text of this document that omits
the distribution URL in the following section is an uncontrolled copy.
Uncontrolled copies may lack important information, be out of date, or
contain factual errors.

-- 
===========================
Larissa Shapiro
BIND and DHCP Product Manager, Internet Systems Consortium
larissas@....org   +1 650 423 1335   http://www.isc.org
Need BIND or DHCP support? Look to the experts!


Content of type "text/html" skipped

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
