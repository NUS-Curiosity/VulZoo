
Date: Thu, 19 Apr 2012 16:55:32 -0400
From: Shatter <shatter@...secinc.com>
To: 'Bugtraq' <bugtraq@...urityfocus.com>, 'Full Disclosure'
	<full-disclosure@...ts.grok.org.uk>
Subject: Some failed authentication attempts using
 OCIPasswordChange API are not recorded (CVE-2012-0511)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

AppSecInc Team SHATTER Security Advisory

Some failed authentication attempts using OCIPasswordChange API are not
recorded.

Risk Level:
Medium

Affected versions:
Oracle Database Server version 10gR1, 10gR2 (10.2.0.4 and previous
patchsets) and 11gR1 (11.1.0.7 and previous patchsets)


Remote exploitable:
Yes (No authentication is required)

Credits:
This vulnerability was discovered and researched by Esteban Martinez
Fayo of Application Security Inc.

Details:
Oracle Database provides OCIPasswordChange API to change user passwords.
This API can be used while a user is logged on as well as before the
authentication process is completed, this is because it can be used for
accounts that have the password expired so that the user is able to
change an expired password for a new one.
When this API is used to authenticate a user and at the same time change
the password, failed logins attempts are recorded only sporadically.
The failed login attempt will be recorded only when the decryption of
the new password (AUTH_NEW_PASSWORD field) performed by the server, is
successful.  This allows an attacker to perform much more failed logins
attempts than what are actually allowed by password policy.  The
approximate rate of failed login attempts that are recorded is only one
every 200 or more attempts.

Impact:
Remote unauthenticated attackers can perform a much higher numbers of
login attempts without being locked out by the password policy.  In
addition, the failed login attempt is not recorded in database auditing
trails.

Vendor Status:
Vendor was contacted and a patch was released.

Workaround:
Implement a strong password policy.
Use network or directory service based authentication as opposed to
native database authentication.

Fix:
Apply Oracle Critical Patch Update April 2012 available at Oracle Support.

CVE:
CVE-2012-0511

Links:
http://www.oracle.com/technetwork/topics/security/cpuapr2012-366314.html
https://www.teamshatter.com/?p=3440

Timeline:
Vendor Notification - 12/08/2011
Vendor Response - 12/15/2011
Fix - 4/17/2012
Public Disclosure - 4/19/2012


- --
_____________________________________________
Copyright (c) 2012 Application Security, Inc.
http://www.appsecinc.com
About Application Security, Inc.

AppSecInc is a pioneer and leading provider of database security
solutions for the enterprise.
By providing strategic and scalable software-only solutions -
AppDetectivePro for auditors and IT advisors, and DbProtect for the
enterprise - AppSecInc supports the database security lifecycle for some
of the most complex and demanding environments in the world across more
than 1,300 active commercial and government customers.

Leveraging the world's most comprehensive database security
knowledgebase from the company's renowned team of threat researchers,
TeamSHATTER, AppSecInc products help customers achieve unprecedented
levels of data security from nefarious or accidental activities, while
reducing overall risk and helping to ensure continuous regulatory and
industry compliance.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (MingW32) - WinPT 1.4.3
Charset: UTF-8

iEYEARECAAYFAk+Qe2YACgkQRx91imnNIgGbKQCaAmGaN+X+t8TgB9KaE53DEApF
d5UAoJhleLxqf78/sgJZvtG7gsYu8e3a
=+2TC
-----END PGP SIGNATURE-----
_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
