
Date: Wed, 5 Oct 2011 18:15:58 +0100
From: Context IS - Disclosure <disclosure@...textis.co.uk>
To: "bugtraq@...urityfocus.com" <bugtraq@...urityfocus.com>,
	"full-disclosure@...ts.grok.org.uk" <full-disclosure@...ts.grok.org.uk>
Subject: Context IS Advisory - Apache Reverse Proxy Bypass
	Vulnerability

===============================ADVISORY==============================
Systems Affected:    Apache httpd
Severity:            High
Category:            Proxy Bypass
Author:              Context Information Security Ltd
Reported to vendor:  16th November 2011
Advisory Issued:     5th October 2011
Reference:           CVE-2011-3368
===============================ADVISORY==============================
 
Description
-----------
Context discovered a security vulnerability which allows for Apache in reverse proxy mode to be used to access internal/DMZ systems due to a weakness in its handling of URLs being processed by mod_rewrite.
 
Analysis
--------
If the Apache configuration file is configured as follows (as previously recommended by Apache):
 
RewriteRule ^(.*) http://internalserver$1 [P]
 
And not with a trailing slash:
 
RewriteRule ^(.*) http://internalserver/$1 [P]
 
Then a request can be made to the proxy server to alter the URL using the user authentication URI syntax, such as:
 
GET @InternalNotAccessibleServer/console HTTP/1.0
 
Causing the proxy to rewrite the URL to:
 
http://internalserver@...ernalNotAccessibleServer/console
 
And provide access to the internal server which is not externally accessible.
 
For an in-depth analysis of this security issue read Context’s blog at:
http://www.contextis.com/research/blog/reverseproxybypass/
 
Technologies Affected
---------------------
 
Apache httpd 1.3 all versions
Apache httpd 2.x all versions
 
 
 
Vendor Response
---------------
Apache have released a patch for this issue but recommend configuration files are reviewed. 
Patch available from:
http://www.apache.org/dist/httpd/patches/apply_to_2.2.21/
 
 
Disclosure Timeline
-------------------
16th November 2011 – Vendor Notification
5th October 2011 – Patch Released by Apache
 
 
Credits
--------
Michael Jordon and David Robinson of Context Information Security Ltd
 
 
About Context Information Security
----------------------------------
 
Context Information Security is an independent security consultancy specialising in both technical security and information assurance services.
 
The company was founded in 1998. Its client base has grown steadily over the years, thanks in large part to personal recommendations from existing clients who value us as business partners. We believe our success is based on the value our clients place on our product-agnostic, holistic approach; the way we work closely with them to develop a tailored service; and to the independence, integrity and technical skills of our consultants.
 
The company’s client base now includes some of the most prestigious blue chip companies in the world, as well as government organisations. 
 
The best security experts need to bring a broad portfolio of skills to the job, so Context has always sought to recruit staff with extensive business experience as well as technical expertise. Our aim is to provide effective and practical solutions, advice and support: when we report back to clients we always communicate our findings and recommendations in plain terms at a business level as well as in the form of an in-depth technical report.
 
Web:        www.contextis.com
Email:      disclosure@...textis.com
 
 
 
 
_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
