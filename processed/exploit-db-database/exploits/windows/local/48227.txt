# Exploit Title: NetBackup 7.0 - 'NetBackup INET Daemon' Unquoted Service Path
# Discovery by: Alan Mondragon "El Masas"
# Discovery Date: 2020-03-17
# Vendor Homepage: https://www.veritas.com/
# Software Link : https://www.veritas.com/
# Veritas
# Tested Version: 7.0
# Vulnerability Type: Unquoted t Service Path
# Tested on OS: Windows Server 2008 R2 en

# Step to discover Unquoted Service Path:


C:\>wmic service get name, displayname, pathname, startmode | findstr /i "Auto" | findstr /i /v "C:\Windows\\" | findstr /i /v """                                                                                                                                                                                                   Auto
NetBackup Client Service NetBackup INET Daemon
                      C:\Program Files\Veritas\NetBackup\bin\bpinetd.exe
                                                    Auto
C:\>sc qc "NetBackup INET Daemon"
[SC] QueryServiceConfig SUCCESS
        SERVICE_NAME: NetBackup INET Daemon
        TYPE               : 10  WIN32_OWN_PROCESS
        START_TYPE         : 2   AUTO_START
        ERROR_CONTROL      : 1   NORMAL
        BINARY_PATH_NAME   : C:\Program Files\Veritas\NetBackup\bin\bpinetd.exe
        LOAD_ORDER_GROUP   :
        TAG                : 0
        DISPLAY_NAME       : NetBackup Client Service
        DEPENDENCIES       :
        SERVICE_START_NAME : LocalSystem

#Exploit:
# A successful attempt would require the local user to be able to insert their code in the system root path
# undetected by the OS or other security applications where it could potentially be executed during
# application startup or reboot. If successful, the local user's code would execute with the elevated
# privileges of the application.