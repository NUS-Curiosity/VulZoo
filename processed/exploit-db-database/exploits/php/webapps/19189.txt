Title:
======
iScripts EasyCreate CMS v2.0 - Multiple Web Vulnerabilites


Date:
=====
2012-06-02


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=588



VL-ID:
=====
588


Common Vulnerability Scoring System:
====================================
8.3


Introduction:
=============
iScripts EasyCreate is an online web site building tool that can be hosted on your server to provide
web site building services to your clients. iScripts EasyCreate is completely customizable. You can decide
on the branding of the entire web site creation software by setting your logo, brand information, marketing
messages, special offers, custom support links, etc. on the application interface. Since the application is
hosted on your server, you have complete control over the working of the site. The application is easy to
install, and you can have your web site building service up and running in minutes.

Power packed web site builder

iScripts EasyCreate makes creating and managing a professional quality web site quick and easy. The step-by-step
approach allows users to build and upload their sites in a few minutes. To build web sites, users do not have
to have any HTML skills. An expert user can control generated code and get the exact look and feel that he wants.
The software has two editors, for beginner users and advanced used users. Users can drag and drop the page
contents to make web pages easy.

(Copy of the Vendor Homepage: http://www.iscripts.com/easycreate  )


Abstract:
=========
The Vulnerability Laboratory Research Team discovered multiple web vulnerabilites in iScripts EasyCreate v2.0 CMS.


Report-Timeline:
================
2012-06-02:  Public or Non-Public Disclosure


Status:
========
Published


Exploitation-Technique:
=======================
Remote


Severity:
=========
Critical


Details:
========
1.1
A SQL Injection vulnerability is detected in iScripts EasyCreate v 2.0, an online web site building tool.
The vulnerability allows an attacker (remote) or local low privileged user account to inject/execute own sql commands
on the affected application dbms. Successful exploitation of the vulnerability results in dbms & application compromise.
The vulnerability is located in the the editor.php file with the bound vulnerable tempsiteid parameter.


Vulnerable Module(s):
                                            [+] Editor - Template ID

Vulnerable File(s):
                                            [+] code/editor.php

Vulnerable Parameter(s):
                                            [+] tempsiteid=[x]

--- SQL Exception Logs ---
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server
version for the right syntax to use near  25  at line 1


1.2
A persistent input validation vulnerability is detected in iScripts EasyCreate v 2.0, an online web site building tool.
The bugs allow remote attackers to implement/inject malicious script code on the application side (persistent). The
persistent vulnerability is located in the first name input field value & the output display of the vulnerable editprofile.php.
Successful exploitation of the vulnerability can lead to session hijacking (manager/admin) or stable (persistent) context
manipulation. Exploitation requires low user inter action & privileged user account.

Vulnerable Module(s):
                                            [+] editprofile.php - [First name]


Proof of Concept:
=================
1.1
The sql injection vulnerability can be exploited by remote attackers without user inter action. For demonstration or reproduce ...

PoC:
http://127.0.0.1:1338/easycreate/cms/code/editor.php?type=new&actiontype=editsite&templateid=128'&tempsiteid=-1 union all select [SQL Injection] --

1.2
The persistent input validation vulnerabilities can be exploited by remote attackers with low required user inter action.
For demonstration or reproduce ...

The attacker create an account and then changed his first name to malicious persistent javascript or html code.
To change, the first name the attacker needs to go to > main menu > profile manager > edit profile.
Then inject the malicious script code i.e., <iframe src=www.vuln-lab.com onload=alert("VL")/>
When the admin browses the payments page in the control panel the persistent injected script code will be
executed out of the web application context.


Risk:
=====
1.1
The security risk of the sql injection vulnerability is estimated as critical.

1.2
The security risk of the persistent input validation vulnerabilities are estiamted as medium(+)


Credits:
========
Vulnerability Laboratory [Research Team]  -    Ibrahim El-Sayed [the stOrM) (storm@vulnerability-lab.com)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties,
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation
may not apply.

Domains:  www.vulnerability-lab.com     - www.vuln-lab.com
Contact:  admin@vulnerability-lab.com   - support@vulnerability-lab.com   - research@vulnerability-lab.com
Section:  video.vulnerability-lab.com   - forum.vulnerability-lab.com     - news.vulnerability-lab.com
Social:    twitter.com/#!/vuln_lab   - facebook.com/VulnerabilityLab   - youtube.com/user/vulnerability0lab

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory.
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other
media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, sourcecode, videos and
other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed),
modify, use or edit our material contact (admin@vulnerability-lab.com or support@vulnerability-lab.com) to get a permission.

                Copyright Â© 2012 Vulnerability-Lab




--
VULNERABILITY RESEARCH LABORATORY TEAM
Website: www.vulnerability-lab.com
Mail: research@vulnerability-lab.com