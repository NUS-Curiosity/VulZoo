Title:
======
News Script PHP v1.2 - Multiple Web Vulnerabilites


Date:
=====
2012-06-07


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=600


VL-ID:
=====
600


Common Vulnerability Scoring System:
====================================
7.5


Introduction:
=============
Visitors to your website will be able to read news, articles, interviews and stories which you have posted.
Features of News Script PHP:

    simple one-step installation
    easy to place on your webpage - copy and paste a single line of code
    password protected admin area with multiple options and features that you can control
    publish news in any language
    three different options of displaying your news page
    simple text editor for the news content area
    caption below the article image
    news search box (optional)
    adjusting number of news items per page.
    full control over visual style of the news
    each of the news articles can have two images - one for the summary and one for the full article
    complete control over image placement on the page (left, right, top and bottom)
    ability to resize the image to fit the article
    view counter for each news article
    set default server time offset
    RSS News Feed with images, validated by w3c
    Simple, uncomplicated script with easy to understand menus, features, etc.
    anyone with a minimum knowledge of websites can install and make this script work

News Script PHP requires PHP 4.3 or higher and MySQL 3 or higher to run on your server.
Current stable version of News Script PHP is 1.2

(Copy of the Vendor Homepage: http://www.newsscriptphp.com )


Abstract:
=========
The Vulnerability Laboratory Research Team discovered multiple different web vulnerabilites in News Script PHP v1.2 CMS.


Report-Timeline:
================
2012-06-07:	Public Public Disclosure


Status:
========
Published


Exploitation-Technique:
=======================
Remote


Severity:
=========
High


Details:
========
1.1
Multiple SQL Injection vulnerabilities  are detected in the News Script PHP 1.2 Content Management System.
The vulnerability allows an attacker (remote) or local low privileged user account to inject/execute own
sql commands on the affected application dbms without user inter action. Successful exploitation of the
vulnerability results in dbms & application compromise. The vulnerabilities are located in admin.php &
preview.php file and bound values like orderBy & id.

Vulnerable File(s):
			[+] preview.php
			[+] admin.php

Vulnerable Parameter(s):
			[+] id
			[+] orderBy


1.2
Multiple non persistent cross site scripting vulnerabilities are detected in the News Script PHP 1.2 Content Management System.
The vulnerability allows remote attackers to hijack website customer, moderator or admin sessions with high required
user inter action or local low privileged user account. Successful exploitation can result in account steal, phishing
& client-side content request manipulation. The vulnerabilities are located in the preview.php and admin.php files and the
bound values like search, ordertype, orderby & act.

Vulnerable File(s):
			[+] preview.php
			[+] admin.php

Vulnerable Parameter(s):
			[+] search
			[+] orderType
			[+] orderBy
			[+] act


Proof of Concept:
=================
1.1
The sql injection vulnerabilities can be exploited without required user inter action with privileged user account.
For demonstration or reproduce ...

PoC:
http://127.0.0.1:1338/news/preview.php?id=[SQL-INJECTION]
http://127.0.0.1:1338/news/preview.php?p=[SQL-INJECTION]
http://127.0.0.1:1338/news/admin.php?act=news&orderType=[ASC/DESC]&search=&orderBy=[SQL-INJECTION]


1.2
The non persistent input validation vulnerabilities can be exploited by remote attackers with medium or high required
user inter action & without privileged user account. For demonstration or reproduce ...

PoC:
http://127.0.0.1:1338/news/preview.php?id=`14&p=`&search=[CROSS SITE SCRIPTING]
http://127.0.0.1:1338/news/admin.php?act=news&orderType=`[CROSS SITE SCRIPTING]
http://127.0.0.1:1338/news/admin.php?act=news&orderType=[CROSS SITE SCRIPTING]]&search=&orderBy=[CROSS SITE SCRIPTING]
http://127.0.0.1:1338/news/preview.php?act=news&orderType=[CROSS SITE SCRIPTING]


Risk:
=====
1.1
The security risk of the sql injection vulnerabilities are estimated as hard

1.2
The security risk of the input validation vulnerabilities are estiamted as low(+)


Credits:
========
Vulnerability Laboratory [Research Team]  -    snup (snup@vulnerability-lab.com) [http://snup1.blogspot.com]



Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties,
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation
may not apply.

Domains:	www.vulnerability-lab.com   	- www.vuln-lab.com
Contact:	admin@vulnerability-lab.com 	- support@vulnerability-lab.com 	- research@vulnerability-lab.com
Section:	video.vulnerability-lab.com 	- forum.vulnerability-lab.com 		- news.vulnerability-lab.com
Social:		twitter.com/#!/vuln_lab 	- facebook.com/VulnerabilityLab 	- youtube.com/user/vulnerability0lab

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory.
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other
media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, sourcecode, videos and
other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed),
modify, use or edit our material contact (admin@vulnerability-lab.com or support@vulnerability-lab.com) to get a permission.

    						Copyright ï¿½ 2012 Vulnerability-Lab




--
VULNERABILITY RESEARCH LABORATORY TEAM
Website: www.vulnerability-lab.com
Mail: research@vulnerability-lab.com