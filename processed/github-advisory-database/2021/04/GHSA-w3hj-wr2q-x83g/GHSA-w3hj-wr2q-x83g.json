{
  "schema_version": "1.4.0",
  "id": "GHSA-w3hj-wr2q-x83g",
  "modified": "2021-03-30T17:04:34Z",
  "published": "2021-04-06T17:22:17Z",
  "aliases": [

  ],
  "summary": "Discovery uses the same AES/GCM Nonce throughout the session",
  "details": "Discovery uses the same AES/GCM Nonce throughout the session though it should be generated on per message basis which can lead to the leaking of the session key.  As the actual ENR record is signed with a different key it is not possible for an attacker to alter the ENR record. Note that the node private key is not compromised, only the session key generated to communicate with an individual peer.\n\nFrom [discovery spec](https://github.com/ethereum/devp2p/blob/f97b8a5b8e9589d3355ebbd9d4a58d5d1644bdf7/discv5/discv5-theory.md#session-cache):\n> The number of messages which can be encrypted with a certain session key is limited because encryption of each message requires a unique nonce for AES-GCM. In addition to the keys, the session cache must also keep track of the count of outgoing messages to ensure the uniqueness of nonce values. Since the wire protocol uses 96 bit AES-GCM nonces, it is strongly recommended to generate them by encoding the current outgoing message count into the first 32 bits of the nonce and filling the remaining 64 bits with random data generated by a cryptographically secure random number generator.",
  "severity": [

  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Maven",
        "name": "tech.pegasys.discovery:discovery"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.4.5"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/ConsenSys/discovery/security/advisories/GHSA-w3hj-wr2q-x83g"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-323"
    ],
    "severity": "LOW",
    "github_reviewed": true,
    "github_reviewed_at": "2021-03-30T17:04:34Z",
    "nvd_published_at": null
  }
}