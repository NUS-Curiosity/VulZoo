{
  "schema_version": "1.4.0",
  "id": "GHSA-9pf8-qqhm-7w64",
  "modified": "2024-03-21T16:00:50Z",
  "published": "2022-05-13T01:30:17Z",
  "aliases": [
    "CVE-2018-10054"
  ],
  "summary": "Improper Input Validation in Datomic",
  "details": "H2 1.4.197, as used in Datomic before 0.9.5697 and other products, allows remote code execution because CREATE ALIAS can execute arbitrary Java code.",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Maven",
        "name": "com.datomic:datomic-free"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.9.5697"
            }
          ]
        }
      ],
      "database_specific": {
        "last_known_affected_version_range": "<= 0.9.5656"
      }
    }
  ],
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2018-10054"
    },
    {
      "type": "WEB",
      "url": "https://github.com/h2database/h2database/issues/1225"
    },
    {
      "type": "WEB",
      "url": "https://github.com/h2database/h2database/issues/1808#issuecomment-599203115"
    },
    {
      "type": "WEB",
      "url": "https://github.com/h2database/h2database/issues/3099"
    },
    {
      "type": "WEB",
      "url": "https://forum.datomic.com/t/important-security-update-0-9-5697/379"
    },
    {
      "type": "WEB",
      "url": "https://lists.apache.org/thread.html/582d4165de6507b0be82d5a6f9a1ce392ec43a00c9fed32bacf7fe1e%40%3Cuser.ignite.apache.org%3E"
    },
    {
      "type": "WEB",
      "url": "https://lists.apache.org/thread.html/582d4165de6507b0be82d5a6f9a1ce392ec43a00c9fed32bacf7fe1e@%3Cuser.ignite.apache.org%3E"
    },
    {
      "type": "WEB",
      "url": "https://lists.apache.org/thread.html/r8aaf4ee16bbaf6204731d4770d96ebb34b258cd79b491f9cdd7f2540%40%3Ccommits.nifi.apache.org%3E"
    },
    {
      "type": "WEB",
      "url": "https://lists.apache.org/thread.html/r8aaf4ee16bbaf6204731d4770d96ebb34b258cd79b491f9cdd7f2540@%3Ccommits.nifi.apache.org%3E"
    },
    {
      "type": "WEB",
      "url": "https://mthbernardes.github.io/rce/2018/03/14/abusing-h2-database-alias.html"
    },
    {
      "type": "WEB",
      "url": "https://www.exploit-db.com/exploits/44422"
    },
    {
      "type": "WEB",
      "url": "http://blog.datomic.com/2018/03/important-security-update.html"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-20"
    ],
    "severity": "HIGH",
    "github_reviewed": true,
    "github_reviewed_at": "2022-06-30T14:03:27Z",
    "nvd_published_at": "2018-04-11T20:29:00Z"
  }
}