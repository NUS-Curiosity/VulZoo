{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nxen: fix is_xen_pmu()\n\nis_xen_pmu() is taking the cpu number as parameter, but it is not using\nit. Instead it just tests whether the Xen PMU initialization on the\ncurrent cpu did succeed. As this test is done by checking a percpu\npointer, preemption needs to be disabled in order to avoid switching\nthe cpu while doing the test. While resuming from suspend() this seems\nnot to be the case:\n\n[   88.082751] ACPI: PM: Low-level resume complete\n[   88.087933] ACPI: EC: EC started\n[   88.091464] ACPI: PM: Restoring platform NVS memory\n[   88.097166] xen_acpi_processor: Uploading Xen processor PM info\n[   88.103850] Enabling non-boot CPUs ...\n[   88.108128] installing Xen timer for CPU 1\n[   88.112763] BUG: using smp_processor_id() in preemptible [00000000] code: systemd-sleep/7138\n[   88.122256] caller is is_xen_pmu+0x12/0x30\n[   88.126937] CPU: 0 PID: 7138 Comm: systemd-sleep Tainted: G        W         5.16.13-2.fc32.qubes.x86_64 #1\n[   88.137939] Hardware name: Star Labs StarBook/StarBook, BIOS 7.97 03/21/2022\n[   88.145930] Call Trace:\n[   88.148757]  <TASK>\n[   88.151193]  dump_stack_lvl+0x48/0x5e\n[   88.155381]  check_preemption_disabled+0xde/0xe0\n[   88.160641]  is_xen_pmu+0x12/0x30\n[   88.164441]  xen_smp_intr_init_pv+0x75/0x100\n\nFix that by replacing is_xen_pmu() by a simple boolean variable which\nreflects the Xen PMU initialization state on cpu 0.\n\nModify xen_pmu_init() to return early in case it is being called for a\ncpu other than cpu 0 and the boolean variable not being set."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "arch/x86/xen/pmu.c",
                  "arch/x86/xen/pmu.h",
                  "arch/x86/xen/smp_pv.c"
               ],
               "versions": [
                  {
                     "version": "bf6dfb154d935725c9a2005033ca33017b9df439",
                     "lessThan": "e9f72105cf4a16bb185093b60fc12dbc82fe15b5",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "bf6dfb154d935725c9a2005033ca33017b9df439",
                     "lessThan": "d533c4a2e8c4ca3a0fe84d295a7bd43af1931028",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "bf6dfb154d935725c9a2005033ca33017b9df439",
                     "lessThan": "ab2c789d1c0a3d0a682f7aa287754193471ff9f8",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "bf6dfb154d935725c9a2005033ca33017b9df439",
                     "lessThan": "e9445a7a59d84ed3ae6c85f299d2a6c4930b1ee9",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "bf6dfb154d935725c9a2005033ca33017b9df439",
                     "lessThan": "af884b276b08e2b7e74c2b9208df35f36fa6a54c",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "bf6dfb154d935725c9a2005033ca33017b9df439",
                     "lessThan": "980bc42812c0a4788aee4b519bc911bfb911c23c",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "bf6dfb154d935725c9a2005033ca33017b9df439",
                     "lessThan": "26911a822148bef5dcfc55e7df49cb05a18737e3",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "bf6dfb154d935725c9a2005033ca33017b9df439",
                     "lessThan": "de2ae403b4c0e79a3410e63bc448542fbb9f9bfc",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "arch/x86/xen/pmu.c",
                  "arch/x86/xen/pmu.h",
                  "arch/x86/xen/smp_pv.c"
               ],
               "versions": [
                  {
                     "version": "4.3",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "4.3",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "4.14.276",
                     "lessThanOrEqual": "4.14.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "4.19.238",
                     "lessThanOrEqual": "4.19.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.4.189",
                     "lessThanOrEqual": "5.4.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.10.110",
                     "lessThanOrEqual": "5.10.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.15.33",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.16.19",
                     "lessThanOrEqual": "5.16.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.17.2",
                     "lessThanOrEqual": "5.17.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.18",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/e9f72105cf4a16bb185093b60fc12dbc82fe15b5"
            },
            {
               "url": "https://git.kernel.org/stable/c/d533c4a2e8c4ca3a0fe84d295a7bd43af1931028"
            },
            {
               "url": "https://git.kernel.org/stable/c/ab2c789d1c0a3d0a682f7aa287754193471ff9f8"
            },
            {
               "url": "https://git.kernel.org/stable/c/e9445a7a59d84ed3ae6c85f299d2a6c4930b1ee9"
            },
            {
               "url": "https://git.kernel.org/stable/c/af884b276b08e2b7e74c2b9208df35f36fa6a54c"
            },
            {
               "url": "https://git.kernel.org/stable/c/980bc42812c0a4788aee4b519bc911bfb911c23c"
            },
            {
               "url": "https://git.kernel.org/stable/c/26911a822148bef5dcfc55e7df49cb05a18737e3"
            },
            {
               "url": "https://git.kernel.org/stable/c/de2ae403b4c0e79a3410e63bc448542fbb9f9bfc"
            }
         ],
         "title": "xen: fix is_xen_pmu()",
         "x_generator": {
            "engine": "bippy-5f407fcff5a0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2022-49181",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
