{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ntty: xilinx_uartps: split sysrq handling\n\nlockdep detects the following circular locking dependency:\n\nCPU 0                      CPU 1\n========================== ============================\ncdns_uart_isr()            printk()\n  uart_port_lock(port)       console_lock()\n\t\t\t     cdns_uart_console_write()\n                               if (!port->sysrq)\n                                 uart_port_lock(port)\n  uart_handle_break()\n    port->sysrq = ...\n  uart_handle_sysrq_char()\n    printk()\n      console_lock()\n\nThe fixed commit attempts to avoid this situation by only taking the\nport lock in cdns_uart_console_write if port->sysrq unset. However, if\n(as shown above) cdns_uart_console_write runs before port->sysrq is set,\nthen it will try to take the port lock anyway. This may result in a\ndeadlock.\n\nFix this by splitting sysrq handling into two parts. We use the prepare\nhelper under the port lock and defer handling until we release the lock."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/tty/serial/xilinx_uartps.c"
               ],
               "versions": [
                  {
                     "version": "74ea66d4ca061a3cd4c0e924e51b60e924644852",
                     "lessThan": "e22a97700901ba5e8bf8db68056a0d50f9440cae",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "74ea66d4ca061a3cd4c0e924e51b60e924644852",
                     "lessThan": "de5bd24197bd9ee37ec1e379a3d882bbd15c5065",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "74ea66d4ca061a3cd4c0e924e51b60e924644852",
                     "lessThan": "8ea0e7b3d7b8f2f0fc9db491ff22a0abe120801c",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "74ea66d4ca061a3cd4c0e924e51b60e924644852",
                     "lessThan": "9b88a7c4584ba67267a051069b8abe44fc9595b2",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "74ea66d4ca061a3cd4c0e924e51b60e924644852",
                     "lessThan": "4410dba9807a17a93f649a9f5870ceaf30a675a3",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "74ea66d4ca061a3cd4c0e924e51b60e924644852",
                     "lessThan": "b06f388994500297bb91be60ffaf6825ecfd2afe",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/tty/serial/xilinx_uartps.c"
               ],
               "versions": [
                  {
                     "version": "4.6",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "4.6",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.15.179",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.129",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.6.78",
                     "lessThanOrEqual": "6.6.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.12.14",
                     "lessThanOrEqual": "6.12.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.13.3",
                     "lessThanOrEqual": "6.13.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.14-rc1",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/e22a97700901ba5e8bf8db68056a0d50f9440cae"
            },
            {
               "url": "https://git.kernel.org/stable/c/de5bd24197bd9ee37ec1e379a3d882bbd15c5065"
            },
            {
               "url": "https://git.kernel.org/stable/c/8ea0e7b3d7b8f2f0fc9db491ff22a0abe120801c"
            },
            {
               "url": "https://git.kernel.org/stable/c/9b88a7c4584ba67267a051069b8abe44fc9595b2"
            },
            {
               "url": "https://git.kernel.org/stable/c/4410dba9807a17a93f649a9f5870ceaf30a675a3"
            },
            {
               "url": "https://git.kernel.org/stable/c/b06f388994500297bb91be60ffaf6825ecfd2afe"
            }
         ],
         "title": "tty: xilinx_uartps: split sysrq handling",
         "x_generator": {
            "engine": "bippy-5f407fcff5a0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2025-21820",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
