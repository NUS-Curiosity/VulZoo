From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-21761: openvswitch: use RCU protection in ovs_vport_cmd_fill_info()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

openvswitch: use RCU protection in ovs_vport_cmd_fill_info()

ovs_vport_cmd_fill_info() can be called without RTNL or RCU.

Use RCU protection and dev_net_rcu() to avoid potential UAF.

The Linux kernel CVE team has assigned CVE-2025-21761 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.15 with commit 9354d452034273a50a4fd703bea31e5d6b1fc20b and fixed in 5.4.291 with commit e85a25d1a9985645e796039e843d1de581d2de1e
	Issue introduced in 4.15 with commit 9354d452034273a50a4fd703bea31e5d6b1fc20b and fixed in 5.10.235 with commit a8816b3f1f151373fd30f1996f00480126c8bb11
	Issue introduced in 4.15 with commit 9354d452034273a50a4fd703bea31e5d6b1fc20b and fixed in 5.15.179 with commit a884f57600e463f69d7b279c4598b865260b62a1
	Issue introduced in 4.15 with commit 9354d452034273a50a4fd703bea31e5d6b1fc20b and fixed in 6.1.129 with commit 7e01abc34e87abd091e619161a20f54ed4e3e2da
	Issue introduced in 4.15 with commit 9354d452034273a50a4fd703bea31e5d6b1fc20b and fixed in 6.6.79 with commit 8ec57509c36c8b9a23e50b7858dda0c520a2d074
	Issue introduced in 4.15 with commit 9354d452034273a50a4fd703bea31e5d6b1fc20b and fixed in 6.12.16 with commit a849a10de5e04d798f7f286a2f1ca174719a617a
	Issue introduced in 4.15 with commit 9354d452034273a50a4fd703bea31e5d6b1fc20b and fixed in 6.13.4 with commit 5828937742af74666192835d657095d95c53dbd0
	Issue introduced in 4.15 with commit 9354d452034273a50a4fd703bea31e5d6b1fc20b and fixed in 6.14-rc3 with commit 90b2f49a502fa71090d9f4fe29a2f51fe5dff76d

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-21761
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/openvswitch/datapath.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/e85a25d1a9985645e796039e843d1de581d2de1e
	https://git.kernel.org/stable/c/a8816b3f1f151373fd30f1996f00480126c8bb11
	https://git.kernel.org/stable/c/a884f57600e463f69d7b279c4598b865260b62a1
	https://git.kernel.org/stable/c/7e01abc34e87abd091e619161a20f54ed4e3e2da
	https://git.kernel.org/stable/c/8ec57509c36c8b9a23e50b7858dda0c520a2d074
	https://git.kernel.org/stable/c/a849a10de5e04d798f7f286a2f1ca174719a617a
	https://git.kernel.org/stable/c/5828937742af74666192835d657095d95c53dbd0
	https://git.kernel.org/stable/c/90b2f49a502fa71090d9f4fe29a2f51fe5dff76d
