From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-21668: pmdomain: imx8mp-blk-ctrl: add missing loop break condition

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

pmdomain: imx8mp-blk-ctrl: add missing loop break condition

Currently imx8mp_blk_ctrl_remove() will continue the for loop
until an out-of-bounds exception occurs.

pstate: 60000005 (nZCv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)
pc : dev_pm_domain_detach+0x8/0x48
lr : imx8mp_blk_ctrl_shutdown+0x58/0x90
sp : ffffffc084f8bbf0
x29: ffffffc084f8bbf0 x28: ffffff80daf32ac0 x27: 0000000000000000
x26: ffffffc081658d78 x25: 0000000000000001 x24: ffffffc08201b028
x23: ffffff80d0db9490 x22: ffffffc082340a78 x21: 00000000000005b0
x20: ffffff80d19bc180 x19: 000000000000000a x18: ffffffffffffffff
x17: ffffffc080a39e08 x16: ffffffc080a39c98 x15: 4f435f464f006c72
x14: 0000000000000004 x13: ffffff80d0172110 x12: 0000000000000000
x11: ffffff80d0537740 x10: ffffff80d05376c0 x9 : ffffffc0808ed2d8
x8 : ffffffc084f8bab0 x7 : 0000000000000000 x6 : 0000000000000000
x5 : ffffff80d19b9420 x4 : fffffffe03466e60 x3 : 0000000080800077
x2 : 0000000000000000 x1 : 0000000000000001 x0 : 0000000000000000
Call trace:
 dev_pm_domain_detach+0x8/0x48
 platform_shutdown+0x2c/0x48
 device_shutdown+0x158/0x268
 kernel_restart_prepare+0x40/0x58
 kernel_kexec+0x58/0xe8
 __do_sys_reboot+0x198/0x258
 __arm64_sys_reboot+0x2c/0x40
 invoke_syscall+0x5c/0x138
 el0_svc_common.constprop.0+0x48/0xf0
 do_el0_svc+0x24/0x38
 el0_svc+0x38/0xc8
 el0t_64_sync_handler+0x120/0x130
 el0t_64_sync+0x190/0x198
Code: 8128c2d0 ffffffc0 aa1e03e9 d503201f

The Linux kernel CVE team has assigned CVE-2025-21668 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.19 with commit 556f5cf9568af772d494cff24ffaa7ea41e1ab40 and fixed in 6.1.127 with commit 699cc10cc3068f9097a506eae7fe178c860dca4e
	Issue introduced in 5.19 with commit 556f5cf9568af772d494cff24ffaa7ea41e1ab40 and fixed in 6.6.74 with commit 926ad31b76b8e229b412536e77cdf828a5cae9c6
	Issue introduced in 5.19 with commit 556f5cf9568af772d494cff24ffaa7ea41e1ab40 and fixed in 6.12.11 with commit 488a68c948bc52dc2a4554a56fdd99aa67c49b06
	Issue introduced in 5.19 with commit 556f5cf9568af772d494cff24ffaa7ea41e1ab40 and fixed in 6.13 with commit 726efa92e02b460811e8bc6990dd742f03b645ea

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-21668
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/pmdomain/imx/imx8mp-blk-ctrl.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/699cc10cc3068f9097a506eae7fe178c860dca4e
	https://git.kernel.org/stable/c/926ad31b76b8e229b412536e77cdf828a5cae9c6
	https://git.kernel.org/stable/c/488a68c948bc52dc2a4554a56fdd99aa67c49b06
	https://git.kernel.org/stable/c/726efa92e02b460811e8bc6990dd742f03b645ea
