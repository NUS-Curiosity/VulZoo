{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\npadata: avoid UAF for reorder_work\n\nAlthough the previous patch can avoid ps and ps UAF for _do_serial, it\ncan not avoid potential UAF issue for reorder_work. This issue can\nhappen just as below:\n\ncrypto_request\t\t\tcrypto_request\t\tcrypto_del_alg\npadata_do_serial\n  ...\n  padata_reorder\n    // processes all remaining\n    // requests then breaks\n    while (1) {\n      if (!padata)\n        break;\n      ...\n    }\n\n\t\t\t\tpadata_do_serial\n\t\t\t\t  // new request added\n\t\t\t\t  list_add\n    // sees the new request\n    queue_work(reorder_work)\n\t\t\t\t  padata_reorder\n\t\t\t\t    queue_work_on(squeue->work)\n...\n\n\t\t\t\t<kworker context>\n\t\t\t\tpadata_serial_worker\n\t\t\t\t// completes new request,\n\t\t\t\t// no more outstanding\n\t\t\t\t// requests\n\n\t\t\t\t\t\t\tcrypto_del_alg\n\t\t\t\t\t\t\t  // free pd\n\n<kworker context>\ninvoke_padata_reorder\n  // UAF of pd\n\nTo avoid UAF for 'reorder_work', get 'pd' ref before put 'reorder_work'\ninto the 'serial_wq' and put 'pd' ref until the 'serial_wq' finish."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "kernel/padata.c"
               ],
               "versions": [
                  {
                     "version": "bbefa1dd6a6d53537c11624752219e39959d04fb",
                     "lessThan": "f4f1b1169fc3694f9bc3e28c6c68dbbf4cc744c0",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "bbefa1dd6a6d53537c11624752219e39959d04fb",
                     "lessThan": "4c6209efea2208597dbd3e52dc87a0d1a8f2dbe1",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "bbefa1dd6a6d53537c11624752219e39959d04fb",
                     "lessThan": "7000507bb0d2ceb545c0a690e0c707c897d102c2",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "bbefa1dd6a6d53537c11624752219e39959d04fb",
                     "lessThan": "6f45ef616775b0ce7889b0f6077fc8d681ab30bc",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "bbefa1dd6a6d53537c11624752219e39959d04fb",
                     "lessThan": "8ca38d0ca8c3d30dd18d311f1a7ec5cb56972cac",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "bbefa1dd6a6d53537c11624752219e39959d04fb",
                     "lessThan": "a54091c24220a4cd847d5b4f36d678edacddbaf0",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "bbefa1dd6a6d53537c11624752219e39959d04fb",
                     "lessThan": "dd7d37ccf6b11f3d95e797ebe4e9e886d0332600",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "kernel/padata.c"
               ],
               "versions": [
                  {
                     "version": "5.6",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "5.6",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.10.235",
                     "lessThanOrEqual": "5.10.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.15.179",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.129",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.6.76",
                     "lessThanOrEqual": "6.6.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.12.13",
                     "lessThanOrEqual": "6.12.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.13.2",
                     "lessThanOrEqual": "6.13.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.14-rc1",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/f4f1b1169fc3694f9bc3e28c6c68dbbf4cc744c0"
            },
            {
               "url": "https://git.kernel.org/stable/c/4c6209efea2208597dbd3e52dc87a0d1a8f2dbe1"
            },
            {
               "url": "https://git.kernel.org/stable/c/7000507bb0d2ceb545c0a690e0c707c897d102c2"
            },
            {
               "url": "https://git.kernel.org/stable/c/6f45ef616775b0ce7889b0f6077fc8d681ab30bc"
            },
            {
               "url": "https://git.kernel.org/stable/c/8ca38d0ca8c3d30dd18d311f1a7ec5cb56972cac"
            },
            {
               "url": "https://git.kernel.org/stable/c/a54091c24220a4cd847d5b4f36d678edacddbaf0"
            },
            {
               "url": "https://git.kernel.org/stable/c/dd7d37ccf6b11f3d95e797ebe4e9e886d0332600"
            }
         ],
         "title": "padata: avoid UAF for reorder_work",
         "x_generator": {
            "engine": "bippy-5f407fcff5a0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2025-21726",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
