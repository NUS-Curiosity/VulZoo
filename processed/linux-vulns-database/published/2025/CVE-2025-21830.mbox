From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-21830: landlock: Handle weird files

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

landlock: Handle weird files

A corrupted filesystem (e.g. bcachefs) might return weird files.
Instead of throwing a warning and allowing access to such file, treat
them as regular files.

The Linux kernel CVE team has assigned CVE-2025-21830 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.13 with commit cb2c7d1a1776057c9a1f48ed1250d85e94d4850d and fixed in 5.15.179 with commit a1fccf6b72b56343dd4f2d96b008147f9951eebd
	Issue introduced in 5.13 with commit cb2c7d1a1776057c9a1f48ed1250d85e94d4850d and fixed in 6.1.129 with commit 7d6121228959ddf44a4b9b6a177384ac7854e2f9
	Issue introduced in 5.13 with commit cb2c7d1a1776057c9a1f48ed1250d85e94d4850d and fixed in 6.6.76 with commit 39bb3d56f1c351e76bb18895d0e73796e653d5c1
	Issue introduced in 5.13 with commit cb2c7d1a1776057c9a1f48ed1250d85e94d4850d and fixed in 6.12.13 with commit 2569e65d2eb6ac1afe6cb6dfae476afee8b6771a
	Issue introduced in 5.13 with commit cb2c7d1a1776057c9a1f48ed1250d85e94d4850d and fixed in 6.13.2 with commit 0fde195a373ab1267e60baa9e1a703a97e7464cd
	Issue introduced in 5.13 with commit cb2c7d1a1776057c9a1f48ed1250d85e94d4850d and fixed in 6.14-rc1 with commit 49440290a0935f428a1e43a5ac8dc275a647ff80

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-21830
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	security/landlock/fs.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/a1fccf6b72b56343dd4f2d96b008147f9951eebd
	https://git.kernel.org/stable/c/7d6121228959ddf44a4b9b6a177384ac7854e2f9
	https://git.kernel.org/stable/c/39bb3d56f1c351e76bb18895d0e73796e653d5c1
	https://git.kernel.org/stable/c/2569e65d2eb6ac1afe6cb6dfae476afee8b6771a
	https://git.kernel.org/stable/c/0fde195a373ab1267e60baa9e1a703a97e7464cd
	https://git.kernel.org/stable/c/49440290a0935f428a1e43a5ac8dc275a647ff80
