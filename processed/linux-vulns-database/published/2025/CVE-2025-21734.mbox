From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-21734: misc: fastrpc: Fix copy buffer page size

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

misc: fastrpc: Fix copy buffer page size

For non-registered buffer, fastrpc driver copies the buffer and
pass it to the remote subsystem. There is a problem with current
implementation of page size calculation which is not considering
the offset in the calculation. This might lead to passing of
improper and out-of-bounds page size which could result in
memory issue. Calculate page start and page end using the offset
adjusted address instead of absolute address.

The Linux kernel CVE team has assigned CVE-2025-21734 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.2 with commit 02b45b47fbe84e23699bb6bdc74d4c2780e282b4 and fixed in 6.1.129 with commit c56ba3ea8e3c9a69a992aad18f7a65e43e51d623
	Issue introduced in 5.2 with commit 02b45b47fbe84e23699bb6bdc74d4c2780e282b4 and fixed in 6.6.78 with commit c0464bad0e85fcd5d47e4297d1e410097c979e55
	Issue introduced in 5.2 with commit 02b45b47fbe84e23699bb6bdc74d4c2780e282b4 and fixed in 6.12.14 with commit 24a79c6bc8de763f7c50f4f84f8b0c183bc25a51
	Issue introduced in 5.2 with commit 02b45b47fbe84e23699bb6bdc74d4c2780e282b4 and fixed in 6.13.3 with commit c3f7161123fcbdc64e90119ccce292d8b66281c4
	Issue introduced in 5.2 with commit 02b45b47fbe84e23699bb6bdc74d4c2780e282b4 and fixed in 6.14-rc1 with commit e966eae72762ecfdbdb82627e2cda48845b9dd66

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-21734
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/misc/fastrpc.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/c56ba3ea8e3c9a69a992aad18f7a65e43e51d623
	https://git.kernel.org/stable/c/c0464bad0e85fcd5d47e4297d1e410097c979e55
	https://git.kernel.org/stable/c/24a79c6bc8de763f7c50f4f84f8b0c183bc25a51
	https://git.kernel.org/stable/c/c3f7161123fcbdc64e90119ccce292d8b66281c4
	https://git.kernel.org/stable/c/e966eae72762ecfdbdb82627e2cda48845b9dd66
