{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nsched: sch_cake: add bounds checks to host bulk flow fairness counts\n\nEven though we fixed a logic error in the commit cited below, syzbot\nstill managed to trigger an underflow of the per-host bulk flow\ncounters, leading to an out of bounds memory access.\n\nTo avoid any such logic errors causing out of bounds memory accesses,\nthis commit factors out all accesses to the per-host bulk flow counters\nto a series of helpers that perform bounds-checking before any\nincrements and decrements. This also has the benefit of improving\nreadability by moving the conditional checks for the flow mode into\nthese helpers, instead of having them spread out throughout the\ncode (which was the cause of the original logic error).\n\nAs part of this change, the flow quantum calculation is consolidated\ninto a helper function, which means that the dithering applied to the\nost load scaling is now applied both in the DRR rotation and when a\nsparse flow's quantum is first initiated. The only user-visible effect\nof this is that the maximum packet size that can be sent while a flow\nstays sparse will now vary with +/- one byte in some cases. This should\nnot make a noticeable difference in practice, and thus it's not worth\ncomplicating the code to preserve the old behaviour."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "net/sched/sch_cake.c"
               ],
               "versions": [
                  {
                     "version": "4a4eeefa514db570be025ab46d779af180e2c9bb",
                     "lessThan": "44fe1efb4961c1a5ccab16bb579dfc6b308ad58b",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "7725152b54d295b7da5e34c2f419539b30d017bd",
                     "lessThan": "b1a1743aaa4906c41c426eda97e2e2586f79246d",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "cde71a5677971f4f1b69b25e854891dbe78066a4",
                     "lessThan": "bb0245fa72b783cb23a9949c5048781341e91423",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "549e407569e08459d16122341d332cb508024094",
                     "lessThan": "a777e06dfc72bed73c05dcb437d7c27ad5f90f3f",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "d4a9039a7b3d8005b90c7b1a55a306444f0e5447",
                     "lessThan": "27202e2e8721c3b23831563c36ed5ac7818641ba",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "546ea84d07e3e324644025e2aae2d12ea4c5896e",
                     "lessThan": "91bb18950b88f955838ec0c1d97f74d135756dc7",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "546ea84d07e3e324644025e2aae2d12ea4c5896e",
                     "lessThan": "737d4d91d35b5f7fa5bb442651472277318b0bfd",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "net/sched/sch_cake.c"
               ],
               "versions": [
                  {
                     "version": "6.11",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "6.11",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.4.291",
                     "lessThanOrEqual": "5.4.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.10.235",
                     "lessThanOrEqual": "5.10.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.15.179",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.125",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.6.72",
                     "lessThanOrEqual": "6.6.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.12.10",
                     "lessThanOrEqual": "6.12.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.13",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/44fe1efb4961c1a5ccab16bb579dfc6b308ad58b"
            },
            {
               "url": "https://git.kernel.org/stable/c/b1a1743aaa4906c41c426eda97e2e2586f79246d"
            },
            {
               "url": "https://git.kernel.org/stable/c/bb0245fa72b783cb23a9949c5048781341e91423"
            },
            {
               "url": "https://git.kernel.org/stable/c/a777e06dfc72bed73c05dcb437d7c27ad5f90f3f"
            },
            {
               "url": "https://git.kernel.org/stable/c/27202e2e8721c3b23831563c36ed5ac7818641ba"
            },
            {
               "url": "https://git.kernel.org/stable/c/91bb18950b88f955838ec0c1d97f74d135756dc7"
            },
            {
               "url": "https://git.kernel.org/stable/c/737d4d91d35b5f7fa5bb442651472277318b0bfd"
            }
         ],
         "title": "sched: sch_cake: add bounds checks to host bulk flow fairness counts",
         "x_generator": {
            "engine": "bippy-5f407fcff5a0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2025-21647",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
