From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-21749: net: rose: lock the socket in rose_bind()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

net: rose: lock the socket in rose_bind()

syzbot reported a soft lockup in rose_loopback_timer(),
with a repro calling bind() from multiple threads.

rose_bind() must lock the socket to avoid this issue.

The Linux kernel CVE team has assigned CVE-2025-21749 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 5.4.291 with commit b8bf5c3fb778bbb1f3ff7d98ec577c969f687513
	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 5.10.235 with commit ed00c5f907d08a647b8bf987514ad8c6b17971a7
	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 5.15.179 with commit d308661a0f4e7c8e86dfc7074a55ee5894c61538
	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 6.1.129 with commit 667f61b3498df751c8b3f0be1637e7226cbe3ed0
	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 6.6.78 with commit e0384efd45f615603e6869205b72040c209e69cc
	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 6.12.14 with commit 970cd2ed26cdab2b0f15b6d90d7eaa36538244a5
	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 6.13.3 with commit 4c04b0ab3a647e76d0e752b013de8e404abafc63
	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 6.14-rc2 with commit a1300691aed9ee852b0a9192e29e2bdc2411a7e6

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-21749
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/rose/af_rose.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/b8bf5c3fb778bbb1f3ff7d98ec577c969f687513
	https://git.kernel.org/stable/c/ed00c5f907d08a647b8bf987514ad8c6b17971a7
	https://git.kernel.org/stable/c/d308661a0f4e7c8e86dfc7074a55ee5894c61538
	https://git.kernel.org/stable/c/667f61b3498df751c8b3f0be1637e7226cbe3ed0
	https://git.kernel.org/stable/c/e0384efd45f615603e6869205b72040c209e69cc
	https://git.kernel.org/stable/c/970cd2ed26cdab2b0f15b6d90d7eaa36538244a5
	https://git.kernel.org/stable/c/4c04b0ab3a647e76d0e752b013de8e404abafc63
	https://git.kernel.org/stable/c/a1300691aed9ee852b0a9192e29e2bdc2411a7e6
