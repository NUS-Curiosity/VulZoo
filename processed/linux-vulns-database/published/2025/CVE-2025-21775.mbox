From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-21775: can: ctucanfd: handle skb allocation failure

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

can: ctucanfd: handle skb allocation failure

If skb allocation fails, the pointer to struct can_frame is NULL. This
is actually handled everywhere inside ctucan_err_interrupt() except for
the only place.

Add the missed NULL check.

Found by Linux Verification Center (linuxtesting.org) with SVACE static
analysis tool.

The Linux kernel CVE team has assigned CVE-2025-21775 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.19 with commit 2dcb8e8782d8e4c38903bf37b1a24d3ffd193da7 and fixed in 6.1.129 with commit 84b9ac59978a6a4e0812d1c938fad97306272cef
	Issue introduced in 5.19 with commit 2dcb8e8782d8e4c38903bf37b1a24d3ffd193da7 and fixed in 6.6.79 with commit e505b83b9ee6aa0ae2f4395f573a66579ae403fb
	Issue introduced in 5.19 with commit 2dcb8e8782d8e4c38903bf37b1a24d3ffd193da7 and fixed in 6.12.16 with commit b0e592dd46a0a952b41c3bf6c963afdd6a42b526
	Issue introduced in 5.19 with commit 2dcb8e8782d8e4c38903bf37b1a24d3ffd193da7 and fixed in 6.13.4 with commit e7e2e2318b1f085044126ba553a4e619842fc36d
	Issue introduced in 5.19 with commit 2dcb8e8782d8e4c38903bf37b1a24d3ffd193da7 and fixed in 6.14-rc3 with commit 9bd24927e3eeb85642c7baa3b28be8bea6c2a078

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-21775
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/can/ctucanfd/ctucanfd_base.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/84b9ac59978a6a4e0812d1c938fad97306272cef
	https://git.kernel.org/stable/c/e505b83b9ee6aa0ae2f4395f573a66579ae403fb
	https://git.kernel.org/stable/c/b0e592dd46a0a952b41c3bf6c963afdd6a42b526
	https://git.kernel.org/stable/c/e7e2e2318b1f085044126ba553a4e619842fc36d
	https://git.kernel.org/stable/c/9bd24927e3eeb85642c7baa3b28be8bea6c2a078
