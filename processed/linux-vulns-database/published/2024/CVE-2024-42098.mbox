From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-42098: crypto: ecdh - explicitly zeroize private_key

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

crypto: ecdh - explicitly zeroize private_key

private_key is overwritten with the key parameter passed in by the
caller (if present), or alternatively a newly generated private key.
However, it is possible that the caller provides a key (or the newly
generated key) which is shorter than the previous key. In that
scenario, some key material from the previous key would not be
overwritten. The easiest solution is to explicitly zeroize the entire
private_key array first.

Note that this patch slightly changes the behavior of this function:
previously, if the ecc_gen_privkey failed, the old private_key would
remain. Now, the private_key is always zeroized. This behavior is
consistent with the case where params.key is set and ecc_is_key_valid
fails.

The Linux kernel CVE team has assigned CVE-2024-42098 to this issue.


Affected and fixed versions
===========================

	Fixed in 5.15.162 with commit 39173b04abda87872b43c331468a4a14f8f05ce8
	Fixed in 6.1.97 with commit fd7ef325911eba1b7191b83cb580463242f2090d
	Fixed in 6.6.37 with commit 80575b252ab0358b7e93895b2a510beb3cb3f975
	Fixed in 6.9.8 with commit d96187eb8e59b572a8e6a68b6a9837a867ea29df
	Fixed in 6.10 with commit 73e5984e540a76a2ee1868b91590c922da8c24c9

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-42098
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	crypto/ecdh.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/39173b04abda87872b43c331468a4a14f8f05ce8
	https://git.kernel.org/stable/c/fd7ef325911eba1b7191b83cb580463242f2090d
	https://git.kernel.org/stable/c/80575b252ab0358b7e93895b2a510beb3cb3f975
	https://git.kernel.org/stable/c/d96187eb8e59b572a8e6a68b6a9837a867ea29df
	https://git.kernel.org/stable/c/73e5984e540a76a2ee1868b91590c922da8c24c9
