{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nfilelock: Fix fcntl/close race recovery compat path\n\nWhen I wrote commit 3cad1bc01041 (\"filelock: Remove locks reliably when\nfcntl/close race is detected\"), I missed that there are two copies of the\ncode I was patching: The normal version, and the version for 64-bit offsets\non 32-bit kernels.\nThanks to Greg KH for stumbling over this while doing the stable\nbackport...\n\nApply exactly the same fix to the compat path for 32-bit kernels."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "fs/locks.c"
               ],
               "versions": [
                  {
                     "version": "c293621bbf67",
                     "lessThan": "a561145f3ae9",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "c293621bbf67",
                     "lessThan": "4c43ad4ab416",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "c293621bbf67",
                     "lessThan": "911cc83e56a2",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "c293621bbf67",
                     "lessThan": "53e21cfa68a7",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "c293621bbf67",
                     "lessThan": "f4d0775c6e2f",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "c293621bbf67",
                     "lessThan": "73ae349534eb",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "c293621bbf67",
                     "lessThan": "5b0af8e4c70e",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "c293621bbf67",
                     "lessThan": "ed898f9ca3fa",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "c293621bbf67",
                     "lessThan": "f8138f2ad2f7",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "fs/locks.c"
               ],
               "versions": [
                  {
                     "version": "2.6.13",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "2.6.13",
                     "status": "unaffected",
                     "versionType": "custom"
                  },
                  {
                     "version": "4.19.319",
                     "lessThanOrEqual": "4.19.*",
                     "status": "unaffected",
                     "versionType": "custom"
                  },
                  {
                     "version": "5.4.281",
                     "lessThanOrEqual": "5.4.*",
                     "status": "unaffected",
                     "versionType": "custom"
                  },
                  {
                     "version": "5.10.223",
                     "lessThanOrEqual": "5.10.*",
                     "status": "unaffected",
                     "versionType": "custom"
                  },
                  {
                     "version": "5.15.164",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "custom"
                  },
                  {
                     "version": "6.1.102",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "custom"
                  },
                  {
                     "version": "6.6.43",
                     "lessThanOrEqual": "6.6.*",
                     "status": "unaffected",
                     "versionType": "custom"
                  },
                  {
                     "version": "6.9.12",
                     "lessThanOrEqual": "6.9.*",
                     "status": "unaffected",
                     "versionType": "custom"
                  },
                  {
                     "version": "6.10.2",
                     "lessThanOrEqual": "6.10.*",
                     "status": "unaffected",
                     "versionType": "custom"
                  },
                  {
                     "version": "6.11-rc1",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/a561145f3ae973ebf3e0aee41624e92a6c5cb38d"
            },
            {
               "url": "https://git.kernel.org/stable/c/4c43ad4ab41602201d34c66ac62130fe339d686f"
            },
            {
               "url": "https://git.kernel.org/stable/c/911cc83e56a2de5a40758766c6a70d6998248860"
            },
            {
               "url": "https://git.kernel.org/stable/c/53e21cfa68a7d12de378b7116c75571f73e0dfa2"
            },
            {
               "url": "https://git.kernel.org/stable/c/f4d0775c6e2f1340ca0725f0337de149aaa989ca"
            },
            {
               "url": "https://git.kernel.org/stable/c/73ae349534ebc377328e7d21891e589626c6e82c"
            },
            {
               "url": "https://git.kernel.org/stable/c/5b0af8e4c70e4b884bb94ff5f0cd49ecf1273c02"
            },
            {
               "url": "https://git.kernel.org/stable/c/ed898f9ca3fa32c56c858b463ceb9d9936cc69c4"
            },
            {
               "url": "https://git.kernel.org/stable/c/f8138f2ad2f745b9a1c696a05b749eabe44337ea"
            }
         ],
         "title": "filelock: Fix fcntl/close race recovery compat path",
         "x_generator": {
            "engine": "bippy-c9c4e1df01b2"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2024-41020",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
