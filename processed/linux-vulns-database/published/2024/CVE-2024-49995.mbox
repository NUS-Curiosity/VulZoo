From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-49995: tipc: guard against string buffer overrun

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

tipc: guard against string buffer overrun

Smatch reports that copying media_name and if_name to name_parts may
overwrite the destination.

 .../bearer.c:166 bearer_name_validate() error: strcpy() 'media_name' too large for 'name_parts->media_name' (32 vs 16)
 .../bearer.c:167 bearer_name_validate() error: strcpy() 'if_name' too large for 'name_parts->if_name' (1010102 vs 16)

This does seem to be the case so guard against this possibility by using
strscpy() and failing if truncation occurs.

Introduced by commit b97bf3fd8f6a ("[TIPC] Initial merge")

Compile tested only.

The Linux kernel CVE team has assigned CVE-2024-49995 to this issue.


Affected and fixed versions
===========================

	Fixed in 4.19.323 with commit 8298b6e45fb4d8944f356b08e4ea3e54df5e0488
	Fixed in 5.4.285 with commit c79768ffba5b6e95569a463a69b3101c95694867
	Fixed in 5.10.227 with commit e2b2558971e02ca33eb637a8350d68a48b3e8e46
	Fixed in 5.15.168 with commit 54dae0e9063ed23c9acf8d5ab9b18d3426a8ac18
	Fixed in 6.1.113 with commit 80c0be7bcf940ce9308311575c3aff8983c9b97a
	Fixed in 6.6.55 with commit 12d26aa7fd3cbdbc5149b6e516563478d575026e
	Fixed in 6.10.14 with commit 2ed7f42dfd3edb387034128ca5b0f639836d4ddd
	Fixed in 6.11.3 with commit a18c7b239d02aafb791ae2c45226f6bb40641792
	Fixed in 6.12 with commit 6555a2a9212be6983d2319d65276484f7c5f431a

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-49995
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/tipc/bearer.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/8298b6e45fb4d8944f356b08e4ea3e54df5e0488
	https://git.kernel.org/stable/c/c79768ffba5b6e95569a463a69b3101c95694867
	https://git.kernel.org/stable/c/e2b2558971e02ca33eb637a8350d68a48b3e8e46
	https://git.kernel.org/stable/c/54dae0e9063ed23c9acf8d5ab9b18d3426a8ac18
	https://git.kernel.org/stable/c/80c0be7bcf940ce9308311575c3aff8983c9b97a
	https://git.kernel.org/stable/c/12d26aa7fd3cbdbc5149b6e516563478d575026e
	https://git.kernel.org/stable/c/2ed7f42dfd3edb387034128ca5b0f639836d4ddd
	https://git.kernel.org/stable/c/a18c7b239d02aafb791ae2c45226f6bb40641792
	https://git.kernel.org/stable/c/6555a2a9212be6983d2319d65276484f7c5f431a
