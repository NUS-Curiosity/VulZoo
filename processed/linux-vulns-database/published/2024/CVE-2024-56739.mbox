From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-56739: rtc: check if __rtc_read_time was successful in rtc_timer_do_work()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

rtc: check if __rtc_read_time was successful in rtc_timer_do_work()

If the __rtc_read_time call fails,, the struct rtc_time tm; may contain
uninitialized data, or an illegal date/time read from the RTC hardware.

When calling rtc_tm_to_ktime later, the result may be a very large value
(possibly KTIME_MAX). If there are periodic timers in rtc->timerqueue,
they will continually expire, may causing kernel softlockup.

The Linux kernel CVE team has assigned CVE-2024-56739 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 2.6.38 with commit 6610e0893b8bc6f59b14fed7f089c5997f035f88 and fixed in 4.19.325 with commit 39ad0a1ae17b54509cd9e93dcd8cec16e7c12d3f
	Issue introduced in 2.6.38 with commit 6610e0893b8bc6f59b14fed7f089c5997f035f88 and fixed in 5.4.287 with commit 44b3257ff705d63d5f00ef8ed314a0eeb7ec37f2
	Issue introduced in 2.6.38 with commit 6610e0893b8bc6f59b14fed7f089c5997f035f88 and fixed in 5.10.231 with commit 0d68e8514d9040108ff7d1b37ca71096674b6efe
	Issue introduced in 2.6.38 with commit 6610e0893b8bc6f59b14fed7f089c5997f035f88 and fixed in 5.15.174 with commit 246f621d363988e7040f4546d20203dc713fa3e1
	Issue introduced in 2.6.38 with commit 6610e0893b8bc6f59b14fed7f089c5997f035f88 and fixed in 6.1.120 with commit fde56535505dde3336df438e949ef4742b6d6d6e
	Issue introduced in 2.6.38 with commit 6610e0893b8bc6f59b14fed7f089c5997f035f88 and fixed in 6.6.64 with commit dd4b1cbcc916fad5d10c2662b62def9f05e453d4
	Issue introduced in 2.6.38 with commit 6610e0893b8bc6f59b14fed7f089c5997f035f88 and fixed in 6.11.11 with commit a1f0b4af90cc18b10261ecde56c6a56b22c75bd1
	Issue introduced in 2.6.38 with commit 6610e0893b8bc6f59b14fed7f089c5997f035f88 and fixed in 6.12.2 with commit e77bce0a8c3989b4173c36f4195122bca8f4a3e1
	Issue introduced in 2.6.38 with commit 6610e0893b8bc6f59b14fed7f089c5997f035f88 and fixed in 6.13 with commit e8ba8a2bc4f60a1065f23d6a0e7cbea945a0f40d

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-56739
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/rtc/interface.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/39ad0a1ae17b54509cd9e93dcd8cec16e7c12d3f
	https://git.kernel.org/stable/c/44b3257ff705d63d5f00ef8ed314a0eeb7ec37f2
	https://git.kernel.org/stable/c/0d68e8514d9040108ff7d1b37ca71096674b6efe
	https://git.kernel.org/stable/c/246f621d363988e7040f4546d20203dc713fa3e1
	https://git.kernel.org/stable/c/fde56535505dde3336df438e949ef4742b6d6d6e
	https://git.kernel.org/stable/c/dd4b1cbcc916fad5d10c2662b62def9f05e453d4
	https://git.kernel.org/stable/c/a1f0b4af90cc18b10261ecde56c6a56b22c75bd1
	https://git.kernel.org/stable/c/e77bce0a8c3989b4173c36f4195122bca8f4a3e1
	https://git.kernel.org/stable/c/e8ba8a2bc4f60a1065f23d6a0e7cbea945a0f40d
