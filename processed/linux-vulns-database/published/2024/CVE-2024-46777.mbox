From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-46777: udf: Avoid excessive partition lengths

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

udf: Avoid excessive partition lengths

Avoid mounting filesystems where the partition would overflow the
32-bits used for block number. Also refuse to mount filesystems where
the partition length is so large we cannot safely index bits in a
block bitmap.

The Linux kernel CVE team has assigned CVE-2024-46777 to this issue.


Affected and fixed versions
===========================

	Fixed in 4.19.322 with commit c0c23130d38e8bc28e9ef581443de9b1fc749966
	Fixed in 5.4.284 with commit 1497a4484cdb2cf6c37960d788fb6ba67567bdb7
	Fixed in 5.10.226 with commit 551966371e17912564bc387fbeb2ac13077c3db1
	Fixed in 5.15.167 with commit 2ddf831451357c6da4b64645eb797c93c1c054d1
	Fixed in 6.1.110 with commit 0173999123082280cf904bd640015951f194a294
	Fixed in 6.6.51 with commit a56330761950cb83de1dfb348479f20c56c95f90
	Fixed in 6.10.10 with commit 925fd8ee80d5348a5e965548e5484d164d19221d
	Fixed in 6.11 with commit ebbe26fd54a9621994bc16b14f2ba8f84c089693

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-46777
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	fs/udf/super.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/c0c23130d38e8bc28e9ef581443de9b1fc749966
	https://git.kernel.org/stable/c/1497a4484cdb2cf6c37960d788fb6ba67567bdb7
	https://git.kernel.org/stable/c/551966371e17912564bc387fbeb2ac13077c3db1
	https://git.kernel.org/stable/c/2ddf831451357c6da4b64645eb797c93c1c054d1
	https://git.kernel.org/stable/c/0173999123082280cf904bd640015951f194a294
	https://git.kernel.org/stable/c/a56330761950cb83de1dfb348479f20c56c95f90
	https://git.kernel.org/stable/c/925fd8ee80d5348a5e965548e5484d164d19221d
	https://git.kernel.org/stable/c/ebbe26fd54a9621994bc16b14f2ba8f84c089693
