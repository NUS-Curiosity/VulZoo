From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-50201: drm/radeon: Fix encoder->possible_clones

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

drm/radeon: Fix encoder->possible_clones

Include the encoder itself in its possible_clones bitmask.
In the past nothing validated that drivers were populating
possible_clones correctly, but that changed in commit
74d2aacbe840 ("drm: Validate encoder->possible_clones").
Looks like radeon never got the memo and is still not
following the rules 100% correctly.

This results in some warnings during driver initialization:
Bogus possible_clones: [ENCODER:46:TV-46] possible_clones=0x4 (full encoder mask=0x7)
WARNING: CPU: 0 PID: 170 at drivers/gpu/drm/drm_mode_config.c:615 drm_mode_config_validate+0x113/0x39c
...

(cherry picked from commit 3b6e7d40649c0d75572039aff9d0911864c689db)

The Linux kernel CVE team has assigned CVE-2024-50201 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.8 with commit 74d2aacbe84042d89f572a3112a146fca05bfcb1 and fixed in 5.10.228 with commit df75c78bfeff99f9b4815c3e79e2b1b1e34fe264
	Issue introduced in 5.8 with commit 74d2aacbe84042d89f572a3112a146fca05bfcb1 and fixed in 5.15.169 with commit fda5dc80121b12871dc343ab37e0c3f0d138825d
	Issue introduced in 5.8 with commit 74d2aacbe84042d89f572a3112a146fca05bfcb1 and fixed in 6.1.114 with commit c3cd27d85f0778f4ec07384d7516b33153759b8e
	Issue introduced in 5.8 with commit 74d2aacbe84042d89f572a3112a146fca05bfcb1 and fixed in 6.6.58 with commit 1a235af0216411a32ab4db54f7bd19020b46c86d
	Issue introduced in 5.8 with commit 74d2aacbe84042d89f572a3112a146fca05bfcb1 and fixed in 6.11.5 with commit 68801730ebb9393460b30cd3885e407f15da27a9
	Issue introduced in 5.8 with commit 74d2aacbe84042d89f572a3112a146fca05bfcb1 and fixed in 6.12 with commit 28127dba64d8ae1a0b737b973d6d029908599611

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-50201
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/gpu/drm/radeon/radeon_encoders.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/df75c78bfeff99f9b4815c3e79e2b1b1e34fe264
	https://git.kernel.org/stable/c/fda5dc80121b12871dc343ab37e0c3f0d138825d
	https://git.kernel.org/stable/c/c3cd27d85f0778f4ec07384d7516b33153759b8e
	https://git.kernel.org/stable/c/1a235af0216411a32ab4db54f7bd19020b46c86d
	https://git.kernel.org/stable/c/68801730ebb9393460b30cd3885e407f15da27a9
	https://git.kernel.org/stable/c/28127dba64d8ae1a0b737b973d6d029908599611
