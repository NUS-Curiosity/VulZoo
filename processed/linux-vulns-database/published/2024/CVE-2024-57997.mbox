From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-57997: wifi: wcn36xx: fix channel survey memory allocation size

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

wifi: wcn36xx: fix channel survey memory allocation size

KASAN reported a memory allocation issue in wcn->chan_survey
due to incorrect size calculation.
This commit uses kcalloc to allocate memory for wcn->chan_survey,
ensuring proper initialization and preventing the use of uninitialized
values when there are no frames on the channel.

The Linux kernel CVE team has assigned CVE-2024-57997 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.18 with commit 29696e0aa413b9d56558731aae3806d7cff48d36 and fixed in 6.1.129 with commit ae68efdff7a7a42ab251cac79d8713de6f0dbaa0
	Issue introduced in 5.18 with commit 29696e0aa413b9d56558731aae3806d7cff48d36 and fixed in 6.6.76 with commit e95f9c408ff8311f75eeabc8acf34a66670d8815
	Issue introduced in 5.18 with commit 29696e0aa413b9d56558731aae3806d7cff48d36 and fixed in 6.12.13 with commit 64c4dcaeac1dc1030e47883b04a617ca9a4f164e
	Issue introduced in 5.18 with commit 29696e0aa413b9d56558731aae3806d7cff48d36 and fixed in 6.13.2 with commit 34cd2817708aec51ef1a6c007e0d6d5342a025d7
	Issue introduced in 5.18 with commit 29696e0aa413b9d56558731aae3806d7cff48d36 and fixed in 6.14-rc1 with commit 6200d947f050efdba4090dfefd8a01981363d954

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-57997
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/wireless/ath/wcn36xx/main.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/ae68efdff7a7a42ab251cac79d8713de6f0dbaa0
	https://git.kernel.org/stable/c/e95f9c408ff8311f75eeabc8acf34a66670d8815
	https://git.kernel.org/stable/c/64c4dcaeac1dc1030e47883b04a617ca9a4f164e
	https://git.kernel.org/stable/c/34cd2817708aec51ef1a6c007e0d6d5342a025d7
	https://git.kernel.org/stable/c/6200d947f050efdba4090dfefd8a01981363d954
