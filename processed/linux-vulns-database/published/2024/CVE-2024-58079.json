{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nmedia: uvcvideo: Fix crash during unbind if gpio unit is in use\n\nWe used the wrong device for the device managed functions. We used the\nusb device, when we should be using the interface device.\n\nIf we unbind the driver from the usb interface, the cleanup functions\nare never called. In our case, the IRQ is never disabled.\n\nIf an IRQ is triggered, it will try to access memory sections that are\nalready free, causing an OOPS.\n\nWe cannot use the function devm_request_threaded_irq here. The devm_*\nclean functions may be called after the main structure is released by\nuvc_delete.\n\nLuckily this bug has small impact, as it is only affected by devices\nwith gpio units and the user has to unbind the device, a disconnect will\nnot trigger this error."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/media/usb/uvc/uvc_driver.c",
                  "drivers/media/usb/uvc/uvcvideo.h"
               ],
               "versions": [
                  {
                     "version": "2886477ff98740cc3333cf785e4de0b1ff3d7a28",
                     "lessThan": "0fdd7cc593385e46e92e180b71e264fc9c195298",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "2886477ff98740cc3333cf785e4de0b1ff3d7a28",
                     "lessThan": "3c00e94d00ca079bef7906d6f39d1091bccfedd3",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "2886477ff98740cc3333cf785e4de0b1ff3d7a28",
                     "lessThan": "0b5e0445bc8384c18bd35cb9fe87f6258c6271d9",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "2886477ff98740cc3333cf785e4de0b1ff3d7a28",
                     "lessThan": "d2eac8b14ac690aa73052aa6d4ba69005715367e",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "2886477ff98740cc3333cf785e4de0b1ff3d7a28",
                     "lessThan": "5d2e65cbe53d0141ed095cf31c2dcf3d8668c11d",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "2886477ff98740cc3333cf785e4de0b1ff3d7a28",
                     "lessThan": "a9ea1a3d88b7947ce8cadb2afceee7a54872bbc5",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/media/usb/uvc/uvc_driver.c",
                  "drivers/media/usb/uvc/uvcvideo.h"
               ],
               "versions": [
                  {
                     "version": "5.12",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "5.12",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.15.179",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.130",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.6.78",
                     "lessThanOrEqual": "6.6.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.12.14",
                     "lessThanOrEqual": "6.12.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.13.3",
                     "lessThanOrEqual": "6.13.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.14-rc1",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/0fdd7cc593385e46e92e180b71e264fc9c195298"
            },
            {
               "url": "https://git.kernel.org/stable/c/3c00e94d00ca079bef7906d6f39d1091bccfedd3"
            },
            {
               "url": "https://git.kernel.org/stable/c/0b5e0445bc8384c18bd35cb9fe87f6258c6271d9"
            },
            {
               "url": "https://git.kernel.org/stable/c/d2eac8b14ac690aa73052aa6d4ba69005715367e"
            },
            {
               "url": "https://git.kernel.org/stable/c/5d2e65cbe53d0141ed095cf31c2dcf3d8668c11d"
            },
            {
               "url": "https://git.kernel.org/stable/c/a9ea1a3d88b7947ce8cadb2afceee7a54872bbc5"
            }
         ],
         "title": "media: uvcvideo: Fix crash during unbind if gpio unit is in use",
         "x_generator": {
            "engine": "bippy-5f407fcff5a0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2024-58079",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
