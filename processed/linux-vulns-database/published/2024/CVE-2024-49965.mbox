From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-49965: ocfs2: remove unreasonable unlock in ocfs2_read_blocks

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

ocfs2: remove unreasonable unlock in ocfs2_read_blocks

Patch series "Misc fixes for ocfs2_read_blocks", v5.

This series contains 2 fixes for ocfs2_read_blocks().  The first patch fix
the issue reported by syzbot, which detects bad unlock balance in
ocfs2_read_blocks().  The second patch fixes an issue reported by Heming
Zhao when reviewing above fix.


This patch (of 2):

There was a lock release before exiting, so remove the unreasonable unlock.

The Linux kernel CVE team has assigned CVE-2024-49965 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.19.87 with commit 6c150df9c2e80b5cf86f5a0d98beb7390ad63bfc and fixed in 4.19.323 with commit 5245f109b4afb6595360d4c180d483a6d2009a59
	Issue introduced in 4.20 with commit cf76c78595ca87548ca5e45c862ac9e0949c4687 and fixed in 5.4.285 with commit 9753bcb17b36c9add9b32c61766ddf8d2d161911
	Issue introduced in 4.20 with commit cf76c78595ca87548ca5e45c862ac9e0949c4687 and fixed in 5.10.227 with commit 3f1ca6ba5452d53c598a45d21267a2c0c221eef3
	Issue introduced in 4.20 with commit cf76c78595ca87548ca5e45c862ac9e0949c4687 and fixed in 5.15.168 with commit f55a33fe0fb5274ef185fd61947cf142138958af
	Issue introduced in 4.20 with commit cf76c78595ca87548ca5e45c862ac9e0949c4687 and fixed in 6.1.113 with commit 81aba693b129e82e11bb54f569504d943d018de9
	Issue introduced in 4.20 with commit cf76c78595ca87548ca5e45c862ac9e0949c4687 and fixed in 6.6.55 with commit 84543da867c967edffd5065fa910ebf56aaae49d
	Issue introduced in 4.20 with commit cf76c78595ca87548ca5e45c862ac9e0949c4687 and fixed in 6.10.14 with commit df4f20fc3673cee11abf2c571987a95733cb638d
	Issue introduced in 4.20 with commit cf76c78595ca87548ca5e45c862ac9e0949c4687 and fixed in 6.11.3 with commit 39a88623af3f1c686bf6db1e677ed865ffe6fccc
	Issue introduced in 4.20 with commit cf76c78595ca87548ca5e45c862ac9e0949c4687 and fixed in 6.12 with commit c03a82b4a0c935774afa01fd6d128b444fd930a1
	Issue introduced in 4.4.204 with commit 01f93d5e36753fc4d06ec67f05ce78c9c6f2dd56
	Issue introduced in 4.9.204 with commit 65cbd1279f4b999d56a838344a30642db24cd215
	Issue introduced in 4.14.157 with commit 97e1db17bc1ef4c2e1789bc9323c7be44fba53f8

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-49965
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	fs/ocfs2/buffer_head_io.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/5245f109b4afb6595360d4c180d483a6d2009a59
	https://git.kernel.org/stable/c/9753bcb17b36c9add9b32c61766ddf8d2d161911
	https://git.kernel.org/stable/c/3f1ca6ba5452d53c598a45d21267a2c0c221eef3
	https://git.kernel.org/stable/c/f55a33fe0fb5274ef185fd61947cf142138958af
	https://git.kernel.org/stable/c/81aba693b129e82e11bb54f569504d943d018de9
	https://git.kernel.org/stable/c/84543da867c967edffd5065fa910ebf56aaae49d
	https://git.kernel.org/stable/c/df4f20fc3673cee11abf2c571987a95733cb638d
	https://git.kernel.org/stable/c/39a88623af3f1c686bf6db1e677ed865ffe6fccc
	https://git.kernel.org/stable/c/c03a82b4a0c935774afa01fd6d128b444fd930a1
