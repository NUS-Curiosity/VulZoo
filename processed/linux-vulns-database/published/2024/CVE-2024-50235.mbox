From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-50235: wifi: cfg80211: clear wdev->cqm_config pointer on free

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

wifi: cfg80211: clear wdev->cqm_config pointer on free

When we free wdev->cqm_config when unregistering, we also
need to clear out the pointer since the same wdev/netdev
may get re-registered in another network namespace, then
destroyed later, running this code again, which results in
a double-free.

The Linux kernel CVE team has assigned CVE-2024-50235 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.1.57 with commit c797498e860e9a435a651bbf0789433684ce6dd8 and fixed in 6.1.116 with commit ba392e1355ba74b1d4fa11b85f71ab6ed7ecc058
	Issue introduced in 6.6 with commit 37c20b2effe987b806c8de6d12978e4ffeff026f and fixed in 6.6.60 with commit 6c44abb2d4c3262737d5d67832daebc8cf48b8c9
	Issue introduced in 6.6 with commit 37c20b2effe987b806c8de6d12978e4ffeff026f and fixed in 6.11.7 with commit 64e4c45d23cd7f6167f69cc2d2877bc7f54292e5
	Issue introduced in 6.6 with commit 37c20b2effe987b806c8de6d12978e4ffeff026f and fixed in 6.12 with commit d5fee261dfd9e17b08b1df8471ac5d5736070917
	Issue introduced in 6.5.7 with commit 32fb9b7d98c3e586bddfb978d383aa8d2b1211bc

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-50235
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/wireless/core.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/ba392e1355ba74b1d4fa11b85f71ab6ed7ecc058
	https://git.kernel.org/stable/c/6c44abb2d4c3262737d5d67832daebc8cf48b8c9
	https://git.kernel.org/stable/c/64e4c45d23cd7f6167f69cc2d2877bc7f54292e5
	https://git.kernel.org/stable/c/d5fee261dfd9e17b08b1df8471ac5d5736070917
