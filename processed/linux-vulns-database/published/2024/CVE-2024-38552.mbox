From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-38552: drm/amd/display: Fix potential index out of bounds in color transformation function

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

drm/amd/display: Fix potential index out of bounds in color transformation function

Fixes index out of bounds issue in the color transformation function.
The issue could occur when the index 'i' exceeds the number of transfer
function points (TRANSFER_FUNC_POINTS).

The fix adds a check to ensure 'i' is within bounds before accessing the
transfer function points. If 'i' is out of bounds, an error message is
logged and the function returns false to indicate an error.

Reported by smatch:
drivers/gpu/drm/amd/amdgpu/../display/dc/dcn10/dcn10_cm_common.c:405 cm_helper_translate_curve_to_hw_format() error: buffer overflow 'output_tf->tf_pts.red' 1025 <= s32max
drivers/gpu/drm/amd/amdgpu/../display/dc/dcn10/dcn10_cm_common.c:406 cm_helper_translate_curve_to_hw_format() error: buffer overflow 'output_tf->tf_pts.green' 1025 <= s32max
drivers/gpu/drm/amd/amdgpu/../display/dc/dcn10/dcn10_cm_common.c:407 cm_helper_translate_curve_to_hw_format() error: buffer overflow 'output_tf->tf_pts.blue' 1025 <= s32max

The Linux kernel CVE team has assigned CVE-2024-38552 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.16 with commit b629596072e5fa901c84f9e88d845a696ee32942 and fixed in 4.19.316 with commit 604c506ca43fce52bb882cff9c1fdf2ec3b4029c
	Issue introduced in 4.16 with commit b629596072e5fa901c84f9e88d845a696ee32942 and fixed in 5.4.278 with commit e280ab978c81443103d7c61bdd1d8d708cf6ed6d
	Issue introduced in 4.16 with commit b629596072e5fa901c84f9e88d845a696ee32942 and fixed in 5.10.219 with commit 04bc4d1090c343025d69149ca669a27c5b9c34a7
	Issue introduced in 4.16 with commit b629596072e5fa901c84f9e88d845a696ee32942 and fixed in 5.15.161 with commit ced9c4e2289a786b8fa684d8893b7045ea53ef7e
	Issue introduced in 4.16 with commit b629596072e5fa901c84f9e88d845a696ee32942 and fixed in 6.1.93 with commit 98b8a6bfd30d07a19cfacdf82b50f84bf3360869
	Issue introduced in 4.16 with commit b629596072e5fa901c84f9e88d845a696ee32942 and fixed in 6.6.33 with commit 4e8c8b37ee84b3b19c448d2b8e4c916d2f5b9c86
	Issue introduced in 4.16 with commit b629596072e5fa901c84f9e88d845a696ee32942 and fixed in 6.8.12 with commit 123edbae64f4d21984359b99c6e79fcde31c6123
	Issue introduced in 4.16 with commit b629596072e5fa901c84f9e88d845a696ee32942 and fixed in 6.9.3 with commit 7226ddf3311c5e5a7726ad7d4e7b079bb3cfbb29
	Issue introduced in 4.16 with commit b629596072e5fa901c84f9e88d845a696ee32942 and fixed in 6.10 with commit 63ae548f1054a0b71678d0349c7dc9628ddd42ca

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-38552
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/gpu/drm/amd/display/dc/dcn10/dcn10_cm_common.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/604c506ca43fce52bb882cff9c1fdf2ec3b4029c
	https://git.kernel.org/stable/c/e280ab978c81443103d7c61bdd1d8d708cf6ed6d
	https://git.kernel.org/stable/c/04bc4d1090c343025d69149ca669a27c5b9c34a7
	https://git.kernel.org/stable/c/ced9c4e2289a786b8fa684d8893b7045ea53ef7e
	https://git.kernel.org/stable/c/98b8a6bfd30d07a19cfacdf82b50f84bf3360869
	https://git.kernel.org/stable/c/4e8c8b37ee84b3b19c448d2b8e4c916d2f5b9c86
	https://git.kernel.org/stable/c/123edbae64f4d21984359b99c6e79fcde31c6123
	https://git.kernel.org/stable/c/7226ddf3311c5e5a7726ad7d4e7b079bb3cfbb29
	https://git.kernel.org/stable/c/63ae548f1054a0b71678d0349c7dc9628ddd42ca
