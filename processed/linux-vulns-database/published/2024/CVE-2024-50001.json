{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet/mlx5: Fix error path in multi-packet WQE transmit\n\nRemove the erroneous unmap in case no DMA mapping was established\n\nThe multi-packet WQE transmit code attempts to obtain a DMA mapping for\nthe skb. This could fail, e.g. under memory pressure, when the IOMMU\ndriver just can't allocate more memory for page tables. While the code\ntries to handle this in the path below the err_unmap label it erroneously\nunmaps one entry from the sq's FIFO list of active mappings. Since the\ncurrent map attempt failed this unmap is removing some random DMA mapping\nthat might still be required. If the PCI function now presents that IOVA,\nthe IOMMU may assumes a rogue DMA access and e.g. on s390 puts the PCI\nfunction in error state.\n\nThe erroneous behavior was seen in a stress-test environment that created\nmemory pressure."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/net/ethernet/mellanox/mlx5/core/en_tx.c"
               ],
               "versions": [
                  {
                     "version": "5af75c747e2a868abbf8611494b50ed5e076fca7",
                     "lessThan": "ca36d6c1a49b6965c86dd528a73f38bc62d9c625",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "5af75c747e2a868abbf8611494b50ed5e076fca7",
                     "lessThan": "ce828b347cf1b3c1b12b091d02463c35ce5097f5",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "5af75c747e2a868abbf8611494b50ed5e076fca7",
                     "lessThan": "fc357e78176945ca7bcacf92ab794b9ccd41b4f4",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "5af75c747e2a868abbf8611494b50ed5e076fca7",
                     "lessThan": "26fad69b34fcba80d5c7d9e651f628e6ac927754",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "5af75c747e2a868abbf8611494b50ed5e076fca7",
                     "lessThan": "ecf310aaf256acbc8182189fe0aa1021c3ddef72",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "5af75c747e2a868abbf8611494b50ed5e076fca7",
                     "lessThan": "8bb8c12fb5e2b1f03d603d493c92941676f109b5",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "5af75c747e2a868abbf8611494b50ed5e076fca7",
                     "lessThan": "2bcae12c795f32ddfbf8c80d1b5f1d3286341c32",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/net/ethernet/mellanox/mlx5/core/en_tx.c"
               ],
               "versions": [
                  {
                     "version": "5.10",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "5.10",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.10.227",
                     "lessThanOrEqual": "5.10.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.15.168",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.113",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.6.55",
                     "lessThanOrEqual": "6.6.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.10.14",
                     "lessThanOrEqual": "6.10.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.11.3",
                     "lessThanOrEqual": "6.11.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.12",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/ca36d6c1a49b6965c86dd528a73f38bc62d9c625"
            },
            {
               "url": "https://git.kernel.org/stable/c/ce828b347cf1b3c1b12b091d02463c35ce5097f5"
            },
            {
               "url": "https://git.kernel.org/stable/c/fc357e78176945ca7bcacf92ab794b9ccd41b4f4"
            },
            {
               "url": "https://git.kernel.org/stable/c/26fad69b34fcba80d5c7d9e651f628e6ac927754"
            },
            {
               "url": "https://git.kernel.org/stable/c/ecf310aaf256acbc8182189fe0aa1021c3ddef72"
            },
            {
               "url": "https://git.kernel.org/stable/c/8bb8c12fb5e2b1f03d603d493c92941676f109b5"
            },
            {
               "url": "https://git.kernel.org/stable/c/2bcae12c795f32ddfbf8c80d1b5f1d3286341c32"
            }
         ],
         "title": "net/mlx5: Fix error path in multi-packet WQE transmit",
         "x_generator": {
            "engine": "bippy-5f407fcff5a0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2024-50001",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
