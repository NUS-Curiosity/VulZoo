From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-50074: parport: Proper fix for array out-of-bounds access

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

parport: Proper fix for array out-of-bounds access

The recent fix for array out-of-bounds accesses replaced sprintf()
calls blindly with snprintf().  However, since snprintf() returns the
would-be-printed size, not the actually output size, the length
calculation can still go over the given limit.

Use scnprintf() instead of snprintf(), which returns the actually
output letters, for addressing the potential out-of-bounds access
properly.

The Linux kernel CVE team has assigned CVE-2024-50074 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.19.320 with commit 166a0bddcc27de41fe13f861c8348e8e53e988c8 and fixed in 4.19.323 with commit 8aadef73ba3b325704ed5cfc4696a25c350182cf
	Issue introduced in 5.4.282 with commit 47b3dce100778001cd76f7e9188944b5cb27a76d and fixed in 5.4.285 with commit b0641e53e6cb937487b6cfb15772374f0ba149b3
	Issue introduced in 5.10.224 with commit a44f88f7576bc1916d8d6293f5c62fbe7cbe03e0 and fixed in 5.10.228 with commit 1826b6d69bbb7f9ae8711827facbb2ad7f8d0aaa
	Issue introduced in 5.15.165 with commit c719b393374d3763e64900ee19aaed767d5a08d6 and fixed in 5.15.169 with commit 440311903231c6e6c9bcf8acb6a2885a422e00bc
	Issue introduced in 6.1.103 with commit 7f4da759092a1a6ce35fb085182d02de8cc4cc84 and fixed in 6.1.114 with commit fca048f222ce9dcbde5708ba2bf81d85a4a27952
	Issue introduced in 6.6.44 with commit b579ea3516c371ecf59d073772bc45dfd28c8a0e and fixed in 6.6.58 with commit 66029078fee00646e2e9dbb8f41ff7819f8e7569
	Issue introduced in 6.11 with commit ab11dac93d2d568d151b1918d7b84c2d02bacbd5 and fixed in 6.11.5 with commit 2a8b26a09c8e3ea03da1ef3cd0ef6b96e559fba6
	Issue introduced in 6.11 with commit ab11dac93d2d568d151b1918d7b84c2d02bacbd5 and fixed in 6.12 with commit 02ac3a9ef3a18b58d8f3ea2b6e46de657bf6c4f9
	Issue introduced in 6.10.3 with commit 7789a1d6792af410aa9b39a1eb237ed24fa2170a

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-50074
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/parport/procfs.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/8aadef73ba3b325704ed5cfc4696a25c350182cf
	https://git.kernel.org/stable/c/b0641e53e6cb937487b6cfb15772374f0ba149b3
	https://git.kernel.org/stable/c/1826b6d69bbb7f9ae8711827facbb2ad7f8d0aaa
	https://git.kernel.org/stable/c/440311903231c6e6c9bcf8acb6a2885a422e00bc
	https://git.kernel.org/stable/c/fca048f222ce9dcbde5708ba2bf81d85a4a27952
	https://git.kernel.org/stable/c/66029078fee00646e2e9dbb8f41ff7819f8e7569
	https://git.kernel.org/stable/c/2a8b26a09c8e3ea03da1ef3cd0ef6b96e559fba6
	https://git.kernel.org/stable/c/02ac3a9ef3a18b58d8f3ea2b6e46de657bf6c4f9
