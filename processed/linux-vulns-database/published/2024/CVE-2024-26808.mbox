From bippy-851b3ed3d212 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-26808: netfilter: nft_chain_filter: handle NETDEV_UNREGISTER for inet/ingress basechain

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

netfilter: nft_chain_filter: handle NETDEV_UNREGISTER for inet/ingress basechain

Remove netdevice from inet/ingress basechain in case NETDEV_UNREGISTER
event is reported, otherwise a stale reference to netdevice remains in
the hook list.

The Linux kernel CVE team has assigned CVE-2024-26808 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.10 with commit 60a3815da702 and fixed in 5.10.210 with commit 9489e214ea8f
	Issue introduced in 5.10 with commit 60a3815da702 and fixed in 5.15.149 with commit 70f17b48c866
	Issue introduced in 5.10 with commit 60a3815da702 and fixed in 6.1.76 with commit af149a46890e
	Issue introduced in 5.10 with commit 60a3815da702 and fixed in 6.6.15 with commit e5888acbf1a3
	Issue introduced in 5.10 with commit 60a3815da702 and fixed in 6.7.3 with commit 36a0a80f3220
	Issue introduced in 5.10 with commit 60a3815da702 and fixed in 6.8 with commit 01acb2e8666a

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-26808
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/netfilter/nft_chain_filter.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/9489e214ea8f2a90345516016aa51f2db3a8cc2f
	https://git.kernel.org/stable/c/70f17b48c86622217a58d5099d29242fc9adac58
	https://git.kernel.org/stable/c/af149a46890e8285d1618bd68b8d159bdb87fdb3
	https://git.kernel.org/stable/c/e5888acbf1a3d8d021990ce6c6061fd5b2bb21b4
	https://git.kernel.org/stable/c/36a0a80f32209238469deb481967d777a3d539ee
	https://git.kernel.org/stable/c/01acb2e8666a6529697141a6017edbf206921913
