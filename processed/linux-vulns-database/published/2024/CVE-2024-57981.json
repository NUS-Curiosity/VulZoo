{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nusb: xhci: Fix NULL pointer dereference on certain command aborts\n\nIf a command is queued to the final usable TRB of a ring segment, the\nenqueue pointer is advanced to the subsequent link TRB and no further.\nIf the command is later aborted, when the abort completion is handled\nthe dequeue pointer is advanced to the first TRB of the next segment.\n\nIf no further commands are queued, xhci_handle_stopped_cmd_ring() sees\nthe ring pointers unequal and assumes that there is a pending command,\nso it calls xhci_mod_cmd_timer() which crashes if cur_cmd was NULL.\n\nDon't attempt timer setup if cur_cmd is NULL. The subsequent doorbell\nring likely is unnecessary too, but it's harmless. Leave it alone.\n\nThis is probably Bug 219532, but no confirmation has been received.\n\nThe issue has been independently reproduced and confirmed fixed using\na USB MCU programmed to NAK the Status stage of SET_ADDRESS forever.\nEverything continued working normally after several prevented crashes."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/usb/host/xhci-ring.c"
               ],
               "versions": [
                  {
                     "version": "c311e391a7efd101250c0e123286709b7e736249",
                     "lessThan": "fd8bfaeba4a85b14427899adec0efb3954300653",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "c311e391a7efd101250c0e123286709b7e736249",
                     "lessThan": "b44253956407046e5907d4d72c8fa5b93ae94485",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "c311e391a7efd101250c0e123286709b7e736249",
                     "lessThan": "cf30300a216a4f8dce94e11781a866a09d4b50d4",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "c311e391a7efd101250c0e123286709b7e736249",
                     "lessThan": "4ff18870af793ce2034a6ad746e91d0a3d985b88",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "c311e391a7efd101250c0e123286709b7e736249",
                     "lessThan": "b649f0d5bc256f691c7d234c3986685d54053de1",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "c311e391a7efd101250c0e123286709b7e736249",
                     "lessThan": "ae069cd2ba09a2bd6a87a68c59ef0b7ea39cd641",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "c311e391a7efd101250c0e123286709b7e736249",
                     "lessThan": "0ce5c0dac768be14afe2426101b568a0f66bfc4d",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "c311e391a7efd101250c0e123286709b7e736249",
                     "lessThan": "1e0a19912adb68a4b2b74fd77001c96cd83eb073",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/usb/host/xhci-ring.c"
               ],
               "versions": [
                  {
                     "version": "3.16",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "3.16",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.4.291",
                     "lessThanOrEqual": "5.4.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.10.235",
                     "lessThanOrEqual": "5.10.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.15.179",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.129",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.6.76",
                     "lessThanOrEqual": "6.6.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.12.13",
                     "lessThanOrEqual": "6.12.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.13.2",
                     "lessThanOrEqual": "6.13.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.14-rc1",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/fd8bfaeba4a85b14427899adec0efb3954300653"
            },
            {
               "url": "https://git.kernel.org/stable/c/b44253956407046e5907d4d72c8fa5b93ae94485"
            },
            {
               "url": "https://git.kernel.org/stable/c/cf30300a216a4f8dce94e11781a866a09d4b50d4"
            },
            {
               "url": "https://git.kernel.org/stable/c/4ff18870af793ce2034a6ad746e91d0a3d985b88"
            },
            {
               "url": "https://git.kernel.org/stable/c/b649f0d5bc256f691c7d234c3986685d54053de1"
            },
            {
               "url": "https://git.kernel.org/stable/c/ae069cd2ba09a2bd6a87a68c59ef0b7ea39cd641"
            },
            {
               "url": "https://git.kernel.org/stable/c/0ce5c0dac768be14afe2426101b568a0f66bfc4d"
            },
            {
               "url": "https://git.kernel.org/stable/c/1e0a19912adb68a4b2b74fd77001c96cd83eb073"
            }
         ],
         "title": "usb: xhci: Fix NULL pointer dereference on certain command aborts",
         "x_generator": {
            "engine": "bippy-5f407fcff5a0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2024-57981",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
