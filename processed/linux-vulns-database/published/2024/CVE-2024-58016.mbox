From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-58016: safesetid: check size of policy writes

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

safesetid: check size of policy writes

syzbot attempts to write a buffer with a large size to a sysfs entry
with writes handled by handle_policy_update(), triggering a warning
in kmalloc.

Check the size specified for write buffers before allocating.

[PM: subject tweak]

The Linux kernel CVE team has assigned CVE-2024-58016 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.1 with commit aeca4e2ca65c1aeacfbe520684e6421719d99417 and fixed in 5.10.235 with commit 976284b94f2021df09829e37a367e19b84d9e5f3
	Issue introduced in 5.1 with commit aeca4e2ca65c1aeacfbe520684e6421719d99417 and fixed in 5.15.179 with commit ecf6a4a558097920447a6fb84dfdb279e2ac749a
	Issue introduced in 5.1 with commit aeca4e2ca65c1aeacfbe520684e6421719d99417 and fixed in 6.1.129 with commit a0dec65f88c8d9290dfa1d2ca1e897abe54c5881
	Issue introduced in 5.1 with commit aeca4e2ca65c1aeacfbe520684e6421719d99417 and fixed in 6.6.78 with commit 96fae5bd1589731592d30b3953a90a77ef3928a6
	Issue introduced in 5.1 with commit aeca4e2ca65c1aeacfbe520684e6421719d99417 and fixed in 6.12.14 with commit 36b385d0f2b4c0bf41d491e19075ecd990d2bf94
	Issue introduced in 5.1 with commit aeca4e2ca65c1aeacfbe520684e6421719d99417 and fixed in 6.13.3 with commit c71d35676d46090c891b6419f253fb92a1a9f4eb
	Issue introduced in 5.1 with commit aeca4e2ca65c1aeacfbe520684e6421719d99417 and fixed in 6.14-rc1 with commit f09ff307c7299392f1c88f763299e24bc99811c7

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-58016
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	security/safesetid/securityfs.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/976284b94f2021df09829e37a367e19b84d9e5f3
	https://git.kernel.org/stable/c/ecf6a4a558097920447a6fb84dfdb279e2ac749a
	https://git.kernel.org/stable/c/a0dec65f88c8d9290dfa1d2ca1e897abe54c5881
	https://git.kernel.org/stable/c/96fae5bd1589731592d30b3953a90a77ef3928a6
	https://git.kernel.org/stable/c/36b385d0f2b4c0bf41d491e19075ecd990d2bf94
	https://git.kernel.org/stable/c/c71d35676d46090c891b6419f253fb92a1a9f4eb
	https://git.kernel.org/stable/c/f09ff307c7299392f1c88f763299e24bc99811c7
