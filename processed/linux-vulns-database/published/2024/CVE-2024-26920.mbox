From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-26920: tracing/trigger: Fix to return error if failed to alloc snapshot

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

tracing/trigger: Fix to return error if failed to alloc snapshot

Fix register_snapshot_trigger() to return error code if it failed to
allocate a snapshot instead of 0 (success). Unless that, it will register
snapshot trigger without an error.

The Linux kernel CVE team has assigned CVE-2024-26920 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.7 with commit 0bbe7f719985efd9adb3454679ecef0984cb6800 and fixed in 6.1.79 with commit 36be97e9eb535fe3008a5cb040b1e56f29f2e398
	Issue introduced in 5.7 with commit 0bbe7f719985efd9adb3454679ecef0984cb6800 and fixed in 6.6.18 with commit 6022c065c9ec465d84cebff8f480db083e4ee06b
	Issue introduced in 5.7 with commit 0bbe7f719985efd9adb3454679ecef0984cb6800 and fixed in 6.7.6 with commit 4b001ef14baab16b553a002cb9979e31b8fc0c6b
	Issue introduced in 5.7 with commit 0bbe7f719985efd9adb3454679ecef0984cb6800 and fixed in 6.8 with commit 0958b33ef5a04ed91f61cef4760ac412080c4e08
	Issue introduced in 4.4.220 with commit 7c6feb347a4bb1f02e55f6814c93b5f7fab887a8
	Issue introduced in 4.9.220 with commit a289fd864722dcf5363fec66a35965d4964df515
	Issue introduced in 4.14.177 with commit 7054f86f268c0d9d62b52a4497dd0e8c10a7e5c7
	Issue introduced in 4.19.117 with commit 57f2a2ad73e99a7594515848f4da987326a15981
	Issue introduced in 5.4.34 with commit 0026e356e51ab3b54322eeb445c75a087ede5b9d
	Issue introduced in 5.5.19 with commit ffa70d104691aa609a18a9a6692049deb35f431f
	Issue introduced in 5.6.6 with commit 733c611a758c68894a4480fb999637476118a8fc

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-26920
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	kernel/trace/trace_events_trigger.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/36be97e9eb535fe3008a5cb040b1e56f29f2e398
	https://git.kernel.org/stable/c/6022c065c9ec465d84cebff8f480db083e4ee06b
	https://git.kernel.org/stable/c/4b001ef14baab16b553a002cb9979e31b8fc0c6b
	https://git.kernel.org/stable/c/0958b33ef5a04ed91f61cef4760ac412080c4e08
