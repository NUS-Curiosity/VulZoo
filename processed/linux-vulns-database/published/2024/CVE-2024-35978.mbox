From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-35978: Bluetooth: Fix memory leak in hci_req_sync_complete()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

Bluetooth: Fix memory leak in hci_req_sync_complete()

In 'hci_req_sync_complete()', always free the previous sync
request state before assigning reference to a new one.

The Linux kernel CVE team has assigned CVE-2024-35978 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.1 with commit f60cb30579d3401cab1ed36b42df5c0568ae0ba7 and fixed in 4.19.313 with commit 89a32741f4217856066c198a4a7267bcdd1edd67
	Issue introduced in 4.1 with commit f60cb30579d3401cab1ed36b42df5c0568ae0ba7 and fixed in 5.4.275 with commit 4beab84fbb50df3be1d8f8a976e6fe882ca65cb2
	Issue introduced in 4.1 with commit f60cb30579d3401cab1ed36b42df5c0568ae0ba7 and fixed in 5.10.216 with commit 8478394f76c748862ef179a16f651f752bdafaf0
	Issue introduced in 4.1 with commit f60cb30579d3401cab1ed36b42df5c0568ae0ba7 and fixed in 5.15.156 with commit 75193678cce993aa959e7764b6df2f599886dd06
	Issue introduced in 4.1 with commit f60cb30579d3401cab1ed36b42df5c0568ae0ba7 and fixed in 6.1.87 with commit 66fab1e120b39f8f47a94186ddee36006fc02ca8
	Issue introduced in 4.1 with commit f60cb30579d3401cab1ed36b42df5c0568ae0ba7 and fixed in 6.6.28 with commit 9ab5e44b9bac946bd49fd63264a08cd1ea494e76
	Issue introduced in 4.1 with commit f60cb30579d3401cab1ed36b42df5c0568ae0ba7 and fixed in 6.8.7 with commit e4cb8382fff6706436b66eafd9c0ee857ff0a9f5
	Issue introduced in 4.1 with commit f60cb30579d3401cab1ed36b42df5c0568ae0ba7 and fixed in 6.9 with commit 45d355a926ab40f3ae7bc0b0a00cb0e3e8a5a810

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-35978
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/bluetooth/hci_request.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/89a32741f4217856066c198a4a7267bcdd1edd67
	https://git.kernel.org/stable/c/4beab84fbb50df3be1d8f8a976e6fe882ca65cb2
	https://git.kernel.org/stable/c/8478394f76c748862ef179a16f651f752bdafaf0
	https://git.kernel.org/stable/c/75193678cce993aa959e7764b6df2f599886dd06
	https://git.kernel.org/stable/c/66fab1e120b39f8f47a94186ddee36006fc02ca8
	https://git.kernel.org/stable/c/9ab5e44b9bac946bd49fd63264a08cd1ea494e76
	https://git.kernel.org/stable/c/e4cb8382fff6706436b66eafd9c0ee857ff0a9f5
	https://git.kernel.org/stable/c/45d355a926ab40f3ae7bc0b0a00cb0e3e8a5a810
