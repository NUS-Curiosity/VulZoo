From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-53136: mm: revert "mm: shmem: fix data-race in shmem_getattr()"

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

mm: revert "mm: shmem: fix data-race in shmem_getattr()"

Revert d949d1d14fa2 ("mm: shmem: fix data-race in shmem_getattr()") as
suggested by Chuck [1].  It is causing deadlocks when accessing tmpfs over
NFS.

As Hugh commented, "added just to silence a syzbot sanitizer splat: added
where there has never been any practical problem".

The Linux kernel CVE team has assigned CVE-2024-53136 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.19.323 with commit 9fb9703cd43ee20a6de8ccdef991677b7274cec0 and fixed in 4.19.325 with commit 36b537e8f302f670c7cf35d88a3a294443e32d52
	Issue introduced in 5.4.285 with commit 7cc30ada84323be19395094d567579536e0d187e and fixed in 5.4.287 with commit a3c65022d89d5baa2cea8e87a6de983ea305f14c
	Issue introduced in 5.10.229 with commit bda1a99a0dd644f31a87d636ac624eeb975cb65a and fixed in 5.10.231 with commit 57cc8d253099d1b8627f0fb487ee011d9158ccc9
	Issue introduced in 5.15.171 with commit 3d9528484480e8f4979b3a347930ed383be99f89 and fixed in 5.15.174 with commit d3f9d88c2c03b2646ace336236adca19f7697bd3
	Issue introduced in 6.1.116 with commit 82cae1e30bd940253593c2d4f16d88343d1358f4 and fixed in 6.1.119 with commit 5874c1150e77296565ad6e495ef41fbf87570d14
	Issue introduced in 6.6.60 with commit edd1f905050686fdc4cfe233d818469fdf7d5ff8 and fixed in 6.6.63 with commit 64e67e8694252c1bf01b802ee911be3fee62c36b
	Issue introduced in 6.11.7 with commit ffd56612566bc23877c8f45def2801f3324a222a and fixed in 6.11.10 with commit 901dc2ad7c3789fa87dc3956f6697c5d62d5cf7e

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-53136
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	mm/shmem.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/36b537e8f302f670c7cf35d88a3a294443e32d52
	https://git.kernel.org/stable/c/a3c65022d89d5baa2cea8e87a6de983ea305f14c
	https://git.kernel.org/stable/c/57cc8d253099d1b8627f0fb487ee011d9158ccc9
	https://git.kernel.org/stable/c/d3f9d88c2c03b2646ace336236adca19f7697bd3
	https://git.kernel.org/stable/c/5874c1150e77296565ad6e495ef41fbf87570d14
	https://git.kernel.org/stable/c/64e67e8694252c1bf01b802ee911be3fee62c36b
	https://git.kernel.org/stable/c/901dc2ad7c3789fa87dc3956f6697c5d62d5cf7e
	https://git.kernel.org/stable/c/d1aa0c04294e29883d65eac6c2f72fe95cc7c049
