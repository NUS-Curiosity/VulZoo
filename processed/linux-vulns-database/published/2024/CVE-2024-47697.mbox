From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-47697: drivers: media: dvb-frontends/rtl2830: fix an out-of-bounds write error

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

drivers: media: dvb-frontends/rtl2830: fix an out-of-bounds write error

Ensure index in rtl2830_pid_filter does not exceed 31 to prevent
out-of-bounds access.

dev->filters is a 32-bit value, so set_bit and clear_bit functions should
only operate on indices from 0 to 31. If index is 32, it will attempt to
access a non-existent 33rd bit, leading to out-of-bounds access.
Change the boundary check from index > 32 to index >= 32 to resolve this
issue.

The Linux kernel CVE team has assigned CVE-2024-47697 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.0 with commit df70ddad81b47c57bcccffc805fbd75f2f1b2dc6 and fixed in 4.19.323 with commit 8ffbe7d07b8e76193b151107878ddc1ccc94deb5
	Issue introduced in 4.0 with commit df70ddad81b47c57bcccffc805fbd75f2f1b2dc6 and fixed in 5.4.285 with commit 883f794c6e498ae24680aead55c16f66b06cfc30
	Issue introduced in 4.0 with commit df70ddad81b47c57bcccffc805fbd75f2f1b2dc6 and fixed in 5.10.227 with commit badbd736e6649c4e6d7b4ff7e2b9857acfa9ea94
	Issue introduced in 4.0 with commit df70ddad81b47c57bcccffc805fbd75f2f1b2dc6 and fixed in 5.15.168 with commit 86d920d2600c3a48efc2775c1666c1017eec6956
	Issue introduced in 4.0 with commit df70ddad81b47c57bcccffc805fbd75f2f1b2dc6 and fixed in 6.1.113 with commit 3dba83d3c81de1368d15a39f22df7b53e306052f
	Issue introduced in 4.0 with commit df70ddad81b47c57bcccffc805fbd75f2f1b2dc6 and fixed in 6.6.54 with commit 58f31be7dfbc0c84a6497ad51924949cf64b86a2
	Issue introduced in 4.0 with commit df70ddad81b47c57bcccffc805fbd75f2f1b2dc6 and fixed in 6.10.13 with commit 7fd6aae7e53b94f4035b1bfce28b8dfa0d0ae470
	Issue introduced in 4.0 with commit df70ddad81b47c57bcccffc805fbd75f2f1b2dc6 and fixed in 6.11.2 with commit 042b101d7bf70616c4967c286ffa6fcca65babfb
	Issue introduced in 4.0 with commit df70ddad81b47c57bcccffc805fbd75f2f1b2dc6 and fixed in 6.12 with commit 46d7ebfe6a75a454a5fa28604f0ef1491f9d8d14

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-47697
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/media/dvb-frontends/rtl2830.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/8ffbe7d07b8e76193b151107878ddc1ccc94deb5
	https://git.kernel.org/stable/c/883f794c6e498ae24680aead55c16f66b06cfc30
	https://git.kernel.org/stable/c/badbd736e6649c4e6d7b4ff7e2b9857acfa9ea94
	https://git.kernel.org/stable/c/86d920d2600c3a48efc2775c1666c1017eec6956
	https://git.kernel.org/stable/c/3dba83d3c81de1368d15a39f22df7b53e306052f
	https://git.kernel.org/stable/c/58f31be7dfbc0c84a6497ad51924949cf64b86a2
	https://git.kernel.org/stable/c/7fd6aae7e53b94f4035b1bfce28b8dfa0d0ae470
	https://git.kernel.org/stable/c/042b101d7bf70616c4967c286ffa6fcca65babfb
	https://git.kernel.org/stable/c/46d7ebfe6a75a454a5fa28604f0ef1491f9d8d14
