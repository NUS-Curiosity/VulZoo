From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-56603: net: af_can: do not leave a dangling sk pointer in can_create()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

net: af_can: do not leave a dangling sk pointer in can_create()

On error can_create() frees the allocated sk object, but sock_init_data()
has already attached it to the provided sock object. This will leave a
dangling sk pointer in the sock object and may cause use-after-free later.

The Linux kernel CVE team has assigned CVE-2024-56603 to this issue.


Affected and fixed versions
===========================

	Fixed in 5.4.287 with commit 884ae8bcee749be43a071d6ed2d89058dbd2425c
	Fixed in 5.10.231 with commit ce39b5576785bb3e66591145aad03d66bc3e778d
	Fixed in 5.15.174 with commit 1fe625f12d090d69f3f084990c7e4c1ff94bfe5f
	Fixed in 6.1.120 with commit 5947c9ac08f0771ea8ed64186b0d52e9029cb6c0
	Fixed in 6.6.66 with commit db207d19adbac96058685f6257720906ad41d215
	Fixed in 6.12.5 with commit 8df832e6b945e1ba61467d7f1c9305e314ae92fe
	Fixed in 6.13 with commit 811a7ca7320c062e15d0f5b171fe6ad8592d1434

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-56603
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/can/af_can.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/884ae8bcee749be43a071d6ed2d89058dbd2425c
	https://git.kernel.org/stable/c/ce39b5576785bb3e66591145aad03d66bc3e778d
	https://git.kernel.org/stable/c/1fe625f12d090d69f3f084990c7e4c1ff94bfe5f
	https://git.kernel.org/stable/c/5947c9ac08f0771ea8ed64186b0d52e9029cb6c0
	https://git.kernel.org/stable/c/db207d19adbac96058685f6257720906ad41d215
	https://git.kernel.org/stable/c/8df832e6b945e1ba61467d7f1c9305e314ae92fe
	https://git.kernel.org/stable/c/811a7ca7320c062e15d0f5b171fe6ad8592d1434
