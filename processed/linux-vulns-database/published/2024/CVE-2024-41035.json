{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nUSB: core: Fix duplicate endpoint bug by clearing reserved bits in the descriptor\n\nSyzbot has identified a bug in usbcore (see the Closes: tag below)\ncaused by our assumption that the reserved bits in an endpoint\ndescriptor's bEndpointAddress field will always be 0.  As a result of\nthe bug, the endpoint_is_duplicate() routine in config.c (and possibly\nother routines as well) may believe that two descriptors are for\ndistinct endpoints, even though they have the same direction and\nendpoint number.  This can lead to confusion, including the bug\nidentified by syzbot (two descriptors with matching endpoint numbers\nand directions, where one was interrupt and the other was bulk).\n\nTo fix the bug, we will clear the reserved bits in bEndpointAddress\nwhen we parse the descriptor.  (Note that both the USB-2.0 and USB-3.1\nspecs say these bits are \"Reserved, reset to zero\".)  This requires us\nto make a copy of the descriptor earlier in usb_parse_endpoint() and\nuse the copy instead of the original when checking for duplicates."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/usb/core/config.c"
               ],
               "versions": [
                  {
                     "version": "0a8fd1346254",
                     "lessThan": "d8418fd083d1",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "0a8fd1346254",
                     "lessThan": "60abea505b72",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "0a8fd1346254",
                     "lessThan": "d09dd21bb521",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "0a8fd1346254",
                     "lessThan": "2bd8534a1b83",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "0a8fd1346254",
                     "lessThan": "9edcf317620d",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "0a8fd1346254",
                     "lessThan": "647d61aef106",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "0a8fd1346254",
                     "lessThan": "37514a5c1251",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "0a8fd1346254",
                     "lessThan": "a368ecde8a50",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/usb/core/config.c"
               ],
               "versions": [
                  {
                     "version": "4.10",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "4.10",
                     "status": "unaffected",
                     "versionType": "custom"
                  },
                  {
                     "version": "4.19.318",
                     "lessThanOrEqual": "4.19.*",
                     "status": "unaffected",
                     "versionType": "custom"
                  },
                  {
                     "version": "5.4.280",
                     "lessThanOrEqual": "5.4.*",
                     "status": "unaffected",
                     "versionType": "custom"
                  },
                  {
                     "version": "5.10.222",
                     "lessThanOrEqual": "5.10.*",
                     "status": "unaffected",
                     "versionType": "custom"
                  },
                  {
                     "version": "5.15.163",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "custom"
                  },
                  {
                     "version": "6.1.100",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "custom"
                  },
                  {
                     "version": "6.6.41",
                     "lessThanOrEqual": "6.6.*",
                     "status": "unaffected",
                     "versionType": "custom"
                  },
                  {
                     "version": "6.9.10",
                     "lessThanOrEqual": "6.9.*",
                     "status": "unaffected",
                     "versionType": "custom"
                  },
                  {
                     "version": "6.10",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/d8418fd083d1b90a6c007cf8dcf81aeae274727b"
            },
            {
               "url": "https://git.kernel.org/stable/c/60abea505b726b38232a0ef410d2bd1994a77f78"
            },
            {
               "url": "https://git.kernel.org/stable/c/d09dd21bb5215d583ca9a1cb1464dbc77a7e88cf"
            },
            {
               "url": "https://git.kernel.org/stable/c/2bd8534a1b83c65702aec3cab164170f8e584188"
            },
            {
               "url": "https://git.kernel.org/stable/c/9edcf317620d7c6a8354911b69b874cf89716646"
            },
            {
               "url": "https://git.kernel.org/stable/c/647d61aef106dbed9c70447bcddbd4968e67ca64"
            },
            {
               "url": "https://git.kernel.org/stable/c/37514a5c1251a8c5c95c323f55050736e7069ac7"
            },
            {
               "url": "https://git.kernel.org/stable/c/a368ecde8a5055b627749b09c6218ef793043e47"
            }
         ],
         "title": "USB: core: Fix duplicate endpoint bug by clearing reserved bits in the descriptor",
         "x_generator": {
            "engine": "bippy-c9c4e1df01b2"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2024-41035",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
