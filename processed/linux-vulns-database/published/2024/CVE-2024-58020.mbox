From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-58020: HID: multitouch: Add NULL check in mt_input_configured

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

HID: multitouch: Add NULL check in mt_input_configured

devm_kasprintf() can return a NULL pointer on failure,but this
returned value in mt_input_configured() is not checked.
Add NULL check in mt_input_configured(), to handle kernel NULL
pointer dereference error.

The Linux kernel CVE team has assigned CVE-2024-58020 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.4.257 with commit df7ca43fe090e1a56c216c8ebc106ef5fd49afc6 and fixed in 5.4.291 with commit a04d96ef67a42165f93194eef22a270acba4b74c
	Issue introduced in 5.10.195 with commit 15ec7cb55e7d88755aa01d44a7a1015a42bfce86 and fixed in 5.10.235 with commit a6bfd3856e9f3da083f177753c623d58ba935e0a
	Issue introduced in 5.15.132 with commit dde88ab4e45beb60b217026207aa9c14c88d71ab and fixed in 5.15.179 with commit 2052b44cd0a62b6fdbe3371e5ba6029c56c400ca
	Issue introduced in 6.1.53 with commit 2763732ec1e68910719c75b6b896e11b6d3d622b and fixed in 6.1.129 with commit 4e7113f591163d99adc7cbcd7295030c8c5d3fc7
	Issue introduced in 6.6 with commit 4794394635293a3e74591351fff469cea7ad15a2 and fixed in 6.6.79 with commit 62f8bf06262b6fc55c58f4c5256140f1382f3b01
	Issue introduced in 6.6 with commit 4794394635293a3e74591351fff469cea7ad15a2 and fixed in 6.12.16 with commit aa879ef6d3acf96fa2c7122d0632061d4ea58d48
	Issue introduced in 6.6 with commit 4794394635293a3e74591351fff469cea7ad15a2 and fixed in 6.13.4 with commit 97c09cc2e72769edb6994b531edcfa313b96bade
	Issue introduced in 6.6 with commit 4794394635293a3e74591351fff469cea7ad15a2 and fixed in 6.14-rc3 with commit 9b8e2220d3a052a690b1d1b23019673e612494c5
	Issue introduced in 4.14.326 with commit ac0d389402a6ff9ad92cea02c2d8c711483b91ab
	Issue introduced in 4.19.295 with commit 39c70c19456e50dcb3abfe53539220dff0490f1d
	Issue introduced in 6.4.16 with commit 1d7833db9fd118415dace2ca157bfa603dec9c8c
	Issue introduced in 6.5.3 with commit b70ac7849248ec8128fa12f86e3655ba38838f29

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-58020
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/hid/hid-multitouch.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/a04d96ef67a42165f93194eef22a270acba4b74c
	https://git.kernel.org/stable/c/a6bfd3856e9f3da083f177753c623d58ba935e0a
	https://git.kernel.org/stable/c/2052b44cd0a62b6fdbe3371e5ba6029c56c400ca
	https://git.kernel.org/stable/c/4e7113f591163d99adc7cbcd7295030c8c5d3fc7
	https://git.kernel.org/stable/c/62f8bf06262b6fc55c58f4c5256140f1382f3b01
	https://git.kernel.org/stable/c/aa879ef6d3acf96fa2c7122d0632061d4ea58d48
	https://git.kernel.org/stable/c/97c09cc2e72769edb6994b531edcfa313b96bade
	https://git.kernel.org/stable/c/9b8e2220d3a052a690b1d1b23019673e612494c5
