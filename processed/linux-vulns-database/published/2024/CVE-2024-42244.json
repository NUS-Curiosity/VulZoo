{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nUSB: serial: mos7840: fix crash on resume\n\nSince commit c49cfa917025 (\"USB: serial: use generic method if no\nalternative is provided in usb serial layer\"), USB serial core calls the\ngeneric resume implementation when the driver has not provided one.\n\nThis can trigger a crash on resume with mos7840 since support for\nmultiple read URBs was added back in 2011. Specifically, both port read\nURBs are now submitted on resume for open ports, but the context pointer\nof the second URB is left set to the core rather than mos7840 port\nstructure.\n\nFix this by implementing dedicated suspend and resume functions for\nmos7840.\n\nTested with Delock 87414 USB 2.0 to 4x serial adapter.\n\n[ johan: analyse crash and rewrite commit message; set busy flag on\n         resume; drop bulk-in check; drop unnecessary usb_kill_urb() ]"
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/usb/serial/mos7840.c"
               ],
               "versions": [
                  {
                     "version": "d83b405383c965498923f3561c3321e2b5df5727",
                     "lessThan": "932a86a711c722b45ed47ba2103adca34d225b33",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "d83b405383c965498923f3561c3321e2b5df5727",
                     "lessThan": "b14aa5673e0a8077ff4b74f0bb260735e7d5e6a4",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "d83b405383c965498923f3561c3321e2b5df5727",
                     "lessThan": "1094ed500987e67a9d18b0f95e1812f1cc720856",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "d83b405383c965498923f3561c3321e2b5df5727",
                     "lessThan": "5ae6a64f18211851c8df6b4221381c438b9a7348",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "d83b405383c965498923f3561c3321e2b5df5727",
                     "lessThan": "553e67dec846323b5575e78a776cf594c13f98c4",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "d83b405383c965498923f3561c3321e2b5df5727",
                     "lessThan": "c15a688e49987385baa8804bf65d570e362f8576",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/usb/serial/mos7840.c"
               ],
               "versions": [
                  {
                     "version": "3.3",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "3.3",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.10.222",
                     "lessThanOrEqual": "5.10.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.15.163",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.100",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.6.41",
                     "lessThanOrEqual": "6.6.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.9.10",
                     "lessThanOrEqual": "6.9.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.10",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/932a86a711c722b45ed47ba2103adca34d225b33"
            },
            {
               "url": "https://git.kernel.org/stable/c/b14aa5673e0a8077ff4b74f0bb260735e7d5e6a4"
            },
            {
               "url": "https://git.kernel.org/stable/c/1094ed500987e67a9d18b0f95e1812f1cc720856"
            },
            {
               "url": "https://git.kernel.org/stable/c/5ae6a64f18211851c8df6b4221381c438b9a7348"
            },
            {
               "url": "https://git.kernel.org/stable/c/553e67dec846323b5575e78a776cf594c13f98c4"
            },
            {
               "url": "https://git.kernel.org/stable/c/c15a688e49987385baa8804bf65d570e362f8576"
            }
         ],
         "title": "USB: serial: mos7840: fix crash on resume",
         "x_generator": {
            "engine": "bippy-5f407fcff5a0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2024-42244",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
