{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nenic: Validate length of nl attributes in enic_set_vf_port\n\nenic_set_vf_port assumes that the nl attribute IFLA_PORT_PROFILE\nis of length PORT_PROFILE_MAX and that the nl attributes\nIFLA_PORT_INSTANCE_UUID, IFLA_PORT_HOST_UUID are of length PORT_UUID_MAX.\nThese attributes are validated (in the function do_setlink in rtnetlink.c)\nusing the nla_policy ifla_port_policy. The policy defines IFLA_PORT_PROFILE\nas NLA_STRING, IFLA_PORT_INSTANCE_UUID as NLA_BINARY and\nIFLA_PORT_HOST_UUID as NLA_STRING. That means that the length validation\nusing the policy is for the max size of the attributes and not on exact\nsize so the length of these attributes might be less than the sizes that\nenic_set_vf_port expects. This might cause an out of bands\nread access in the memcpys of the data of these\nattributes in enic_set_vf_port."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/net/ethernet/cisco/enic/enic_main.c"
               ],
               "versions": [
                  {
                     "version": "f8bd909183ac",
                     "lessThan": "2b649d7e0cb4",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "f8bd909183ac",
                     "lessThan": "ca63fb7af9d3",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "f8bd909183ac",
                     "lessThan": "3c0d36972edb",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "f8bd909183ac",
                     "lessThan": "25571a12fbc8",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "f8bd909183ac",
                     "lessThan": "7077c22f84f4",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "f8bd909183ac",
                     "lessThan": "f6638e955ca0",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "f8bd909183ac",
                     "lessThan": "aee1955a1509",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "f8bd909183ac",
                     "lessThan": "e8021b94b041",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/net/ethernet/cisco/enic/enic_main.c"
               ],
               "versions": [
                  {
                     "version": "2.6.35",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "2.6.35",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "4.19.316",
                     "lessThanOrEqual": "4.19.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.4.278",
                     "lessThanOrEqual": "5.4.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.10.219",
                     "lessThanOrEqual": "5.10.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.15.161",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.93",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.6.33",
                     "lessThanOrEqual": "6.6.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.9.4",
                     "lessThanOrEqual": "6.9.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.10",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/2b649d7e0cb42a660f0260ef25fd55fdc9c6c600"
            },
            {
               "url": "https://git.kernel.org/stable/c/ca63fb7af9d3e531aa25f7ae187bfc6c7166ec2d"
            },
            {
               "url": "https://git.kernel.org/stable/c/3c0d36972edbe56fcf98899622d9b90ac9965227"
            },
            {
               "url": "https://git.kernel.org/stable/c/25571a12fbc8a1283bd8380d461267956fd426f7"
            },
            {
               "url": "https://git.kernel.org/stable/c/7077c22f84f41974a711604a42fd0e0684232ee5"
            },
            {
               "url": "https://git.kernel.org/stable/c/f6638e955ca00c489894789492776842e102af9c"
            },
            {
               "url": "https://git.kernel.org/stable/c/aee1955a1509a921c05c70dad5d6fc8563dfcb31"
            },
            {
               "url": "https://git.kernel.org/stable/c/e8021b94b0412c37bcc79027c2e382086b6ce449"
            }
         ],
         "title": "enic: Validate length of nl attributes in enic_set_vf_port",
         "x_generator": {
            "engine": "bippy-9e1c9544281a"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2024-38659",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
