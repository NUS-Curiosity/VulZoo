{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnetem: fix return value if duplicate enqueue fails\n\nThere is a bug in netem_enqueue() introduced by\ncommit 5845f706388a (\"net: netem: fix skb length BUG_ON in __skb_to_sgvec\")\nthat can lead to a use-after-free.\n\nThis commit made netem_enqueue() always return NET_XMIT_SUCCESS\nwhen a packet is duplicated, which can cause the parent qdisc's q.qlen\nto be mistakenly incremented. When this happens qlen_notify() may be\nskipped on the parent during destruction, leaving a dangling pointer\nfor some classful qdiscs like DRR.\n\nThere are two ways for the bug happen:\n\n- If the duplicated packet is dropped by rootq->enqueue() and then\n  the original packet is also dropped.\n- If rootq->enqueue() sends the duplicated packet to a different qdisc\n  and the original packet is dropped.\n\nIn both cases NET_XMIT_SUCCESS is returned even though no packets\nare enqueued at the netem qdisc.\n\nThe fix is to defer the enqueue of the duplicate packet until after\nthe original packet has been guaranteed to return NET_XMIT_SUCCESS."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "net/sched/sch_netem.c"
               ],
               "versions": [
                  {
                     "version": "5845f706388a4cde0f6b80f9e5d33527e942b7d9",
                     "lessThan": "759e3e8c4a6a6b4e52ebc4547123a457f0ce90d4",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "5845f706388a4cde0f6b80f9e5d33527e942b7d9",
                     "lessThan": "c414000da1c2ea1ba9a5e5bb1a4ba774e51e202d",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "5845f706388a4cde0f6b80f9e5d33527e942b7d9",
                     "lessThan": "52d99a69f3d556c6426048c9d481b912205919d8",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "5845f706388a4cde0f6b80f9e5d33527e942b7d9",
                     "lessThan": "0486d31dd8198e22b63a4730244b38fffce6d469",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "5845f706388a4cde0f6b80f9e5d33527e942b7d9",
                     "lessThan": "577d6c0619467fe90f7e8e57e45cb5bd9d936014",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "5845f706388a4cde0f6b80f9e5d33527e942b7d9",
                     "lessThan": "e5bb2988a310667abed66c7d3ffa28880cf0f883",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "5845f706388a4cde0f6b80f9e5d33527e942b7d9",
                     "lessThan": "c07ff8592d57ed258afee5a5e04991a48dbaf382",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "net/sched/sch_netem.c"
               ],
               "versions": [
                  {
                     "version": "5.0",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "5.0",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.4.283",
                     "lessThanOrEqual": "5.4.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.10.225",
                     "lessThanOrEqual": "5.10.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.15.166",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.107",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.6.48",
                     "lessThanOrEqual": "6.6.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.10.7",
                     "lessThanOrEqual": "6.10.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.11",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/759e3e8c4a6a6b4e52ebc4547123a457f0ce90d4"
            },
            {
               "url": "https://git.kernel.org/stable/c/c414000da1c2ea1ba9a5e5bb1a4ba774e51e202d"
            },
            {
               "url": "https://git.kernel.org/stable/c/52d99a69f3d556c6426048c9d481b912205919d8"
            },
            {
               "url": "https://git.kernel.org/stable/c/0486d31dd8198e22b63a4730244b38fffce6d469"
            },
            {
               "url": "https://git.kernel.org/stable/c/577d6c0619467fe90f7e8e57e45cb5bd9d936014"
            },
            {
               "url": "https://git.kernel.org/stable/c/e5bb2988a310667abed66c7d3ffa28880cf0f883"
            },
            {
               "url": "https://git.kernel.org/stable/c/c07ff8592d57ed258afee5a5e04991a48dbaf382"
            }
         ],
         "title": "netem: fix return value if duplicate enqueue fails",
         "x_generator": {
            "engine": "bippy-5f407fcff5a0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2024-45016",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
