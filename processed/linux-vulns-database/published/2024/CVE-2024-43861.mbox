From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-43861: net: usb: qmi_wwan: fix memory leak for not ip packets

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

net: usb: qmi_wwan: fix memory leak for not ip packets

Free the unused skb when not ip packets arrive.

The Linux kernel CVE team has assigned CVE-2024-43861 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.12 with commit c6adf77953bcec0ad63d7782479452464e50f7a3 and fixed in 4.19.320 with commit 3c90a69533b5bba73401ef884d033ea49ee99662
	Issue introduced in 4.12 with commit c6adf77953bcec0ad63d7782479452464e50f7a3 and fixed in 5.4.282 with commit 37c093449704017870604994ba9b813cdb9475a4
	Issue introduced in 4.12 with commit c6adf77953bcec0ad63d7782479452464e50f7a3 and fixed in 5.10.224 with commit e87f52225e04a7001bf55bbd7a330fa4252327b5
	Issue introduced in 4.12 with commit c6adf77953bcec0ad63d7782479452464e50f7a3 and fixed in 5.15.165 with commit c4251a3deccad852b27e60625f31fba6cc14372f
	Issue introduced in 4.12 with commit c6adf77953bcec0ad63d7782479452464e50f7a3 and fixed in 6.1.105 with commit da518cc9b64df391795d9952aed551e0f782e446
	Issue introduced in 4.12 with commit c6adf77953bcec0ad63d7782479452464e50f7a3 and fixed in 6.6.46 with commit f2c353227de14b0289298ffc3ba92058c4768384
	Issue introduced in 4.12 with commit c6adf77953bcec0ad63d7782479452464e50f7a3 and fixed in 6.10.5 with commit c6c5b91424fafc0f83852d961c10c7e43a001882
	Issue introduced in 4.12 with commit c6adf77953bcec0ad63d7782479452464e50f7a3 and fixed in 6.11 with commit 7ab107544b777c3bd7feb9fe447367d8edd5b202

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-43861
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/usb/qmi_wwan.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/3c90a69533b5bba73401ef884d033ea49ee99662
	https://git.kernel.org/stable/c/37c093449704017870604994ba9b813cdb9475a4
	https://git.kernel.org/stable/c/e87f52225e04a7001bf55bbd7a330fa4252327b5
	https://git.kernel.org/stable/c/c4251a3deccad852b27e60625f31fba6cc14372f
	https://git.kernel.org/stable/c/da518cc9b64df391795d9952aed551e0f782e446
	https://git.kernel.org/stable/c/f2c353227de14b0289298ffc3ba92058c4768384
	https://git.kernel.org/stable/c/c6c5b91424fafc0f83852d961c10c7e43a001882
	https://git.kernel.org/stable/c/7ab107544b777c3bd7feb9fe447367d8edd5b202
