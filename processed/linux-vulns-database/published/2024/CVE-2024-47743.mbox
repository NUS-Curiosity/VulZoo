From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-47743: KEYS: prevent NULL pointer dereference in find_asymmetric_key()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

KEYS: prevent NULL pointer dereference in find_asymmetric_key()

In find_asymmetric_key(), if all NULLs are passed in the id_{0,1,2}
arguments, the kernel will first emit WARN but then have an oops
because id_2 gets dereferenced anyway.

Add the missing id_2 check and move WARN_ON() to the final else branch
to avoid duplicate NULL checks.

Found by Linux Verification Center (linuxtesting.org) with Svace static
analysis tool.

The Linux kernel CVE team has assigned CVE-2024-47743 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.17 with commit 7d30198ee24f2ddcc4fefcd38a9b76bd8ab31360 and fixed in 6.1.113 with commit 3322fa8f2aa40b0b3651034cd541647a600cc6c0
	Issue introduced in 5.17 with commit 7d30198ee24f2ddcc4fefcd38a9b76bd8ab31360 and fixed in 6.6.54 with commit a3765b497a4f5224cb2f7a6a2d3357d3066214ee
	Issue introduced in 5.17 with commit 7d30198ee24f2ddcc4fefcd38a9b76bd8ab31360 and fixed in 6.10.13 with commit 13b5b401ead95b5d8266f64904086c55b6024900
	Issue introduced in 5.17 with commit 7d30198ee24f2ddcc4fefcd38a9b76bd8ab31360 and fixed in 6.11.2 with commit 0d3b0706ada15c333e6f9faf19590ff715e45d1e
	Issue introduced in 5.17 with commit 7d30198ee24f2ddcc4fefcd38a9b76bd8ab31360 and fixed in 6.12 with commit 70fd1966c93bf3bfe3fe6d753eb3d83a76597eef

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-47743
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	crypto/asymmetric_keys/asymmetric_type.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/3322fa8f2aa40b0b3651034cd541647a600cc6c0
	https://git.kernel.org/stable/c/a3765b497a4f5224cb2f7a6a2d3357d3066214ee
	https://git.kernel.org/stable/c/13b5b401ead95b5d8266f64904086c55b6024900
	https://git.kernel.org/stable/c/0d3b0706ada15c333e6f9faf19590ff715e45d1e
	https://git.kernel.org/stable/c/70fd1966c93bf3bfe3fe6d753eb3d83a76597eef
