From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-50179: ceph: remove the incorrect Fw reference check when dirtying pages

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

ceph: remove the incorrect Fw reference check when dirtying pages

When doing the direct-io reads it will also try to mark pages dirty,
but for the read path it won't hold the Fw caps and there is case
will it get the Fw reference.

The Linux kernel CVE team has assigned CVE-2024-50179 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.2 with commit 5dda377cf0a6bd43f64a3c1efb670d7c668e7b29 and fixed in 4.19.323 with commit c26c5ec832dd9e9dcd0a0a892a485c99889b68f0
	Issue introduced in 4.2 with commit 5dda377cf0a6bd43f64a3c1efb670d7c668e7b29 and fixed in 5.4.285 with commit 126b567a2ef65fc38a71d832bf1216c56816f231
	Issue introduced in 4.2 with commit 5dda377cf0a6bd43f64a3c1efb670d7c668e7b29 and fixed in 5.10.227 with commit f55e003d261baa7c57d51ae5c8ec1f5c26a35c89
	Issue introduced in 4.2 with commit 5dda377cf0a6bd43f64a3c1efb670d7c668e7b29 and fixed in 5.15.168 with commit f863bfd0a2c6c99011c62ea71ac04f8e78707da9
	Issue introduced in 4.2 with commit 5dda377cf0a6bd43f64a3c1efb670d7c668e7b29 and fixed in 6.1.113 with commit ea98284fc4fb05f276737d2043b02b62be5a8dfb
	Issue introduced in 4.2 with commit 5dda377cf0a6bd43f64a3c1efb670d7c668e7b29 and fixed in 6.6.55 with commit 11ab19d48ab877430eed0c7d83810970bbcbc4f6
	Issue introduced in 4.2 with commit 5dda377cf0a6bd43f64a3c1efb670d7c668e7b29 and fixed in 6.10.14 with commit 9d4f619153bab7fa59736462967821d6521a38cb
	Issue introduced in 4.2 with commit 5dda377cf0a6bd43f64a3c1efb670d7c668e7b29 and fixed in 6.11.3 with commit 74b302ebad5b43ac17460fa58092d892a3cba6eb
	Issue introduced in 4.2 with commit 5dda377cf0a6bd43f64a3c1efb670d7c668e7b29 and fixed in 6.12 with commit c08dfb1b49492c09cf13838c71897493ea3b424e

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-50179
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	fs/ceph/addr.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/c26c5ec832dd9e9dcd0a0a892a485c99889b68f0
	https://git.kernel.org/stable/c/126b567a2ef65fc38a71d832bf1216c56816f231
	https://git.kernel.org/stable/c/f55e003d261baa7c57d51ae5c8ec1f5c26a35c89
	https://git.kernel.org/stable/c/f863bfd0a2c6c99011c62ea71ac04f8e78707da9
	https://git.kernel.org/stable/c/ea98284fc4fb05f276737d2043b02b62be5a8dfb
	https://git.kernel.org/stable/c/11ab19d48ab877430eed0c7d83810970bbcbc4f6
	https://git.kernel.org/stable/c/9d4f619153bab7fa59736462967821d6521a38cb
	https://git.kernel.org/stable/c/74b302ebad5b43ac17460fa58092d892a3cba6eb
	https://git.kernel.org/stable/c/c08dfb1b49492c09cf13838c71897493ea3b424e
