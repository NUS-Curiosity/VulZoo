From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-56691: mfd: intel_soc_pmic_bxtwc: Use IRQ domain for USB Type-C device

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

mfd: intel_soc_pmic_bxtwc: Use IRQ domain for USB Type-C device

While design wise the idea of converting the driver to use
the hierarchy of the IRQ chips is correct, the implementation
has (inherited) flaws. This was unveiled when platform_get_irq()
had started WARN() on IRQ 0 that is supposed to be a Linux
IRQ number (also known as vIRQ).

Rework the driver to respect IRQ domain when creating each MFD
device separately, as the domain is not the same for all of them.

The Linux kernel CVE team has assigned CVE-2024-56691 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.9 with commit 9c6235c8633210cc2da0882e2e9d6ff90aa37503 and fixed in 5.4.287 with commit 0997e77c51330c2866a4f39480e762cca92ad953
	Issue introduced in 4.9 with commit 9c6235c8633210cc2da0882e2e9d6ff90aa37503 and fixed in 5.10.231 with commit 0b648968bfa4f5c9c4983bca9f2de17626ed6fb6
	Issue introduced in 4.9 with commit 9c6235c8633210cc2da0882e2e9d6ff90aa37503 and fixed in 5.15.174 with commit 23230ac3c5ca3f154b64849d1cf50583b4e6b98c
	Issue introduced in 4.9 with commit 9c6235c8633210cc2da0882e2e9d6ff90aa37503 and fixed in 6.1.120 with commit c310e6916c0b297011d0fec03f168a6b24e9e984
	Issue introduced in 4.9 with commit 9c6235c8633210cc2da0882e2e9d6ff90aa37503 and fixed in 6.6.64 with commit e1ef62e8d262e3f27446d26742208c1c81e9ee18
	Issue introduced in 4.9 with commit 9c6235c8633210cc2da0882e2e9d6ff90aa37503 and fixed in 6.11.11 with commit 518e414d24e7037d6cc7198e942bf47fe6f5e8e1
	Issue introduced in 4.9 with commit 9c6235c8633210cc2da0882e2e9d6ff90aa37503 and fixed in 6.12.2 with commit 87a07a5b0b296e489c606ca95ffc16c18821975b
	Issue introduced in 4.9 with commit 9c6235c8633210cc2da0882e2e9d6ff90aa37503 and fixed in 6.13 with commit 686fb77712a4bc94b76a0c5ae74c60118b7a0d79

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-56691
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/mfd/intel_soc_pmic_bxtwc.c
	drivers/usb/typec/tcpm/wcove.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/0997e77c51330c2866a4f39480e762cca92ad953
	https://git.kernel.org/stable/c/0b648968bfa4f5c9c4983bca9f2de17626ed6fb6
	https://git.kernel.org/stable/c/23230ac3c5ca3f154b64849d1cf50583b4e6b98c
	https://git.kernel.org/stable/c/c310e6916c0b297011d0fec03f168a6b24e9e984
	https://git.kernel.org/stable/c/e1ef62e8d262e3f27446d26742208c1c81e9ee18
	https://git.kernel.org/stable/c/518e414d24e7037d6cc7198e942bf47fe6f5e8e1
	https://git.kernel.org/stable/c/87a07a5b0b296e489c606ca95ffc16c18821975b
	https://git.kernel.org/stable/c/686fb77712a4bc94b76a0c5ae74c60118b7a0d79
