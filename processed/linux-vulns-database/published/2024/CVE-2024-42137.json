{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nBluetooth: qca: Fix BT enable failure again for QCA6390 after warm reboot\n\nCommit 272970be3dab (\"Bluetooth: hci_qca: Fix driver shutdown on closed\nserdev\") will cause below regression issue:\n\nBT can't be enabled after below steps:\ncold boot -> enable BT -> disable BT -> warm reboot -> BT enable failure\nif property enable-gpios is not configured within DT|ACPI for QCA6390.\n\nThe commit is to fix a use-after-free issue within qca_serdev_shutdown()\nby adding condition to avoid the serdev is flushed or wrote after closed\nbut also introduces this regression issue regarding above steps since the\nVSC is not sent to reset controller during warm reboot.\n\nFixed by sending the VSC to reset controller within qca_serdev_shutdown()\nonce BT was ever enabled, and the use-after-free issue is also fixed by\nthis change since the serdev is still opened before it is flushed or wrote.\n\nVerified by the reported machine Dell XPS 13 9310 laptop over below two\nkernel commits:\ncommit e00fc2700a3f (\"Bluetooth: btusb: Fix triggering coredump\nimplementation for QCA\") of bluetooth-next tree.\ncommit b23d98d46d28 (\"Bluetooth: btusb: Fix triggering coredump\nimplementation for QCA\") of linus mainline tree."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/bluetooth/hci_qca.c"
               ],
               "versions": [
                  {
                     "version": "e84ec6e25df9bb0968599e92eacedaf3a0a5b587",
                     "lessThan": "215a26c2404fa34625c725d446967fa328a703eb",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "908d1742b6e694e84ead5c62e4b7c1bfbb8b46a3",
                     "lessThan": "4ca6013cd18e58ac1044908c40d4006a92093a11",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "ea3ebda47dd56f6e1c62f2e0e1b6e1b0a973e447",
                     "lessThan": "e6e200b264271f62a3fadb51ada9423015ece37b",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "272970be3dabd24cbe50e393ffee8f04aec3b9a8",
                     "lessThan": "e2d8aa4c763593704ac21e7591aed4f13e32f3b5",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "272970be3dabd24cbe50e393ffee8f04aec3b9a8",
                     "lessThan": "977b9dc65e14fb80de4763d949c7dec2ecb15b9b",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "272970be3dabd24cbe50e393ffee8f04aec3b9a8",
                     "lessThan": "88e72239ead9814b886db54fc4ee39ef3c2b8f26",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/bluetooth/hci_qca.c"
               ],
               "versions": [
                  {
                     "version": "6.2",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "6.2",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.10.222",
                     "lessThanOrEqual": "5.10.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.15.163",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.98",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.6.39",
                     "lessThanOrEqual": "6.6.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.9.9",
                     "lessThanOrEqual": "6.9.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.10",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/215a26c2404fa34625c725d446967fa328a703eb"
            },
            {
               "url": "https://git.kernel.org/stable/c/4ca6013cd18e58ac1044908c40d4006a92093a11"
            },
            {
               "url": "https://git.kernel.org/stable/c/e6e200b264271f62a3fadb51ada9423015ece37b"
            },
            {
               "url": "https://git.kernel.org/stable/c/e2d8aa4c763593704ac21e7591aed4f13e32f3b5"
            },
            {
               "url": "https://git.kernel.org/stable/c/977b9dc65e14fb80de4763d949c7dec2ecb15b9b"
            },
            {
               "url": "https://git.kernel.org/stable/c/88e72239ead9814b886db54fc4ee39ef3c2b8f26"
            }
         ],
         "title": "Bluetooth: qca: Fix BT enable failure again for QCA6390 after warm reboot",
         "x_generator": {
            "engine": "bippy-5f407fcff5a0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2024-42137",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
