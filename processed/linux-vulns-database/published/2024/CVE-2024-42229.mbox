From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-42229: crypto: aead,cipher - zeroize key buffer after use

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

crypto: aead,cipher - zeroize key buffer after use

I.G 9.7.B for FIPS 140-3 specifies that variables temporarily holding
cryptographic information should be zeroized once they are no longer
needed. Accomplish this by using kfree_sensitive for buffers that
previously held the private key.

The Linux kernel CVE team has assigned CVE-2024-42229 to this issue.


Affected and fixed versions
===========================

	Fixed in 4.19.323 with commit 89b9b6fa4463daf820e6a5ef65c3b0c2db239513
	Fixed in 5.4.285 with commit b716e9c3603ee95ed45e938fe47227d22cf3ec35
	Fixed in 5.10.222 with commit 9db8c299a521813630fcb4154298cb60c37f3133
	Fixed in 5.15.163 with commit 71dd428615375e36523f4d4f7685ddd54113646d
	Fixed in 6.1.98 with commit 28c8d274848feba552e95c5c2a7e3cfe8f15c534
	Fixed in 6.6.39 with commit b502d4a08875ea2b4ea5d5b28dc7c991c8b90cfb
	Fixed in 6.9.9 with commit f58679996a831754a356974376f248aa0af2eb8e
	Fixed in 6.10 with commit 23e4099bdc3c8381992f9eb975c79196d6755210

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-42229
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	crypto/aead.c
	crypto/cipher.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/89b9b6fa4463daf820e6a5ef65c3b0c2db239513
	https://git.kernel.org/stable/c/b716e9c3603ee95ed45e938fe47227d22cf3ec35
	https://git.kernel.org/stable/c/9db8c299a521813630fcb4154298cb60c37f3133
	https://git.kernel.org/stable/c/71dd428615375e36523f4d4f7685ddd54113646d
	https://git.kernel.org/stable/c/28c8d274848feba552e95c5c2a7e3cfe8f15c534
	https://git.kernel.org/stable/c/b502d4a08875ea2b4ea5d5b28dc7c991c8b90cfb
	https://git.kernel.org/stable/c/f58679996a831754a356974376f248aa0af2eb8e
	https://git.kernel.org/stable/c/23e4099bdc3c8381992f9eb975c79196d6755210
