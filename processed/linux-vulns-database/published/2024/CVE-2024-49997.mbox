From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-49997: net: ethernet: lantiq_etop: fix memory disclosure

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

net: ethernet: lantiq_etop: fix memory disclosure

When applying padding, the buffer is not zeroed, which results in memory
disclosure. The mentioned data is observed on the wire. This patch uses
skb_put_padto() to pad Ethernet frames properly. The mentioned function
zeroes the expanded buffer.

In case the packet cannot be padded it is silently dropped. Statistics
are also not incremented. This driver does not support statistics in the
old 32-bit format or the new 64-bit format. These will be added in the
future. In its current form, the patch should be easily backported to
stable versions.

Ethernet MACs on Amazon-SE and Danube cannot do padding of the packets
in hardware, so software padding must be applied.

The Linux kernel CVE team has assigned CVE-2024-49997 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.0 with commit 504d4721ee8e432af4b5f196a08af38bc4dac5fe and fixed in 4.19.323 with commit 905f06a34f960676e7dc77bea00f2f8fe18177ad
	Issue introduced in 3.0 with commit 504d4721ee8e432af4b5f196a08af38bc4dac5fe and fixed in 5.4.285 with commit 60c068444c20bf9a3e22b65b5f6f3d9edc852931
	Issue introduced in 3.0 with commit 504d4721ee8e432af4b5f196a08af38bc4dac5fe and fixed in 5.10.227 with commit 185df159843d30fb71f821e7ea4368c2a3bfcd36
	Issue introduced in 3.0 with commit 504d4721ee8e432af4b5f196a08af38bc4dac5fe and fixed in 5.15.168 with commit 469856f76f4802c5d7e3d20e343185188de1e2db
	Issue introduced in 3.0 with commit 504d4721ee8e432af4b5f196a08af38bc4dac5fe and fixed in 6.1.113 with commit 2bf4c101d7c99483b8b15a0c8f881e3f399f7e18
	Issue introduced in 3.0 with commit 504d4721ee8e432af4b5f196a08af38bc4dac5fe and fixed in 6.6.55 with commit e66e38d07b31e177ca430758ed97fbc79f27d966
	Issue introduced in 3.0 with commit 504d4721ee8e432af4b5f196a08af38bc4dac5fe and fixed in 6.10.14 with commit 1097bf16501ed5e35358d848b0a94ad2830b0f65
	Issue introduced in 3.0 with commit 504d4721ee8e432af4b5f196a08af38bc4dac5fe and fixed in 6.11.3 with commit 431b122933b197820d319eb3987a67d04346ce9e
	Issue introduced in 3.0 with commit 504d4721ee8e432af4b5f196a08af38bc4dac5fe and fixed in 6.12 with commit 45c0de18ff2dc9af01236380404bbd6a46502c69

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-49997
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/ethernet/lantiq_etop.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/905f06a34f960676e7dc77bea00f2f8fe18177ad
	https://git.kernel.org/stable/c/60c068444c20bf9a3e22b65b5f6f3d9edc852931
	https://git.kernel.org/stable/c/185df159843d30fb71f821e7ea4368c2a3bfcd36
	https://git.kernel.org/stable/c/469856f76f4802c5d7e3d20e343185188de1e2db
	https://git.kernel.org/stable/c/2bf4c101d7c99483b8b15a0c8f881e3f399f7e18
	https://git.kernel.org/stable/c/e66e38d07b31e177ca430758ed97fbc79f27d966
	https://git.kernel.org/stable/c/1097bf16501ed5e35358d848b0a94ad2830b0f65
	https://git.kernel.org/stable/c/431b122933b197820d319eb3987a67d04346ce9e
	https://git.kernel.org/stable/c/45c0de18ff2dc9af01236380404bbd6a46502c69
