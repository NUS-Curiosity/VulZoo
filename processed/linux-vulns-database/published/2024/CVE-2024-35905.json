{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf: Protect against int overflow for stack access size\n\nThis patch re-introduces protection against the size of access to stack\nmemory being negative; the access size can appear negative as a result\nof overflowing its signed int representation. This should not actually\nhappen, as there are other protections along the way, but we should\nprotect against it anyway. One code path was missing such protections\n(fixed in the previous patch in the series), causing out-of-bounds array\naccesses in check_stack_range_initialized(). This patch causes the\nverification of a program with such a non-sensical access size to fail.\n\nThis check used to exist in a more indirect way, but was inadvertendly\nremoved in a833a17aeac7."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "kernel/bpf/verifier.c"
               ],
               "versions": [
                  {
                     "version": "afea95d319cc",
                     "lessThan": "9970e059af47",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "02962684258e",
                     "lessThan": "37dc1718dc0c",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "b1d4d54d32ce",
                     "lessThan": "98cdac206b11",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "08b91babccbb",
                     "lessThan": "3f0784b2f1eb",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "a833a17aeac7",
                     "lessThan": "203a68151e8e",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "a833a17aeac7",
                     "lessThan": "ecc6a2101840",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "kernel/bpf/verifier.c"
               ],
               "versions": [
                  {
                     "version": "6.8",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "6.8",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.10.215",
                     "lessThanOrEqual": "5.10.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.15.154",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.85",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.6.26",
                     "lessThanOrEqual": "6.6.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.8.5",
                     "lessThanOrEqual": "6.8.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.9",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/9970e059af471478455f9534e8c3db82f8c5496d"
            },
            {
               "url": "https://git.kernel.org/stable/c/37dc1718dc0c4392dbfcb9adec22a776e745dd69"
            },
            {
               "url": "https://git.kernel.org/stable/c/98cdac206b112bec63852e94802791e316acc2c1"
            },
            {
               "url": "https://git.kernel.org/stable/c/3f0784b2f1eb9147973d8c43ba085c5fdf44ff69"
            },
            {
               "url": "https://git.kernel.org/stable/c/203a68151e8eeb331d4a64ab78303f3a15faf103"
            },
            {
               "url": "https://git.kernel.org/stable/c/ecc6a2101840177e57c925c102d2d29f260d37c8"
            }
         ],
         "title": "bpf: Protect against int overflow for stack access size",
         "x_generator": {
            "engine": "bippy-9e1c9544281a"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2024-35905",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
