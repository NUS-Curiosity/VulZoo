From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-56766: mtd: rawnand: fix double free in atmel_pmecc_create_user()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

mtd: rawnand: fix double free in atmel_pmecc_create_user()

The "user" pointer was converted from being allocated with kzalloc() to
being allocated by devm_kzalloc().  Calling kfree(user) will lead to a
double free.

The Linux kernel CVE team has assigned CVE-2024-56766 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.4.287 with commit 22fbbc37edb840fd420fadf670366be9bf028426 and fixed in 5.4.289 with commit ca9818554b0f33e87f38e4bfa2dac056692d46cc
	Issue introduced in 5.10.231 with commit 54cb5fa850f9306d84e49a3db44b7a7eb5536cd1 and fixed in 5.10.233 with commit 1562871ef613fa9492aa0310933eff785166a90e
	Issue introduced in 5.15.174 with commit 5fe7709251e334cc27618473299c48340cecd3c8 and fixed in 5.15.176 with commit 3d825a241e65f7e3072978729e79d735ec40b80e
	Issue introduced in 6.1.120 with commit 24cbc37e837fd9e31e5024480b779207d1d99f1d and fixed in 6.1.123 with commit 6ea15205d7e2b811fbbdf79783f686f58abfb4b7
	Issue introduced in 6.6.64 with commit f1290871c8aaeb13029390a2b6e5c05733a1be6f and fixed in 6.6.69 with commit dd45c87782738715d5e7c167f8dabf0814a7394a
	Issue introduced in 6.12.2 with commit 8ac19ec818c548c5788da5926dcc8af96fad4bb1 and fixed in 6.12.8 with commit d2f090ea57f8d6587e09d4066f740a8617767b3d
	Issue introduced in 4.19.325 with commit 2014fcea19ec27df033359a0f42db0e8ed4290a8
	Issue introduced in 6.11.11 with commit bdd11a04d102f8310812aa7cec39545fdd6662d1

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-56766
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/mtd/nand/raw/atmel/pmecc.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/ca9818554b0f33e87f38e4bfa2dac056692d46cc
	https://git.kernel.org/stable/c/1562871ef613fa9492aa0310933eff785166a90e
	https://git.kernel.org/stable/c/3d825a241e65f7e3072978729e79d735ec40b80e
	https://git.kernel.org/stable/c/6ea15205d7e2b811fbbdf79783f686f58abfb4b7
	https://git.kernel.org/stable/c/dd45c87782738715d5e7c167f8dabf0814a7394a
	https://git.kernel.org/stable/c/d2f090ea57f8d6587e09d4066f740a8617767b3d
	https://git.kernel.org/stable/c/d8e4771f99c0400a1873235704b28bb803c83d17
