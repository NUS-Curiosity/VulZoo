From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-46716: dmaengine: altera-msgdma: properly free descriptor in msgdma_free_descriptor

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

dmaengine: altera-msgdma: properly free descriptor in msgdma_free_descriptor

Remove list_del call in msgdma_chan_desc_cleanup, this should be the role
of msgdma_free_descriptor. In consequence replace list_add_tail with
list_move_tail in msgdma_free_descriptor.

This fixes the path:
   msgdma_free_chan_resources -> msgdma_free_descriptors ->
   msgdma_free_desc_list -> msgdma_free_descriptor

which does not correctly free the descriptors as first nodes were not
removed from the list.

The Linux kernel CVE team has assigned CVE-2024-46716 to this issue.


Affected and fixed versions
===========================

	Fixed in 6.1.109 with commit a3480e59fdbe5585d2d1eff0bed7671583acf725
	Fixed in 6.6.50 with commit 20bf2920a869f9dbda0ef8c94c87d1901a64a716
	Fixed in 6.10.9 with commit db67686676c7becc1910bf1d6d51505876821863
	Fixed in 6.11 with commit 54e4ada1a4206f878e345ae01cf37347d803d1b1

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-46716
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/dma/altera-msgdma.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/a3480e59fdbe5585d2d1eff0bed7671583acf725
	https://git.kernel.org/stable/c/20bf2920a869f9dbda0ef8c94c87d1901a64a716
	https://git.kernel.org/stable/c/db67686676c7becc1910bf1d6d51505876821863
	https://git.kernel.org/stable/c/54e4ada1a4206f878e345ae01cf37347d803d1b1
