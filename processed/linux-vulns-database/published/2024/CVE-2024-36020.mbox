From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-36020: i40e: fix vf may be used uninitialized in this function warning

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

i40e: fix vf may be used uninitialized in this function warning

To fix the regression introduced by commit 52424f974bc5, which causes
servers hang in very hard to reproduce conditions with resets races.
Using two sources for the information is the root cause.
In this function before the fix bumping v didn't mean bumping vf
pointer. But the code used this variables interchangeably, so stale vf
could point to different/not intended vf.

Remove redundant "v" variable and iterate via single VF pointer across
whole function instead to guarantee VF pointer validity.

The Linux kernel CVE team has assigned CVE-2024-36020 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.19.264 with commit 76ed715836c6994bac29d9638e9314e6e3b08651 and fixed in 4.19.312 with commit cc9cd02dd9e8b7764ea9effb24f4f1dd73d1b23d
	Issue introduced in 5.4.223 with commit e88c2a1e28c5475065563d66c07ca879a9afbd07 and fixed in 5.4.274 with commit 9dcf0fcb80f6aeb01469e3c957f8d4c97365450a
	Issue introduced in 5.10.153 with commit 9abae363af5ced6adbf04c14366289540281fb26 and fixed in 5.10.215 with commit b8e82128b44fa40bf99a50b919488ef361e1683c
	Issue introduced in 5.15.77 with commit c39de3ae5075ea5f78e097cb5720d4e52d5caed9 and fixed in 5.15.154 with commit 951d2748a2a8242853abc3d0c153ce4bf8faad31
	Issue introduced in 6.1 with commit 52424f974bc53c26ba3f00300a00e9de9afcd972 and fixed in 6.1.85 with commit 3e89846283f3cf7c7a8e28b342576fd7c561d2ba
	Issue introduced in 6.1 with commit 52424f974bc53c26ba3f00300a00e9de9afcd972 and fixed in 6.6.26 with commit 0dcf573f997732702917af1563aa2493dc772fc0
	Issue introduced in 6.1 with commit 52424f974bc53c26ba3f00300a00e9de9afcd972 and fixed in 6.8.5 with commit 06df7618f591b2dc43c59967e294d7b9fc8675b6
	Issue introduced in 6.1 with commit 52424f974bc53c26ba3f00300a00e9de9afcd972 and fixed in 6.9 with commit f37c4eac99c258111d414d31b740437e1925b8e8
	Issue introduced in 6.0.7 with commit 02f949747e6fb767b29f7931d4bbf40911684e7a

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-36020
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/ethernet/intel/i40e/i40e_virtchnl_pf.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/cc9cd02dd9e8b7764ea9effb24f4f1dd73d1b23d
	https://git.kernel.org/stable/c/9dcf0fcb80f6aeb01469e3c957f8d4c97365450a
	https://git.kernel.org/stable/c/b8e82128b44fa40bf99a50b919488ef361e1683c
	https://git.kernel.org/stable/c/951d2748a2a8242853abc3d0c153ce4bf8faad31
	https://git.kernel.org/stable/c/3e89846283f3cf7c7a8e28b342576fd7c561d2ba
	https://git.kernel.org/stable/c/0dcf573f997732702917af1563aa2493dc772fc0
	https://git.kernel.org/stable/c/06df7618f591b2dc43c59967e294d7b9fc8675b6
	https://git.kernel.org/stable/c/f37c4eac99c258111d414d31b740437e1925b8e8
