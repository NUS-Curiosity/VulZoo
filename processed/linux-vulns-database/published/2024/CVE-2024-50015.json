{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\next4: dax: fix overflowing extents beyond inode size when partially writing\n\nThe dax_iomap_rw() does two things in each iteration: map written blocks\nand copy user data to blocks. If the process is killed by user(See signal\nhandling in dax_iomap_iter()), the copied data will be returned and added\non inode size, which means that the length of written extents may exceed\nthe inode size, then fsck will fail. An example is given as:\n\ndd if=/dev/urandom of=file bs=4M count=1\n dax_iomap_rw\n  iomap_iter // round 1\n   ext4_iomap_begin\n    ext4_iomap_alloc // allocate 0~2M extents(written flag)\n  dax_iomap_iter // copy 2M data\n  iomap_iter // round 2\n   iomap_iter_advance\n    iter->pos += iter->processed // iter->pos = 2M\n   ext4_iomap_begin\n    ext4_iomap_alloc // allocate 2~4M extents(written flag)\n  dax_iomap_iter\n   fatal_signal_pending\n  done = iter->pos - iocb->ki_pos // done = 2M\n ext4_handle_inode_extension\n  ext4_update_inode_size // inode size = 2M\n\nfsck reports: Inode 13, i_size is 2097152, should be 4194304.  Fix?\n\nFix the problem by truncating extents if the written length is smaller\nthan expected."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "fs/ext4/file.c"
               ],
               "versions": [
                  {
                     "version": "776722e85d3b0936253ecc3d14db4fba37f191ba",
                     "lessThan": "f8a7c342326f6ad1dfdb30a18dd013c70f5e9669",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "776722e85d3b0936253ecc3d14db4fba37f191ba",
                     "lessThan": "8c30a9a8610c314554997f86370140746aa35661",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "776722e85d3b0936253ecc3d14db4fba37f191ba",
                     "lessThan": "abfaa876b948baaea4d14f21a1963789845c8b4c",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "776722e85d3b0936253ecc3d14db4fba37f191ba",
                     "lessThan": "5efccdee4a7d507a483f20f880b809cc4eaef14d",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "776722e85d3b0936253ecc3d14db4fba37f191ba",
                     "lessThan": "a9f331f51515bdb3ebc8d0963131af367ef468f6",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "776722e85d3b0936253ecc3d14db4fba37f191ba",
                     "lessThan": "ec0dd451e236c46e4858d53e9e82bae7797a7af5",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "776722e85d3b0936253ecc3d14db4fba37f191ba",
                     "lessThan": "dda898d7ffe85931f9cca6d702a51f33717c501e",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "fs/ext4/file.c"
               ],
               "versions": [
                  {
                     "version": "4.10",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "4.10",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.10.227",
                     "lessThanOrEqual": "5.10.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.15.168",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.113",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.6.55",
                     "lessThanOrEqual": "6.6.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.10.14",
                     "lessThanOrEqual": "6.10.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.11.3",
                     "lessThanOrEqual": "6.11.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.12",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/f8a7c342326f6ad1dfdb30a18dd013c70f5e9669"
            },
            {
               "url": "https://git.kernel.org/stable/c/8c30a9a8610c314554997f86370140746aa35661"
            },
            {
               "url": "https://git.kernel.org/stable/c/abfaa876b948baaea4d14f21a1963789845c8b4c"
            },
            {
               "url": "https://git.kernel.org/stable/c/5efccdee4a7d507a483f20f880b809cc4eaef14d"
            },
            {
               "url": "https://git.kernel.org/stable/c/a9f331f51515bdb3ebc8d0963131af367ef468f6"
            },
            {
               "url": "https://git.kernel.org/stable/c/ec0dd451e236c46e4858d53e9e82bae7797a7af5"
            },
            {
               "url": "https://git.kernel.org/stable/c/dda898d7ffe85931f9cca6d702a51f33717c501e"
            }
         ],
         "title": "ext4: dax: fix overflowing extents beyond inode size when partially writing",
         "x_generator": {
            "engine": "bippy-5f407fcff5a0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2024-50015",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
