From bippy-d175d3acf727 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2021-47348: drm/amd/display: Avoid HDCP over-read and corruption

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

drm/amd/display: Avoid HDCP over-read and corruption

Instead of reading the desired 5 bytes of the actual target field,
the code was reading 8. This could result in a corrupted value if the
trailing 3 bytes were non-zero, so instead use an appropriately sized
and zero-initialized bounce buffer, and read only 5 bytes before casting
to u64.

The Linux kernel CVE team has assigned CVE-2021-47348 to this issue.


Affected and fixed versions
===========================

	Fixed in 5.10.51 with commit c5b518f4b98d
	Fixed in 5.12.18 with commit 44c7c901cb36
	Fixed in 5.13.3 with commit 3b2b93a485fb
	Fixed in 5.14 with commit 06888d571b51

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2021-47348
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/gpu/drm/amd/display/modules/hdcp/hdcp1_execution.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/c5b518f4b98dbb2bc31b6a55e6aaa1e0e2948f2e
	https://git.kernel.org/stable/c/44c7c901cb368a9f2493748f213b247b5872639f
	https://git.kernel.org/stable/c/3b2b93a485fb7a970bc8b5daef16f4cf579d172f
	https://git.kernel.org/stable/c/06888d571b513cbfc0b41949948def6cb81021b2
