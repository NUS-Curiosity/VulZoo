From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2021-47443: NFC: digital: fix possible memory leak in digital_tg_listen_mdaa()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

NFC: digital: fix possible memory leak in digital_tg_listen_mdaa()

'params' is allocated in digital_tg_listen_mdaa(), but not free when
digital_send_cmd() failed, which will cause memory leak. Fix it by
freeing 'params' if digital_send_cmd() return failed.

The Linux kernel CVE team has assigned CVE-2021-47443 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.13 with commit 1c7a4c24fbfd99442cc6e14dc80fcb00f118e8b8 and fixed in 4.4.290 with commit 429054ec51e648d241a7e0b465cf44f6633334c5
	Issue introduced in 3.13 with commit 1c7a4c24fbfd99442cc6e14dc80fcb00f118e8b8 and fixed in 4.9.288 with commit a67d47e32c91e2b10402cb8c081774cbf08edb2e
	Issue introduced in 3.13 with commit 1c7a4c24fbfd99442cc6e14dc80fcb00f118e8b8 and fixed in 4.14.252 with commit b7b023e6ff567e991c31cd425b0e1d16779c938b
	Issue introduced in 3.13 with commit 1c7a4c24fbfd99442cc6e14dc80fcb00f118e8b8 and fixed in 4.19.213 with commit 9881b0c860649f27ef2565deef011e516390f416
	Issue introduced in 3.13 with commit 1c7a4c24fbfd99442cc6e14dc80fcb00f118e8b8 and fixed in 5.4.155 with commit 7ab488d7228a9dceb2456867f1f0919decf6efed
	Issue introduced in 3.13 with commit 1c7a4c24fbfd99442cc6e14dc80fcb00f118e8b8 and fixed in 5.10.75 with commit 3f2960b39f22e26cf8addae93c3f5884d1c183c9
	Issue introduced in 3.13 with commit 1c7a4c24fbfd99442cc6e14dc80fcb00f118e8b8 and fixed in 5.14.14 with commit 564249219e5b5673a8416b5181875d828c3f1e8c
	Issue introduced in 3.13 with commit 1c7a4c24fbfd99442cc6e14dc80fcb00f118e8b8 and fixed in 5.15 with commit 58e7dcc9ca29c14e44267a4d0ea61e3229124907

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2021-47443
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/nfc/digital_core.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/429054ec51e648d241a7e0b465cf44f6633334c5
	https://git.kernel.org/stable/c/a67d47e32c91e2b10402cb8c081774cbf08edb2e
	https://git.kernel.org/stable/c/b7b023e6ff567e991c31cd425b0e1d16779c938b
	https://git.kernel.org/stable/c/9881b0c860649f27ef2565deef011e516390f416
	https://git.kernel.org/stable/c/7ab488d7228a9dceb2456867f1f0919decf6efed
	https://git.kernel.org/stable/c/3f2960b39f22e26cf8addae93c3f5884d1c183c9
	https://git.kernel.org/stable/c/564249219e5b5673a8416b5181875d828c3f1e8c
	https://git.kernel.org/stable/c/58e7dcc9ca29c14e44267a4d0ea61e3229124907
