{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ncomedi: dt9812: fix DMA buffers on stack\n\nUSB transfer buffers are typically mapped for DMA and must not be\nallocated on the stack or transfers will fail.\n\nAllocate proper transfer buffers in the various command helpers and\nreturn an error on short transfers instead of acting on random stack\ndata.\n\nNote that this also fixes a stack info leak on systems where DMA is not\nused as 32 bytes are always sent to the device regardless of how short\nthe command is."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/comedi/drivers/dt9812.c"
               ],
               "versions": [
                  {
                     "version": "63274cd7d38a3322d90b66a5bc976de1fb899051",
                     "lessThan": "a6af69768d5cb4b2528946d53be5fa19ade37723",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "63274cd7d38a3322d90b66a5bc976de1fb899051",
                     "lessThan": "365a346cda82f51d835c49136a00a9df8a78c7f2",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "63274cd7d38a3322d90b66a5bc976de1fb899051",
                     "lessThan": "8a52bc480992c7c9da3ebfea456af731f50a4b97",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "63274cd7d38a3322d90b66a5bc976de1fb899051",
                     "lessThan": "39ea61037ae78f14fa121228dd962ea3280eacf3",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "63274cd7d38a3322d90b66a5bc976de1fb899051",
                     "lessThan": "3efb7af8ac437085b6c776e5b54830b149d86efe",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "63274cd7d38a3322d90b66a5bc976de1fb899051",
                     "lessThan": "786f5b03450454557ff858a8bead5d7c0cbf78d6",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "63274cd7d38a3322d90b66a5bc976de1fb899051",
                     "lessThan": "3ac273d154d634e2034508a14db82a95d7ad12ed",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "63274cd7d38a3322d90b66a5bc976de1fb899051",
                     "lessThan": "20cebb8b620dc987e55ddc46801de986e081757e",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "63274cd7d38a3322d90b66a5bc976de1fb899051",
                     "lessThan": "536de747bc48262225889a533db6650731ab25d3",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/comedi/drivers/dt9812.c"
               ],
               "versions": [
                  {
                     "version": "2.6.29",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "2.6.29",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "4.4.292",
                     "lessThanOrEqual": "4.4.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "4.9.290",
                     "lessThanOrEqual": "4.9.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "4.14.255",
                     "lessThanOrEqual": "4.14.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "4.19.217",
                     "lessThanOrEqual": "4.19.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.4.159",
                     "lessThanOrEqual": "5.4.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.10.79",
                     "lessThanOrEqual": "5.10.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.14.18",
                     "lessThanOrEqual": "5.14.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.15.2",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.16",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/a6af69768d5cb4b2528946d53be5fa19ade37723"
            },
            {
               "url": "https://git.kernel.org/stable/c/365a346cda82f51d835c49136a00a9df8a78c7f2"
            },
            {
               "url": "https://git.kernel.org/stable/c/8a52bc480992c7c9da3ebfea456af731f50a4b97"
            },
            {
               "url": "https://git.kernel.org/stable/c/39ea61037ae78f14fa121228dd962ea3280eacf3"
            },
            {
               "url": "https://git.kernel.org/stable/c/3efb7af8ac437085b6c776e5b54830b149d86efe"
            },
            {
               "url": "https://git.kernel.org/stable/c/786f5b03450454557ff858a8bead5d7c0cbf78d6"
            },
            {
               "url": "https://git.kernel.org/stable/c/3ac273d154d634e2034508a14db82a95d7ad12ed"
            },
            {
               "url": "https://git.kernel.org/stable/c/20cebb8b620dc987e55ddc46801de986e081757e"
            },
            {
               "url": "https://git.kernel.org/stable/c/536de747bc48262225889a533db6650731ab25d3"
            }
         ],
         "title": "comedi: dt9812: fix DMA buffers on stack",
         "x_generator": {
            "engine": "bippy-5f407fcff5a0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2021-47477",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
