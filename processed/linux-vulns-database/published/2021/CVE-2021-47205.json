{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nclk: sunxi-ng: Unregister clocks/resets when unbinding\n\nCurrently, unbinding a CCU driver unmaps the device's MMIO region, while\nleaving its clocks/resets and their providers registered. This can cause\na page fault later when some clock operation tries to perform MMIO. Fix\nthis by separating the CCU initialization from the memory allocation,\nand then using a devres callback to unregister the clocks and resets.\n\nThis also fixes a memory leak of the `struct ccu_reset`, and uses the\ncorrect owner (the specific platform driver) for the clocks and resets.\n\nEarly OF clock providers are never unregistered, and limited error\nhandling is possible, so they are mostly unchanged. The error reporting\nis made more consistent by moving the message inside of_sunxi_ccu_probe."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/clk/sunxi-ng/ccu-sun4i-a10.c",
                  "drivers/clk/sunxi-ng/ccu-sun50i-a100-r.c",
                  "drivers/clk/sunxi-ng/ccu-sun50i-a100.c",
                  "drivers/clk/sunxi-ng/ccu-sun50i-a64.c",
                  "drivers/clk/sunxi-ng/ccu-sun50i-h6-r.c",
                  "drivers/clk/sunxi-ng/ccu-sun50i-h6.c",
                  "drivers/clk/sunxi-ng/ccu-sun50i-h616.c",
                  "drivers/clk/sunxi-ng/ccu-sun5i.c",
                  "drivers/clk/sunxi-ng/ccu-sun6i-a31.c",
                  "drivers/clk/sunxi-ng/ccu-sun8i-a23.c",
                  "drivers/clk/sunxi-ng/ccu-sun8i-a33.c",
                  "drivers/clk/sunxi-ng/ccu-sun8i-a83t.c",
                  "drivers/clk/sunxi-ng/ccu-sun8i-de2.c",
                  "drivers/clk/sunxi-ng/ccu-sun8i-h3.c",
                  "drivers/clk/sunxi-ng/ccu-sun8i-r.c",
                  "drivers/clk/sunxi-ng/ccu-sun8i-r40.c",
                  "drivers/clk/sunxi-ng/ccu-sun8i-v3s.c",
                  "drivers/clk/sunxi-ng/ccu-sun9i-a80-de.c",
                  "drivers/clk/sunxi-ng/ccu-sun9i-a80-usb.c",
                  "drivers/clk/sunxi-ng/ccu-sun9i-a80.c",
                  "drivers/clk/sunxi-ng/ccu-suniv-f1c100s.c",
                  "drivers/clk/sunxi-ng/ccu_common.c",
                  "drivers/clk/sunxi-ng/ccu_common.h"
               ],
               "versions": [
                  {
                     "version": "1da177e4c3f4",
                     "lessThan": "b5dd513daa70",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "1da177e4c3f4",
                     "lessThan": "9bec2b9c6134",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/clk/sunxi-ng/ccu-sun4i-a10.c",
                  "drivers/clk/sunxi-ng/ccu-sun50i-a100-r.c",
                  "drivers/clk/sunxi-ng/ccu-sun50i-a100.c",
                  "drivers/clk/sunxi-ng/ccu-sun50i-a64.c",
                  "drivers/clk/sunxi-ng/ccu-sun50i-h6-r.c",
                  "drivers/clk/sunxi-ng/ccu-sun50i-h6.c",
                  "drivers/clk/sunxi-ng/ccu-sun50i-h616.c",
                  "drivers/clk/sunxi-ng/ccu-sun5i.c",
                  "drivers/clk/sunxi-ng/ccu-sun6i-a31.c",
                  "drivers/clk/sunxi-ng/ccu-sun8i-a23.c",
                  "drivers/clk/sunxi-ng/ccu-sun8i-a33.c",
                  "drivers/clk/sunxi-ng/ccu-sun8i-a83t.c",
                  "drivers/clk/sunxi-ng/ccu-sun8i-de2.c",
                  "drivers/clk/sunxi-ng/ccu-sun8i-h3.c",
                  "drivers/clk/sunxi-ng/ccu-sun8i-r.c",
                  "drivers/clk/sunxi-ng/ccu-sun8i-r40.c",
                  "drivers/clk/sunxi-ng/ccu-sun8i-v3s.c",
                  "drivers/clk/sunxi-ng/ccu-sun9i-a80-de.c",
                  "drivers/clk/sunxi-ng/ccu-sun9i-a80-usb.c",
                  "drivers/clk/sunxi-ng/ccu-sun9i-a80.c",
                  "drivers/clk/sunxi-ng/ccu-suniv-f1c100s.c",
                  "drivers/clk/sunxi-ng/ccu_common.c",
                  "drivers/clk/sunxi-ng/ccu_common.h"
               ],
               "versions": [
                  {
                     "version": "5.15.5",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "custom"
                  },
                  {
                     "version": "5.16",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/b5dd513daa70ee8f6d281a20bd28485ee9bb7db2"
            },
            {
               "url": "https://git.kernel.org/stable/c/9bec2b9c6134052994115d2d3374e96f2ccb9b9d"
            }
         ],
         "title": "clk: sunxi-ng: Unregister clocks/resets when unbinding",
         "x_generator": {
            "engine": "bippy-a5840b7849dd"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2021-47205",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
