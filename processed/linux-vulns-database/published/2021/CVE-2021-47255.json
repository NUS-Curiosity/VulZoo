{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nkvm: LAPIC: Restore guard to prevent illegal APIC register access\n\nPer the SDM, \"any access that touches bytes 4 through 15 of an APIC\nregister may cause undefined behavior and must not be executed.\"\nWorse, such an access in kvm_lapic_reg_read can result in a leak of\nkernel stack contents. Prior to commit 01402cf81051 (\"kvm: LAPIC:\nwrite down valid APIC registers\"), such an access was explicitly\ndisallowed. Restore the guard that was removed in that commit."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "arch/x86/kvm/lapic.c"
               ],
               "versions": [
                  {
                     "version": "01402cf81051f796dac7c60ca11d6147153ca46a",
                     "lessThan": "bf99ea52970caeb4583bdba1192c1f9b53b12c84",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "01402cf81051f796dac7c60ca11d6147153ca46a",
                     "lessThan": "018685461a5b9a9a70e664ac77aef0d7415a3fd5",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "01402cf81051f796dac7c60ca11d6147153ca46a",
                     "lessThan": "a2aff09807fbe4018c269d3773a629949058b210",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "01402cf81051f796dac7c60ca11d6147153ca46a",
                     "lessThan": "218bf772bddd221489c38dde6ef8e917131161f6",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "arch/x86/kvm/lapic.c"
               ],
               "versions": [
                  {
                     "version": "5.3",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "5.3",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.4.128",
                     "lessThanOrEqual": "5.4.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.10.46",
                     "lessThanOrEqual": "5.10.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.12.13",
                     "lessThanOrEqual": "5.12.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.13",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/bf99ea52970caeb4583bdba1192c1f9b53b12c84"
            },
            {
               "url": "https://git.kernel.org/stable/c/018685461a5b9a9a70e664ac77aef0d7415a3fd5"
            },
            {
               "url": "https://git.kernel.org/stable/c/a2aff09807fbe4018c269d3773a629949058b210"
            },
            {
               "url": "https://git.kernel.org/stable/c/218bf772bddd221489c38dde6ef8e917131161f6"
            }
         ],
         "title": "kvm: LAPIC: Restore guard to prevent illegal APIC register access",
         "x_generator": {
            "engine": "bippy-5f407fcff5a0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2021-47255",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
