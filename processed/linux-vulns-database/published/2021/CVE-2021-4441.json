{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nspi: spi-zynq-qspi: Fix a NULL pointer dereference in zynq_qspi_exec_mem_op()\n\nIn zynq_qspi_exec_mem_op(), kzalloc() is directly used in memset(),\nwhich could lead to a NULL pointer dereference on failure of\nkzalloc().\n\nFix this bug by adding a check of tmpbuf.\n\nThis bug was found by a static analyzer. The analysis employs\ndifferential checking to identify inconsistent security operations\n(e.g., checks or kfrees) between two code paths and confirms that the\ninconsistent operations are not recovered in the current function or\nthe callers, so they constitute bugs.\n\nNote that, as a bug found by static analysis, it can be a false\npositive or hard to trigger. Multiple researchers have cross-reviewed\nthe bug.\n\nBuilds with CONFIG_SPI_ZYNQ_QSPI=m show no new warnings,\nand our static analyzer no longer warns about this code."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/spi/spi-zynq-qspi.c"
               ],
               "versions": [
                  {
                     "version": "67dca5e580f1e93a66177389981541cac208c817",
                     "lessThan": "df14d2bed8e2455878e046e67123d9ecb2e79056",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "67dca5e580f1e93a66177389981541cac208c817",
                     "lessThan": "2efece1368aeee2d2552c7ec36aeb676c4d4c95f",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "67dca5e580f1e93a66177389981541cac208c817",
                     "lessThan": "3c32405d6474a21f7d742828e73c13e326dcae82",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "67dca5e580f1e93a66177389981541cac208c817",
                     "lessThan": "b9dd08cbebe0c593c49bf86d2012a431494e54cb",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "67dca5e580f1e93a66177389981541cac208c817",
                     "lessThan": "ab3824427b848da10e9fe2727f035bbeecae6ff4",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/spi/spi-zynq-qspi.c"
               ],
               "versions": [
                  {
                     "version": "5.2",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "5.2",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.4.182",
                     "lessThanOrEqual": "5.4.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.10.103",
                     "lessThanOrEqual": "5.10.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.15.26",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.16.12",
                     "lessThanOrEqual": "5.16.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.17",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/df14d2bed8e2455878e046e67123d9ecb2e79056"
            },
            {
               "url": "https://git.kernel.org/stable/c/2efece1368aeee2d2552c7ec36aeb676c4d4c95f"
            },
            {
               "url": "https://git.kernel.org/stable/c/3c32405d6474a21f7d742828e73c13e326dcae82"
            },
            {
               "url": "https://git.kernel.org/stable/c/b9dd08cbebe0c593c49bf86d2012a431494e54cb"
            },
            {
               "url": "https://git.kernel.org/stable/c/ab3824427b848da10e9fe2727f035bbeecae6ff4"
            }
         ],
         "title": "spi: spi-zynq-qspi: Fix a NULL pointer dereference in zynq_qspi_exec_mem_op()",
         "x_generator": {
            "engine": "bippy-5f407fcff5a0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2021-4441",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
