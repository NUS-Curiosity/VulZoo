From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2021-47016: m68k: mvme147,mvme16x: Don't wipe PCC timer config bits

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

m68k: mvme147,mvme16x: Don't wipe PCC timer config bits

Don't clear the timer 1 configuration bits when clearing the interrupt flag
and counter overflow. As Michael reported, "This results in no timer
interrupts being delivered after the first. Initialization then hangs
in calibrate_delay as the jiffies counter is not updated."

On mvme16x, enable the timer after requesting the irq, consistent with
mvme147.

The Linux kernel CVE team has assigned CVE-2021-47016 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.2 with commit 7529b90d051e4629884771ba2b1d3a87d2c6a9d7 and fixed in 5.4.119 with commit f6a90818a32058fca62cda3a2027a6a2364e1878
	Issue introduced in 5.2 with commit 7529b90d051e4629884771ba2b1d3a87d2c6a9d7 and fixed in 5.10.37 with commit 1dfb26df15fc7036a74221d43de7427f74293dae
	Issue introduced in 5.2 with commit 7529b90d051e4629884771ba2b1d3a87d2c6a9d7 and fixed in 5.11.21 with commit 73fdeb612d25b5e105c219e05434285a45d23576
	Issue introduced in 5.2 with commit 7529b90d051e4629884771ba2b1d3a87d2c6a9d7 and fixed in 5.12.4 with commit 5d34225169346cab5145978d153b9ce90e9ace21
	Issue introduced in 5.2 with commit 7529b90d051e4629884771ba2b1d3a87d2c6a9d7 and fixed in 5.13 with commit 43262178c043032e7c42d00de44c818ba05f9967

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2021-47016
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	arch/m68k/include/asm/mvme147hw.h
	arch/m68k/mvme147/config.c
	arch/m68k/mvme16x/config.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/f6a90818a32058fca62cda3a2027a6a2364e1878
	https://git.kernel.org/stable/c/1dfb26df15fc7036a74221d43de7427f74293dae
	https://git.kernel.org/stable/c/73fdeb612d25b5e105c219e05434285a45d23576
	https://git.kernel.org/stable/c/5d34225169346cab5145978d153b9ce90e9ace21
	https://git.kernel.org/stable/c/43262178c043032e7c42d00de44c818ba05f9967
