From bippy-851b3ed3d212 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2021-47161: spi: spi-fsl-dspi: Fix a resource leak in an error handling path

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

spi: spi-fsl-dspi: Fix a resource leak in an error handling path

'dspi_request_dma()' should be undone by a 'dspi_release_dma()' call in the
error handling path of the probe function, as already done in the remove
function

The Linux kernel CVE team has assigned CVE-2021-47161 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.10 with commit 90ba37033cb9 and fixed in 4.14.241 with commit 10a089bae827
	Issue introduced in 4.10 with commit 90ba37033cb9 and fixed in 4.19.199 with commit 00450ed03a17
	Issue introduced in 4.10 with commit 90ba37033cb9 and fixed in 5.4.124 with commit 15d1cc4b4b58
	Issue introduced in 4.10 with commit 90ba37033cb9 and fixed in 5.10.42 with commit fe6921e3b845
	Issue introduced in 4.10 with commit 90ba37033cb9 and fixed in 5.12.9 with commit 12391be4724a
	Issue introduced in 4.10 with commit 90ba37033cb9 and fixed in 5.13 with commit 680ec0549a05

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2021-47161
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/spi/spi-fsl-dspi.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/10a089bae827ec30ad9b6cb7048020a62fae0cfa
	https://git.kernel.org/stable/c/00450ed03a17143e2433b461a656ef9cd17c2f1d
	https://git.kernel.org/stable/c/15d1cc4b4b585f9a2ce72c52cca004d5d735bdf1
	https://git.kernel.org/stable/c/fe6921e3b8451a537e01c031b8212366bb386e3e
	https://git.kernel.org/stable/c/12391be4724acc9269e1845ccbd881df37de4b56
	https://git.kernel.org/stable/c/680ec0549a055eb464dce6ffb4bfb736ef87236e
