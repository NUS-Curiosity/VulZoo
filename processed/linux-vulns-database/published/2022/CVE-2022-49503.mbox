From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-49503: ath9k_htc: fix potential out of bounds access with invalid rxstatus->rs_keyix

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

ath9k_htc: fix potential out of bounds access with invalid rxstatus->rs_keyix

The "rxstatus->rs_keyix" eventually gets passed to test_bit() so we need to
ensure that it is within the bitmap.

drivers/net/wireless/ath/ath9k/common.c:46 ath9k_cmn_rx_accept()
error: passing untrusted data 'rx_stats->rs_keyix' to 'test_bit()'

The Linux kernel CVE team has assigned CVE-2022-49503 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.15 with commit 4ed1a8d4a25711f780b96920fff2bb531229e322 and fixed in 4.9.318 with commit 0bcb528402cd5e1a6e1833e956fd58a12d509e8e
	Issue introduced in 3.15 with commit 4ed1a8d4a25711f780b96920fff2bb531229e322 and fixed in 4.14.283 with commit a048e0c3caa852397b7b50d4c82a0415c05f7ac3
	Issue introduced in 3.15 with commit 4ed1a8d4a25711f780b96920fff2bb531229e322 and fixed in 4.19.247 with commit 4bdcf32c965c27f55ccc4ee71c1927131115b0bb
	Issue introduced in 3.15 with commit 4ed1a8d4a25711f780b96920fff2bb531229e322 and fixed in 5.4.198 with commit 2326d398ccd41ba6d93b8346532dfa432ab00fee
	Issue introduced in 3.15 with commit 4ed1a8d4a25711f780b96920fff2bb531229e322 and fixed in 5.10.121 with commit 461e4c1f199076275f16bf6f3d3e42c6b6c79f33
	Issue introduced in 3.15 with commit 4ed1a8d4a25711f780b96920fff2bb531229e322 and fixed in 5.15.46 with commit 7f6defe0fabc79f29603c6fa3c80e4fe0456a3e9
	Issue introduced in 3.15 with commit 4ed1a8d4a25711f780b96920fff2bb531229e322 and fixed in 5.17.14 with commit eda518db7db16c360bc84379d90675650daa3048
	Issue introduced in 3.15 with commit 4ed1a8d4a25711f780b96920fff2bb531229e322 and fixed in 5.18.3 with commit 3dad3fed5672828c7fb0465cb66a3d9a70952fa6
	Issue introduced in 3.15 with commit 4ed1a8d4a25711f780b96920fff2bb531229e322 and fixed in 5.19 with commit 2dc509305cf956381532792cb8dceef2b1504765

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-49503
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/wireless/ath/ath9k/htc_drv_txrx.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/0bcb528402cd5e1a6e1833e956fd58a12d509e8e
	https://git.kernel.org/stable/c/a048e0c3caa852397b7b50d4c82a0415c05f7ac3
	https://git.kernel.org/stable/c/4bdcf32c965c27f55ccc4ee71c1927131115b0bb
	https://git.kernel.org/stable/c/2326d398ccd41ba6d93b8346532dfa432ab00fee
	https://git.kernel.org/stable/c/461e4c1f199076275f16bf6f3d3e42c6b6c79f33
	https://git.kernel.org/stable/c/7f6defe0fabc79f29603c6fa3c80e4fe0456a3e9
	https://git.kernel.org/stable/c/eda518db7db16c360bc84379d90675650daa3048
	https://git.kernel.org/stable/c/3dad3fed5672828c7fb0465cb66a3d9a70952fa6
	https://git.kernel.org/stable/c/2dc509305cf956381532792cb8dceef2b1504765
