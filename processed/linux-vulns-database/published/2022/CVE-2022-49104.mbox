From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-49104: staging: vchiq_core: handle NULL result of find_service_by_handle

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

staging: vchiq_core: handle NULL result of find_service_by_handle

In case of an invalid handle the function find_servive_by_handle
returns NULL. So take care of this and avoid a NULL pointer dereference.

The Linux kernel CVE team has assigned CVE-2022-49104 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.9 with commit 71bad7f086419dc674244b91ca35a12bfa4cb597 and fixed in 5.10.111 with commit aa0b7296785312a4bfa8fac0ba8ad78698fd9fcf
	Issue introduced in 4.9 with commit 71bad7f086419dc674244b91ca35a12bfa4cb597 and fixed in 5.15.34 with commit 42f2142a337ee372455574809fc924580a7e51b2
	Issue introduced in 4.9 with commit 71bad7f086419dc674244b91ca35a12bfa4cb597 and fixed in 5.16.20 with commit 04202f54dd8899e10f56a89c4c1ede0043fa22af
	Issue introduced in 4.9 with commit 71bad7f086419dc674244b91ca35a12bfa4cb597 and fixed in 5.17.3 with commit 3b424f6586a870b8d657c5e5419465bbe0e7b61f
	Issue introduced in 4.9 with commit 71bad7f086419dc674244b91ca35a12bfa4cb597 and fixed in 5.18 with commit ca225857faf237234d2fffe5d1919467dfadd822

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-49104
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/staging/vc04_services/interface/vchiq_arm/vchiq_core.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/aa0b7296785312a4bfa8fac0ba8ad78698fd9fcf
	https://git.kernel.org/stable/c/42f2142a337ee372455574809fc924580a7e51b2
	https://git.kernel.org/stable/c/04202f54dd8899e10f56a89c4c1ede0043fa22af
	https://git.kernel.org/stable/c/3b424f6586a870b8d657c5e5419465bbe0e7b61f
	https://git.kernel.org/stable/c/ca225857faf237234d2fffe5d1919467dfadd822
