From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-49074: irqchip/gic-v3: Fix GICR_CTLR.RWP polling

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

irqchip/gic-v3: Fix GICR_CTLR.RWP polling

It turns out that our polling of RWP is totally wrong when checking
for it in the redistributors, as we test the *distributor* bit index,
whereas it is a different bit number in the RDs... Oopsie boo.

This is embarassing. Not only because it is wrong, but also because
it took *8 years* to notice the blunder...

Just fix the damn thing.

The Linux kernel CVE team has assigned CVE-2022-49074 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.17 with commit 021f653791ad17e03f98aaa7fb933816ae16f161 and fixed in 4.19.238 with commit c7daf1b4ad809692d5c26f33c02ed8a031066548
	Issue introduced in 3.17 with commit 021f653791ad17e03f98aaa7fb933816ae16f161 and fixed in 5.4.189 with commit 3c07cc242baf83f0bddbbd9d7945d0bee56d8b57
	Issue introduced in 3.17 with commit 021f653791ad17e03f98aaa7fb933816ae16f161 and fixed in 5.10.111 with commit ff24114bb08d8b90edf2aff0a4fd0689523e6c17
	Issue introduced in 3.17 with commit 021f653791ad17e03f98aaa7fb933816ae16f161 and fixed in 5.15.34 with commit 7218a789abb3e033f5f3a85636ca50d9ae7b0fc9
	Issue introduced in 3.17 with commit 021f653791ad17e03f98aaa7fb933816ae16f161 and fixed in 5.16.20 with commit 60e1eb4811f53f5f60c788297d978515e7a2637a
	Issue introduced in 3.17 with commit 021f653791ad17e03f98aaa7fb933816ae16f161 and fixed in 5.17.3 with commit 6fef3e3179e6ed8fecdd004ede541674ffa7749d
	Issue introduced in 3.17 with commit 021f653791ad17e03f98aaa7fb933816ae16f161 and fixed in 5.18 with commit 0df6664531a12cdd8fc873f0cac0dcb40243d3e9

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-49074
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/irqchip/irq-gic-v3.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/c7daf1b4ad809692d5c26f33c02ed8a031066548
	https://git.kernel.org/stable/c/3c07cc242baf83f0bddbbd9d7945d0bee56d8b57
	https://git.kernel.org/stable/c/ff24114bb08d8b90edf2aff0a4fd0689523e6c17
	https://git.kernel.org/stable/c/7218a789abb3e033f5f3a85636ca50d9ae7b0fc9
	https://git.kernel.org/stable/c/60e1eb4811f53f5f60c788297d978515e7a2637a
	https://git.kernel.org/stable/c/6fef3e3179e6ed8fecdd004ede541674ffa7749d
	https://git.kernel.org/stable/c/0df6664531a12cdd8fc873f0cac0dcb40243d3e9
