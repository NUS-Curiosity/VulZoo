{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nvsock: remove vsock from connected table when connect is interrupted by a signal\n\nvsock_connect() expects that the socket could already be in the\nTCP_ESTABLISHED state when the connecting task wakes up with a signal\npending. If this happens the socket will be in the connected table, and\nit is not removed when the socket state is reset. In this situation it's\ncommon for the process to retry connect(), and if the connection is\nsuccessful the socket will be added to the connected table a second\ntime, corrupting the list.\n\nPrevent this by calling vsock_remove_connected() if a signal is received\nwhile waiting for a connection. This is harmless if the socket is not in\nthe connected table, and if it is in the table then removing it will\nprevent list corruption from a double add.\n\nNote for backporting: this patch requires d5afa82c977e (\"vsock: correct\nremoval of socket from the list\"), which is in all current stable trees\nexcept 4.9.y."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "net/vmw_vsock/af_vsock.c"
               ],
               "versions": [
                  {
                     "version": "d021c344051af91f42c5ba9fdedc176740cbd238",
                     "lessThan": "0bb88f3f7e8d506f3efe46d694964117e20efbfc",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "d021c344051af91f42c5ba9fdedc176740cbd238",
                     "lessThan": "e3b3939fd137aab6d00d54bee0ee9244b286a608",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "d021c344051af91f42c5ba9fdedc176740cbd238",
                     "lessThan": "2910bcb9f67551a45397735e47b6d456eb8cd549",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "d021c344051af91f42c5ba9fdedc176740cbd238",
                     "lessThan": "5f326fe2aef411a6575628f92bd861463ea91df7",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "d021c344051af91f42c5ba9fdedc176740cbd238",
                     "lessThan": "87cd1bbd6677411e17369cd4b7389ab1e1fdba44",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "d021c344051af91f42c5ba9fdedc176740cbd238",
                     "lessThan": "787468ee7a435777521d33399d012fd591ae2f94",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "d021c344051af91f42c5ba9fdedc176740cbd238",
                     "lessThan": "addd62a8cb6fa90aa322365c62487da61f6baab8",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "d021c344051af91f42c5ba9fdedc176740cbd238",
                     "lessThan": "b9208492fcaecff8f43915529ae34b3bcb03877c",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "net/vmw_vsock/af_vsock.c"
               ],
               "versions": [
                  {
                     "version": "3.9",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "3.9",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "4.9.303",
                     "lessThanOrEqual": "4.9.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "4.14.268",
                     "lessThanOrEqual": "4.14.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "4.19.231",
                     "lessThanOrEqual": "4.19.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.4.181",
                     "lessThanOrEqual": "5.4.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.10.102",
                     "lessThanOrEqual": "5.10.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.15.25",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.16.11",
                     "lessThanOrEqual": "5.16.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.17",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/0bb88f3f7e8d506f3efe46d694964117e20efbfc"
            },
            {
               "url": "https://git.kernel.org/stable/c/e3b3939fd137aab6d00d54bee0ee9244b286a608"
            },
            {
               "url": "https://git.kernel.org/stable/c/2910bcb9f67551a45397735e47b6d456eb8cd549"
            },
            {
               "url": "https://git.kernel.org/stable/c/5f326fe2aef411a6575628f92bd861463ea91df7"
            },
            {
               "url": "https://git.kernel.org/stable/c/87cd1bbd6677411e17369cd4b7389ab1e1fdba44"
            },
            {
               "url": "https://git.kernel.org/stable/c/787468ee7a435777521d33399d012fd591ae2f94"
            },
            {
               "url": "https://git.kernel.org/stable/c/addd62a8cb6fa90aa322365c62487da61f6baab8"
            },
            {
               "url": "https://git.kernel.org/stable/c/b9208492fcaecff8f43915529ae34b3bcb03877c"
            }
         ],
         "title": "vsock: remove vsock from connected table when connect is interrupted by a signal",
         "x_generator": {
            "engine": "bippy-5f407fcff5a0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2022-48786",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
