From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-49527: media: venus: hfi: avoid null dereference in deinit

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

media: venus: hfi: avoid null dereference in deinit

If venus_probe fails at pm_runtime_put_sync the error handling first
calls hfi_destroy and afterwards hfi_core_deinit. As hfi_destroy sets
core->ops to NULL, hfi_core_deinit cannot call the core_deinit function
anymore.

Avoid this null pointer derefence by skipping the call when necessary.

The Linux kernel CVE team has assigned CVE-2022-49527 to this issue.


Affected and fixed versions
===========================

	Fixed in 4.14.283 with commit 2533acb652359c9e097dfa33587896af782e8a91
	Fixed in 4.19.247 with commit a21d15dde21d7e8ae047eb8368677407db45d840
	Fixed in 5.4.198 with commit 0ac84ab50712879eac3c1dd2598440652a85d3d0
	Fixed in 5.10.121 with commit 27ad46da44177a78a4a0cae6fe03906888c61aa1
	Fixed in 5.15.46 with commit 9c385b961d4c378228e80f6abea8509cb67feab6
	Fixed in 5.17.14 with commit 0ed5a643b1a4a46b9b7bfba5d468c10cc30e1359
	Fixed in 5.18.3 with commit b73ed0510bb8d9647cd8e8a4c4c8772bbe545c3a
	Fixed in 5.19 with commit 86594f6af867b5165d2ba7b5a71fae3a5961e56c

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-49527
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/media/platform/qcom/venus/hfi.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/2533acb652359c9e097dfa33587896af782e8a91
	https://git.kernel.org/stable/c/a21d15dde21d7e8ae047eb8368677407db45d840
	https://git.kernel.org/stable/c/0ac84ab50712879eac3c1dd2598440652a85d3d0
	https://git.kernel.org/stable/c/27ad46da44177a78a4a0cae6fe03906888c61aa1
	https://git.kernel.org/stable/c/9c385b961d4c378228e80f6abea8509cb67feab6
	https://git.kernel.org/stable/c/0ed5a643b1a4a46b9b7bfba5d468c10cc30e1359
	https://git.kernel.org/stable/c/b73ed0510bb8d9647cd8e8a4c4c8772bbe545c3a
	https://git.kernel.org/stable/c/86594f6af867b5165d2ba7b5a71fae3a5961e56c
