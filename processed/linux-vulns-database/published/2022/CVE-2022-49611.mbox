From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-49611: x86/speculation: Fill RSB on vmexit for IBRS

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

x86/speculation: Fill RSB on vmexit for IBRS

Prevent RSB underflow/poisoning attacks with RSB.  While at it, add a
bunch of comments to attempt to document the current state of tribal
knowledge about RSB attacks and what exactly is being mitigated.

The Linux kernel CVE team has assigned CVE-2022-49611 to this issue.


Affected and fixed versions
===========================

	Fixed in 4.14.297 with commit 3d323b99ff5c8c57005184056d65f6af5b0479d8
	Fixed in 4.19.266 with commit f744b88dfc201bf8092833ec70b23c720188b527
	Fixed in 5.4.217 with commit 17a9fc4a7b91f8599223631bb6ae6416bc0de1c0
	Fixed in 5.10.133 with commit 4d7f72b6e1bc630bec7e4cd51814bc2b092bf153
	Fixed in 5.15.57 with commit 8d5cff499a6d740c91ff37963907e0e983c37f0f
	Fixed in 5.18.14 with commit 8c38306e2e9257af4af2819aa287a4711ff36329
	Fixed in 5.19 with commit 9756bba28470722dacb79ffce554336dd1f6a6cd

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-49611
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	arch/x86/include/asm/cpufeatures.h
	arch/x86/kernel/cpu/bugs.c
	arch/x86/kvm/vmx/vmenter.S


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/3d323b99ff5c8c57005184056d65f6af5b0479d8
	https://git.kernel.org/stable/c/f744b88dfc201bf8092833ec70b23c720188b527
	https://git.kernel.org/stable/c/17a9fc4a7b91f8599223631bb6ae6416bc0de1c0
	https://git.kernel.org/stable/c/4d7f72b6e1bc630bec7e4cd51814bc2b092bf153
	https://git.kernel.org/stable/c/8d5cff499a6d740c91ff37963907e0e983c37f0f
	https://git.kernel.org/stable/c/8c38306e2e9257af4af2819aa287a4711ff36329
	https://git.kernel.org/stable/c/9756bba28470722dacb79ffce554336dd1f6a6cd
