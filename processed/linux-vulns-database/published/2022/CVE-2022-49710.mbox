From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-49710: dm mirror log: round up region bitmap size to BITS_PER_LONG

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

dm mirror log: round up region bitmap size to BITS_PER_LONG

The code in dm-log rounds up bitset_size to 32 bits. It then uses
find_next_zero_bit_le on the allocated region. find_next_zero_bit_le
accesses the bitmap using unsigned long pointers. So, on 64-bit
architectures, it may access 4 bytes beyond the allocated size.

Fix this bug by rounding up bitset_size to BITS_PER_LONG.

This bug was found by running the lvm2 testsuite with kasan.

The Linux kernel CVE team has assigned CVE-2022-49710 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 2.6.18 with commit 29121bd0b00ebb9524971a583fea4a2f7afe8041 and fixed in 5.4.200 with commit ae460312875159285cef5bf3dc654593f404a1ef
	Issue introduced in 2.6.18 with commit 29121bd0b00ebb9524971a583fea4a2f7afe8041 and fixed in 5.10.124 with commit ba751f0d25f07aa21ce9b85372a3792bf7969d13
	Issue introduced in 2.6.18 with commit 29121bd0b00ebb9524971a583fea4a2f7afe8041 and fixed in 5.15.49 with commit 0d2209b54f1de0c2f99cab246d4cf2cfe24aaaa9
	Issue introduced in 2.6.18 with commit 29121bd0b00ebb9524971a583fea4a2f7afe8041 and fixed in 5.18.6 with commit 9a02f3275acc628c0d956be771405ced79ac36df
	Issue introduced in 2.6.18 with commit 29121bd0b00ebb9524971a583fea4a2f7afe8041 and fixed in 5.19 with commit 85e123c27d5cbc22cfdc01de1e2ca1d9003a02d0

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-49710
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/md/dm-log.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/ae460312875159285cef5bf3dc654593f404a1ef
	https://git.kernel.org/stable/c/ba751f0d25f07aa21ce9b85372a3792bf7969d13
	https://git.kernel.org/stable/c/0d2209b54f1de0c2f99cab246d4cf2cfe24aaaa9
	https://git.kernel.org/stable/c/9a02f3275acc628c0d956be771405ced79ac36df
	https://git.kernel.org/stable/c/85e123c27d5cbc22cfdc01de1e2ca1d9003a02d0
