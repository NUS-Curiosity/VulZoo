From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-49494: mtd: rawnand: cadence: fix possible null-ptr-deref in cadence_nand_dt_probe()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

mtd: rawnand: cadence: fix possible null-ptr-deref in cadence_nand_dt_probe()

It will cause null-ptr-deref when using 'res', if platform_get_resource()
returns NULL, so move using 'res' after devm_ioremap_resource() that
will check it to avoid null-ptr-deref.
And use devm_platform_get_and_ioremap_resource() to simplify code.

The Linux kernel CVE team has assigned CVE-2022-49494 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.5 with commit ec4ba01e894d3165e4d1ccbef782ef5593b708b4 and fixed in 5.10.121 with commit 81f1ddffdc22ca5789e33b9d4712914e302090c1
	Issue introduced in 5.5 with commit ec4ba01e894d3165e4d1ccbef782ef5593b708b4 and fixed in 5.15.46 with commit 0cfee868b89ffa945f3d535ee5c985cb40c5a0f8
	Issue introduced in 5.5 with commit ec4ba01e894d3165e4d1ccbef782ef5593b708b4 and fixed in 5.17.14 with commit 069af5e27c1b0f7677ef76d8d3102e503ca4f80b
	Issue introduced in 5.5 with commit ec4ba01e894d3165e4d1ccbef782ef5593b708b4 and fixed in 5.18.3 with commit 13b60d3dc84b47307669edb66b633b18466014b4
	Issue introduced in 5.5 with commit ec4ba01e894d3165e4d1ccbef782ef5593b708b4 and fixed in 5.19 with commit a28ed09dafee20da51eb26452950839633afd824

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-49494
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/mtd/nand/raw/cadence-nand-controller.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/81f1ddffdc22ca5789e33b9d4712914e302090c1
	https://git.kernel.org/stable/c/0cfee868b89ffa945f3d535ee5c985cb40c5a0f8
	https://git.kernel.org/stable/c/069af5e27c1b0f7677ef76d8d3102e503ca4f80b
	https://git.kernel.org/stable/c/13b60d3dc84b47307669edb66b633b18466014b4
	https://git.kernel.org/stable/c/a28ed09dafee20da51eb26452950839633afd824
