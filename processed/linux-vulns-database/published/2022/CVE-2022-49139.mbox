From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-49139: Bluetooth: fix null ptr deref on hci_sync_conn_complete_evt

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

Bluetooth: fix null ptr deref on hci_sync_conn_complete_evt

This event is just specified for SCO and eSCO link types.
On the reception of a HCI_Synchronous_Connection_Complete for a BDADDR
of an existing LE connection, LE link type and a status that triggers the
second case of the packet processing a NULL pointer dereference happens,
as conn->link is NULL.

The Linux kernel CVE team has assigned CVE-2022-49139 to this issue.


Affected and fixed versions
===========================

	Fixed in 5.4.231 with commit 1c1291a84e94f6501644634c97544bb8291e9a1a
	Fixed in 5.10.167 with commit 0f9db1209f59844839175b5b907d3778cafde93d
	Fixed in 5.15.92 with commit c1aa0dd52db4ce888be0bd820c3fa918d350ca0b
	Fixed in 5.17.3 with commit f61c23e73dc653b957781066abfa8105c3fa3f5b
	Fixed in 5.18 with commit 3afee2118132e93e5f6fa636dfde86201a860ab3

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-49139
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/bluetooth/hci_event.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/1c1291a84e94f6501644634c97544bb8291e9a1a
	https://git.kernel.org/stable/c/0f9db1209f59844839175b5b907d3778cafde93d
	https://git.kernel.org/stable/c/c1aa0dd52db4ce888be0bd820c3fa918d350ca0b
	https://git.kernel.org/stable/c/f61c23e73dc653b957781066abfa8105c3fa3f5b
	https://git.kernel.org/stable/c/3afee2118132e93e5f6fa636dfde86201a860ab3
