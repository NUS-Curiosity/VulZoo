From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-49382: soc: rockchip: Fix refcount leak in rockchip_grf_init

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

soc: rockchip: Fix refcount leak in rockchip_grf_init

of_find_matching_node_and_match returns a node pointer with refcount
incremented, we should use of_node_put() on it when done.
Add missing of_node_put() to avoid refcount leak.

The Linux kernel CVE team has assigned CVE-2022-49382 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.11 with commit 4c58063d4258f6beb4fd5647db6b58f49e337c8f and fixed in 4.14.283 with commit d5422f323858cad3ac3581075f9a3a5e0d41c0d8
	Issue introduced in 4.11 with commit 4c58063d4258f6beb4fd5647db6b58f49e337c8f and fixed in 4.19.247 with commit 28133325526b92921f3269fdf97a20d90b92b217
	Issue introduced in 4.11 with commit 4c58063d4258f6beb4fd5647db6b58f49e337c8f and fixed in 5.4.198 with commit 69a30b2ed620c2206cbbd1e9c112e4fc584e02bd
	Issue introduced in 4.11 with commit 4c58063d4258f6beb4fd5647db6b58f49e337c8f and fixed in 5.10.122 with commit 5b3e990f85eb034faa461e691e719e8ce9e2a3c8
	Issue introduced in 4.11 with commit 4c58063d4258f6beb4fd5647db6b58f49e337c8f and fixed in 5.15.47 with commit aab25b669cb9fd3698c2631be4435f4fe92d9e59
	Issue introduced in 4.11 with commit 4c58063d4258f6beb4fd5647db6b58f49e337c8f and fixed in 5.17.15 with commit 042571fe1d171773655ad706715ecc865913d9a4
	Issue introduced in 4.11 with commit 4c58063d4258f6beb4fd5647db6b58f49e337c8f and fixed in 5.18.4 with commit 8f64e84924604bb969ee1fbc4b8d7d09b9214889
	Issue introduced in 4.11 with commit 4c58063d4258f6beb4fd5647db6b58f49e337c8f and fixed in 5.19 with commit 9b59588d8be91c96bfb0371e912ceb4f16315dbf

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-49382
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/soc/rockchip/grf.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/d5422f323858cad3ac3581075f9a3a5e0d41c0d8
	https://git.kernel.org/stable/c/28133325526b92921f3269fdf97a20d90b92b217
	https://git.kernel.org/stable/c/69a30b2ed620c2206cbbd1e9c112e4fc584e02bd
	https://git.kernel.org/stable/c/5b3e990f85eb034faa461e691e719e8ce9e2a3c8
	https://git.kernel.org/stable/c/aab25b669cb9fd3698c2631be4435f4fe92d9e59
	https://git.kernel.org/stable/c/042571fe1d171773655ad706715ecc865913d9a4
	https://git.kernel.org/stable/c/8f64e84924604bb969ee1fbc4b8d7d09b9214889
	https://git.kernel.org/stable/c/9b59588d8be91c96bfb0371e912ceb4f16315dbf
