From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-49048: ipv6: fix panic when forwarding a pkt with no in6 dev

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

ipv6: fix panic when forwarding a pkt with no in6 dev

kongweibin reported a kernel panic in ip6_forward() when input interface
has no in6 dev associated.

The following tc commands were used to reproduce this panic:
tc qdisc del dev vxlan100 root
tc qdisc add dev vxlan100 root netem corrupt 5%

The Linux kernel CVE team has assigned CVE-2022-49048 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.19.199 with commit bff0854e2f804f68d3e93d19e4580dbd69777e1d and fixed in 4.19.239 with commit 74b68f5249f16c5f7f675d0f604fa6ae20e3a151
	Issue introduced in 5.4.136 with commit 7f4848229e91d508102b30396b8a1b710ac23637 and fixed in 5.4.190 with commit ab2f5afb7af5c68389e8c7dd29e0a98fbeaaa435
	Issue introduced in 5.10.54 with commit 79ec7b5b2f4fe38e5c7459ed0bdff4ef3386ab63 and fixed in 5.10.112 with commit a263712ba8c9ded25dd9d2d5ced11bcea5b33a3e
	Issue introduced in 5.14 with commit ccd27f05ae7b8ebc40af5b004e94517a919aa862 and fixed in 5.15.35 with commit adee01bbf6cb5b3e4ed08be8ff866aac90f13836
	Issue introduced in 5.14 with commit ccd27f05ae7b8ebc40af5b004e94517a919aa862 and fixed in 5.17.4 with commit e69fb3de87a8923e5931a272a38fa3cceb01da44
	Issue introduced in 5.14 with commit ccd27f05ae7b8ebc40af5b004e94517a919aa862 and fixed in 5.18 with commit e3fa461d8b0e185b7da8a101fe94dfe6dd500ac0
	Issue introduced in 5.13.6 with commit 350e10d217337480158b604bbf6601c50ed161c6

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-49048
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/ipv6/ip6_output.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/74b68f5249f16c5f7f675d0f604fa6ae20e3a151
	https://git.kernel.org/stable/c/ab2f5afb7af5c68389e8c7dd29e0a98fbeaaa435
	https://git.kernel.org/stable/c/a263712ba8c9ded25dd9d2d5ced11bcea5b33a3e
	https://git.kernel.org/stable/c/adee01bbf6cb5b3e4ed08be8ff866aac90f13836
	https://git.kernel.org/stable/c/e69fb3de87a8923e5931a272a38fa3cceb01da44
	https://git.kernel.org/stable/c/e3fa461d8b0e185b7da8a101fe94dfe6dd500ac0
