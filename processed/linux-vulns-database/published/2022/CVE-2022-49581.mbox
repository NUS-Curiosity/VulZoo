From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-49581: be2net: Fix buffer overflow in be_get_module_eeprom

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

be2net: Fix buffer overflow in be_get_module_eeprom

be_cmd_read_port_transceiver_data assumes that it is given a buffer that
is at least PAGE_DATA_LEN long, or twice that if the module supports SFF
8472. However, this is not always the case.

Fix this by passing the desired offset and length to
be_cmd_read_port_transceiver_data so that we only copy the bytes once.

The Linux kernel CVE team has assigned CVE-2022-49581 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.18 with commit e36edd9d26cf257511548edaf2b7a56eb4fed854 and fixed in 4.9.325 with commit a5a8fc0679a8fd58d47aa2ebcfc5742631f753f9
	Issue introduced in 3.18 with commit e36edd9d26cf257511548edaf2b7a56eb4fed854 and fixed in 4.14.290 with commit fe4473fc7940f14c4a12db873b9729134c212654
	Issue introduced in 3.18 with commit e36edd9d26cf257511548edaf2b7a56eb4fed854 and fixed in 4.19.254 with commit 8ff4f9df73e5c551a72ee6034886c17e8de6596d
	Issue introduced in 3.18 with commit e36edd9d26cf257511548edaf2b7a56eb4fed854 and fixed in 5.4.208 with commit a8569f76df7ec5b4b51155c57523a0b356db5741
	Issue introduced in 3.18 with commit e36edd9d26cf257511548edaf2b7a56eb4fed854 and fixed in 5.10.134 with commit 665cbe91de2f7c97c51ca8fce39aae26477c1948
	Issue introduced in 3.18 with commit e36edd9d26cf257511548edaf2b7a56eb4fed854 and fixed in 5.15.58 with commit aba8ff847f4f927ad7a1a1ee4a9f29989a1a728f
	Issue introduced in 3.18 with commit e36edd9d26cf257511548edaf2b7a56eb4fed854 and fixed in 5.18.15 with commit 18043da94c023f3ef09c15017bdb04e8f695ef10
	Issue introduced in 3.18 with commit e36edd9d26cf257511548edaf2b7a56eb4fed854 and fixed in 5.19 with commit d7241f679a59cfe27f92cb5c6272cb429fb1f7ec

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-49581
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/ethernet/emulex/benet/be_cmds.c
	drivers/net/ethernet/emulex/benet/be_cmds.h
	drivers/net/ethernet/emulex/benet/be_ethtool.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/a5a8fc0679a8fd58d47aa2ebcfc5742631f753f9
	https://git.kernel.org/stable/c/fe4473fc7940f14c4a12db873b9729134c212654
	https://git.kernel.org/stable/c/8ff4f9df73e5c551a72ee6034886c17e8de6596d
	https://git.kernel.org/stable/c/a8569f76df7ec5b4b51155c57523a0b356db5741
	https://git.kernel.org/stable/c/665cbe91de2f7c97c51ca8fce39aae26477c1948
	https://git.kernel.org/stable/c/aba8ff847f4f927ad7a1a1ee4a9f29989a1a728f
	https://git.kernel.org/stable/c/18043da94c023f3ef09c15017bdb04e8f695ef10
	https://git.kernel.org/stable/c/d7241f679a59cfe27f92cb5c6272cb429fb1f7ec
