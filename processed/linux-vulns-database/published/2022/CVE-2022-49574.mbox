From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-49574: tcp: Fix data-races around sysctl_tcp_recovery.

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

tcp: Fix data-races around sysctl_tcp_recovery.

While reading sysctl_tcp_recovery, it can be changed concurrently.
Thus, we need to add READ_ONCE() to its readers.

The Linux kernel CVE team has assigned CVE-2022-49574 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.4 with commit 4f41b1c58a32537542f14c1150099131613a5e8a and fixed in 4.19.254 with commit c7a492db1f7c37c758a66915908677bd8bc5d368
	Issue introduced in 4.4 with commit 4f41b1c58a32537542f14c1150099131613a5e8a and fixed in 5.4.208 with commit 92c35113c63306091df9211375eebd0abd8c2160
	Issue introduced in 4.4 with commit 4f41b1c58a32537542f14c1150099131613a5e8a and fixed in 5.10.134 with commit d8781f7cd04091744f474a2bada74772084b9dc9
	Issue introduced in 4.4 with commit 4f41b1c58a32537542f14c1150099131613a5e8a and fixed in 5.15.58 with commit a31e2d0cb5cfa2aae3144cac04f25031d5d20fb4
	Issue introduced in 4.4 with commit 4f41b1c58a32537542f14c1150099131613a5e8a and fixed in 5.18.15 with commit 52ee7f5c4811ce6be1becd14d38ba1f8a8a0df81
	Issue introduced in 4.4 with commit 4f41b1c58a32537542f14c1150099131613a5e8a and fixed in 5.19 with commit e7d2ef837e14a971a05f60ea08c47f3fed1a36e4

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-49574
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/ipv4/tcp_input.c
	net/ipv4/tcp_recovery.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/c7a492db1f7c37c758a66915908677bd8bc5d368
	https://git.kernel.org/stable/c/92c35113c63306091df9211375eebd0abd8c2160
	https://git.kernel.org/stable/c/d8781f7cd04091744f474a2bada74772084b9dc9
	https://git.kernel.org/stable/c/a31e2d0cb5cfa2aae3144cac04f25031d5d20fb4
	https://git.kernel.org/stable/c/52ee7f5c4811ce6be1becd14d38ba1f8a8a0df81
	https://git.kernel.org/stable/c/e7d2ef837e14a971a05f60ea08c47f3fed1a36e4
