From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-49727: ipv6: Fix signed integer overflow in l2tp_ip6_sendmsg

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

ipv6: Fix signed integer overflow in l2tp_ip6_sendmsg

When len >= INT_MAX - transhdrlen, ulen = len + transhdrlen will be
overflow. To fix, we can follow what udpv6 does and subtract the
transhdrlen from the max.

The Linux kernel CVE team has assigned CVE-2022-49727 to this issue.


Affected and fixed versions
===========================

	Fixed in 4.9.320 with commit 2cf73c7cb6125083408d77f43d0e84d86aed0000
	Fixed in 4.14.285 with commit 0e818d433fc2718fe4da044ffca7431812a7e04e
	Fixed in 4.19.249 with commit 6c4e3486d21173d60925ef52e512cae727b43d30
	Fixed in 5.4.200 with commit 2f42389d270f2304c8855b0b63498a5a4d0c053d
	Fixed in 5.10.124 with commit b8879ca1fd7348b4d5db7db86dcb97f60c73d751
	Fixed in 5.15.49 with commit 27a37755ceb401111ded76810359d3adc4b268a1
	Fixed in 5.18.6 with commit 034246122f5c5e2e2a0b9fe04e24517920e9beb1
	Fixed in 5.19 with commit f638a84afef3dfe10554c51820c16e39a278c915

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-49727
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/l2tp/l2tp_ip6.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/2cf73c7cb6125083408d77f43d0e84d86aed0000
	https://git.kernel.org/stable/c/0e818d433fc2718fe4da044ffca7431812a7e04e
	https://git.kernel.org/stable/c/6c4e3486d21173d60925ef52e512cae727b43d30
	https://git.kernel.org/stable/c/2f42389d270f2304c8855b0b63498a5a4d0c053d
	https://git.kernel.org/stable/c/b8879ca1fd7348b4d5db7db86dcb97f60c73d751
	https://git.kernel.org/stable/c/27a37755ceb401111ded76810359d3adc4b268a1
	https://git.kernel.org/stable/c/034246122f5c5e2e2a0b9fe04e24517920e9beb1
	https://git.kernel.org/stable/c/f638a84afef3dfe10554c51820c16e39a278c915
