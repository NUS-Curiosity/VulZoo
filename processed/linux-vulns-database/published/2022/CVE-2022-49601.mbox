From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-49601: tcp/dccp: Fix a data-race around sysctl_tcp_fwmark_accept.

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

tcp/dccp: Fix a data-race around sysctl_tcp_fwmark_accept.

While reading sysctl_tcp_fwmark_accept, it can be changed concurrently.
Thus, we need to add READ_ONCE() to its reader.

The Linux kernel CVE team has assigned CVE-2022-49601 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.16 with commit 84f39b08d7868ce10eeaf640627cb89777f0ae93 and fixed in 4.9.325 with commit 13207f9485b5de68decf296ceb0046f5eabb2485
	Issue introduced in 3.16 with commit 84f39b08d7868ce10eeaf640627cb89777f0ae93 and fixed in 4.14.290 with commit 45fc82706a97242539d6b841ddd7a077ec20757b
	Issue introduced in 3.16 with commit 84f39b08d7868ce10eeaf640627cb89777f0ae93 and fixed in 4.19.254 with commit abf70de2ec026ae8d7da4e79bec61888a880e00b
	Issue introduced in 3.16 with commit 84f39b08d7868ce10eeaf640627cb89777f0ae93 and fixed in 5.4.208 with commit a7386602a2fe2f6192477e8ede291a815da09d81
	Issue introduced in 3.16 with commit 84f39b08d7868ce10eeaf640627cb89777f0ae93 and fixed in 5.10.134 with commit d4f65615db7fca3df9f7e79eadf937e6ddb03c54
	Issue introduced in 3.16 with commit 84f39b08d7868ce10eeaf640627cb89777f0ae93 and fixed in 5.15.58 with commit bf3134feffe61b7a0e21f60a04743f8da0958b53
	Issue introduced in 3.16 with commit 84f39b08d7868ce10eeaf640627cb89777f0ae93 and fixed in 5.18.15 with commit 526d8cf8824f613c72dba2155542295e70135f62
	Issue introduced in 3.16 with commit 84f39b08d7868ce10eeaf640627cb89777f0ae93 and fixed in 5.19 with commit 1a0008f9df59451d0a17806c1ee1a19857032fa8

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-49601
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	include/net/inet_sock.h


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/13207f9485b5de68decf296ceb0046f5eabb2485
	https://git.kernel.org/stable/c/45fc82706a97242539d6b841ddd7a077ec20757b
	https://git.kernel.org/stable/c/abf70de2ec026ae8d7da4e79bec61888a880e00b
	https://git.kernel.org/stable/c/a7386602a2fe2f6192477e8ede291a815da09d81
	https://git.kernel.org/stable/c/d4f65615db7fca3df9f7e79eadf937e6ddb03c54
	https://git.kernel.org/stable/c/bf3134feffe61b7a0e21f60a04743f8da0958b53
	https://git.kernel.org/stable/c/526d8cf8824f613c72dba2155542295e70135f62
	https://git.kernel.org/stable/c/1a0008f9df59451d0a17806c1ee1a19857032fa8
