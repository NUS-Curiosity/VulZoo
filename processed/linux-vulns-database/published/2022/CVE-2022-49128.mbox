From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-49128: drm/bridge: Add missing pm_runtime_put_sync

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

drm/bridge: Add missing pm_runtime_put_sync

pm_runtime_get_sync() will increase the rumtime PM counter
even when it returns an error. Thus a pairing decrement is needed
to prevent refcount leak. Fix this by replacing this API with
pm_runtime_resume_and_get(), which will not change the runtime
PM counter on error. Besides, a matching decrement is needed
on the error handling path to keep the counter balanced.

The Linux kernel CVE team has assigned CVE-2022-49128 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.8 with commit 44cfc6233447cb2cf47aeb99457de35826a363f6 and fixed in 5.15.34 with commit ff13c90d7f7ab606b37be6d15140d19013d6736c
	Issue introduced in 5.8 with commit 44cfc6233447cb2cf47aeb99457de35826a363f6 and fixed in 5.16.20 with commit 792533e54cd6e89191798ccd1abd590c62b9077e
	Issue introduced in 5.8 with commit 44cfc6233447cb2cf47aeb99457de35826a363f6 and fixed in 5.17.3 with commit 9df80dc738926a2ea4bd1ce5993c3d0f4b0e855c
	Issue introduced in 5.8 with commit 44cfc6233447cb2cf47aeb99457de35826a363f6 and fixed in 5.18 with commit 46f47807738441e354873546dde0b000106c068a

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-49128
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/gpu/drm/bridge/nwl-dsi.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/ff13c90d7f7ab606b37be6d15140d19013d6736c
	https://git.kernel.org/stable/c/792533e54cd6e89191798ccd1abd590c62b9077e
	https://git.kernel.org/stable/c/9df80dc738926a2ea4bd1ce5993c3d0f4b0e855c
	https://git.kernel.org/stable/c/46f47807738441e354873546dde0b000106c068a
