{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ntracing: Fix potential double free in create_var_ref()\n\nIn create_var_ref(), init_var_ref() is called to initialize the fields\nof variable ref_field, which is allocated in the previous function call\nto create_hist_field(). Function init_var_ref() allocates the\ncorresponding fields such as ref_field->system, but frees these fields\nwhen the function encounters an error. The caller later calls\ndestroy_hist_field() to conduct error handling, which frees the fields\nand the variable itself. This results in double free of the fields which\nare already freed in the previous function.\n\nFix this by storing NULL to the corresponding fields when they are freed\nin init_var_ref()."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "kernel/trace/trace_events_hist.c"
               ],
               "versions": [
                  {
                     "version": "067fe038e70f6e64960d26a79c4df5f1413d0f13",
                     "lessThan": "f8b383f83cb573152c577eca1ef101e89995b72a",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "067fe038e70f6e64960d26a79c4df5f1413d0f13",
                     "lessThan": "c27f744ceefadc7bbeb14233b6abc150ced617d2",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "067fe038e70f6e64960d26a79c4df5f1413d0f13",
                     "lessThan": "058cb6d86b9789377216c936506b346aaa1eb581",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "067fe038e70f6e64960d26a79c4df5f1413d0f13",
                     "lessThan": "37443b3508b8cce6832f8d25cb4550b2f7801f50",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "067fe038e70f6e64960d26a79c4df5f1413d0f13",
                     "lessThan": "4fdfb15e08598711dbf50daf56a33965232daf0e",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "067fe038e70f6e64960d26a79c4df5f1413d0f13",
                     "lessThan": "bd83ff3bbfb003832481c9bff999d12385f396ae",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "067fe038e70f6e64960d26a79c4df5f1413d0f13",
                     "lessThan": "99696a2592bca641eb88cc9a80c90e591afebd0f",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "kernel/trace/trace_events_hist.c"
               ],
               "versions": [
                  {
                     "version": "4.17",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "4.17",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "4.19.247",
                     "lessThanOrEqual": "4.19.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.4.198",
                     "lessThanOrEqual": "5.4.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.10.121",
                     "lessThanOrEqual": "5.10.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.15.46",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.17.14",
                     "lessThanOrEqual": "5.17.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.18.3",
                     "lessThanOrEqual": "5.18.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.19",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/f8b383f83cb573152c577eca1ef101e89995b72a"
            },
            {
               "url": "https://git.kernel.org/stable/c/c27f744ceefadc7bbeb14233b6abc150ced617d2"
            },
            {
               "url": "https://git.kernel.org/stable/c/058cb6d86b9789377216c936506b346aaa1eb581"
            },
            {
               "url": "https://git.kernel.org/stable/c/37443b3508b8cce6832f8d25cb4550b2f7801f50"
            },
            {
               "url": "https://git.kernel.org/stable/c/4fdfb15e08598711dbf50daf56a33965232daf0e"
            },
            {
               "url": "https://git.kernel.org/stable/c/bd83ff3bbfb003832481c9bff999d12385f396ae"
            },
            {
               "url": "https://git.kernel.org/stable/c/99696a2592bca641eb88cc9a80c90e591afebd0f"
            }
         ],
         "title": "tracing: Fix potential double free in create_var_ref()",
         "x_generator": {
            "engine": "bippy-5f407fcff5a0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2022-49410",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
