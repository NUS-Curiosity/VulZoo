From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-49100: virtio_console: eliminate anonymous module_init & module_exit

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

virtio_console: eliminate anonymous module_init & module_exit

Eliminate anonymous module_init() and module_exit(), which can lead to
confusion or ambiguity when reading System.map, crashes/oops/bugs,
or an initcall_debug log.

Give each of these init and exit functions unique driver-specific
names to eliminate the anonymous names.

Example 1: (System.map)
 ffffffff832fc78c t init
 ffffffff832fc79e t init
 ffffffff832fc8f8 t init

Example 2: (initcall_debug log)
 calling  init+0x0/0x12 @ 1
 initcall init+0x0/0x12 returned 0 after 15 usecs
 calling  init+0x0/0x60 @ 1
 initcall init+0x0/0x60 returned 0 after 2 usecs
 calling  init+0x0/0x9a @ 1
 initcall init+0x0/0x9a returned 0 after 74 usecs

The Linux kernel CVE team has assigned CVE-2022-49100 to this issue.


Affected and fixed versions
===========================

	Fixed in 4.9.311 with commit 93e3d88321d2274fa4e26b006e19cc10fec331c2
	Fixed in 4.14.276 with commit 7deaddb704713608e0ae559e27185581b9af71a0
	Fixed in 4.19.238 with commit 0f3d824bd70a1303464d5e93ee3e7afe7832fe89
	Fixed in 5.4.189 with commit 3504b0a177208eda85bf472bbf7c9aa77d2b8343
	Fixed in 5.10.111 with commit c69b442125bf009fce26e15aa5616caf8a3673c3
	Fixed in 5.15.34 with commit 44c2d5fbe7b2bd1f8cb114d608a591a73a5d4ae6
	Fixed in 5.16.20 with commit 3fd5dee7404ce40c79cba468bb2510115639d975
	Fixed in 5.17.3 with commit 71612aee09ecea3475f8751dc841d75a011b1fd0
	Fixed in 5.18 with commit fefb8a2a941338d871e2d83fbd65fbfa068857bd

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-49100
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/char/virtio_console.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/93e3d88321d2274fa4e26b006e19cc10fec331c2
	https://git.kernel.org/stable/c/7deaddb704713608e0ae559e27185581b9af71a0
	https://git.kernel.org/stable/c/0f3d824bd70a1303464d5e93ee3e7afe7832fe89
	https://git.kernel.org/stable/c/3504b0a177208eda85bf472bbf7c9aa77d2b8343
	https://git.kernel.org/stable/c/c69b442125bf009fce26e15aa5616caf8a3673c3
	https://git.kernel.org/stable/c/44c2d5fbe7b2bd1f8cb114d608a591a73a5d4ae6
	https://git.kernel.org/stable/c/3fd5dee7404ce40c79cba468bb2510115639d975
	https://git.kernel.org/stable/c/71612aee09ecea3475f8751dc841d75a011b1fd0
	https://git.kernel.org/stable/c/fefb8a2a941338d871e2d83fbd65fbfa068857bd
