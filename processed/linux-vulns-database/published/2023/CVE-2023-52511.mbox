From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-52511: spi: sun6i: reduce DMA RX transfer width to single byte

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

spi: sun6i: reduce DMA RX transfer width to single byte

Through empirical testing it has been determined that sometimes RX SPI
transfers with DMA enabled return corrupted data. This is down to single
or even multiple bytes lost during DMA transfer from SPI peripheral to
memory. It seems the RX FIFO within the SPI peripheral can become
confused when performing bus read accesses wider than a single byte to it
during an active SPI transfer.

This patch reduces the width of individual DMA read accesses to the
RX FIFO to a single byte to mitigate that issue.

The Linux kernel CVE team has assigned CVE-2023-52511 to this issue.


Affected and fixed versions
===========================

	Fixed in 5.15.134 with commit ff05ed4ae214011464a0156f05cac1b0b46b5fbc
	Fixed in 6.1.56 with commit e15bb292b24630ee832bfc7fd616bd72c7682bbb
	Fixed in 6.5.6 with commit b3c21c9c7289692f4019f163c3b06d8bdf78b355
	Fixed in 6.6 with commit 171f8a49f212e87a8b04087568e1b3d132e36a18

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-52511
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/spi/spi-sun6i.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/ff05ed4ae214011464a0156f05cac1b0b46b5fbc
	https://git.kernel.org/stable/c/e15bb292b24630ee832bfc7fd616bd72c7682bbb
	https://git.kernel.org/stable/c/b3c21c9c7289692f4019f163c3b06d8bdf78b355
	https://git.kernel.org/stable/c/171f8a49f212e87a8b04087568e1b3d132e36a18
