From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-52631: fs/ntfs3: Fix an NULL dereference bug

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

fs/ntfs3: Fix an NULL dereference bug

The issue here is when this is called from ntfs_load_attr_list().  The
"size" comes from le32_to_cpu(attr->res.data_size) so it can't overflow
on a 64bit systems but on 32bit systems the "+ 1023" can overflow and
the result is zero.  This means that the kmalloc will succeed by
returning the ZERO_SIZE_PTR and then the memcpy() will crash with an
Oops on the next line.

The Linux kernel CVE team has assigned CVE-2023-52631 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.15 with commit be71b5cba2e6485e8959da7a9f9a44461a1bb074 and fixed in 5.15.149 with commit ae4acad41b0f93f1c26cc0fc9135bb79d8282d0b
	Issue introduced in 5.15 with commit be71b5cba2e6485e8959da7a9f9a44461a1bb074 and fixed in 6.1.78 with commit ec1bedd797588fe38fc11cba26d77bb1d9b194c6
	Issue introduced in 5.15 with commit be71b5cba2e6485e8959da7a9f9a44461a1bb074 and fixed in 6.6.17 with commit fb7bcd1722bc9bc55160378f5f99c01198fd14a7
	Issue introduced in 5.15 with commit be71b5cba2e6485e8959da7a9f9a44461a1bb074 and fixed in 6.7.5 with commit 686820fe141ea0220fc6fdfc7e5694f915cf64b2
	Issue introduced in 5.15 with commit be71b5cba2e6485e8959da7a9f9a44461a1bb074 and fixed in 6.8 with commit b2dd7b953c25ffd5912dda17e980e7168bebcf6c

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-52631
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	fs/ntfs3/ntfs_fs.h


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/ae4acad41b0f93f1c26cc0fc9135bb79d8282d0b
	https://git.kernel.org/stable/c/ec1bedd797588fe38fc11cba26d77bb1d9b194c6
	https://git.kernel.org/stable/c/fb7bcd1722bc9bc55160378f5f99c01198fd14a7
	https://git.kernel.org/stable/c/686820fe141ea0220fc6fdfc7e5694f915cf64b2
	https://git.kernel.org/stable/c/b2dd7b953c25ffd5912dda17e980e7168bebcf6c
