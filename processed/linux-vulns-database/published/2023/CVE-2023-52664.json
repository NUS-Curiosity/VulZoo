{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: atlantic: eliminate double free in error handling logic\n\nDriver has a logic leak in ring data allocation/free,\nwhere aq_ring_free could be called multiple times on same ring,\nif system is under stress and got memory allocation error.\n\nRing pointer was used as an indicator of failure, but this is\nnot correct since only ring data is allocated/deallocated.\nRing itself is an array member.\n\nChanging ring allocation functions to return error code directly.\nThis simplifies error handling and eliminates aq_ring_free\non higher layer."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/net/ethernet/aquantia/atlantic/aq_ptp.c",
                  "drivers/net/ethernet/aquantia/atlantic/aq_ring.c",
                  "drivers/net/ethernet/aquantia/atlantic/aq_ring.h",
                  "drivers/net/ethernet/aquantia/atlantic/aq_vec.c"
               ],
               "versions": [
                  {
                     "version": "5015024ddfe5efccf1b964f14f078c2152b3b335",
                     "lessThan": "0edb3ae8bfa31cd544b0c195bdec00e036002b5d",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "5015024ddfe5efccf1b964f14f078c2152b3b335",
                     "lessThan": "c11a870a73a3bc4cc7df6dd877a45b181795fcbf",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "5015024ddfe5efccf1b964f14f078c2152b3b335",
                     "lessThan": "d1fde4a7e1dcc4d49cce285107a7a43c3030878d",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "5015024ddfe5efccf1b964f14f078c2152b3b335",
                     "lessThan": "b3cb7a830a24527877b0bc900b9bd74a96aea928",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/net/ethernet/aquantia/atlantic/aq_ptp.c",
                  "drivers/net/ethernet/aquantia/atlantic/aq_ring.c",
                  "drivers/net/ethernet/aquantia/atlantic/aq_ring.h",
                  "drivers/net/ethernet/aquantia/atlantic/aq_vec.c"
               ],
               "versions": [
                  {
                     "version": "4.11",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "4.11",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.77",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.6.16",
                     "lessThanOrEqual": "6.6.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.7.4",
                     "lessThanOrEqual": "6.7.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.8",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/0edb3ae8bfa31cd544b0c195bdec00e036002b5d"
            },
            {
               "url": "https://git.kernel.org/stable/c/c11a870a73a3bc4cc7df6dd877a45b181795fcbf"
            },
            {
               "url": "https://git.kernel.org/stable/c/d1fde4a7e1dcc4d49cce285107a7a43c3030878d"
            },
            {
               "url": "https://git.kernel.org/stable/c/b3cb7a830a24527877b0bc900b9bd74a96aea928"
            }
         ],
         "title": "net: atlantic: eliminate double free in error handling logic",
         "x_generator": {
            "engine": "bippy-5f407fcff5a0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2023-52664",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
