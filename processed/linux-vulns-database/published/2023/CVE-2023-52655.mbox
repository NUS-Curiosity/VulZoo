From bippy-d175d3acf727 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-52655: usb: aqc111: check packet for fixup for true limit

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

usb: aqc111: check packet for fixup for true limit

If a device sends a packet that is inbetween 0
and sizeof(u64) the value passed to skb_trim()
as length will wrap around ending up as some very
large value.

The driver will then proceed to parse the header
located at that position, which will either oops or
process some random value.

The fix is to check against sizeof(u64) rather than
0, which the driver currently does. The issue exists
since the introduction of the driver.

The Linux kernel CVE team has assigned CVE-2023-52655 to this issue.


Affected and fixed versions
===========================

	Fixed in 5.4.265 with commit 84f2e5b3e70f
	Fixed in 5.10.205 with commit d69581c17608
	Fixed in 5.15.144 with commit 46412b2fb1f9
	Fixed in 6.1.69 with commit 82c386d73689
	Fixed in 6.6.8 with commit 2ebf775f0541
	Fixed in 6.7 with commit ccab434e674c

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-52655
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/usb/aqc111.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/84f2e5b3e70f08fce3cb1ff73414631c5e490204
	https://git.kernel.org/stable/c/d69581c17608d81824dd497d9a54b6a5b6139975
	https://git.kernel.org/stable/c/46412b2fb1f9cc895d6d4036bf24f640b5d86dab
	https://git.kernel.org/stable/c/82c386d73689a45d5ee8c1290827bce64056dddd
	https://git.kernel.org/stable/c/2ebf775f0541ae0d474836fa0cf3220e502f8e3e
	https://git.kernel.org/stable/c/ccab434e674ca95d483788b1895a70c21b7f016a
