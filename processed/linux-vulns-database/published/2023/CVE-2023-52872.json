{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ntty: n_gsm: fix race condition in status line change on dead connections\n\ngsm_cleanup_mux() cleans up the gsm by closing all DLCIs, stopping all\ntimers, removing the virtual tty devices and clearing the data queues.\nThis procedure, however, may cause subsequent changes of the virtual modem\nstatus lines of a DLCI. More data is being added the outgoing data queue\nand the deleted kick timer is restarted to handle this. At this point many\nresources have already been removed by the cleanup procedure. Thus, a\nkernel panic occurs.\n\nFix this by proving in gsm_modem_update() that the cleanup procedure has\nnot been started and the mux is still alive.\n\nNote that writing to a virtual tty is already protected by checks against\nthe DLCI specific connection state."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/tty/n_gsm.c"
               ],
               "versions": [
                  {
                     "version": "dd37f657387853623f20c1b2482afbb9cd8ece33",
                     "lessThan": "81a4dd5e6c78f5d8952fa8c9d36565db1fe01444",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "c568f7086c6e771c77aad13d727c70ef70e07243",
                     "lessThan": "df6cfab66ff2a44bd23ad5dd5309cb3421bb6593",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "c568f7086c6e771c77aad13d727c70ef70e07243",
                     "lessThan": "19d34b73234af542cc8a218cf398dee73cdb1890",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "c568f7086c6e771c77aad13d727c70ef70e07243",
                     "lessThan": "ce4df90333c4fe65acb8b5089fdfe9b955ce976a",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "c568f7086c6e771c77aad13d727c70ef70e07243",
                     "lessThan": "3a75b205de43365f80a33b98ec9289785da56243",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/tty/n_gsm.c"
               ],
               "versions": [
                  {
                     "version": "6.0",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "6.0",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.15.138",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.62",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.5.11",
                     "lessThanOrEqual": "6.5.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.6.1",
                     "lessThanOrEqual": "6.6.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.7",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/81a4dd5e6c78f5d8952fa8c9d36565db1fe01444"
            },
            {
               "url": "https://git.kernel.org/stable/c/df6cfab66ff2a44bd23ad5dd5309cb3421bb6593"
            },
            {
               "url": "https://git.kernel.org/stable/c/19d34b73234af542cc8a218cf398dee73cdb1890"
            },
            {
               "url": "https://git.kernel.org/stable/c/ce4df90333c4fe65acb8b5089fdfe9b955ce976a"
            },
            {
               "url": "https://git.kernel.org/stable/c/3a75b205de43365f80a33b98ec9289785da56243"
            }
         ],
         "title": "tty: n_gsm: fix race condition in status line change on dead connections",
         "x_generator": {
            "engine": "bippy-5f407fcff5a0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2023-52872",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
