From bippy-d175d3acf727 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-52669: crypto: s390/aes - Fix buffer overread in CTR mode

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

crypto: s390/aes - Fix buffer overread in CTR mode

When processing the last block, the s390 ctr code will always read
a whole block, even if there isn't a whole block of data left.  Fix
this by using the actual length left and copy it into a buffer first
for processing.

The Linux kernel CVE team has assigned CVE-2023-52669 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.0 with commit 0200f3ecc196 and fixed in 5.10.210 with commit cd51e26a3b89
	Issue introduced in 3.0 with commit 0200f3ecc196 and fixed in 5.15.149 with commit a7f580cdb42e
	Issue introduced in 3.0 with commit 0200f3ecc196 and fixed in 6.1.76 with commit dbc9a791a70e
	Issue introduced in 3.0 with commit 0200f3ecc196 and fixed in 6.6.15 with commit d68ac38895e8
	Issue introduced in 3.0 with commit 0200f3ecc196 and fixed in 6.7.3 with commit e78f1a43e72d
	Issue introduced in 3.0 with commit 0200f3ecc196 and fixed in 6.8 with commit d07f951903fa

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-52669
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	arch/s390/crypto/aes_s390.c
	arch/s390/crypto/paes_s390.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/cd51e26a3b89706beec64f2d8296cfb1c34e0c79
	https://git.kernel.org/stable/c/a7f580cdb42ec3d53bbb7c4e4335a98423703285
	https://git.kernel.org/stable/c/dbc9a791a70ea47be9f2acf251700fe254a2ab23
	https://git.kernel.org/stable/c/d68ac38895e84446848b7647ab9458d54cacba3e
	https://git.kernel.org/stable/c/e78f1a43e72daf77705ad5b9946de66fc708b874
	https://git.kernel.org/stable/c/d07f951903fa9922c375b8ab1ce81b18a0034e3b
