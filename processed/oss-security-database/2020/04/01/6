
Date: Wed, 1 Apr 2020 12:19:01 -0700
From: Jonathan Wei <jonwei@...che.org>
To: oss-security@...ts.openwall.com
Subject: [CVE-2020-1958]: Apache Druid LDAP injection vulnerability

Severity: High

Vendor:
The Apache Software Foundation

Versions Affected:
Druid 0.17.0

Description:
When LDAP authentication is enabled:
- Callers of Druid APIs with a valid set of LDAP credentials can bypass the
`credentialsValidator.userSearch` filter barrier that determines if a valid
LDAP user is allowed to authenticate with Druid. They are still subject to
role-based authorization checks, if configured.
- Callers of Druid APIs can retrieve any LDAP attribute values of users
that exist on the LDAP server, so long as that information is visible to
the Druid server. This information disclosure does not require the caller
itself to be a valid LDAP user.

Mitigation:
- Users of Druid 0.17.0 that use LDAP authentication should upgrade to
Druid 0.17.1.

Credit:
This issue was discovered by Grzegorz Go≈Çawski.

