
Date: Tue, 19 May 2020 08:29:05 +0530
From: Hardik Vyas <hvyas@...hat.com>
To: oss-security@...ts.openwall.com
Subject: CVE-2020-10736 ceph: authorization bypass in monitor and manager daemons

Hello,

An authorization bypass vulnerability was found in Ceph versions 15.2.0 and
later, where the ceph-mon and ceph-mgr daemons do not properly restrict
access, resulting in gaining access to unauthorized resources. This flaw
allows an authenticated client to modify the configuration and possibly
conduct further attacks.

In ceph-mon daemon, the "kludge" for older clients in handle_command()
allows any authenticated client access to the three whitelisted commands.
An attacker with "mon r" caps can exploit this, e.g. to change
configuration parameters using injectargs. For ceph-mgr daemon, in
handle_command(MCommand), messages are queued to adminsocket without access
checks if fsid is present. This can be exploited by an attacker without
manager caps to run any MCommand including "config set".

CVE-2020-10736 has been assigned for this flaw. Octopus v15.2.2 release
announcement : https://ceph.io/releases/v15-2-2-octopus-released/

Upstream patches:

[master]
https://github.com/ceph/ceph/commit/c7e7009a690621aacd4ac2c70c6469f25d692868
[v15.2.2]
https://github.com/ceph/ceph/commit/f2cf2ce1bd9a86462510a7a12afa4e528b615df2

Credit: Olle Segerdahl

Regards,
-- 

Hardik Vyas / Red Hat Product Security

BD48 C633 DE34 733A BBC3  3B72 8A14 AEBB D68B 9381

