
Date: Fri, 2 Apr 2021 10:47:26 +0100
From: Colm O hEigeartaigh <coheigea@...che.org>
To: oss-security@...ts.openwall.com
Subject: CVE-2021-22696: Apache CXF: OAuth 2 authorization service vulnerable to DDos attacks

Description:

CXF supports (via JwtRequestCodeFilter) passing OAuth 2 parameters via a
JWT token as opposed to query parameters (see: The OAuth 2.0 Authorization
Framework: JWT Secured Authorization Request (JAR)). Instead of sending a
JWT token as a "request" parameter, the spec also supports specifying a URI
from which to retrieve a JWT token from via the "request_uri" parameter.

CXF was not validating the "request_uri" parameter (apart from ensuring it
uses "https) and was making a REST request to the parameter in the request
to retrieve a token.

This means that CXF was vulnerable to DDos attacks on the authorization
server, as specified in section 10.4.1 of the spec.

This issue affects Apache CXF versions prior to 3.4.3; Apache CXF versions
prior to 3.3.10.

Reference:
http://cxf.apache.org/security-advisories.data/CVE-2021-22696.txt.asc

