{
    "CVE_data_meta": {
        "ASSIGNER": "sirt@juniper.net",
        "DATE_PUBLIC": "2020-07-08T07:00:00.000Z",
        "ID": "CVE-2020-1654",
        "STATE": "PUBLIC",
        "TITLE": "Junos OS: SRX Series: processing a malformed HTTP message when ICAP redirect service is enabled may can lead to flowd process crash or remote code execution"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "platform": "SRX Series",
                                            "version_affected": "!<",
                                            "version_name": "18.1",
                                            "version_value": "18.1R1"
                                        },
                                        {
                                            "platform": "SRX Series",
                                            "version_affected": "<",
                                            "version_name": "18.1",
                                            "version_value": "18.1R3-S9"
                                        },
                                        {
                                            "platform": "SRX Series",
                                            "version_affected": "<",
                                            "version_name": "18.2",
                                            "version_value": "18.2R2-S7, 18.2R3-S3"
                                        },
                                        {
                                            "platform": "SRX Series",
                                            "version_affected": "<",
                                            "version_name": "18.3",
                                            "version_value": "18.3R1-S7, 18.3R2-S4, 18.3R3-S1"
                                        },
                                        {
                                            "platform": "SRX Series",
                                            "version_affected": "<",
                                            "version_name": "18.4",
                                            "version_value": "18.4R1-S7, 18.4R2-S4, 18.4R3"
                                        },
                                        {
                                            "platform": "SRX Series",
                                            "version_affected": "<",
                                            "version_name": "19.1",
                                            "version_value": "19.1R1-S5, 19.1R2"
                                        },
                                        {
                                            "platform": "SRX Series",
                                            "version_affected": "<",
                                            "version_name": "19.2",
                                            "version_value": "19.2R1-S2, 19.2R2"
                                        },
                                        {
                                            "platform": "SRX Series",
                                            "version_affected": "<",
                                            "version_name": "19.3",
                                            "version_value": "19.3R2"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Juniper Networks"
                }
            ]
        }
    },
    "configuration": [
        {
            "lang": "eng",
            "value": "This issue may occur only when ICAP Redirect Service is enabled.\n\nThe examples of minimum config stanza affected by this issue:\n  [services icap-redirect profile <ICAP_PROFILE_NAME>]\nin combination with: \n  [security policies from-zone <ZONE_NAME> to-zone <ZONE_NAME> policy <POLICY_NAME> then permit application-services <ICAP_PROFILE_NAME>]\n\n"
        }
    ],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "On Juniper Networks SRX Series with ICAP (Internet Content Adaptation Protocol) redirect service enabled, processing a malformed HTTP message can lead to a Denial of Service (DoS) or Remote Code Execution (RCE) Continued processing of this malformed HTTP message may result in an extended Denial of Service (DoS) condition. The offending HTTP message that causes this issue may originate both from the HTTP server or the HTTP client. This issue affects Juniper Networks Junos OS on SRX Series: 18.1 versions prior to 18.1R3-S9 ; 18.2 versions prior to 18.2R2-S7, 18.2R3-S3; 18.3 versions prior to 18.3R1-S7, 18.3R2-S4, 18.3R3-S1; 18.4 versions prior to 18.4R1-S7, 18.4R2-S4, 18.4R3; 19.1 versions prior to 19.1R1-S5, 19.1R2; 19.2 versions prior to 19.2R1-S2, 19.2R2; 19.3 versions prior to 19.3R2. This issue does not affect Juniper Networks Junos OS prior to 18.1R1."
            }
        ]
    },
    "exploit": [
        {
            "lang": "eng",
            "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
        }
    ],
    "generator": {
        "engine": "Vulnogram 0.0.9"
    },
    "impact": {
        "cvss": {
            "attackComplexity": "LOW",
            "attackVector": "NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 9.8,
            "baseSeverity": "CRITICAL",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
            "version": "3.1"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-120 Buffer Overflow"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "name": "https://kb.juniper.net/JSA11031",
                "refsource": "CONFIRM",
                "url": "https://kb.juniper.net/JSA11031"
            }
        ]
    },
    "solution": [
        {
            "lang": "eng",
            "value": "The following software releases have been updated to resolve this specific issue: 18.1R3-S9, 18.2R2-S7, 18.2R3-S3, 18.3R1-S7, 18.3R2-S4, 18.3R3-S1, 18.4R1-S7, 18.4R2-S4, 18.4R3, 19.1R1-S5, 19.1R2, 19.2R1-S2, 19.2R2, 19.3R2, 19.4R1, and all subsequent releases.\n"
        }
    ],
    "source": {
        "advisory": "JSA11031",
        "defect": [
            "1460035"
        ],
        "discovery": "USER"
    },
    "work_around": [
        {
            "lang": "eng",
            "value": "Disable ICAP redirect service otherwise there are no viable workarounds for this issue.\n"
        }
    ]
}