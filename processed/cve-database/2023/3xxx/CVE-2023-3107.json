{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2023-3107",
        "ASSIGNER": "secteam@freebsd.org",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "A set of carefully crafted ipv6 packets can trigger an integer overflow in the calculation of a fragment reassembled packet's payload length field. This allows an attacker to trigger a kernel panic, resulting in a denial of service.\n"
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-190 Integer Overflow or Wraparound",
                        "cweId": "CWE-190"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "FreeBSD",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "FreeBSD",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "13.2-RELEASE",
                                            "version_value": "13.2-RELEASE-p2"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "13.1-RELEASE",
                                            "version_value": "13.1-RELEASE-p9"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "12.4-RELEASE",
                                            "version_value": "12.4-RELEASE-p4"
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "https://security.FreeBSD.org/advisories/FreeBSD-SA-23:06.ipv6.asc",
                "refsource": "MISC",
                "name": "https://security.FreeBSD.org/advisories/FreeBSD-SA-23:06.ipv6.asc"
            },
            {
                "url": "https://security.netapp.com/advisory/ntap-20230804-0001/",
                "refsource": "MISC",
                "name": "https://security.netapp.com/advisory/ntap-20230804-0001/"
            }
        ]
    },
    "generator": {
        "engine": "Vulnogram 0.1.0-dev"
    },
    "source": {
        "advisory": "FreeBSD-SA-23:06.ipv6",
        "discovery": "UNKNOWN"
    },
    "work_around": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "Users with IPv6 disabled on untrusted network interfaces are not affected.  Such interfaces will have the IFDISABLED nd6 flag set in ifconfig(8).<br><br>The kernel may be configured to drop all IPv6 fragments by setting the net.inet6.ip6.maxfrags sysctl to 0.  Doing so will prevent the bug from being triggered, with the caveat that legitimate IPv6 fragments will be dropped.<br><br>If the pf(4) firewall is enabled, and scrubbing and fragment reassembly is enabled on untrusted interfaces, the bug cannot be triggered.  This is the default if pf(4) is enabled.<br>"
                }
            ],
            "value": "Users with IPv6 disabled on untrusted network interfaces are not affected.  Such interfaces will have the IFDISABLED nd6 flag set in ifconfig(8).\n\nThe kernel may be configured to drop all IPv6 fragments by setting the net.inet6.ip6.maxfrags sysctl to 0.  Doing so will prevent the bug from being triggered, with the caveat that legitimate IPv6 fragments will be dropped.\n\nIf the pf(4) firewall is enabled, and scrubbing and fragment reassembly is enabled on untrusted interfaces, the bug cannot be triggered.  This is the default if pf(4) is enabled.\n"
        }
    ],
    "credits": [
        {
            "lang": "en",
            "value": "Zweig of Kunlun Lab"
        }
    ]
}