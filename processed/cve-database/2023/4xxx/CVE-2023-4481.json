{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2023-4481",
        "ASSIGNER": "sirt@juniper.net",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "An Improper Input Validation vulnerability in the Routing Protocol Daemon (rpd) of Juniper Networks Junos OS and Junos OS Evolved allows an unauthenticated, network-based attacker to cause a Denial of Service (DoS).\n\nWhen certain specific crafted BGP UPDATE messages are received over an established BGP session, one BGP session may be torn down with an UPDATE message error, or the issue may propagate beyond the local system which will remain non-impacted, but may affect one or more remote systems. This issue is exploitable remotely as the crafted UPDATE message can propagate through unaffected systems and intermediate BGP speakers.\nContinuous receipt of the crafted BGP UPDATE messages will create a sustained Denial of Service (DoS) condition for impacted devices.\n\nThis issue affects eBGP and iBGP, in both IPv4 and IPv6 implementations.  This issue requires a remote attacker to have at least one established BGP session.\n Improper Input Validation, Denial of Service vulnerability in Juniper Networks, Inc. Junos OS (BGP, rpd modules), Juniper Networks, Inc. Junos OS Evolved (BGP, rpd modules) allows Fuzzing.This issue affects\u00a0\n\nJunos OS:\u00a0\n\n\n\n  *  All versions before 20.4R3-S10,\n  *  from 21.1R1 through 21.*,\n  *  from 21.2 before 21.2R3-S5,\n  *  from 21.3 before 21.3R3-S5,\n  *  from 21.4 before 21.4R3-S7 (unaffected from 21.4R3-S5, affected from 21.4R3-S6)\n  *  from 22.1 before 22.1R3-S4,\n  *  from 22.2 before 22.2R3-S3,\n  *  from 22.3 before 22.3R3-S1,\n  *  from 22.4 before 22.4R3,\n  *  from 23.2 before 23.2R2.\n\n\nJunos OS Evolved:\n\n\n\n  *  All versions before 20.4R3-S10-EVO,\n  *  from 21.2-EVO before 21.2R3-S7-EVO,\n  *  from 21.3-EVO before 21.3R3-S5-EVO,\n  *  from 21.4-EVO before 21.4R3-S5-EVO,\n  *  from 22.1-EVO before 22.1R3-S4-EVO,\n  *  from 22.2-EVO before 22.2R3-S3-EVO,\n  *  from 22.3-EVO before 22.3R3-S1-EVO,\n  *  from 22.4-EVO before 22.4R3-EVO,\n  *  from 23.2-EVO before 23.2R2-EVO."
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-20 Improper Input Validation",
                        "cweId": "CWE-20"
                    }
                ]
            },
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "Denial of Service"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "Juniper Networks, Inc.",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "not down converted",
                                            "x_cve_json_5_version_data": {
                                                "versions": [
                                                    {
                                                        "lessThan": "20.4R3-S10",
                                                        "status": "affected",
                                                        "version": "0",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "lessThan": "21.2R3-S5",
                                                        "status": "affected",
                                                        "version": "21.2",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "lessThan": "21.3R3-S5",
                                                        "status": "affected",
                                                        "version": "21.3",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "21.4R3-S5",
                                                                "status": "unaffected"
                                                            },
                                                            {
                                                                "at": "21.4R3-S6",
                                                                "status": "affected"
                                                            }
                                                        ],
                                                        "lessThan": "21.4R3-S7",
                                                        "status": "affected",
                                                        "version": "21.4",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "lessThan": "22.1R3-S4",
                                                        "status": "affected",
                                                        "version": "22.1",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "lessThan": "22.2R3-S3",
                                                        "status": "affected",
                                                        "version": "22.2",
                                                        "versionType": "se"
                                                    },
                                                    {
                                                        "lessThan": "22.3R3-S1",
                                                        "status": "affected",
                                                        "version": "22.3",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "lessThan": "22.4R3",
                                                        "status": "affected",
                                                        "version": "22.4",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "lessThan": "23.2R2",
                                                        "status": "affected",
                                                        "version": "23.2",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "lessThanOrEqual": "21.*",
                                                        "status": "affected",
                                                        "version": "21.1R1",
                                                        "versionType": "semver"
                                                    }
                                                ],
                                                "defaultStatus": "affected"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Junos OS Evolved",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "not down converted",
                                            "x_cve_json_5_version_data": {
                                                "versions": [
                                                    {
                                                        "lessThan": "20.4R3-S10-EVO",
                                                        "status": "affected",
                                                        "version": "0",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "lessThan": "21.2R3-S7-EVO",
                                                        "status": "affected",
                                                        "version": "21.2-EVO",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "lessThan": "21.3R3-S5-EVO",
                                                        "status": "affected",
                                                        "version": "21.3-EVO",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "lessThan": "21.4R3-S5-EVO",
                                                        "status": "affected",
                                                        "version": "21.4-EVO",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "lessThan": "22.1R3-S4-EVO",
                                                        "status": "affected",
                                                        "version": "22.1-EVO",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "lessThan": "22.2R3-S3-EVO",
                                                        "status": "affected",
                                                        "version": "22.2-EVO",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "lessThan": "22.3R3-S1-EVO",
                                                        "status": "affected",
                                                        "version": "22.3-EVO",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "lessThan": "22.4R3-EVO",
                                                        "status": "affected",
                                                        "version": "22.4-EVO",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "lessThan": "23.2R2-EVO",
                                                        "status": "affected",
                                                        "version": "23.2-EVO",
                                                        "versionType": "semver"
                                                    }
                                                ],
                                                "defaultStatus": "affected"
                                            }
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "https://kb.juniper.net/JSA72510",
                "refsource": "MISC",
                "name": "https://kb.juniper.net/JSA72510"
            },
            {
                "url": "https://www.rfc-editor.org/rfc/rfc7606",
                "refsource": "MISC",
                "name": "https://www.rfc-editor.org/rfc/rfc7606"
            },
            {
                "url": "https://www.rfc-editor.org/rfc/rfc4271",
                "refsource": "MISC",
                "name": "https://www.rfc-editor.org/rfc/rfc4271"
            },
            {
                "url": "https://www.juniper.net/documentation/us/en/software/junos/bgp/topics/topic-map/bgp-error-messages.html",
                "refsource": "MISC",
                "name": "https://www.juniper.net/documentation/us/en/software/junos/bgp/topics/topic-map/bgp-error-messages.html"
            }
        ]
    },
    "generator": {
        "engine": "Vulnogram 0.1.0-dev"
    },
    "source": {
        "advisory": "JSA72510",
        "defect": [
            "1709837"
        ],
        "discovery": "EXTERNAL"
    },
    "configuration": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "The following minimal configuration is required:<br><br>&nbsp; [protocols bgp]"
                }
            ],
            "value": "The following minimal configuration is required:\n\n\u00a0 [protocols bgp]"
        }
    ],
    "work_around": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<span style=\"background-color: rgb(255, 255, 255);\">The workaround is to configure BGP error tolerance by way of:</span><br><br><span style=\"background-color: rgb(255, 255, 255);\">&nbsp; [ protocols bgp bgp-error-tolerance ... ]</span><br><br><span style=\"background-color: rgb(255, 255, 255);\">Additional details can be found at </span><a target=\"_blank\" rel=\"nofollow\" href=\"https://www.juniper.net/documentation/us/en/software/junos/bgp/topics/topic-map/bgp-error-messages.html\">https://www.juniper.net/documentation/us/en/software/junos/bgp/topics/topic-map/bgp-error-messages.h...</a><br><br><span style=\"background-color: rgb(255, 255, 255);\">Juniper considers configuring this option to be a Best Common Practice (BCP) as it not only prevents this issue from happening, but protects against similar issues as well.</span><br>"
                }
            ],
            "value": "The workaround is to configure BGP error tolerance by way of:\n\n\u00a0 [ protocols bgp bgp-error-tolerance ... ]\n\nAdditional details can be found at  https://www.juniper.net/documentation/us/en/software/junos/bgp/topics/topic-map/bgp-error-messages.h... https://www.juniper.net/documentation/us/en/software/junos/bgp/topics/topic-map/bgp-error-messages.html \n\nJuniper considers configuring this option to be a Best Common Practice (BCP) as it not only prevents this issue from happening, but protects against similar issues as well."
        }
    ],
    "exploit": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<span style=\"background-color: rgb(255, 255, 255);\">Juniper SIRT is not aware of any malicious exploitation of this vulnerability.</span><br>"
                }
            ],
            "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
        }
    ],
    "solution": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>The following software releases have been updated to resolve this specific issue:<br></p><p>Junos OS: <span style=\"background-color: rgb(255, 255, 255);\">20.4R3-S10,&nbsp;</span><span style=\"background-color: rgb(255, 255, 255);\">21.2R3-S7,&nbsp;</span><span style=\"background-color: rgb(255, 255, 255);\">21.3R3-S5,&nbsp;</span><span style=\"background-color: rgb(255, 255, 255);\">21.4R3-S5 or <span style=\"background-color: rgb(255, 255, 255);\">21.4R3-S7</span>,&nbsp;</span><span style=\"background-color: rgb(255, 255, 255);\">22.1R3-S4,&nbsp;</span><span style=\"background-color: rgb(255, 255, 255);\">22.2R3-S3,&nbsp;</span><span style=\"background-color: rgb(255, 255, 255);\">22.3R3-S1,&nbsp;</span><span style=\"background-color: rgb(255, 255, 255);\">22.4R3,</span>&nbsp;23.2R2, 23.3R2, 23.4R1, and all subsequent releases<br></p><p>Note: except for Junos OS 21.4R3-S6 which is affected and unfixed.<br></p><p></p><p>Junos OS Evolved: 20.4R3-S10-EVO,&nbsp;<span style=\"background-color: rgb(255, 255, 255);\">21.2R3-S7-EVO,&nbsp;<span style=\"background-color: rgb(255, 255, 255);\">21.3R3-S5-EVO,&nbsp;<span style=\"background-color: rgb(255, 255, 255);\">21.4R3-S5-EVO,&nbsp;<span style=\"background-color: rgb(255, 255, 255);\">22.1R3-S4-EVO,<span style=\"background-color: rgb(255, 255, 255);\">&nbsp;22.2R3-S3-EVO,&nbsp;<span style=\"background-color: rgb(255, 255, 255);\">22.3R3-S1-EVO,&nbsp;<span style=\"background-color: rgb(255, 255, 255);\">22.4R3-EVO,&nbsp;<span style=\"background-color: rgb(255, 255, 255);\"><span style=\"background-color: rgb(255, 255, 255);\">23.2R2-EVO,&nbsp;<span style=\"background-color: rgb(255, 255, 255);\"><span style=\"background-color: rgb(255, 255, 255);\">23.4R1-EVO,</span></span></span></span></span></span></span></span></span></span></span><span style=\"background-color: var(--wht);\">&nbsp;and all subsequent releases.</span></p><br>It is important that customers implement the workaround in addition to taking any updated software as these crafted UPDATE messages may be propagated to other devices even if non-impacted locally, thereby protecting the network by stopping the propagation of these crafted UPDATE messages.<br>The workaround is to configure BGP error tolerance by way of:<br><br>&nbsp; [ protocols bgp bgp-error-tolerance ... ]<br><br>Additional details can be found at <a target=\"_blank\" rel=\"nofollow\" href=\"https://www.juniper.net/documentation/us/en/software/junos/bgp/topics/topic-map/bgp-error-messages.html\">https://www.juniper.net/documentation/us/en/software/junos/bgp/topics/topic-map/bgp-error-messages.h...</a><br><br>Juniper considers configuring this option to be a Best Common Practice (BCP) as it not only prevents this issue from happening, but protects against similar issues as well.<p></p><p>This issue is being tracked as PR <a target=\"_blank\" rel=\"nofollow\" href=\"https://prsearch.juniper.net/problemreport/PR1709837\">1709837</a>&nbsp;which is visible on the Customer Support website.</p><p>Note: Juniper SIRT's <a target=\"_blank\" rel=\"nofollow\" href=\"https://kb.juniper.net/KB16765\">policy</a>&nbsp;is not to evaluate releases which are beyond End of Engineering (EOE) or End of Life (EOL).</p><br>"
                }
            ],
            "value": "The following software releases have been updated to resolve this specific issue:\n\n\nJunos OS: 20.4R3-S10,\u00a021.2R3-S7,\u00a021.3R3-S5,\u00a021.4R3-S5 or 21.4R3-S7,\u00a022.1R3-S4,\u00a022.2R3-S3,\u00a022.3R3-S1,\u00a022.4R3,\u00a023.2R2, 23.3R2, 23.4R1, and all subsequent releases\n\n\nNote: except for Junos OS 21.4R3-S6 which is affected and unfixed.\n\n\n\n\nJunos OS Evolved: 20.4R3-S10-EVO,\u00a021.2R3-S7-EVO,\u00a021.3R3-S5-EVO,\u00a021.4R3-S5-EVO,\u00a022.1R3-S4-EVO,\u00a022.2R3-S3-EVO,\u00a022.3R3-S1-EVO,\u00a022.4R3-EVO,\u00a023.2R2-EVO,\u00a023.4R1-EVO,\u00a0and all subsequent releases.\n\n\nIt is important that customers implement the workaround in addition to taking any updated software as these crafted UPDATE messages may be propagated to other devices even if non-impacted locally, thereby protecting the network by stopping the propagation of these crafted UPDATE messages.\nThe workaround is to configure BGP error tolerance by way of:\n\n\u00a0 [ protocols bgp bgp-error-tolerance ... ]\n\nAdditional details can be found at  https://www.juniper.net/documentation/us/en/software/junos/bgp/topics/topic-map/bgp-error-messages.h... https://www.juniper.net/documentation/us/en/software/junos/bgp/topics/topic-map/bgp-error-messages.html \n\nJuniper considers configuring this option to be a Best Common Practice (BCP) as it not only prevents this issue from happening, but protects against similar issues as well.\n\nThis issue is being tracked as PR  1709837 https://prsearch.juniper.net/problemreport/PR1709837 \u00a0which is visible on the Customer Support website.\n\nNote: Juniper SIRT's  policy https://kb.juniper.net/KB16765 \u00a0is not to evaluate releases which are beyond End of Engineering (EOE) or End of Life (EOL)."
        }
    ],
    "credits": [
        {
            "lang": "en",
            "value": "Ben Cartwright-Cox / bgp.tools"
        }
    ],
    "impact": {
        "cvss": [
            {
                "attackComplexity": "LOW",
                "attackVector": "NETWORK",
                "availabilityImpact": "HIGH",
                "baseScore": 7.5,
                "baseSeverity": "HIGH",
                "confidentialityImpact": "NONE",
                "integrityImpact": "NONE",
                "privilegesRequired": "NONE",
                "scope": "UNCHANGED",
                "userInteraction": "NONE",
                "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
                "version": "3.1"
            }
        ]
    }
}