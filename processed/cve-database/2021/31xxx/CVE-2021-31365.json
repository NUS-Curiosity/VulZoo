{
    "CVE_data_meta": {
        "ASSIGNER": "sirt@juniper.net",
        "DATE_PUBLIC": "2021-10-13T16:00:00.000Z",
        "ID": "CVE-2021-31365",
        "STATE": "PUBLIC",
        "TITLE": "Junos OS: EX2300, EX3400 and EX4300 Series: An Aggregated Ethernet (AE) interface will go down due to a stream of specific layer 2 frames"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "platform": "EX4300 Series",
                                            "version_affected": "<",
                                            "version_value": "15.1R7-S7"
                                        },
                                        {
                                            "platform": "EX4300 Series",
                                            "version_affected": "<",
                                            "version_name": "16.1",
                                            "version_value": "16.1R7-S8"
                                        },
                                        {
                                            "platform": "EX4300 Series",
                                            "version_affected": "<",
                                            "version_name": "17.1",
                                            "version_value": "17.1R2-S12"
                                        },
                                        {
                                            "platform": "EX4300 Series",
                                            "version_affected": "<",
                                            "version_name": "17.2",
                                            "version_value": "17.2R3-S4"
                                        },
                                        {
                                            "platform": "EX4300 Series",
                                            "version_affected": "<",
                                            "version_name": "17.3",
                                            "version_value": "17.3R3-S8"
                                        },
                                        {
                                            "platform": "EX4300 Series",
                                            "version_affected": "<",
                                            "version_name": "17.4",
                                            "version_value": "17.4R2-S10, 17.4R3-S2"
                                        },
                                        {
                                            "platform": "EX4300 Series",
                                            "version_affected": "<",
                                            "version_name": "18.1",
                                            "version_value": "18.1R3-S10"
                                        },
                                        {
                                            "platform": "EX4300 Series",
                                            "version_affected": "<",
                                            "version_name": "18.2",
                                            "version_value": "18.2R2-S7, 18.2R3-S3"
                                        },
                                        {
                                            "platform": "EX4300 Series",
                                            "version_affected": "<",
                                            "version_name": "18.3",
                                            "version_value": "18.3R2-S4, 18.3R3-S2"
                                        },
                                        {
                                            "platform": "EX4300 Series",
                                            "version_affected": "<",
                                            "version_name": "18.4",
                                            "version_value": "18.4R1-S7, 18.4R2-S4, 18.4R3-S1"
                                        },
                                        {
                                            "platform": "EX4300 Series",
                                            "version_affected": "<",
                                            "version_name": "19.1",
                                            "version_value": "19.1R1-S5, 19.1R2-S1, 19.1R3"
                                        },
                                        {
                                            "platform": "EX4300 Series",
                                            "version_affected": "<",
                                            "version_name": "19.2",
                                            "version_value": "19.2R1-S5, 19.2R2"
                                        },
                                        {
                                            "platform": "EX4300 Series",
                                            "version_affected": "<",
                                            "version_name": "19.3",
                                            "version_value": "19.3R2-S2, 19.3R3"
                                        },
                                        {
                                            "platform": "EX4300 Series",
                                            "version_affected": "<",
                                            "version_name": "19.4",
                                            "version_value": "19.4R1-S2, 19.4R2"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "platform": "EX3400 Series, EX4300-MP Series",
                                            "version_affected": "<",
                                            "version_value": "18.1R3-S12"
                                        },
                                        {
                                            "platform": "EX3400 Series, EX4300-MP Series",
                                            "version_affected": "<",
                                            "version_name": "18.2",
                                            "version_value": "18.2R3-S7"
                                        },
                                        {
                                            "platform": "EX3400 Series, EX4300-MP Series",
                                            "version_affected": "<",
                                            "version_name": "18.3",
                                            "version_value": "18.3R3-S4"
                                        },
                                        {
                                            "platform": "EX3400 Series, EX4300-MP Series",
                                            "version_affected": "<",
                                            "version_name": "18.4",
                                            "version_value": "18.4R2-S9, 18.4R3-S7"
                                        },
                                        {
                                            "platform": "EX3400 Series, EX4300-MP Series",
                                            "version_affected": "<",
                                            "version_name": "19.1",
                                            "version_value": "19.1R2-S3, 19.1R3-S4"
                                        },
                                        {
                                            "platform": "EX3400 Series, EX4300-MP Series",
                                            "version_affected": "<",
                                            "version_name": "19.2",
                                            "version_value": "19.2R3-S1"
                                        },
                                        {
                                            "platform": "EX3400 Series, EX4300-MP Series",
                                            "version_affected": "<",
                                            "version_name": "19.3",
                                            "version_value": "19.3R3-S1"
                                        },
                                        {
                                            "platform": "EX3400 Series, EX4300-MP Series",
                                            "version_affected": "<",
                                            "version_name": "19.4",
                                            "version_value": "19.4R3-S1"
                                        },
                                        {
                                            "platform": "EX3400 Series, EX4300-MP Series",
                                            "version_affected": "<",
                                            "version_name": "20.1",
                                            "version_value": "20.1R3"
                                        },
                                        {
                                            "platform": "EX3400 Series, EX4300-MP Series",
                                            "version_affected": "<",
                                            "version_name": "20.2",
                                            "version_value": "20.2R3"
                                        },
                                        {
                                            "platform": "EX3400 Series, EX4300-MP Series",
                                            "version_affected": "<",
                                            "version_name": "20.3",
                                            "version_value": "20.3R2"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "platform": "EX2300 Series",
                                            "version_affected": "<",
                                            "version_value": "18.3R3-S5"
                                        },
                                        {
                                            "platform": "EX2300 Series",
                                            "version_affected": "<",
                                            "version_name": "18.4",
                                            "version_value": "18.4R2-S9, 18.4R3-S9"
                                        },
                                        {
                                            "platform": "EX2300 Series",
                                            "version_affected": "<",
                                            "version_name": "19.1",
                                            "version_value": "19.1R2-S3, 19.1R3-S6"
                                        },
                                        {
                                            "platform": "EX2300 Series",
                                            "version_affected": "<",
                                            "version_name": "19.2",
                                            "version_value": "19.2R1-S7, 19.2R3-S3"
                                        },
                                        {
                                            "platform": "EX2300 Series",
                                            "version_affected": "<",
                                            "version_name": "19.3",
                                            "version_value": "19.3R2-S7, 19.3R3-S3"
                                        },
                                        {
                                            "platform": "EX2300 Series",
                                            "version_affected": "<",
                                            "version_name": "19.4",
                                            "version_value": "19.4R3-S5"
                                        },
                                        {
                                            "platform": "EX2300 Series",
                                            "version_affected": "<",
                                            "version_name": "20.1",
                                            "version_value": "20.1R2-S2, 20.1R3-S1"
                                        },
                                        {
                                            "platform": "EX2300 Series",
                                            "version_affected": "<",
                                            "version_name": "20.2",
                                            "version_value": "20.2R3-S2"
                                        },
                                        {
                                            "platform": "EX2300 Series",
                                            "version_affected": "<",
                                            "version_name": "20.3",
                                            "version_value": "20.3R3-S1"
                                        },
                                        {
                                            "platform": "EX2300 Series",
                                            "version_affected": "<",
                                            "version_name": "20.4",
                                            "version_value": "20.4R2-S1, 20.4R3"
                                        },
                                        {
                                            "platform": "EX2300 Series",
                                            "version_affected": "<",
                                            "version_name": "21.1",
                                            "version_value": "21.1R2"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Juniper Networks"
                }
            ]
        }
    },
    "configuration": [
        {
            "lang": "eng",
            "value": "This issue can only occur when the device is configured with Link Aggregation Control Protocol (LACP) in combination with Link Layer Discovery Protocol (LLDP).\n\nThe examples of minimum config stanza affected by this issue:\n  [interfaces ae<X> aggregated-ether-options lacp]\nin combination with:\n  [protocols lldp interface (all | ae<X>)]\n \n"
        }
    ],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "An Uncontrolled Resource Consumption vulnerability in Juniper Networks Junos OS on EX2300, EX3400 and EX4300 Series platforms allows an adjacent attacker sending a stream of layer 2 frames will trigger an Aggregated Ethernet (AE) interface to go down and thereby causing a Denial of Service (DoS). By continuously sending a stream of specific layer 2 frames an attacker will sustain the Denial of Service (DoS) condition. This issue affects: Juniper Networks Junos OS EX4300 Series All versions prior to 15.1R7-S7; 16.1 versions prior to 16.1R7-S8; 17.1 versions prior to 17.1R2-S12; 17.2 versions prior to 17.2R3-S4; 17.3 versions prior to 17.3R3-S8; 17.4 versions prior to 17.4R2-S10, 17.4R3-S2; 18.1 versions prior to 18.1R3-S10; 18.2 versions prior to 18.2R2-S7, 18.2R3-S3; 18.3 versions prior to 18.3R2-S4, 18.3R3-S2; 18.4 versions prior to 18.4R1-S7, 18.4R2-S4, 18.4R3-S1; 19.1 versions prior to 19.1R1-S5, 19.1R2-S1, 19.1R3; 19.2 versions prior to 19.2R1-S5, 19.2R2; 19.3 versions prior to 19.3R2-S2, 19.3R3; 19.4 versions prior to 19.4R1-S2, 19.4R2. Juniper Networks Junos OS EX3400 and EX4300-MP Series All versions prior to 18.1R3-S12; 18.2 versions prior to 18.2R3-S7; 18.3 versions prior to 18.3R3-S4; 18.4 versions prior to 18.4R2-S9, 18.4R3-S7; 19.1 versions prior to 19.1R2-S3, 19.1R3-S4; 19.2 versions prior to 19.2R3-S1; 19.3 versions prior to 19.3R3-S1; 19.4 versions prior to 19.4R3-S1; 20.1 versions prior to 20.1R3; 20.2 versions prior to 20.2R3; 20.3 versions prior to 20.3R2. Juniper Networks Junos OS EX2300 Series All versions prior to 18.3R3-S5; 18.4 versions prior to 18.4R2-S9, 18.4R3-S9; 19.1 versions prior to 19.1R2-S3, 19.1R3-S6; 19.2 versions prior to 19.2R1-S7, 19.2R3-S3; 19.3 versions prior to 19.3R2-S7, 19.3R3-S3; 19.4 versions prior to 19.4R3-S5; 20.1 versions prior to 20.1R2-S2, 20.1R3-S1; 20.2 versions prior to 20.2R3-S2; 20.3 versions prior to 20.3R3-S1; 20.4 versions prior to 20.4R2-S1, 20.4R3; 21.1 versions prior to 21.1R2."
            }
        ]
    },
    "exploit": [
        {
            "lang": "eng",
            "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
        }
    ],
    "generator": {
        "engine": "Vulnogram 0.0.9"
    },
    "impact": {
        "cvss": {
            "attackComplexity": "LOW",
            "attackVector": "ADJACENT_NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 6.5,
            "baseSeverity": "MEDIUM",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "version": "3.1"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-400 Uncontrolled Resource Consumption"
                    }
                ]
            },
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "Denial of Service (DoS)"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "name": "https://kb.juniper.net/JSA11227",
                "refsource": "CONFIRM",
                "url": "https://kb.juniper.net/JSA11227"
            }
        ]
    },
    "solution": [
        {
            "lang": "eng",
            "value": "The following software releases have been updated to resolve this specific issue in Junos OS \n\n- For EX4300 Series: 15.1R7-S7, 16.1R7-S8, 17.1R2-S12, 17.2R3-S4, 17.3R3-S8, 17.4R2-S10, 17.4R3-S2, 18.1R3-S10, 18.2R2-S7, 18.2R3-S3, 18.3R2-S4, 18.3R3-S2, 18.4R1-S7, 18.4R2-S4, 18.4R3-S1, 19.1R1-S5, 19.1R2-S1, 19.1R3, 19.2R2, 19.3R2-S2, 19.3R3, 19.4R1-S2, 19.4R2, 20.1R1, and all subsequent releases.\n\n- For EX3400 and EX4300-MP Series: 18.1R3-S12, 18.2R3-S7, 18.3R3-S4, 18.4R2-S9, 18.4R3-S7, 19.1R2-S3, 19.1R3-S4, 19.2R3-S1, 19.3R3-S1, 19.4R3-S1, 20.1R3, 20.2R3, 20.3R2, 20.4R1, and all subsequent releases.\n\n -For EX2300 Series: 18.3R3-S5, 18.4R2-S9, 18.4R3-S9, 19.1R2-S3, 19.1R3-S6, 19.2R1-S7, 19.2R3-S3, 19.3R2-S7, 19.3R3-S3, 19.4R3-S5, 20.1R2-S2, 20.1R3-S1, 20.2R3-S2, 20.3R3-S1, 20.4R2-S1, 20.4R3, 21.1R2, 21.2R1, and all subsequent releases."
        }
    ],
    "source": {
        "advisory": "JSA11227",
        "defect": [
            "1481911",
            "1582255",
            "1542530"
        ],
        "discovery": "USER"
    },
    "work_around": [
        {
            "lang": "eng",
            "value": "Disabling LLDP configuration will prevent this issue."
        }
    ]
}