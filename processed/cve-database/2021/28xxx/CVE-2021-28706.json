{
    "CVE_data_meta": {
        "ASSIGNER": "security@xen.org",
        "ID": "CVE-2021-28706",
        "STATE": "PUBLIC"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "xen",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "4.12.x"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "xen",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "?<",
                                            "version_value": "4.12"
                                        },
                                        {
                                            "version_affected": ">=",
                                            "version_value": "4.14.x"
                                        },
                                        {
                                            "version_affected": "!>",
                                            "version_value": "4.15.x"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "xen",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "xen-unstable"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "xen",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "4.13.x"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Xen"
                }
            ]
        }
    },
    "configuration": {
        "configuration_data": {
            "description": {
                "description_data": [
                    {
                        "lang": "eng",
                        "value": "All Xen versions from at least 3.2 onwards are affected.\n\nOn x86, only Xen builds with the BIGMEM configuration option enabled are\naffected.  (This option is off by default.)\n\nOnly hosts with more than 16 TiB of memory are affected."
                    }
                ]
            }
        }
    },
    "credit": {
        "credit_data": {
            "description": {
                "description_data": [
                    {
                        "lang": "eng",
                        "value": "This issue was discovered by Julien Grall of Amazon."
                    }
                ]
            }
        }
    },
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "guests may exceed their designated memory limit When a guest is permitted to have close to 16TiB of memory, it may be able to issue hypercalls to increase its memory allocation beyond the administrator established limit. This is a result of a calculation done with 32-bit precision, which may overflow. It would then only be the overflowed (and hence small) number which gets compared against the established upper bound."
            }
        ]
    },
    "impact": {
        "impact_data": {
            "description": {
                "description_data": [
                    {
                        "lang": "eng",
                        "value": "A guest may be able too allocate unbounded amounts of memory to itself.\nThis may result in a Denial of Service (DoS) affecting the entire host."
                    }
                ]
            }
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "unknown"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "url": "https://xenbits.xenproject.org/xsa/advisory-385.txt",
                "refsource": "MISC",
                "name": "https://xenbits.xenproject.org/xsa/advisory-385.txt"
            },
            {
                "refsource": "FEDORA",
                "name": "FEDORA-2021-03645e9807",
                "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/I7ZGWVVRI4XY2XSTBI3XEMWBXPDVX6OT/"
            },
            {
                "refsource": "DEBIAN",
                "name": "DSA-5017",
                "url": "https://www.debian.org/security/2021/dsa-5017"
            },
            {
                "refsource": "FEDORA",
                "name": "FEDORA-2021-2b3a2de94f",
                "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PXUI4VMD52CH3T7YXAG3J2JW7ZNN3SXF/"
            },
            {
                "refsource": "GENTOO",
                "name": "GLSA-202402-07",
                "url": "https://security.gentoo.org/glsa/202402-07"
            }
        ]
    },
    "workaround": {
        "workaround_data": {
            "description": {
                "description_data": [
                    {
                        "lang": "eng",
                        "value": "Setting the maximum amount of memory a guest may allocate to strictly\nless than 1023 GiB will avoid the vulnerability."
                    }
                ]
            }
        }
    }
}