{
    "CVE_data_meta": {
        "ASSIGNER": "sirt@juniper.net",
        "DATE_PUBLIC": "2021-07-14T16:00:00.000Z",
        "ID": "CVE-2021-0289",
        "STATE": "PUBLIC",
        "TITLE": "Junos OS: User-defined ARP Policer isn't applied on Aggregated Ethernet (AE) interface until firewall process is restarted"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": ">=",
                                            "version_name": "5.6",
                                            "version_value": "5.6R1"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "15.1",
                                            "version_value": "15.1R7-S10"
                                        },
                                        {
                                            "version_affected": ">=",
                                            "version_name": "15.1",
                                            "version_value": "15.1F1"
                                        },
                                        {
                                            "version_affected": ">=",
                                            "version_name": "16.1",
                                            "version_value": "16.1R1"
                                        },
                                        {
                                            "version_affected": ">=",
                                            "version_name": "16.2",
                                            "version_value": "16.2R1"
                                        },
                                        {
                                            "version_affected": ">=",
                                            "version_name": "17.1",
                                            "version_value": "17.1R1"
                                        },
                                        {
                                            "version_affected": ">=",
                                            "version_name": "17.2",
                                            "version_value": "17.2R1"
                                        },
                                        {
                                            "version_affected": ">=",
                                            "version_name": "17.3",
                                            "version_value": "17.3R1"
                                        },
                                        {
                                            "version_affected": ">=",
                                            "version_name": "17.4",
                                            "version_value": "17.4R1"
                                        },
                                        {
                                            "version_affected": ">=",
                                            "version_name": "18.1",
                                            "version_value": "18.1R1"
                                        },
                                        {
                                            "version_affected": ">=",
                                            "version_name": "18.2",
                                            "version_value": "18.2R1"
                                        },
                                        {
                                            "version_affected": ">=",
                                            "version_name": "18.3",
                                            "version_value": "18.3R1"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "18.4",
                                            "version_value": "18.4R2-S9, 18.4R3-S9"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "19.4",
                                            "version_value": "19.4R3-S3"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "20.1",
                                            "version_value": "20.1R3"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "20.2",
                                            "version_value": "20.2R3-S2"
                                        },
                                        {
                                            "version_affected": ">=",
                                            "version_name": "20.3",
                                            "version_value": "20.3R1"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "20.4",
                                            "version_value": "20.4R3"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "21.1",
                                            "version_value": "21.1R2"
                                        },
                                        {
                                            "version_affected": "!<",
                                            "version_value": "5.6R1"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "platform": "SRX Series",
                                            "version_affected": "<",
                                            "version_name": "18.4",
                                            "version_value": "18.4R2-S9, 18.4R3-S9"
                                        },
                                        {
                                            "platform": "SRX Series",
                                            "version_affected": "<",
                                            "version_name": "19.4",
                                            "version_value": "19.4R3-S3"
                                        },
                                        {
                                            "platform": "SRX Series",
                                            "version_affected": "<",
                                            "version_name": "20.1",
                                            "version_value": "20.1R3"
                                        },
                                        {
                                            "platform": "SRX Series",
                                            "version_affected": "!<",
                                            "version_name": "20.2",
                                            "version_value": "20.2R3-S2"
                                        },
                                        {
                                            "platform": "SRX Series",
                                            "version_affected": ">=",
                                            "version_name": "20.3",
                                            "version_value": "20.3R1"
                                        },
                                        {
                                            "platform": "SRX Series",
                                            "version_affected": "<",
                                            "version_name": "20.4",
                                            "version_value": "20.4R3"
                                        },
                                        {
                                            "platform": "SRX Series",
                                            "version_affected": "<",
                                            "version_name": "21.1",
                                            "version_value": "21.1R2"
                                        },
                                        {
                                            "platform": "SRX Series",
                                            "version_affected": "!<",
                                            "version_name": "18.4",
                                            "version_value": "18.4R1"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Junos OS Evolved",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "!",
                                            "version_name": "Any",
                                            "version_value": "Any"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "Juniper Networks"
                }
            ]
        }
    },
    "configuration": [
        {
            "lang": "eng",
            "value": "First in config CLI mode check that is there any user ARP policers configured on an ae interface:\n\n  show configuration | display set | match jtac-arp\n       set groups jtac-arp-policer interfaces ae5 unit <*> family inet policer arp jtac-arp  <<< this shows user arp policer configured on all ae interfaces\n\nNext validate which ARP policer is installed by using the operational cli command:\n\n\u201cshow interfaces extensive | match policer\u201d\n  show interfaces extensive | match policer\n      Policer: Input: __default_arp_policer__   <<< incorrect if user arp policer was applied on ae interface and default arp policer is displayed\n      Policer: Input: jtac-arp-ae5.317-inet-arp <<< correct if user arp policer was applied on ae interface\n "
        }
    ],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "When user-defined ARP Policer is configured and applied on one or more Aggregated Ethernet (AE) interface units, a Time-of-check Time-of-use (TOCTOU) Race Condition vulnerability between the Device Control Daemon (DCD) and firewall process (dfwd) daemons of Juniper Networks Junos OS allows an attacker to bypass the user-defined ARP Policer. In this particular case the User ARP policer is replaced with default ARP policer. To review the desired ARP Policers and actual state one can run the command \"show interfaces <> extensive\" and review the output. See further details below. An example output is: show interfaces extensive | match policer Policer: Input: __default_arp_policer__ <<< incorrect if user ARP Policer was applied on an AE interface and the default ARP Policer is displayed Policer: Input: jtac-arp-ae5.317-inet-arp <<< correct if user ARP Policer was applied on an AE interface For all platforms, except SRX Series: This issue affects Juniper Networks Junos OS: All versions 5.6R1 and all later versions prior to 18.4 versions prior to 18.4R2-S9, 18.4R3-S9 with the exception of 15.1 versions 15.1R7-S10 and later versions; 19.4 versions prior to 19.4R3-S3; 20.1 versions prior to 20.1R3; 20.2 versions prior to 20.2R3-S2; 20.3 version 20.3R1 and later versions; 20.4 versions prior to 20.4R3; 21.1 versions prior to 21.1R2; This issue does not affect Juniper Networks Junos OS versions prior to 5.6R1. On SRX Series this issue affects Juniper Networks Junos OS: 18.4 versions prior to 18.4R2-S9, 18.4R3-S9; 19.4 versions prior to 19.4R3-S4; 20.1 versions prior to 20.1R3; 20.2 versions prior to 20.2R3-S2; 20.3 version 20.3R1 and later versions; 20.4 versions prior to 20.4R3; 21.1 versions prior to 21.1R2. This issue does not affect 18.4 versions prior to 18.4R1 on SRX Series. This issue does not affect Junos OS Evolved."
            }
        ]
    },
    "exploit": [
        {
            "lang": "eng",
            "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
        }
    ],
    "generator": {
        "engine": "Vulnogram 0.0.9"
    },
    "impact": {
        "cvss": {
            "attackComplexity": "LOW",
            "attackVector": "ADJACENT_NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 6.5,
            "baseSeverity": "MEDIUM",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "version": "3.1"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-367 Time-of-check Time-of-use (TOCTOU) Race Condition"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "name": "https://kb.juniper.net/JSA11191",
                "refsource": "CONFIRM",
                "url": "https://kb.juniper.net/JSA11191"
            }
        ]
    },
    "solution": [
        {
            "lang": "eng",
            "value": "The following software releases have been updated to resolve this specific issue: For all platforms, except SRX Series, using Junos OS 15.1R7-S10, 18.4R2-S9, 18.4R3-S9, 19.4R3-S4, 20.1R3, 20.2R3-S2, 20.4R3, 21.1R2, 21.2R1, and all subsequent releases. On SRX series using Junos OS 18.4R2-S9, 18.4R3-S9, 19.4R3-S4. 20.1R3, 20.4R3, 21.1R2, 21.2R1, and all subsequent releases."
        }
    ],
    "source": {
        "advisory": "JSA11191",
        "defect": [
            "1528403"
        ],
        "discovery": "USER"
    },
    "work_around": [
        {
            "lang": "eng",
            "value": "There is no workaround for this issue. \n\nIf affected by this issue, to recover from its impact, restart the firewall process to update the ARP Policer on the AE interface unit(s).  \nFrom the CLI issue: \n\n  cli> restart firewall \n\nNote: no side effects on firewall restart shall be seen when issuing this command.\n "
        }
    ]
}