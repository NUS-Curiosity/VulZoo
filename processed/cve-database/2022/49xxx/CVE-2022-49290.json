{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2022-49290",
        "ASSIGNER": "cve@kernel.org",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nmac80211: fix potential double free on mesh join\n\nWhile commit 6a01afcf8468 (\"mac80211: mesh: Free ie data when leaving\nmesh\") fixed a memory leak on mesh leave / teardown it introduced a\npotential memory corruption caused by a double free when rejoining the\nmesh:\n\n  ieee80211_leave_mesh()\n  -> kfree(sdata->u.mesh.ie);\n  ...\n  ieee80211_join_mesh()\n  -> copy_mesh_setup()\n     -> old_ie = ifmsh->ie;\n     -> kfree(old_ie);\n\nThis double free / kernel panics can be reproduced by using wpa_supplicant\nwith an encrypted mesh (if set up without encryption via \"iw\" then\nifmsh->ie is always NULL, which avoids this issue). And then calling:\n\n  $ iw dev mesh0 mesh leave\n  $ iw dev mesh0 mesh join my-mesh\n\nNote that typically these commands are not used / working when using\nwpa_supplicant. And it seems that wpa_supplicant or wpa_cli are going\nthrough a NETDEV_DOWN/NETDEV_UP cycle between a mesh leave and mesh join\nwhere the NETDEV_UP resets the mesh.ie to NULL via a memcpy of\ndefault_mesh_setup in cfg80211_netdev_notifier_call, which then avoids\nthe memory corruption, too.\n\nThe issue was first observed in an application which was not using\nwpa_supplicant but \"Senf\" instead, which implements its own calls to\nnl80211.\n\nFixing the issue by removing the kfree()'ing of the mesh IE in the mesh\njoin function and leaving it solely up to the mesh leave to free the\nmesh IE."
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "n/a"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "Linux",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Linux",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "3212d6248faf0efce6b7a718e198feecce0eea05",
                                            "version_value": "615716af8644813355e014314a0bc1e961250f5a"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "86e7d4cd2ed5f4b0188afce8199faffcf1ae7c7e",
                                            "version_value": "c1d9c3628ef0a0ca197595d0f9e01cd3b5dda186"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "37bccfa89559a70c044b5ccde3c916a91388e14a",
                                            "version_value": "273ebddc5fda2967492cb0b6cdd7d81cfb821b76"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "3f15e3e62c80e180282f0cbc5559264e11c328b7",
                                            "version_value": "3bbd0000d012f92aec423b224784fbf0f7bf40f8"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "6a01afcf8468d3ca2bd8bbb27503f60dcf643b20",
                                            "version_value": "5d3ff9542a40ce034416bca03864709540a36016"
                                        },
                                        {
                                            "version_value": "not down converted",
                                            "x_cve_json_5_version_data": {
                                                "versions": [
                                                    {
                                                        "version": "5.8",
                                                        "status": "affected"
                                                    },
                                                    {
                                                        "version": "0",
                                                        "lessThan": "5.8",
                                                        "status": "unaffected",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "version": "4.9.309",
                                                        "lessThanOrEqual": "4.9.*",
                                                        "status": "unaffected",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "version": "4.14.274",
                                                        "lessThanOrEqual": "4.14.*",
                                                        "status": "unaffected",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "version": "4.19.237",
                                                        "lessThanOrEqual": "4.19.*",
                                                        "status": "unaffected",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "version": "5.4.188",
                                                        "lessThanOrEqual": "5.4.*",
                                                        "status": "unaffected",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "version": "5.10.109",
                                                        "lessThanOrEqual": "5.10.*",
                                                        "status": "unaffected",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "version": "5.15.32",
                                                        "lessThanOrEqual": "5.15.*",
                                                        "status": "unaffected",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "version": "5.16.18",
                                                        "lessThanOrEqual": "5.16.*",
                                                        "status": "unaffected",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "version": "5.17.1",
                                                        "lessThanOrEqual": "5.17.*",
                                                        "status": "unaffected",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "version": "5.18",
                                                        "lessThanOrEqual": "*",
                                                        "status": "unaffected",
                                                        "versionType": "original_commit_for_fix"
                                                    }
                                                ],
                                                "defaultStatus": "affected"
                                            }
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "https://git.kernel.org/stable/c/615716af8644813355e014314a0bc1e961250f5a",
                "refsource": "MISC",
                "name": "https://git.kernel.org/stable/c/615716af8644813355e014314a0bc1e961250f5a"
            },
            {
                "url": "https://git.kernel.org/stable/c/c1d9c3628ef0a0ca197595d0f9e01cd3b5dda186",
                "refsource": "MISC",
                "name": "https://git.kernel.org/stable/c/c1d9c3628ef0a0ca197595d0f9e01cd3b5dda186"
            },
            {
                "url": "https://git.kernel.org/stable/c/273ebddc5fda2967492cb0b6cdd7d81cfb821b76",
                "refsource": "MISC",
                "name": "https://git.kernel.org/stable/c/273ebddc5fda2967492cb0b6cdd7d81cfb821b76"
            },
            {
                "url": "https://git.kernel.org/stable/c/3bbd0000d012f92aec423b224784fbf0f7bf40f8",
                "refsource": "MISC",
                "name": "https://git.kernel.org/stable/c/3bbd0000d012f92aec423b224784fbf0f7bf40f8"
            },
            {
                "url": "https://git.kernel.org/stable/c/5d3ff9542a40ce034416bca03864709540a36016",
                "refsource": "MISC",
                "name": "https://git.kernel.org/stable/c/5d3ff9542a40ce034416bca03864709540a36016"
            },
            {
                "url": "https://git.kernel.org/stable/c/12e407a8ef17623823fd0c066fbd7f103953d28d",
                "refsource": "MISC",
                "name": "https://git.kernel.org/stable/c/12e407a8ef17623823fd0c066fbd7f103953d28d"
            },
            {
                "url": "https://git.kernel.org/stable/c/582d8c60c0c053684f7138875e8150d5749ffc17",
                "refsource": "MISC",
                "name": "https://git.kernel.org/stable/c/582d8c60c0c053684f7138875e8150d5749ffc17"
            },
            {
                "url": "https://git.kernel.org/stable/c/46bb87d40683337757a2f902fcd4244b32bb4e86",
                "refsource": "MISC",
                "name": "https://git.kernel.org/stable/c/46bb87d40683337757a2f902fcd4244b32bb4e86"
            },
            {
                "url": "https://git.kernel.org/stable/c/4a2d4496e15ea5bb5c8e83b94ca8ca7fb045e7d3",
                "refsource": "MISC",
                "name": "https://git.kernel.org/stable/c/4a2d4496e15ea5bb5c8e83b94ca8ca7fb045e7d3"
            }
        ]
    },
    "generator": {
        "engine": "bippy-5f407fcff5a0"
    }
}