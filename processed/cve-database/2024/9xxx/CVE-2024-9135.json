{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2024-9135",
        "ASSIGNER": "psirt@arista.com",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "On affected platforms running Arista EOS with BGP Link State configured, BGP peer flap can cause the BGP agent to leak memory. This may result in BGP routing processing being terminated and route flapping."
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-401 Missing Release of Memory after Effective Lifetime",
                        "cweId": "CWE-401"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "Arista Networks",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "EOS",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "=",
                                            "version_value": "4.33.0"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "4.31.0",
                                            "version_value": "4.31.5"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "4.30.0",
                                            "version_value": "4.30.8.1"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "4.29.0",
                                            "version_value": "4.29.9.1"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "4.28.0"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "4.27.0",
                                            "version_value": "4.27.1"
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "https://www.arista.com/en/support/advisories-notices/security-advisory/21092-security-advisory-0110",
                "refsource": "MISC",
                "name": "https://www.arista.com/en/support/advisories-notices/security-advisory/21092-security-advisory-0110"
            }
        ]
    },
    "generator": {
        "engine": "Vulnogram 0.2.0"
    },
    "source": {
        "advisory": "110",
        "defect": [
            "1006114"
        ],
        "discovery": "UNKNOWN"
    },
    "configuration": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>In order to be vulnerable to CVE-2024-9135, the following condition must be met:</p><p>BGP Link State must be configured:</p><pre>switch# router bgp 65544\nswitch#  &nbsp; address-family link-state\nswitch# &nbsp; &nbsp; &nbsp; neighbor 192.0.2.9 activate\nswitch#\nswitch#sh bgp link-state summary\nBGP summary information for VRF default\nRouter identifier 192.0.2.2, local AS number 65540\nNeighbor Status Codes: m - Under maintenance\n&nbsp; Description  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Neighbor V AS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MsgRcvd &nbsp; MsgSent  InQ OutQ  Up/Down State &nbsp; NlriRcd NlriAcc\n  \n&nbsp; brw363 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 192.0.2.9 4 65550 &nbsp; &nbsp; &nbsp; 194222  &nbsp; 125149  &nbsp; 0  &nbsp; 0 01:08:41 Estab &nbsp; 211948 211948\n</pre><div>&nbsp;</div><p>If BGP Link State is not configured there is no exposure to this issue. No BGP link-state peering is shown under show bgp link-state summary as below:</p><pre>switch&gt;sh bgp link-state summary\nBGP summary information for VRF default\nRouter identifier 192.0.2.2, local AS number 65540\nNeighbor Status Codes: m - Under maintenance\n  Description              Neighbor V AS           MsgRcvd   MsgSent  InQ OutQ  Up/Down State   NlriRcd NlriAcc</pre><br>"
                }
            ],
            "value": "In order to be vulnerable to CVE-2024-9135, the following condition must be met:\n\nBGP Link State must be configured:\n\nswitch# router bgp 65544\nswitch#  \u00a0 address-family link-state\nswitch# \u00a0 \u00a0 \u00a0 neighbor 192.0.2.9 activate\nswitch#\nswitch#sh bgp link-state summary\nBGP summary information for VRF default\nRouter identifier 192.0.2.2, local AS number 65540\nNeighbor Status Codes: m - Under maintenance\n\u00a0 Description  \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Neighbor V AS \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 MsgRcvd \u00a0 MsgSent  InQ OutQ  Up/Down State \u00a0 NlriRcd NlriAcc\n  \n\u00a0 brw363 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 192.0.2.9 4 65550 \u00a0 \u00a0 \u00a0 194222  \u00a0 125149  \u00a0 0  \u00a0 0 01:08:41 Estab \u00a0 211948 211948\n\n\n\u00a0\n\nIf BGP Link State is not configured there is no exposure to this issue. No BGP link-state peering is shown under show bgp link-state summary as below:\n\nswitch>sh bgp link-state summary\nBGP summary information for VRF default\nRouter identifier 192.0.2.2, local AS number 65540\nNeighbor Status Codes: m - Under maintenance\n  Description              Neighbor V AS           MsgRcvd   MsgSent  InQ OutQ  Up/Down State   NlriRcd NlriAcc"
        }
    ],
    "work_around": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>The workaround is to disable the Dynamic Path Selection (DPS) service inside BGP LinkState by disabling the feature toggle.  Note this should be done on affected non AWE platforms only.</p><pre>1. Enter \"bash\" shell under EOS prompt\n2. sudo sh -c 'echo \"BgpLsConsumerDps=0\" &gt; /mnt/flash/toggle_override; echo \"BgpLsProducerDps=0\" &gt;&gt; /mnt/flash/toggle_override'\n3. Reload the switch or router</pre>"
                }
            ],
            "value": "The workaround is to disable the Dynamic Path Selection (DPS) service inside BGP LinkState by disabling the feature toggle.  Note this should be done on affected non AWE platforms only.\n\n1. Enter \"bash\" shell under EOS prompt\n2. sudo sh -c 'echo \"BgpLsConsumerDps=0\" > /mnt/flash/toggle_override; echo \"BgpLsProducerDps=0\" >> /mnt/flash/toggle_override'\n3. Reload the switch or router"
        }
    ],
    "credits": [
        {
            "lang": "en",
            "value": "Craig Dods from Meta\u2019s Infrastructure Security team."
        }
    ],
    "impact": {
        "cvss": [
            {
                "attackComplexity": "LOW",
                "attackVector": "NETWORK",
                "availabilityImpact": "LOW",
                "baseScore": 5.3,
                "baseSeverity": "MEDIUM",
                "confidentialityImpact": "NONE",
                "integrityImpact": "NONE",
                "privilegesRequired": "NONE",
                "scope": "UNCHANGED",
                "userInteraction": "NONE",
                "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
                "version": "3.1"
            }
        ]
    }
}