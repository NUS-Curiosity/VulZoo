{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2024-9594",
        "ASSIGNER": "security@kubernetes.io",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "A security issue was discovered in the Kubernetes Image Builder versions <= v0.1.37 where default credentials are enabled during the image build process\u00a0when using the Nutanix, OVA, QEMU or raw providers. The credentials can be used to gain root access. The credentials are disabled at the conclusion of the image build process. Kubernetes clusters are only affected if their nodes use VM images created via the Image Builder project. Because these images were vulnerable during the image build process, they are affected only if an attacker was able to reach the VM where the image build was happening and used the vulnerability to modify the image at the time the image build was occurring."
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-798 Use of Hard-coded Credentials",
                        "cweId": "CWE-798"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "Kubernetes",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Image Builder",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "not down converted",
                                            "x_cve_json_5_version_data": {
                                                "versions": [
                                                    {
                                                        "status": "affected",
                                                        "version": "0",
                                                        "lessThanOrEqual": "0.1.37",
                                                        "versionType": "semver"
                                                    },
                                                    {
                                                        "status": "unaffected",
                                                        "version": "0.1.38"
                                                    }
                                                ],
                                                "defaultStatus": "unaffected"
                                            }
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "https://github.com/kubernetes/kubernetes/issues/128007",
                "refsource": "MISC",
                "name": "https://github.com/kubernetes/kubernetes/issues/128007"
            },
            {
                "url": "https://github.com/kubernetes-sigs/image-builder/pull/1596",
                "refsource": "MISC",
                "name": "https://github.com/kubernetes-sigs/image-builder/pull/1596"
            },
            {
                "url": "https://groups.google.com/g/kubernetes-security-announce/c/UKJG-oZogfA/m/Lu1hcnHmAQAJ",
                "refsource": "MISC",
                "name": "https://groups.google.com/g/kubernetes-security-announce/c/UKJG-oZogfA/m/Lu1hcnHmAQAJ"
            }
        ]
    },
    "generator": {
        "engine": "Vulnogram 0.2.0"
    },
    "source": {
        "discovery": "EXTERNAL"
    },
    "solution": [
        {
            "lang": "en",
            "value": "Rebuild any affected images using a fixed version of Image Builder. Re-deploy the fixed images to any affected VMs.",
            "supportingMedia": [
                {
                    "type": "text/html",
                    "base64": false,
                    "value": "<p>Rebuild any affected images using a fixed version of Image Builder. Re-deploy the fixed images to any affected VMs.</p>"
                }
            ]
        }
    ],
    "credits": [
        {
            "lang": "en",
            "value": "Nicolai Rybnikar @rybnico from Rybnikar Enterprises GmbH."
        }
    ],
    "impact": {
        "cvss": [
            {
                "version": "3.1",
                "attackVector": "ADJACENT_NETWORK",
                "attackComplexity": "HIGH",
                "privilegesRequired": "HIGH",
                "userInteraction": "REQUIRED",
                "scope": "UNCHANGED",
                "confidentialityImpact": "HIGH",
                "integrityImpact": "HIGH",
                "availabilityImpact": "HIGH",
                "baseSeverity": "MEDIUM",
                "baseScore": 6.3,
                "vectorString": "CVSS:3.1/AV:A/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:H"
            }
        ]
    }
}