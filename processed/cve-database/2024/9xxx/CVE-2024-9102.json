{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2024-9102",
        "ASSIGNER": "vulnerability@ncsc.ch",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "phpLDAPadmin since at least version 1.2.0 through the latest version 1.2.6.7 allows users to export elements from the LDAP directory into a Comma-Separated Value (CSV) file, but it does not neutralize special elements that could be interpreted as a command when the file is opened by a spreadsheet product. Thus, this could lead to CSV Formula Injection."
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-1236 Improper Neutralization of Formula Elements in a CSV File",
                        "cweId": "CWE-1236"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "phpLDAPadmin",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "phpLDAPadmin",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "not down converted",
                                            "x_cve_json_5_version_data": {
                                                "versions": [
                                                    {
                                                        "status": "affected",
                                                        "version": "1.2.0"
                                                    },
                                                    {
                                                        "status": "affected",
                                                        "version": "1.2.6.7"
                                                    }
                                                ],
                                                "defaultStatus": "affected"
                                            }
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "https://www.redguard.ch/blog/2024/12/19/security-advisory-phpldapadmin/",
                "refsource": "MISC",
                "name": "https://www.redguard.ch/blog/2024/12/19/security-advisory-phpldapadmin/"
            },
            {
                "url": "https://github.com/leenooks/phpLDAPadmin/commit/ea17aadef46fd29850160987fe7740ceed1381ad#diff-93b9f3e6d4c5bdacf469ea0ec74c1e9217ca6272da9be5a1bfd711f7da16f9e3R240",
                "refsource": "MISC",
                "name": "https://github.com/leenooks/phpLDAPadmin/commit/ea17aadef46fd29850160987fe7740ceed1381ad#diff-93b9f3e6d4c5bdacf469ea0ec74c1e9217ca6272da9be5a1bfd711f7da16f9e3R240"
            },
            {
                "url": "https://sourceforge.net/projects/phpldapadmin/files/phpldapadmin-php5/1.2.0",
                "refsource": "MISC",
                "name": "https://sourceforge.net/projects/phpldapadmin/files/phpldapadmin-php5/1.2.0"
            }
        ]
    },
    "generator": {
        "engine": "Vulnogram 0.2.0"
    },
    "source": {
        "discovery": "EXTERNAL"
    },
    "work_around": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "It is advised that the Office settings in clients are configured in such a way that&nbsp;Dynamic Data Exchange (DDE) is disabled."
                }
            ],
            "value": "It is advised that the Office settings in clients are configured in such a way that\u00a0Dynamic Data Exchange (DDE) is disabled."
        }
    ],
    "solution": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "It is recommended that control characters at the beginning of character strings in cells are filtered before CSV export in order to avoid formula injection. As such functions always start with one of the following characters, these can be filtered specifically:<br>- Equal (<tt>=</tt>)<br>- Plus (<tt>+</tt>)<br>- Minus (<tt>-</tt>)<br>- At (<tt>@</tt>)<br>- Tab (<tt>0x09</tt>)<br>- Carriage return (<tt>0x0D</tt>)<br><br>When filtering these special characters, care should be taken to ensure that not only the special characters in the first position are removed (for example in <tt>+-@=cmd|' /C calc.exe'!'A1'</tt>). Instead, all leading special characters up to the first legitimate character should be removed.<br><br>As an alternative to the above-mentioned filtering, OWASP suggests also another sanitization method which includes three steps (<a target=\"_blank\" rel=\"nofollow\" href=\"https://owasp.org/www-community/attacks/CSV_Injection\">https://owasp.org/www-community/attacks/CSV_Injection</a>).<br>"
                }
            ],
            "value": "It is recommended that control characters at the beginning of character strings in cells are filtered before CSV export in order to avoid formula injection. As such functions always start with one of the following characters, these can be filtered specifically:\n- Equal (=)\n- Plus (+)\n- Minus (-)\n- At (@)\n- Tab (0x09)\n- Carriage return (0x0D)\n\nWhen filtering these special characters, care should be taken to ensure that not only the special characters in the first position are removed (for example in +-@=cmd|' /C calc.exe'!'A1'). Instead, all leading special characters up to the first legitimate character should be removed.\n\nAs an alternative to the above-mentioned filtering, OWASP suggests also another sanitization method which includes three steps ( https://owasp.org/www-community/attacks/CSV_Injection )."
        }
    ],
    "credits": [
        {
            "lang": "en",
            "value": "Andreas Pfefferle, Redguard AG"
        }
    ]
}