{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2024-8687",
        "ASSIGNER": "psirt@paloaltonetworks.com",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "An information exposure vulnerability exists in Palo Alto Networks PAN-OS software that enables a GlobalProtect end user to learn both the configured GlobalProtect uninstall password and the configured disable or disconnect passcode. After the password or passcode is known, end users can uninstall, disable, or disconnect GlobalProtect even if the GlobalProtect app configuration would not normally permit them to do so."
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-497 Exposure of Sensitive System Information to an Unauthorized Control Sphere",
                        "cweId": "CWE-497"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "Palo Alto Networks",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "PAN-OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "not down converted",
                                            "x_cve_json_5_version_data": {
                                                "versions": [
                                                    {
                                                        "status": "unaffected",
                                                        "version": "11.1.0"
                                                    },
                                                    {
                                                        "status": "unaffected",
                                                        "version": "11.2.0"
                                                    },
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "11.0.1",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "11.0.1",
                                                        "status": "affected",
                                                        "version": "11.0.0",
                                                        "versionType": "custom"
                                                    },
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "10.2.4",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "10.2.4",
                                                        "status": "affected",
                                                        "version": "10.2.0",
                                                        "versionType": "custom"
                                                    },
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "10.1.9",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "10.1.9",
                                                        "status": "affected",
                                                        "version": "10.1.0",
                                                        "versionType": "custom"
                                                    },
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "10.0.12",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "10.0.12",
                                                        "status": "affected",
                                                        "version": "10.0.0",
                                                        "versionType": "custom"
                                                    },
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "9.1.16",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "9.1.16",
                                                        "status": "affected",
                                                        "version": "9.1.0",
                                                        "versionType": "custom"
                                                    },
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "9.0.17",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "9.0.17",
                                                        "status": "affected",
                                                        "version": "9.0.0",
                                                        "versionType": "custom"
                                                    },
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "8.1.25",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "8.1.25",
                                                        "status": "affected",
                                                        "version": "8.1.0",
                                                        "versionType": "custom"
                                                    }
                                                ],
                                                "defaultStatus": "unaffected"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "GlobalProtect App",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "not down converted",
                                            "x_cve_json_5_version_data": {
                                                "versions": [
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "5.1.12",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "5.1.12",
                                                        "status": "affected",
                                                        "version": "5.1.0",
                                                        "versionType": "custom"
                                                    },
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "5.2.13",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "5.2.13",
                                                        "status": "affected",
                                                        "version": "5.2.0",
                                                        "versionType": "custom"
                                                    },
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "6.0.7",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "6.0.7",
                                                        "status": "affected",
                                                        "version": "6.0.0",
                                                        "versionType": "custom"
                                                    },
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "6.1.2",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "6.1.2",
                                                        "status": "affected",
                                                        "version": "6.1.0",
                                                        "versionType": "custom"
                                                    },
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "6.2.1",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "6.2.1",
                                                        "status": "affected",
                                                        "version": "6.2.0",
                                                        "versionType": "custom"
                                                    },
                                                    {
                                                        "status": "unaffected",
                                                        "version": "6.3.0"
                                                    }
                                                ],
                                                "defaultStatus": "unaffected"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Cloud NGFW",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "not down converted",
                                            "x_cve_json_5_version_data": {
                                                "versions": [
                                                    {
                                                        "status": "unaffected",
                                                        "version": "All"
                                                    }
                                                ],
                                                "defaultStatus": "unaffected"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Prisma Access",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "not down converted",
                                            "x_cve_json_5_version_data": {
                                                "versions": [
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "10.2.9 on PAN-OS",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "10.2.9 on PAN-OS",
                                                        "status": "affected",
                                                        "version": "10.2.0",
                                                        "versionType": "custom"
                                                    }
                                                ],
                                                "defaultStatus": "unaffected"
                                            }
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "https://security.paloaltonetworks.com/CVE-2024-8687",
                "refsource": "MISC",
                "name": "https://security.paloaltonetworks.com/CVE-2024-8687"
            }
        ]
    },
    "generator": {
        "engine": "Vulnogram 0.1.0-dev"
    },
    "source": {
        "defect": [
            "PAN-204689",
            "GPC-16848"
        ],
        "discovery": "EXTERNAL"
    },
    "configuration": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "Impacted systems are those on which any of the following features are enabled:<br>* Network &gt; GlobalProtect &gt; Portals &gt;  &gt; Agent &gt;  &gt; App &gt; Allow User to Disable GlobalProtect App &gt; Allow with Passcode<br>* Network &gt; GlobalProtect &gt; Portals &gt;  &gt; Agent &gt;  &gt; App &gt; Allow user to disconnect GlobalProtect App &gt; Allow with Passcode<br>* Network &gt; GlobalProtect &gt; Portals &gt;  &gt; Agent &gt;  &gt; App &gt; Allow User to Uninstall GlobalProtect App &gt; Allow with Password"
                }
            ],
            "value": "Impacted systems are those on which any of the following features are enabled:\n* Network > GlobalProtect > Portals >  > Agent >  > App > Allow User to Disable GlobalProtect App > Allow with Passcode\n* Network > GlobalProtect > Portals >  > Agent >  > App > Allow user to disconnect GlobalProtect App > Allow with Passcode\n* Network > GlobalProtect > Portals >  > Agent >  > App > Allow User to Uninstall GlobalProtect App > Allow with Password"
        }
    ],
    "work_around": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "Change the following two settings (if enabled) to \"Allow with Ticket\":<br>* Network &gt; GlobalProtect &gt; Portals &gt;  &gt; Agent &gt;  &gt; App &gt; Allow User to Disable GlobalProtect App<br>* Network &gt; GlobalProtect &gt; Portals &gt;  &gt; Agent &gt;  &gt; App &gt; Allow user to disconnect GlobalProtect App<br><br>Change the following setting (if enabled) to \"Disallow\":<br>* Network &gt; GlobalProtect &gt; Portals &gt;  &gt; Agent &gt;  &gt; App &gt; Allow User to Uninstall GlobalProtect App<br>"
                }
            ],
            "value": "Change the following two settings (if enabled) to \"Allow with Ticket\":\n* Network > GlobalProtect > Portals >  > Agent >  > App > Allow User to Disable GlobalProtect App\n* Network > GlobalProtect > Portals >  > Agent >  > App > Allow user to disconnect GlobalProtect App\n\nChange the following setting (if enabled) to \"Disallow\":\n* Network > GlobalProtect > Portals >  > Agent >  > App > Allow User to Uninstall GlobalProtect App"
        }
    ],
    "exploit": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "Palo Alto Networks is not aware of any malicious exploitation of this issue.<br>"
                }
            ],
            "value": "Palo Alto Networks is not aware of any malicious exploitation of this issue."
        }
    ],
    "solution": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "This issue is fixed in PAN-OS 8.1.25, PAN-OS 9.0.17, PAN-OS 9.1.16, PAN-OS 10.0.12, PAN-OS 10.1.9, PAN-OS 10.2.4, PAN-OS 11.0.1, and all later PAN-OS versions. It is also fixed in Prisma Access 10.2.9 and all later Prisma Access versions. To maintain GlobalProtect app functionality for the vulnerable features, we released a corresponding software update for GlobalProtect app 5.1.12, GlobalProtect app 5.2.13, GlobalProtect app 6.0.7, GlobalProtect app 6.1.2, and GlobalProtect app 6.2.1, and all later GlobalProtect app versions.<br><br>To maintain the ability for end users to use the uninstall password feature and the disable or disconnect passcode feature, you must ensure that you upgrade all GlobalProtect app deployments to a fixed version before you upgrade your PAN-OS software to a fixed version.<br><br>All fixed versions of GlobalProtect are backwards compatible with vulnerable versions of PAN-OS software. However, fixed versions of PAN-OS software are not backwards compatible with vulnerable versions of GlobalProtect.<br><br>You can find additional information for PAN-204689 here: <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-release-notes/pan-os-11-1-0-known-and-addressed-issues/pan-os-11-1-0-known-issues\">https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-release-notes/pan-os-11-1-0-known-and-addressed-issues/pan-os-11-1-0-known-issues</a>\n\nPrisma Access customers can open a support case to request an upgrade.<br>"
                }
            ],
            "value": "This issue is fixed in PAN-OS 8.1.25, PAN-OS 9.0.17, PAN-OS 9.1.16, PAN-OS 10.0.12, PAN-OS 10.1.9, PAN-OS 10.2.4, PAN-OS 11.0.1, and all later PAN-OS versions. It is also fixed in Prisma Access 10.2.9 and all later Prisma Access versions. To maintain GlobalProtect app functionality for the vulnerable features, we released a corresponding software update for GlobalProtect app 5.1.12, GlobalProtect app 5.2.13, GlobalProtect app 6.0.7, GlobalProtect app 6.1.2, and GlobalProtect app 6.2.1, and all later GlobalProtect app versions.\n\nTo maintain the ability for end users to use the uninstall password feature and the disable or disconnect passcode feature, you must ensure that you upgrade all GlobalProtect app deployments to a fixed version before you upgrade your PAN-OS software to a fixed version.\n\nAll fixed versions of GlobalProtect are backwards compatible with vulnerable versions of PAN-OS software. However, fixed versions of PAN-OS software are not backwards compatible with vulnerable versions of GlobalProtect.\n\nYou can find additional information for PAN-204689 here:  https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-release-notes/pan-os-11-1-0-known-and-addressed-issues/pan-os-11-1-0-known-issues \n\nPrisma Access customers can open a support case to request an upgrade."
        }
    ],
    "credits": [
        {
            "lang": "en",
            "value": "Claudiu Pancotan"
        }
    ]
}