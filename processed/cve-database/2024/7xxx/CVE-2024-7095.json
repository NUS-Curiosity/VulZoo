{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2024-7095",
        "ASSIGNER": "psirt@arista.com",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "On affected platforms running Arista EOS with SNMP configured, if \u201csnmp-server transmit max-size\u201d is configured, under some circumstances a specially crafted packet can cause the snmpd process to leak memory. This may result in the snmpd process being terminated (causing SNMP requests to time out until snmpd is restarted) and memory pressure for other processes on the switch. Increased memory pressure can cause processes other than snmpd to be at risk for unexpected termination as well."
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "cwe-401"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "Arista Networks",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "EOS",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<=",
                                            "version_name": "4.32.0F",
                                            "version_value": "4.32.2F"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "4.31.0M",
                                            "version_value": "4.31.4M"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "4.30.0M",
                                            "version_value": "4.30.7M"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "4.29.0"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "4.28.0"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "4.27.0"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "4.26.0"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "4.25.0"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "4.24.0"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "4.23.0"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "4.22.0"
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "https://www.arista.com/en/support/advisories-notices/security-advisory/20650-security-advisory-0107",
                "refsource": "MISC",
                "name": "https://www.arista.com/en/support/advisories-notices/security-advisory/20650-security-advisory-0107"
            }
        ]
    },
    "generator": {
        "engine": "Vulnogram 0.2.0"
    },
    "source": {
        "advisory": "107",
        "defect": [
            "BUG974415"
        ],
        "discovery": "INTERNAL"
    },
    "configuration": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>In order to be vulnerable to CVE-2024-7095, the following conditions must be met:</p><ol><li>SNMP must be configured, and</li><li>\u201c<b>snmp-server transmit max-size</b>\u201d must be configured</li></ol><p>If the necessary configurations are present, <b>show snmp</b>&nbsp;output will look something like below, where <b>Transmit message maximum size</b>&nbsp;will contain a number smaller than the default of 65536:</p><pre>switch&gt;show snmp\nChassis: None\n0 SNMP packets input\n&nbsp; &nbsp; 0 Bad SNMP version errors\n&nbsp; &nbsp; 0 Unknown community name\n&nbsp; &nbsp; 0 Illegal operation for community name supplied\n&nbsp; &nbsp; 0 Encoding errors\n&nbsp; &nbsp; 0 Number of requested variables\n&nbsp; &nbsp; 0 Number of altered variables\n&nbsp; &nbsp; 0 Get-request PDUs\n&nbsp; &nbsp; 0 Get-next PDUs\n&nbsp; &nbsp; 0 Set-request PDUs\n0 SNMP packets output\n&nbsp; &nbsp; 0 Too big errors\n&nbsp; &nbsp; 0 No such name errors\n&nbsp; &nbsp; 0 Bad value errors\n&nbsp; &nbsp; 0 General errors\n&nbsp; &nbsp; 0 Response PDUs\n&nbsp; &nbsp; 0 Trap PDUs\n&nbsp; &nbsp; 0 Trap drops\nAccess Control\n&nbsp; &nbsp; 0 Users\n&nbsp; &nbsp; 0 Groups\n&nbsp; &nbsp; 0 Views\nSNMP logging: disabled\n<span style=\"background-color: rgb(255, 255, 0);\">SNMP agent enabled in VRFs: default\nTransmit message maximum size: 1500</span>\n</pre><div>&nbsp;</div><p>If SNMP is not configured there is no exposure to this issue and the <b>show snmp</b>&nbsp;output will look something like:</p><pre>switch&gt;show snmp\nChassis: XXXXXXXXXXX\nSNMP agent enabled in VRFs: default\nTransmit message maximum size: 65536\n<span style=\"background-color: rgb(255, 255, 0);\">SNMP agent disabled:</span> Either no communities and no users are configured, or no VRFs are configured.\n</pre><div>&nbsp;</div><p>If the <b>transmit max-size</b>&nbsp;is not configured there is no exposure to this issue and even if SNMP is configured, the <b>show snmp</b>&nbsp;output will look something like:</p><pre>switch&gt;show snmp\nChassis: None\n0 SNMP packets input\n&nbsp; &nbsp; 0 Bad SNMP version errors\n&nbsp; &nbsp; 0 Unknown community name\n&nbsp; &nbsp; 0 Illegal operation for community name supplied\n&nbsp; &nbsp; 0 Encoding errors\n&nbsp; &nbsp; 0 Number of requested variables\n&nbsp; &nbsp; 0 Number of altered variables\n&nbsp; &nbsp; 0 Get-request PDUs\n&nbsp; &nbsp; 0 Get-next PDUs\n&nbsp; &nbsp; 0 Set-request PDUs\n0 SNMP packets output\n&nbsp; &nbsp; 0 Too big errors\n&nbsp; &nbsp; 0 No such name errors\n&nbsp; &nbsp; 0 Bad value errors\n&nbsp; &nbsp; 0 General errors\n&nbsp; &nbsp; 0 Response PDUs\n&nbsp; &nbsp; 0 Trap PDUs\n&nbsp; &nbsp; 0 Trap drops\nAccess Control\n&nbsp; &nbsp; 0 Users\n&nbsp; &nbsp; 0 Groups\n&nbsp; &nbsp; 0 Views\nSNMP logging: disabled\nSNMP agent enabled in VRFs: default\n<span style=\"background-color: rgb(255, 255, 0);\">Transmit message maximum size: 65536</span></pre><br>"
                }
            ],
            "value": "In order to be vulnerable to CVE-2024-7095, the following conditions must be met:\n\n  *  SNMP must be configured, and\n  *  \u201csnmp-server transmit max-size\u201d must be configured\nIf the necessary configurations are present, show snmp\u00a0output will look something like below, where Transmit message maximum size\u00a0will contain a number smaller than the default of 65536:\n\nswitch>show snmp\nChassis: None\n0 SNMP packets input\n\u00a0 \u00a0 0 Bad SNMP version errors\n\u00a0 \u00a0 0 Unknown community name\n\u00a0 \u00a0 0 Illegal operation for community name supplied\n\u00a0 \u00a0 0 Encoding errors\n\u00a0 \u00a0 0 Number of requested variables\n\u00a0 \u00a0 0 Number of altered variables\n\u00a0 \u00a0 0 Get-request PDUs\n\u00a0 \u00a0 0 Get-next PDUs\n\u00a0 \u00a0 0 Set-request PDUs\n0 SNMP packets output\n\u00a0 \u00a0 0 Too big errors\n\u00a0 \u00a0 0 No such name errors\n\u00a0 \u00a0 0 Bad value errors\n\u00a0 \u00a0 0 General errors\n\u00a0 \u00a0 0 Response PDUs\n\u00a0 \u00a0 0 Trap PDUs\n\u00a0 \u00a0 0 Trap drops\nAccess Control\n\u00a0 \u00a0 0 Users\n\u00a0 \u00a0 0 Groups\n\u00a0 \u00a0 0 Views\nSNMP logging: disabled\nSNMP agent enabled in VRFs: default\nTransmit message maximum size: 1500\n\n\n\u00a0\n\nIf SNMP is not configured there is no exposure to this issue and the show snmp\u00a0output will look something like:\n\nswitch>show snmp\nChassis: XXXXXXXXXXX\nSNMP agent enabled in VRFs: default\nTransmit message maximum size: 65536\nSNMP agent disabled: Either no communities and no users are configured, or no VRFs are configured.\n\n\n\u00a0\n\nIf the transmit max-size\u00a0is not configured there is no exposure to this issue and even if SNMP is configured, the show snmp\u00a0output will look something like:\n\nswitch>show snmp\nChassis: None\n0 SNMP packets input\n\u00a0 \u00a0 0 Bad SNMP version errors\n\u00a0 \u00a0 0 Unknown community name\n\u00a0 \u00a0 0 Illegal operation for community name supplied\n\u00a0 \u00a0 0 Encoding errors\n\u00a0 \u00a0 0 Number of requested variables\n\u00a0 \u00a0 0 Number of altered variables\n\u00a0 \u00a0 0 Get-request PDUs\n\u00a0 \u00a0 0 Get-next PDUs\n\u00a0 \u00a0 0 Set-request PDUs\n0 SNMP packets output\n\u00a0 \u00a0 0 Too big errors\n\u00a0 \u00a0 0 No such name errors\n\u00a0 \u00a0 0 Bad value errors\n\u00a0 \u00a0 0 General errors\n\u00a0 \u00a0 0 Response PDUs\n\u00a0 \u00a0 0 Trap PDUs\n\u00a0 \u00a0 0 Trap drops\nAccess Control\n\u00a0 \u00a0 0 Users\n\u00a0 \u00a0 0 Groups\n\u00a0 \u00a0 0 Views\nSNMP logging: disabled\nSNMP agent enabled in VRFs: default\nTransmit message maximum size: 65536"
        }
    ],
    "work_around": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>The workaround is to disable <b>snmp-server transmit max-size</b>&nbsp;configuration:</p><pre>no snmp-server transmit max-size</pre><br>"
                }
            ],
            "value": "The workaround is to disable snmp-server transmit max-size\u00a0configuration:\n\nno snmp-server transmit max-size"
        }
    ],
    "solution": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>The recommended resolution is to upgrade to a remediated software version at your earliest convenience. Arista recommends customers move to the latest version of each release that contains all the fixes listed below. For more information about upgrading see <a target=\"_blank\" rel=\"nofollow\" href=\"https://www.arista.com/en/um-eos/eos-upgrades-and-downgrades\">EOS User Manual: Upgrades and Downgrades</a></p><div>&nbsp;</div><div>CVE-2024-7095 has been fixed in the following releases:</div><ul><li>4.32.3M and later releases in the 4.32.x train</li><li>4.31.5M and later releases in the 4.31.x train</li><li>4.30.8M and later releases in the 4.30.x train</li></ul><br>"
                }
            ],
            "value": "The recommended resolution is to upgrade to a remediated software version at your earliest convenience. Arista recommends customers move to the latest version of each release that contains all the fixes listed below. For more information about upgrading see  EOS User Manual: Upgrades and Downgrades https://www.arista.com/en/um-eos/eos-upgrades-and-downgrades \n\n\u00a0\n\nCVE-2024-7095 has been fixed in the following releases:\n\n  *  4.32.3M and later releases in the 4.32.x train\n  *  4.31.5M and later releases in the 4.31.x train\n  *  4.30.8M and later releases in the 4.30.x train"
        }
    ],
    "impact": {
        "cvss": [
            {
                "attackComplexity": "LOW",
                "attackVector": "NETWORK",
                "availabilityImpact": "LOW",
                "baseScore": 4.3,
                "baseSeverity": "MEDIUM",
                "confidentialityImpact": "NONE",
                "integrityImpact": "NONE",
                "privilegesRequired": "LOW",
                "scope": "UNCHANGED",
                "userInteraction": "NONE",
                "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L",
                "version": "3.1"
            }
        ]
    }
}