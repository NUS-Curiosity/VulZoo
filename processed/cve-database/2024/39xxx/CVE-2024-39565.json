{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2024-39565",
        "ASSIGNER": "sirt@juniper.net",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "An Improper Neutralization of Data within XPath Expressions ('XPath Injection') vulnerability in J-Web shipped with Juniper Networks Junos OS allows an unauthenticated, network-based attacker to\u00a0execute\u00a0remote commands on the target device.\u00a0\n\nWhile an administrator is logged into a J-Web session or has previously logged in and subsequently logged out of their J-Web session, the attacker can arbitrarily execute commands on the target device with the other user's credentials. In the worst case, the attacker will have full control over the device.\nThis issue affects Junos OS:\u00a0\n\n\n\n  *  All versions before 21.2R3-S8,\u00a0\n  *  from 21.4 before 21.4R3-S7,\n  *  from 22.2 before 22.2R3-S4,\n  *  from 22.3 before 22.3R3-S3,\n  *  from 22.4 before 22.4R3-S2,\n  *  from 23.2 before 23.2R2,\n  *  from 23.4 before 23.4R1-S1, 23.4R2."
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-643 Improper Neutralization of Data within XPath Expressions ('XPath Injection')",
                        "cweId": "CWE-643"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "Juniper Networks, Inc.",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "0",
                                            "version_value": "21.2R3-S8"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "21.4",
                                            "version_value": "21.4R3-S7"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "22.2",
                                            "version_value": "22.2R3-S4"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "22.3",
                                            "version_value": "22.3R3-S3"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "22.4",
                                            "version_value": "22.4R3-S2"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "23.2",
                                            "version_value": "23.2R2"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "23.4",
                                            "version_value": "23.4R1-S1, 23.4R2"
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "https://supportportal.juniper.net/JSA83023",
                "refsource": "MISC",
                "name": "https://supportportal.juniper.net/JSA83023"
            },
            {
                "url": "https://www.first.org/cvss/calculator/v4-0#CVSS:4.0/AV:N/AC:H/AT:P/PR:N/UI:P/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N/E:P/AU:Y/R:I/V:C/RE:L/U:Amber",
                "refsource": "MISC",
                "name": "https://www.first.org/cvss/calculator/v4-0#CVSS:4.0/AV:N/AC:H/AT:P/PR:N/UI:P/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N/E:P/AU:Y/R:I/V:C/RE:L/U:Amber"
            },
            {
                "url": "https://support.juniper.net/support/downloads/?p=283",
                "refsource": "MISC",
                "name": "https://support.juniper.net/support/downloads/?p=283"
            }
        ]
    },
    "generator": {
        "engine": "Vulnogram 0.1.0-dev"
    },
    "source": {
        "advisory": "JSA83023",
        "defect": [
            "1786296"
        ],
        "discovery": "EXTERNAL"
    },
    "configuration": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "The following minimal configuration must be present on the device:<br><br>[system services web-management http]<br>or<br>[system services web-management https]<br><br>"
                }
            ],
            "value": "The following minimal configuration must be present on the device:\n\n[system services web-management http]\nor\n[system services web-management https]"
        }
    ],
    "work_around": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>There are no known workarounds for this issue other than disabling J-Web when not in use. </p><p>Juniper Networks has written an effective countermeasure for this attack at IDP Signature SigPack #3675 onward, released on 07 February 2024. The signature \u201cHTTP:PHP:LAUNCHPAD-CMD-INJ\u201d will identify and block the attack. For best effect, customers may deploy this signature on devices where J-Web is not used.</p>"
                }
            ],
            "value": "There are no known workarounds for this issue other than disabling J-Web when not in use. \n\nJuniper Networks has written an effective countermeasure for this attack at IDP Signature SigPack #3675 onward, released on 07 February 2024. The signature \u201cHTTP:PHP:LAUNCHPAD-CMD-INJ\u201d will identify and block the attack. For best effect, customers may deploy this signature on devices where J-Web is not used."
        },
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>Methods which may reduce, but not eliminate, the risk for exploitation of these problems, and which does not mitigate or resolve the underlying problem include:</p><p>\u2022 Deploying the appropriate IDP Signature on devices which do not have J-Web enabled which protect the device downstream which requires J-Web to be enabled.</p><p>\u2022 Disabling J-Web and using only alternate options such as Netconf over SSH for device management</p><p>\u2022 Restricting the use of J-Web to low-privileged accounts only</p><p>In addition to the recommendations listed above, it is good security practice to limit the exploitable attack surface of critical infrastructure networking equipment. Use access lists or firewall filters to limit access to the device only from trusted, administrative networks or hosts.</p>"
                }
            ],
            "value": "Methods which may reduce, but not eliminate, the risk for exploitation of these problems, and which does not mitigate or resolve the underlying problem include:\n\n\u2022 Deploying the appropriate IDP Signature on devices which do not have J-Web enabled which protect the device downstream which requires J-Web to be enabled.\n\n\u2022 Disabling J-Web and using only alternate options such as Netconf over SSH for device management\n\n\u2022 Restricting the use of J-Web to low-privileged accounts only\n\nIn addition to the recommendations listed above, it is good security practice to limit the exploitable attack surface of critical infrastructure networking equipment. Use access lists or firewall filters to limit access to the device only from trusted, administrative networks or hosts."
        }
    ],
    "exploit": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
                }
            ],
            "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
        }
    ],
    "solution": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "The following software releases have been updated to resolve this specific issue: 21.2R3-S8, 21.4R3-S7, 22.2R3-S4, 22.3R3-S3, 22.4R3-S2, 23.2R2, 23.4R1-S1, 23.4R2, 24.2R1, and all subsequent releases."
                }
            ],
            "value": "The following software releases have been updated to resolve this specific issue: 21.2R3-S8, 21.4R3-S7, 22.2R3-S4, 22.3R3-S3, 22.4R3-S2, 23.2R2, 23.4R1-S1, 23.4R2, 24.2R1, and all subsequent releases."
        }
    ],
    "credits": [
        {
            "lang": "en",
            "value": "Juniper SIRT would like to acknowledge and thank CataLpa of Hatlab, DbappSecurity Co. Ltd. for responsibly reporting this vulnerability."
        }
    ],
    "impact": {
        "cvss": [
            {
                "attackComplexity": "LOW",
                "attackVector": "NETWORK",
                "availabilityImpact": "HIGH",
                "baseScore": 8.8,
                "baseSeverity": "HIGH",
                "confidentialityImpact": "HIGH",
                "integrityImpact": "HIGH",
                "privilegesRequired": "NONE",
                "scope": "UNCHANGED",
                "userInteraction": "REQUIRED",
                "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
                "version": "3.1"
            }
        ]
    }
}