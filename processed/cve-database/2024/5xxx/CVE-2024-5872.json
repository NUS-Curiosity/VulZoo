{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2024-5872",
        "ASSIGNER": "psirt@arista.com",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "On affected platforms running Arista EOS, a specially crafted packet with incorrect VLAN tag might be copied to CPU, which may cause incorrect control plane behavior related to the packet, such as route flaps, multicast routes learnt, etc."
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "cwe-346"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "Arista Networks",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "EOS",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<=",
                                            "version_name": "4.32.0F",
                                            "version_value": "4.32.2F"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "4.31.0M",
                                            "version_value": "4.31.4M"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "4.30.0M",
                                            "version_value": "4.30.7M"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "4.29.0M",
                                            "version_value": "4.29.8M"
                                        },
                                        {
                                            "version_affected": "<=",
                                            "version_name": "4.28.1F",
                                            "version_value": "4.28.11F"
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "https://www.arista.com/en/support/advisories-notices/security-advisory/20649-security-advisory-0106",
                "refsource": "MISC",
                "name": "https://www.arista.com/en/support/advisories-notices/security-advisory/20649-security-advisory-0106"
            }
        ]
    },
    "generator": {
        "engine": "Vulnogram 0.2.0"
    },
    "source": {
        "advisory": "106",
        "defect": [
            "BUG 884202"
        ],
        "discovery": "INTERNAL"
    },
    "configuration": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>There are multiple conditions which must be met. An L3 interface must be configured on the device and at least one of four additional conditions, detailed below and labeled 1 through 4, must be met. In addition to the configuration the packet being sent must have an incorrect VLAN tag.</p><p>In order to be vulnerable to CVE-2024-5872, an L3 interface MUST be configured on the device.</p><p>To check IPv4 L3 interface configuration:</p><pre>Switch&gt;show ip interface brief\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Address\nInterface &nbsp; &nbsp; IP Address &nbsp; &nbsp; &nbsp; &nbsp; Status  &nbsp; Protocol &nbsp; &nbsp; MTU &nbsp; Owner\n------------- ------------------ --------- ---------- ------ -------\nEthernet5/1 &nbsp; 5.1.1.1/24 &nbsp; &nbsp; &nbsp; &nbsp; up  &nbsp; &nbsp; &nbsp; up  &nbsp; &nbsp; &nbsp; &nbsp; 1500\nManagement1 &nbsp; 10.240.112.30/25 &nbsp; up  &nbsp; &nbsp; &nbsp; up  &nbsp; &nbsp; &nbsp; &nbsp; 1500\nVlan4 &nbsp; &nbsp; &nbsp; &nbsp; 4.1.1.1/24 &nbsp; &nbsp; &nbsp; &nbsp; up  &nbsp; &nbsp; &nbsp; up  &nbsp; &nbsp; &nbsp; &nbsp; 1500\n</pre><div>&nbsp;</div><p>To check IPv6 L3 interface configuration:</p><pre>Switch&gt;show ipv6 interface brief\nInterface  Status  MTU IPv6 Address  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Addr State Addr Source\n--------- ------- ---- ----------------------- ---------- -----------\nMa1  &nbsp; &nbsp; &nbsp; up &nbsp; &nbsp; 1500 fe80::d3ff:fe5f:73e9/64 up &nbsp; &nbsp; &nbsp; &nbsp; link local\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;fdfd:5c41:712d::701e/64 up &nbsp; &nbsp; &nbsp; &nbsp; config\nVl4  &nbsp; &nbsp; &nbsp; up &nbsp; &nbsp; 1500 fe80::d3ff:fe5f:73ea/64 up &nbsp; &nbsp; &nbsp; &nbsp; link local\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;120::1/120  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; up &nbsp; &nbsp; &nbsp; &nbsp; config\n</pre><div>&nbsp;</div><div>AND</div><p>At least one of the following conditions (#\u2019s 1-4 below) must be met:</p><ol><li>Either IPv4 routing or IPv6 routing is not configured, which will cause the vulnerability to impact IPv4 unicast packets or IPv6 unicast packets, respectively:<br><pre>Switch&gt;show ip\n \n<span style=\"background-color: rgb(255, 255, 0);\">IP Routing : Disabled</span>\nIP Multicast Routing : Disabled\nIPv6 Multicast Routing : Disabled\nIPv6 Interfaces Forwarding : None\n \n<span style=\"background-color: rgb(255, 255, 0);\">IPv6 Unicast Routing : Disabled</span>\n</pre></li></ol><div>OR</div><ol><li>For packets with TTL of 0 or 1, all IP configurations are vulnerable.<br><div>&nbsp;</div></li></ol><div>OR</div><ol><li>Unicast and multicast routing must be configured for IPv4 to be vulnerable for IPv4 multicast packets, and IPv4 multicast must be enabled on an L3 interface:<br><pre>Switch&gt;show ip\n \n<span style=\"background-color: rgb(255, 255, 0);\">IP Routing : Enabled\nIP Multicast Routing : Enabled</span>\nIPv6 Multicast Routing : Disabled\nIPv6 Interfaces Forwarding : None\n<br>\nIPv6 Unicast Routing : Disabled\nSwitch(config-if-Vl4)#show active\ninterface Vlan4\n&nbsp; &nbsp;ip address 4.1.1.1/24\n&nbsp; &nbsp;<span style=\"background-color: rgb(255, 255, 0);\">pim ipv4 sparse-mode</span>\n</pre></li></ol><div>OR</div><ol><li>Unicast and multicast routing must be configured for IPv6 to be vulnerable to IPv6 multicast packets, and IPv6 multicast must be enabled on an L3 interface:<br><pre>Switch&gt;show ip\n  \nIP Routing : Disabled\nIP Multicast Routing : Disabled\n<span style=\"background-color: rgb(255, 255, 0);\">IPv6 Multicast Routing : Enabled</span>\nIPv6 Interfaces Forwarding : None\n  \n<span style=\"background-color: rgb(255, 255, 0);\">IPv6 Unicast Routing : Enabled</span>\nSwitch(config-if-Vl4)#show active\ninterface Vlan4\n&nbsp; &nbsp;ipv6 address 120::1/120\n&nbsp; &nbsp;<span style=\"background-color: rgb(255, 255, 0);\">pim ipv6 sparse-mode</span></pre></li></ol><br>"
                }
            ],
            "value": "There are multiple conditions which must be met. An L3 interface must be configured on the device and at least one of four additional conditions, detailed below and labeled 1 through 4, must be met. In addition to the configuration the packet being sent must have an incorrect VLAN tag.\n\nIn order to be vulnerable to CVE-2024-5872, an L3 interface MUST be configured on the device.\n\nTo check IPv4 L3 interface configuration:\n\nSwitch>show ip interface brief\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Address\nInterface \u00a0 \u00a0 IP Address \u00a0 \u00a0 \u00a0 \u00a0 Status  \u00a0 Protocol \u00a0 \u00a0 MTU \u00a0 Owner\n------------- ------------------ --------- ---------- ------ -------\nEthernet5/1 \u00a0 5.1.1.1/24 \u00a0 \u00a0 \u00a0 \u00a0 up  \u00a0 \u00a0 \u00a0 up  \u00a0 \u00a0 \u00a0 \u00a0 1500\nManagement1 \u00a0 10.240.112.30/25 \u00a0 up  \u00a0 \u00a0 \u00a0 up  \u00a0 \u00a0 \u00a0 \u00a0 1500\nVlan4 \u00a0 \u00a0 \u00a0 \u00a0 4.1.1.1/24 \u00a0 \u00a0 \u00a0 \u00a0 up  \u00a0 \u00a0 \u00a0 up  \u00a0 \u00a0 \u00a0 \u00a0 1500\n\n\n\u00a0\n\nTo check IPv6 L3 interface configuration:\n\nSwitch>show ipv6 interface brief\nInterface  Status  MTU IPv6 Address  \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Addr State Addr Source\n--------- ------- ---- ----------------------- ---------- -----------\nMa1  \u00a0 \u00a0 \u00a0 up \u00a0 \u00a0 1500 fe80::d3ff:fe5f:73e9/64 up \u00a0 \u00a0 \u00a0 \u00a0 link local\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0fdfd:5c41:712d::701e/64 up \u00a0 \u00a0 \u00a0 \u00a0 config\nVl4  \u00a0 \u00a0 \u00a0 up \u00a0 \u00a0 1500 fe80::d3ff:fe5f:73ea/64 up \u00a0 \u00a0 \u00a0 \u00a0 link local\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0120::1/120  \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 up \u00a0 \u00a0 \u00a0 \u00a0 config\n\n\n\u00a0\n\nAND\n\nAt least one of the following conditions (#\u2019s 1-4 below) must be met:\n\n  *  Either IPv4 routing or IPv6 routing is not configured, which will cause the vulnerability to impact IPv4 unicast packets or IPv6 unicast packets, respectively:\nSwitch>show ip\n \nIP Routing : Disabled\nIP Multicast Routing : Disabled\nIPv6 Multicast Routing : Disabled\nIPv6 Interfaces Forwarding : None\n \nIPv6 Unicast Routing : Disabled\n\n\n\nOR\n\n  *  For packets with TTL of 0 or 1, all IP configurations are vulnerable.\n\u00a0\n\n\nOR\n\n  *  Unicast and multicast routing must be configured for IPv4 to be vulnerable for IPv4 multicast packets, and IPv4 multicast must be enabled on an L3 interface:\nSwitch>show ip\n \nIP Routing : Enabled\nIP Multicast Routing : Enabled\nIPv6 Multicast Routing : Disabled\nIPv6 Interfaces Forwarding : None\n\n\nIPv6 Unicast Routing : Disabled\nSwitch(config-if-Vl4)#show active\ninterface Vlan4\n\u00a0 \u00a0ip address 4.1.1.1/24\n\u00a0 \u00a0pim ipv4 sparse-mode\n\n\n\nOR\n\n  *  Unicast and multicast routing must be configured for IPv6 to be vulnerable to IPv6 multicast packets, and IPv6 multicast must be enabled on an L3 interface:\nSwitch>show ip\n  \nIP Routing : Disabled\nIP Multicast Routing : Disabled\nIPv6 Multicast Routing : Enabled\nIPv6 Interfaces Forwarding : None\n  \nIPv6 Unicast Routing : Enabled\nSwitch(config-if-Vl4)#show active\ninterface Vlan4\n\u00a0 \u00a0ipv6 address 120::1/120\n\u00a0 \u00a0pim ipv6 sparse-mode"
        }
    ],
    "work_around": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<span style=\"background-color: rgb(255, 255, 255);\">There is no workaround.</span><br>"
                }
            ],
            "value": "There is no workaround."
        }
    ],
    "solution": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>The recommended resolution is to upgrade to a remediated software version at your earliest convenience. Arista recommends customers move to the latest version of each release that contains all the fixes listed below. For more information about upgrading see <a target=\"_blank\" rel=\"nofollow\" href=\"https://www.arista.com/en/um-eos/eos-upgrades-and-downgrades\">EOS User Manual: Upgrades and Downgrades</a></p><div>&nbsp;</div><div>CVE-2024-5872 has been fixed in the following releases:</div><ul><li>4.33.0F and later releases in the 4.33.x train</li><li>4.32.3M and later releases in the 4.32.x train</li><li>4.31.5M and later releases in the 4.31.x train</li><li>4.30.8M and later releases in the 4.30.x train</li><li>4.29.9M and later releases in the 4.29.x train</li><li>4.28.12M and later releases in the 4.28.x train</li></ul><br>"
                }
            ],
            "value": "The recommended resolution is to upgrade to a remediated software version at your earliest convenience. Arista recommends customers move to the latest version of each release that contains all the fixes listed below. For more information about upgrading see  EOS User Manual: Upgrades and Downgrades https://www.arista.com/en/um-eos/eos-upgrades-and-downgrades \n\n\u00a0\n\nCVE-2024-5872 has been fixed in the following releases:\n\n  *  4.33.0F and later releases in the 4.33.x train\n  *  4.32.3M and later releases in the 4.32.x train\n  *  4.31.5M and later releases in the 4.31.x train\n  *  4.30.8M and later releases in the 4.30.x train\n  *  4.29.9M and later releases in the 4.29.x train\n  *  4.28.12M and later releases in the 4.28.x train"
        }
    ],
    "impact": {
        "cvss": [
            {
                "attackComplexity": "LOW",
                "attackVector": "NETWORK",
                "availabilityImpact": "LOW",
                "baseScore": 6.5,
                "baseSeverity": "MEDIUM",
                "confidentialityImpact": "NONE",
                "integrityImpact": "LOW",
                "privilegesRequired": "NONE",
                "scope": "UNCHANGED",
                "userInteraction": "NONE",
                "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L",
                "version": "3.1"
            }
        ]
    }
}