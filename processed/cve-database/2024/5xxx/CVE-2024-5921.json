{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2024-5921",
        "ASSIGNER": "psirt@paloaltonetworks.com",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "An insufficient certification validation issue in the Palo Alto Networks GlobalProtect app enables attackers to connect the GlobalProtect app to arbitrary servers. This can enable a local non-administrative operating system user or an attacker on the same subnet to install malicious root certificates on the endpoint and subsequently install malicious software signed by the malicious root certificates on that endpoint.\n\nPlease subscribe to  our RSS feed https://security.paloaltonetworks.com/rss.xml  to be alerted to new updates to this and other advisories."
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-295 Improper Certificate Validation",
                        "cweId": "CWE-295"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "Palo Alto Networks",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "GlobalProtect App",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "not down converted",
                                            "x_cve_json_5_version_data": {
                                                "versions": [
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "6.3.2",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "6.3.2",
                                                        "status": "affected",
                                                        "version": "6.3.0",
                                                        "versionType": "custom"
                                                    },
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "6.2.6",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "6.2.6",
                                                        "status": "affected",
                                                        "version": "6.2.0",
                                                        "versionType": "custom"
                                                    },
                                                    {
                                                        "status": "affected",
                                                        "version": "6.1.0",
                                                        "versionType": "custom"
                                                    }
                                                ],
                                                "defaultStatus": "unaffected"
                                            }
                                        },
                                        {
                                            "version_value": "not down converted",
                                            "x_cve_json_5_version_data": {
                                                "versions": [
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "6.3.2",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "6.3.2",
                                                        "status": "affected",
                                                        "version": "6.3.0",
                                                        "versionType": "custom"
                                                    },
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "6.2.6-c857",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "6.2.6-c857",
                                                        "status": "affected",
                                                        "version": "6.2.0",
                                                        "versionType": "custom"
                                                    },
                                                    {
                                                        "status": "affected",
                                                        "version": "6.1.0",
                                                        "versionType": "custom"
                                                    }
                                                ],
                                                "defaultStatus": "unaffected"
                                            }
                                        },
                                        {
                                            "version_value": "not down converted",
                                            "x_cve_json_5_version_data": {
                                                "versions": [
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "6.2.1-c31",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "6.2.1-c31",
                                                        "status": "affected",
                                                        "version": "6.2.0",
                                                        "versionType": "custom"
                                                    },
                                                    {
                                                        "status": "affected",
                                                        "version": "6.1.0",
                                                        "versionType": "custom"
                                                    }
                                                ],
                                                "defaultStatus": "unaffected"
                                            }
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "6.1.0",
                                            "version_value": "6.1.6"
                                        },
                                        {
                                            "version_value": "not down converted",
                                            "x_cve_json_5_version_data": {
                                                "versions": [
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "6.1.7",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "6.1.7",
                                                        "status": "affected",
                                                        "version": "6.1.0",
                                                        "versionType": "custom"
                                                    }
                                                ],
                                                "defaultStatus": "unaffected"
                                            }
                                        },
                                        {
                                            "version_value": "not down converted",
                                            "x_cve_json_5_version_data": {
                                                "versions": [
                                                    {
                                                        "status": "unaffected",
                                                        "version": "6.0.0",
                                                        "versionType": "custom"
                                                    },
                                                    {
                                                        "status": "unaffected",
                                                        "version": "5.1.0",
                                                        "versionType": "custom"
                                                    }
                                                ],
                                                "defaultStatus": "unaffected"
                                            }
                                        },
                                        {
                                            "version_value": "not down converted",
                                            "x_cve_json_5_version_data": {
                                                "versions": [
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "6.2.6",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "6.2.6",
                                                        "status": "affected",
                                                        "version": "6.2.0",
                                                        "versionType": "custom"
                                                    }
                                                ],
                                                "defaultStatus": "unaffected"
                                            }
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "https://security.paloaltonetworks.com/CVE-2024-5921",
                "refsource": "MISC",
                "name": "https://security.paloaltonetworks.com/CVE-2024-5921"
            },
            {
                "url": "https://blog.amberwolf.com/blog/2024/november/palo-alto-globalprotect---code-execution-and-privilege-escalation-via-malicious-vpn-server-cve-2024-5921/",
                "refsource": "MISC",
                "name": "https://blog.amberwolf.com/blog/2024/november/palo-alto-globalprotect---code-execution-and-privilege-escalation-via-malicious-vpn-server-cve-2024-5921/"
            },
            {
                "url": "https://github.com/AmberWolfCyber/NachoVPN",
                "refsource": "MISC",
                "name": "https://github.com/AmberWolfCyber/NachoVPN"
            }
        ]
    },
    "generator": {
        "engine": "Vulnogram 0.1.0-dev"
    },
    "source": {
        "defect": [
            "GPC-19860",
            "GPC-19861"
        ],
        "discovery": "EXTERNAL"
    },
    "configuration": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "No special configuration is required to be affected by this issue."
                }
            ],
            "value": "No special configuration is required to be affected by this issue."
        }
    ],
    "work_around": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>You can mitigate this issue for all platforms (<a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-using-the-windows-registry\">Windows</a>, <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-using-the-macos-property-list\">macOS</a>, <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-on-linux-endpoints-redhat\">Linux</a>, <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-and-verify-fips-cc-mode-using-workspaceone-on-ios-devices\">iOS</a>, <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-and-verify-fips-cc-mode-using-microsoft-intune-on-android-endpoints\">Android</a>) by using the GlobalProtect app 6.0 in FIPS-CC mode or GlobalProtect app 5.1 in FIPS-CC mode. For details, refer to the first \"FIPS-CC Certification Validation\" table in <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/resolve-fips-cc-mode-issues\">our documentation</a>.</p><p>Note: this is separate from any FIPS-CC configurations on any GlobalProtect portals or gateways. This workaround is specific to FIPS-CC mode on the GlobalProtect app. GlobalProtect portals or gateways do not need to use FIPS-CC mode as part of this workaround.</p>"
                }
            ],
            "value": "You can mitigate this issue for all platforms ( Windows https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-using-the-windows-registry ,  macOS https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-using-the-macos-property-list ,  Linux https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-on-linux-endpoints-redhat ,  iOS https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-and-verify-fips-cc-mode-using-workspaceone-on-ios-devices ,  Android https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-and-verify-fips-cc-mode-using-microsoft-intune-on-android-endpoints ) by using the GlobalProtect app 6.0 in FIPS-CC mode or GlobalProtect app 5.1 in FIPS-CC mode. For details, refer to the first \"FIPS-CC Certification Validation\" table in  our documentation https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/resolve-fips-cc-mode-issues .\n\nNote: this is separate from any FIPS-CC configurations on any GlobalProtect portals or gateways. This workaround is specific to FIPS-CC mode on the GlobalProtect app. GlobalProtect portals or gateways do not need to use FIPS-CC mode as part of this workaround."
        }
    ],
    "exploit": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>Palo Alto Networks is not aware of any malicious exploitation of this issue. We are aware of a publicly available conference talk and blog posts discussing this issue. A proof of concept for this issue is also publicly available.<br></p>"
                }
            ],
            "value": "Palo Alto Networks is not aware of any malicious exploitation of this issue. We are aware of a publicly available conference talk and blog posts discussing this issue. A proof of concept for this issue is also publicly available."
        }
    ],
    "solution": [
        {
            "lang": "eng",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>This issue is fixed in GlobalProtect app 6.2.1-c31 on Linux, GlobalProtect app 6.2.6 on Windows, GlobalProtect app 6.2.6-c857 on macOS, GlobalProtect app 6.3.2 on Windows and macOS, and all later GlobalProtect app versions. Additional fixes are under development and will be made available for the remaining platforms (Linux, iOS, and Android).</p>The fix for this vulnerability requires three steps:<br><ol><li>Ensure that all of your GlobalProtect portals use TLS certificate chains that meet the criteria specified in the \"FIPS-CC Certification Validation\" table in <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/resolve-fips-cc-mode-issues\">our documentation</a>.</li><li>Ensure that the TLS certificate chains used by the GlobalProtect portals are added to the root certificate store in your operating system.</li><li>Install a fixed version of GlobalProtect using one of the deployment options below. This setting enforces strict X.509v3 verification checks on the certificate provided by the GlobalProtect portal.<br></li></ol><p>Note: Prisma Access customers using portals with a *.gpcloudservice.com domain name already have valid TLS certificate chains. The root certificate for these portals is from GoDaddy, which is trusted by default in Windows, macOS, RHEL, Ubuntu, iOS, and Android. Therefore, Prisma Access customers using a GlobalProtect portal with a *.gpcloudservice.com domain name should only need to perform step 3 above.<br><br><b>Important</b>: If your GlobalProtect portals do not use valid X.509V3 TLS certificate chains, this will result in TLS verification failures. To generate a GlobalProtect portal certificate that can be used with a fixed version of GlobalProtect app, refer to the first \"FIPS-CC Certification Validation\" table in <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/resolve-fips-cc-mode-issues\">our documentation</a>.<b><br></b></p><p><b></b><b></b><b>Warning: Performance Concern:</b> Some customers reported problems connecting to Portals and Gateways when this solution was implemented in certain situations. This is due to certificate providers that rate limit requests for Online Certificate Status Protocol (OCSP) and certificate revocation list (CRL) checks. This happens when multiple users connect to GlobalProtect Portals from a single public IP (such as NAT) around the same time, such as when hundreds or thousands of end users connect around the start of a workday from a single office.<br></p>"
                }
            ],
            "value": "This issue is fixed in GlobalProtect app 6.2.1-c31 on Linux, GlobalProtect app 6.2.6 on Windows, GlobalProtect app 6.2.6-c857 on macOS, GlobalProtect app 6.3.2 on Windows and macOS, and all later GlobalProtect app versions. Additional fixes are under development and will be made available for the remaining platforms (Linux, iOS, and Android).\n\nThe fix for this vulnerability requires three steps:\n  *  Ensure that all of your GlobalProtect portals use TLS certificate chains that meet the criteria specified in the \"FIPS-CC Certification Validation\" table in  our documentation https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/resolve-fips-cc-mode-issues .\n  *  Ensure that the TLS certificate chains used by the GlobalProtect portals are added to the root certificate store in your operating system.\n  *  Install a fixed version of GlobalProtect using one of the deployment options below. This setting enforces strict X.509v3 verification checks on the certificate provided by the GlobalProtect portal.\n\nNote: Prisma Access customers using portals with a *.gpcloudservice.com domain name already have valid TLS certificate chains. The root certificate for these portals is from GoDaddy, which is trusted by default in Windows, macOS, RHEL, Ubuntu, iOS, and Android. Therefore, Prisma Access customers using a GlobalProtect portal with a *.gpcloudservice.com domain name should only need to perform step 3 above.\n\nImportant: If your GlobalProtect portals do not use valid X.509V3 TLS certificate chains, this will result in TLS verification failures. To generate a GlobalProtect portal certificate that can be used with a fixed version of GlobalProtect app, refer to the first \"FIPS-CC Certification Validation\" table in  our documentation https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/resolve-fips-cc-mode-issues .\n\n\nWarning: Performance Concern: Some customers reported problems connecting to Portals and Gateways when this solution was implemented in certain situations. This is due to certificate providers that rate limit requests for Online Certificate Status Protocol (OCSP) and certificate revocation list (CRL) checks. This happens when multiple users connect to GlobalProtect Portals from a single public IP (such as NAT) around the same time, such as when hundreds or thousands of end users connect around the start of a workday from a single office."
        }
    ],
    "credits": [
        {
            "lang": "en",
            "value": "Maxime ESCOURBIAC, Michelin CERT"
        },
        {
            "lang": "en",
            "value": "Yassine BENGANA, Abicom for Michelin CERT"
        },
        {
            "lang": "en",
            "value": "Richard Warren and David Cash of AmberWolf"
        }
    ]
}