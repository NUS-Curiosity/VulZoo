{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2024-5921",
        "ASSIGNER": "psirt@paloaltonetworks.com",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "An insufficient certification validation issue in the Palo Alto Networks GlobalProtect app enables attackers to connect the GlobalProtect app to arbitrary servers. This can enable a local non-administrative operating system user or an attacker on the same subnet to install malicious root certificates on the endpoint and subsequently install malicious software signed by the malicious root certificates on that endpoint.\n\nGlobalProtect App for Android is under evaluation. Please subscribe to  our RSS feed https://security.paloaltonetworks.com/rss.xml  to be alerted to new updates to this and other advisories."
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-295 Improper Certificate Validation",
                        "cweId": "CWE-295"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "Palo Alto Networks",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "GlobalProtect App",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "=",
                                            "version_value": "6.3.0"
                                        },
                                        {
                                            "version_value": "not down converted",
                                            "x_cve_json_5_version_data": {
                                                "versions": [
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "6.2.6",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "6.2.6",
                                                        "status": "affected",
                                                        "version": "6.2.0",
                                                        "versionType": "custom"
                                                    }
                                                ],
                                                "defaultStatus": "unaffected"
                                            }
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "6.2.0"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "6.1.0"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "6.0.0"
                                        },
                                        {
                                            "version_affected": "=",
                                            "version_value": "5.1.0"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "GlobalProtect UWP App",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "=",
                                            "version_value": "All"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "GlobalProtect iOS App",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "=",
                                            "version_value": "All"
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "https://security.paloaltonetworks.com/CVE-2024-5921",
                "refsource": "MISC",
                "name": "https://security.paloaltonetworks.com/CVE-2024-5921"
            },
            {
                "url": "https://blog.amberwolf.com/blog/2024/november/palo-alto-globalprotect---code-execution-and-privilege-escalation-via-malicious-vpn-server-cve-2024-5921/",
                "refsource": "MISC",
                "name": "https://blog.amberwolf.com/blog/2024/november/palo-alto-globalprotect---code-execution-and-privilege-escalation-via-malicious-vpn-server-cve-2024-5921/"
            },
            {
                "url": "https://github.com/AmberWolfCyber/NachoVPN",
                "refsource": "MISC",
                "name": "https://github.com/AmberWolfCyber/NachoVPN"
            }
        ]
    },
    "source": {
        "defect": [
            "GPC-19860",
            "GPC-19861"
        ],
        "discovery": "EXTERNAL"
    },
    "work_around": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p><span>You can mitigate this issue for all platforms (</span><a target=\"_blank\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-using-the-windows-registry\"><span>Windows</span></a><span>, </span><a target=\"_blank\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-using-the-macos-property-list\"><span>macOS</span></a><span>, </span><a target=\"_blank\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-on-linux-endpoints-redhat\"><span>Linux</span></a><span>, </span><a target=\"_blank\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-and-verify-fips-cc-mode-using-workspaceone-on-ios-devices\"><span>iOS</span></a><span>, </span><a target=\"_blank\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-and-verify-fips-cc-mode-using-microsoft-intune-on-android-endpoints\"><span>Android</span></a><span>) by using the GlobalProtect app 6.0 in FIPS-CC mode or GlobalProtect app 5.1 in FIPS-CC mode. For details, </span><span>refer to </span><span>the first \"FIPS-CC Certification Validation\" table in </span><a target=\"_blank\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/resolve-fips-cc-mode-issues\"><span>our documentation</span></a><span>.</span></p><p><span>Note: this is separate from any FIPS-CC configurations on any GlobalProtect portals or gateways. This workaround is specific to FIPS-CC mode on the GlobalProtect app. GlobalProtect portals or gateways do not need to use FIPS-CC mode as part of this workaround.</span></p>"
                }
            ],
            "value": "You can mitigate this issue for all platforms ( Windows https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-using-the-windows-registry ,  macOS https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-using-the-macos-property-list ,  Linux https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-on-linux-endpoints-redhat ,  iOS https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-and-verify-fips-cc-mode-using-workspaceone-on-ios-devices ,  Android https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-and-verify-fips-cc-mode-using-microsoft-intune-on-android-endpoints ) by using the GlobalProtect app 6.0 in FIPS-CC mode or GlobalProtect app 5.1 in FIPS-CC mode. For details, refer to the first \"FIPS-CC Certification Validation\" table in  our documentation https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/resolve-fips-cc-mode-issues .\n\nNote: this is separate from any FIPS-CC configurations on any GlobalProtect portals or gateways. This workaround is specific to FIPS-CC mode on the GlobalProtect app. GlobalProtect portals or gateways do not need to use FIPS-CC mode as part of this workaround."
        }
    ],
    "exploit": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "Palo Alto Networks is not aware of any malicious exploitation of this issue. We are aware of a publicly available conference talk and blog posts discussing this issue. A proof of concept for this issue is also publicly available.<br />"
                }
            ],
            "value": "Palo Alto Networks is not aware of any malicious exploitation of this issue. We are aware of a publicly available conference talk and blog posts discussing this issue. A proof of concept for this issue is also publicly available."
        }
    ],
    "solution": [
        {
            "lang": "eng",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p></p><p>This issue is fixed in GlobalProtect app 6.2.6 and all later GlobalProtect app 6.2 versions on Windows.</p><p></p><p></p>The fix for this vulnerability requires three steps:<br /><ol><li>Ensure that all of your GlobalProtect portals use TLS certificate chains that only contain <a target=\"_blank\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/fips-cc-security-functions\">valid X.509v3 certificates</a>,</li><li>Ensure that the the TLS certificate chains used by the GlobalProtect portals are added to the root certificate store in your operating system,</li><li>Install a fixed version of GlobalProtect using one of the deployment options below. This setting enforces strict X.509v3 verification checks on the certificate provided by the GlobalProtect portal.<br /></li></ol><p>Note: Prisma Access customers using portals with a *.gpcloudservice.com domain name already have valid TLS certificate chains. The root certificate for these portals is from GoDaddy, which is trusted by default in Windows, macOS, RHEL, Ubuntu, iOS, and Android. Therefore, Prisma Access customers using a GlobalProtect portal with a *.gpcloudservice.com domain name should only need to perform step 3 above.<br /><br />Important: if your GlobalProtect portals do not use valid X.509V3 TLS certificate chains, this will result in TLS verification failures. To generate a GlobalProtect portal certificate that can be used with a fixed version of GlobalProtect app, refer to the first \"FIPS-CC Certification Validation\" table in <a target=\"_blank\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/resolve-fips-cc-mode-issues\">our documentation</a>.</p><p><b>Solution for new and existing GlobalProtect app installation on Windows</b></p><p></p><p>Customers can use their endpoint mobile device management (MDM) tools to apply the following changes.</p><ol><li>Install a fixed version of GlobalProtect app.</li><li>Update the following registry key with the specified recommended values:<br />HKEY_LOCAL_MACHINE\\SOFTWARE\\Palo Alto Networks\\GlobalProtect\\Settings<br />cert-store: machine<br />cert-location: ROOT<br />full-chain-cert-verify: yes</li><li>To apply this registry change, restart the operating system.</li></ol><p></p><p><b>Alternate solution for new GlobalProtect app installation on Windows</b></p><p></p><p>Install GlobalProtect with the pre-deployment key FULLCHAINCERTVERIFY set to Yes:</p><p>\u00a0 \u00a0 msiexec.exe /i GlobalProtect64.msi FULLCHAINCERTVERIFY=\"yes\"</p><p></p>"
                }
            ],
            "value": "This issue is fixed in GlobalProtect app 6.2.6 and all later GlobalProtect app 6.2 versions on Windows.\n\n\n\n\n\nThe fix for this vulnerability requires three steps:\n  *  Ensure that all of your GlobalProtect portals use TLS certificate chains that only contain  valid X.509v3 certificates https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/fips-cc-security-functions ,\n  *  Ensure that the the TLS certificate chains used by the GlobalProtect portals are added to the root certificate store in your operating system,\n  *  Install a fixed version of GlobalProtect using one of the deployment options below. This setting enforces strict X.509v3 verification checks on the certificate provided by the GlobalProtect portal.\n\nNote: Prisma Access customers using portals with a *.gpcloudservice.com domain name already have valid TLS certificate chains. The root certificate for these portals is from GoDaddy, which is trusted by default in Windows, macOS, RHEL, Ubuntu, iOS, and Android. Therefore, Prisma Access customers using a GlobalProtect portal with a *.gpcloudservice.com domain name should only need to perform step 3 above.\n\nImportant: if your GlobalProtect portals do not use valid X.509V3 TLS certificate chains, this will result in TLS verification failures. To generate a GlobalProtect portal certificate that can be used with a fixed version of GlobalProtect app, refer to the first \"FIPS-CC Certification Validation\" table in  our documentation https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/resolve-fips-cc-mode-issues .\n\nSolution for new and existing GlobalProtect app installation on Windows\n\n\n\nCustomers can use their endpoint mobile device management (MDM) tools to apply the following changes.\n\n  *  Install a fixed version of GlobalProtect app.\n  *  Update the following registry key with the specified recommended values:\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Palo Alto Networks\\GlobalProtect\\Settings\ncert-store: machine\ncert-location: ROOT\nfull-chain-cert-verify: yes\n  *  To apply this registry change, restart the operating system.\n\n\nAlternate solution for new GlobalProtect app installation on Windows\n\n\n\nInstall GlobalProtect with the pre-deployment key FULLCHAINCERTVERIFY set to Yes:\n\n\u00a0 \u00a0 msiexec.exe /i GlobalProtect64.msi FULLCHAINCERTVERIFY=\"yes\""
        }
    ],
    "credits": [
        {
            "lang": "en",
            "value": "Maxime ESCOURBIAC, Michelin CERT"
        },
        {
            "lang": "en",
            "value": "Yassine BENGANA, Abicom for Michelin CERT"
        },
        {
            "lang": "en",
            "value": "Richard Warren and David Cash of AmberWolf"
        }
    ]
}