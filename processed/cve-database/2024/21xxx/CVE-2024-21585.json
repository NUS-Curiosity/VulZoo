{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2024-21585",
        "ASSIGNER": "sirt@juniper.net",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "\nAn Improper Handling of Exceptional Conditions vulnerability in BGP session processing of Juniper Networks Junos OS and Junos OS Evolved allows an unauthenticated network-based attacker, using specific timing outside the attacker's control, to flap BGP sessions and cause the routing protocol daemon (rpd) process to crash and restart, leading to a Denial of Service (DoS) condition. Continued BGP session flapping will create a sustained Denial of Service (DoS) condition.\n\nThis issue only affects routers configured with non-stop routing (NSR) enabled. Graceful Restart (GR) helper mode, enabled by default, is also required for this issue to be exploitable.\n\n\nNote: NSR is not supported on the SRX Series and is therefore not affected by this vulnerability.\nWhen the BGP session flaps on the NSR-enabled router, the device enters GR-helper/LLGR-helper mode due to the peer having negotiated GR/LLGR-restarter capability and the backup BGP requests for replication of the GR/LLGR-helper session, master BGP schedules, and initiates replication of GR/LLGR stale routes to the backup BGP. In this state, if the BGP session with the BGP peer comes up again, unsolicited replication is initiated for the peer without cleaning up the ongoing GR/LLGR-helper mode replication. This parallel two instances of replication for the same peer leads to the assert if the BGP session flaps again.\n\nThis issue affects:\n\nJuniper Networks Junos OS\n\n\n\n  *  All versions earlier than 20.4R3-S9;\n  *  21.2 versions earlier than 21.2R3-S7;\n  *  21.3 versions earlier than 21.3R3-S5;\n  *  21.4 versions earlier than 21.4R3-S5;\n  *  22.1 versions earlier than 22.1R3-S4;\n  *  22.2 versions earlier than 22.2R3-S3;\n  *  22.3 versions earlier than 22.3R3-S1;\n  *  22.4 versions earlier than 22.4R2-S2, 22.4R3;\n  *  23.2 versions earlier than 23.2R1-S1, 23.2R2.\n\n\n\n\nJuniper Networks Junos OS Evolved\n\n\n\n  *  All versions earlier than 21.3R3-S5-EVO;\n  *  21.4 versions earlier than 21.4R3-S5-EVO;\n  *  22.1 versions earlier than 22.1R3-S4-EVO;\n  *  22.2 versions earlier than 22.2R3-S3-EVO;\n  *  22.3 versions earlier than 22.3R3-S1-EVO;\n  *  22.4 versions earlier than 22.4R2-S2-EVO, 22.4R3-EVO;\n  *  23.2 versions earlier than 23.2R1-S1-EVO, 23.2R2-EVO.\n\n\n\n\n\n\n"
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-755 Improper Handling of Exceptional Conditions",
                        "cweId": "CWE-755"
                    }
                ]
            },
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "Denial of Service (DoS)"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "Juniper Networks",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Junos OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "0",
                                            "version_value": "20.4R3-S9"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "21.2",
                                            "version_value": "21.2R3-S7"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "21.3",
                                            "version_value": "21.3R3-S5"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "21.4",
                                            "version_value": "21.4R3-S5"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "22.1",
                                            "version_value": "22.1R3-S4"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "22.2",
                                            "version_value": "22.2R3-S3"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "22.3",
                                            "version_value": "22.3R3-S1"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "22.4",
                                            "version_value": "22.4R2-S2, 22.4R3"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "23.2",
                                            "version_value": "23.2R1-S1, 23.2R2"
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "Junos OS Evolved",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "0",
                                            "version_value": "21.3R3-S5-EVO"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "21.4",
                                            "version_value": "21.4R3-S5-EVO"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "22.1",
                                            "version_value": "22.1R3-S4-EVO"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "22.2",
                                            "version_value": "22.2R3-S3-EVO"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "22.3",
                                            "version_value": "22.3R3-S1-EVO"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "22.4",
                                            "version_value": "22.4R2-S2-EVO, 22.4R3-EVO"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "23.2",
                                            "version_value": "23.2R1-S1-EVO, 23.2R2-EVO"
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "https://supportportal.juniper.net/JSA75723",
                "refsource": "MISC",
                "name": "https://supportportal.juniper.net/JSA75723"
            },
            {
                "url": "https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:L",
                "refsource": "MISC",
                "name": "https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:L"
            },
            {
                "url": "https://supportportal.juniper.net/s/article/MX-GR-and-LLGR-capability-and-compatibility-changes-after-15-1-release",
                "refsource": "MISC",
                "name": "https://supportportal.juniper.net/s/article/MX-GR-and-LLGR-capability-and-compatibility-changes-after-15-1-release"
            }
        ]
    },
    "generator": {
        "engine": "Vulnogram 0.1.0-av217"
    },
    "source": {
        "advisory": "JSA75723",
        "defect": [
            "1742287"
        ],
        "discovery": "USER"
    },
    "configuration": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "Non-stop routing (NSR) is enabled using the following configuration:<br><br><tt>&nbsp; [edit chassis redundancy]<br>&nbsp; graceful-switchover;<br>&nbsp; <br>&nbsp; [edit routing-options]<br>&nbsp; nonstop-routing;</tt><br>"
                }
            ],
            "value": "Non-stop routing (NSR) is enabled using the following configuration:\n\n\u00a0 [edit chassis redundancy]\n\u00a0 graceful-switchover;\n\u00a0 \n\u00a0 [edit routing-options]\n\u00a0 nonstop-routing;\n"
        }
    ],
    "work_around": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "Graceful Restart (GR) helper mode and Long-Lived Graceful Restart (LLGR) helper mode can be disabled to prevent this issue.<br><br><tt>&nbsp; [edit protocols bgp graceful-restart]<br>&nbsp; disable;<br><br>&nbsp; [edit protocols bgp graceful-restart long-lived receiver]<br>&nbsp; disable;</tt>"
                }
            ],
            "value": "Graceful Restart (GR) helper mode and Long-Lived Graceful Restart (LLGR) helper mode can be disabled to prevent this issue.\n\n\u00a0 [edit protocols bgp graceful-restart]\n\u00a0 disable;\n\n\u00a0 [edit protocols bgp graceful-restart long-lived receiver]\n\u00a0 disable;"
        }
    ],
    "exploit": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>Juniper SIRT is not aware of any malicious exploitation of this vulnerability.</p>"
                }
            ],
            "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability.\n\n"
        }
    ],
    "solution": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>The following software releases have been updated to resolve this specific issue: </p><p>Junos OS: 20.4R3-S9, 21.2R3-S7, 21.3R3-S5, 21.4R3-S5, 22.1R3-S4, 22.2R3-S3, 22.3R3-S1, 22.4R2-S2, 22.4R3, 23.1R2, 23.2R1-S1, 23.2R2, 23.3R1, and all subsequent releases.</p><p>Junos OS Evolved: 21.3R3-S5-EVO, 21.4R3-S5-EVO, 22.1R3-S4-EVO, 22.2R3-S3-EVO, 22.3R3-S1-EVO, 22.4R2-S2-EVO, 22.4R3-EVO, 23.1R2-EVO, 23.2R1-S1-EVO, 23.2R2-EVO, 23.3R1-EVO, and all subsequent releases.</p>"
                }
            ],
            "value": "The following software releases have been updated to resolve this specific issue: \n\nJunos OS: 20.4R3-S9, 21.2R3-S7, 21.3R3-S5, 21.4R3-S5, 22.1R3-S4, 22.2R3-S3, 22.3R3-S1, 22.4R2-S2, 22.4R3, 23.1R2, 23.2R1-S1, 23.2R2, 23.3R1, and all subsequent releases.\n\nJunos OS Evolved: 21.3R3-S5-EVO, 21.4R3-S5-EVO, 22.1R3-S4-EVO, 22.2R3-S3-EVO, 22.3R3-S1-EVO, 22.4R2-S2-EVO, 22.4R3-EVO, 23.1R2-EVO, 23.2R1-S1-EVO, 23.2R2-EVO, 23.3R1-EVO, and all subsequent releases.\n\n"
        }
    ],
    "impact": {
        "cvss": [
            {
                "attackComplexity": "HIGH",
                "attackVector": "NETWORK",
                "availabilityImpact": "HIGH",
                "baseScore": 5.9,
                "baseSeverity": "MEDIUM",
                "confidentialityImpact": "NONE",
                "integrityImpact": "NONE",
                "privilegesRequired": "NONE",
                "scope": "UNCHANGED",
                "userInteraction": "NONE",
                "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
                "version": "3.1"
            }
        ]
    }
}