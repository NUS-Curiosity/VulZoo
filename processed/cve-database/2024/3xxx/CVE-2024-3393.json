{
    "data_version": "4.0",
    "data_type": "CVE",
    "data_format": "MITRE",
    "CVE_data_meta": {
        "ID": "CVE-2024-3393",
        "ASSIGNER": "psirt@paloaltonetworks.com",
        "STATE": "PUBLIC"
    },
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "A Denial of Service vulnerability in the DNS Security feature of Palo Alto Networks PAN-OS software allows an unauthenticated attacker to send a malicious packet through the data plane of the firewall that reboots the firewall. Repeated attempts to trigger this condition will cause the firewall to enter maintenance mode."
            }
        ]
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-754 Improper Check for Unusual or Exceptional Conditions",
                        "cweId": "CWE-754"
                    }
                ]
            }
        ]
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "vendor_name": "Palo Alto Networks",
                    "product": {
                        "product_data": [
                            {
                                "product_name": "Cloud NGFW",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "not down converted",
                                            "x_cve_json_5_version_data": {
                                                "versions": [
                                                    {
                                                        "status": "unaffected",
                                                        "version": "All"
                                                    }
                                                ],
                                                "defaultStatus": "unaffected"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "product_name": "PAN-OS",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_value": "not down converted",
                                            "x_cve_json_5_version_data": {
                                                "versions": [
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "11.2.3",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "11.2.3",
                                                        "status": "affected",
                                                        "version": "11.2.0",
                                                        "versionType": "custom"
                                                    },
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "11.1.2-h16",
                                                                "status": "unaffected"
                                                            },
                                                            {
                                                                "at": "11.1.3-h13",
                                                                "status": "unaffected"
                                                            },
                                                            {
                                                                "at": "11.1.4-h7",
                                                                "status": "unaffected"
                                                            },
                                                            {
                                                                "at": "11.1.5",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "11.1.2-h16",
                                                        "status": "affected",
                                                        "version": "11.1.0",
                                                        "versionType": "custom"
                                                    },
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "10.2.8-h19",
                                                                "status": "unaffected"
                                                            },
                                                            {
                                                                "at": "10.2.9-h19",
                                                                "status": "unaffected"
                                                            },
                                                            {
                                                                "at": "10.2.10-h12",
                                                                "status": "unaffected"
                                                            },
                                                            {
                                                                "at": "10.2.11-h10",
                                                                "status": "unaffected"
                                                            },
                                                            {
                                                                "at": "10.2.12-h4",
                                                                "status": "unaffected"
                                                            },
                                                            {
                                                                "at": "10.2.13-h2",
                                                                "status": "unaffected"
                                                            },
                                                            {
                                                                "at": "10.2.14",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "10.2.8-h19",
                                                        "status": "affected",
                                                        "version": "10.2.8",
                                                        "versionType": "custom"
                                                    },
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "10.1.14-h8",
                                                                "status": "unaffected"
                                                            },
                                                            {
                                                                "at": "10.1.15",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "10.1.14-h8",
                                                        "status": "affected",
                                                        "version": "10.1.14",
                                                        "versionType": "custom"
                                                    }
                                                ],
                                                "defaultStatus": "unaffected"
                                            }
                                        },
                                        {
                                            "version_value": "not down converted",
                                            "x_cve_json_5_version_data": {
                                                "versions": [
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "10.2.8",
                                                                "status": "affected"
                                                            },
                                                            {
                                                                "at": "10.2.9-h19",
                                                                "status": "unaffected"
                                                            },
                                                            {
                                                                "at": "10.2.10-h12",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "10.2.8",
                                                        "status": "unaffected",
                                                        "version": "10.2.0",
                                                        "versionType": "custom"
                                                    },
                                                    {
                                                        "changes": [
                                                            {
                                                                "at": "11.2.3",
                                                                "status": "unaffected"
                                                            }
                                                        ],
                                                        "lessThan": "11.2.3",
                                                        "status": "affected",
                                                        "version": "11.2.0",
                                                        "versionType": "custom"
                                                    }
                                                ],
                                                "defaultStatus": "unaffected"
                                            }
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        }
    },
    "references": {
        "reference_data": [
            {
                "url": "https://security.paloaltonetworks.com/CVE-2024-3393",
                "refsource": "MISC",
                "name": "https://security.paloaltonetworks.com/CVE-2024-3393"
            }
        ]
    },
    "generator": {
        "engine": "Vulnogram 0.1.0-dev"
    },
    "source": {
        "defect": [
            "PAN-259351",
            "PAN-219034"
        ],
        "discovery": "USER"
    },
    "configuration": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p>Both of the following must be true for PAN-OS software to be affected:<br></p><ol><li>Either a DNS Security License or an Advanced DNS Security License must be applied, AND<br></li><li>DNS Security logging must be enabled.</li></ol>"
                }
            ],
            "value": "Both of the following must be true for PAN-OS software to be affected:\n\n\n  *  Either a DNS Security License or an Advanced DNS Security License must be applied, AND\n\n  *  DNS Security logging must be enabled."
        }
    ],
    "work_around": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "If your firewall running the vulnerable PAN-OS versions stops responding or reboots unexpectedly and you cannot immediately apply a fix, apply a workaround below based on your deployment.<br><br><b>Unmanaged NGFWs, NGFW managed by Panorama, or Prisma Access managed by Panorama</b><b><br></b><ol><li>For each Anti-spyware profile, navigate to Objects \u2192 Security Profiles \u2192 Anti-spyware \u2192 (select a profile) \u2192 DNS Policies \u2192 DNS Security.</li><li>Change the Log Severity to \"none\" for all configured DNS Security categories.<br></li><li>Commit the changes.<br></li></ol>Remember to revert the Log Severity settings once the fixes are applied.<br><br><b>NGFW managed by Strata Cloud Manager (SCM)</b><br><br><div><div>You can choose one of the following mitigation options:</div><div><ol><li>Option 1: Disable DNS Security logging directly on each NGFW by following the PAN-OS steps above.</li><li>Option 2: Disable DNS Security logging across all NGFWs in your tenant by opening a <a target=\"_blank\" rel=\"nofollow\" href=\"https://support.paloaltonetworks.com/Support/Index\">support case</a>.</li></ol></div><b><p>Prisma Access managed by Strata Cloud Manager (SCM)</p></b></div><p>Until we perform an upgrade of your Prisma Access tenant, you can disable DNS Security logging across all NGFWs in your tenant by opening a <a target=\"_blank\" rel=\"nofollow\" href=\"https://support.paloaltonetworks.com/Support/Index\">support case</a>. If you would like to expedite the upgrade, please make a note of that in the support case.</p><b></b>"
                }
            ],
            "value": "If your firewall running the vulnerable PAN-OS versions stops responding or reboots unexpectedly and you cannot immediately apply a fix, apply a workaround below based on your deployment.\n\nUnmanaged NGFWs, NGFW managed by Panorama, or Prisma Access managed by Panorama\n  *  For each Anti-spyware profile, navigate to Objects \u2192 Security Profiles \u2192 Anti-spyware \u2192 (select a profile) \u2192 DNS Policies \u2192 DNS Security.\n  *  Change the Log Severity to \"none\" for all configured DNS Security categories.\n\n  *  Commit the changes.\n\nRemember to revert the Log Severity settings once the fixes are applied.\n\nNGFW managed by Strata Cloud Manager (SCM)\n\nYou can choose one of the following mitigation options:\n\n  *  Option 1: Disable DNS Security logging directly on each NGFW by following the PAN-OS steps above.\n  *  Option 2: Disable DNS Security logging across all NGFWs in your tenant by opening a  support case https://support.paloaltonetworks.com/Support/Index .\n\n\nPrisma Access managed by Strata Cloud Manager (SCM)\n\n\n\nUntil we perform an upgrade of your Prisma Access tenant, you can disable DNS Security logging across all NGFWs in your tenant by opening a  support case https://support.paloaltonetworks.com/Support/Index . If you would like to expedite the upgrade, please make a note of that in the support case."
        }
    ],
    "exploit": [
        {
            "lang": "en",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "Palo Alto Networks is aware of customers experiencing this denial of service (DoS) when their firewall blocks malicious DNS packets that trigger this issue."
                }
            ],
            "value": "Palo Alto Networks is aware of customers experiencing this denial of service (DoS) when their firewall blocks malicious DNS packets that trigger this issue."
        }
    ],
    "solution": [
        {
            "lang": "eng",
            "supportingMedia": [
                {
                    "base64": false,
                    "type": "text/html",
                    "value": "<p><span>This issue is fixed in PAN-OS 10.1.14-h8, PAN-OS 10.2.10-h12, PAN-OS 11.1.5, PAN-OS 11.2.3, and all later PAN-OS versions.</span></p><p><span>Note: PAN-OS 11.0 reached the end of life (EOL) on November 17, 2024, so we do not intend to provide a fix for this release.</span></p><p><span>Prisma Access customers using DNS Security with affected PAN-OS versions should apply one of the workarounds provided below. We will perform upgrades in two phases for impacted customers on the weekends of January 3rd and January 10th. You can request an expedited Prisma Access upgrade to the latest PAN-OS version by opening a </span><a target=\"_blank\" rel=\"nofollow\" href=\"https://support.paloaltonetworks.com/Support/Index\"><span>support case</span></a><span>.</span></p><p><span><span>In addition, to provide the most seamless upgrade path for our customers, we are making fixes available for other TAC-preferred and commonly deployed maintenance releases.</span></span></p><p>\u200b\u200bAdditional PAN-OS 11.1 fixes:</p><div><ul><li>11.1.2-h16</li><li>11.1.3-h13</li><li>11.1.4-h7</li><li>11.1.5</li></ul></div><div>Additional PAN-OS 10.2 fixes:</div><div><ul><li>10.2.8-h19</li><li>10.2.9-h19</li><li>10.2.10-h12</li><li>10.2.11-h10</li><li>10.2.12-h4</li><li>10.2.13-h2</li><li>10.2.14</li></ul></div><div>Additional PAN-OS 10.1 fixes:</div><div><ul><li>10.1.14-h8</li><li>10.1.15</li></ul></div><div>Additional PAN-OS fixes only applicable to Prisma Access:</div><div><ul><li>10.2.9-h19</li><li>10.2.10-h12</li></ul></div>"
                }
            ],
            "value": "This issue is fixed in PAN-OS 10.1.14-h8, PAN-OS 10.2.10-h12, PAN-OS 11.1.5, PAN-OS 11.2.3, and all later PAN-OS versions.\n\nNote: PAN-OS 11.0 reached the end of life (EOL) on November 17, 2024, so we do not intend to provide a fix for this release.\n\nPrisma Access customers using DNS Security with affected PAN-OS versions should apply one of the workarounds provided below. We will perform upgrades in two phases for impacted customers on the weekends of January 3rd and January 10th. You can request an expedited Prisma Access upgrade to the latest PAN-OS version by opening a  support case https://support.paloaltonetworks.com/Support/Index .\n\nIn addition, to provide the most seamless upgrade path for our customers, we are making fixes available for other TAC-preferred and commonly deployed maintenance releases.\n\n\u200b\u200bAdditional PAN-OS 11.1 fixes:\n\n  *  11.1.2-h16\n  *  11.1.3-h13\n  *  11.1.4-h7\n  *  11.1.5\n\n\n\n\nAdditional PAN-OS 10.2 fixes:\n\n  *  10.2.8-h19\n  *  10.2.9-h19\n  *  10.2.10-h12\n  *  10.2.11-h10\n  *  10.2.12-h4\n  *  10.2.13-h2\n  *  10.2.14\n\n\n\n\nAdditional PAN-OS 10.1 fixes:\n\n  *  10.1.14-h8\n  *  10.1.15\n\n\n\n\nAdditional PAN-OS fixes only applicable to Prisma Access:\n\n  *  10.2.9-h19\n  *  10.2.10-h12"
        }
    ],
    "credits": [
        {
            "lang": "en",
            "value": "Palo Alto Networks thanks the CERT-EE team for their extra effort in providing invaluable forensic and analytic assistance."
        }
    ]
}