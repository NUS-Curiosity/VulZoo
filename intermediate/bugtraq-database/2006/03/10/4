
Date: Thu,  9 Mar 2006 16:25:00 -0700
From: security@...driva.com
To: bugtraq@...urityfocus.com
Subject: [ MDKSA-2006:035-1 ] - Updated php packages fix vulnerability



-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

 _______________________________________________________________________
 
 Mandriva Linux Security Advisory                       MDKSA-2006:035-1
 http://www.mandriva.com/security/
 _______________________________________________________________________
 
 Package : php
 Date    : March 9, 2006
 Affected: 10.2, Corporate 3.0, Multi Network Firewall 2.0
 _______________________________________________________________________
 
 Problem Description:
 
 A flaw in the PHP gd extension in versions prior to 4.4.1 could allow
 a remote attacker to bypass safe_mode and open_basedir restrictions via
 unknown attack vectors.

 Update:

 A regression was introduced with the backported patch from PHP 4.4.1
 that would prevent PHP from creating a new file with imagepng(),
 imagejpeg(), etc.  Thanks to Tibor Pittich for bringing this to our
 attention.
 
 The updated packages have been patched to correct this issue.
 _______________________________________________________________________

 References:
 
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3391
 http://bugs.php.net/bug.php?id=35071
 _______________________________________________________________________
 
 Updated Packages:
 
 Mandriva Linux 10.2:
 0db2745dbbff64fd65dadb8dc56990be  10.2/RPMS/libphp_common432-4.3.10-7.7.102mdk.i586.rpm
 b47b27ecb1ab4c382050efe0b0c2d90d  10.2/RPMS/php432-devel-4.3.10-7.7.102mdk.i586.rpm
 e8a60234bdd8300d69de5d34db052f48  10.2/RPMS/php-cgi-4.3.10-7.7.102mdk.i586.rpm
 5fbcbe8137a9c81e51732d2e2626fbc2  10.2/RPMS/php-cli-4.3.10-7.7.102mdk.i586.rpm
 6939daad4be9d536a5b92a9c974492b7  10.2/RPMS/php-gd-4.3.10-5.2.102mdk.i586.rpm
 c642018a2637aad0f30f3a54b39adb7f  10.2/SRPMS/php-4.3.10-7.7.102mdk.src.rpm
 1b5088207662744536850e76c1c2a810  10.2/SRPMS/php-gd-4.3.10-5.2.102mdk.src.rpm

 Mandriva Linux 10.2/X86_64:
 7e8cb4fba36c45cbb30f857b66952b61  x86_64/10.2/RPMS/lib64php_common432-4.3.10-7.7.102mdk.x86_64.rpm
 1abf502652277a2f88b0ac8ec56cf1f0  x86_64/10.2/RPMS/php432-devel-4.3.10-7.7.102mdk.x86_64.rpm
 e90f65a59b48a161218c75bb500cc23d  x86_64/10.2/RPMS/php-cgi-4.3.10-7.7.102mdk.x86_64.rpm
 6a99ba4dade20bf3d2aede8e77e21470  x86_64/10.2/RPMS/php-cli-4.3.10-7.7.102mdk.x86_64.rpm
 3d2427baec1eaccc59bf70497793b48b  x86_64/10.2/RPMS/php-gd-4.3.10-5.2.102mdk.x86_64.rpm
 c642018a2637aad0f30f3a54b39adb7f  x86_64/10.2/SRPMS/php-4.3.10-7.7.102mdk.src.rpm
 1b5088207662744536850e76c1c2a810  x86_64/10.2/SRPMS/php-gd-4.3.10-5.2.102mdk.src.rpm

 Corporate 3.0:
 47c8f5aa37f7e181a5a05345e44dd0a4  corporate/3.0/RPMS/libphp_common432-4.3.4-4.11.C30mdk.i586.rpm
 ab2851f86c0696e78ca59a81087a7ec6  corporate/3.0/RPMS/php432-devel-4.3.4-4.11.C30mdk.i586.rpm
 ad94de884bd67484333ec571e2380c9d  corporate/3.0/RPMS/php-cgi-4.3.4-4.11.C30mdk.i586.rpm
 fb2b23250348b24fca399fea9468a5f5  corporate/3.0/RPMS/php-cli-4.3.4-4.11.C30mdk.i586.rpm
 fb4a1734af1371fe3e9f7e9a0c2bb59e  corporate/3.0/RPMS/php-gd-4.3.4-1.2.C30mdk.i586.rpm
 d809ddd37502d3c97ad14b2ac0959849  corporate/3.0/SRPMS/php-4.3.4-4.11.C30mdk.src.rpm
 31dd981b3b064c2395e391ded732e885  corporate/3.0/SRPMS/php-gd-4.3.4-1.2.C30mdk.src.rpm

 Corporate 3.0/X86_64:
 16f6a5912df4369466ef137fba4f140f  x86_64/corporate/3.0/RPMS/lib64php_common432-4.3.4-4.11.C30mdk.x86_64.rpm
 7be55ce5d0efd363b52f34bd51601b57  x86_64/corporate/3.0/RPMS/php432-devel-4.3.4-4.11.C30mdk.x86_64.rpm
 e1152a93a0dbe5621cc22d4f0fd9a078  x86_64/corporate/3.0/RPMS/php-cgi-4.3.4-4.11.C30mdk.x86_64.rpm
 09e8804af62b2690372cdc9b7c33768e  x86_64/corporate/3.0/RPMS/php-cli-4.3.4-4.11.C30mdk.x86_64.rpm
 a88970d68492804931649ac5a16ff160  x86_64/corporate/3.0/RPMS/php-gd-4.3.4-1.2.C30mdk.x86_64.rpm
 d809ddd37502d3c97ad14b2ac0959849  x86_64/corporate/3.0/SRPMS/php-4.3.4-4.11.C30mdk.src.rpm
 31dd981b3b064c2395e391ded732e885  x86_64/corporate/3.0/SRPMS/php-gd-4.3.4-1.2.C30mdk.src.rpm

 Multi Network Firewall 2.0:
 83c42077383163544e1dc557aa0a084d  mnf/2.0/RPMS/libphp_common432-4.3.4-4.11.M20mdk.i586.rpm
 2280458c90117e02c017adfa626d1ccf  mnf/2.0/RPMS/php432-devel-4.3.4-4.11.M20mdk.i586.rpm
 5548f0e25486fdad8bc4639afc2ecfc6  mnf/2.0/RPMS/php-cgi-4.3.4-4.11.M20mdk.i586.rpm
 5154c61212ed626d19f2044c2a21ccef  mnf/2.0/RPMS/php-cli-4.3.4-4.11.M20mdk.i586.rpm
 290cb21e2b69e3e567a07fcb7f16f3de  mnf/2.0/RPMS/php-gd-4.3.4-1.2.M20mdk.i586.rpm
 a3dacf3ebc5f4a13d84d00d9df2c80e0  mnf/2.0/SRPMS/php-4.3.4-4.11.M20mdk.src.rpm
 752b4174f06cfff2ef8879c512d4bb19  mnf/2.0/SRPMS/php-gd-4.3.4-1.2.M20mdk.src.rpm
 _______________________________________________________________________

 To upgrade automatically use MandrivaUpdate or urpmi.  The verification
 of md5 checksums and GPG signatures is performed automatically for you.

 All packages are signed by Mandriva for security.  You can obtain the
 GPG public key of the Mandriva Security Team by executing:

  gpg --recv-keys --keyserver pgp.mit.edu 0x22458A98

 You can view other update advisories for Mandriva Linux at:

  http://www.mandriva.com/security/advisories

 If you want to report vulnerabilities, please contact

  security_(at)_mandriva.com
 _______________________________________________________________________

 Type Bits/KeyID     Date       User ID
 pub  1024D/22458A98 2000-07-10 Mandriva Security Team
  <security*mandriva.com>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQFEEIzzmqjQ0CJFipgRAgfKAJ4r+acPLAqS7j3f0j1wGfBDIA6VpQCfXa3T
lXHyFfLjT6RMx/tK9MVf76k=
=RPEv
-----END PGP SIGNATURE-----



