
Date: Wed, 6 Dec 2006 17:21:19 -0800
From: TSRT@...m.com
To: full-disclosure@...ts.grok.org.uk, bugtraq@...urityfocus.com
Cc: zdi-disclosures@...m.com
Subject: TSRT-06-15: Citrix Presentation Server Client ActiveX Heap Overflow
 Vulnerability

TSRT-06-15: Citrix Presentation Server Client ActiveX Heap Overflow
            Vulnerability
http://www.tippingpoint.com/security/advisories/TSRT-06-15.html
December 6, 2006

-- CVE ID:
CVE-2006-6334

-- Affected Vendor:
Citrix

-- Affected Products:
Citrix Presentation Server Client for Windows < v9.230 

-- TippingPoint(TM) IPS Customer Protection:
TippingPoint IPS customers have been protected against this
vulnerability since February 2006 by a pre-existing Digital Vaccine
protection filter ID 4163. For further product information on the
TippingPoint IPS:

    http://www.tippingpoint.com 

-- Vulnerability Details:
This vulnerability allows attackers to execute arbitrary code on
vulnerable installations of Citrix Presentation Server Client for
Windows. User interaction is required to exploit this vulnerability in
that the target must visit a malicious page.

The specific flaw resides in the SendChannelData function of the
ActiveX control Wfica.ocx (CLSID 238F6F83-B8B4-11CF-8771-00A024541EE3).
The function is prototyped as follows:

    SendChannelData(ChannelName As String,
        Data As String,
        DataSize As Long,
        DataType As ICAVCDataType)

Specifying an undersized buffer length as the 'DataSize' parameter and
supplying a large buffer as the 'Data' parameter results in an
exploitable heap corruption.

-- Vendor Response:
Citrix has issued an update to correct this vulnerability. More details
can be found at:

http://support.citrix.com/article/CTX111827

-- Disclosure Timeline:
2006.02.01 - Pre-existing Digital Vaccine released to TippingPoint 
customers
2006.09.19 - Vulnerability reported to vendor
2006.12.06 - Coordinated public release of advisory

-- Credit:
This vulnerability was discovered by Aaron Portnoy, TippingPoint Security 
Research Team.
