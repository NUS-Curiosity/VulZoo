
Date: Tue, 31 Oct 2006 18:35:52 -0500
From: iDefense Labs <labs-no-reply@...fense.com>
To: idlabs-advisories@...fense.com, vulnwatch@...nwatch.org,
	full-disclosure@...ts.grok.org.uk, bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 10.27.06: Novell eDirectory NMAS BerDecodeLoginDataRequeset
 DoS Vulnerability

Novell eDirectory NMAS BerDecodeLoginDataRequeset DoS Vulnerability

iDefense Security Advisory 10.27.06
http://www.idefense.com/intelligence/vulnerabilities/
Oct 27, 2006

I. BACKGROUND

Novell eDirectory is a cross-platform lightweight directory access
protocol (LDAP) server. Additionally, eDirectory implements NMAS which
stands for Novell Modular Authentication System. More information can be
found on Novell's web site at http://www.novell.com/products/edirectory/

II. DESCRIPTION

Remote exploitation of a denial of service (DoS) vulnerability in Novell
Inc.'s eDirectory product could allow an attacker to force the running
daemon to cease servicing requests.

The problem specifically exists due to a pointer handling mistake within
the BerDecodeLoginDataRequest function within the libnmasldap.so module.
When a specially crafted login request is encountered, this function
loops based on a length value supplied in the request. In this loop, a
nested pointer value is incremented at the wrong level. This results in
a buffer length parameter that is on the stack being used as a memory
address for ber_get_int(). This value does not appear to be influenced
in any way by attacker supplied input. Invalid memory access will lead
to a segmentation violation, crashing the process.

III. ANALYSIS

Successful exploitation of this vulnerability could allow an attacker to
crash the server process. No credentials are required.

IV. DETECTION

iDefense has confirmed the existence of this vulnerability within versions
8.8 and 8.8.1 of Novell's eDirectory product. The vulnerability was
tested
and confirmed to exist on both Linux and Solaris.

V. WORKAROUND

iDefense is unaware of any viable workaround for this issue.

VI. VENDOR RESPONSE

Novell has addressed this issue in version 2.0.3 of Security Services.
To obtain the updated version please refer to the following quoted
vendor response:

"Search for "Security Services" at the Novell Downloads Web site
(http://download.novell.com) and download the necessary platform-specific
download for the Security Services 2.0.3 patch.

    * For NetWare - select ss203_NW.tgz
    * For Linux, Solaris, HP-UX, and AIX - select ss203_SLAH.tgz
    * For Windows - select ss_setup.exe"

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2006-4521 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

08/17/2006  Initial vendor notification
08/18/2006  Initial vendor response
10/06/2006  Second vendor notification
10/27/2006  Coordinated public disclosure

IX. CREDIT

The discoverer of this vulnerability wishes to remain anonymous.

Get paid for vulnerability research
http://www.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2006 iDefense, Inc.

Permission is granted for the redistribution of this alert electronically.
It may not be edited in any way without the express written consent of
iDefense. If you wish to reprint the whole or any part of this alert in
any other medium other than electronically, please email
customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate at
the time of publishing based on currently available information. Use of
the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on, this
information.


