
Date: 27 Nov 2006 17:36:29 -0000
From: research@...antec.com
To: bugtraq@...urityfocus.com
Subject: SYMSA-2006-011: JBoss Java Class DeploymentFileRepository
 Directory Traversal

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1




                   Symantec Vulnerability Research
                   http://www.symantec.com/research
                        Security Advisory

   Advisory ID: SYMSA-2006-011
Advisory Title: JBoss Java Class DeploymentFileRepository Directory Traversal 
        Author: Oliver Karow / olver_Karow[@]symantec.com
  Release Date: 27-11-2006
   Application: JBoss Web Server 1.0.0.GA
      Platform: Java (Windows / Linux)
      Severity: Remotely exploitable / User access
 Vendor status: Vendor verified, patch is available
    CVE Number: CVE-2006-5750
     Reference: http://www.securityfocus.com/bid/21219


Overview:

	From JBoss Documentation:

"This class wraps the file system for deployments. It gives a
file-based persistence mechanism for deployments. Used by
web-console to store -service.xml files, -ds.xml files, etc...,
really anything text based. Deployments are tied to a specific
name and that name corresponds to the base file name."

The class can be abused to create files outside of the application
root directory, and could allow an attacker who has access to
the management console the ability to read or write files with
the permissions of the JBoss user, potentially leading to
arbitrary code execution.



Details:

	The method setBaseDir() of the class
org.jboss.console.manager.DeploymentFileRepository does not
check if the basedir is set to a directory outside of the application
root directory via directory traversal. In conjunction with
the usage of the methods store() and remove(), it is possible
to create and delete arbitrary files on the target system.

The class is used by JBoss Web Server's web-console/jmx-console
which by default is accessible from remote by unauthenticated
users. During our research, it was possible to create and
execute JSP-Files and to overwrite configuration files.

The class may also be used by other JBoss Applications, thus
making them vulnerable  to the same attacks.

Due to JBoss Web Server's missing default authentication
enforcement, complete control of the application is also possible.



Vendor Response:

Red Hat has verified the flaw in the DeploymentFileRepository class
of the JBoss application server.  A remote attacker who is able to
access the console manager could read or write to files with the
permissions of the JBoss user.  This could potentially lead to
arbitrary code execution as the JBoss user (CVE-2006-5750).

Please note that the JBoss console manager should always be secured
prior to deployment.  By default, the JBoss installer gives users the
ability to password protect the console manager, limiting an attack
using this vulnerability to authorised users.  These steps can also
be performed manually.
http://wiki.jboss.org/wiki/Wiki.jsp?page=SecureJBoss



Recommendation:

This issue affected the JBoss Application Server.  A patch for this
issue is available:
http://jira.jboss.com/jira/browse/ASPATCH-126

This issue affected Red Hat Application Stack.  An updated jbossas
package to correct this issue is available along with our advisory:
https://rhn.redhat.com/errata/RHSA-2006-0743.html


Common Vulnerabilities and Exposures (CVE) Information:

The Common Vulnerabilities and Exposures (CVE) project has assigned
the following names to these issues.  These are candidates for
inclusion in the CVE list (http://cve.mitre.org), which standardizes
names for security problems.


  CVE-2006-5750  Requested

- -------Symantec Vulnerability Research Advisory Information-------

For questions about this advisory, or to report an error:
research@...antec.com

For details on Symantec's Vulnerability Reporting Policy: 
http://www.symantec.com/research/Symantec-Responsible-Disclosure.pdf

Symantec Vulnerability Research Advisory Archive: 
http://www.symantec.com/research/  

Symantec Vulnerability Research GPG Key:
http://www.symantec.com/research/Symantec_Vulnerability_Research_GPG.asc

- -------------Symantec Product Advisory Information-------------

To Report a Security Vulnerability in a Symantec Product:
secure@...antec.com 

For general information on Symantec's Product Vulnerability 
reporting and response:
http://www.symantec.com/security/

Symantec Product Advisory Archive: 
http://www.symantec.com/avcenter/security/SymantecAdvisories.html

Symantec Product Advisory PGP Key:
http://www.symantec.com/security/Symantec-Vulnerability-Management-Key.asc

- ---------------------------------------------------------------

Copyright (c) 2006 by Symantec Corp.
Permission to redistribute this alert electronically is granted 
as long as it is not edited in any way unless authorized by 
Symantec Consulting Services. Reprinting the whole or part of 
this alert in any medium other than electronically requires 
permission from cs_advisories@...antec.com.

Disclaimer
The information in the advisory is believed to be accurate at the 
time of publishing based on currently available information. Use 
of the information constitutes acceptance for use in an AS IS 
condition. There are no warranties with regard to this information. 
Neither the author nor the publisher accepts any liability for any 
direct, indirect, or consequential loss or damage arising from use 
of, or reliance on, this information.

Symantec, Symantec products, and Symantec Consulting Services are 
registered trademarks of Symantec Corp. and/or affiliated companies 
in the United States and other countries. All other registered and 
unregistered trademarks represented in this document are the sole 
property of their respective companies/owners.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.2.2 (GNU/Linux)

iD8DBQFFayI7uk7IIFI45IARAmu4AJ0WotzDr8YAW1SgTwbeBFn9jOIUcwCg3VUe
F1Bsjzx3lmSy6f8e5jABJlo=
=zP1f
-----END PGP SIGNATURE-----
