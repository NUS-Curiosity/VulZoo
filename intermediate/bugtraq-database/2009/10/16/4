
Date: Fri, 16 Oct 2009 11:28:01 +0800
From: NSFOCUS Security Team <security@...ocus.com>
To: bugtraq@...urityfocus.com, full-disclosure@...ts.netsys.com
Subject: NSFOCUS SA2009-01 : UiTV UiPlayer UiCheck Component Stack Buffer Overflow Vulnerability

NSFOCUS Security Advisory (SA2009-01)

UiTV UiPlayer UiCheck Component Stack Buffer Overflow Vulnerability

Release Date: 2009-10-16

CVE ID: CVE-2009-2970

http://www.nsfocus.com/en/advisories/0901.html

Affected system:
==============

UiTV UiPlayer UiCheck.dll 1.0.0.6 and prior versions
 
Unaffected system:
==============

UiTV UiPlayer UiCheck.dll 1.0.0.7

Impact:
======

NSFOCUS Security Team discovered a stack buffer overflow vulnerability in
UiPlayer which allows remote attackers to run arbitrary code on user system
by crafting a malicious webpage.

Description:
==========

UiPlayer is a video player provided by UITV. Due to the cooperation with
Baibu and other companies, UiPlayer is integrated into many video players,
such as BaiduX. UiPlayer is embedded into browsers in the form of ActiveX,
and acquires video data in high speed by P2P technique. 

There exists a vulnerability in a component of UiPlayer, which allows attackers
to gain complete control over user's system.

UiCheck.dll in UiPlayer's installation directory is an ActiveX control that
will be loaded in IE. The interface function GetUiDllVersion() provided by
UiCheck.dll will copy the received filename parameter to a buffer of fixed
size. If the filename is over-long, it will trigger a stack buffer overflow.

Workaround:
===========

* Un-register UiCheck.dll by command "regsvr32 /u UiCheck.dll".

Vendor Status:
============

The vulnerability has been fixed by the vendor in the latest version, available
for download at the vendor's homepage:
http://www.uitv.cn/support/index.html

BaiduV:
http://v.baidu.com/xiaba/index.html

Additional Information:
==================

The Common Vulnerabilities and Exposures (CVE) project has assigned the name
CVE-2009-2970 to this issue. This is a candidate for inclusion in the CVE
list (http://cve.mitre.org), which standardizes names for security problems.
Candidates may change significantly before they become official CVE entries.

Credit:
=====

This vulnerability was discovered by Yu Yang of NSFOCUS Security Team.

DISCLAIMS:

THE INFORMATION PROVIDED IS RELEASED BY NSFOCUS "AS IS" WITHOUT WARRANTY OF
ANY KIND. NSFOCUS DISCLAIMS ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, EXCEPT
FOR THE WARRANTIES OF MERCHANTABILITY. IN NO EVENT SHALL NSFOCUS BE LIABLE
FOR ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL, CONSEQUENTIAL,
LOSS OF USINESS PROFITS OR SPECIAL DAMAGES, EVEN IF NSFOCUS HAS BEEN ADVISED
OF THE POSSIBILITY OF SUCH DAMAGES. DISTRIBUTION OR REPRODUCTION OF THE INFORMATION
IS PROVIDED THAT THE ADVISORY IS NOT MODIFIED IN ANY WAY.

(c) 2009 NSFOCUS.


-- 
Regards,

NSFOCUS Security Team <security@...ocus.com>
NSFOCUS Information Technology Co.,Ltd. (http://www.nsfocus.com)

PGP Key fingerprint = F8F2 F5D1 EF74 E08C 02FE 1B90 D7BF 7877 C6A6 F6DA
