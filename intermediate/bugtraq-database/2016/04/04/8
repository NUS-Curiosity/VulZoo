
Date: Sat, 2 Apr 2016 10:00:23 +0200 (CEST)
From: Martin Heiland <martin.heiland.lists@...n-xchange.com>
To: bugtraq@...urityfocus.com
Subject: Open-Xchange Security Advisory 2016-04-02

Product: Open-Xchange Server 6 / OX AppSuite
Vendor: Open-Xchange GmbH

Internal reference: 44409 (Bug ID)
Vulnerability type: Cross Site Scripting (CWE-80)
Vulnerable version: 7.8.0 and earlier
Vulnerable component: backend
Report confidence: Confirmed
Solution status: Fixed by Vendor
Fixed versions: 7.6.2-rev50, 7.6.3-rev8, 7.8.0-rev26
Researcher credits: Tim Schughart of ProSec Networks
Vendor notification: 2016-03-02
Solution date: 2016-03-14
Public disclosure: 2016-04-02
CVE reference: CVE-2016-2840
CVSSv2: 6.4 (AV:N/AC:L/Au:N/C:P/I:P/A:N)

Vulnerability Details:
The "session" parameter for file-download requests can be used to inject script code that gets reflected through the subsequent status page.

Risk:
Malicious script code can be executed within a trusted domains context. While no OX App Suite specific data can be manipulated, the vulnerability can be exploited without being authenticated and therefor used for social engineering attacks, stealing cookies or redirecting from trustworthy to malicious hosts.

Steps to reproduce:
Construct a HTTP GET request to the /api/mail servlet and "attachment" action that contains script code at the "session" parameter. The same applies to the /api/files servlet when requesting a HTML file. Since the session is not known to the system, a error page will be returned. This page reflects the provided value for the "session" parameter and browsers may execute embedded script code.

Solution:
Users should not open links from untrusted sources. Providers should update to the last publicly available Patch Releases (7.6.2-rev50, 7.6.3-rev8, 7.8.0-rev26) or later.



Internal reference: 44542 (Bug ID)
Vulnerability type: Cross Site Scripting (CWE-80)
Vulnerable version: 7.8.0 and earlier
Vulnerable component: frontend
Report confidence: Confirmed
Solution status: Fixed by Vendor
Fixed versions: 7.6.2-rev40, 7.6.3-rev7, 7.8.0-rev19
Researcher credits: Satish Bommisetty
Vendor notification: 2016-03-07
Solution date: 2016-03-14
Public disclosure: 2016-04-02
CVSSv3: 3.7 (AV:N/AC:H/PR:L/UI:R/S:U/C:L/I:L/A:N/RC:C)

Vulnerability Details:
App Suite Portal can be used to display files stored at OX Drive. In case a user has added a file to the portal where the file-name contains script code, it may get executed. Exploiting this vulnerability requires additional social-engineering steps. Malicious file-names can be distributed to other users by sharing a file or renaming a shared file which has already been added to the portal.

Risk:
Malicious script code can be executed within a users context. This can lead to session hijacking or triggering unwanted actions via the web interface (sending mail, deleting data etc.).

Steps to reproduce:
1. Create a file named "><img src=x onerror=alert(1)>.xlsx
2. Share the file to another user
3. Trick another user to add this file to the portal by using "Add to Portal" in Drive

Solution:
Users should not accept data and usage instructions from untrusted sources. Providers should update to the last publicly available Patch Releases (7.6.2-rev40, 7.6.3-rev7, 7.8.0-rev19) or later.

Download attachment "signature.asc" of type "application/pgp-signature" (822 bytes)
