
Date: Wed, 29 Feb 2012 11:18:37 -0500
From: Cisco Systems Product Security Incident Response Team <psirt@...co.com>
To: bugtraq@...urityfocus.com
Cc: psirt@...co.com
Subject: Cisco Security Advisory: Multiple Vulnerabilities in Cisco Wireless LAN Controllers 

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Multiple Vulnerabilities in Cisco Wireless LAN Controllers

Advisory ID: cisco-sa-20120229-wlc

Revision 1.0

For Public Release 2012 February 29 16:00  UTC (GMT)

Summary
=======

The Cisco Wireless LAN Controller (WLC) product family is affected by
the following vulnerabilities:

  * Cisco Wireless LAN Controllers HTTP Denial of Service Vulnerability
  * Cisco Wireless LAN Controllers IPv6 Denial of Service Vulnerability
  * Cisco Wireless LAN Controllers WebAuth Denial of Service Vulnerability
  * Cisco Wireless LAN Controllers Unauthorized Access Vulnerability


Cisco has released free software updates that address these
vulnerabilities. Workarounds are available that mitigate some of these
vulnerabilities.

This advisory is available at the following link:
http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20120229-wlc


Affected Products
=================

The Cisco WLC product family is affected by multiple vulnerabilities.
Affected versions of Cisco ASA Software vary depending on the specific
vulnerability.


Vulnerable Products
+------------------

For specific version information, refer to the Software Versions and
Fixes section of this advisory.

Each of the following products is affected by at least one of the
vulnerabilities covered in this Security Advisory:

  * Cisco 2000 Series WLC
  * Cisco 2100 Series WLC
  * Cisco 2500 Series WLC
  * Cisco 4100 Series WLC
  * Cisco 4400 Series WLC
  * Cisco 5500 Series WLC
  * Cisco 500 Series Wireless Express Mobility Controllers
  * Cisco Wireless Services Modules (WiSM)
  * Cisco Wireless Services Modules version 2 (WiSM version 2)
  * Cisco NME-AIR-WLC Modules for Integrated Services Routers (ISRs)
  * Cisco NM-AIR-WLC Modules for Integrated Services Routers (ISRs)
  * Cisco Catalyst 3750G Integrated WLCs
  * Cisco Flex 7500 Series Cloud Controllers

Note: The Cisco 2000 Series WLCs, Cisco 4100 Series WLCs, Cisco
NM-AIR-WLC, and Cisco 500 Series Wireless Express Mobility
Controllers, have reached end-of-software maintenance. The following
table includes the end-of-life document URL for each model:

+-------------------------------------------------------------------+
|Model                 |End of Life Document URL                    |
|----------------------+--------------------------------------------|
|Cisco 2000 Series WLC |http://www.cisco.com/en/US/prod/collateral/ |
|                      |wireless/ps6302/ps8322/ps6308/              |
|                      |prod_end-of-life_notice0900aecd805d22b0.html|
|----------------------+--------------------------------------------|
|Cisco 4100 Series WLC |http://www.cisco.com/en/US/prod/collateral/ |
|                      |wireless/ps6302/ps8322/ps6307/              |
|                      |prod_end-of-life_notice0900aecd803387a9.html|
|----------------------+--------------------------------------------|
|Cisco NM-AIR-WLC      |http://www.cisco.com/en/US/prod/collateral/ |
|Modules for ISR       |modules/ps2797/                             |
|                      |prod_end-of-life_notice0900aecd806aeb34.html|
|----------------------+--------------------------------------------|
|Cisco 500 Series      |http://www.cisco.com/en/US/prod/collateral/ |
|Wireless Express      |wireless/ps7306/ps7320/ps7339/              |
|Mobility Controllers  |end_of_life_c51-568040.html                 |
+-------------------------------------------------------------------+


Determination of Software Versions
+---------------------------------

To determine the WLC version that is running in a given environment,
use one of the following methods:

  * In the web interface, choose the Monitor tab, click Summary in
    the left pane, and note the Software Version field.
  * In the command-line interface, issue the show sysinfo command as
    shown in the following example:

(Cisco Controller)> show sysinfo

Manufacturer's Name.. Cisco Systems Inc.
Product Name......... Cisco Controller
Product Version...... 5.1.151.0
RTOS Version......... Linux-2.6.10_mvl401
Bootloader Version... 4.0.207.0
Build Type........... DATA + WPS
<output suppressed>


Products Confirmed Not Vulnerable
+--------------------------------

No other Cisco products are currently known to be affected by these
vulnerabilities.


Details
=======

Cisco WLCs and Cisco WiSMs are responsible for system-wide wireless
LAN functions, such as security policies, intrusion prevention, RF
management, quality of service (QoS), and mobility.

These devices communicate with controller-based access points over any
Layer 2 (Ethernet) or Layer 3 (IP) infrastructure using the
Lightweight Access Point Protocol (LWAPP) and the Control and
Provisioning of Wireless Access Points (CAPWAP) protocol.

The Cisco WLC family of devices is affected by the following
vulnerabilities:


Cisco Wireless LAN Controllers HTTP Denial of Service Vulnerability
+------------------------------------------------------------------

The Cisco Wireless LAN Controller (WLC) product family is affected by
a denial of service (DoS) vulnerability that could allow an
unauthenticated, remote attacker to cause the device to crash by
submitting a malformed URL to the administrative management interface.

This vulnerability is documented in Cisco bug ID CSCts81997 and has
been assigned Common Vulnerabilities and Exposures (CVE) ID
CVE-2012-0368.


Cisco Wireless LAN Controllers IPv6 Denial of Service Vulnerability
+------------------------------------------------------------------

The Cisco Wireless LAN Controller (WLC) product family is affected by
a denial of service (DoS) vulnerability where an unauthenticated
attacker could cause a device reload by sending a series of IPv6
packets.

This vulnerability is documented in Cisco bug ID CSCtt07949 and has
been assigned CVE ID CVE-2012-0369.


Cisco Wireless LAN Controllers WebAuth Denial of Service Vulnerability
+---------------------------------------------------------------------

The Cisco Wireless LAN Controller (WLC) product family is affected by
a denial of service (DoS) vulnerability where an unauthenticated
attacker could cause a device reload by sending a series of HTTP or
HTTPS packets to an affected controller configured for WebAuth.

This vulnerability can be exploited from both wired and wireless
segments. A TCP three-way handshake is needed in order to exploit
this vulnerability.

This vulnerability is documented in Cisco bug ID CSCtt47435 and has
been assigned CVE ID CVE-2012-0370.


Cisco Wireless LAN Controllers Unauthorized Access Vulnerability
+---------------------------------------------------------------

The Cisco Wireless LAN Controller (WLC) product family is affected by
an unauthorized access vulnerability where an unauthenticated attacker
could view and modify the configuration of an affected Cisco WLC.

This vulnerability exists if CPU based access control lists (ACLs) are
configured in the wireless controller. An attacker can exploit this
vulnerability by connecting to the controller over TCP port 1023. Only
the Cisco 4400 Series WLCs, WiSM version 1, and Cisco Catalyst 3750G
Integrated WLCs are affected by this vulnerability.

This vulnerability is documented in Cisco bug ID CSCtu56709 and has
been assigned CVE ID CVE-2012-0371.


Vulnerability Scoring Details
=============================

Cisco has scored the vulnerabilities in this advisory based on the
Common Vulnerability Scoring System (CVSS). The CVSS scoring in this
security advisory is in accordance with CVSS version 2.0.

CVSS is a standards-based scoring method that conveys vulnerability
severity and helps organizations determine the urgency and priority of
a response.

Cisco has provided a base and temporal score. Customers can also
compute environmental scores that help determine the impact of the
vulnerability in their own networks.

Cisco has provided additional information regarding CVSS at the
following link:
http://www.cisco.com/web/about/security/intelligence/cvss-qandas.html

Cisco has also provided a CVSS calculator to compute the environmental
impact for individual networks at the following link:
http://intellishield.cisco.com/security/alertmanager/cvss


* CSCts81997 - Cisco Wireless LAN Controllers HTTP Denial of Service Vulnerability

CVSS Base Score - 7.8
    Access Vector -            Network
    Access Complexity -        Low
    Authentication -           None
    Confidentiality Impact -   None
    Integrity Impact -         None
    Availability Impact -      Complete

CVSS Temporal Score - 6.4
    Exploitability -           Functional
    Remediation Level -        Official-Fix
    Report Confidence -        Confirmed


* CSCtt07949 - Cisco Wireless LAN Controllers IPv6 Denial of Service Vulnerability

CVSS Base Score - 7.8
    Access Vector -            Network
    Access Complexity -        Low
    Authentication -           None
    Confidentiality Impact -   None
    Integrity Impact -         None
    Availability Impact -      Complete

CVSS Temporal Score - 6.4
    Exploitability -           Functional
    Remediation Level -        Official-Fix
    Report Confidence -        Confirmed


* CSCtt47435 - Cisco Wireless LAN Controllers WebAuth Denial of Service Vulnerability

CVSS Base Score - 7.8
    Access Vector -            Network
    Access Complexity -        Low
    Authentication -           None
    Confidentiality Impact -   None
    Integrity Impact -         None
    Availability Impact -      Complete

CVSS Temporal Score - 6.4
    Exploitability -           Functional
    Remediation Level -        Official-Fix
    Report Confidence -        Confirmed


* CSCtu56709 - Cisco Wireless LAN Controllers Unauthorized Access Vulnerability

CVSS Base Score - 9.3
    Access Vector -            Network
    Access Complexity -        Medium
    Authentication -           None
    Confidentiality Impact -   Complete
    Integrity Impact -         Complete
    Availability Impact -      Complete

CVSS Temporal Score - 7.7
    Exploitability -           Functional
    Remediation Level -        Official-Fix
    Report Confidence -        Confirmed


Impact
======

Successful exploitation of the DoS vulnerabilities could allow an
unauthenticated attacker to cause an affected device to reload.
Repeated exploitation could result in a sustained DoS condition.

Successful exploitation of the unauthorized access vulnerability could
allow an unauthenticated attacker to view or modify the device
configuration.


Software Versions and Fixes
===========================

When considering software upgrades, customers are advised to consult
the Cisco Security Advisories and Responses archive at:
http://www.cisco.com/go/psirt

Review subsequent advisories to determine exposure and a complete
upgrade solution.

In all cases, customers should ensure that the devices to be upgraded
contain sufficient memory and confirm that current hardware and
software configurations will continue to be supported properly by the
new release. If the information is not clear, customers are advised to
contact the Cisco Technical Assistance Center (TAC) or their
contracted maintenance providers.

If a given release train is vulnerable, then the earliest possible
releases that contain the fix (along with the anticipated date of
availability for each, if applicable) are listed in the "First Fixed
Release" column of the table. A device running a release in the given
train that is earlier than the release in a specific column (less than
the First Fixed Release) is known to be vulnerable.

+-------------------------------------------------------------------+
| Vulnerability/Bug ID         | Affected   | First Fixed Release   |
|                              | Release    |                       |
|------------------------------+------------+-----------------------|
|                              | 4.0        | Vulnerable; Migrate   |
|                              |            | to 7.0 or later       |
|                              |------------+-----------------------|
|                              | 4.1        | Vulnerable; Migrate   |
|                              |            | to 7.0 or later       |
|                              |------------+-----------------------|
|                              | 4.1M       | Vulnerable; Migrate   |
|                              |            | to 7.0 or later       |
|                              |------------+-----------------------|
|                              | 4.2        | Vulnerable; Migrate   |
|                              |            | to 7.0 or later       |
|                              |------------+-----------------------|
|                              | 4.2M       | Vulnerable; Migrate   |
|                              |            | to 7.0 or later       |
|                              |------------+-----------------------|
| HTTP DoS Vulnerability       | 5.0        | Vulnerable; Migrate   |
| (CSCts81997)                 |            | to 7.0 or later       |
|                              |------------+-----------------------|
|                              | 5.1        | Vulnerable; Migrate   |
|                              |            | to 7.0 or later       |
|                              |------------+-----------------------|
|                              | 5.2        | Vulnerable; Migrate   |
|                              |            | to 7.0 or later       |
|                              |------------+-----------------------|
|                              | 6.0        | Vulnerable; Migrate   |
|                              |            | to 7.0 or later       |
|                              |------------+-----------------------|
|                              | 7.0        | 7.0.220.0             |
|                              |------------+-----------------------|
|                              | 7.1        | 7.1.91.0              |
|                              |------------+-----------------------|
|                              | 7.2        | 7.2.103.0             |
|------------------------------+------------+-----------------------|
|                              | 4.0        | Not Vulnerable        |
|                              |------------+-----------------------|
|                              | 4.1        | Not Vulnerable        |
|                              |------------+-----------------------|
|                              | 4.1M       | Not Vulnerable        |
|                              |------------+-----------------------|
|                              | 4.2        | Not Vulnerable        |
|                              |------------+-----------------------|
|                              | 4.2M       | Not Vulnerable        |
|                              |------------+-----------------------|
|                              | 5.0        | Not Vulnerable        |
|                              |------------+-----------------------|
| IPv6DoS Vulnerability        | 5.1        | Not Vulnerable        |
|(CSCtt07949)                  |------------+-----------------------|
|                              | 5.2        | Not Vulnerable        |
|                              |------------+-----------------------|
|                              | 6.0        | Vulnerable; Migrate   |
|                              |            | to 7.0 or later       |
|                              |------------+-----------------------|
|                              | 7.0        | 7.0.220.0             |
|                              |------------+-----------------------|
|                              | 7.1        | 7.1.91.0              |
|                              |------------+-----------------------|
|                              | 7.2        | 7.2.103.0             |
|------------------------------+------------+-----------------------|
|                              | 4.0        | Vulnerable; Migrate   |
|                              |            | to 7.0 or later       |
|                              |------------+-----------------------|
|                              | 4.1        | Vulnerable; Migrate   |
|                              |            | to 7.0 or later       |
|                              |------------+-----------------------|
|                              | 4.1M       | Vulnerable; Migrate   |
|                              |            | to 7.0 or later       |
|                              |------------+-----------------------|
|                              | 4.2        | Vulnerable; Migrate   |
|                              |            | to 7.0 or later       |
|                              |------------+-----------------------|
|                              | 4.2M       | Vulnerable; Migrate   |
|                              |            | to 7.0 or later       |
|                              |------------+-----------------------|
| WebAuth DoS Vulnerability    | 5.0        | Vulnerable; Migrate   |
| (CSCtt47435)                 |            | to 7.0 or later       |
|                              |------------+-----------------------|
|                              | 5.1        | Vulnerable; Migrate   |
|                              |            | to 7.0 or later       |
|                              |------------+-----------------------|
|                              | 5.2        | Vulnerable; Migrate   |
|                              |            | to 7.0 or later       |
|                              |------------+-----------------------|
|                              | 6.0        | Vulnerable; Migrate   |
|                              |            | to 7.0 or later       |
|                              |------------+-----------------------|
|                              | 7.0        | 7.0.220.0             |
|                              |------------+-----------------------|
|                              | 7.1        | 7.1.91.0              |
|                              |------------+-----------------------|
|                              | 7.2        |  Not Vulnerable       |
|------------------------------+------------+-----------------------|
|                              | 4.0        | Vulnerable; Migrate   |
|                              |            | to 7.0 or later       |
|                              |------------+-----------------------|
|                              | 4.1        | Vulnerable; Migrate   |
|                              |            | to 7.0 or later       |
|                              |------------+-----------------------|
|                              | 4.1M       | Vulnerable; Migrate   |
|                              |            | to 7.0 or later       |
|                              |------------+-----------------------|
|                              | 4.2        | Vulnerable; Migrate   |
|                              |            | to 7.0 or later       |
|                              |------------+-----------------------|
|                              | 4.2M       | Vulnerable; Migrate   |
|                              |            | to 7.0 or later       |
|                              |------------+-----------------------|
| Unauthorized Access          | 5.0        | Vulnerable; Migrate   |
| Vulnerability (CSCtu56709)   |            | to 7.0 or later       |
|                              |------------+-----------------------|
|                              | 5.1        | Vulnerable; Migrate   |
|                              |            | to 7.0 or later       |
|                              |------------+-----------------------|
|                              | 5.2        | Vulnerable; Migrate   |
|                              |            | to 7.0 or later       |
|                              |------------+-----------------------|
|                              | 6.0        | Vulnerable; Migrate   |
|                              |            | to 7.0 or later       |
|                              |------------+-----------------------|
|                              | 7.0        | 7.0.220.4             |
|                              |------------+-----------------------|
|                              | 7.1        | Not Vulnerable        |
|                              |------------+-----------------------|
|                              | 7.2        | Not Vulnerable        |
+-------------------------------------------------------------------+


Recommended Releases
+-------------------

The "Recommended Release" table lists the releases which have fixes
for all the published vulnerabilities at the time of this Advisory.
Cisco recommends upgrading to a release equal to or later than the
release in the "Recommended Releases" table.

+-------------------------------------------------------------------+
| Affected Release             | Recommended Release                |
|------------------------------+------------------------------------|
| 7.0                          | 7.0.230.0                          |
|------------------------------+------------------------------------|
| 7.1                          | 7.1.91.0                           |
|------------------------------+------------------------------------|
| 7.2                          | 7.2.103.0                          |
+-------------------------------------------------------------------+


Workarounds
===========

This Cisco Security Advisory describes multiple distinct
vulnerabilities. These vulnerabilities and their respective
workarounds are independent of each other.

Cisco Wireless LAN Controllers HTTP Denial of Service Vulnerability
There are no workarounds to mitigate this vulnerability.

Cisco Wireless LAN Controllers IPv6 Denial of Service Vulnerability
There are no workarounds to mitigate this vulnerability.

Cisco Wireless LAN Controllers WebAuth Denial of Service Vulnerability
There are no workarounds to mitigate this vulnerability.

Cisco Wireless LAN Controllers Unauthorized Access Vulnerability CPU
based ACLs can be configured to block access to the affected WLC on
TCP port 1023. After ACLs are defined, they can be applied to the
management interface, the access point manager (AP-manager) interface,
or any of the dynamic interfaces for client data traffic or to the
Network Processing Unit (NPU) interface for traffic to the controller
CPU.

Additional mitigations that can be deployed on Cisco devices in the
network are available in the Cisco Applied Mitigation Bulletin
companion document for this advisory, which is available at the
following link:
http://tools.cisco.com/security/center/content/CiscoAppliedMitigationBulletin/cisco-amb-20120229-wlc


Obtaining Fixed Software
========================

Cisco has released free software updates that address the
vulnerabilities described in this advisory. Prior to deploying
software, customers are advised to consult their maintenance providers
or check the software for feature set compatibility and known issues
that are specific to their environments.

Customers may only install and expect support for feature sets they
have purchased. By installing, downloading, accessing, or otherwise
using such software upgrades, customers agree to follow the terms of
the Cisco software license at:
http://www.cisco.com/en/US/docs/general/warranty/English/EU1KEN_.html

Or as set forth at http://www.cisco.com/public/sw-center/sw-usingswc.shtml

Do not contact psirt@...co.com or security-alert@...co.com for
software upgrades.


Customers with Service Contracts
+-------------------------------

Customers with contracts should obtain upgraded software through their
regular update channels. For most customers, upgrades should be
obtained through the Software Center on Cisco.com at:
http://www.cisco.com


Customers Using Third-Party Support Organizations
+------------------------------------------------

Customers with Cisco products that are provided or maintained through
prior or existing agreements with third-party support organizations,
such as Cisco Partners, authorized resellers, or service providers,
should contact that organization for assistance with the appropriate
course of action.

The effectiveness of any workaround or fix depends on specific
customer situations, such as product mix, network topology, traffic
behavior, and organizational mission. Because of the variety of
affected products and releases, customers should consult their service
providers or support organizations to ensure that any applied
workaround or fix is the most appropriate in the intended network
before it is deployed.


Customers Without Service Contracts
+----------------------------------

Customers who purchase directly from Cisco but do not hold a Cisco
service contract and customers who make purchases through third-party
vendors but are unsuccessful in obtaining fixed software through their
point of sale should obtain upgrades by contacting the Cisco Technical
Assistance Center (TAC):

  * +1 800 553 2447 (toll free from within North America)
  * +1 408 526 7209 (toll call from anywhere in the world)
  * e-mail: tac@...co.com

Customers should have the product serial number available and be
prepared to provide the URL of this advisory as evidence of
entitlement to a free upgrade. Customers without service contracts
should request free upgrades through the TAC.

Refer to Cisco Worldwide Contacts at:
http://www.cisco.com/en/US/support/tsd_cisco_worldwide_contacts.html

For additional TAC contact information, including localized telephone
numbers, instructions, and e-mail addresses for support in various
languages.


Exploitation and Public Announcements
=====================================

The Cisco Product Security Incident Response Team (PSIRT) is not aware
of any public announcements or malicious use of the vulnerabilities
that are described in this advisory.

These vulnerabilities were found during internal testing and during
the troubleshooting of customer service requests.


Status of This Notice: Final
============================

THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY
KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF
MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE
INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS
AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS
DOCUMENT AT ANY TIME.

A stand-alone copy or Paraphrase of the text of this document that
omits the distribution URL in the following section is an
uncontrolled copy, and may lack important information or contain
factual errors.


Distribution
============

This advisory is posted on Cisco Security Intelligence Operations at
the following link:
http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20120229-wlc

Additionally, a text version of this advisory is clear signed with
the Cisco PSIRT PGP key and circulated among the following e-mail
addresses:

  * cust-security-announce@...co.com
  * first-bulletins@...ts.first.org
  * bugtraq@...urityfocus.com
  * vulnwatch@...nwatch.org
  * cisco@...t.colorado.edu
  * cisco-nsp@...k.nether.net
  * full-disclosure@...ts.grok.org.uk

Future updates of this advisory, if any, will reside on Cisco.com but
may not be announced on mailing lists. Users can monitor this
advisory's URL for any updates.


Revision History
================

+-------------------------------------------------------------------+
| Revision 1.0   | 2012-February-29   | Initial public release.     |
+-------------------------------------------------------------------+


Cisco Security Procedures
=========================

Complete information about reporting security vulnerabilities in
Cisco products, obtaining assistance with security incidents, and
registering to receive security information from Cisco is available
on Cisco.com at:
http://www.cisco.com/en/US/products/products_security_vulnerability_policy.html

This web page includes instructions for press inquiries regarding
Cisco Security Advisories. All Cisco Security Advisories are available
at:
http://www.cisco.com/go/psirt

+--------------------------------------------------------------------
Copyright 2010-2012 Cisco Systems, Inc. All rights reserved.
+--------------------------------------------------------------------
-----BEGIN PGP SIGNATURE-----
Version: GnuPG/MacGPG2 v2.0.17 (Darwin)
Comment: GPGTools - http://gpgtools.org

iF4EAREIAAYFAk9NNsMACgkQQXnnBKKRMNAT9QD/eiMEVJB+F+vzCBMq6lCKbhxM
fvIvDvBx2ZAMARO9pK8A/Rg0q1bR1eL4gblRgg8swazzbV/Pz0A3G4UtSx+gfXBz
=lRis
-----END PGP SIGNATURE-----
