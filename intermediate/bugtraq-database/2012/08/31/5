
Date: Thu, 30 Aug 2012 21:32:35 GMT
From: LpSolit@...il.com
To: bugtraq@...urityfocus.com
Subject: Security advisory for Bugzilla 4.3.3, 4.2.3, 4.0.8 and 3.6.11

Summary
=======

Bugzilla is a Web-based bug-tracking system used by a large number of
software projects. The following security issues have been discovered
in Bugzilla:

* When the user logs in using LDAP, the username is not escaped
  before being passed to LDAP which could potentially lead to LDAP
  injection.

* Extensions are not protected against directory browsing by default
  and users can view the source code of templates used by the
  extensions. These templates may contain sensitive data.

All affected installations are encouraged to upgrade as soon as
possible.


Vulnerability Details
=====================

Class:       LDAP Injection
Versions:    2.12 to 3.6.10, 3.7.1 to 4.0.7, 4.1.1 to 4.2.2,
             4.3.1 to 4.3.2
Fixed In:    3.6.11, 4.0.8, 4.2.3, 4.3.3
Description: When the user logs in using LDAP, the username is not
             escaped when building the uid=$username filter which is
             used to query the LDAP directory. This could potentially
             lead to LDAP injection.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=785470
CVE Number:  CVE-2012-3981

Class:       Directory Browsing
Versions:    2.23.2 to 3.6.10, 3.7.1 to 4.0.7, 4.1.1 to 4.2.2,
             4.3.1 to 4.3.2
Fixed In:    4.0.8, 4.2.3, 4.3.3
Description: Extensions are not protected against directory browsing
             and users can access the source code of the templates
             which may contain sensitive data.
             Directory browsing is blocked in Bugzilla 4.3.3 only,
             because it requires a configuration change in the Apache
             httpd.conf file to allow local .htaccess files to use
             Options -Indexes. To not break existing installations,
             this fix has not been backported to stable branches.
             The access to templates is blocked for all supported
             branches except the old 3.6 branch, because this branch
             doesn't have .htaccess in the bzr repository and cannot
             be fixed easily for existing installations without
             potentially conflicting with custom changes.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=785522
             https://bugzilla.mozilla.org/show_bug.cgi?id=785511
CVE Number:  none

Vulnerability Solutions
=======================

The fixes for these issues are included in the 3.6.11, 4.0.8, 4.2.3
and 4.3.3 releases. Upgrading to a release with the relevant fixes will
protect your installation from possible exploits of these issues.

If you are unable to upgrade but would like to patch just the
individual security vulnerabilities, there are patches available for
each issue at the "References" URL for each vulnerability.

Full release downloads, patches to upgrade Bugzilla from previous
versions, and CVS/bzr upgrade instructions are available at:

  http://www.bugzilla.org/download/


Credits
=======

The Bugzilla team wish to thank the following people/organizations for
their assistance in locating, advising us of, and assisting us to fix
this issue:

Fr�d�ric Buclin
Reed Loden
Byron Jones
Lockheed Martin

General information about the Bugzilla bug-tracking system can be found
at:

  http://www.bugzilla.org/

Comments and follow-ups can be directed to the mozilla.support.bugzilla
newsgroup or the support-bugzilla mailing list.
http://www.bugzilla.org/support/ has directions for accessing these
forums.
