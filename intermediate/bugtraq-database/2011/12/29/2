
Date: Tue, 27 Dec 2011 16:05:30 -0500 (EST)
From: security-alert@...com
To: bugtraq@...urityfocus.com
Subject: [security bulletin] HPSBPI02728 SSRT100692 rev.2 - Certain HP Printers and HP Digital Senders, Remote Firmware Update Enabled by Default

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

SUPPORT COMMUNICATION - SECURITY BULLETIN

Document ID: c03102449
Version: 2

HPSBPI02728 SSRT100692 rev.2 - Certain HP Printers and HP Digital Senders, Remote Firmware Update Enabled by Default

NOTICE: The information in this Security Bulletin should be acted upon as soon as possible.

Release Date: 2011-11-30
Last Updated: 2011-12-23

Potential Security Impact: Remote firmware update enabled by default

Source: Hewlett-Packard Company, HP Software Security Response Team

VULNERABILITY SUMMARY
A potential security vulnerability has been identified with certain HP printers and HP digital senders. The vulnerability could be exploited remotely to install unauthorized printer firmware.

References: CVE-2011-4161

SUPPORTED SOFTWARE VERSIONS*: ONLY impacted versions are listed.
HP LaserJet Enterprise 500 color M551

HP LaserJet Enterprise 600 M601

HP LaserJet Enterprise 600 M602

HP LaserJet Enterprise 600 M603

HP Color LaserJet CM1312 Multifunction Printer

HP LaserJet Pro CM1415 Color Multifunction Printer

HP Color LaserJet CP1510

HP LaserJet M1522 Multifunction Printer

HP LaserJet Pro CP1525 Color Printer

HP LaserJet Pro M1536 Multifunction Printer

HP Color LaserJet CP2025

HP LaserJet P2035

HP LaserJet P2055

HP Color LaserJet CM2320 Multifunction Printer

HP LaserJet M2727 Multifunction Printer

HP Color LaserJet 3000

HP LaserJet P3005

HP LaserJet Enterprise P3015

HP LaserJet M3027 Multifunction Printer

HP LaserJet M3035

HP Color LaserJet CP3505

HP Color LaserJet CP3525

HP Color LaserJet CM3530

HP Color LaserJet 3800

HP Color LaserJet CP4005

HP LaserJet P4014

HP LaserJet P4015

HP LaserJet 4240

HP LaserJet 4250

HP LaserJet 4345 Multifunction Printer

HP LaserJet 4350

HP LaserJet P4515

HP Color LaserJet Enterprise CP4520

HP Color LaserJet Enterprise CP4525

HP Color LaserJet Enterprise CM4540 Multifunction Printer

HP LaserJet Enterprise M4555 Multifunction Printer

HP Color LaserJet 4700

HP Color LaserJet 4730 Multifunction Printer

HP Color LaserJet CM4730 Multifunction Printer

HP LaserJet M5025 Multifunction Printer

HP LaserJet M5035

HP LaserJet 5200n

HP Color LaserJet Professional CP5225 Printer

HP Color LaserJet CP5525

HP Color LaserJet 5550

HP Color LaserJet CP6015

HP Color LaserJet CM6030

HP Color LaserJet CM6040

HP CM8060 Color Multifunction Printer with Edgeline

HP LaserJet 9040

HP LaserJet M9040 Multifunction Printer

HP LaserJet 9050

HP LaserJet M9050 Multifunction Printer

HP 9200c Digital Sender

HP 9250c Digital Sender

HP Color LaserJet 9500

BACKGROUND

CVSS 2.0 Base Metrics
===========================================================
  Reference              Base Vector             Base Score
CVE-2011-4161    (AV:N/AC:L/Au:N/C:C/I:C/A:C)       10.0
===========================================================
             Information on CVSS is documented
            in HP Customer Notice: HPSN-2008-002

Note: For further information on Secure Printing and Imaging please refer to http://www.hp.com/go/secureprinting

Remote Firmware Update (RFU): The Remote Firmware Update (RFU) feature is enabled by default. A firmware update can be sent remotely to port 9100 without authentication. This could allow unauthorized modification of the device firmware. The unauthorized firmware could impact the confidentiality and integrity of data sent to and received from the device. The unauthorized firmware could also cause a Denial of Service (DoS) to the device.

RESOLUTION

The following steps can be taken to avoid unauthorized firmware updates:

Update the firmware to a version that implements code signing
Disable the Remote Firmware Update

The code signing feature verifies that firmware updates are properly signed. This will prevent the installation of invalid firmware updates.

The following table lists the availability of RFU disabling and code signing.

Product
 RFU Can Be Disabled
 Code Signing Firmware Available

HP LaserJet Enterprise 500 color M551
 Yes
 Yes

HP LaserJet Enterprise 600 M601
 Yes
 Yes

HP LaserJet Enterprise 600 M602
 Yes
 Yes

HP LaserJet Enterprise 600 M603
 Yes
 Yes

HP Color LaserJet CM1312 Multifunction Printer
 Yes, Note 1
 No

HP LaserJet Pro CM1415 Color Multifunction Printer
 Yes, Note 1
 Yes

HP Color LaserJet CP1510
 Yes, Note 1
 No

HP LaserJet M1522 Multifunction Printer
 Yes, Note 1
 No

HP LaserJet Pro CP1525 Color Printer
 Yes, Note 1
 Yes

HP LaserJet Pro M1536 Multifunction Printer
 Yes, Note 1
 Yes

HP Color LaserJet CP2025
 Yes, Note 1
 No

HP LaserJet P2035
 Yes
 No

HP LaserJet P2055
 Yes
 No

HP Color LaserJet CM2320 Multifunction Printer
 Yes, Note 1
 No

HP LaserJet M2727 Multifunction Printer
 Yes, Note 1
 No

HP Color LaserJet 3000
 Yes
 No

HP LaserJet P3005
 Yes
 No

HP LaserJet Enterprise P3015
 Yes
 Yes, Note 2

HP LaserJet M3027 Multifunction Printer
 Yes
 Yes, Note 2

HP LaserJet M3035
 Yes
 Yes, Note 2

HP Color LaserJet CP3505
 Yes
 No

HP Color LaserJet CP3525
 Yes
 Yes, Note 2

HP Color LaserJet CM3530
 Yes
 Yes, Note 2

HP Color LaserJet 3800
 Yes
 Yes

HP Color LaserJet CP4005
 Yes
 Yes

HP LaserJet P4014
 Yes
 Yes, Note 2

HP LaserJet P4015
 Yes
 Yes, Note 2

HP LaserJet 4240
 Yes
 No

HP LaserJet 4250
 Yes
 No

HP LaserJet 4345 Multifunction Printer
 Yes
 Yes, Note 2

HP LaserJet 4350
 Yes
 No

HP LaserJet P4515
 Yes
 Yes, Note 2

HP Color LaserJet Enterprise CP4520
 Yes
 Yes

HP Color LaserJet Enterprise CP4525
 Yes
 Yes, Note 2

HP Color LaserJet Enterprise CM4540 Multifunction Printer
 Yes
 Yes

HP LaserJet Enterprise M4555 Multifunction Printer
 Yes
 Yes

HP Color LaserJet 4700
 Yes
 Yes

HP Color LaserJet 4730 Multifunction Printer
 Yes
 Yes, Note 2

HP Color LaserJet CM4730 Multifunction Printer
 Yes
 Yes

HP LaserJet M5025 Multifunction Printer
 Yes
 Yes, Note 2

HP LaserJet M5035
 Yes
 Yes, Note 2

HP LaserJet 5200L
 Yes
 Yes, Note 2

HP LaserJet 5200N
 Yes
 Yes, Note 2

HP Color LaserJet Professional CP5225 Printer
 Yes, Note 1
 No

HP Color LaserJet CP5525
 Yes
 Yes

HP Color LaserJet 5550
 Yes
 No

HP Color LaserJet CP6015
 Yes
 Yes, Note 2

HP Color LaserJet CM6030
 Yes
 Yes, Note 2

HP Color LaserJet CM6040
 Yes
 Yes, Note 2

HP CM8060 Color Multifunction Printer with Edgeline
 Yes
 Yes

HP LaserJet 9040
 Yes
 Yes, Note 2

HP LaserJet M9040 Multifunction Printer
 Yes
 Yes, Note 2

HP LaserJet 9050
 Yes
 Yes, Note 2

HP LaserJet M9050 Multifunction Printer
 Yes
 Yes, Note 2

HP 9200c Digital Sender
 Yes
 No

HP 9250c Digital Sender
 Yes
 Yes, Note 2

HP Color LaserJet 9500
 Yes
 No

Note 1 - To add the ability to disable RFU, update to the firmware version listed in the following table.

Product
 Firmware Version Adding Disable RFU Capability

HP Color LaserJet CM1312 Multifunction Printer
 20111209

HP LaserJet Pro CM1415 Color Multifunction Printer
 20111215

HP Color LaserJet CP1510
 20111209

HP LaserJet M1522 Multifunction Printer
 20111212

HP LaserJet Pro CP1525 Color Printer
 20111215

HP LaserJet Pro M1536 Multifunction Printer
 20111215

HP Color LaserJet CP2025
 20111208

HP LaserJet P2035
 20111213

HP LaserJet P2055
 20111214

HP Color LaserJet CM2320 Multifunction Printer
 20111209

HP LaserJet M2727 Multifunction Printer
 20111212

HP Color LaserJet Professional CP5225 Printer
 20111206

Note 2 - To add code signing, update to the firmware version listed in the following table.

Product
 Firmware Version Adding Code Signing

HP LaserJet Enterprise P3015
 07.130.0B

HP LaserJet M3027 Multifunction Printer
 48.240.0B

HP LaserJet M3035
 48.240.0B

HP Color LaserJet CP3525
 06.130.0B

HP Color LaserJet CM3530
 53.170.1B

HP LaserJet P4014
 04.160.2B

HP LaserJet P4015
 04.160.2B

HP LaserJet 4345 Multifunction Printer
 48.240.0B

HP LaserJet P4515
 04.160.2B

HP Color LaserJet Enterprise CP4525
 07.110.2B

HP Color LaserJet 4730 Multifunction Printer
 50.220.1B

HP LaserJet M5025 Multifunction Printer
 48.240.0B

HP LaserJet M5035
 48.240.0B

HP LaserJet 5200L
 08.180.1B

HP LaserJet 5200N
 08.180.1B

HP Color LaserJet CP6015
 04.150.0B

HP Color LaserJet CM6030
 52.190.1B

HP Color LaserJet CM6040
 52.190.1B

HP LaserJet 9040
 08.220.1B

HP LaserJet M9040 Multifunction Printer
 51.190.1B

HP LaserJet 9050
 08.220.1B

HP LaserJet M9050 Multifunction Printer
 51.190.1B

HP 9250c Digital Sender
 48.230.0B

How to Download the Firmware Update

Browse to www.hp.com/go/support then:

Select "Drivers & Software"
Enter the product name listed in the table above into the search field
Click on "Search"
If the search returns a list of products click on the appropriate product
Under "Select operating system" click on "Cross operating system (BIOS, Firmware, Diagnostics, etc.)"
If the "Cross operating system ..." link is not present, select any Windows operating system from the list.
Select the appropriate firmware update under "Firmware"

How to Disable the Remote Firmware Update (RFU)

For instructions about how to disable the RFU please refer to the following document: Configuring Remote Firmware Update on HP Printers and Multifunction Devices

The document is available using ftp:

ftp.usa.hp.com
account: sb02728
password: Secure12

or

ftp://sb02728:Secure12@....usa.hp.com/

File name: Configuring Remote Firmware Update on HP Printing Devices.pdf

HISTORY
Version:1 (rev.1) - 30 November 2011 Initial release
Version:2 (rev.2) - 23 December 2011 Code signing firmware available

Third Party Security Patches: Third party security patches that are to be installed on systems running HP software products should be applied in accordance with the customer's patch management policy.

Support: For issues about implementing the recommendations of this Security Bulletin, contact normal HP Services support channel.  For other issues about the content of this Security Bulletin, send e-mail to security-alert@...com.

Report: To report a potential security vulnerability with any HP supported product, send Email to: security-alert@...com

Subscribe: To initiate a subscription to receive future HP Security Bulletin alerts via Email: http://h41183.www4.hp.com/signup_alerts.php?jumpid=hpsc_secbulletins

Security Bulletin List: A list of HP Security Bulletins, updated periodically, is contained in HP Security Notice HPSN-2011-001: https://h20566.www2.hp.com/portal/site/hpsc/public/kb/docDisplay/?docId=emr_na-c02964430

Security Bulletin Archive: A list of recently released Security Bulletins is available here: http://h20566.www2.hp.com/portal/site/hpsc/public/kb/secBullArchive/

Software Product Category: The Software Product Category is represented in the title by the two characters following HPSB.

3C = 3COM
3P = 3rd Party Software
GN = HP General Software
HF = HP Hardware and Firmware
MP = MPE/iX
MU = Multi-Platform Software
NS = NonStop Servers
OV = OpenVMS
PI = Printing and Imaging
PV = ProCurve
ST = Storage Software
TU = Tru64 UNIX
UX = HP-UX

Copyright 2011 Hewlett-Packard Development Company, L.P.
Hewlett-Packard Company shall not be liable for technical or editorial errors or omissions contained herein. The information provided is provided "as is" without warranty of any kind. To the extent permitted by law, neither HP or its affiliates, subcontractors or suppliers will be liable for incidental,special or consequential damages including downtime cost; lost profits;damages relating to the procurement of substitute products or services; or damages for loss of data, or software restoration. The information in this document is subject to change without notice. Hewlett-Packard Company and the names of Hewlett-Packard products referenced herein are trademarks of Hewlett-Packard Company in the United States and other countries. Other product and company names mentioned herein may be trademarks of their respective owners.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)

iEYEARECAAYFAk70SlMACgkQ4B86/C0qfVnW0gCfWhmGFhR35DVsXxJKLz3jZyOm
J54An0Fkzq+mLKBxHvtFE2MHOvpxLtR9
=AzNK
-----END PGP SIGNATURE-----
