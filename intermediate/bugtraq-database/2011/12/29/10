
Date: Thu, 29 Dec 2011 16:36:58 GMT
From: LpSolit@...il.com
To: bugtraq@...urityfocus.com
Subject: Security advisory for Bugzilla 4.2rc1, 4.0.3, 3.6.7 and 3.4.13

Summary
=======

Bugzilla is a Web-based bug-tracking system used by a large number of
software projects. The following security issues have been discovered
in Bugzilla:

* When viewing tabular or graphical reports as well as new charts,
  an XSS vulnerability is possible in debug mode.

* The User.offer_account_by_email WebService method lets you create
  a new user account even if the active authentication method forbids
  users to create an account.

* A CSRF vulnerability in post_bug.cgi and in attachment.cgi could
  lead to the creation of unwanted bug reports and attachments.

All affected installations are encouraged to upgrade as soon as
possible.


Vulnerability Details
=====================

Class:       Cross-Site Scripting
Versions:    2.17.1 to 3.4.12, 3.5.1 to 3.6.6, 3.7.1 to 4.0.2,
             4.1.1 to 4.1.3
Fixed In:    3.4.13, 3.6.7, 4.0.3, 4.2rc1
Description: Tabular and graphical reports, as well as new charts have
             a debug mode which displays raw data as plain text. This
             text is not correctly escaped and a crafted URL could
             use this vulnerability to inject code leading to XSS.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=697699
CVE Number:  CVE-2011-3657

Class:       Unauthorized Account Creation
Versions:    2.23.3 to 3.4.12, 3.5.1 to 3.6.6, 3.7.1 to 4.0.2,
             4.1.1 to 4.1.3
Fixed In:    3.4.13, 3.6.7, 4.0.3, 4.2rc1
Description: The User.offer_account_by_email WebService method ignores
             the user_can_create_account setting of the authentication
             method and generates an email with a token in it which the
             user can use to create an account. Depending on the
             authentication method being active, this could allow the
             user to log in using this account.
             Installations where the createemailregexp parameter is
             empty are not vulnerable to this issue.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=711714
CVE Number:  CVE-2011-3667

Class:       Cross-Site Request Forgery
Versions:    2.0 to 3.4.12, 3.5.1 to 3.6.6, 3.7.1 to 4.0.2,
             4.1.1 to 4.1.3
Fixed In:    4.2rc1
Description: The creation of bug reports and of attachments is not
             protected by a token and so they can be created without
             the consent of a user if the relevant code is embedded
             in an HTML page and the user visits this page. This
             behavior was intentional to let third-party applications
             submit new bug reports and attachments easily. But as this
             behavior can be abused by a malicious user, it has been
             decided to block submissions with no valid token starting
             from version 4.2rc1. Older branches are not patched to not
             break these third-party applications after the upgrade.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=703975
             https://bugzilla.mozilla.org/show_bug.cgi?id=703983
CVE Number:  none

Vulnerability Solutions
=======================

The fixes for these issues are included in the 3.4.13, 3.6.7, 4.0.3,
and 4.2rc1 releases. Upgrading to a release with the relevant fixes will
protect your installation from possible exploits of these issues.

If you are unable to upgrade but would like to patch just the
individual security vulnerabilities, there are patches available for
each issue at the "References" URL for each vulnerability.

Full release downloads, patches to upgrade Bugzilla from previous
versions, and CVS/bzr upgrade instructions are available at:

  http://www.bugzilla.org/download/


Credits
=======

The Bugzilla team wish to thank the following people/organizations for
their assistance in locating, advising us of, and assisting us to fix
this issue:

Byron Jones
Fr�d�ric Buclin
Gervase Markham
David Lawrence
RedTeam Pentesting
Reed Loden
Max Kanat-Alexander
Mario Gomes

General information about the Bugzilla bug-tracking system can be found
at:

  http://www.bugzilla.org/

Comments and follow-ups can be directed to the mozilla.support.bugzilla
newsgroup or the support-bugzilla mailing list.
http://www.bugzilla.org/support/ has directions for accessing these
forums.
