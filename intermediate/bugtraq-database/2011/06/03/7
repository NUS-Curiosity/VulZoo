
Date: Thu, 02 Jun 2011 17:38:50 -0400
From: labs-no-reply <labs-no-reply@...p.vrsn.com>
To: bugtraq@...urityfocus.com, vulnwatch@...nwatch.org,
	full-disclosure@...ts.grok.org.uk
Subject: iDefense Security Advisory 06.01.11: Cisco AnyConnect VPN Client
 Arbitrary Program Execution Vulnerability

iDefense Security Advisory 06.01.11
http://labs.idefense.com/intelligence/vulnerabilities/
Jun 01, 2011

I. BACKGROUND

Cisco's AnyConnect VPN solution provides remote access to customers via
the Web browser. This is accomplished through the use of an ActiveX
control. The control itself is provided by the server upon connecting.
Cisco states that AnyConnect VPN supports all Adaptive Security
Appliance (ASA) models. For more information, visit the following URL.

http://www.cisco.com/en/US/docs/security/vpn_client/anyconnect/anyconnect23/release/notes/anyconnect23rn.html

II. DESCRIPTION

Remote exploitation of a design error within Cisco Systems Inc's
AnyConnect VPN client allows attackers to execute arbitrary code with
the privileges of a user running Internet Explorer.

The vulnerability exists within the ActiveX control with the following
identifiers:

  CLSID: 55963676-2F5E-4BAF-AC28-CF26AA587566
  ProgId: Cisco.AnyConnect.VPNWeb.1
  File: %WINDIR%\system32\vpnweb.ocx

This ActiveX control is not marked as safe for initialization or
scripting within the registry, but it does implement IObjectSafety. When
queried, this control's IObjectSafety interface reports that it is safe
for both scripting and initialization.

This ActiveX control is used to install the VPN client. Once it is
instantiated, it will attempt to download two files from the site
supported in the "url" property. As such, an attacker can craft a page
such that the control will download an executable of their choosing.

One of the files will be executed upon the successful completion of the
download. This allows an attacker to execute an arbitrary executable on
the user's system.

III. ANALYSIS

Exploitation allows attackers to execute arbitrary code in the context
of the currently logged-on user. To exploit this vulnerability, a
targeted user must load a malicious Web page created by an attacker. An
attacker typically accomplishes this via social engineering or injecting
content into compromised, trusted sites.

Additionally, in a default configuration, a targeted user must have this
control already installed or must accept several warning prompts at the
time that the attack is taking place. This control is not on the white
list included with Internet Explorer 7.0. More information can be found
at the following URL.

http://msdn.microsoft.com/en-us/library/bb250471.aspx

IV. DETECTION

Cisco AnyConnect VPN client versions prior to 2.3.185 for Windows,
2.5.3041 adn 3.0.629 for Linux and Apple Mac OS X are vulnerable.

V. WORKAROUND

Setting the kill-bit for this control will prevent it from being loaded
within Internet Explorer. However, doing so will prevent legitimate use
of the control.

VI. VENDOR RESPONSE

Cisco has released an advisory which describes methods of updating the
AnyConnect Secure Mobility Client. For more information, consult their
advisory at the following URL.

http://www.cisco.com/en/US/products/products_security_advisory09186a0080b80123.shtml

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2011-2039 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org/), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

02/24/2009  Initial Vendor Notification
02/25/2009  Initial Vendor Reply
06/01/2011  Coordinated Public Disclosure

IX. CREDIT

This vulnerability was reported to iDefense by Elazar Broad.

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2011 Verisign

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDefense. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically, please
e-mail customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
 There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
