
Date: Mon, 01 Feb 2010 15:23:22 -0500
From: iDefense Labs <labs-no-reply@...fense.com>
To: bugtraq@...urityfocus.com, vulnwatch@...nwatch.org,
	full-disclosure@...ts.grok.org.uk
Subject: iDefense Security Advisory 02.01.10: Real Networks RealPlayer Compressed
 GIF Handling  Integer Overflow

iDefense Security Advisory 02.01.10
http://labs.idefense.com/intelligence/vulnerabilities/
Feb 01, 2010

I. BACKGROUND

RealPlayer is an application for playing various media formats,
developed by RealNetworks Inc. Since late 2003, Real Player has been
based on the open-source Helix Player. More information can be found at
the URLs shown. For more information, see the vendor's site found at the
following links.

http://www.real.com/realplayer.html
http://helixcommunity.org/

II. DESCRIPTION

Remote exploitation of an integer overflow vulnerability in Real
Networks Inc.'s RealPlayer version 11 could allow an attacker to
execute arbitrary code.

iDefense Labs has confirmed the existence of an integer overflow issue
within RealPlayer when handling compressed GIF files. The vulnerability
occurs in the CGIFCodec::InitDecompress() function, which does not
properly validate a field in the GIF file before using it in an
arithmetic operation that calculates the size of a heap buffer. This
issue leads to heap corruption, which can result in the execution of
arbitrary code.

III. ANALYSIS

Exploitation of this issue allows an attacker to execute arbitrary code
within the security context of the current user. An attacker would need
to entice a victim into opening a RTSP stream. Upon the victim opening
the stream, the attack would inject a malformed compressed GIF image
into a RTSP stream to exploit this issue. Other attack vectors are
likely to exist; however, this was the vector tested within iDefense
Labs. It should be noted that RealPlayer can be instantiated within a
Web browser. This means an attacker could host a malicious Web page and
entice a victim into visiting this page. Upon visiting the page,
exploitation would occur.

IV. DETECTION

iDefense confirmed RealPlayer version 11 is vulnerable to this issue.
RealNetworks provided the following matrix of affected software:

Windows RealPlayer 11.0.0 - 11.0.4
Mac RealPlayer 10

V. WORKAROUND

iDefense recommends applying the following workarounds until a patch
resolving this issue is made publicly available by Real Networks Inc.
RealPlayer users should change the GIF filetype association to another
application. It is also recommended that RealPlayer users disable the
RealPlayer plugins contained within the Web browsers plugins directory
by changing the file permissions to deny execution of these files.
These workarounds will limit the functionality of RealPlayer by
disabling GIF support and web browser plugin features. These
workarounds may not mitigate all exploitation vectors but will likely
prevent the majority of likely scenarios.

VI. VENDOR RESPONSE

RealNetworks has released a patch which addresses this issue.
Information about downloadable vendor updates can be found by clicking
on the URLs shown.

http://service.real.com/realplayer/security/01192010_player/en/

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2009-4245 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org/), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

05/13/2008  Initial Contact
05/03/2008  Initial Response
02/01/2010  Coordinated public disclosure.

IX. CREDIT

The discoverer of this vulnerability wishes to remain anonymous.

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2010 iDefense, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDefense. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically,
please e-mail customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
 There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct,
indirect, or consequential loss or damage arising from use of, or
reliance on, this information.
