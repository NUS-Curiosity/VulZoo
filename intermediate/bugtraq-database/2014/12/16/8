
Date: Tue, 16 Dec 2014 18:56:35 +0100
From: Florian Weimer <fw@...eb.enyo.de>
To: bugtraq@...urityfocus.com
Subject: [SECURITY] [DSA 3105-1] heirloom-mailx security update

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3105-1                   security@...ian.org
http://www.debian.org/security/                            Florian Weimer
December 16, 2014                      http://www.debian.org/security/faq
- -------------------------------------------------------------------------

Package        : heirloom-mailx
CVE ID         : CVE-2004-2771 CVE-2014-7844

Two security vulnerabilities were discovered in Heirloom mailx, an
implementation of the "mail" command:

CVE-2004-2771

    mailx interprets interprets shell meta-characters in certain email
    addresses.

CVE-2014-7844

    An unexpected feature of mailx treats syntactically valid email
    addresses as shell commands to execute.

Shell command execution can be re-enabled using the "expandaddr"
option.

Note that this security update does not remove all mailx facilities
for command execution, though.  Scripts which send mail to addresses
obtained from an untrusted source (such as a web form) should use the
"--" separator before the email addresses (which was fixed to work
properly in this update), or they should be changed to invoke
"mail -t" or "sendmail -i -t" instead, passing the recipient addresses
as part of the mail header.

For the stable distribution (wheezy), these problems have been fixed in
version 12.5-2+deb7u1.

We recommend that you upgrade your heirloom-mailx packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: https://www.debian.org/security/

Mailing list: debian-security-announce@...ts.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)

iQEcBAEBAgAGBQJUkHozAAoJEL97/wQC1SS++tsIAIyvLPRuuB864e+9/vBNrn8P
r0MmgGT/8FZgbuiDaqe6PUkv7mR2wPpx3k4kPXq4vcGB00OvCULBabHlc+SqWtZo
535u5V0g4hoAeKUOD9BnMIgGFxoFx/wcmrDZbWxUHgHJSdmxrieix0z/uD5VniGe
jHZUkFAHE86pXzrrVHoYrFzSkU2N5h/ifkZED32dbYCMTTyKuSF97dK8oTyalvo+
/Al27mV6idY6q8rYZZvATm1TVSO8MjjqJmCC3y2EJP8MLTrvEi59iTAFLlHB/3s1
sGq5f+dGPmOsAFGtHZewGA+dpxEL/CqBMwpww1zMBiCoEIp7Vdv4OkZiAi+EfVo=
=qgAH
-----END PGP SIGNATURE-----

