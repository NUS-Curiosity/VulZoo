
Date: Tue, 11 Nov 2014 17:08:39 -0500 (EST)
From: security-alert@...com
To: bugtraq@...urityfocus.com
Subject: [security bulletin] HPSBGN03117 rev.2 - HP Remote Device Access: Virtual Customer Access System (vCAS) running Bash Shell, Remote Code Execution

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Note: the current version of the following document is available here:
https://h20564.www2.hp.com/portal/site/hpsc/public/kb/
docDisplay?docId=emr_na-c04467807

SUPPORT COMMUNICATION - SECURITY BULLETIN

Document ID: c04467807
Version: 2

HPSBGN03117 rev.2 - HP Remote Device Access: Virtual Customer Access System
(vCAS) running Bash Shell, Remote Code Execution

NOTICE: The information in this Security Bulletin should be acted upon as
soon as possible.

Release Date: 2014-09-30
Last Updated: 2014-11-11

Potential Security Impact: Remote code execution

Source: Hewlett-Packard Company, HP Software Security Response Team

VULNERABILITY SUMMARY
A potential security vulnerability has been identified with HP Remote Device
Access: Virtual Customer Access System (vCAS) running Bash Shell. This is the
Bash Shell vulnerability known as "ShellShock" which could be exploited
remotely to allow execution of code.

  NOTE: The vCAS product is vulnerable only if DHCP is enabled.

References:

  CVE-2014-6271
  CVE-2014-7169
  SSRT101724

SUPPORTED SOFTWARE VERSIONS*: ONLY impacted versions are listed.

  All vCAS versions prior to 14.10-38402

BACKGROUND

CVSS 2.0 Base Metrics
===========================================================
  Reference              Base Vector             Base Score
CVE-2014-6271    (AV:N/AC:L/Au:N/C:C/I:C/A:C)       10.0
CVE-2014-7169    (AV:N/AC:L/Au:N/C:C/I:C/A:C)       10.0
===========================================================
             Information on CVSS is documented
            in HP Customer Notice: HPSN-2008-002

RESOLUTION

HP has made the following updates available to resolve the vulnerability in
HP Remote Device Access: Virtual Customer Access System (vCAS) running Bash
Shell.

  Customers should upgrade their vCAS systems using the web UI or the
"casupdate" command.

  There are also new VirtualBox and VMware ESX images available:

    - VMware ESX/ESXi image:
https://h20529.www2.hp.com/apt/hp-rdacas-14.10-38402.ova

    - VirtualBox image:
https://h20529.www2.hp.com/apt/hp-rdacas-14.10-38402-vbox.ova

    NOTE:

      - HP recommends to not power-down or disconnect the vCAS until the
update is available.
      - The vCAS pulls down the latest updates from HP by using Ubuntus
apt-get facility.
      - HP does not push updates out on to the vCAS so customers will have to
be proactive and install the latest updates.

  Actions Required

    The DHCP exploit can be mitigated by ensuring that DHCP is disabled on
the vCAS as detailed in MITIGATION INFORMATION below. Download updates by
using a web browser:

      1. Connect to the vCAS and login as hp-admin
      2. Go to Tools -> Software Updates
      3. Under "Manual Actions" select Check now and then upgrade now

    See HP Remote Device Access vCAS User Guide, Chapter 4, Software Updates
for more details:

          http://h20566.www2.hp.com/portal/site/hpsc/template.PAGE/action.pro
cess/public/psi/manualsDisplay/?sp4ts.oid=4256914&javax.portlet.action=true&s
pf_p.tpst=psiContentDisplay&javax.portlet.begCacheTok=com.vignette.cachetoken
&spf_p.prp_psiContentDisplay=wsrp-interactionState%3DdocId%253Demr_na-c033816
86%257CdocLocale%253Den_US&javax.portlet.endCacheTok=com.vignette.cachetoken

  MITIGATION INFORMATION

    A Shellshock attack requires the definition of an environment variable
introduced into Bash. The vCAS has three attack vectors: SSH, the lighttpd
web server, and the DHCP client.

    - The exploit does not elevate privileges.
    - The SSH and webserver exploits require vCAS credentials so there is no
risk for unauthorized access or code execution through this vulnerability.

    The DHCP client uses Bash scripts and is vulnerable to Shellshock. The
DHCP exploit can be mitigated by ensuring that DHCP is disabled on the vCAS.

      Note: HP strongly discourages the use of DHCP on the vCAS.

    The web UI forces the vCAS user to assign a static IP address and change
the hp-admin password.
    A vCAS user must manually configure DHCP for use on the vCAS.

    A vCAS user can verify that DHCP is disabled by inspecting the file
"/etc/network/interfaces" and ensuring that the "iface" line for device
"eth0" is set for a static IP.

      Example of a static IP configuration:

        # The primary network interface
        auto eth0
        iface eth0 inet static
        address 172.27.1.68
        netmask 255.255.255.0
        gateway 172.27.1.1

HISTORY
Version:1 (rev.1) - 30 September 2014 Initial release
Version:2 (rev.2) - 11 November 2014 Software updates available

Third Party Security Patches: Third party security patches that are to be
installed on systems running HP software products should be applied in
accordance with the customer's patch management policy.

Support: For issues about implementing the recommendations of this Security
Bulletin, contact normal HP Services support channel.  For other issues about
the content of this Security Bulletin, send e-mail to security-alert@...com.

Report: To report a potential security vulnerability with any HP supported
product, send Email to: security-alert@...com

Subscribe: To initiate a subscription to receive future HP Security Bulletin
alerts via Email:
http://h41183.www4.hp.com/signup_alerts.php?jumpid=hpsc_secbulletins

Security Bulletin Archive: A list of recently released Security Bulletins is
available here:
https://h20564.www2.hp.com/portal/site/hpsc/public/kb/secBullArchive/

Software Product Category: The Software Product Category is represented in
the title by the two characters following HPSB.

3C = 3COM
3P = 3rd Party Software
GN = HP General Software
HF = HP Hardware and Firmware
MP = MPE/iX
MU = Multi-Platform Software
NS = NonStop Servers
OV = OpenVMS
PI = Printing and Imaging
PV = ProCurve
ST = Storage Software
TU = Tru64 UNIX
UX = HP-UX

Copyright 2014 Hewlett-Packard Development Company, L.P.
Hewlett-Packard Company shall not be liable for technical or editorial errors
or omissions contained herein. The information provided is provided "as is"
without warranty of any kind. To the extent permitted by law, neither HP or
its affiliates, subcontractors or suppliers will be liable for
incidental,special or consequential damages including downtime cost; lost
profits; damages relating to the procurement of substitute products or
services; or damages for loss of data, or software restoration. The
information in this document is subject to change without notice.
Hewlett-Packard Company and the names of Hewlett-Packard products referenced
herein are trademarks of Hewlett-Packard Company in the United States and
other countries. Other product and company names mentioned herein may be
trademarks of their respective owners.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.19 (GNU/Linux)

iEYEARECAAYFAlRiTVMACgkQ4B86/C0qfVkVXwCgnt3AiI6i2W/bYpzl1OdUS3V0
240AnAzsgVtgeyaCKxbE7+fRS74qViiq
=Gpae
-----END PGP SIGNATURE-----
