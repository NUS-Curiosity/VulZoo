
Date: Wed, 23 Oct 2019 09:32:26 GMT
From: matthias.deeg@...s.de
To: bugtraq@...urityfocus.com
Subject: [SYSS-2019-011]: Fujitsu Wireless Keyboard Set LX390 - Keystroke
 Injection Vulnerability (CVE-2019-18200)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Advisory ID: SYSS-2019-011
Product: Wireless Keyboard Set LX390
Manufacturer: Fujitsu
Affected Version(s): Model No. GK381
Tested Version(s): Model No. GK381
Vulnerability Type: Cryptographic Issues (CWE-310)
                    Keystroke Injection Vulnerability
Risk Level: High
Solution Status: Open (product reached end-of-life (EOL) in May 2019)
Manufacturer Notification: 2019-04-01
Solution Date: -
Public Disclosure: 2019-10-23 
CVE Reference: CVE-2019-18200
Author of Advisory: Matthias Deeg (SySS GmbH)

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Overview:

Fujitsu Wireless Keyboard Set LX390 is a wireless desktop set consisting
of a mouse and a keyboard.

The manufacturer describes the product as follows (see [1, 2]):

"The Wireless Keyboard Set LX390 is an excellent desktop solution for
users with ambition. This durable keyboard set is equipped with secure
2.4 GHz technology and plug and play technology. The elegant mouse works
on most surfaces due to its precise 1000 dpi sensor. It offers fabulous
features and ultra slim, portable design."

Due to an insecure implementation of the data communication, the
wireless keyboard LX390 is prone to keystroke injection attacks.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Vulnerability Details:

SySS GmbH found out that the wireless desktop set Fujitsu LX390 is
vulnerable to keystroke injection attacks, as the used data
communication is unencrypted, which is described in the SySS security
advisory SYSS-2019-010 (see [3]), and unauthenticated.

By analyzing the used radio communication protocol, the so-called data
whitening or data scrambling mechanism used by the 2.4 GHz radio
transceiver, and its configuration, an attacker is able to send
arbitrary keystrokes to a victim's computer system. In this way, an
attacker can remotely take control over the victim's computer that is
operated with an affected Fujitsu LX390 wireless desktop set. 

The actual configuration for a specific targeted keyboard regarding the
used data whitening configuration can be learned by remotely analyzing
the radio communication.

In combination with the replay attack described in the SySS security
advisory SYSS-2019-009 (see [4]), a keystroke injection attack allows to
remotely attack computer systems with an active screen lock, for example
in order to install malware when the target system is unattended.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Proof of Concept (PoC):

SySS GmbH could successfully perform keystroke injection attacks against
the Fujitsu wireless desktop set LX390 using a software-defined radio
in combination with an in-house developed software tool utilizing GNU
Radio [5].

For the protocol analysis and initial proof-of-concept attacks,
Universal Radio Hacker (URH) [6] was used.

SySS GmbH could also perform successful keystroke injection attacks
using another in-house developed software tool in combination with the
USB radio dongle Crazyradio PA and the nrf-research-firmware by Bastille
Networks Internet Security written by Marc Newlin (see [7] and [8]).

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Solution:

The Fujitsu Wireless Keyboard Set LX390 reached its end-of-life (EOL) in
May 2019.

Fujitsu has released two new wireless keyboard sets named LX410 [9] and
LX960 [10] that are not affected by the described security issue.

SySS recommends replacing LX390 wireless keyboard sets used in
environments with higher security demands, for instance with one of the
newer successor models LX410 or LX960.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclosure Timeline:

2019-04-01: Vulnerability reported to manufacturer
2019-04-02: Fujitsu confirms receipt of security advisory and asks
            questions regarding the reported security issue;
            answered open questions
2019-04-11: Received further questions from manufacturer
2019-04-18: Answered open questions and postponed disclosure date
2019-10-08: Reminded manufacturer of the upcoming release of the
            security advisory
2019-10-18: Discussed details of coordinated disclosure with
            manufacturer
2019-10-21: Public release of security advisory

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

References:

[1]  Product website for Fujitsu Wireless Keyboard Set LX390 (not available anymore)
     https://www.fujitsu.com/global/products/computing/peripheral/accessories/input-devices/keyboards/keyboard-lx390.html
[2]  Data sheet Fujitsu Wireless Keyboard Set LX390
     https://produktinfo.conrad.com/datenblaetter/1300000-1399999/001375431-da-01-en-FUJITSU_DESKTOP_SET_WIREL_LX390_WEISS.pdf
[3]  SySS Security Advisory SYSS-2019-010
     https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2019-010.txt
[4]  SySS Security Advisory SYSS-2019-009
     https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2019-009.txt
[5]  GNU Radio
     https://www.gnuradio.org/
[6]  Universal Radio Hacker (URH)
     https://github.com/jopohl/urh
[7]  Product website for Crazyradio PA
     https://www.bitcraze.io/crazyradio-pa/
[8]  Bastille's nRF24 research firmware and tools
     https://github.com/BastilleResearch/nrf-research-firmware
[9]  Product website for Fujitsu Wireless Keyboard Set LX410
     https://www.fujitsu.com/global/products/computing/peripheral/accessories/input-devices/keyboards/keyboard-lx410.html
[10] Product website for Fujitsu Wireless Keyboard Set LX960
     https://www.fujitsu.com/global/products/computing/peripheral/accessories/input-devices/keyboards/keyboard-lx960.html
[11] SySS Security Advisory SYSS-2019-011
     https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2019-011.txt
[12] SySS Responsible Disclosure Policy
     https://www.syss.de/en/responsible-disclosure-policy/

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Credits:

This security vulnerability was found by Matthias Deeg of SySS GmbH.

E-Mail: matthias.deeg (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Matthias_Deeg.asc
Key fingerprint = D1F0 A035 F06C E675 CDB9 0514 D9A4 BF6A 34AD 4DAB

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclaimer:

The information provided in this security advisory is provided "as is" 
and without warranty of any kind. Details of this security advisory may 
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web 
site.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Copyright:

Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEE0fCgNfBs5nXNuQUU2aS/ajStTasFAl2wG/sACgkQ2aS/ajSt
Tav0JRAAhRswQ+EPh6xpzSeMKSiqG1+6SpGPH+oQUPvhnpJTVY4Ypz6guxpdEgo3
B+NKfC6gCuP6z9PFjkQ62/pCZjPIh4RvP3EbN+/xaG93mAw6U5cIUOUw+ZL2kvhJ
WuO/171YTpGHhZn7nhCFRspuKm+8JVbfsAXOUyx4+VM72Kv0/t51r87IB00zqZQW
/7npG22OdNDwheUZQy6kezRGngIOfHUT/hBxptIiGRvp+K2/rNUKY6WugECWRY1W
cw8XOzayrCaPPsNhVpAXh4wCtCFczxy0i/ySX8vaWOixPYE/8ND7cA+GjeFrUaCi
Y7u9YvCuP9/oZnH7FRFFNfs3Pn2lfaAlvv5GhOxdos0AK3y1w9nO3Ltg5C9zrgND
dY3AokCLjuevIsTOpUNCXQxiNj0e1DJRyqrHdpDviD5b5uhIUaz3ZypJimLqigPR
Bp5uM8ck84ZHx94vqltzX0u7WuuD9CikbLyZpJN/A3l0IZs3yF7OBqKt7D0nfXN+
ZRD8jhSSPXvLhUJRtM1Z4mLl8AnFU90BqDgvwEI4Ry/3zmRiS0sXo2g2yeS69uBp
yi8c/Bxx/waEwnKV9UsFH0GD5KjleffOfdX7vEVKodw3Wxi2ILgn2MUAArT/b2pF
dIIayneKpY++CWrSBGiTww8HTqTcgpICZ466QHG07NIzGlKnG50=
=Jvuy
-----END PGP SIGNATURE-----
