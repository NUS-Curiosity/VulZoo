
Date: Tue, 14 Aug 2007 18:34:59 -0400
From: iDefense Labs <labs-no-reply@...fense.com>
To: vulnwatch@...nwatch.org, full-disclosure@...ts.grok.org.uk,
	bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 08.14.07: Microsoft Windows Vista Sidebar
 RSS Feeds Gadget Cross Site Scripting Vulnerability

Microsoft Windows Vista Sidebar RSS Feeds Gadget Cross Site Scripting
Vulnerability

iDefense Security Advisory 08.14.07
http://labs.idefense.com/intelligence/vulnerabilities/
Aug 14, 2007

I. BACKGROUND

The Vista sidebar is a desktop extension that allows the user to keep a
number of "gadgets", which are mini-applications, running in constant
view on the desktop. Vista provides a number of default gadgets, such
as a calendar, a weather tool, and an RSS feed reader.

RSS feeds allow a content provider, such as a website, to let others
receive a stream of "headlines" describing content on the provider's
site. The feeds are often updated frequently, and allow a user to
receive information from a site without having to visit it. For
example, a user may subscribe to a news feed that updates every hour
with the headlines of top news stories. In order to subscribe to a
feed, a user needs a feed reader. Modern browsers, such as Internet
Explorer, provide a feed reader within the browser.

For more information about the Vista Sidebar and Gadgets please see the
following URL.

http://www.microsoft.com/windows/products/windowsvista/features/details/sidebargadgets.mspx

II. DESCRIPTION

Remote exploitation of a Cross Site Scripting (XSS) vulnerability in the
Windows Vista Sidebar RSS Gadget allows an attacker to execute arbitrary
code with the privileges of the logged in user.

The vulnerability exists within the parsing of the certain elements of
the items in an RSS feed. A properly crafted HTML tag within these
elements will not be removed, and will be rendered by the RSS gadget.
Since the RSS gadget runs in the local zone, the injected JavaScript
has full access to the system.

III. ANALYSIS

Exploitation of this vulnerability will result in the execution of
arbitrary code with the privileges of the user running the RSS gadget.
In order to exploit this, an attacker can inject JavaScript that will
download and execute a malicious binary.

The RSS gadget runs by default, but does not display any feeds unless a
user subscribes to them. As such, a user must be receiving data from a
malicious feed in order to be attacked.

In the most common scenario, this requires some form of social
engineering to convince a user to subscribe to a malicious feed. There
is no way to add a feed by simply clicking a link. The user must click
the 'Subscribe to this feed' button displayed when visiting a feed in
Internet Explorer. After adding the feed, exploitation will occur once
the gadget attempts to display the feed.

Another attack vector that requires significantly less social
engineering requires an attacker control a trusted feed. If an attacker
can find some way to inject data into a trusted feed then they will be
able to exploit any subscribers to the feed.

IV. DETECTION

iDefense has confirmed the existence of this vulnerability in Microsoft
Windows Vista Business. Other versions are suspected to be vulnerable.

V. WORKAROUND

iDefense is currently unaware of any workarounds for this issue.

VI. VENDOR RESPONSE

Microsoft has addressed this vulnerability within MS07-048. For more
information, consult their bulletin at the following URL.

http://www.microsoft.com/technet/security/Bulletin/MS07-048.mspx

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2007-3033 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org/), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

03/21/2007  Initial vendor notification
03/21/2007  Initial vendor response
08/14/2007  Coordinated public disclosure

IX. CREDIT

This vulnerability was reported to iDefense by Aviv Raff.

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2007 iDefense, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDefense. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically,
please e-mail customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
 There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct,
indirect, or consequential loss or damage arising from use of, or
reliance on, this information.
