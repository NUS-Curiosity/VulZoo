
Date: Wed, 16 Apr 2008 14:26:58 -0400
From: iDefense Labs <labs-no-reply@...fense.com>
To: vulnwatch@...nwatch.org, full-disclosure@...ts.grok.org.uk,
	bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 04.15.08: Oracle Application Express Privilege
 Escalation Vulnerability

iDefense Security Advisory 04.15.08
http://labs.idefense.com/intelligence/vulnerabilities/
Apr 15, 2008

I. BACKGROUND

Oracle Application Express (Oracle APEX), formerly called HTML DB, is a
rapid web application development tool for the Oracle database. For
more information about Oracle Application Express, please visit
following URL.

http://www.oracle.com/technology/products/database/application_express/index.html

II. DESCRIPTION

Local exploitation of a design error vulnerability in Oracle Corp.'s
Application Express web application development tool allows attackers
to gain elevated privileges.

The vulnerability exists in "run_ddl" function within the
"wwv_execute_immediate" package. This package is included in the
"flows_030000" schema. This function allows attackers to execute SQL
commands as any database user, such as SYS.

III. ANALYSIS

Exploitation allows the attacker to execute SQL commands as any database
user. In order to exploit this vulnerability, an attacker must have
access to an account which can execute the
"flows_030000.wwv_execute_immediate.run_ddl" function. On a default
installation of Oracle Database 11g, the following non-DBA users can
execute this function: WMSYS, WKSYS, FLOWS_030000, OUTLN.

If combined with other SQL injection vulnerabilities which give access
to above accounts, an attacker with normal database user access can
take control of the whole database and possibly the whole computer
system.

IV. DETECTION

iDefense confirmed the existence of this vulnerability in Oracle
Application Express version 3.0.1.00.08, which is installed by default
with Oracle Database 11g R1 (version 11.1.0.6.0). Previous versions may
also be affected. However, Oracle Database 10g R2 does not install
Oracle Application Express by default.

V. WORKAROUND

Exploitation of this vulnerability can be prevented, if this component
is not being used, by uninstalling Oracle Application Express.

VI. VENDOR RESPONSE

Oracle has addressed this issue within the April 2008 Critical Patch
Update. For more information, visit the following URL.

http://www.oracle.com/technology/deploy/security/critical-patch-updates/cpuapr2008.html

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2008-1811 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org/), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

01/18/2008  Initial vendor notification
01/22/2008  Initial vendor response
04/15/2008  Coordinated public disclosure

IX. CREDIT

This vulnerability was reported to iDefense by Joxean Koret.

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2008 iDefense, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDefense. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically,
please e-mail customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
 There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct,
indirect, or consequential loss or damage arising from use of, or
reliance on, this information.
