
Date: Tue, 15 Apr 2008 18:19:43 -0400
From: iDefense Labs <labs-no-reply@...fense.com>
To: vulnwatch@...nwatch.org, full-disclosure@...ts.grok.org.uk,
	bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 04.09.08: IBM DB2 Universal Database db2dasStartStopFMDaemon
 Buffer Overflow Vulnerability

iDefense Security Advisory 04.09.08
http://labs.idefense.com/intelligence/vulnerabilities/
Apr 09, 2008

I. BACKGROUND

IBM Corp.'s DB2 Universal Database product is a large database server
product commonly used for high-end databases. For more information,
visit the product website at the following URL.

http://ibm.com/db2/

II. DESCRIPTION

Local exploitation of a buffer overflow vulnerability in the db2dasrrm
program, as included with IBM Corp.'s DB2 Universal Database, allows
attackers to elevate privileges to root.

This vulnerability exists due to insufficient validation of the length
of the attacker-supplied "DASPROF" environment variable contents. By
setting the variable to a specially crafted string, an attacker can
cause a buffer overflow when the string is copied into a static-sized
buffer stored on the stack. By overflowing the buffer, the attacker can
overwrite execution control structures stored on the stack and execute
arbitrary code.

III. ANALYSIS

Exploitation allows local attackers to gain root privileges. In order to
exploit this vulnerability, the attacker must have access to execute the
vulnerable set-uid root "db2dasrrm" program.

IV. DETECTION

iDefense has confirmed the existence of this vulnerability in IBM
Corp.'s DB2 Universal Database 9.1 with Fix Pack 4 installed on a Linux
system. Versions for other supported UNIX-like systems should also be
considered vulnerable. All previously released versions are suspected
vulnerable.

V. WORKAROUND

The best defense against this type of vulnerability is to prevent
untrusted users from having code execution abilities on the respective
database server. The following workarounds may also be useful.

  Use a more strict permissions setting for the DB2 instance directory 
would prevent non-instance users from accessing the set-uid root binaries.
  Remove the set-uid bit from all programs included with DB2.

These configuration changes have not been tested and may cause adverse
behavior.

VI. VENDOR RESPONSE

IBM Corp. has addressed this vulnerability with the release of V9.1 Fix
Pack 4a, V8 FixPak 16, and V9.5 Fix Pack 1 of its Universal Database
product. More information can be found at the following URLs.

V8: http://www-1.ibm.com/support/docview.wss?uid=swg21256235

V9.1: http://www-1.ibm.com/support/docview.wss?uid=swg21255572

V9.5: http://www-1.ibm.com/support/docview.wss?uid=swg21287889

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2007-5758 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org/), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

11/29/2007  Initial vendor notification
12/01/2007  Initial vendor response
04/09/2008  Coordinated public disclosure

IX. CREDIT

The discoverer of this vulnerability wishes to remain anonymous.

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2008 iDefense, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDefense. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically,
please e-mail customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
 There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct,
indirect, or consequential loss or damage arising from use of, or
reliance on, this information.
