
Date: Wed, 26 Mar 2008 17:00:00 +0100
From: Cisco Systems Product Security Incident Response Team <psirt@...co.com>
To: bugtraq@...urityfocus.com
Cc: psirt@...co.com
Subject: Cisco Security Advisory: Cisco IOS User Datagram Protocol Delivery Issue For IPv4/IPv6 Dual-stack Routers

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Cisco Security Advisory: Cisco IOS User Datagram Protocol Delivery
                         Issue For IPv4/IPv6 Dual-stack Routers

Advisory ID: cisco-sa-20080326-IPv4IPv6

http://www.cisco.com/warp/public/707/cisco-sa-20080326-IPv4IPv6.shtml

Revision 1.0

For Public Release 2008 March 26 1600 UTC (GMT)

Summary
=======

A device running Cisco IOS software that has Internet Protocol
version 6 (IPv6) enabled may be subject to a denial of service (DoS)
attack. For the device to be affected by this vulnerability the
device also has to have certain Internet Protocol version 4 (IPv4)
User Datagram Protocol (UDP) services enabled. To exploit this
vulnerability an offending IPv6 packet must be targeted to the
device. Packets that are routed throughout the router can not trigger
this vulnerability. Successful exploitation will prevent the
interface from receiving any additional traffic. The only exception
is Resource Reservation Protocol (RSVP) service, which if exploited,
will cause the device to crash. Only the interface on which the
vulnerability was exploited will be affected.

Cisco is providing fixed software to address this issue. There are
workarounds available to mitigate the effects of the vulnerability.

This advisory is posted at 
http://www.cisco.com/warp/public/707/cisco-sa-20080326-IPv4IPv6.shtml

Note: The March 26, 2008 publication includes five Security
Advisories. The Advisories all affect Cisco's Internetwork Operating
System (IOS). Each Advisory lists the releases that correct the
vulnerability described in the Advisory, and the Advisories also
detail the releases that correct the vulnerabilities in all five
Advisories. Please reference the following software table to find a
release which fixes all published Security Advisories as of March
26th, 2008.

  * March 26th bundled IOS Advisory Table
    http://www.cisco.com/warp/public/707/cisco-sa-20080326-bundle.shtml

Individual publication links are listed below:

  * Cisco IOS Virtual Private Dial-up Network Denial of Service
    Vulnerability
    http://www.cisco.com/warp/public/707/cisco-sa-20080326-pptp.shtml

  * Multiple DLSw Denial of Service Vulnerabilities in Cisco IOS
    http://www.cisco.com/warp/public/707/cisco-sa-20080326-dlsw.shtml

  * Cisco IOS User Datagram Protocol Delivery Issue For IPv4/IPv6
    Dual-stack Routers
    http://www.cisco.com/warp/public/707/cisco-sa-20080326-IPv4IPv6.shtml

  * Vulnerability in Cisco IOS with OSPF, MPLS VPN, and Supervisor
    32, Supervisor 720, or Route Switch Processor 720
    http://www.cisco.com/warp/public/707/cisco-sa-20080326-queue.shtml

  * Cisco IOS Multicast Virtual Private Network (MVPN) Data Leak
    http://www.cisco.com/warp/public/707/cisco-sa-20080326-mvpn.shtml

Affected Products
=================

Vulnerable Products
+------------------

Only Cisco IOS software releases that have IPv6 enabled are affected
by this vulnerability. In order to be vulnerable both support for
IPv6 protocol and IPv4 UDP-based services must be enabled on the
device. The IPv6 is not enabled by default in Cisco IOS software.

To determine the software running on a Cisco IOS product, log in to
the device and issue the show version command to display the system
banner. Cisco IOS software will identify itself as "Internetwork
Operating System Software" or simply "IOS." On the next line of
output, the image name will be displayed between parentheses,
followed by "Version" and the Cisco IOS software release name. Other
Cisco devices will not have the show version command, or will give
different output.

The following example shows output from a device running a Cisco IOS
image:

    Router>show version
    Cisco IOS Software, 1841 Software (C1841-ADVSECURITYK9-M), Version 12.4(15)T2, RELEASE SOFTWARE (fc7) 
    Technical Support: http://www.cisco.com/techsupport 
    Copyright (c) 1986-2008 by Cisco Systems, Inc. 
    Compiled Thu 17-Jan-08 23:12 by prod_rel_team

Additional information about Cisco IOS software release naming is
available at the following link:
http://www.cisco.com/en/US/products/sw/iosswrel/ps1828/products_white_paper09186a008018305e.shtml.

In order for an interface to be vulnerable two conditions must be
satisfied:

 1. An interface must have IPv6 enabled.
 2. One or more of the following IPv4 UDP-based services must be
    enabled:
    TACACS - port 49
    Domain Name System (DNS) server - port 53
    Resource Reservation Protocol (RSVP) - port 1698
    Layer Two Forwarding (L2F)/Layer Two Tunnel Protocol (L2TP) -
    port 1701
    IP SLA Responder - port 1967
    Media Gateway Control Protocol (MGCP) - port 2427
    Session Initiation Protocol (SIP) - port 5060

No other IPv4 UDP-based services are known to be affected.

How To Verify If IPv6 Is Enabled
+-------------------------------

IPv6 protocol is enabled on an interface if either or both of the
following configuration lines are present in the configuration:

    Router#show running-config
    interface FastEthernet0/1
     ipv6 address 2001:0DB8:C18:1::/64 eui-64

    Router#show running-config
    interface FastEthernet0/1
     ipv6 enabled

If any of the interfaces contain either or both of the ipv6 lines
then IPv6 is enabled on that particular interface.

How To Verify If IPv4 UDP-based Services Are Enabled
+---------------------------------------------------

To determine whether device is affected or not, use the show ip
sockets command to display all UDP ports device is listening to. In
some newer IOS releases the command show ip sockets is obsoleted, and
the alternate command show udp can be used instead. The output is
identical to the show ip sockets command.

The device is vulnerable if the Local Port column (fifth from the
left) in the output of show ip sockets contains any of the port
numbers listed in the example below.

    Router#show ip sockets
    Proto    Remote      Port      Local       Port  In Out Stat TTY OutputIF
    17 192.168.100.1      49 192.168.100.2       49   0   0   11   0 
    17 0.0.0.0             0 192.168.100.2       53   0   0  211   0 
    17   --listen--          192.168.100.2     1698   0   0    1   0 
    17 192.168.100.1    1701 192.168.100.2     1701   1   0 1021   0
    17 0.0.0.0             0 192.168.100.2     1967   0   0  211   0 
    17 0.0.0.0             0  --any--          2427   0   0  211   0
    17 0.0.0.0             0  --any--          5060   0   0  211   0

Products Confirmed Not Vulnerable
+--------------------------------

No other Cisco products are currently known to be affected by this
vulnerability.

Any device running Cisco IOS without IPv6 enabled is not vulnerable.
Cisco IOS XR and Cisco PIX/ASA are not affected.

Details
=======

To exploit this vulnerability an offending IPv6 packet must be
targeted to the device. Packets that are routed throughout the router
can not trigger this vulnerability. Successful exploitation of the
vulnerability may result in one of the following two conditions:

 1. The device will crash if RSVP service is configured on the
    interface.
 2. Any other affected IPv4 UDP-based service will prevent the
    interface from receiving additional traffic. Only the interface
    on which the vulnerability is exploited will be affected.

This vulnerability is independent of the interface media type. A
blocked interface will immediately stop receiving any subsequent
packets destined to the device itself until it is unblocked. It is
possible to unblock the interface using methods other than a device
reload. These methods are described in the Workarounds section. All
other interfaces are unaffected and will continue receiving and
transmitting packets.

Blocked interface may allow transit traffic to flow for a period of
time. Transit traffic may continue to flow until either the
respective routing entry or Address Resolution Protocol (ARP) entry
expires, whichever event occurs first. Depending on the circumstances
the transit traffic can stop flowing through the blocked interface
within a few seconds or continue up to four hours (which is the ARP
cache default lifetime). After that no further transit traffic will
flow through the blocked interface.

No other IPv4 UDP-based services are known to be affected by this
vulnerability.

This vulnerability is documented in Cisco Bug ID CSCse56501, and has
been assigned the Common Vulnerabilities and Exposures (CVE) ID
CVE-2008-1153.

Identification Of Vulnerability Exploitation
+-------------------------------------------

The show interfaces command can be used to view the input queue size
to identify a blocked input interface. A device under attack, but not
yet blocked will show the Input queue size increasing without a
subsequent decrease. If the current size (in this case, 76) is larger
than the maximum size (75), the input queue is blocked. The value of
75 is the default value and it can be changed using the interface
command hold-queue X in .

    Router#show interfaces FastEthernet 0/1 | include queue
      Input queue: 76/75/0/0 (size/max/drops/flushes); Total output drops: 0
      Output queue: 0/40 (size/max)

The example above shows that the interface FastEthernet0/1 is
blocked.

The show ip sockets command can be used to determine which protocol
blocks the interface. If In column (sixth from the left) of the
output contains any other number than zero (0) that is an indication
that packets of that particular protocol are blocking, or starting to
block, the interface. The following example shows DNS packets that
are beginning to fill the input queue of the interface. The interface
is not completely blocked because only 13 packets are in the input
queue.

    Router#show ip sockets
    Proto    Remote      Port      Local       Port  In Out Stat TTY OutputIF
    17 192.168.100.1      49 192.168.100.2       49   0   0   11   0 
    17 0.0.0.0             0 192.168.100.2       53  13   0  211   0 
    17   --listen--          192.168.100.2     1698   0   0    1   0 
    17 192.168.100.1    1701 192.168.100.2     1701   1   0 1021   0
    17 0.0.0.0             0 192.168.100.2     1967   0   0  211   0 
    17 0.0.0.0             0  --any--          2427   0   0  211   0
    17 0.0.0.0             0  --any--          5060   0   0  211   0

The output of the show ip sockets command does not provide
information on interfaces. It is possible that packets from multiple
protocols may be blocking a single interface. The output of the
command must be interpreted with the device's configuration to
establish the affected port.

Additional methods that can be used to detect blocked interfaces are
described in "Cisco Applied Mitigation Bulletin: User Datagram
Protocol Delivery Issue For IPv4/IPv6 Dual-Stack Routers" document
available at 
http://www.cisco.com/warp/public/707/cisco-amb-20080326-IPv4IPv6.shtml. 
The method utilizes Embedded Event Manager (EEM) and Applets or an 
EEM Script.

Vulnerability Scoring Details
=============================

Cisco has provided scores for the vulnerabilities in this advisory
based on the Common Vulnerability Scoring System (CVSS). The CVSS
scoring in this Security Advisory is done in accordance with CVSS
version 2.0.

CVSS is a standards-based scoring method that conveys vulnerability
severity and helps determine urgency and priority of response.

Cisco has provided a base and temporal score. Customers can then
compute environmental scores to assist in determining the impact of
the vulnerability in individual networks.

Cisco has provided an FAQ to answer additional questions regarding
CVSS at
http://www.cisco.com/web/about/security/intelligence/cvss-qandas.html

Cisco has also provided a CVSS calculator to help compute the
environmental impact for individual networks at
http://intellishield.cisco.com/security/alertmanager/cvss

CSCse56501 - UDP delivery issue when IPv4 and IPv6 are bound to the
             same socket

  CVSS Base Score - 7.8

  Access Vector            - Network
  Access Complexity        - Low
  Authentication           - None
  Confidentiality Impact   - None
  Integrity Impact         - None
  Availability Impact      - Complete

  CVSS Temporal Score - 6.4

  Exploitability           - Functional
  Remediation Level        - Official-Fix
  Report Confidence        - Confirmed

Impact
======

Successful exploitation of the vulnerability can result in one of the
following two conditions:

 1. The device will crash if RSVP service is configured on the
    interface.
 2. Any other affected IPv4 UDP-based service will prevent the
    interface from receiving additional traffic. Only the interface
    on which the vulnerability is exploited will be affected.

Software Versions and Fixes
===========================

When considering software upgrades, also consult 
http://www.cisco.com/go/psirt and any subsequent advisories to 
determine exposure and a complete upgrade solution.

In all cases, customers should exercise caution to be certain the
devices to be upgraded contain sufficient memory and that current
hardware and software configurations will continue to be supported
properly by the new release. If the information is not clear, contact
the Cisco Technical Assistance Center (TAC) or your contracted
maintenance provider for assistance.

Each row of the Cisco IOS software table (below) names a Cisco IOS
release train. If a given release train is vulnerable, then the
earliest possible releases that contain the fix (along with the
anticipated date of availability for each, if applicable) are listed
in the "First Fixed Release" column of the table. The "Recommended
Release" column indicates the releases which have fixes for all the
published vulnerabilities at the time of this Advisory. A device
running a release in the given train that is earlier than the release
in a specific column (less than the First Fixed Release) is known to
be vulnerable. Cisco recommends upgrading to a release equal to or
later than the release in the "Recommended Releases" column of the
table.

+----------------------------------------+
|   Major    | Availability of Repaired  |
|  Release   |         Releases          |
|------------+---------------------------|
|  Affected  | First Fixed | Recommended |
| 12.0-Based |   Release   |   Release   |
|  Releases  |             |             |
|----------------------------------------|
|    There are no affected 12.0 based    |
|                releases                |
|----------------------------------------|
|  Affected  | First Fixed | Recommended |
| 12.1-Based |   Release   |   Release   |
|  Releases  |             |             |
|------------+-------------+-------------|
| 12.1       | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1AA     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1AX     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1AY     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1AZ     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1CX     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1DA     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1DB     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1DC     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1E      | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1EA     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1EB     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1EC     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1EO     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1EU     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1EV     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1EW     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1EX     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1EY     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1EZ     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1GA     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1GB     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1T      | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1XA     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1XB     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1XC     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1XD     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1XE     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1XF     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1XG     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1XH     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1XI     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1XJ     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1XK     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1XL     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1XM     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1XN     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1XO     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1XP     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1XQ     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1XR     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1XS     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1XT     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.1XU     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.1XV     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
| 12.1XW     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1XX     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1XY     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1XZ     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.1YA     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.1YB     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.1YC     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.1YD     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Releases    |             |
|            | prior to    |             |
|            | 12.1(5)YE6  |             |
|            | are         |             |
|            | vulnerable, |             |
| 12.1YE     | release     | 12.3(26)    |
|            | 12.1(5)YE6  |             |
|            | and later   |             |
|            | are not     |             |
|            | vulnerable; |             |
|            | first fixed |             |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.1YF     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
| 12.1YG     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.1YH     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.1YI     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
| 12.1YJ     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
|  Affected  | First Fixed | Recommended |
| 12.2-Based |   Release   |   Release   |
|  Releases  |             |             |
|------------+-------------+-------------|
| 12.2       | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2B      | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2BC     | first fixed | 12.3(23)BC1 |
|            | in 12.3BC   |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2BW     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2BY     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2BZ     | first fixed |             |
|            | in 12.3XI   |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2CX     | first fixed | 12.3(23)BC1 |
|            | in 12.3BC   |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2CY     | first fixed | 12.3(23)BC1 |
|            | in 12.3BC   |             |
|------------+-------------+-------------|
| 12.2CZ     | Vulnerable; |             |
|            | contact TAC |             |
|------------+-------------+-------------|
| 12.2DA     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2DD     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2DX     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            |             | 12.2(25)    |
|            |             | EWA13       |
|            | Vulnerable; |             |
| 12.2EU     | first fixed | 12.2(31)    |
|            | in 12.2SG   | SGA5        |
|            |             |             |
|            |             | 12.2(44)SG  |
|------------+-------------+-------------|
|            |             | 12.2(25)    |
|            |             | EWA13       |
|            | Vulnerable; |             |
| 12.2EW     | first fixed | 12.2(31)    |
|            | in 12.2SG   | SGA5        |
|            |             |             |
|            |             | 12.2(44)SG  |
|------------+-------------+-------------|
|            | 12.2(25)    |             |
|            | EWA10       | 12.2(25)    |
| 12.2EWA    |             | EWA13       |
|            | 12.2(25)    |             |
|            | EWA11       |             |
|------------+-------------+-------------|
|            | 12.2(35)EX1 |             |
| 12.2EX     |             | 12.2(40)EX1 |
|            | 12.2(37)EX  |             |
|------------+-------------+-------------|
| 12.2EY     | 12.2(37)EY  |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2EZ     | first fixed |             |
|            | in 12.2SEE  |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2FX     | first fixed |             |
|            | in 12.2SEE  |             |
|------------+-------------+-------------|
|            | Vulnerable; | 12.2(25)    |
| 12.2FY     | first fixed | SEG4        |
|            | in 12.2SEG  |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2FZ     | first fixed | 12.2(44)SE1 |
|            | in 12.2SE   |             |
|------------+-------------+-------------|
| 12.2IXA    | Vulnerable; |             |
|            | contact TAC |             |
|------------+-------------+-------------|
| 12.2IXB    | Vulnerable; |             |
|            | contact TAC |             |
|------------+-------------+-------------|
| 12.2IXC    | Vulnerable; |             |
|            | contact TAC |             |
|------------+-------------+-------------|
| 12.2IXD    | Vulnerable; |             |
|            | contact TAC |             |
|------------+-------------+-------------|
| 12.2IXE    | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2JA     | first fixed |             |
|            | in 12.3JA   |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2JK     | first fixed | 12.4(15)T4  |
|            | in 12.4T    |             |
|------------+-------------+-------------|
| 12.2MB     | Vulnerable; |             |
|            | contact TAC |             |
|------------+-------------+-------------|
| 12.2MC     | 12.2(15)    | 12.4(18a)   |
|            | MC2h        |             |
|------------+-------------+-------------|
|            | 12.2(14)S18 |             |
|            |             |             |
|            | 12.2(18)S13 |             |
| 12.2S      |             | 12.2(25)S15 |
|            | 12.2(20)S14 |             |
|            |             |             |
|            | 12.2(25)S13 |             |
|------------+-------------+-------------|
|            | 12.2(28)SB7 |             |
|            |             |             |
|            | 12.2(31)SB5 |             |
| 12.2SB     |             | 12.2(28)    |
|            | 12.2(33)SB; | SB12        |
|            | Available   |             |
|            | on          |             |
|            | 31-MAR-2008 |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
|            | first fixed |             |
| 12.2SBC    | in 12.2SB;  | 12.2(28)    |
|            | Available   | SB12        |
|            | on          |             |
|            | 31-MAR-2008 |             |
|------------+-------------+-------------|
| 12.2SCA    | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
|            | 12.2(35)SE4 |             |
| 12.2SE     |             | 12.2(44)SE1 |
|            | 12.2(37)SE  |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2SEA    | first fixed |             |
|            | in 12.2SEE  |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2SEB    | first fixed |             |
|            | in 12.2SEE  |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2SEC    | first fixed |             |
|            | in 12.2SEE  |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2SED    | first fixed |             |
|            | in 12.2SEE  |             |
|------------+-------------+-------------|
| 12.2SEE    | 12.2(25)    |             |
|            | SEE4        |             |
|------------+-------------+-------------|
| 12.2SEF    | 12.2(25)    | 12.2(44)SE1 |
|            | SEF3        |             |
|------------+-------------+-------------|
| 12.2SEG    | 12.2(25)    | 12.2(25)    |
|            | SEG3        | SEG4        |
|------------+-------------+-------------|
|            | 12.2(25)SG3 |             |
|            |             |             |
| 12.2SG     | 12.2(31)SG3 | 12.2(44)SG  |
|            |             |             |
|            | 12.2(37)SG  |             |
|------------+-------------+-------------|
|            | 12.2(31)    |             |
|            | SGA2        |             |
|            |             |             |
|            | 12.2(31)    |             |
|            | SGA3        | 12.2(31)    |
| 12.2SGA    |             | SGA5        |
|            | 12.2(31)    |             |
|            | SGA6;       |             |
|            | Available   |             |
|            | on          |             |
|            | 07-APR-2008 |             |
|------------+-------------+-------------|
| 12.2SL     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.2SM     | Vulnerable; |             |
|            | contact TAC |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2SO     | migrate to  | 12.2(29)SVD |
|            | any release |             |
|            | in 12.2SVA  |             |
|------------+-------------+-------------|
| 12.2SRA    | 12.2(33)    | 12.2(33)    |
|            | SRA4        | SRA7        |
|------------+-------------+-------------|
|            |             | 12.2(33)    |
|            | 12.2(33)    | SRB3;       |
| 12.2SRB    | SRB1        | Available   |
|            |             | on          |
|            |             | 31-MAR-2008 |
|------------+-------------+-------------|
| 12.2SRC    | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2SU     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
| 12.2SV     | 12.2(29b)SV | 12.2(29b)SV |
|------------+-------------+-------------|
| 12.2SVA    | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.2SVC    | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.2SVD    | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.2SW     | Vulnerable; |             |
|            | contact TAC |             |
|------------+-------------+-------------|
|            | Vulnerable; | 12.2(18)    |
| 12.2SX     | first fixed | SXF13       |
|            | in 12.2SXF  |             |
|------------+-------------+-------------|
|            | Vulnerable; | 12.2(18)    |
| 12.2SXA    | first fixed | SXF13       |
|            | in 12.2SXF  |             |
|------------+-------------+-------------|
|            | Vulnerable; | 12.2(18)    |
| 12.2SXB    | first fixed | SXF13       |
|            | in 12.2SXF  |             |
|------------+-------------+-------------|
|            | Vulnerable; | 12.2(18)    |
| 12.2SXD    | first fixed | SXF13       |
|            | in 12.2SXF  |             |
|------------+-------------+-------------|
|            | Vulnerable; | 12.2(18)    |
| 12.2SXE    | first fixed | SXF13       |
|            | in 12.2SXF  |             |
|------------+-------------+-------------|
|            | 12.2(18)    |             |
|            | SXF10a      |             |
|            |             |             |
|            | 12.2(18)    |             |
|            | SXF12a      | 12.2(18)    |
| 12.2SXF    |             | SXF13       |
|            | 12.2(18)    |             |
|            | SXF13a      |             |
|            |             |             |
|            | 12.2(18)    |             |
|            | SXF9        |             |
|------------+-------------+-------------|
| 12.2SXH    | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
|            | Vulnerable; | 12.2(18)    |
| 12.2SY     | first fixed | SXF13       |
|            | in 12.2SXF  |             |
|------------+-------------+-------------|
|            |             | 12.2(25)S15 |
|            | Vulnerable; |             |
| 12.2SZ     | first fixed | 12.2(28)    |
|            | in 12.2S    | SB12        |
|            |             |             |
|            |             | 12.2(33)SRC |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2T      | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
| 12.2TPC    | 12.2(8)     |             |
|            | TPC10b      |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
|            | first fixed |             |
| 12.2UZ     | in 12.2SB;  | 12.2(28)    |
|            | Available   | SB12        |
|            | on          |             |
|            | 31-MAR-2008 |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2XA     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2XB     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2XC     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2XD     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2XE     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2XF     | first fixed | 12.3(23)BC1 |
|            | in 12.3BC   |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2XG     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2XH     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2XI     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2XJ     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2XK     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2XL     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2XM     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
| 12.2XN     | 12.2(33)XN1 | 12.3(26)    |
|------------+-------------+-------------|
| 12.2XO     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2XQ     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2XR     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
| 12.2XS     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2XT     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2XU     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2XV     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2XW     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | 12.2(4)     |             |
|            | YA13;       |             |
| 12.2YA     | Available   | 12.3(26)    |
|            | on          |             |
|            | 31-MAR-2008 |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2YB     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2YC     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2YD     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            |             | 12.2(25)S15 |
|            | Vulnerable; |             |
| 12.2YE     | first fixed | 12.2(28)    |
|            | in 12.2S    | SB12        |
|            |             |             |
|            |             | 12.2(33)SRC |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2YF     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2YG     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2YH     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2YJ     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2YK     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2YL     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2YM     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2YN     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            | Vulnerable; | 12.2(18)    |
| 12.2YO     | first fixed | SXF13       |
|            | in 12.2SXF  |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2YP     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2YQ     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2YR     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
| 12.2YS     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2YT     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2YU     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2YV     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2YW     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2YX     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2YY     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            |             | 12.2(25)S15 |
|            | Vulnerable; |             |
| 12.2YZ     | first fixed | 12.2(28)    |
|            | in 12.2S    | SB12        |
|            |             |             |
|            |             | 12.2(33)SRC |
|------------+-------------+-------------|
|            | Vulnerable; | 12.2(18)    |
| 12.2ZA     | first fixed | SXF13       |
|            | in 12.2SXF  |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2ZB     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2ZC     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
| 12.2ZD     | Vulnerable; |             |
|            | contact TAC |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2ZE     | first fixed | 12.3(26)    |
|            | in 12.3     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2ZF     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            | Vulnerable; | 12.4(15)T4  |
| 12.2ZG     | first fixed |             |
|            | in 12.3YG   | 12.4(18a)   |
|------------+-------------+-------------|
| 12.2ZH     | 12.2(13)ZH9 | 12.2(13)    |
|            |             | ZH11        |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2ZJ     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            | Vulnerable; | 12.4(15)T4  |
| 12.2ZL     | first fixed |             |
|            | in 12.4     | 12.4(18a)   |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2ZP     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.2ZU     | migrate to  | 12.2(33)    |
|            | any release | SXH2        |
|            | in 12.2SXH  |             |
|------------+-------------+-------------|
| 12.2ZY     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
|  Affected  | First Fixed | Recommended |
| 12.3-Based |   Release   |   Release   |
|  Releases  |             |             |
|------------+-------------+-------------|
|            | 12.3(17c)   |             |
|            |             |             |
|            | 12.3(18a)   |             |
| 12.3       |             | 12.3(26)    |
|            | 12.3(19a)   |             |
|            |             |             |
|            | 12.3(23)    |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.3B      | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            | 12.3(17b)   |             |
|            | BC8         |             |
|            |             |             |
| 12.3BC     | 12.3(21a)   | 12.3(23)BC1 |
|            | BC2         |             |
|            |             |             |
|            | 12.3(23)BC  |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.3BW     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
| 12.3EU     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
|            | 12.3(11)JA4 |             |
| 12.3JA     |             |             |
|            | 12.3(7)JA5  |             |
|------------+-------------+-------------|
| 12.3JEA    | 12.3(8)JEA2 | 12.3(8)JEA4 |
|------------+-------------+-------------|
| 12.3JEB    | 12.3(8)JEB1 | 12.3(8)JEB2 |
|------------+-------------+-------------|
| 12.3JEC    | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
|            | 12.3(2)JK3  |             |
| 12.3JK     |             | 12.3(8)JK1  |
|            | 12.3(8)JK   |             |
|------------+-------------+-------------|
| 12.3JL     | 12.3(2)JL2  | 12.3(2)JL4  |
|------------+-------------+-------------|
| 12.3JX     | 12.3(7)JX9  | 12.3(7)JX10 |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.3T      | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
| 12.3TPC    | 12.3(4)     |             |
|            | TPC11b      |             |
|------------+-------------+-------------|
| 12.3VA     | Vulnerable; |             |
|            | contact TAC |             |
|------------+-------------+-------------|
|            |             | 12.3(2)XA7; |
| 12.3XA     | 12.3(2)XA6  | Available   |
|            |             | on          |
|            |             | 31-MAR-2008 |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.3XB     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            |             | 12.4(15)T4  |
| 12.3XC     | 12.3(2)XC5  |             |
|            |             | 12.4(18a)   |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.3XD     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            | 12.3(2)XE6; | 12.4(15)T4  |
| 12.3XE     | Available   |             |
|            | on          | 12.4(18a)   |
|            | 31-MAR-2008 |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.3XF     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            | Vulnerable; | 12.4(15)T4  |
| 12.3XG     | first fixed |             |
|            | in 12.3YG   | 12.4(18a)   |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.3XH     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
| 12.3XI     | 12.3(7)XI10 |             |
|------------+-------------+-------------|
|            | Vulnerable; | 12.3(14)    |
| 12.3XJ     | first fixed | YX11        |
|            | in 12.3YX   |             |
|            |             | 12.4(15)T4  |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.3XK     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.3XQ     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            |             | 12.3(7)XR8; |
| 12.3XR     | 12.3(7)XR7  | Available   |
|            |             | on          |
|            |             | 31-MAR-2008 |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.3XS     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.3XU     | first fixed | 12.4(15)T4  |
|            | in 12.4T    |             |
|------------+-------------+-------------|
|            | Vulnerable; | 12.3(14)    |
| 12.3XW     | first fixed | YX11        |
|            | in 12.3YX   |             |
|            |             | 12.4(15)T4  |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.3XY     | first fixed | 12.4(18a)   |
|            | in 12.4     |             |
|------------+-------------+-------------|
|            | Vulnerable; | 12.4(15)T4  |
| 12.3YA     | first fixed |             |
|            | in 12.4     | 12.4(18a)   |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.3YD     | first fixed | 12.4(15)T4  |
|            | in 12.4T    |             |
|------------+-------------+-------------|
|            | Vulnerable; | 12.3(14)    |
| 12.3YF     | first fixed | YX11        |
|            | in 12.3YX   |             |
|            |             | 12.4(15)T4  |
|------------+-------------+-------------|
| 12.3YG     | 12.3(8)YG6  | 12.4(15)T4  |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.3YH     | first fixed | 12.4(15)T4  |
|            | in 12.4T    |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.3YI     | first fixed | 12.4(15)T4  |
|            | in 12.4T    |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.3YJ     | first fixed | 12.4(15)T4  |
|            | in 12.4T    |             |
|------------+-------------+-------------|
| 12.3YK     | 12.3(11)YK3 | 12.4(15)T4  |
|------------+-------------+-------------|
| 12.3YM     | 12.3(14)    | 12.3(14)    |
|            | YM10        | YM12        |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.3YQ     | first fixed | 12.4(15)T4  |
|            | in 12.4T    |             |
|------------+-------------+-------------|
|            | 12.3(11)    |             |
|            | YS3;        |             |
| 12.3YS     | Available   | 12.4(15)T4  |
|            | on          |             |
|            | 31-MAR-2008 |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.3YT     | first fixed | 12.4(15)T4  |
|            | in 12.4T    |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.3YU     | first fixed |             |
|            | in 12.4XB   |             |
|------------+-------------+-------------|
| 12.3YX     | 12.3(14)YX8 | 12.3(14)    |
|            |             | YX11        |
|------------+-------------+-------------|
| 12.3YZ     | 12.3(11)YZ2 |             |
|------------+-------------+-------------|
|  Affected  | First Fixed | Recommended |
| 12.4-Based |   Release   |   Release   |
|  Releases  |             |             |
|------------+-------------+-------------|
|            | 12.4(10c)   |             |
|            |             |             |
|            | 12.4(12)    |             |
|            |             |             |
|            | 12.4(17a)   |             |
|            |             |             |
| 12.4       | 12.4(3h)    | 12.4(18a)   |
|            |             |             |
|            | 12.4(5c)    |             |
|            |             |             |
|            | 12.4(7e)    |             |
|            |             |             |
|            | 12.4(8d)    |             |
|------------+-------------+-------------|
| 12.4JA     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.4JK     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.4JMA    | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.4JMB    | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.4JMC    | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.4JX     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.4MD     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.4MR     | 12.4(12)MR  | 12.4(16)MR2 |
|------------+-------------+-------------|
| 12.4SW     | 12.4(11)SW3 | 12.4(15)SW  |
|------------+-------------+-------------|
|            | 12.4(11)T2  |             |
|            |             |             |
|            | 12.4(15)T   |             |
|            |             |             |
|            | 12.4(2)T6   |             |
| 12.4T      |             | 12.4(15)T4  |
|            | 12.4(4)T8   |             |
|            |             |             |
|            | 12.4(6)T8   |             |
|            |             |             |
|            | 12.4(9)T3   |             |
|------------+-------------+-------------|
|            | Vulnerable; |             |
| 12.4XA     | first fixed | 12.4(15)T4  |
|            | in 12.4T    |             |
|------------+-------------+-------------|
| 12.4XB     | 12.4(2)XB6  |             |
|------------+-------------+-------------|
| 12.4XC     | 12.4(4)XC7  |             |
|------------+-------------+-------------|
| 12.4XD     | 12.4(4)XD7  | 12.4(4)XD10 |
|------------+-------------+-------------|
| 12.4XE     | 12.4(6)XE2  | 12.4(15)T4  |
|------------+-------------+-------------|
| 12.4XF     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.4XG     | 12.4(9)XG2  | 12.4(9)XG2  |
|------------+-------------+-------------|
| 12.4XJ     | 12.4(11)XJ4 | 12.4(15)T4  |
|------------+-------------+-------------|
| 12.4XK     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.4XL     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.4XM     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.4XN     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.4XT     | 12.4(6)XT1  | 12.4(6)XT2  |
|------------+-------------+-------------|
| 12.4XV     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.4XW     | Not         |             |
|            | Vulnerable  |             |
|------------+-------------+-------------|
| 12.4XY     | Not         |             |
|            | Vulnerable  |             |
+----------------------------------------+

Workarounds
===========

A blocked interface can be unblocked by disabling the UDP service
whose packets are blocking the interface. This procedure can restore
normal operation of the interface without rebooting the device. The
procedure for disabling vulnerable services are described in the "If
IPv4 UDP-based Services Are Not Required" section.

The following workarounds are options that may be available depending
on the Cisco IOS software running on the device and the operating
environment. The workarounds depend on whether IPv6 or any of the
affected UDP services are required for the normal operation.

If IPv6 Protocol Is Not Required
+-------------------------------

Disable IPv6. To disable IPv6 use the following commands:

    Router(config)#interface FastEthernet0/0
    Router(config-if)#no ipv6 address

or

    Router(config)#interface FastEthernet0/0
    Router(config-if)#no ipv6 enable

If RSVP is the only affected service that is configured it is
sufficient to disable IPv6 only on the interface where RSVP is
configured. If any other affected UDP service is present on the
device then IPv6 would have to be disabled from all interfaces.

If IPv4 UDP-based Services Are Not Required
+------------------------------------------

Disable all affected IPv4 UDP-based services.

Disabling TACACS
+---------------

To disable TACACS use the following commands:

    Router(config)#no tacacs-server host <IP-address>

or

    Router(config)#no tacacs-server administration

Disabling DNS
+------------

To disable DNS use the following command:

    Router(config)#no ip dns server

Disabling RSVP
+-------------

To disable RSVP use the following commands:

    Router(config)#interface <Interface>
    Router(config)#no ip rsvp bandwidth

Disabling L2F/L2TP
+-----------------

To disable L2F/L2TP use the following commands:

    Router(config)#clear vpdn tunnel l2tp all
    Router(config)#no vpdn-group <group-name>
    Router(config)#no vpdn enable

Disabling IP SLA Responder
+-------------------------

To disable IP SLA Responder use the following command:

    Router(config)#no ip sla monitor responder

Disabling MGCP
+-------------

To disable MGCP use the following command:

    Router(config)#no mgcp

Disabling SIP
+------------

To disable SIP use the following commands:

    Router(config)#sip-ua
    Router(config-sip-ua)#no transport udp
    Router(config-sip-ua)#no transport tcp

If IPv4 UDP-based Services Are Required
+---------------------------------------

By deploying IPv6 Access Control List (ACL) it is possible to prevent
offending IPv6 packets reaching vulnerable UDP services. The ACL in
the following example will block all IPv6 traffic from reaching
vulnerable services.

    Router(config)#ipv6 access-list protect_IPv4_services
    Router(config-ipv6-acl)#deny udp any 2001:DB8:1:128::/64 eq tacacs
    Router(config-ipv6-acl)#deny udp any 2001:DB8:1:128::/64 eq domain
    Router(config-ipv6-acl)#deny udp any 2001:DB8:1:128::/64 eq 1698
    Router(config-ipv6-acl)#deny udp any 2001:DB8:1:128::/64 eq 1701
    Router(config-ipv6-acl)#deny udp any 2001:DB8:1:128::/64 eq 1967
    Router(config-ipv6-acl)#deny udp any 2001:DB8:1:128::/64 eq 2427
    Router(config-ipv6-acl)#deny udp any 2001:DB8:1:128::/64 eq 5060
    
    !-- Permit/deny all other Layer 3 and Layer 4 traffic in accordance        
    !-- with existing security policies and configurations                     
    !
    !-- Allow all other IPv6 traffic
    
    Router(config-ipv6-acl)#permit ipv6 any 2001:db8:1:128::/64
    
    !
    !
    
    Router(config)#interface FastEthernet0/1
    Router(config-if)#ipv6 traffic-filter protect_IPv4_services in

Additional mitigation techniques that can be deployed on Cisco
devices within the network are available in the Cisco Applied
Mitigation Bulletin companion document for this advisory:

http://www.cisco.com/warp/public/707/cisco-amb-20080326-IPv4IPv6.shtml

Obtaining Fixed Software
========================

Cisco has released free software updates that address this
vulnerability. Prior to deploying software, customers should consult
their maintenance provider or check the software for feature set
compatibility and known issues specific to their environment.

Customers may only install and expect support for the feature sets
they have purchased. By installing, downloading, accessing or
otherwise using such software upgrades, customers agree to be bound
by the terms of Cisco's software license terms found at 
http://www.cisco.com/en/US/products/prod_warranties_item09186a008088e31f.html
or as otherwise set forth at Cisco.com Downloads at 
http://www.cisco.com/public/sw-center/sw-usingswc.shtml.

Do not contact psirt@...co.com or security-alert@...co.com for
software upgrades.

Customers with Service Contracts
+-------------------------------

Customers with contracts should obtain upgraded software through
their regular update channels. For most customers, this means that
upgrades should be obtained through the Software Center on Cisco's
worldwide website at http://www.cisco.com.

Customers using Third Party Support Organizations
+------------------------------------------------

Customers whose Cisco products are provided or maintained through
prior or existing agreements with third-party support organizations,
such as Cisco Partners, authorized resellers, or service providers
should contact that support organization for guidance and assistance
with the appropriate course of action in regards to this advisory.

The effectiveness of any workaround or fix is dependent on specific
customer situations, such as product mix, network topology, traffic
behavior, and organizational mission. Due to the variety of affected
products and releases, customers should consult with their service
provider or support organization to ensure any applied workaround or
fix is the most appropriate for use in the intended network before it
is deployed.

Customers without Service Contracts
+----------------------------------

Customers who purchase direct from Cisco but do not hold a Cisco
service contract, and customers who purchase through third-party
vendors but are unsuccessful in obtaining fixed software through
their point of sale should acquire upgrades by contacting the Cisco
Technical Assistance Center (TAC). TAC contacts are as follows.

  * +1 800 553 2447 (toll free from within North America)
  * +1 408 526 7209 (toll call from anywhere in the world)
  * e-mail: tac@...co.com

Customers should have their product serial number available and be
prepared to give the URL of this notice as evidence of entitlement to
a free upgrade. Free upgrades for non-contract customers must be
requested through the TAC.

Refer to http://www.cisco.com/warp/public/687/Directory/DirTAC.shtml
for additional TAC contact information, including localized telephone
numbers, and instructions and e-mail addresses for use in various
languages.

Exploitation and Public Announcements
=====================================

The Cisco PSIRT is not aware of any public announcements or malicious
use of the vulnerability described in this advisory.

This vulnerability was encountered in customer networks.

Status of this Notice: FINAL
============================

THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY
KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF
MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE
INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS
AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS
DOCUMENT AT ANY TIME.

A stand-alone copy or Paraphrase of the text of this document that
omits the distribution URL in the following section is an
uncontrolled copy, and may lack important information or contain
factual errors.

Distribution
============

This advisory is posted on Cisco's worldwide website at:

http://www.cisco.com/warp/public/707/cisco-sa-20080326-IPv4IPv6.shtml

In addition to worldwide web posting, a text version of this notice
is clear-signed with the Cisco PSIRT PGP key and is posted to the
following e-mail and Usenet news recipients.

  * cust-security-announce@...co.com
  * first-bulletin@...st.org
  * bugtraq@...urityfocus.com
  * vulnwatch@...nwatch.org
  * cisco@...t.colorado.edu
  * cisco-nsp@...k.nether.net
  * full-disclosure@...ts.grok.org.uk
  * comp.dcom.sys.cisco@...sgate.cisco.com

Future updates of this advisory, if any, will be placed on Cisco's
worldwide website, but may or may not be actively announced on
mailing lists or newsgroups. Users concerned about this problem are
encouraged to check the above URL for any updates.

Revision History
================

+---------------------------------------+
| Revision |             | Initial      |
| 1.0      | 2008-Mar-26 | public       |
|          |             | release      |
+---------------------------------------+

Cisco Security Procedures
=========================

Complete information on reporting security vulnerabilities in Cisco
products, obtaining assistance with security incidents, and
registering to receive security information from Cisco, is available
on Cisco's worldwide website at 
http://www.cisco.com/en/US/products/products_security_vulnerability_policy.html.
This includes instructions for press inquiries regarding Cisco 
security notices. All Cisco security advisories are available at 
http://www.cisco.com/go/psirt.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (Darwin)

iEYEARECAAYFAkfqS4gACgkQ86n/Gc8U/uAm/ACggxEFIL0aetfoQ27m64AVtqnj
ppcAnjzf09ihO63iGHlZl3X4PAeo7L2I
=y1wT
-----END PGP SIGNATURE-----
