
Date: Mon, 22 Nov 2010 11:31:52 -0500 (EST)
From: Josh Bressers <bressers@...hat.com>
To: oss-security@...ts.openwall.com
Cc: "Steven M. Christey" <coley@...us.mitre.org>
Subject: Re: CVE request: kernel: missing tty ops write
 function presence check in hci_uart_tty_open()

Please use CVE-2010-4242

Thanks.

-- 
    JB


----- "Eugene Teo" <eugene@...hat.com> wrote:

> hci_uart_tty_open() is missing check that tty has a write op (a few 
> don't), and you should check this at open and refuse if the ops you
> need 
> don't exist, eg as SLIP does:
> 
> static int slip_open(struct tty_struct *tty)
> {
>          struct slip *sl;
>          int err;
> 
>          if (!capable(CAP_NET_ADMIN))
>                  return -EPERM;
> 
>          if (tty->ops->write == NULL)
>                  return -EOPNOTSUPP;
> 
> https://bugzilla.redhat.com/show_bug.cgi?id=641410
> http://git.kernel.org/linus/c19483cc5e56ac5e22dd19cf25ba210ab1537773
> 
> Thanks, Eugene
