
Date: Wed, 5 May 2021 09:36:49 -0700
From: Aaron Patterson <aaron.patterson@...il.com>
To: rubyonrails-security@...glegroups.com, oss-security@...ts.openwall.com, 
	ruby-security-ann@...glegroups.com
Subject: [CVE-2021-22902] Possible Denial of Service vulnerability in Action Dispatch

There is a possible Denial of Service vulnerability in the Mime type parser
of
Action Dispatch. This vulnerability has been assigned the CVE identifier
CVE-2021-22902.

Versions Affected:  >= 6.0.0
Not affected:       < 6.0.0
Fixed Versions:     6.0.3.7, 6.1.0.2

Impact
------
There is a possible Denial of Service vulnerability in Action Dispatch.
Carefully crafted Accept headers can cause the mime type parser in Action
Dispatch to do catastrophic backtracking in the regular expression engine.

Releases
--------
The fixed releases are available at the normal locations.

Workarounds
-----------
The following monkey patch placed in an initializer can be used to work
around
the issue:

```ruby
module Mime
  class Type
    MIME_REGEXP =
/\A(?:\*\/\*|#{MIME_NAME}\/(?:\*|#{MIME_NAME})(?>\s*#{MIME_PARAMETER}\s*)*)\z/
  end
end
```

Patches
-------
To aid users who aren't able to upgrade immediately we have provided
patches for
the two supported release series. They are in git-am format and consist of a
single changeset.

* 6-0-Prevent-catastrophic-backtracking-during-mime-parsin.patch - Patch
for 6.0 series
* 6-1-Prevent-catastrophic-backtracking-during-mime-parsin.patch - Patch
for 6.1 series

Please note that only the 6.1.Z, 6.0.Z, and 5.2.Z series are supported at
present. Users of earlier unsupported releases are advised to upgrade as
soon
as possible as we cannot guarantee the continued availability of security
fixes for unsupported releases.

Credits
-------

Thanks to Security Curious <security-curious@...me> for reporting this!

-- 
Aaron Patterson
http://tenderlovemaking.com/

Content of type "text/html" skipped

Download attachment "6-0-Prevent-catastrophic-backtracking-during-mime-parsin.patch" of type "application/octet-stream" (2246 bytes)

Download attachment "6-1-Prevent-catastrophic-backtracking-during-mime-parsin.patch" of type "application/octet-stream" (2290 bytes)
