
Date: Wed, 22 Feb 2012 10:04:37 -0700
From: Vincent Danen <vdanen@...hat.com>
To: oss-security@...ts.openwall.com
Cc: systemtap@...rceware.org
Subject: CVE-2012-0875: systemtap memory disclosure/kernel panic when
 processing malformed DWARF unwind data

A flaw was discovered [1] in how systemtap handled DWARF expressions
when unwinding the stack.  This could result in an invalid pointer read,
leading to reading kernel memory, or a kernel panic (and if the kernel
reboot on panic flag was set (panic_on_oops), it would cause the system
to reboot).

In order to trigger this flaw, an admin would have to enable
unprivileged mode (giving users membership in the 'stapusr' group and
configuring the local machine with 'signer,all-users' stap-server
trust). If an admin has enabled unprivileged mode, a user with such
access could use this to crash the local machine.

A workaround is to disable unprivileged mode.

This will be corrected in a forthcoming upstream release of systemtap,
and is currently fixed in git [2].  It is believed that this flaw was
introduced via git commit 16d59279f [3], so would affect systemtap >=
1.4.

[1] http://sourceware.org/bugzilla/show_bug.cgi?id=13714
[2] http://sourceware.org/git/?p=systemtap.git;a=commit;h=64b0cff3b
[3] http://sourceware.org/git/?p=systemtap.git;a=commit;h=16d59279f

This is tracked in the Red Hat bugzilla via:
https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2012-0875

and is assigned the name CVE-2012-0875.

-- 
Vincent Danen / Red Hat Security Response Team 

Content of type "application/pgp-signature" skipped
