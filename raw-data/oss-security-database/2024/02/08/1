
Date: Thu, 08 Feb 2024 03:28:39 +0000
From: Wang Weibing <wwbmmm@...che.org>
To: oss-security@...ts.openwall.com
Subject: CVE-2024-23452: Apache bRPC: HTTP request smuggling vulnerability 

Severity: moderate

Affected versions:

- Apache bRPC 0.9.5 before 1.8.0

Description:

Request smuggling vulnerability in HTTP server in Apache bRPC 0.9.5~1.7.0 on all platforms allows attacker to smuggle request.

Vulnerability Cause Description：

The http_parser does not comply with the RFC-7320 HTTP 1.1 specification.

Attack scenario:
If a message is received with both a Transfer-Encoding and a Content-Length header field, such a message might indicate an attempt to perform request smuggling or response splitting.
One particular attack scenario is that a bRPC made http server on the backend receiving requests in one persistent connection from frontend server that uses TE to parse request with the logic that 'chunk' is contained in the TE field. in that case an attacker can smuggle a request into the connection to the backend server. 

Solution:
You can choose one solution from below:
1. Upgrade bRPC to version 1.8.0, which fixes this issue. Download link:  https://github.com/apache/brpc/releases/tag/1.8.0
 2. Apply this patch:  https://github.com/apache/brpc/pull/2518

Credit:

Pingtao Wei of 2012 Laboratories (finder)
Ziyang Chen of 2012 Laboratories (finder)
Haoran Zhi of 2012 Laboratories (finder)
Hongpei Li of 2012 Laboratories (finder)

References:

https://github.com/apache/brpc/releases/tag/1.8.0
https://github.com/apache/brpc/pull/2518
https://brpc.apache.org
https://www.cve.org/CVERecord?id=CVE-2024-23452

