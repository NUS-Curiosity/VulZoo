
Date: Fri, 09 Feb 2024 17:20:43 +0000
From: Houston Putman <houston@...che.org>
To: oss-security@...ts.openwall.com
Subject: CVE-2023-50292: Apache Solr: Solr Schema Designer blindly "trusts" all configsets, possibly leading to RCE by unauthenticated users 

Severity: critical

Affected versions:

- Apache Solr 8.10.0 through 8.11.2
- Apache Solr 9.0.0 before 9.3.0

Description:

Incorrect Permission Assignment for Critical Resource, Improper Control of Dynamically-Managed Code Resources vulnerability in Apache Solr.

This issue affects Apache Solr: from 8.10.0 through 8.11.2, from 9.0.0 before 9.3.0.

The Schema Designer was introduced to allow users to more easily configure and test new Schemas and configSets.
However, when the feature was created, the "trust" (authentication) of these configSets was not considered.
External library loading is only available to configSets that are "trusted" (created by authenticated users), thus non-authenticated users are unable to perform Remote Code Execution.
Since the Schema Designer loaded configSets without taking their "trust" into account, configSets that were created by unauthenticated users were allowed to load external libraries when used in the Schema Designer.

Users are recommended to upgrade to version 9.3.0, which fixes the issue.

This issue is being tracked as SOLR-16777 

Credit:

Skay (reporter)

References:

https://solr.staged.apache.org/security.html#cve-2023-50298-apache-solr-can-expose-zookeeper-credentials-via-streaming-expressions
https://solr.apache.org
https://www.cve.org/CVERecord?id=CVE-2023-50292
https://issues.apache.org/jira/browse/SOLR-16777

