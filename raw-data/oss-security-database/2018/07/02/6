
Date: Mon, 2 Jul 2018 16:38:01 +0200
From: Matthias Gerstner <mgerstner@...e.de>
To: oss-security@...ts.openwall.com
Subject: Re: accountsservice: insufficient path check in
 user_change_icon_file_authorized_cb()

Hi,

> >I think the easiest way to fix this is to normalize the user supplied 
> >filename e.g. using realpath()
> 
> Using realpath(3) for access control is almost always a mistake: this 
> function expands symlinks, including attacker-controlled symlinks.

can you elaborate what your main worry of using realpath is in this
context?

It surely is better not to expand attacker controlled symlinks or
perform and system calls if it is not necessary. But I fail to see the
security issue of just calling realpath(3) on an attacker controlled
path.

Regards

Matthias

Download attachment "signature.asc" of type "application/pgp-signature" (834 bytes)
