
Date: Tue, 6 Nov 2018 23:28:37 +0100
From: Remi Gacogne <remi.gacogne@...erdns.com>
To: oss-security@...ts.openwall.com
Subject: PowerDNS Security Advisories 2018-03, 2018-04, 2018-05, 2018-06 and
 2018-07

Hello everybody,

We just released PowerDNS Authoritative 4.1.5 and 4.0.6, and Recursor
4.1.5 and 4.0.9, fixing several security issues:

 * 2018-03: Crafted zone record can cause a denial of service
(CVE-2018-10851, Authoritative)
 * 2018-04: Crafted answer can cause a denial of service
(CVE-2018-10851, Recursor)
 * 2018-05: Packet cache pollution via crafted query (CVE-2018-14626,
Authoritative >= 4.1.0)
 * 2018-06: Packet cache pollution via crafted query (CVE-2018-14626,
Recursor >= 4.0.0)
 * 2018-07: Crafted query for meta-types can cause a denial of service
(CVE-2018-14644, Recursor >= 4.0.0)

The full security advisories can be found below, and also at:

-
https://doc.powerdns.com/authoritative/security-advisories/powerdns-advisory-2018-03.html
-
https://doc.powerdns.com/recursor/security-advisories/powerdns-advisory-2018-04.html
-
https://doc.powerdns.com/authoritative/security-advisories/powerdns-advisory-2018-05.html
-
https://doc.powerdns.com/recursor/security-advisories/powerdns-advisory-2018-06.html
-
https://doc.powerdns.com/recursor/security-advisories/powerdns-advisory-2018-07.html

We also provide minimal patches here:

- https://downloads.powerdns.com/patches/2018-03/
- https://downloads.powerdns.com/patches/2018-04/
- https://downloads.powerdns.com/patches/2018-05/
- https://downloads.powerdns.com/patches/2018-06/
- https://downloads.powerdns.com/patches/2018-07/


Please feel free to contact me directly if you have any question.

Best regards,

Remi Gacogne
PowerDNS.COM BV - https://www.powerdns.com/

PowerDNS Security Advisory 2018-03: Crafted zone record can cause a
denial of service
=====================================================================================

-  CVE: CVE-2018-10851
-  Date: November 6th 2018
-  Affects: PowerDNS Authoritative from 3.3.0 up to and including 4.1.4
-  Not affected: 4.1.5, 4.0.6
-  Severity: Medium
-  Impact: Denial of service
-  Exploit: This problem can be triggered via crafted records
-  Risk of system compromise: No
-  Solution: Upgrade to a non-affected version
-  Workaround: run the process inside the guardian or inside a
   supervisor

An issue has been found in PowerDNS Authoritative Server allowing an
authorized user to cause a memory leak by inserting a specially crafted
record in a zone under their control, then sending a DNS query for that
record.
The issue is due to the fact that some memory is allocated before the
parsing and is not always properly released if the record is malformed.

This issue has been assigned CVE-2018-10851.

When the PowerDNS Authoritative Server is run inside the guardian
(``--guardian``), or inside a supervisor like supervisord or systemd, an
out-of-memory crash will lead to an automatic restart, limiting the
impact to a somewhat degraded service.

PowerDNS Authoritative from 3.3.0 up to and including 4.1.4 is affected.
Please note that at the time of writing, PowerDNS Authoritative 3.4 and
below are no longer supported, as described in
https://doc.powerdns.com/authoritative/appendices/EOL.html.

PowerDNS Security Advisory 2018-04: Crafted answer can cause a denial of
service
================================================================================

-  CVE: CVE-2018-10851
-  Date: November 6th 2018
-  Affects: PowerDNS Recursor from 3.2 up to and including 4.1.4
-  Not affected: 4.1.5, 4.0.9
-  Severity: Medium
-  Impact: Denial of service
-  Exploit: This problem can be triggered by an authoritative server
-  Risk of system compromise: No
-  Solution: Upgrade to a non-affected version
-  Workaround: run the process inside a supervisor

An issue has been found in PowerDNS Recursor allowing a malicious
authoritative server to cause a memory leak by sending specially crafted
records.
The issue is due to the fact that some memory is allocated before the
parsing and is not always properly released if the record is malformed.

This issue has been assigned CVE-2018-10851.

When the PowerDNS Recursor is run inside a supervisor like supervisord
or systemd, an out-of-memory crash will lead to an automatic restart,
limiting
the impact to a somewhat degraded service.

PowerDNS Recursor from 3.2 up to and including 4.1.4 is affected. Please
note that at the time of writing, PowerDNS Recursor 3.7 and below are no
longer supported, as described in
https://doc.powerdns.com/recursor/appendices/EOL.html.

PowerDNS Security Advisory 2018-05: Packet cache pollution via crafted query
============================================================================

-  CVE: CVE-2018-14626
-  Date: November 6th 2018
-  Affects: PowerDNS Authoritative from 4.1.0 up to and including 4.1.4
-  Not affected: 4.1.5, 4.0.x
-  Severity: Medium
-  Impact: Denial of service
-  Exploit: This problem can be triggered via crafted queries
-  Risk of system compromise: No
-  Solution: Upgrade to a non-affected version

An issue has been found in PowerDNS Authoritative Server allowing a
remote user to craft a DNS query that will cause an answer without DNSSEC
records to be inserted into the packet cache and be returned to clients
asking for DNSSEC records, thus hiding the presence of DNSSEC signatures
for a specific qname and qtype.
For a DNSSEC-signed domain, this means that DNSSEC validating clients
will consider the answer to be bogus until it expires from the packet
cache, leading to a denial of service.

This issue has been assigned CVE-2018-14626.

PowerDNS Authoritative from 4.1.0 up to and including 4.1.4 is affected.

We would like to thank Kees Monshouwer for finding and subsequently
reporting this issue.

PowerDNS Security Advisory 2018-06: Packet cache pollution via crafted query
============================================================================

-  CVE: CVE-2018-14626
-  Date: November 6th 2018
-  Affects: PowerDNS Recursor from 4.0.0 up to and including 4.1.4
-  Not affected: 4.1.5, 4.0.9
-  Severity: Medium
-  Impact: Denial of service
-  Exploit: This problem can be triggered via crafted queries
-  Risk of system compromise: No
-  Solution: Upgrade to a non-affected version

An issue has been found in PowerDNS Recursor allowing a remote user to
craft a DNS query that will cause an answer without DNSSEC records to be
inserted into the packet cache and be returned to clients asking for
DNSSEC records, thus hiding the presence of DNSSEC signatures for a
specific qname and qtype. For a DNSSEC-signed domain, this means that
clients performing DNSSEC validation by themselves might consider the
answer to be bogus until it expires from the packet cache, leading to a
denial of service.

This issue has been assigned CVE-2018-14626.

PowerDNS Recursor from 4.0.0 up to and including 4.1.4 is affected.

We would like to thank Kees Monshouwer for finding and subsequently
reporting this issue.

PowerDNS Security Advisory 2018-07: Crafted query for meta-types can
cause a denial of service
==============================================================================================

-  CVE: CVE-2018-14644
-  Date: November 6th 2018
-  Affects: PowerDNS Recursor from 4.0.0 up to and including 4.1.4
-  Not affected: 4.0.9, 4.1.5
-  Severity: Medium
-  Impact: Denial of service
-  Exploit: This problem can be triggered via crafted queries for some
domains
-  Risk of system compromise: No
-  Solution: Upgrade to a non-affected version

An issue has been found in PowerDNS Recursor where a remote attacker
sending a DNS query for a meta-type like OPT can lead to a zone being
wrongly cached as failing DNSSEC validation. It only arises if the
parent zone is signed, and all the authoritative servers for that parent
zone answer with FORMERR to a query for at least one of the meta-types.
As a result, subsequent queries from clients requesting DNSSEC
validation will be answered with a ServFail.

This issue has been assigned CVE-2018-14644 by Red Hat.

PowerDNS Recursor from 4.0.0 up to and including 4.1.4 is affected.

We would like to thank Toshifumi Sakaguchi for finding and subsequently
reporting this issue.




Download attachment "signature.asc" of type "application/pgp-signature" (489 bytes)
