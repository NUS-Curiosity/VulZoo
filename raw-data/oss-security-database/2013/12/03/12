
Date: Tue, 3 Dec 2013 11:09:45 -0800
From: Aaron Patterson <tenderlove@...y-lang.org>
To: rubyonrails-security@...glegroups.com, oss-security@...ts.openwall.com,
	ruby-security-ann@...glegroups.com
Subject: [CVE-2013-6417] Incomplete fix to CVE-2013-0155 (Unsafe Query
 Generation Risk)

Incomplete fix to CVE-2013-0155 (Unsafe Query Generation Risk)

The prior fix to CVE-2013-0155 was incomplete and the use of common 3rd party libraries can accidentally circumvent the protection. This vulnerability has been assigned the CVE identifier CVE-2013-6417.

Versions Affected:  All.
Not affected:       None
Fixed Versions:     4.0.2 & 3.2.16

Impact 
------
Due to the way that Rack::Request and Rails::Request interact, it is possible for a 3rd party or custom rack middleware to parse the parameters insecurely and store them in the same key that Rails uses for its own parameters.  In the event that happens the application will receive unsafe parameters and could be vulnerable to the earlier vulnerability.

All users running an affected release should either upgrade or use one of the work arounds immediately. 

Releases 
-------- 
The 4.0.2 & 3.2.16 releases are available at the normal locations. 

Workarounds 
-----------
To work around this issue you need to audit your middleware chain and ensure that each of the libraries in use does not create an instance of Rack::Request. 

Patches 
------- 
To aid users who aren't able to upgrade immediately we have provided patches for the two supported release series.  They are in git-am format and consist of a single changeset. 

* 4-0-rack-params.patch - Patch for 4.0 series 
* 3-2-rack-params.patch - Patch for 3.2 series 

Please note that only the 4.0.x and 3.2.x series are supported at present.  Users of earlier unsupported releases are advised to upgrade as soon as possible as we cannot guarantee the continued availability of security fixes for unsupported releases.

Credits 
------- 
Thanks to Sudhir Rao for reporting the issue to us and to James Tucker for assisting with the fix.

-- 
Aaron Patterson
http://tenderlovemaking.com/

View attachment "3-2-rack-params.patch" of type "text/plain" (2718 bytes)

View attachment "4-0-rack-params.patch" of type "text/plain" (2810 bytes)

Content of type "application/pgp-signature" skipped
