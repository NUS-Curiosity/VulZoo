
Date: Mon, 09 Jan 2012 17:57:09 -0700
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com, cyd@....org, deng@...domsample.de,
        ulm@...too.org, "Steven M. Christey" <coley@...us.mitre.org>
Subject: CVE Request: CEDET/Emacs global-ede-mode file loading vulnerability

I'll assign this a CVE once I have determined the code base status (are
these considered the same codebase, or have they forked enough to be
considered separate code bases? Also I need to ensure this hasn't
already been assigned a CVE. CC'ing relevant developers as well.


EMACS

Hiroshi Oota has found a security flaw in EDE (part of CEDET), a
development tool included in Emacs.  EDE can store various information
about a project, such as how to build the project, in a file named
Project.ede in the project directory tree.  When the minor mode
`global-ede-mode' is enabled, visiting a file causes Emacs to look for
Project.ede in the file's directory or one of its parent directories.
If Project.ede is present, Emacs automatically reads and evaluates the
first Lisp expression in it.

This design exposes EDE users to the danger of loading malicious code
from one file (Project.ede), simply by visiting another file in the same
directory tree.

REF
http://lists.gnu.org/archive/html/emacs-devel/2012-01/msg00387.html
https://bugs.gentoo.org/show_bug.cgi?id=398241
https://bugs.gentoo.org/show_bug.cgi?id=398239
https://bugs.gentoo.org/show_bug.cgi?id=398227


CEDET
>>> Does this also affect the standalone version of CEDET, i.e. cedet-1.0
>>> from <http://cedet.sourceforge.net/>?
>
>> Yes.
>
> The patch for Emacs 23 fails for it, unfortunately. In case anyone is
> interested, a (almost trivially) backported version of the patch can
> be found here:
>
<http://sources.gentoo.org/cgi-bin/viewvc.cgi/gentoo-x86/app-emacs/cedet/files/cedet-1.0-ede_security_fix.patch>

A new CEDET 1.0.1 (or similar) will be released soon. The bzr repos
trunk and newtrunk were updated.

REF
http://lists.gnu.org/archive/html/emacs-devel/2012-01/msg00401.html
http://sources.gentoo.org/cgi-bin/viewvc.cgi/gentoo-x86/app-emacs/cedet/files/cedet-1.0-ede_security_fix.patch


-- 

-- Kurt Seifried / Red Hat Security Response Team

