
Date: Fri, 31 Aug 2012 18:11:53 +0200
From: Petr Matousek <pmatouse@...hat.com>
To: oss-security@...ts.openwall.com
Subject: CVE Request -- kernel: net: slab corruption due to improper
 synchronization around inet->opt

Description of the problem:
Lack proper synchronization to manipulate inet->opt ip_options can lead
to system crash.

Problem is that ip_make_skb() calls ip_setup_cork() and ip_setup_cork()
possibly makes a copy of ipc->opt (struct ip_options), without any
protection against another thread manipulating inet->opt. Another thread
can change inet->opt pointer and free old one under us.

Given right server application (setting socket options and processing
traffic over the same socket at the same time), remote attacker could
use this flaw to crash the system. More likely though, local
unprivileged user could use this flaw to crash the system.

Upstream fix:
http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commitdiff;h=f6d8bd051c391c1c0458a30b2a7abcd939329259

Thanks,
-- 
Petr Matousek / Red Hat Security Response Team
