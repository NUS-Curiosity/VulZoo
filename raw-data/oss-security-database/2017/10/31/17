
Date: Tue, 31 Oct 2017 12:44:38 -0700
From: Jesus Camacho Rodriguez <jcamacho@...che.org>
To: "user@...e.apache.org" <user@...e.apache.org>,
	<dev@...e.apache.org>,
	"security@...e.apache.org" <security@...e.apache.org>,
	<announce@...che.org>,
	<oss-security@...ts.openwall.com>
Subject: [CVE-2017-12625] Apache Hive information disclosure vulnerability for
 column masking

CVE-2017-12625: Apache Hive information disclosure vulnerability for column masking

Severity: Important

Vendor: The Apache Software Foundation

Versions Affected: Hive 2.1.0 to 2.3.0

Description:
Hive exposes an interface through which masking policies can be defined on tables or
views, e.g., using Apache Ranger. When a view is created over a given table, the
policy enforcement does not happen correctly on the table for masked columns.

Mitigation:
2.3.0 users should upgrade to 2.3.1
2.2.0 users should upgrade to 2.3.1, obtain the latest source from git for branch-2.2
or apply this patch which will be included from 2.2.1
https://git1-us-west.apache.org/repos/asf?p=hive.git;a=commit;h=0e795debddf261b0ac6ace90e2d774f9a99b7f4b
2.1.x users should upgrade to 2.3.1, obtain the latest source from git for branch-2.1
or apply this patch which will be included from 2.1.2
https://git1-us-west.apache.org/repos/asf?p=hive.git;a=commit;h=6db9fd6e43f6eef3c9d1ca8e324b2edaa54fb0d3

To mitigate this vulnerability until Hive is upgraded to a new version, there are two
possible options. These steps need to be done manually in Ranger / Hive.
1) Restrict users from creating views on tables with column masking rules defined. For
this in Ranger Hive Policy:
 - Users should not have SELECT permission for those Table columns with masking rules
defined.
 - Give SELECT permission only for those columns without masking rules defined.
2) Review the Hive Column Masking Policies maintained in Ranger for the tables. Then
check in Hive if views that read those tables have been defined.
If present, either change the view definition so those columns are not selected or
directly drop those views.

Credit:
This issue was reported by ï»¿Suja Santhosh of Hortonworks.


If you have any question, please reach out to us in the Hive dev list.

Regards,

The Apache Hive Team


