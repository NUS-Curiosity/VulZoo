
Date: Tue, 28 Jul 2015 16:58:01 +0200
From: Vasyl Kaigorodov <vkaigoro@...hat.com>
To: oss-security@...ts.openwall.com, cve-assign@...re.org
Cc: 775139@...s.debian.org
Subject: CVE request: mktexlsr/texlive: insecure use of /tmp

Hello,

Can I please have a CVE assigned for the following issue:

mktexlsr is creating /tmp files in an insecure way:

    treefile="${TMPDIR-/tmp}/mktexlsrtrees$$.tmp"
    # ...
    while test $# -gt 0; do
       # ...
       (umask 077
       if echo "$1" >>"$treefile"; then :; else
         echo "$progname: $treefile: could not append to arg file, goodbye." >&2
         exit 1
       fi
       # ...
    done

This is insecure because the filename is predictable and, more 
importantly, the program doesn't fail atomically if the file already 
exists.

References:
https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=775139
https://bugzilla.redhat.com/show_bug.cgi?id=1181167

Thanks.
-- 
Vasyl Kaigorodov | Red Hat Product Security
PGP:  0xABB6E828 A7E0 87FF 5AB5 48EB 47D0 2868 217B F9FC ABB6 E828
Free/Busy status: https://url.corp.redhat.com/vk-free-busy-status

Content of type "application/pgp-signature" skipped
