
Date: Sun, 12 Jul 2015 15:12:33 -0500
From: Kyle Kelley <rgbkrk@...il.com>
To: oss-security@...ts.openwall.com
Cc: Muhammad A Khan <khanam@...ibm.com>, security <security@...thon.org>
Subject: CVE request: IPython CSRF validation

Email addresses of requester: security@...thon.org; rgbkrk@...il.com;
khanam@...ibm.com
Software name: IPython notebook
Type of vulnerability: CSRF
Attack outcome: Possible remote execution
Patches:
  2.x:
https://github.com/ipython/ipython/commit/a05fe052a18810e92d9be8c1185952c13fe4e5b0
  3.x:
https://github.com/ipython/ipython/commit/1415a9710407e7c14900531813c15ba6165f0816

Affected versions: 0.12 ≤ version ≤ 3.2.0

Summary: POST requests exposed via the IPython REST API are vulnerable to
cross-site request forgery (CSRF). Web pages on different domains can make
non-AJAX POST requests to known IPython URLs, and IPython will honor them.
The user's browser will automatically send IPython cookies along with the
requests. The response is blocked by the Same-Origin Policy, but the
request isn't.

API paths with issues:

* POST /api/contents/<path>/<file>
* POST /api/contents/<path>/<file>/checkpoints
* POST /api/contents/<path>/<file>/checkpoints/<checkpoint_id>
* POST /api/kernels
* POST /api/kernels/<kernel_id>/<action>
* POST /api/sessions
* POST /api/clusters/<cluster_id>/<action>

Mitigations:

Upgrade to IPython 3.2.1. If using pip,

  pip install --upgrade ipython[notebook]

For conda:

  conda update conda
  conda update ipython ipython-notebook

Vulnerability was found by Ahmad Khan, Security Engineer at IBM.

-- 
Kyle Kelley (@rgbkrk <https://twitter.com/rgbkrk>; lambdaops.com,
developer.rackspace.com)

