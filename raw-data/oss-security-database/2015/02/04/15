
Date: Wed, 04 Feb 2015 15:18:47 -0700
From: Kurt Seifried <kseifried@...hat.com>
To: "oss-security@...ts.openwall.com" <oss-security@...ts.openwall.com>,
        Assign a CVE Identifier <cve-assign@...re.org>, security@...dle.com
Subject: CVE request for Moodlee MDL-48980 Security: Always clean the result
 from min_get_slash_argument

I don't think this has a CVE yet

http://git.moodle.org/gw?p=moodle.git;a=commit;h=af9a7937cc085f96bdbc4724cadec6eeae0242fc

MDL-48980 Security: Always clean the result from min_get_slash_argument

The result from this function is used in send_file calls and if unclean
(windows dir separators, or .. path components) it could expose
sensitive files (e.g. .php files). Now we always clean the result from
this function even if it means double cleaning.

I also fixed the unit test for this function and added a new test for
this cleaning.

I also updated the comments to point to get_file_argument as the full
version of min_get_slash_argument.

-- 
Kurt Seifried -- Red Hat -- Product Security -- Cloud
PGP A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993


Download attachment "signature.asc" of type "application/pgp-signature" (820 bytes)
