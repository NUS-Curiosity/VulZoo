
Date: Tue, 13 Jan 2015 22:44:00 +0300
From: Alexander Cherepanov <cherepan@...me.ru>
To: oss-security@...ts.openwall.com
Subject: CVE request: lhasa: directory traversals

Hi!

Directory traversals were fixed in lhasa a couple of years ago.

They were not found by me. I've just rediscovered one of them and 
wondered why it worked on Debian wheezy but not on Debian jessie.

1.
Sanitize directory paths and do not allow '..'
https://github.com/fragglet/lhasa/commit/64b96b5c1d08293b6c373f616b206d951ee358f7

2.
Add deferred creation for dangerous symlinks.
https://github.com/fragglet/lhasa/commit/3bab39fd492a8924bdd25615ef40ca68c0c7ad0f

which should probably be accompanied by

Fix some corner cases with symlink handling.
https://github.com/fragglet/lhasa/commit/adcd9912803e69ebeb000cc4c341fbc64820ed1f

Only show symlink extraction message once.
https://github.com/fragglet/lhasa/commit/c26557dd1b2e640e9785686355c5a2945483460b

but I haven't looked inside.

Could CVE please be assigned?

-- 
Alexander Cherepanov
