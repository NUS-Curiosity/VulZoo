
Date: Wed, 11 Sep 2019 12:43:19 +0200
From: Hanno Böck <hanno@...eck.de>
To: oss-security@...ts.openwall.com
Subject: OpenDMARC signature bypass with multiple From addresses

Hi,

Protonmail reported about a phishing incident in July:
https://protonmail.com/blog/bellingcat-cyberattack-phishing/

This had this somewhat mysterious chapter:
"Furthermore, the attackers attempted to exploit an unpatched
vulnerability in an open source software that is widely used by email
providers in an effort to bypass spam and abuse filters. We were
previously aware of this vulnerability and have already been watching
it for some time, but we will not disclose it here because the software
in question is not developed by ProtonMail, and it has not yet been
patched by the software maintainers. This vulnerability, however, is
not widely known and indicates a higher level of sophistication on the
part of the attackers."

After asking protonmail multiple times for a statement they answered
and I learned that it's about this issue in OpenDMARC:
https://github.com/trusteddomainproject/OpenDMARC/pull/48

It's an issue where by specifying multiple From addresses only one of
them gets DMARC-checked.

There's no reaction from the OpenDMARC developers and it's unclear
whether it's still actively developed. Given this is already actively
exploited I think people should be aware of it and distros should
probably apply the patch from the PR.

-- 
Hanno Böck
https://hboeck.de/

mail/jabber: hanno@...eck.de
GPG: FE73757FA60E4E21B937579FA5880072BBB51E42
