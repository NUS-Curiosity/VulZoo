
Date: Mon, 8 Nov 2010 17:02:48 -0500 (EST)
From: Petr Matousek <pmatouse@...hat.com>
To: oss-security@...ts.openwall.com
Cc: coley@...us.mitre.org
Subject: CVE request: kernel: gdth: integer overflow in ioc_general()

"gdth_ioctl_alloc() takes the size variable as an int.
copy_from_user() takes the size variable as an unsigned long.
gen.data_len and gen.sense_len are unsigned longs.
On x86_64 longs are 64 bit and ints are 32 bit.

We could pass in a very large number and the allocation would truncate
the size to 32 bits and allocate a small buffer.  Then when we do the
copy_from_user(), it would result in a memory corruption."

Upstream commit:
http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commitdiff;h=f63ae56e4e97fb12053590e41a4fa59e7daa74a4

Credit: James E.J. Bottomley

Reference:
http://ns3.spinics.net/lists/linux-scsi/msg47361.html
https://bugzilla.redhat.com/show_bug.cgi?id=651147

Thanks,
--
Petr Matousek / Red Hat Security Response Team
