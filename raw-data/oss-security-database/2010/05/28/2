
Date: Fri, 28 May 2010 10:04:32 +0200
From: Tomas Hoger <thoger@...hat.com>
To: oss-security@...ts.openwall.com
Cc: coley@...re.org
Subject: Re: Fwd: [Full-disclosure] stratsec Security
 Advisory SS-2010-005: Samba Multiple DoS Vulnerabilities (3.3.x)

Hi Eren!

On Fri, 28 May 2010 08:33:12 +0300 Eren TÃ¼rkay wrote:

> A NULL pointer dereference (#7229, CVE-2010-1635) and a crash with
> CUPS printers (#7298, CVE-2010-1642)

You have a wrong bug / fix for CVE-2010-1642.  What you seem to be
trying to pick up is the following fix mentioned in 3.4.8 release notes:

   o Fix smbd crash with CUPS printers and no [printers] share defined
     (bug #7297).

Note that your bug id is off-by-one ;).  However, that's not the
stratsec issue, you should be looking at this:

   o Fix an uninitialized variable read in smbd (bug #7254).

https://bugzilla.samba.org/show_bug.cgi?id=7254
http://git.samba.org/?p=samba.git;a=commitdiff;h=9280051bfba33745

This issue should rather be described as OOB read as mentioned in Josh's
CVE assignment.  This problem may affect fairly old samba version, I've
seen the same code / issue in some oldish 3.0.x versions.  The crash is
not too reliable though, I've only seen crash on some (recent) versions
using stratsec reproducer (you've noticed already their advisory
incorrectly labels reproducers and has them mixed-up, right?).

> It seems that 3.3.x is also vulnerable as the same code seems to
> exist in this release as well. However, I couldn't see any reference
> for 3.3.x being vulnerable. I would really appreciate a statement
> from Samba team as to the status of 3.3.x

CVE-2010-1642 mentioned above.

NULL deref CVE-2010-1635 should only affect 3.5.x, as it occurs in
this code, which does not exist in 3.4.x:

http://git.samba.org/?p=samba.git;a=commitdiff;h=c116652a3050a854

On 3.3.x, reproducer causes smbd to follow error code path where
smb_panic is called.

-- 
Tomas Hoger / Red Hat Security Response Team
