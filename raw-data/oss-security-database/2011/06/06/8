
Date: Mon, 06 Jun 2011 18:19:45 +0200
From: Jan Lieskovsky <jlieskov@...hat.com>
To: "Steven M. Christey" <coley@...us.mitre.org>
CC: oss-security <oss-security@...ts.openwall.com>,
        Chris Evans <scarybeasts@...il.com>, Greg KH <greg@...ah.com>,
        Kees Cook <kees@...ntu.com>
Subject: CVE Request -- vsftpd -- Do not create network namespace per connection

Hello, Josh, Steve, vendors,

   It was found that vsftpd, Very Secure FTP daemon, when the network
namespace (CONFIG_NET_NS) support was activated in the kernel, used to
create a new network namespace per connection. A remote attacker could
use this flaw to cause a memory pressure and denial of the vsftpd
service.

References:
[1] http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=629373
[2] https://bugs.launchpad.net/ubuntu/+source/linux/+bug/720095
[3] https://bugzilla.redhat.com/show_bug.cgi?id=711134

This one being a bit tricky one -- from my understanding of the issue,
vsftpd doesn't necessarily have a security flaw on its side. It's
kernel issue / bug, which allows this to be used for vsftpd DoS:
[4] https://bugs.launchpad.net/ubuntu/+source/linux/+bug/720095/comments/31
[5] https://bugs.launchpad.net/ubuntu/+source/linux/+bug/720095/comments/32

Short-term solution would be probably to address this on the vsftpd
side, the long-term one then being to get this fixed in kernel.

Though not sure, how it would be wrt to CVE identifier(s) assignment.

Steve, could you advice here?

Thank you & Regards, Jan.
--
Jan iankko Lieskovsky / Red Hat Security Response Team
