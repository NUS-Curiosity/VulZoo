
Date: Wed, 30 Nov 2005 15:19:00 -0700
From: Mandriva Security Team <security@...driva.com>
To: bugtraq@...urityfocus.com
Subject: MDKSA-2005:220 - Updated kernel packages fix numerous vulnerabilities


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

 _______________________________________________________________________
 
 Mandriva Linux Security Advisory                         MDKSA-2005:220
 http://www.mandriva.com/security/
 _______________________________________________________________________
 
 Package : kernel
 Date    : November 30, 2005
 Affected: 10.2
 _______________________________________________________________________
 
 Problem Description:
 
 Multiple vulnerabilities in the Linux 2.6 kernel have been discovered
 and corrected in this update:
 
 The kernel on x86_64 platforms does not use a guard page for the 47-bit
 address page to protect against an AMD K8 bug which allows a local user
 to cause a DoS (CVE-2005-1764).
 
 The KEYCTL_JOIN_SESSION_KEYRING operation in versions prior to 2.6.12.5
 contains an error path that does not properly release the session
 management semaphore, which allows local users or remote attackers to
 cause a DoS (semaphore hang) via a new session keyring with an empty
 name string, a long name string, the key quota reached, or ENOMEM
 (CVE-2005-2098).
 
 Kernels prior to 2.6.12.5 do not properly destroy a keyring that is not
 instantiated properly, allowing a local user or remote attacker to
 cause a DoS (oops) via a keyring with a payload that is not empty
 (CVE-2005-2099).
 
 An array index overflow in the xfrm_sk_policy_insert function in
 xfrm_user.c allows local users to cause a DoS (oops or deadlock) and
 possibly execute arbitrary code (CVE-2005-2456).
 
 The zisofs driver in versions prior to 2.6.12.5 allows local users and
 remove attackers to cause a DoS (crash) via a crafted compressed ISO
 filesystem (CVE-2005-2457).
 
 inflate.c in the zlib routines in versions prior to 2.6.12.5 allow
 remove attackers to cause a DoS (crash) via a compressed file with
 "improper tables" (CVE-2005-2458).
 
 The huft_build function in inflate.c in the zlib routines in versions
 prior to 2.6.12.5 returns the wrong value, allowing remote attackers to
 cause a DoS (crash) via a certain compressed file that leads to a null
 pointer dereference (CVE-2005-2459).
 
 A stack-based buffer overflow in the sendmsg function call in versions
 prior to 2.6.13.1 allow local users to execute arbitrary code by
 calling sendmsg and modifying the message contents in another thread
 (CVE-2005-2490).
 
 The raw_sendmsg function in versions prior to 2.6.13.1 allow local
 users to cause a DoS (change hardware state) or read from arbitrary
 memory via crafted input (CVE-2005-2492).
 
 A memory leak in the seq_file implementation in the SCSI procfs
 interface (sg.c) in 2.6.13 and earlier allows a local user to cause a
 DoS (memory consumption) via certain repeated reads from
 /proc/scsi/gs/devices file which is not properly handled when the
 next() interator returns NULL or an error (CVE-2005-2800).
 
 The ipt_recent module in versions prior to 2.6.12 when running on 64bit
 processors allows remote attackers to cause a DoS (kernel panic) via
 certain attacks such as SSH brute force (CVE-2005-2872).
 
 The ipt_recent module in versions prior to 2.6.12 does not properly
 perform certain tests when the jiffies value is greater than LONG_MAX,
 which can cause ipt_recent netfilter rules to block too early
 (CVE-2005-2873).
 
 Multiple vulnerabilities in versions prior to 2.6.13.2 allow local
 users to cause a DoS (oops from null dereference) via fput in a 32bit
 ioctl on 64-bit x86 systems or sockfd_put in the 32-bit routing_ioctl
 function on 64-bit systems (CVE-2005-3044).
 
 The sys_set_mempolicy function in mempolicy.c allows local users to
 cause a DoS via a negative first argument (CVE-2005-3053).
 
 Versions 2.6.8 to 2.6.14-rc2 allow local users to cause a DoS (oops)
 via a userspace process that issues a USB Request Block (URB) to a USB
 device and terminates before the URB is finished, which leads to a
 stale pointer reference (CVE-2005-3055).
 
 drm.c in version 2.6.13 and earlier creates a debug file in sysfs with
 world-readable and world-writable permissions, allowing local users to
 enable DRM debugging and obtain sensitive information (CVE-2005-3179).
 
 The Orinoco driver in 2.6.13 and earlier does not properly clear memory
 from a previously used packet whose length is increased, allowing
 remote attackers to obtain sensitive information (CVE-2005-3180).
 
 Kernels 2.6.13 and earlier, when CONFIG_AUDITSYSCALL is enabled, use an
 incorrect function to free names_cache memory, preventing the memory
 from being tracked by AUDITSYSCALL code and leading to a memory leak
 (CVE-2005-3181).
 
 The VT implementation in version 2.6.12 allows local users to use
 certain IOCTLs on terminals of other users and gain privileges
 (CVE-2005-3257).
 
 Exec does not properly clear posix-timers in multi-threaded
 environments, which result in a resource leak and could allow a large
 number of multiple local users to cause a DoS by using more posix-
 timers than specified by the quota for a single user (CVE-2005-3271).
 
 The rose_rt_ioctl function rose_route.c in versions prior to 2.6.12
 does not properly verify the ndigis argument for a new route, allowing
 an attacker to trigger array out-of-bounds errors with a large number
 of digipeats (CVE-2005-3273).
 
 A race condition in ip_vs_conn_flush in versions prior to 2.6.13, when
 running on SMP systems, allows local users to cause a DoS (null
 dereference) by causing a connection timer to expire while the
 connection table is being flushed before the appropriate lock is
 acquired (CVE-2005-3274).
 
 The NAT code in versions prior to 2.6.13 incorrectly declares a
 variable to be static, allowing remote attackers to cause a DoS (memory
 corruption) by causing two packets for the same protocol to be NATed at
 the same time (CVE-2005-3275).
 
 The sys_get_thread_area function in process.c in versions prior to
 2.6.12.4 and 2.6.13 does not clear a data structure before copying it
 to userspace, which may allow a user process to obtain sensitive
 information (CVE-2005-3276).
 
 The provided packages are patched to fix these vulnerabilities.  All
 users are encouraged to upgrade to these updated kernels.
 
 To update your kernel, please follow the directions located at:
 
   http://www.mandriva.com/en/security/kernelupdate
 _______________________________________________________________________

 References:
 
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1764
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2098
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2099
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2456
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2457
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2458
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2459
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2490
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2492
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2800
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2872
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2873
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3044
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3053
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3055
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3179
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3180
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3181
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3257
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3273
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3274
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3275
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3276
 _______________________________________________________________________
 
 Updated Packages:
 
 Mandriva Linux 10.2:
 2c46bb090164d04e6c45a0abef9d5756  10.2/RPMS/kernel-2.6.11.13mdk-1-1mdk.i586.rpm
 1f527287a66e776825c6a665a9b62ccf  10.2/RPMS/kernel-i586-up-1GB-2.6.11.13mdk-1-1mdk.i586.rpm
 df151a56daf78664f6ac4dcf99ffbf4a  10.2/RPMS/kernel-i686-up-4GB-2.6.11.13mdk-1-1mdk.i586.rpm
 b531e97efe37e4cc41fba8fea177317b  10.2/RPMS/kernel-smp-2.6.11.13mdk-1-1mdk.i586.rpm
 243fc4fbd27117ecf95a8c9d856a22cb  10.2/RPMS/kernel-source-2.6-2.6.11-13mdk.i586.rpm
 841f4b9e8f333ae07af81fbb295e7b89  10.2/RPMS/kernel-source-stripped-2.6-2.6.11-13mdk.i586.rpm
 dafc4f7aa34f21434ce2d1ec76b8b80f  10.2/RPMS/kernel-xbox-2.6.11.13mdk-1-1mdk.i586.rpm
 7369eb7eaf212a81d56f3d3df895f909  10.2/SRPMS/kernel-2.6.11.13mdk-1-1mdk.src.rpm

 Mandriva Linux 10.2/X86_64:
 d82156477b51547a270c7cda5a8ac5a1  x86_64/10.2/RPMS/kernel-2.6.11.13mdk-1-1mdk.x86_64.rpm
 f7e6d8f44813da237726c757cf4a4958  x86_64/10.2/RPMS/kernel-smp-2.6.11.13mdk-1-1mdk.x86_64.rpm
 b0b6f0422937ce40d421cf607dd5c57b  x86_64/10.2/RPMS/kernel-source-2.6-2.6.11-13mdk.x86_64.rpm
 42f78955e8bc151d36ae5bb3e1493c25  x86_64/10.2/RPMS/kernel-source-stripped-2.6-2.6.11-13mdk.x86_64.rpm
 7369eb7eaf212a81d56f3d3df895f909  x86_64/10.2/SRPMS/kernel-2.6.11.13mdk-1-1mdk.src.rpm
 _______________________________________________________________________

 To upgrade automatically use MandrivaUpdate or urpmi.  The verification
 of md5 checksums and GPG signatures is performed automatically for you.

 All packages are signed by Mandriva for security.  You can obtain the
 GPG public key of the Mandriva Security Team by executing:

  gpg --recv-keys --keyserver pgp.mit.edu 0x22458A98

 You can view other update advisories for Mandriva Linux at:

  http://www.mandriva.com/security/advisories

 If you want to report vulnerabilities, please contact

  security_(at)_mandriva.com
 _______________________________________________________________________

 Type Bits/KeyID     Date       User ID
 pub  1024D/22458A98 2000-07-10 Mandriva Security Team
  <security*mandriva.com>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQFDjfmdmqjQ0CJFipgRAq87AKCc30fj1YTM9/J6R1uwqUZ5bUGx5QCgiUMa
9yaj33KlDIs4ThWlTKKwFJ0=
=Etvq
-----END PGP SIGNATURE-----


