
Date: Wed, 30 Nov 2005 14:56:01 -0700
From: Mandriva Security Team <security@...driva.com>
To: bugtraq@...urityfocus.com
Subject: MDKSA-2005:218 - Updated kernel packages fix numerous vulnerabilities


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

 _______________________________________________________________________
 
 Mandriva Linux Security Advisory                         MDKSA-2005:218
 http://www.mandriva.com/security/
 _______________________________________________________________________
 
 Package : kernel
 Date    : November 30, 2005
 Affected: Corporate 3.0, Multi Network Firewall 2.0
 _______________________________________________________________________
 
 Problem Description:
 
 Multiple vulnerabilities in the Linux 2.6 kernel have been discovered
 and corrected in this update:
 
 An integer overflow in vc_resize (CAN-2004-1333).
 
 A race condition in the sysfs_read_file and sysfs_write_file functions
 in 2.6.10 and earlier allows local users to read kernel memory and
 cause a DoS (crash) via large offsets in sysfs files (CAN-2004-2302).
 
 An integer signedness error in scsi_ioctl.c (CVE-2005-0180).
 
 Netfilter allows a local user to cause a DoS (memory consumption) via
 certain packet fragments that are reassembled twice, which causes a
 data structure to be allocated twice (CVE-2005-0210).
 
 The netfilter/iptables module in versions prior to 2.6.8.1 allow remote
 attackers to cause a DoS (crash) or bypass firewall rules via crafted
 packets, which are not properly handled by skb_checksum_help function
 (CVE-2005-0449).
 
 The zisofs driver in versions prior to 2.6.12.5 allows local users and
 remove attackers to cause a DoS (crash) via a crafted compressed ISO
 filesystem (CVE-2005-2457).
 
 The kernel does not properly restrict socket policy access to users
 with the CAP_NET_ADMIN capability, which could allow local users to
 conduct unauthorized activities via ipv4/ip_sockglue.c and
 ipv6/ipv6_sockglue.c (CVE-2005-2555).
 
 A memory leak in the seq_file implementation in the SCSI procfs
 interface (sg.c) in 2.6.13 and earlier allows a local user to cause a
 DoS (memory consumption) via certain repeated reads from
 /proc/scsi/gs/devices file which is not properly handled when the
 next() interator returns NULL or an error (CVE-2005-2800).
 
 Multiple vulnerabilities in versions prior to 2.6.13.2 allow local
 users to cause a DoS (oops from null dereference) via fput in a 32bit
 ioctl on 64-bit x86 systems or sockfd_put in the 32-bit routing_ioctl
 function on 64-bit systems (CVE-2005-3044).
 
 Versions 2.6.8 to 2.6.14-rc2 allow local users to cause a DoS (oops)
 via a userspace process that issues a USB Request Block (URB) to a USB
 device and terminates before the URB is finished, which leads to a
 stale pointer reference (CVE-2005-3055).
 
 The Orinoco driver in 2.6.13 and earlier does not properly clear memory
 from a previously used packet whose length is increased, allowing
 remote attackers to obtain sensitive information (CVE-2005-3180).
 
 Kernels 2.6.13 and earlier, when CONFIG_AUDITSYSCALL is enabled, use an
 incorrect function to free names_cache memory, preventing the memory
 from being tracked by AUDITSYSCALL code and leading to a memory leak
 (CVE-2005-3181).
 
 The VT implementation in version 2.6.12 allows local users to use
 certain IOCTLs on terminals of other users and gain privileges
 (CVE-2005-3257).
 
 Exec does not properly clear posix-timers in multi-threaded
 environments, which result in a resource leak and could allow a large
 number of multiple local users to cause a DoS by using more posix-
 timers than specified by the quota for a single user (CVE-2005-3271).
 
 The rose_rt_ioctl function rose_route.c in versions prior to 2.6.12
 does not properly verify the ndigis argument for a new route, allowing
 an attacker to trigger array out-of-bounds errors with a large number
 of digipeats (CVE-2005-3273).
 
 A race condition in ip_vs_conn_flush in versions prior to 2.6.13, when
 running on SMP systems, allows local users to cause a DoS (null
 dereference) by causing a connection timer to expire while the
 connection table is being flushed before the appropriate lock is
 acquired (CVE-2005-3274).
 
 The NAT code in versions prior to 2.6.13 incorrectly declares a
 variable to be static, allowing remote attackers to cause a DoS (memory
 corruption) by causing two packets for the same protocol to be NATed at
 the same time (CVE-2005-3275).
 
 The sys_get_thread_area function in process.c in versions prior to
 2.6.12.4 and 2.6.13 does not clear a data structure before copying it
 to userspace, which may allow a user process to obtain sensitive
 information (CVE-2005-3276).
 
 The following non-security fixes are also applied:
 
 Support for the arp_ignore and arp_announce sysctls were added to the
 Corporate 3 kernels (bugzilla #16346).
 
 The provided packages are patched to fix these vulnerabilities.  All
 users are encouraged to upgrade to these updated kernels.
 
 To update your kernel, please follow the directions located at:
 
   http://www.mandriva.com/en/security/kernelupdate
 _______________________________________________________________________

 References:
 
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-1333
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-2302
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-0180
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-0210
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-0449
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2457
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2555
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2800
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3044
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3055
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3180
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3181
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3257
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3271
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3273
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3274
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3275
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3276
 http://qa.mandriva.com/show_bug.cgi?id=16346
 _______________________________________________________________________
 
 Updated Packages:
 
 Corporate 3.0:
 7e38bcdc8a3900485d17d08e13963700  corporate/3.0/RPMS/kernel-2.6.3.29mdk-1-1mdk.i586.rpm
 be4dc943991be67f9f612ac5ca2f6c10  corporate/3.0/RPMS/kernel-enterprise-2.6.3.29mdk-1-1mdk.i586.rpm
 9acc6e90b1a8620be6af552baa8524ab  corporate/3.0/RPMS/kernel-i686-up-4GB-2.6.3.29mdk-1-1mdk.i586.rpm
 1a171d91312764089f2f0c84a6e9131a  corporate/3.0/RPMS/kernel-p3-smp-64GB-2.6.3.29mdk-1-1mdk.i586.rpm
 e6f42b56669ca4ac5515d728051c4f88  corporate/3.0/RPMS/kernel-secure-2.6.3.29mdk-1-1mdk.i586.rpm
 5f3e473fae7614433328756156f2b953  corporate/3.0/RPMS/kernel-smp-2.6.3.29mdk-1-1mdk.i586.rpm
 c98b0f07cb49a918201d2daa1ac23e7c  corporate/3.0/RPMS/kernel-source-2.6.3-29mdk.i586.rpm
 e816bcde98728e85a86c565259364f8a  corporate/3.0/RPMS/kernel-source-stripped-2.6.3-29mdk.i586.rpm
 b2497e007272f38b30e98b4231a77a76  corporate/3.0/SRPMS/kernel-2.6.3.29mdk-1-1mdk.src.rpm

 Corporate 3.0/X86_64:
 5261e06d1085ff9c61bf29789f10669f  x86_64/corporate/3.0/RPMS/kernel-2.6.3.29mdk-1-1mdk.x86_64.rpm
 3cb631841cf4e9d29e1f667d940d9ab4  x86_64/corporate/3.0/RPMS/kernel-secure-2.6.3.29mdk-1-1mdk.x86_64.rpm
 61024ad1c23dbde624c3cd43c8805f26  x86_64/corporate/3.0/RPMS/kernel-smp-2.6.3.29mdk-1-1mdk.x86_64.rpm
 ba1514dcafcc748796bd9b23cd1905e4  x86_64/corporate/3.0/RPMS/kernel-source-2.6.3-29mdk.x86_64.rpm
 48a9eb1de36653665e6d7de333d25cb0  x86_64/corporate/3.0/RPMS/kernel-source-stripped-2.6.3-29mdk.x86_64.rpm
 b2497e007272f38b30e98b4231a77a76  x86_64/corporate/3.0/SRPMS/kernel-2.6.3.29mdk-1-1mdk.src.rpm

 Multi Network Firewall 2.0:
 7e38bcdc8a3900485d17d08e13963700  mnf/2.0/RPMS/kernel-2.6.3.29mdk-1-1mdk.i586.rpm
 9acc6e90b1a8620be6af552baa8524ab  mnf/2.0/RPMS/kernel-i686-up-4GB-2.6.3.29mdk-1-1mdk.i586.rpm
 1a171d91312764089f2f0c84a6e9131a  mnf/2.0/RPMS/kernel-p3-smp-64GB-2.6.3.29mdk-1-1mdk.i586.rpm
 e6f42b56669ca4ac5515d728051c4f88  mnf/2.0/RPMS/kernel-secure-2.6.3.29mdk-1-1mdk.i586.rpm
 5f3e473fae7614433328756156f2b953  mnf/2.0/RPMS/kernel-smp-2.6.3.29mdk-1-1mdk.i586.rpm
 b2497e007272f38b30e98b4231a77a76  mnf/2.0/SRPMS/kernel-2.6.3.29mdk-1-1mdk.src.rpm
 _______________________________________________________________________

 To upgrade automatically use MandrivaUpdate or urpmi.  The verification
 of md5 checksums and GPG signatures is performed automatically for you.

 All packages are signed by Mandriva for security.  You can obtain the
 GPG public key of the Mandriva Security Team by executing:

  gpg --recv-keys --keyserver pgp.mit.edu 0x22458A98

 You can view other update advisories for Mandriva Linux at:

  http://www.mandriva.com/security/advisories

 If you want to report vulnerabilities, please contact

  security_(at)_mandriva.com
 _______________________________________________________________________

 Type Bits/KeyID     Date       User ID
 pub  1024D/22458A98 2000-07-10 Mandriva Security Team
  <security*mandriva.com>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQFDjfSCmqjQ0CJFipgRAivNAKCf9uIkAEZu5hRDk/tDe6Y89813zQCdEqFD
Ar/Lnzyy9a037hb4fBSiHsc=
=Ohmy
-----END PGP SIGNATURE-----


