
Date: Thu, 10 Feb 2005 11:12:32 -0700
From: Shiva Persaud <shivapd@...ibm.com>
To: bugtraq@...urityfocus.com, vulnwatch@...nwatch.org
Subject: Re: iDEFENSE Security Advisory 02.10.05: IBM AIX lspath Local File Access
 Vulnerability

IBM's advisory for this issue:

<BEGIN>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

IBM SECURITY ADVISORY

First Issued: Wed Feb  9 15:16:37 CST 2005

=========================================================================
                           VULNERABILITY SUMMARY

VULNERABILITY:      A vulnerability in the lspath command allows any
                    local user to read from any file.

PLATFORMS:          AIX 5.2 and 5.3.

SOLUTION:           Apply the workaround, efix or APAR as described below.

THREAT:             A local user can read the first work of any file.

CERT VU Number:     N/A
CVE Number:         N/A
=========================================================================
                           DETAILED INFORMATION


I.  Description
===============

A vulnerability was discovered in the lspath command. This command
displays information about paths to an MultiPath I/O (MPIO) capable
device. Any local user may exploit this vulnerability to read any file up
to the first whitespace (tab, space or newline character) in that file.
Please note that this issue cannot be exploited to read an arbitrary file
in entirety nor can it be exploited to write to a file.

The command affected by this issue ships as part of the bos.rte.methods
fileset. To determine if this fileset is installed, execute the following
command:

# lslpp -L bos.rte.methods

If the fileset is installed it will be listed along with its version
information, state, type and a description.


II. Impact
==========
A local user may read an arbitrary file up to the first whitespace. This
vulnerability may be exploited to access information that a user would not
otherwise be able to read.


III.  Solutions
===============

A. Official Fix

IBM provides the following fixes:

      APAR number for AIX 5.2.0: IY67457  (available approx. 04/15/05)
      APAR number for AIX 5.3.0: IY67655  (available approx. 04/15/05)

NOTE: Affected customers are urged to upgrade to 5.1.0, 5.2.0 or 5.3.0 at
the latest maintenance level.

B. Emergency Fix

Efixes are available for AIX 5.1.0, 5.2.0 and 5.3.0. The efixes can be
downloaded via ftp from:

     ftp://aix.software.ibm.com/aix/efixes/security/lspath_efix.tar.Z

lspath_efix.tar.Z is a compressed tarball containing this advisory, three
efix packages cleartext PGP signatures for each efix package.


Verify you have retrieved the efixes intact:
- ---------------------------------------------
The checksums below were generated using the "sum" and "md5sum" commands
and are as follows:

Filename                 sum         md5
=====================================================================
IY67457.050209.epkg.Z    09497    36 a4dde2b6e62efce8fae2a1fcd861ca07
IY67655.050209.epkg.Z    21676    37 76b49f71ac3a55a40412fd117f98df92

These sums should match exactly. The PGP signatures in the compressed
tarball and on this advisory can also be used to verify the integrity of
the various files they correspond to. If the sums or signatures cannot be
confirmed, double check the command results and the download site address.
If those are OK, contact IBM AIX Security at security-alert@...tin.ibm.com
and describe the discrepancy.

IMPORTANT: If possible, it is recommended that a mksysb backup of the
system is created. Verify it is both bootable, and readable before
proceeding.

These efixes have not been fully regression tested; thus, IBM does not
warrant the fully correct functioning of the efix.  Customers install the
efix and operate the modified version of AIX at their own risk.

Efix Installation Instructions:
- -------------------------------
These packages use the new Emergency Fix Management Solution to install
and manage efixes. More information can be found at:

     http://techsupport.services.ibm.com/server/aix.efixmgmt

To preview an epkg efix installation execute the following command:

# emgr -e epkg_name -p       # where epkg_name is the name of the
                             # efix package being previewed.

To install an epkg efix package, execute the following command:

# emgr -e epkg_name -X       # where epkg_name is the name of the
                             # efix package being installed.

The "X" flag will expand any filesystems if required.

C. Workaround

Setting the file mode bits to 500 will allow only the root user to execute
the lspath command. This can be done by executing the following command as
root:

# chmod 500 /usr/sbin/lspath

Verify that the file mode bits have been changed to 500:
# ls -la /usr/sbin/lspath
- -r-x------  1 root system 63894 2003-06-23 13:59 /usr/sbin/lspath


IV. Obtaining Fixes
===================

AIX Version 5 APARs can be downloaded from:

     http://www-1.ibm.com/servers/eserver/support/pseries/aixfixes.html

Security related Emergency Fixes can be downloaded from:

     ftp://aix.software.ibm.com/aix/efixes/security


V.  Acknowledgments
====================
This vulnerability was reported by iDEFENSE.


VI.  Contact Information
========================

If you would like to receive AIX Security Advisories via email, please
visit:

     https://techsupport.services.ibm.com/server/pseries.subscriptionSvcs

Comments regarding the content of this announcement can be directed to:

     security-alert@...tin.ibm.com

To request the PGP public key that can be used to communicate securely
with the AIX Security Team send email to security-alert@...tin.ibm.com
with a subject of "get key". The key can also be downloaded from a PGP
Public Key Server. The key id is 0x9391C1F2.

Please contact your local IBM AIX support center for any assistance.

eServer is a trademark of International Business Machines Corporation.
IBM, AIX and pSeries are registered trademarks of International Business
Machines Corporation. All other trademarks are property of their 
respective
holders.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.0 (MingW32)

iD8DBQFCCpiKxwSSvpORwfIRArdhAJoCfMoHOGyb4myThNLX7HWXKYjh/wCfaMcr
7ILVJOl7vnup4S2ODj3OrG8=
=v5MC
-----END PGP SIGNATURE-----
</BEGIN>

Download attachment "smime.p7s" of type "application/x-pkcs7-signature" (5213 bytes)
