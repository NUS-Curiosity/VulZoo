
Date: Thu, 10 Feb 2005 10:59:01 -0500
From: "iDefense Customer Service" <customerservice@...fense.com>
To: <bugtraq@...urityfocus.com>, <vulnwatch@...nwatch.org>
Subject: iDEFENSE Security Advisory 02.10.05: IBM AIX lspath Local File Access Vulnerability


IBM AIX lspath Local File Access Vulnerability

iDEFENSE Security Advisory 02.10.05
www.idefense.com/application/poi/display?id=195&type=vulnerabilities
February 10, 2005

I. BACKGROUND

The lspath program is a setuid root application, installed by default 
under newer versions of IBM AIX. It is used to display information about

MultiPath I/O devices. 

II. DESCRIPTION

Local exploitation of a file access vulnerability in the lspath command 
included by default in multiple versions of IBM Corp.'s AIX operating 
system could allow for the reading of one line of any file on the 
system, regardless of permissions. 

The problem specifically exists in the -f option. If a user specifies a 
file with the -f option, the first line (up to the first space) in that 
file will be displayed on the screen along with an error message.

III. ANALYSIS

The format of sensitive AIX authentication files (namely 
/etc/security/passwd) limit the impact of this vulnerability due to the 
fact that there is no protected data on the first line of the file. 
However, exploitation does not require any knowledge of application 
internals, making exploitation of this vulnerability trivial, even for 
unskilled attackers.

IV. DETECTION

iDEFENSE has confirmed the existence of this vulnerability in lower 
patch levels of IBM AIX version 5.2. It is suspected that previous 
versions are also vulnerable.

V. WORKAROUND

Only allow trusted users local access to security critical systems. 
Alternately, remove the setuid bit from lspath using chmod u-s 
/usr/sbin/lspath

VI. VENDOR RESPONSE

Vendor advisories for this issue are available at:

For AIX 5.2:

https://techsupport.services.ibm.com/server/pseries.subscriptionSvcs?mod
e=1&heading=AIX52&topic=SECURITY&month=ALL

For AIX 5.3:

https://techsupport.services.ibm.com/server/pseries.subscriptionSvcs?mod
e=1&heading=AIX53&topic=SECURITY&month=ALL

VII. CVE INFORMATION

A Mitre Corp. Common Vulnerabilities and Exposures (CVE) number has not
been assigned yet.

VIII. DISCLOSURE TIMELINE

12/21/2004  Initial vendor notification
01/07/2004  Initial vendor response
02/10/2004  Coordinated public disclosure

IX. CREDIT

iDEFENSE Labs is credited with this discovery.

Get paid for vulnerability research
http://www.idefense.com/poi/teams/vcp.jsp

X. LEGAL NOTICES

Copyright (c) 2005 iDEFENSE, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDEFENSE. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically, please
email customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.

There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.



