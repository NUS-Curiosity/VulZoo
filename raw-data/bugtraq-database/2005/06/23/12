
Date: Thu, 23 Jun 2005 20:09:15 +0200
From: OpenPKG <openpkg@...npkg.org>
To: bugtraq@...urityfocus.com
Subject: [OpenPKG-SA-2005.012] OpenPKG Security Advisory (sudo)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

________________________________________________________________________

OpenPKG Security Advisory                            The OpenPKG Project
http://www.openpkg.org/security.html              http://www.openpkg.org
openpkg-security@...npkg.org                         openpkg@...npkg.org
OpenPKG-SA-2005.012                                          23-Jun-2005
________________________________________________________________________

Package:             sudo
Vulnerability:       race condition, arbitrary command execution
OpenPKG Specific:    no

Affected Releases:   Affected Packages:       Corrected Packages:
OpenPKG CURRENT      <= sudo-1.6.8p8-20050422 >= sudo-1.6.8p9-20060620
OpenPKG 2.4          <= sudo-1.6.8p8-2.4.0    >= sudo-1.6.8p8-2.4.1
OpenPKG 2.3          <= sudo-1.6.8p7-2.3.0    >= sudo-1.6.8p7-2.3.1

Dependent Packages:  none

Description:
  According to a vendor security advisory [0] based on hints from
  Charles Morris, a race condition exists in the command pathname
  handling of Sudo [1] prior to version 1.6.8p9. This could allow a
  user with Sudo privileges to run arbitrary commands. Exploitation of
  the bug requires that the user be allowed to run one or more commands
  via Sudo and be able to create symbolic links in the filesystem.
  Furthermore, an entry in the "sudoers" file giving another user access
  to the "ALL" pseudo-command must follow the user's entry for the race
  to exist. The Common Vulnerabilities and Exposures (CVE) project
  assigned the id CAN-2005-1993 [2] to the problem.

  Please check whether you are affected by running "<prefix>/bin/openpkg
  rpm -q sudo". If you have the "sudo" package installed and its version
  is affected (see above), we recommend that you immediately upgrade it
  (see Solution) [3][4].

Solution:
  Select the updated source RPM appropriate for your OpenPKG release
  [5][6], fetch it from the OpenPKG FTP service [7][8] or a mirror
  location, verify its integrity [9], build a corresponding binary RPM
  from it [3] and update your OpenPKG installation by applying the
  binary RPM [4]. For the most recent release OpenPKG 2.4, perform the
  following operations to permanently fix the security problem (for
  other releases adjust accordingly).

  $ ftp ftp.openpkg.org
  ftp> bin
  ftp> cd release/2.4/UPD
  ftp> get sudo-1.6.8p8-2.4.1.src.rpm
  ftp> bye
  $ <prefix>/bin/openpkg rpm -v --checksig sudo-1.6.8p8-2.4.1.src.rpm
  $ <prefix>/bin/openpkg rpm --rebuild sudo-1.6.8p8-2.4.1.src.rpm
  $ su -
  # <prefix>/bin/openpkg rpm -Fvh <prefix>/RPM/PKG/sudo-1.6.8p8-2.4.1.*.rpm
________________________________________________________________________

References:
  [0] http://www.sudo.ws/sudo/alerts/path_race.html
  [1] http://www.sudo.ws/
  [2] http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2005-1993
  [3] http://www.openpkg.org/tutorial.html#regular-source
  [4] http://www.openpkg.org/tutorial.html#regular-binary
  [5] ftp://ftp.openpkg.org/release/2.4/UPD/sudo-1.6.8p8-2.4.1.src.rpm
  [6] ftp://ftp.openpkg.org/release/2.3/UPD/sudo-1.6.8p7-2.3.1.src.rpm
  [7] ftp://ftp.openpkg.org/release/2.4/UPD/
  [8] ftp://ftp.openpkg.org/release/2.3/UPD/
  [9] http://www.openpkg.org/security.html#signature
________________________________________________________________________

For security reasons, this advisory was digitally signed with the
OpenPGP public key "OpenPKG <openpkg@...npkg.org>" (ID 63C4CB9F) of the
OpenPKG project which you can retrieve from http://pgp.openpkg.org and
hkp://pgp.openpkg.org. Follow the instructions on http://pgp.openpkg.org/
for details on how to verify the integrity of this advisory.
________________________________________________________________________

-----BEGIN PGP SIGNATURE-----
Comment: OpenPKG <openpkg@...npkg.org>

iD8DBQFCuvpUgHWT4GPEy58RAuqJAKDKJZ29ph5iOYOTwJHhBn7JNCCmZgCcD/dG
AuUubrgwjVpyuZ+jkbvuPl0=
=d12Z
-----END PGP SIGNATURE-----


