
Date: Thu, 23 Jun 2005 17:44:05 -0400
From: "iDEFENSE Labs" <labs-no-reply@...fense.com>
To: <bugtraq@...urityfocus.com>, <vulnwatch@...nwatch.org>,
	<full-disclosure@...ts.grok.org.uk>
Subject: iDEFENSE Security Advisory 06.23.05: Veritas
	Backup Exec Agent Error Status Remote DoS Vulnerability


Veritas Backup Exec Agent Error Status Remote DoS Vulnerability 

iDEFENSE Security Advisory 06.23.05
www.idefense.com/application/poi/display?id=271&type=vulnerabilities
June 23, 2005

I. BACKGROUND

VERITAS Backup Exec is an advanced backup and restore solution for 
Microsoft Windows server environments. More information is available 
from the vendor's website:

http://veritas.com/Products/www?c=product&refId=57

II. DESCRIPTION

Exploitation of a buffer overflow vulnerability in Veritas Software 
Corp.'s Backup Exec allows remote attackers to execute arbitrary code.

The Veritas Backup Exec Agent listens on TCP port 10000 and is 
responsible for accepting connections from the backup server when a 
backup is to occur. Typically the agent would be installed on most 
servers and important workstations in an enterprise environment. 
Veritas Backup Exec uses the standard NMDP protocol to communicate with 
the listening agents.

The vulnerability specifically exists because of improper handling of 
request packets with an unexpected "Error Status" value. Specifically, 
any Error Status other than "0" will cause a null pointer dereference,
resulting in an unhandled exception as can be seen as follows.

eax=00000000 ebx=0032ac08 ecx=00000000 
edx=0098a930 esi=0032e1e8 edi=009b5770
eip=008f1c84 esp=00fbfb58 ebp=0032ac30 iopl=0
nv up ei pl nz na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000  efl=00010202

*** ERROR: Symbol file could not be found.
Defaulted to export symbols for 
C:\Program Files\VERITAS\Backup Exec\NT\ndmpsrvr.dll -
ndmpsrvr+0x21c84:

008f1c84 8b00     mov     eax,[eax]      ds:0023:00000000=????????

The unhandled exception will result in a crash of the program and a 
denial of service condition.

III. ANALYSIS

Exploitation does not require authentication, thereby allowing any 
remote attacker to cause the denial of service and disruption of backup 
capabilities.

IV. DETECTION

iDEFENSE has confirmed the existence of this vulnerability in Backup 
Exec for Windows Servers versions 9.0, 9.1 and 10.0. It is suspected 
that other versions are also vulnerable.

Several vendors ship or use Veritas software including Hitachi and NEC 
Corporation.

V. WORKAROUND

Use a firewall to restrict incoming connections to trusted workstations 
running the Backup Exec client software which uses port 10000 TCP.

VI. VENDOR RESPONSE

The vendor has addressed this vulnerability in security advisories
VX05-001 and VX05-008:

   http://seer.support.veritas.com/docs/276533.htm
   http://seer.support.veritas.com/docs/277485.htm

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CAN-2005-0772 to this issue. This is a candidate for inclusion
in the CVE list (http://cve.mitre.org), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

03/16/2005  Initial vendor notification
03/30/2005  Initial vendor response
06/22/2005  Coordinated public disclosure

IX. CREDIT

The discoverer of this vulnerability wishes to remain anonymous.

Get paid for vulnerability research
http://www.idefense.com/poi/teams/vcp.jsp

Free tools, research and upcoming events
http://labs.idefense.com

X. LEGAL NOTICES

Copyright (c) 2005 iDEFENSE, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDEFENSE. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically, please
email customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/


