
Date: Thu, 21 Apr 2005 21:53:08 +0200
From: Michael Roitzsch <mroi@...rs.sourceforge.net>
To: bugtraq@...urityfocus.com
Subject: xine security announcement: multiple heap overflows in MMS and Real RTSP streaming clients


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

xine security announcement
==========================

Announcement-ID: XSA-2004-8

Summary:
By a user receiving data from a malicious network streaming server, an
attacker can overrun a heap buffer, which can, on some systems, lead to
or help in executing attacker-chosen malicious code with the permissions
of the user running a xine-lib based media application.

Description:
Both the MMS and Real RTSP streaming client code made some too strong
assumptions on the transfered data. Several critical bounds checks were
missing, resulting in the possibility of heap overflows, should the remote
server not adhere to these assumptions. In the MMS case, a remote server
could present content with too many individual streams, in the RTSP case,
a remote server's reply could have too many lines.
An attacker can setup a server delivering malicious data to the users. This
can be used to overflow a heap buffer, which can, with certain implementations
of heap management, lead to attacker chosen data written to the stack. This
can cause attacker-chosen code being executed with the permissions of the
user running the application. By tricking users to retrieve a stream, which
can be as easy as providing a link on a website, this vulnerability can be
exploited remotely.

Severity:
This is difficult to exploit remotely, because the indirection involved
requires precision and knowledge of the target machine: The heap overlow
needs to alter heap management information in a way so that a return adress
on the stack is modified. This adress must lead to some malicious code to be
executed, which needs to be injected somehow.
The involved xine plugin is part of the standard xine installation, so we
consider this problem to be moderately severe.

Affected versions:
All 0.9 releases starting with and including 0.9.9
All 1-alpha releases.
All 1-beta releases.
All 1-rc releases.
The 1.0 release.

Unaffected versions:
All releases older than 0.9.9.
1.0.1 or newer.

Solution:
The enclosed patches which have been applied to xine-lib CVS fix the problem
but should only be used by distributors who do not want to upgrade.
Otherwise, we strongly advise everyone to upgrade to the soon to arrive 1.0.1
release of xine-lib.
As a temporary workaround, you may delete the files "xineplug_inp_mms.so" and
"xineplug_inp_rtsp.so" from the xine-lib plugin directory, losing the ability
to use MMS or Real RTSP streaming content.

Patches:
http://cvs.sourceforge.net/viewcvs.py/xine/xine-lib/src/input/librtsp/rtsp.c?r1=1.18&r2=1.19&diff_format=u
http://cvs.sourceforge.net/viewcvs.py/xine/xine-lib/src/input/mms.c?r1=1.55&r2=1.56&diff_format=u

For further information and in case of questions, please contact the xine
team. Our website is http://xinehq.de/
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.2 (GNU/Linux)

iD8DBQFCaASrJpWKj3pWCrYRAg2dAJ99k0lSz9AQcrrkqZWcKl4K3nxjIwCgiM/q
MN1OFdnIZiGqR4E8ml89830=
=oqqr
-----END PGP SIGNATURE-----


