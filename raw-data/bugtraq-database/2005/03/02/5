
Date: Wed, 2 Mar 2005 10:53:13 -0500
From: "iDEFENSE Labs" <labs-no-reply@...fense.com>
To: <bugtraq@...urityfocus.com>, <vulnwatch@...nwatch.org>
Subject: iDEFENSE Security Advisory 03.02.05: Computer Associates License Client/Server GCR Checksum Buffer Overflow


Computer Associates License Client/Server GCR Checksum Buffer Overflow 

iDEFENSE Security Advisory 03.02.05
www.idefense.com/application/poi/display?id=215&type=vulnerabilities
March 2, 2005

I. BACKGROUND

The Computer Associates License Client/Server applications provide a 
method for CA products to register their licenses on the network. The 
License Client and Server are distributed with almost all CA software 
distributions. More information about Computer Associates software 
products is available from:

   http://www3.ca.com/Products/

II. DESCRIPTION

Remote exploitation of a buffer overflow vulnerability in Computer 
Associates License Server and License Client can allow attackers to 
execute arbitrary code.

The vulnerability specifically exists due to insufficient bounds 
checking on user-supplied values in GCR requests. The GCR request 
packet format is shown below:

A0 GCR HOSTNAME<DEVBOX>HARDWARE<001122334455>LOCALE<English>
IDENT1<unknown>IDENT2<unknown>IDENT3<unknown>IDENT4<unknown>
OS<Windows_NT 5.0>OLFFILE<0 0 0>SERVER<RMT>VERSION<3 1.54.0>
NETWORK<127.0.0.1 HOSTNAME 255.255.255.0>MACHINE<PC_1586_1_3201>
CHECKSUMS<1 2 3 4 5 6 7 8 9 10 11 12>RMTV<1.00><EOM>

If the second, fifth, eighth, or eleventh field of the Checksums item 
contains a large string, a stack overflow will occur. The format 
specifier for the call to sscanf() is simply:

"%x %s %i %x %s %i %x %s %i %x %s %i"

If the eleventh field is used to overflow the local stack buffer, the 
return address will be overwritten with the address at 64 bytes into 
the overflow string.

Ollydbg output after SEH overwrite in CA License Client:

EAX 00630510
ECX 7C91056D ntdll.7C91056D
EDX 003B0000
EBX 00D4E053 ASCII "GCR"
ESP 0082FC10 ASCII "XXXXXXXXXXXXXXXXXXXXXXXXXXXXX
EBP 00D4E050 ASCII "A0"
ESI 0082FCBC ASCII "XXXXXXXXXXXXXXXXXXXXXXXXXXXXX
EDI 00D4E057 ASCII "HOSTNAME<DEVBOX>HARDWARE<0011
EIP DEADC0DE

Log data, item 0
Address=DEADC0DE
Message=Access violation when executing [DEADC0DE]

III. ANALYSIS

Exploitation allows remote attackers to execute arbitrary code under 
the privileges of Local System. A GETCONFIG packet exchange which 
discloses the remote operating system version usually proceeds the GCR 
request and increases the likelihood of successful exploitation. The CA 
License Server does not run by default, but is packaged with most 
Computer Associates software distributions. The CA License Client does 
run by default and is packaged with almost all Computer Associates 
software.

IV. DETECTION

iDEFENSE has confirmed that CA License Server 0.1.0.15 and CA License 
Client 0.1.0.15 are vulnerable. 

V. WORKAROUND

Use a firewall to only allow trusted hosts to connect to the Computer 
Associates License Server and Client ports. 

VI. VENDOR RESPONSE

A vendor advisory for this issue is available at:

http://supportconnectw.ca.com/public/ca_common_docs/security_notice.asp

Patches for this issue are available at:

http://supportconnectw.ca.com/public/reglic/downloads/licensepatch.asp#a
lp

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CAN-2005-0581 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org), which standardizes names for
security problems. This is one of several overflows that have been
assigned CAN-2005-0581.

VIII. DISCLOSURE TIMELINE

12/01/2004  Initial vendor notification
12/01/2004  Initial vendor response
03/02/2005  Coordinated public disclosure

IX. CREDIT

An anonymous contributor is credited with discovering this 
vulnerability.

Get paid for vulnerability research 
http://www.idefense.com/poi/teams/vcp.jsp

Free tools, research and upcoming events
http://labs.idefense.com

X. LEGAL NOTICES

Copyright (c) 2005 iDEFENSE, Inc.

Permission is granted for the redistribution of this alert 
electronically. It may not be edited in any way without the express 
written consent of iDEFENSE. If you wish to reprint the whole or any 
part of this alert in any other medium other than electronically, 
please email customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate 
at the time of publishing based on currently available information. Use 
of the information constitutes acceptance for use in an AS IS 
condition. There are no warranties with regard to this information. 
Neither the author nor the publisher accepts any liability for any 
direct, indirect, or consequential loss or damage arising from use of, 
or reliance on, this information.



