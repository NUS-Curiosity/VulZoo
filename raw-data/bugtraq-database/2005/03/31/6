
Date: Thu, 31 Mar 2005 15:40:06 +0200 (CEST)
From: joey@...odrom.org (Martin Schulze)
To: bugtraq@...urityfocus.com
Subject: [SECURITY] [DSA 701-1] New samba packages fix arbitrary code execution


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- --------------------------------------------------------------------------
Debian Security Advisory DSA 701-1                     security@...ian.org
http://www.debian.org/security/                             Martin Schulze
March 31st, 2005                        http://www.debian.org/security/faq
- --------------------------------------------------------------------------

Package        : samba
Vulnerability  : integer overflows
Problem-Type   : remote
Debian-specific: no
CVE ID         : CAN-2004-1154
CERT advisory  : VU#226184

Greg MacManus discovered an integer overflow in the smb daemon from
Samba, a LanManager like file and printer server for GNU/Linux and
Unix-like systems.  Requesting a very large number of access control
descriptors from the server could exploit the integer overflow, which
may result in a buffer overflow which could lead to the execution of
arbitrary code with root privileges.  Upstream developers have
discovered more possible integer overflows that are fixed with this
update as well.

For the stable distribution (woody) these problems have been fixed in
version 2.2.3a-14.2.

For the unstable distribution (sid) these problems have been fixed in
version 3.0.10-1.

We recommend that you upgrade your samba packages.


Upgrade Instructions
- --------------------

wget url
        will fetch the file for you
dpkg -i file.deb
        will install the referenced file.

If you are using the apt-get package manager, use the line for
sources.list as given below:

apt-get update
        will update the internal database
apt-get upgrade
        will install corrected packages

You may use an automated update by adding the resources from the
footer to the proper configuration.


Debian GNU/Linux 3.0 alias woody
- --------------------------------

  Source archives:

    http://security.debian.org/pool/updates/main/s/samba/samba_2.2.3a-14.2.dsc
      Size/MD5 checksum:      775 ed6d755e8e623a887796b1f483c09769
    http://security.debian.org/pool/updates/main/s/samba/samba_2.2.3a-14.2.diff.gz
      Size/MD5 checksum:   130208 cc39bb74c7553dda203d51f6d8c14aa3
    http://security.debian.org/pool/updates/main/s/samba/samba_2.2.3a.orig.tar.gz
      Size/MD5 checksum:  5460531 b6ec2f076af69331535a82b586f55254

  Architecture independent components:

    http://security.debian.org/pool/updates/main/s/samba/samba-doc_2.2.3a-14.2_all.deb
      Size/MD5 checksum:  2447006 abf6acd83baeb484d105c8eb1101543b

  Alpha architecture:

    http://security.debian.org/pool/updates/main/s/samba/libpam-smbpass_2.2.3a-14.2_alpha.deb
      Size/MD5 checksum:   416676 a860eb37f223fd04606640f40b9a6f0d
    http://security.debian.org/pool/updates/main/s/samba/libsmbclient_2.2.3a-14.2_alpha.deb
      Size/MD5 checksum:   490074 e6946b652f61379f406bc9685f765a11
    http://security.debian.org/pool/updates/main/s/samba/libsmbclient-dev_2.2.3a-14.2_alpha.deb
      Size/MD5 checksum:   601880 bae5a3ac952faa460d8ca4952a8cd401
    http://security.debian.org/pool/updates/main/s/samba/samba_2.2.3a-14.2_alpha.deb
      Size/MD5 checksum:  2963048 6860982e4f08926c032d28b2614de9eb
    http://security.debian.org/pool/updates/main/s/samba/samba-common_2.2.3a-14.2_alpha.deb
      Size/MD5 checksum:  1132586 f422f96231a49f8798e23799773b1913
    http://security.debian.org/pool/updates/main/s/samba/smbclient_2.2.3a-14.2_alpha.deb
      Size/MD5 checksum:  1159098 2974f164602da70553a48bb5f33c453f
    http://security.debian.org/pool/updates/main/s/samba/smbfs_2.2.3a-14.2_alpha.deb
      Size/MD5 checksum:   952040 108b244edced3569e81ceac4cca464d8
    http://security.debian.org/pool/updates/main/s/samba/swat_2.2.3a-14.2_alpha.deb
      Size/MD5 checksum:   624342 cfa17afeef989729921d2054ff35e2d0
    http://security.debian.org/pool/updates/main/s/samba/winbind_2.2.3a-14.2_alpha.deb
      Size/MD5 checksum:  1108844 012f203692a25c6ffe3c22f823283423

  ARM architecture:

    http://security.debian.org/pool/updates/main/s/samba/libpam-smbpass_2.2.3a-14.2_arm.deb
      Size/MD5 checksum:   397606 e3e807c7cf17368ce1b8dd42ec7d6164
    http://security.debian.org/pool/updates/main/s/samba/libsmbclient_2.2.3a-14.2_arm.deb
      Size/MD5 checksum:   462146 b715f738b9317243e4fc12cd62fd2396
    http://security.debian.org/pool/updates/main/s/samba/libsmbclient-dev_2.2.3a-14.2_arm.deb
      Size/MD5 checksum:   548352 5e2a59f8dbb9b9a89416711ef8f7668a
    http://security.debian.org/pool/updates/main/s/samba/samba_2.2.3a-14.2_arm.deb
      Size/MD5 checksum:  2557662 3f53c5016e17d7f88e18b8e71b104aa9
    http://security.debian.org/pool/updates/main/s/samba/samba-common_2.2.3a-14.2_arm.deb
      Size/MD5 checksum:  1024318 14d245cf77b2f09f8568b3111f45bb53
    http://security.debian.org/pool/updates/main/s/samba/smbclient_2.2.3a-14.2_arm.deb
      Size/MD5 checksum:  1004756 71f0152421a3ae144c4c1d954a8e968a
    http://security.debian.org/pool/updates/main/s/samba/smbfs_2.2.3a-14.2_arm.deb
      Size/MD5 checksum:   833412 6174eb2e44fad3021e741c18cf400d79
    http://security.debian.org/pool/updates/main/s/samba/swat_2.2.3a-14.2_arm.deb
      Size/MD5 checksum:   558488 d991ee85af61b00eba644c1066f25d84
    http://security.debian.org/pool/updates/main/s/samba/winbind_2.2.3a-14.2_arm.deb
      Size/MD5 checksum:   976166 b0707e5ce8801cd072ebac9c991e9997

  Intel IA-32 architecture:

    http://security.debian.org/pool/updates/main/s/samba/libpam-smbpass_2.2.3a-14.2_i386.deb
      Size/MD5 checksum:   389290 889828ac5a057bf25dc3cb7113a9380d
    http://security.debian.org/pool/updates/main/s/samba/libsmbclient_2.2.3a-14.2_i386.deb
      Size/MD5 checksum:   446478 ed692d3f99e5d7dc2c7e7410c8130c64
    http://security.debian.org/pool/updates/main/s/samba/libsmbclient-dev_2.2.3a-14.2_i386.deb
      Size/MD5 checksum:   500178 9a79ce62bafb3406d3e72d7ddde7fb86
    http://security.debian.org/pool/updates/main/s/samba/samba_2.2.3a-14.2_i386.deb
      Size/MD5 checksum:  2421974 6c6b944883a8fbee61f7408ff37ba8d1
    http://security.debian.org/pool/updates/main/s/samba/samba-common_2.2.3a-14.2_i386.deb
      Size/MD5 checksum:   993612 62aab90749ffb236184542883c55e725
    http://security.debian.org/pool/updates/main/s/samba/smbclient_2.2.3a-14.2_i386.deb
      Size/MD5 checksum:   955560 906eaca395641f209b0fe337217db70b
    http://security.debian.org/pool/updates/main/s/samba/smbfs_2.2.3a-14.2_i386.deb
      Size/MD5 checksum:   794860 163e9b00151866c4b810b7c9e4438e52
    http://security.debian.org/pool/updates/main/s/samba/swat_2.2.3a-14.2_i386.deb
      Size/MD5 checksum:   535812 3aa901020246a2485e62e0ede3c6634a
    http://security.debian.org/pool/updates/main/s/samba/winbind_2.2.3a-14.2_i386.deb
      Size/MD5 checksum:   932022 20cd8457fdfbf90108b15369a31d837f

  Intel IA-64 architecture:

    http://security.debian.org/pool/updates/main/s/samba/libpam-smbpass_2.2.3a-14.2_ia64.deb
      Size/MD5 checksum:   462676 540dace1a60b0e5cfba97e8866c23a7f
    http://security.debian.org/pool/updates/main/s/samba/libsmbclient_2.2.3a-14.2_ia64.deb
      Size/MD5 checksum:   554712 bd471871155707af98c5b464520a5210
    http://security.debian.org/pool/updates/main/s/samba/libsmbclient-dev_2.2.3a-14.2_ia64.deb
      Size/MD5 checksum:   626242 5d3b0f59069be1e3802a4f43e76cf6f5
    http://security.debian.org/pool/updates/main/s/samba/samba_2.2.3a-14.2_ia64.deb
      Size/MD5 checksum:  3495238 b45f2ce637e094b1017027df16d00616
    http://security.debian.org/pool/updates/main/s/samba/samba-common_2.2.3a-14.2_ia64.deb
      Size/MD5 checksum:  1250614 80d39f2455e74a45b11c854739c08776
    http://security.debian.org/pool/updates/main/s/samba/smbclient_2.2.3a-14.2_ia64.deb
      Size/MD5 checksum:  1332568 f52feeb16a80fb9a7919245f3c1356eb
    http://security.debian.org/pool/updates/main/s/samba/smbfs_2.2.3a-14.2_ia64.deb
      Size/MD5 checksum:  1100422 157d2efbf4cbb2c8b1b9e1582159be7d
    http://security.debian.org/pool/updates/main/s/samba/swat_2.2.3a-14.2_ia64.deb
      Size/MD5 checksum:   696270 d03bd295dbfefd9d01510482f92f6e41
    http://security.debian.org/pool/updates/main/s/samba/winbind_2.2.3a-14.2_ia64.deb
      Size/MD5 checksum:  1283854 7b50b300c3613c5ba444c2f24e1ac292

  HP Precision architecture:

    http://security.debian.org/pool/updates/main/s/samba/libpam-smbpass_2.2.3a-14.2_hppa.deb
      Size/MD5 checksum:   420536 2d65dcc7d03aa1a543e2502a84d786cc
    http://security.debian.org/pool/updates/main/s/samba/libsmbclient_2.2.3a-14.2_hppa.deb
      Size/MD5 checksum:   491894 dc029fc8dd9e0064f4df562eba62e562
    http://security.debian.org/pool/updates/main/s/samba/libsmbclient-dev_2.2.3a-14.2_hppa.deb
      Size/MD5 checksum:   590552 810af1ee8bfe5f6b1ac5587bdceb6b7d
    http://security.debian.org/pool/updates/main/s/samba/samba_2.2.3a-14.2_hppa.deb
      Size/MD5 checksum:  2798038 cdb68b3c7e2d6729dddb8700cc433690
    http://security.debian.org/pool/updates/main/s/samba/samba-common_2.2.3a-14.2_hppa.deb
      Size/MD5 checksum:  1082366 cfc5500a166c1f4e230442fd280b5c04
    http://security.debian.org/pool/updates/main/s/samba/smbclient_2.2.3a-14.2_hppa.deb
      Size/MD5 checksum:  1087188 7ba92ad1f99751f1c9f90a9dbd19bd01
    http://security.debian.org/pool/updates/main/s/samba/smbfs_2.2.3a-14.2_hppa.deb
      Size/MD5 checksum:   903314 8cc3d7d91b09cffe2ff51476839db369
    http://security.debian.org/pool/updates/main/s/samba/swat_2.2.3a-14.2_hppa.deb
      Size/MD5 checksum:   590724 e3ad49e185067df013a4fef46a3ee828
    http://security.debian.org/pool/updates/main/s/samba/winbind_2.2.3a-14.2_hppa.deb
      Size/MD5 checksum:  1062004 26531112552c087dadfd7ffc280df23b

  Motorola 680x0 architecture:

    http://security.debian.org/pool/updates/main/s/samba/libpam-smbpass_2.2.3a-14.2_m68k.deb
      Size/MD5 checksum:   399726 00f799e82545d582d860f46bf10dea70
    http://security.debian.org/pool/updates/main/s/samba/libsmbclient_2.2.3a-14.2_m68k.deb
      Size/MD5 checksum:   461030 a10f03d2fe355df7e797828fe962c800
    http://security.debian.org/pool/updates/main/s/samba/libsmbclient-dev_2.2.3a-14.2_m68k.deb
      Size/MD5 checksum:   505888 591cfb5ebcd6e2dbb68eb948603717aa
    http://security.debian.org/pool/updates/main/s/samba/samba_2.2.3a-14.2_m68k.deb
      Size/MD5 checksum:  2367100 308996ff251844dd3f0a5fded2a35433
    http://security.debian.org/pool/updates/main/s/samba/samba-common_2.2.3a-14.2_m68k.deb
      Size/MD5 checksum:   983814 47b877e8763494e2b00c874095a78a5b
    http://security.debian.org/pool/updates/main/s/samba/smbclient_2.2.3a-14.2_m68k.deb
      Size/MD5 checksum:   939616 d19790091af32a60c3e7ee6e0af6a905
    http://security.debian.org/pool/updates/main/s/samba/smbfs_2.2.3a-14.2_m68k.deb
      Size/MD5 checksum:   791634 2754a51d35a1cf9398bd1bab50b5ae1b
    http://security.debian.org/pool/updates/main/s/samba/swat_2.2.3a-14.2_m68k.deb
      Size/MD5 checksum:   525696 9ceb78d6498c3d27cfa4d87b2f379a0a
    http://security.debian.org/pool/updates/main/s/samba/winbind_2.2.3a-14.2_m68k.deb
      Size/MD5 checksum:   933810 2efa93cceb0a3acda77fb0e6e2e6314f

  Big endian MIPS architecture:

    http://security.debian.org/pool/updates/main/s/samba/libpam-smbpass_2.2.3a-14.2_mips.deb
      Size/MD5 checksum:   396722 34fb219c9fe830264cdf52c7a0f3b1ab
    http://security.debian.org/pool/updates/main/s/samba/libsmbclient_2.2.3a-14.2_mips.deb
      Size/MD5 checksum:   460120 57dba7ccba6755517cfc58b4dea07979
    http://security.debian.org/pool/updates/main/s/samba/libsmbclient-dev_2.2.3a-14.2_mips.deb
      Size/MD5 checksum:   570634 39cdf8befd87163e0e9c52abb6c8b6ce
    http://security.debian.org/pool/updates/main/s/samba/samba_2.2.3a-14.2_mips.deb
      Size/MD5 checksum:  2808398 ce1a6d37dab949fb7724aa9faca655dc
    http://security.debian.org/pool/updates/main/s/samba/samba-common_2.2.3a-14.2_mips.deb
      Size/MD5 checksum:  1080004 a2166427424924afc7ded093a42bc01b
    http://security.debian.org/pool/updates/main/s/samba/smbclient_2.2.3a-14.2_mips.deb
      Size/MD5 checksum:  1089938 b0ef5f7ff9cf948c5d2a1fa09780d563
    http://security.debian.org/pool/updates/main/s/samba/smbfs_2.2.3a-14.2_mips.deb
      Size/MD5 checksum:   912144 d4cd215c563ac74d5240dda768f46503
    http://security.debian.org/pool/updates/main/s/samba/swat_2.2.3a-14.2_mips.deb
      Size/MD5 checksum:   581964 190062657bbc945d78c731c06b3a897c
    http://security.debian.org/pool/updates/main/s/samba/winbind_2.2.3a-14.2_mips.deb
      Size/MD5 checksum:  1030284 50054e577b25f48e575f9e83ca41ce0b

  Little endian MIPS architecture:

    http://security.debian.org/pool/updates/main/s/samba/libpam-smbpass_2.2.3a-14.2_mipsel.deb
      Size/MD5 checksum:   392796 c5dc7710c31eceadf0d46f0b40b06809
    http://security.debian.org/pool/updates/main/s/samba/libsmbclient_2.2.3a-14.2_mipsel.deb
      Size/MD5 checksum:   454590 318da06daca89d1155c7e5c9b3c93b43
    http://security.debian.org/pool/updates/main/s/samba/libsmbclient-dev_2.2.3a-14.2_mipsel.deb
      Size/MD5 checksum:   563800 402e3326d8bd634e15bf1c1a9c4c644a
    http://security.debian.org/pool/updates/main/s/samba/samba_2.2.3a-14.2_mipsel.deb
      Size/MD5 checksum:  2771130 ba9ab77b83292afa7538852f5a868d19
    http://security.debian.org/pool/updates/main/s/samba/samba-common_2.2.3a-14.2_mipsel.deb
      Size/MD5 checksum:  1073534 b3d8482b87dc1ac20eb4461c9595182c
    http://security.debian.org/pool/updates/main/s/samba/smbclient_2.2.3a-14.2_mipsel.deb
      Size/MD5 checksum:  1078464 80bc11245b63d47f2e5dba17ce622e59
    http://security.debian.org/pool/updates/main/s/samba/smbfs_2.2.3a-14.2_mipsel.deb
      Size/MD5 checksum:   899430 27ecacc2e46f7c38b36cd52019b7820c
    http://security.debian.org/pool/updates/main/s/samba/swat_2.2.3a-14.2_mipsel.deb
      Size/MD5 checksum:   577708 60fe284f98cb7a3c18a1918a52ab4dc9
    http://security.debian.org/pool/updates/main/s/samba/winbind_2.2.3a-14.2_mipsel.deb
      Size/MD5 checksum:  1017342 75881b6098d79160a85b5b3b0f878011

  PowerPC architecture:

    http://security.debian.org/pool/updates/main/s/samba/libpam-smbpass_2.2.3a-14.2_powerpc.deb
      Size/MD5 checksum:   409336 174f6cfef8574bcc282c7d7cd665770b
    http://security.debian.org/pool/updates/main/s/samba/libsmbclient_2.2.3a-14.2_powerpc.deb
      Size/MD5 checksum:   476594 cec7d028024104714af7f7bbdd3668d5
    http://security.debian.org/pool/updates/main/s/samba/libsmbclient-dev_2.2.3a-14.2_powerpc.deb
      Size/MD5 checksum:   547480 d7b88a2a152ef39a6f23dbc8ac46d690
    http://security.debian.org/pool/updates/main/s/samba/samba_2.2.3a-14.2_powerpc.deb
      Size/MD5 checksum:  2610996 31eed1691e75a8bbe22187be00f0a14b
    http://security.debian.org/pool/updates/main/s/samba/samba-common_2.2.3a-14.2_powerpc.deb
      Size/MD5 checksum:  1038260 35d3029a6457c37a8c3a4e4bcd9341ef
    http://security.debian.org/pool/updates/main/s/samba/smbclient_2.2.3a-14.2_powerpc.deb
      Size/MD5 checksum:  1023524 0526ddd483d09d191c8ddcda9185d0bf
    http://security.debian.org/pool/updates/main/s/samba/smbfs_2.2.3a-14.2_powerpc.deb
      Size/MD5 checksum:   853602 d5e2a9c4bbec328154d1a08c56f93904
    http://security.debian.org/pool/updates/main/s/samba/swat_2.2.3a-14.2_powerpc.deb
      Size/MD5 checksum:   561486 5626087bf9267d858e0289aee1405a77
    http://security.debian.org/pool/updates/main/s/samba/winbind_2.2.3a-14.2_powerpc.deb
      Size/MD5 checksum:  1003532 da00f6f7a477e1a52ba18a335aa127f6

  IBM S/390 architecture:

    http://security.debian.org/pool/updates/main/s/samba/libpam-smbpass_2.2.3a-14.2_s390.deb
      Size/MD5 checksum:   404072 b52d6ae5e77777addefd28c58c4a6fe9
    http://security.debian.org/pool/updates/main/s/samba/libsmbclient_2.2.3a-14.2_s390.deb
      Size/MD5 checksum:   470950 d3385a09944ad94781b880a1d80c9ac6
    http://security.debian.org/pool/updates/main/s/samba/libsmbclient-dev_2.2.3a-14.2_s390.deb
      Size/MD5 checksum:   527804 27fd260c9398154514e8a70177ce055a
    http://security.debian.org/pool/updates/main/s/samba/samba_2.2.3a-14.2_s390.deb
      Size/MD5 checksum:  2501754 6be4ff7189917615125c40e3ee631eef
    http://security.debian.org/pool/updates/main/s/samba/samba-common_2.2.3a-14.2_s390.deb
      Size/MD5 checksum:  1008760 4c6651d64c3c4a9ec8916af1e91e9fb1
    http://security.debian.org/pool/updates/main/s/samba/smbclient_2.2.3a-14.2_s390.deb
      Size/MD5 checksum:   984848 637babef496afe73603eef16112486f4
    http://security.debian.org/pool/updates/main/s/samba/smbfs_2.2.3a-14.2_s390.deb
      Size/MD5 checksum:   835314 efde15896957552cdd76308c9ad2dab2
    http://security.debian.org/pool/updates/main/s/samba/swat_2.2.3a-14.2_s390.deb
      Size/MD5 checksum:   538650 b5a655c7d4bec50cdc087c232b9244b6
    http://security.debian.org/pool/updates/main/s/samba/winbind_2.2.3a-14.2_s390.deb
      Size/MD5 checksum:   967484 4827ac06c204098d224e5f0e88ffc24d

  Sun Sparc architecture:

    http://security.debian.org/pool/updates/main/s/samba/libpam-smbpass_2.2.3a-14.2_sparc.deb
      Size/MD5 checksum:   401274 61e2ad2290e32ce5aee5c0967563a332
    http://security.debian.org/pool/updates/main/s/samba/libsmbclient_2.2.3a-14.2_sparc.deb
      Size/MD5 checksum:   462188 1e3ef6dd9583ba51c55c87c4f94444d3
    http://security.debian.org/pool/updates/main/s/samba/libsmbclient-dev_2.2.3a-14.2_sparc.deb
      Size/MD5 checksum:   525132 4c2116ac5547fbd4cb7f7a7024ac5d43
    http://security.debian.org/pool/updates/main/s/samba/samba_2.2.3a-14.2_sparc.deb
      Size/MD5 checksum:  2517230 ba9adc956c8403f54301e0d0cee3d558
    http://security.debian.org/pool/updates/main/s/samba/samba-common_2.2.3a-14.2_sparc.deb
      Size/MD5 checksum:  1012856 d1343c98d143e18116f33539fcdd6acd
    http://security.debian.org/pool/updates/main/s/samba/smbclient_2.2.3a-14.2_sparc.deb
      Size/MD5 checksum:   987080 ede9dd55c713256a520f1c27fc75d96a
    http://security.debian.org/pool/updates/main/s/samba/smbfs_2.2.3a-14.2_sparc.deb
      Size/MD5 checksum:   830820 c3efc54482ca48b1cbab74a8ad6bb252
    http://security.debian.org/pool/updates/main/s/samba/swat_2.2.3a-14.2_sparc.deb
      Size/MD5 checksum:   544688 65292ae729bb008692ed4b6c4544e995
    http://security.debian.org/pool/updates/main/s/samba/winbind_2.2.3a-14.2_sparc.deb
      Size/MD5 checksum:   967778 668c6be5dce7c832db6db69d57dcd881


  These files will probably be moved into the stable distribution on
  its next update.

- ---------------------------------------------------------------------------------
For apt-get: deb http://security.debian.org/ stable/updates main
For dpkg-ftp: ftp://security.debian.org/debian-security dists/stable/updates/main
Mailing list: debian-security-announce@...ts.debian.org
Package info: `apt-cache show <pkg>' and http://packages.debian.org/<pkg>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.0 (GNU/Linux)

iD8DBQFCS/21W5ql+IAeqTIRArQdAJ9FjkQ9al6fIkoIKCY31N5VswgApQCcDFSz
jnc1AZvaZK4s86OlQXq5Adw=
=mBnv
-----END PGP SIGNATURE-----



