
Date: Mon, 4 Jul 2005 20:06:15 +0100
From: Rob Holland <tigger@...too.org>
To: bugtraq@...urityfocus.com
Subject: pam_ldap/nss_ldap password leak in a master+slave+start_tls LDAP setup


pam_ldap/nss_ldap fail to re-start TLS when following referred
connections. This can result in credentials being sent in clear text
when pam_ldap/nss_ldap attempt to rebind.

This affects any LDAP infrastructure which can generate referrals during
NSS or PAM operations (generally a master+slave LDAP setup) and which
relies on "ssl start_tls" in ldap.conf for security of the connections.

Although the initial connection starts TLS properly, subsequent referred
connections do not.

This is a bug in all three of nss_ldap, pam_ldap and openldap. pam_ldap
and nss_ldap to not attempt to re-start TLS and Openldap does not
currently allow a client to start TLS on a referred connection anyway,
due to a buggy "already doing tls" check.

Bugs have been filed (and ignored, save for a mistaken "we don't take
3rd party patches" email) upstream at:

http://www.openldap.org/its/index.cgi/Incoming?id=3791

and

http://bugzilla.padl.com/show_bug.cgi?id=210
http://bugzilla.padl.com/show_bug.cgi?id=211

The nss bug (211) is only filed today as I've only just been alerted to
the fact that it suffers the same problem.

-- 
rob holland - [ tigger@...too.org ] - Gentoo Audit Team
[ 5251 4FAC D684 8845 5604  E44F D65C 392F D91B 4729 ]


