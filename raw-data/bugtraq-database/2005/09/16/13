
Date: Fri, 16 Sep 2005 15:48:14 +0200
From: ZATAZ Audits <exploits@...az.net>
To: vuldb@...urityfocus.com, vuln@...unia.com, vuln@...tik.com,
	moderators@...db.org, bugs@...uritytracker.com,
	submissions@...ketstormsecurity.org, news@...uriteam.com,
	xforce@....net, bugtraq@...urityfocus.com, vulnwatch@...nwatch.org,
	full-disclosure@...ts.grok.org.uk
Subject: gwcc insecure temporary file creation


#########################################################

gwcc insecure temporary file creation

Vendor: http://gwcc.sourceforge.net/
Advisory: http://www.zataz.net/adviso/gwcc-09052005.txt
Vendor informed: yes
Exploit available: yes
Impact : low
Exploitation : low

#########################################################

The vulnerability is caused due to temporary file being created insecurely.
This can be exploited via symlink attacks to create and overwrite 
arbitrary files
with the privileges of the user running the affected script.

Secunia report that this bug was discovered by D1g1t4lLeech the 2005-09-16.

ZATAZ Audit has discovered this bug the 2005-09-02

So I think that D1g1t4lLeech is a true leecher ;)

##########
Versions:
##########

gwcc <= 0.9.6-r2

##########
Solution:
##########

To prevent symlink attack use kernel patch such as grsecurity
Gentoo Patch : http://bugs.gentoo.org/attachment.cgi?id=67477

#########
Timeline:
#########

Discovered : 2005-09-02
Vendor notified : 2005-09-05
Vendor response : no reponse
Vendor fix : no patch
Vendor Sec report (vendor-sec@....de) : 2005-09-13
Disclosure : 2005-09-16

#####################
Technical details :
#####################

Vulnerable code :
-----------------

Take a look at : src/callbacks.c

1702     // Pipe print command and voila!, the doc is printed.
1703     strcat(print_command, " /tmp/gwcc_out.txt");

And also into : src/utils.c

94     else if (strcmp(operation, "temp") == 0) {
95         strcat(file_name, "/tmp/gwcc_out.txt");

#########
Related :
#########

Bug report : http://bugs.gentoo.org/show_bug.cgi?id=104566
CVE : NONE

#####################
Credits :
#####################

Eric Romang (eromang@...az.net - ZATAZ Audit) - Gentoo Security Scout
Thxs to Gentoo Security Team.


_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/


