
Date: Wed, 7 Sep 2005 13:46:29 +0200
From: Ansgar -59cobalt- Wiechers <bugtraq@...netcobalt.net>
To: bugtraq@...urityfocus.com, full-disclosure@...ts.grok.org.uk
Subject: Re: Microsoft Windows keybd_event validation
	vulnerability


On 2005-09-06 Frederic Charpentier wrote:
> I haven't seen any information about this new local exploit for
> Microsoft Windows :
> 
> http://www.haxorcitos.com/MSRC-6005bgs-EN.txt
> 
> Description from Haxorcitos :
> 
> As is Known, with the current Microsoft Security Model, applications
> that share the destkop are able to send messages between them.
> Every Desktop application is able to obtain the handle of every
> process executed in the same desktop.
> 
> This feature and the possibility of any application to emulate a
> virtual keyboard by sending key strokes, allows every process to send
> messages and keys as if there were an interactive user.

This has been known for years and is the exact reason why Microsoft
recommends that any service running with elevated privileges should
*not* be run interactively [1].

This flaw allows for shatter attacks [2,3] and we have used it in [4] to
attack personal firewalls.

[1] http://support.microsoft.com/default.aspx?scid=kb;en-us;327618
[2] http://security.tombom.co.uk/shatter.html
[3] http://security.tombom.co.uk/moreshatter.html
[4] http://copton.net/vortraege/pfw/index.html

Regards
Ansgar Wiechers
-- 
"Another option [for defragmentation] is to back up your important files,
erase the hard disk, then reinstall Mac OS X and your backed up files."
--http://docs.info.apple.com/article.html?artnum=25668
_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/


