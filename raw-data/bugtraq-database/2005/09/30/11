
Date: Fri, 30 Sep 2005 14:23:45 -0400
From: "iDEFENSE Labs" <labs-no-reply@...fense.com>
To: <bugtraq@...urityfocus.com>, <vulnwatch@...nwatch.org>,
	<full-disclosure@...ts.grok.org.uk>
Subject: iDEFENSE Security Advisory 09.30.05: RealNetworks
	RealPlayer/HelixPlayer RealPix Format String Vulnerability


RealNetworks RealPlayer/HelixPlayer RealPix Format String Vulnerability 

iDEFENSE Security Advisory 09.30.05
www.idefense.com/application/poi/display?id=311&type=vulnerabilities
September 30, 2005

I. BACKGROUND

RealPlayer is an application for playing various media formats,
developed by RealNetworks Inc. For more information, visit
http://www.real.com/.

II. DESCRIPTION

Remote exploitation of a format string vulnerability in RealPix (.rp) 
file format parser within various versions of RealNetworks Inc.'s 
RealPlayer could allow attackers to execute arbitrary code. 

The vulnerability specifically exists because of the improper usage of a

formatted printing function. When a user specifies an invalid value for 
the "timeformat" attribute describing a RealPix file, the data is passed

to the function. 

The following stripped down .rp file is sufficient enough to trigger the

vulnerability: 

   <imfl>
   <head 
   title="iDEFENSE Labs RealPix Vulnerability"
   timeformat="%n%n%n%n%n%n"/>
   </imfl> 


III. ANALYSIS

Exploitation allows for arbitrary code execution as the user who opened
the .rp file.

Exploitation requires an attacker to craft a malicious .rp file and
convince a user to open it. An attacker could also trick a user to load 
the .rp file from a normal web page under the attacker's control; this 
is possible if the user has configured their web browser to handle 
RealPlayer formats automatically.

IV. DETECTION

iDEFENSE Labs has confirmed that RealPlayer 10.0.4.750 on Linux is 
vulnerable. Windows and Mac versions of RealPlayer are not vulnerable. 
FreeBSD versions are suspected vulnerable.

The vendor has indicated that the following versions are vulnerable:
   Linux RealPlayer 10 (10.0.0 - 10.0.5)
   Helix Player (10.0.0 - 10.0.5)

The following vendors include susceptible RealPlayer packages within
their respective distributions:

	The FreeBSD Project: FreeBSD 5.3 and earlier
	Novell Inc.: SuSE Linux 9.2 
	Red Hat Inc.: Desktop v.3 and v.4,
	   Enterprise Linux AS/ES/WS v.3 and v.4 and Fedora Core 3,
	   Linux 7.3 and 9 

V. WORKAROUND

Filter .rp attachments at e-mail gateways. Educate users about the risks

of accepting files from untrusted individuals.

VI. VENDOR RESPONSE

The vendor had released the following advisory for this vulnerability:

   http://service.real.com/help/faq/security/050930_player/EN/

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CAN-2005-2710 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

08/23/2005  Initial vendor notification
09/02/2005  Initial vendor response
09/30/2005  Coordinated public disclosure

IX. CREDIT

iDEFENSE Labs is credited with this discovery.

Get paid for vulnerability research
http://www.idefense.com/poi/teams/vcp.jsp

Free tools, research and upcoming events
http://labs.idefense.com

X. LEGAL NOTICES

Copyright (c) 2005 iDEFENSE, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDEFENSE. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically, please
email customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/


