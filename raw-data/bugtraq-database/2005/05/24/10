
Date: Tue, 24 May 2005 16:09:16 -0400
From: "iDEFENSE Labs" <labs-no-reply@...fense.com>
To: <bugtraq@...urityfocus.com>, <vulnwatch@...nwatch.org>,
	<full-disclosure@...ts.grok.org.uk>
Subject: iDEFENSE Security Advisory 05.24.05: Ipswitch
	IMail IMAP LSUB DoS Vulnerability


Ipswitch IMail IMAP LSUB DoS Vulnerability

iDEFENSE Security Advisory 05.24.05
www.idefense.com/application/poi/display?id=245&type=vulnerabilities
May 24, 2005

I. BACKGROUND

Ipswitch Collaboration Suite (ICS) is a comprehensive communication and 
collaboration solution for Microsoft Windows with a customer base of 
over 53 million users. More information is available on the vendor's 
website:

     http://www.ipswitch.com/products/IMail_Server/index.html

II. DESCRIPTION

Remote exploitation of a denial of service (DoS) vulnerability in 
Ipswitch Inc.'s IMail IMAP daemon allows attackers to cause 100 percent 
CPU use on the server, thereby preventing legitimate users from 
retrieving e-mail.

The problem specifically exists within IMAPD32.EXE upon parsing a 
malformed LSUB command. An attacker can cause the daemon to produce 
heavy load by transmitting a long string of NULL characters to the 
'LSUB' IMAP directive. This, in turn, causes an infinite loop, 
eventually exhausting all available system resources and causing a 
denial of service.

III. ANALYSIS

Exploitation allows unauthenticated remote attackers to render the IMAP 
server useless, thereby preventing legitimate users from retrieving e-
mail. This attack takes few resources to launch and can be repeated 
to ensure that an unpatched system is unable to recover. Exploitation 
requires a valid IMAP account, thus limiting the impact of this 
vulnerability.

IV. DETECTION

iDEFENSE has confirmed the existence of this vulnerability in Ipswitch 
IMail version 8.13. It is suspected that earlier versions are also 
vulnerable.

V. WORKAROUND

As this vulnerability is exploited after authentication occurs, ensuring

that only trusted users have accounts can mitigate the risk somwhat. As 
a more effective workaround, consider limiting access to the IMAP server

by filtering TCP port 143. If possible, consider disabling IMAP and 
forcing users to use POP3.

VI. VENDOR RESPONSE

The vendor has released the following patch to fix this vulnerability:

ftp://ftp.ipswitch.com/Ipswitch/Product_Support/IMail/imail82hf2.exe

The associated vendor advisory can be found at:

http://www.ipswitch.com/support/imail/releases/imail_professional/im82hf
2.html

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CAN-2005-1249 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

04/25/2005  Initial vendor notification
05/10/2005  Initial vendor response
05/24/2005  Public disclosure

IX. CREDIT

The discoverer of the first vulnerability wishes to remain anonymous.

Get paid for vulnerability research
http://www.idefense.com/poi/teams/vcp.jsp

Free tools, research and upcoming events
http://labs.idefense.com

X. LEGAL NOTICES

Copyright (c) 2005 iDEFENSE, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDEFENSE. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically, please
email customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/


