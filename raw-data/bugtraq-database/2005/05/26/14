
Date: Thu, 26 May 2005 11:10:53 -0600
From: "Boren, Rich (SSRT)" <rich.boren@...com>
To: <bugtraq@...urityfocus.com>
Subject: [security bulletin] SSRT5954 rev.1 - HP-UX TCP/IP Remote Denial of Service (DoS)



-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

HP SECURITY BULLETIN

HPSBUX01137     REVISION: 1

SSRT5954 rev.1 - HP-UX TCP/IP Remote Denial of Service (DoS)

NOTICE:
There are no restrictions for distribution of this Security
Bulletin provided that it remains complete and intact.

The information in this Security Bulletin should be acted upon
as soon as possible.

INITIAL RELEASE:
25 May 2005

POTENTIAL SECURITY IMPACT:
Remote Denial of Service (DoS)

SOURCE:
Hewlett-Packard Company
HP Software Security Response Team

VULNERABILITY SUMMARY:
A potential security vulnerability has been identified with HP-UX
running TCP/IP (IPv4). This vulnerability could be remotely
exploited by an unauthorized user to cause a Denial of Service
(DoS).

REFERENCES:
CAN-2005-1192

SUPPORTED SOFTWARE VERSIONS*:  ONLY impacted versions are listed.
HP-UX B.11.00, B.11.04, B.11.11, B.11.22, B.11.23 running
TCP/IP (IPv4).

BACKGROUND:

  AFFECTED VERSIONS

     HP-UX B.11.22
     HP-UX B.11.04
     HP-UX B.11.00
     =============
     action: set ip_pmtu_strategy = 0 or 3

     HP-UX B.11.23
     =============
     Networking.NET2-KRN
 ->action: install preliminary binary files per HPSBUX01164


     HP-UX B.11.11
     =============
     Networking.NET2-KRN
 ->action: install preliminary binary files per HPSBUX01164

  END AFFECTED VERSIONS


Certain network traffic can result in a Denial of Service (DoS)
for HP-UX systems running TCP/IP (IPv4).  Receiving a certain
packet on any open TCP/IP connection can result in a Denial of
Service (DoS) condition which can only be corrected by a reboot
of the affected system.

Until patches are available to resolve the issue the Denial of
Service (DoS) can be avoided by setting the ip_pmtu_strategy
parameter to either 0 or 3.

 Discussion of ip_pmtu_strategy
 ----------------------------------

The default value for ip_pmtu_strategy is 1.  This allows for PMTU
discovery.  Once the issue of this Security Bulletin has been
resolved via patches the ip_pmtu_strategy value of 1 will again be
the preferred setting for most situations.

The ip_pmtu_strategy values of 0 and 3 set the PMTU to a fixed
size for destinations which are not on the local network.

The ip_pmtu_strategy value of 0 sets the PMTU to 576 bytes.
Routers are required to handle packets of at least this size.

The ip_pmtu_strategy value of 3 sets the PMTU to 1500 bytes.  This
will generally result in more efficient transmission than the 576
byte PMTU.  If it is known that the routers involved can handle a
1500 byte MTU the ip_pmtu_strategy value of 3 is preferred.

 Patch requirements for setting ip_pmtu_strategy to 3
 ----------------------------------------------------------

All affected HP-UX versions allow setting ip_pmtu_strategy to 0.

B.11.22 and B.11.23 have no patch requirements for
setting ip_pmtu_strategy to 3.

B.11.11, B.11.04, and B.11.00 require the following patches in
order to set ip_pmtu_strategy to 3:

   B.11.11 - PHNE_25642 or subsequent
   B.11.04 - PHNE_26101 or subsequent
   B.11.00 - PHNE_25423 or subsequent

 Reboot requirement for setting ip_pmtu_strategy
 ------------------------------------------------------

The ip_pmtu_strategy parameter can be set via the ndd(1M) command
or by changing the nddconf file and rebooting the system.  The
ndd(1M) command only affects new connections.  Existing
connections will remain vulnerable until they terminate or until
the system is rebooted and the nddconf value of ip_pmtu_strategy
takes effect.

Note:
It has been recommended in several places including HP-UX
Bastille, System Health Check, and the Security Bulletin
HPSBUX0001-110 that ip_pmtu_strategy be set to 1.   This
recommendation was made to avoid issues with which
occurred when ip_pmtu_strategy was set to 2.  The value 1
was recommended because it is the system default and
for most situations results in the best performance.  However,
the values 0 and 3 also avoid the issues which occurred when
ip_pmtu_strategy was set to 2.  As mentioned above once the
issue of this Security Bulletin has been resolved via patches the
ip_pmtu_strategy setting of 1 will again be the preferred setting
for most situations.

Note:
There is a defect that will cause "ndd -c" to fail if there are
more than 10 directives in /etc/rc.config.d/nddconf.  That defect
is fixed in the following patches:

   B.11.11 - PHNE_25644 or subsequent
   B.11.04 - PHNE_26076 or subsequent
   B.11.00 - PHNE_26125 or subsequent
RESOLUTION:

Until patches are available the Denial of Service (DoS) can be
avoided by setting the ip_pmtu_strategy parameter to 0 or 3.

 ->Note: The preliminary binary files cited in HPSBUX01164 for
         B.11.11 and B.11.23 will resolve the issue of this
         Security Bulletin as well.

If the ip_pmtu_strategy value of 3 is desired for B.11.11, B11.04,
or B.11.00 apply the patches listed in the Background section.

Edit /etc/rc.config.d/nddconf to add the following:

TRANSPORT_NAME[n]=ip
NDD_NAME[n]=ip_pmtu_strategy
NDD_VALUE[n]=0

or

TRANSPORT_NAME[n]=ip
NDD_NAME[n]=ip_pmtu_strategy
NDD_VALUE[n]=3

where 'n' is the next available index value as described in the
nddconf comments.

As discussed in the Background section the system must be rebooted
for the new ip_pmtu_strategy to take effect.

Until the system can be rebooted the ip_pmtu_strategy value for
new connections can be set with the ndd(1M) command:

  /usr/bin/ndd -set /dev/ip ip_pmtu_strategy 0

or

  /usr/bin/ndd -set /dev/ip ip_pmtu_strategy 3
MANUAL ACTIONS:  Yes - NonUpdate
set ip_pmtu_strategy = 0 or 3

 ->For B.11.11 and B.11.23 the binary files cited in the
   HPSBUX01164 Security Bulletin will resolve the issue of this
   Security Bulletin as well.

BULLETIN REVISION HISTORY:
Revision 0: 24 April 2005
  Initial release

Revision 1: 25 May 2005
  The binary files of HPSBUX01164 will resolve the issue for
  B.11.11 and B.11.23.



HP-UX SPECIFIC SECURITY BULLETINS*:  Security Patch Check revision
B.02.00 analyzes all HP-issued Security Bulletins to provide a
subset of recommended actions that potentially affect a specific
HP-UX system.

For more information:
http://www.software.hp.com/cgi-bin/swdepot_parser.cgi/cgi/
displayProductInfo.pl?productNumber=B6834AA


SUPPORT: For further information, contact normal HP Services
support channel.

REPORT: To report a potential security vulnerability with any HP
supported product, send Email to: security-alert@...com. It is
strongly recommended that security related information being
communicated to HP be encrypted using PGP, especially exploit
information. To obtain the security-alert PGP key please send an
e-mail message to security-alert@...com with the Subject of
'get key' (no quotes).

SUBSCRIBE: To initiate a subscription to receive future HP
Security Bulletins via Email:

http://h30046.www3.hp.com/driverAlertProfile.php?regioncode=NA&
langcode=USENG&jumpid=in_SC-GEN__driverITRC&topiccode=ITRC

On the web page: ITRC security bulletins and patch sign-up
Under Step1: your IRTC security bulletins and patches
     - check ALL categories for which alerts are required and
       continue.
Under Step2: your IRTC operating systems
     - verify your operating system selections are checked and
       save.

To update an existing subscription:
http://h30046.www3.hp.com/subSignIn.php

Log in on the web page
  Subscriber's choice for Business: sign-in.
On the Web page:
 Subscriber's Choice: your profile summary
   - use Edit Profile to update appropriate sections.

To review previously published Security Bulletins visit:
http://itrc.hp.com/service/cki/secBullArchive.do

* The Software Product Category that this Security Bulletin
  relates to is represented by the 5th and 6th characters of the
  Bulletin number:
    GN = HP General SW,
    MA = HP Management Agents,
    MI = Misc. 3rd party SW,
    MP = HP MPE/iX,
    NS = HP NonStop Servers,
    OV = HP OpenVMS,
    PI = HP Printing & Imaging,
    ST = HP Storage SW,
    TL = HP Trusted Linux,
    TU = HP Tru64 UNIX,
    UX = HP-UX,
    VV = HP Virtual Vault

System management and security procedures must be reviewed
frequently to maintain system integrity. HP is continually
reviewing and enhancing the security features of software products
to provide customers with current secure solutions.

"HP is broadly distributing this Security Bulletin in order to
bring to the attention of users of the affected HP products the
important security information contained in this Bulletin. HP
recommends that all users determine the applicability of this
information to their individual situations and take appropriate
action. HP does not warrant that this information is necessarily
accurate or complete for all user situations and, consequently, HP
will not be responsible for any damages resulting from user's use
or disregard of the information provided in this Bulletin. To the
extent permitted by law, HP disclaims all warranties, either
express or implied, including the warranties of merchantability
and fitness for a particular purpose, title and non-infringement."


(c)Copyright 2005 Hewlett-Packard Development Company, L.P.
Hewlett-Packard Company shall not be liable for technical or
editorial errors or omissions contained herein. The information
provided is provided "as is" without warranty of any kind. To the
extent permitted by law, neither HP nor its affiliates,
subcontractors or suppliers will be liable for incidental, special
or consequential damages including downtime cost; lost profits;
damages relating to the procurement of substitute products or
services; or damages for loss of data, or software restoration.
The information in this document is subject to change without
notice. Hewlett-Packard Company and the names of Hewlett-Packard
products referenced herein are trademarks of Hewlett-Packard
Company in the United States and other countries. Other product
and company names mentioned herein may be trademarks of their
respective owners.

-----BEGIN PGP SIGNATURE-----
Version: PGP 8.1

iQA/AwUBQpXJNuAfOvwtKn1ZEQIhxwCg+0X2zY65cjOwsdCU7ZMpDtFQgkEAn0jH
QfANZNM3lj4ab5AolZCb7GHf
=V29p
-----END PGP SIGNATURE-----


