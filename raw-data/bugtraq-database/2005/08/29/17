
Date: Mon, 29 Aug 2005 17:26:47 -0400
From: "iDEFENSE Labs" <labs-no-reply@...fense.com>
To: <bugtraq@...urityfocus.com>, <vulnwatch@...nwatch.org>,
	<full-disclosure@...ts.grok.org.uk>
Subject: iDEFENSE Security Advisory 08.29.05: Adobe
	Version Cue VCNative Arbitrary File Overwrite Vulnerability


Adobe Version Cue VCNative Arbitrary File Overwrite Vulnerability

iDEFENSE Security Advisory 08.29.05
www.idefense.com/application/poi/display?id=297&type=vulnerabilities
August 29, 2005

I. BACKGROUND

Adobe Version Cue is a software version tracking system for Adobe 
products distributed with Adobe Creative Suite and select Adobe 
products. 

II. DESCRIPTION

Local exploitation of a design error in Adobe Systems, Inc. Version Cue 
allows local attackers to gain root privileges. Version Cue includes a
setuid root application named VCNative which is vulnerable to a symlink
attack. The vulnerability specifically exists due to the use of
predictable log file names. VCNative uses a format such as
"VCNative-[pid].log" for the filename and stores the file in the
current working directory. Attackers can easily predict the created
filename and supply user-controlled data via the "-host" and "- port"
options. A carefully supplied value can cause a crafted "log file" to
be written. Crafted strings written to root-owned files can lead to
arbitrary code execution with root privileges.

III. ANALYSIS

Successful exploitation allows local attackers to write to arbitrary 
files with user-supplied data. Data written to the linked file will 
include some corrupted data as well as user-suppplied data, potentially 
corrupting a file completely and preventing the execution of system 
commands. In addition, a carefully crafted input value can be used in 
conjunction with standard system tools such as cron to gain root 
privileges.

A workaround solution has been provided for this vulnerability. In 
addition, the vulnerability affects only the Apple OS X platform and is 
only installed with Adobe Creative Suite or other Adobe products. 

IV. DETECTION

iDEFENSE Labs has confirmed the existence of this vulnerability in 
Adobe Version Cue version 1 on the Apple OS X platform.

V. WORKAROUND

As a workaround solution, remove the setuid bit from the VCNative 
binary and execute the application as a root user when necessary.

VI. VENDOR RESPONSE

Adobe Version Cue Update 2 which addresses this vulnerability, is
available for download at:

 http://www.adobe.com/support/downloads/detail.jsp?ftpID=2985

The vendor advisory for this vulnerability is located at:

 http://www.adobe.com/support/techdocs/327129.html

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CAN-2005-1842 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

06/27/2005 Initial vendor notification
06/27/2005 Initial vendor response
08/29/2005 Public disclosure

IX. CREDIT

vade79 (http://fakehalo.us) is credited with this discovery.

Get paid for vulnerability research
http://www.idefense.com/poi/teams/vcp.jsp

Free tools, research and upcoming events
http://labs.idefense.com

X. LEGAL NOTICES

Copyright (c) 2005 iDEFENSE, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDEFENSE. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically, please
email customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/


