
Date: Wed, 12 Jan 2005 14:00:08 +0800
From: "Sowhat ." <smaillist@...il.com>
To: bugtraq@...urityfocus.com, full-disclosure@...ts.netsys.com
Subject: TFTPD32 Long FileName Remote Denial of Service


TFTPD32 Long FileName Remote Denial of Service

By Sowhat
12.JAN.2005
http://secway.org/advisory/ad20050108.txt

Product Affected:

TFTPD 2.74 and prior

Impact:
Low


(1) Introduction

TFTPD32 is a bundle including a full featured TFTP server, a TFTP
client, a DHCP server and a Syslog server.
TFTPD32 is designed for Windows 95/NT/2000/XP.
"TFTPD32 recommended by Cisco, HP  and other companies" --From the
author's webpage.

For more information:
http://perso.wanadoo.fr/philippe.jounin/TFTPD32.html

(2) Details
A vulnerability in TFTPD32 may allow remote attackers crash the
TFTPD32 and therefore cause a Denial of Service.

aviram(@)beyondsecurity.com had reported "TFTPD32 Buffer Overflow
Vulnerability (Long filename)" to bugtraq. And it seems that the
author fixed the problem in v2.51.
But during a simple audit,I found that TFTPD32 is still vulnerable to
"Long Filenmae".

C:\Windows\System32>tftp -i 192.168.0.1 get AAAAA...[about 508 'A' here]...AA

The TFTPD32 will print the following error messages 2 times:
"Error:RecvFrom Returns 10040 <"A message sent on a datagram socket
was larger than the internal message buffer or some other network
limit, or the buffer used to receive a datagram into was smaller than
the datagram itself.">"
and then it will dead. 

But this vulnerability seems very unstable and not exploitable.
the TFTPD32 will not dead immediately ,usually 10-15 seconds after the
request,and some times you need to "get" 2-3 times.

(3) Solution

Waitting for the author's update

(4) Author Response

I have sent an email to the author BUT no reply yet.
_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.netsys.com/full-disclosure-charter.html


