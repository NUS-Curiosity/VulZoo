
Date: 17 Oct 2017 19:12:04 +0000
From: security-alert@....com
To: undisclosed-recipients: ;
Subject: [security bulletin] HPESBHF03789 rev.2 - Certain HPE Gen9 Systems
 with HP Trusted Platform Module v2.0 Option, Unauthorized Access to Data

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Note: the current version of the following document is available here:
https://h20564.www2.hpe.com/hpsc/doc/public/display?docId=emr_na-hpesbhf03789en_us

SUPPORT COMMUNICATION - SECURITY BULLETIN

Document ID: hpesbhf03789en_us
Version: 2

HPESBHF03789 rev.2 - Certain HPE Gen9 Systems with HP Trusted Platform Module
v2.0 Option, Unauthorized Access to Data

NOTICE: The information in this Security Bulletin should be acted upon as
soon as possible.

Release Date: 2017-10-18
Last Updated: 2017-10-17

Potential Security Impact: Local: Unauthorized Access to Data; Remote:
Unauthorized Access to Data

Source: Hewlett Packard Enterprise, Product Security Response Team

VULNERABILITY SUMMARY
A potential security vulnerability has been identified in the "HP Trusted
Platform Module 2.0 Option" kit. This optional kit is available for HPE Gen9
systems with firmware version 5.51. The vulnerability in TPM firmware 5.51 is
that new mathematical methods exist such that RSA keys generated by the TPM
2.0 with firmware 5.51 are cryptographically weakened. This vulnerability
could lead to local and remote unauthorized access to data.

**Note:**  

 * The "HP Trusted Platform Module Option" (TPM 1.2) for HPE Gen6 through
Gen9 systems is not affected.

References:

  - PSRT110605
  - PSRT110598
  - CVE-2017-15361

SUPPORTED SOFTWARE VERSIONS*: ONLY impacted versions are listed.

  - HPE Trusted Platform Module 2.0 Kit FW 5.51 - TPM 2.0 FW 5.62 is not
affected.  This is the Gen9 TPM 2.0 option (only Gen9 servers could have this
option). The TPM 2.0 Option for Gen9 servers is not standard on Gen9 servers
- - it is an option.
  - HP ProLiant BL460c Gen9 Server Blade n/a - only if "HPE Trusted Platform
Module 2.0 Kit" w/ FW version 5.51 is installed.
  - HP ProLiant BL660c Gen9 Server n/a - only if "HPE Trusted Platform Module
2.0 Kit" w/ FW version 5.51 is installed.
  - HP ProLiant DL120 Gen9 Server n/a - only if "HPE Trusted Platform Module
2.0 Kit" w/ FW version 5.51 is installed.
  - HP ProLiant DL160 Gen9 Server n/a - only if "HPE Trusted Platform Module
2.0 Kit" w/ FW version 5.51 is installed.
  - HP ProLiant DL360 Gen9 Server n/a - only if "HPE Trusted Platform Module
2.0 Kit" w/ FW version 5.51 is installed.
  - HP ProLiant DL380 Gen9 Server n/a - only if "HPE Trusted Platform Module
2.0 Kit" w/ FW version 5.51 is installed.
  - HP ProLiant DL388 Gen9 Server n/a - only if "HPE Trusted Platform Module
2.0 Kit" w/ FW version 5.51 is installed.
  - HP ProLiant DL580 Gen9 Server n/a - only if "HPE Trusted Platform Module
2.0 Kit" w/ FW version 5.51 is installed.
  - HP ProLiant DL60 Gen9 Server n/a - only if "HPE Trusted Platform Module
2.0 Kit" w/ FW version 5.51 is installed.
  - HP ProLiant DL80 Gen9 Server n/a - only if "HPE Trusted Platform Module
2.0 Kit" w/ FW version 5.51 is installed.
  - HP ProLiant ML110 Gen9 Server n/a - only if "HPE Trusted Platform Module
2.0 Kit" w/ FW version 5.51 is installed.
  - HP ProLiant ML150 Gen9 Server n/a - only if "HPE Trusted Platform Module
2.0 Kit" w/ FW version 5.51 is installed.
  - HPE Apollo 4200 Gen9 Server n/a - only if "HPE Trusted Platform Module
2.0 Kit" w/ FW version 5.51 is installed.
  - HPE ProLiant DL180 Gen9 Server n/a - only if "HPE Trusted Platform Module
2.0 Kit" w/ FW version 5.51 is installed.
  - HPE ProLiant DL180 Gen9 Server n/a - only if "HPE Trusted Platform Module
2.0 Kit" w/ FW version 5.51 is installed.
  - HPE ProLiant DL20 Gen9 Server n/a - only if "HPE Trusted Platform Module
2.0 Kit" w/ FW version 5.51 is installed.
  - HPE ProLiant DL560 Gen9 Server n/a - only if "HPE Trusted Platform Module
2.0 Kit" w/ FW version 5.51 is installed.
  - HPE ProLiant ML10 Gen9 E3-1225 v5 3.3GHz 4-core 8GB-R 1TB Non-hot Plug
4LFF SATA 300W AP Svr/Promo n/a - only if "HPE Trusted Platform Module 2.0
Kit" w/ FW version 5.51 is installed.
  - HPE ProLiant ML10 Gen9 E3-1225 v5 4GB-R 1TB Non-hot Plug 4LFF SATA 300W
Svr/S-Buy n/a - only if "HPE Trusted Platform Module 2.0 Kit" w/ FW version
5.51 is installed.
  - HPE ProLiant ML10 Gen9 E3-1225 v5 8GB-R 1TB Non-hot Plug 4LFF SATA 300W
Perf Svr n/a - only if "HPE Trusted Platform Module 2.0 Kit" w/ FW version
5.51 is installed.
  - HPE ProLiant ML10 Gen9 E3-1225 v5 8GB-R 2TB Non-hot Plug 4LFF SATA 300W
Svr/GO n/a - only if "HPE Trusted Platform Module 2.0 Kit" w/ FW version 5.51
is installed.
  - HPE ProLiant ML10 Gen9 E3-1225 v5 8GB-R 2TB Non-hot Plug 4LFF SATA 300W
Svr/TV n/a - only if "HPE Trusted Platform Module 2.0 Kit" w/ FW version 5.51
is installed.
  - HPE ProLiant ML10 Gen9 G4400 4GB-R Non-hot Plug 4LFF SATA 300W Entry Svr
n/a - only if "HPE Trusted Platform Module 2.0 Kit" w/ FW version 5.51 is
installed.
  - HPE ProLiant ML30 Gen9 Server n/a - only if "HPE Trusted Platform Module
2.0 Kit" w/ FW version 5.51 is installed.
  - HPE ProLiant ML350 Gen9 Server n/a - only if "HPE Trusted Platform Module
2.0 Kit" w/ FW version 5.51 is installed.
  - HPE ProLiant ML350 Gen9 Server n/a - only if "HPE Trusted Platform Module
2.0 Kit" w/ FW version 5.51 is installed.
  - HPE ProLiant XL170r Gen9 Server n/a - only if "HPE Trusted Platform
Module 2.0 Kit" w/ FW version 5.51 is installed.
  - HPE ProLiant XL190r Gen9 Server n/a - only if "HPE Trusted Platform
Module 2.0 Kit" w/ FW version 5.51 is installed.
  - HPE ProLiant XL230a Gen9 Server n/a - only if "HPE Trusted Platform
Module 2.0 Kit" w/ FW version 5.51 is installed.
  - HPE ProLiant XL230a Gen9 Server n/a - only if "HPE Trusted Platform
Module 2.0 Kit" w/ FW version 5.51 is installed.
  - HPE ProLiant XL250a Gen9 Server n/a - only if "HPE Trusted Platform
Module 2.0 Kit" w/ FW version 5.51 is installed.
  - HPE ProLiant XL250a Gen9 Server n/a - only if "HPE Trusted Platform
Module 2.0 Kit" w/ FW version 5.51 is installed.
  - HPE ProLiant XL260a Gen9 Server n/a - only if "HPE Trusted Platform
Module 2.0 Kit" w/ FW version 5.51 is installed.
  - HPE ProLiant XL450 Gen9 Server n/a - only if "HPE Trusted Platform Module
2.0 Kit" w/ FW version 5.51 is installed.
  - HPE ProLiant XL730f Gen9 Server n/a - only if "HPE Trusted Platform
Module 2.0 Kit" w/ FW version 5.51 is installed.
  - HPE ProLiant XL730f Gen9 Server n/a - only if "HPE Trusted Platform
Module 2.0 Kit" w/ FW version 5.51 is installed.
  - HPE ProLiant XL740f Gen9 Server n/a - only if "HPE Trusted Platform
Module 2.0 Kit" w/ FW version 5.51 is installed.
  - HPE ProLiant XL740f Gen9 Server n/a - only if "HPE Trusted Platform
Module 2.0 Kit" w/ FW version 5.51 is installed.
  - HPE ProLiant XL750f Gen9 Server n/a - only if "HPE Trusted Platform
Module 2.0 Kit" w/ FW version 5.51 is installed.
  - HPE ProLiant XL750f Gen9 Server n/a - only if "HPE Trusted Platform
Module 2.0 Kit" w/ FW version 5.51 is installed.

BACKGROUND

  CVSS Base Metrics
  =================
  Reference, CVSS V3 Score/Vector, CVSS V2 Score/Vector

    CVE-2017-15361
      7.4 CVSS:3.0/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
      6.2 (AV:L/AC:H/Au:N/C:C/I:C/A:C)

    Information on CVSS is documented in
    HPE Customer Notice HPSN-2008-002 here:

https://h20564.www2.hpe.com/hpsc/doc/public/display?docId=emr_na-c01345499

RESOLUTION

HPE has provided both an updated system ROM, and updated TPM firmware to
correct this issue for impacted systems. Update the system ROM and "HPE
Trusted Platform Module 2.0 Option" to firmware version 5.62 or subsequent. 

The latest version of the System ROM is available, and must be updated before
updating the TPM firmware. Use these instructions:

1.Click the following link: 

 * <http://www.hpe.com/support/hpesc>

2.Enter a product name (e.g., "DL380 Gen9") in the text field under Enter a
Product Name or Number.  
3.Click Go.  
4.Select the appropriate product model from the Results list (if prompted).  
5.Click the "drivers, software & firmware" hyperlink under the Download
Options tab.  
6.Select the system's specific operating system from the Operating Systems
dropdown menu.  
7.Click the category BIOS - System ROM.  
8.Select the latest release of HPE System ROM Version 2.50 (or later).  
9.Click Download.  


The latest version of the TPM firmware is available. Use these instructions:

 1.Click the following link:

 * <http://www.hpe.com/support/hpesc>

 2.Enter a product name (e.g., "DL380 Gen9") in the text field under Enter a
Product Name or Number.  
 3.Click Go.  
 4.Select the appropriate product model from the Results list (if prompted). 

 5.Click the "drivers, software & firmware" hyperlink under the Download
Options tab.  
 6.Select the system's specific operating system from the Operating Systems
dropdown menu.  
 7.Click the category Firmware.  
 8.Select the latest release of the HPE Trusted Platform Module 2.0 Option
firmware update for HPE Gen9 Severs Version 5.62 (or later).  
 9.Click Download.  

**Note:** 

 * After the firmware upgrade, the TPM will generate RSA keys using an
improved algorithm. Revoking the weak TPM generated RSA keys will still be
required. Refer to the OS documentation for OS-specific instructions. In
addition, a System ROM update to version 2.50 (or later) is required before
updating the TPM 2.0 firmware.
 
 * Please refer to the HPE *Customer Bulletin* as well:
  
   - **HPE ProLiant Gen9 Servers** - Potential Vulnerability in the HPE
Trusted Platform Module 2.0 Option Firmware Version 5.51 for HPE ProLiant
Gen9 Servers
<http://h20565.www2.hpe.com/hpsc/doc/public/display?docId=a00028289en_us>

HISTORY

Version:1 (rev.1) - 16 October 2017 Initial release

Version:2 (rev.2) - 17 October 2017 Added CVE reference


Third Party Security Patches: Third party security patches that are to be
installed on systems running Hewlett Packard Enterprise (HPE) software
products should be applied in accordance with the customer's patch management
policy.

Support: For issues about implementing the recommendations of this Security
Bulletin, contact normal HPE Services support channel. For other issues about
the content of this Security Bulletin, send e-mail to security-alert@....com.

Report: To report a potential security vulnerability for any HPE supported
product:
  Web form: https://www.hpe.com/info/report-security-vulnerability
  Email: security-alert@....com

Subscribe: To initiate a subscription to receive future HPE Security Bulletin
alerts via Email: http://www.hpe.com/support/Subscriber_Choice

Security Bulletin Archive: A list of recently released Security Bulletins is
available here: http://www.hpe.com/support/Security_Bulletin_Archive

Software Product Category: The Software Product Category is represented in
the title by the two characters following HPSB.

3C = 3COM
3P = 3rd Party Software
GN = HPE General Software
HF = HPE Hardware and Firmware
MU = Multi-Platform Software
NS = NonStop Servers
OV = OpenVMS
PV = ProCurve
ST = Storage Software
UX = HP-UX

Copyright 2016 Hewlett Packard Enterprise

Hewlett Packard Enterprise shall not be liable for technical or editorial
errors or omissions contained herein. The information provided is provided
"as is" without warranty of any kind. To the extent permitted by law, neither
HP or its affiliates, subcontractors or suppliers will be liable for
incidental,special or consequential damages including downtime cost; lost
profits; damages relating to the procurement of substitute products or
services; or damages for loss of data, or software restoration. The
information in this document is subject to change without notice. Hewlett
Packard Enterprise and the names of Hewlett Packard Enterprise products
referenced herein are trademarks of Hewlett Packard Enterprise in the United
States and other countries. Other product and company names mentioned herein
may be trademarks of their respective owners.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQEcBAEBCAAGBQJZ5k72AAoJELXhAxt7SZaiU4EIAKJK3i30Qui8Fqm7/Kr5R/oB
UgW8kg/4EkbEpJ7ewQwjE2gaIMUmo6q2we+mpLU3/4T8+ZcZgxw7hDZqOrOn7V08
rzchXK1oLqdW9vu0BlWrUK6TTWHghW38nwqLHhmxuRavrVR4kYB+ctfFUS3vaSVd
eQWBn6coSrkeToazgtvlPilChl1ygH4NITmLBXPnSbcp8U1yLhF+j0eUKLcZnR8l
OMi65CVCNWCcSL3NV6x4NXvREmehKXGqgokGUe6rBWucU+A21W66GhsnhC5ysa4j
SR8Ungf0W1QihfW3+Jijiu5hC7mrcZrGi+AZAvJDb4S5zvfM+hVUZNuEGa6nzVM=
=KoaT
-----END PGP SIGNATURE-----
