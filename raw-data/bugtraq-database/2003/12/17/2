
Date: Wed, 17 Dec 2003 13:03:14 +0100
From: OpenPKG <openpkg@...npkg.org>
To: bugtraq@...urityfocus.com
Subject: [OpenPKG-SA-2003.053] OpenPKG Security Advisory (lftp)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

________________________________________________________________________

OpenPKG Security Advisory                            The OpenPKG Project
http://www.openpkg.org/security.html              http://www.openpkg.org
openpkg-security@...npkg.org                         openpkg@...npkg.org
OpenPKG-SA-2003.053                                          17-Dec-2003
________________________________________________________________________

Package:             lftp
Vulnerability:       arbitrary code execution
OpenPKG Specific:    no

Affected Releases:   Affected Packages:          Corrected Packages:
OpenPKG CURRENT      <= lftp-2.6.9-20031120      >= lftp-2.6.10-20031211
OpenPKG 1.3          <= lftp-2.6.6-1.3.0         >= lftp-2.6.6-1.3.1
OpenPKG 1.2          <= lftp-2.6.4-1.2.0         >= lftp-2.6.4-1.2.1

Dependent Packages:  none

Description:
  According to a security advisory from Ulf HÃ¤rnhammar [0], a buffer
  overflow bug exists in the FTP/HTTP/HTTPS client LFTP [1] bug in
  versions up to and including 2.6.9. An attacker could create a
  carefully crafted directory on a website such that, if a user connects
  to that directory using the LFTP client and subsequently issues a "ls"
  or "rels" command, the attacker could execute arbitrary code on the
  users machine. The Common Vulnerabilities and Exposures (CVE) project
  assigned the id CAN-2003-0963 [2] to the problem.

  Please check whether you are affected by running "<prefix>/bin/rpm -q
  lftp". If you have the "lftp" package installed and its version is
  affected (see above), we recommend that you immediately upgrade it
  (see Solution) [3][4].

Solution:
  Select the updated source RPM appropriate for your OpenPKG release
  [5][6], fetch it from the OpenPKG FTP service [7][8] or a mirror
  location, verify its integrity [9], build a corresponding binary RPM
  from it [3] and update your OpenPKG installation by applying the binary
  RPM [4]. For the current release OpenPKG 1.3, perform the following
  operations to permanently fix the security problem (for other releases
  adjust accordingly).

  $ ftp ftp.openpkg.org
  ftp> bin
  ftp> cd release/1.3/UPD
  ftp> get lftp-2.6.6-1.3.1.src.rpm
  ftp> bye
  $ <prefix>/bin/rpm -v --checksig lftp-2.6.6-1.3.1.src.rpm
  $ <prefix>/bin/rpm --rebuild lftp-2.6.6-1.3.1.src.rpm
  $ su -
  # <prefix>/bin/rpm -Fvh <prefix>/RPM/PKG/lftp-2.6.6-1.3.1.*.rpm
________________________________________________________________________

References:
  [0] http://www.securityfocus.com/archive/1/347587/2003-12-13/2003-12-19/0
  [1] http://lftp.yar.ru/
  [2] http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2003-0963
  [3] http://www.openpkg.org/tutorial.html#regular-source
  [4] http://www.openpkg.org/tutorial.html#regular-binary
  [5] ftp://ftp.openpkg.org/release/1.2/UPD/lftp-2.6.4-1.2.1.src.rpm
  [6] ftp://ftp.openpkg.org/release/1.3/UPD/lftp-2.6.6-1.3.1.src.rpm
  [7] ftp://ftp.openpkg.org/release/1.2/UPD/
  [8] ftp://ftp.openpkg.org/release/1.3/UPD/
  [9] http://www.openpkg.org/security.html#signature
________________________________________________________________________

For security reasons, this advisory was digitally signed with the
OpenPGP public key "OpenPKG <openpkg@...npkg.org>" (ID 63C4CB9F) of the
OpenPKG project which you can retrieve from http://pgp.openpkg.org and
hkp://pgp.openpkg.org. Follow the instructions on http://pgp.openpkg.org/
for details on how to verify the integrity of this advisory.
________________________________________________________________________

-----BEGIN PGP SIGNATURE-----
Comment: OpenPKG <openpkg@...npkg.org>

iD8DBQE/4ES3gHWT4GPEy58RAhWvAJ0XtJea7vqBrAx9OfsWiUNlLBVn0QCgub7I
eKC4m/yFGSRs+3syLFg26U0=
=5dTH
-----END PGP SIGNATURE-----


