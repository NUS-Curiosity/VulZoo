
Date: Wed, 10 Dec 2003 22:09 -0500
From: bugzilla@...hat.com
To: redhat-watch-list@...hat.com, bugtraq@...urityfocus.com,
	full-disclosure@...ts.netsys.com
Subject: [RHSA-2003:390-01] Updated gnupg packages disable ElGamal keys


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- ---------------------------------------------------------------------
                   Red Hat Security Advisory

Synopsis:          Updated gnupg packages disable ElGamal keys
Advisory ID:       RHSA-2003:390-01
Issue date:        2003-12-10
Updated on:        2003-12-10
Product:           Red Hat Linux
Keywords:          gnupg elgamal sign encrypt
Cross references:  
Obsoletes:         RHSA-2003-175 RHSA-2001:073 RHSA-2001:063
CVE Names:         CAN-2003-0971
- ---------------------------------------------------------------------

1. Topic:

Updated gnupg packages are now available for Red Hat Linux.  These updates
disable the ability to generate ElGamal keys (used for both signing and
encrypting) and disable the ability to use ElGamal public keys for
encrypting data.

2. Relevant releases/architectures:

Red Hat Linux 7.1 - i386
Red Hat Linux 7.2 - i386, ia64
Red Hat Linux 7.3 - i386
Red Hat Linux 8.0 - i386
Red Hat Linux 9 - i386

3. Problem description:

GnuPG is a utility for encrypting data and creating digital signatures.

Phong Nguyen identified a severe bug in the way GnuPG creates and uses
ElGamal keys, when those keys are used both to sign and encrypt data.  This
vulnerability can be used to trivially recover the private key.  While the
default behavior of GnuPG when generating keys does not lead to the
creation of unsafe keys, by overriding the default settings an unsafe key
could have been created.

If you are using ElGamal keys, you should revoke those keys immediately.

The packages included in this update do not make ElGamal keys safe to use;
they merely include a patch by David Shaw that disables functions that
would generate or use ElGamal keys.

To determine if your key is affected, run the following command to obtain a
list of secret keys that you have on your secret keyring:

gpg --list-secret-keys

The output of this command includes both the size and type of the keys
found, and will look similar to this example:

/home/example/.gnupg/secring.gpg
- ----------------------------------------------------
sec  1024D/01234567 2000-10-17 Example User <example@...mple.com>
uid                            Example User <example@...mple.com>

The key length, type, and ID are listed together, separated by a forward
slash.  In the example output above, the key's type is "D" (DSA, sign
and encrypt).  Your key is unsafe if and only if the key type is "G"
(ElGamal, sign and encrypt).  In the above example, the secret key is safe
to use, while the secret key in the following example is not:

/home/example/.gnupg/secring.gpg
- ----------------------------------------------------
sec  1024G/01234567 2000-10-17 Example User <example@...mple.com>
uid                            Example User <example@...mple.com>

For more details regarding this issue, as well as instructions on how to
revoke any keys that are unsafe, refer to the advisory available from the
GnuPG web site:

http://www.gnupg.org/

4. Solution:

Before applying this update, make sure all previously released errata
relevant to your system have been applied.

To update all RPMs for your particular architecture, run:

rpm -Fvh [filenames]

where [filenames] is a list of the RPMs you wish to upgrade.  Only those
RPMs which are currently installed will be updated.  Those RPMs which are
not installed but included in the list will not be updated.  Note that you
can also use wildcards (*.rpm) if your current directory *only* contains
the desired RPMs.

Please note that this update is also available via Red Hat Network.  Many
people find this an easier way to apply updates.  To use Red Hat Network,
launch the Red Hat Update Agent with the following command:

up2date

This will start an interactive process that will result in the appropriate
RPMs being upgraded on your system.

If up2date fails to connect to Red Hat Network due to SSL Certificate 
Errors, you need to install a version of the up2date client with an updated 
certificate.  The latest version of up2date is available from the Red Hat 
FTP site and may also be downloaded directly from the RHN website:

https://rhn.redhat.com/help/latest-up2date.pxt

5. RPMs required:

Red Hat Linux 7.1:

SRPMS:
ftp://updates.redhat.com/7.1/en/os/SRPMS/gnupg-1.0.7-12.src.rpm

i386:
ftp://updates.redhat.com/7.1/en/os/i386/gnupg-1.0.7-12.i386.rpm

Red Hat Linux 7.2:

SRPMS:
ftp://updates.redhat.com/7.2/en/os/SRPMS/gnupg-1.0.7-13.src.rpm

i386:
ftp://updates.redhat.com/7.2/en/os/i386/gnupg-1.0.7-13.i386.rpm

ia64:
ftp://updates.redhat.com/7.2/en/os/ia64/gnupg-1.0.7-13.ia64.rpm

Red Hat Linux 7.3:

SRPMS:
ftp://updates.redhat.com/7.3/en/os/SRPMS/gnupg-1.0.7-13.src.rpm

i386:
ftp://updates.redhat.com/7.3/en/os/i386/gnupg-1.0.7-13.i386.rpm

Red Hat Linux 8.0:

SRPMS:
ftp://updates.redhat.com/8.0/en/os/SRPMS/gnupg-1.0.7-14.src.rpm

i386:
ftp://updates.redhat.com/8.0/en/os/i386/gnupg-1.0.7-14.i386.rpm

Red Hat Linux 9:

SRPMS:
ftp://updates.redhat.com/9/en/os/SRPMS/gnupg-1.2.1-9.src.rpm

i386:
ftp://updates.redhat.com/9/en/os/i386/gnupg-1.2.1-9.i386.rpm



6. Verification:

MD5 sum                          Package Name
- --------------------------------------------------------------------------
4d62554490e85b7cc1f0cfef6518a979 7.1/en/os/SRPMS/gnupg-1.0.7-12.src.rpm
0591a2079aff5e7979b0225b568bceaa 7.1/en/os/i386/gnupg-1.0.7-12.i386.rpm
b619c30c293094d7dcd18487d8e62a43 7.2/en/os/SRPMS/gnupg-1.0.7-13.src.rpm
e7e3e75afd1ccd2267ccc7847c76ebb4 7.2/en/os/i386/gnupg-1.0.7-13.i386.rpm
6fb21011ca42ff395b8cfc7dce4c2936 7.2/en/os/ia64/gnupg-1.0.7-13.ia64.rpm
b619c30c293094d7dcd18487d8e62a43 7.3/en/os/SRPMS/gnupg-1.0.7-13.src.rpm
e7e3e75afd1ccd2267ccc7847c76ebb4 7.3/en/os/i386/gnupg-1.0.7-13.i386.rpm
bc375882f13e5c10eb29eb3615de911d 8.0/en/os/SRPMS/gnupg-1.0.7-14.src.rpm
a3de0844778cd994258f121330ff6d62 8.0/en/os/i386/gnupg-1.0.7-14.i386.rpm
e1f31f4a07ebb5b4040f8f6ca3816cc4 9/en/os/SRPMS/gnupg-1.2.1-9.src.rpm
604a2fb5b809ec99280871f46507f4a1 9/en/os/i386/gnupg-1.2.1-9.i386.rpm


These packages are GPG signed by Red Hat for security.  Our key is
available from https://www.redhat.com/security/keys.html

You can verify each package with the following command:
    
    rpm --checksig -v <filename>

If you only wish to verify that each package has not been corrupted or
tampered with, examine only the md5sum with the following command:
    
    md5sum <filename>


7. References:

http://lists.gnupg.org/pipermail/gnupg-announce/2003q4/000276.html
http://lists.gnupg.org/pipermail/gnupg-users/2003-November/020779.html
http://lists.gnupg.org/pipermail/gnupg-announce/2003q4/000277.html
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2003-0971

8. Contact:

The Red Hat security contact is <secalert@...hat.com>.  More contact
details at https://www.redhat.com/solutions/security/news/contact.html

Copyright 2003 Red Hat, Inc.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.0.7 (GNU/Linux)

iD8DBQE/19/bXlSAg2UNWIIRApHAAKDDT9iYhOHv0ld977q+en9pERGINgCffIEe
p12aGFwXHe+nF62Bq5NPSGk=
=/+7o
-----END PGP SIGNATURE-----


_______________________________________________
Redhat-watch-list mailing list
To unsubscribe, visit: https://www.redhat.com/mailman/listinfo/redhat-watch-list


