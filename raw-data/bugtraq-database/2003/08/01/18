
Date: Thu, 31 Jul 2003 21:57:30 -0400
From: Matt Zimmerman <mdz@...ian.org>
To: bugtraq@...urityfocus.com
Subject: [SECURITY] [DSA-358-1] New kernel source and i386, alpha kernel images fix multiple vulnerabilities


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- --------------------------------------------------------------------------
Debian Security Advisory DSA 358-1                     security@...ian.org
http://www.debian.org/security/                             Matt Zimmerman
July 31st, 2003                         http://www.debian.org/security/faq
- --------------------------------------------------------------------------

Package        : linux-kernel-i386, linux-kernel-alpha
Vulnerability  : several
Problem-Type   : local, remote
Debian-specific: no
CVE Ids        : CAN-2003-0461, CAN-2003-0462, CAN-2003-0476,
  CAN-2003-0501, CAN-2003-0550, CAN-2003-0551, CAN-2003-0552,
  CAN-2003-0018, CAN-2003-0619

A number of vulnerabilities have been discovered in the Linux kernel.

- - CAN-2003-0461: /proc/tty/driver/serial in Linux 2.4.x reveals the
  exact number of characters used in serial links, which could allow
  local users to obtain potentially sensitive information such as the
  length of passwords.  This bug has been fixed by restricting access
  to /proc/tty/driver/serial.

- - CAN-2003-0462: A race condition in the way env_start and env_end
  pointers are initialized in the execve system call and used in
  fs/proc/base.c on Linux 2.4 allows local users to cause a denial of
  service (crash).

- - CAN-2003-0476: The execve system call in Linux 2.4.x records the
  file descriptor of the executable process in the file table of the
  calling process, which allows local users to gain read access to
  restricted file descriptors.

- - CAN-2003-0501: The /proc filesystem in Linux allows local users to
  obtain sensitive information by opening various entries in
  /proc/self before executing a setuid program, which causes the
  program to fail to change the ownership and permissions of those
  entries.

- - CAN-2003-0550: The STP protocol, as enabled in Linux 2.4.x, does not
  provide sufficient security by design, which allows attackers to
  modify the bridge topology.  This bug has been fixed by disabling
  STP by default.

- - CAN-2003-0551: The STP protocol, as enabled in Linux 2.4.x, does not
  provide sufficient security by design, which allows attackers to
  modify the bridge topology.

- - CAN-2003-0552: Linux 2.4.x allows remote attackers to spoof the
  bridge forwarding table via forged packets whose source addresses
  are the same as the target.

- - CAN-2003-0018: Linux kernel 2.4.10 through 2.4.21-pre4 does not
  properly handle the O_DIRECT feature, which allows local attackers
  with write privileges to read portions of previously deleted files,
  or cause file system corruption.  This bug has been fixed by
  disabling O_DIRECT.

- - CAN-2003-0619: Integer signedness error in the decode_fh function of
  nfs3xdr.c in Linux kernel before 2.4.21 allows remote attackers to
  cause a denial of service (kernel panic) via a negative size value
  within XDR data of an NFSv3 procedure call.

This advisory covers only the i386 and alpha architectures.  Other
architectures will be covered by separate advisories.

For the stable distribution (woody) on the i386 architecture, these
problems have been fixed in kernel-source-2.4.18 version 2.4.18-11,
kernel-image-2.4.18-1-i386 version 2.4.18-9, and
kernel-image-2.4.18-i386bf version 2.4.18-5woody2.

For the stable distribution (woody) on the alpha architecture, these
problems have been fixed in kernel-source-2.4.18 version 2.4.18-11 and
kernel-image-2.4.18-1-alpha version 2.4.18-8.

For the unstable distribution (sid) these problems are fixed in
kernel-source-2.4.20 version 2.4.20-9.

We recommend that you update your kernel packages.

If you are using the kernel installed by the installation system when
the "bf24" option is selected (for a 2.4.x kernel), you should install
the kernel-image-2.4.18-bf2.4 package.  If you installed a different
kernel-image package after installation, you should install the
corresponding 2.4.18-1 kernel.  You may use the table below as a
guide.

| If "uname -r" shows: | Install this package:
- ------------------------------------------------------
| 2.4.18-bf2.4         | kernel-image-2.4.18-bf2.4
| 2.4.18-386           | kernel-image-2.4.18-1-386
| 2.4.18-586tsc        | kernel-image-2.4.18-1-586tsc
| 2.4.18-686           | kernel-image-2.4.18-1-686
| 2.4.18-686-smp       | kernel-image-2.4.18-1-686-smp
| 2.4.18-k6            | kernel-image-2.4.18-1-k6
| 2.4.18-k7            | kernel-image-2.4.18-1-k7

NOTE: that this kernel is binary compatible with the previous kernel
security update, but not binary compatible with the corresponding
kernel included in Debian 3.0r1.  If you have not already applied the
previous security update (kernel-image-2.4.18-bf2.4 version
2.4.18-5woody1 or any of the 2.4.18-1-* kernels), then any custom
modules will need to be rebuilt in order to work with the new kernel.
New PCMCIA modules are provided for all of the above kernels.

NOTE: A system reboot will be required immediately after the upgrade
in order to replace the running kernel.  Remember to read carefully
and follow the instructions given during the kernel upgrade process.

Upgrade Instructions
- --------------------

wget url
        will fetch the file for you
dpkg -i file.deb
        will install the referenced file.

If you are using the apt-get package manager, use the line for
sources.list as given below:

apt-get update
        will update the internal database
apt-get upgrade
        will install corrected packages

You may use an automated update by adding the resources from the
footer to the proper configuration.

Debian GNU/Linux 3.0 alias woody
- --------------------------------

  Source archives:

    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-image-2.4.18-1-i386_2.4.18-9.dsc
      Size/MD5 checksum:     1323 a52f99a769d129819d6c8ada3c5045c6
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-image-2.4.18-1-i386_2.4.18-9.tar.gz
      Size/MD5 checksum:    69606 e21b5ef20e4c7af4e455933df9ee4166
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-i386bf/kernel-image-2.4.18-i386bf_2.4.18-5woody2.dsc
      Size/MD5 checksum:      654 ca1be1a797c9e30e263374955dd77b0f
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-i386bf/kernel-image-2.4.18-i386bf_2.4.18-5woody2.tar.gz
      Size/MD5 checksum:    25822 602dd83e5607dd6b6ee5cf86e16790e5
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-alpha/kernel-image-2.4.18-1-alpha_2.4.18-8.dsc
      Size/MD5 checksum:      872 fcc88e846f61f02cf4fa27edf702a4db
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-alpha/kernel-image-2.4.18-1-alpha_2.4.18-8.tar.gz
      Size/MD5 checksum:    24061 beeb0146a914281de11f7439179956c0
    http://security.debian.org/pool/updates/main/k/kernel-source-2.4.18/kernel-source-2.4.18_2.4.18-11.dsc
      Size/MD5 checksum:      798 cf43f98322e7a024b16e06dc1f0f83eb
    http://security.debian.org/pool/updates/main/k/kernel-source-2.4.18/kernel-source-2.4.18_2.4.18-11.diff.gz
      Size/MD5 checksum:    66571 b19259c1b01f075a457b58610ee3f8b8
    http://security.debian.org/pool/updates/main/k/kernel-source-2.4.18/kernel-source-2.4.18_2.4.18.orig.tar.gz
      Size/MD5 checksum: 29818323 24b4c45a04a23eb4ce465eb326a6ddf2

  Intel IA-32 architecture:

    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-headers-2.4.18-1_2.4.18-9_i386.deb
      Size/MD5 checksum:  3397958 767768d092247730a5506c97f4f6c6c7
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-headers-2.4.18-1-386_2.4.18-9_i386.deb
      Size/MD5 checksum:  3487150 3c296013374ffefcbdb0de781c6fd5ce
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-headers-2.4.18-1-586tsc_2.4.18-9_i386.deb
      Size/MD5 checksum:  3487900 7b262d0e0204b184aaaf1e13f7702907
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-headers-2.4.18-1-686_2.4.18-9_i386.deb
      Size/MD5 checksum:  3488158 f51ebc4199c4813bd48ea0992acd6f93
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-headers-2.4.18-1-686-smp_2.4.18-9_i386.deb
      Size/MD5 checksum:  3489144 352f0331aaa6deb1775228535f88f282
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-headers-2.4.18-1-k6_2.4.18-9_i386.deb
      Size/MD5 checksum:  3487710 ea9a4d1feb084a5c696137b6bd34462e
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-headers-2.4.18-1-k7_2.4.18-9_i386.deb
      Size/MD5 checksum:  3487954 21e564dd78bedb789815bd52194d3ff4
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-image-2.4.18-1-386_2.4.18-9_i386.deb
      Size/MD5 checksum:  8797484 bbcf9f3824f23ec474ac7759fb854cc3
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-image-2.4.18-1-586tsc_2.4.18-9_i386.deb
      Size/MD5 checksum:  8704368 290e78d252a322a787c561e03b23cc15
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-image-2.4.18-1-686_2.4.18-9_i386.deb
      Size/MD5 checksum:  8702946 4087ed6ff51dd349071dff3eeee77b15
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-image-2.4.18-1-686-smp_2.4.18-9_i386.deb
      Size/MD5 checksum:  8959820 77d9fc68ae40ee66ee08227adfd2a68d
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-image-2.4.18-1-k6_2.4.18-9_i386.deb
      Size/MD5 checksum:  8661146 3c50481605daabde929aad5340fa9178
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-image-2.4.18-1-k7_2.4.18-9_i386.deb
      Size/MD5 checksum:  8862884 2ad9fef313514a07f876eef1a6b982d8
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-pcmcia-modules-2.4.18-1-386_2.4.18-9_i386.deb
      Size/MD5 checksum:   228132 83b331acd31e5fc0de4b8da9fa9cf8e3
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-pcmcia-modules-2.4.18-1-586tsc_2.4.18-9_i386.deb
      Size/MD5 checksum:   227688 6b66326ceae1d564ea51bbeeb7e3d919
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-pcmcia-modules-2.4.18-1-686_2.4.18-9_i386.deb
      Size/MD5 checksum:   227144 fde12cbb05c113ae7dd3ffd4e2c552ff
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-pcmcia-modules-2.4.18-1-686-smp_2.4.18-9_i386.deb
      Size/MD5 checksum:   230818 db88f6cb1cf65c7435e6392e8bc3504d
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-pcmcia-modules-2.4.18-1-k6_2.4.18-9_i386.deb
      Size/MD5 checksum:   226792 72bfd4693f7bfaa939f7896258de33da
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-i386/kernel-pcmcia-modules-2.4.18-1-k7_2.4.18-9_i386.deb
      Size/MD5 checksum:   230044 b27f6542766c03879409bba79bb716a8
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-i386bf/kernel-headers-2.4.18-bf2.4_2.4.18-5woody2_i386.deb
      Size/MD5 checksum:  3395196 a992ad938bd5cbeabfc22a59871965c4
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-i386bf/kernel-image-2.4.18-bf2.4_2.4.18-5woody2_i386.deb
      Size/MD5 checksum:  6424624 3c1918455da20eb109cf016bead1fbd2

  Alpha architecture:

    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-alpha/kernel-headers-2.4.18-1_2.4.18-8_alpha.deb
      Size/MD5 checksum:  3333278 8477964689288e4b74a26ee7250eb2b8
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-alpha/kernel-headers-2.4.18-1-generic_2.4.18-8_alpha.deb
      Size/MD5 checksum:  3474414 af8fce811647795e67f54f44b2721e71
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-alpha/kernel-headers-2.4.18-1-smp_2.4.18-8_alpha.deb
      Size/MD5 checksum:  3476688 e7f09e05a0b5522c662e745e43fd6724
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-alpha/kernel-image-2.4.18-1-generic_2.4.18-8_alpha.deb
      Size/MD5 checksum: 12425942 e95bbf7ede7553c6e514b8b153aa2e27
    http://security.debian.org/pool/updates/main/k/kernel-image-2.4.18-1-alpha/kernel-image-2.4.18-1-smp_2.4.18-8_alpha.deb
      Size/MD5 checksum: 12799024 fbbbfb33c90c0816b01dba537e85df5e

  Architecture independent components:

    http://security.debian.org/pool/updates/main/k/kernel-source-2.4.18/kernel-doc-2.4.18_2.4.18-11_all.deb
      Size/MD5 checksum:  1710260 16dd8f969b5a174083966d806226f27c
    http://security.debian.org/pool/updates/main/k/kernel-source-2.4.18/kernel-source-2.4.18_2.4.18-11_all.deb
      Size/MD5 checksum: 23886666 2bb0bcc7083d69962ac9875541b15d06

  These files will probably be moved into the stable distribution on
  its next revision.

- ---------------------------------------------------------------------------------
For apt-get: deb http://security.debian.org/ stable/updates main
For dpkg-ftp: ftp://security.debian.org/debian-security dists/stable/updates/main
Mailing list: debian-security-announce@...ts.debian.org
Package info: `apt-cache show <pkg>' and http://packages.debian.org/<pkg>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.2 (GNU/Linux)

iD8DBQE/Kci4ArxCt0PiXR4RAhCXAKDDcmhkAyWAJFg3R7k9oYskrXwQ3ACgpsrw
P1Nug+TilsOeIDBfV/smPDc=
=Mi3e
-----END PGP SIGNATURE-----



