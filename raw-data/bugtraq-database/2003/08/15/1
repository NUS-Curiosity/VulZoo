
Date: Thu, 14 Aug 2003 15:00:06 -0700
From: SGI Security Coordinator <agent99@....com>
To: agent99@....com
Cc: bugtraq@...urityfocus.com, full-disclosure@...ts.netsys.com,
   vulnwatch@...nwatch.org
Subject: Checkpoint/Restart Vulnerability on IRIX


-----BEGIN PGP SIGNED MESSAGE-----

______________________________________________________________________________
                           SGI Security Advisory

  Title     : Checkpoint/Restart Vulnerability
  Number    : 20030802-01-P
  Date      : August 14, 2003
  Reference : CVE CAN-2003-0679
  Reference : SGI BUG 894920
  Fixed in  : IRIX 6.5.22 or patches 5264 through 5269
______________________________________________________________________________

SGI provides this information freely to the SGI user community for its
consideration, interpretation, implementation and use.  SGI recommends that
this information be acted upon as soon as possible.

SGI provides the information in this Security Advisory on an "AS-IS" basis
only, and disclaims all warranties with respect thereto, express, implied
or otherwise, including, without limitation, any warranty of merchantability
or fitness for a particular purpose.  In no event shall SGI be liable for
any loss of profits, loss of business, loss of data or for any indirect,
special, exemplary, incidental or consequential damages of any kind arising
from your use of, failure to use or improper use of any of the instructions
or information in this Security Advisory.
______________________________________________________________________________

- -----------------------
- --- Issue Specifics ---
- -----------------------

It has been reported that the checkpoint/restart (cpr) system has a security
vulnerability whereby normal users can truncate or overwrite certain files
for which they do not have appropriate permissions.

A local account on the system would be required to exploit this vulnerability.

The vulnerability exists within the 32 bit and 64 bit versions of the libcpr
library and therefore binaries that load that library may exhibit the
vulnerability.

SGI has investigated the issue and recommends the following steps for
neutralizing the exposure.  It is HIGHLY RECOMMENDED that these measures be
implemented on ALL vulnerable SGI systems.

These issues have been corrected with patches and in future releases of IRIX.


- --------------
- --- Impact ---
- --------------

The 32 bit versions of libcpr are installed by default on IRIX 6.5 systems
as part of the optional eoe.sw.cpr package.  The 64 bit version is part of
the optional eoe.sw64.lib package which is installed by default on 64 bit
systems.

To determine the version of IRIX you are running, execute the following
command:

  # /bin/uname -R

That will return a result similar to the following:

  # 6.5 6.5.19f

The first number ("6.5") is the release name, the second ("6.5.16f" in this
case) is the extended release name.  The extended release name is the
"version" we refer to throughout this document.

To see if the 32 bit versions of the libcpr library are installed, execute
the following command:

  % versions eoe.sw.cpr
  I = Installed, R = Removed

     Name                 Date        Description

     I  eoe                  05/18/2003  IRIX Execution Environment, 6.5.20f
     I  eoe.sw               05/18/2003  IRIX Execution Environment Software
     I  eoe.sw.cpr           05/18/2003  SGI Checkpoint-Restart Software


To check for the 64 bit versions:

  % versions eoe.sw64.lib
  I = Installed, R = Removed

     Name                 Date        Description

     I  eoe                  05/18/2003  IRIX Execution Environment, 6.5.20f
     I  eoe.sw64             05/18/2003  EOE 64bit Libraries
     I  eoe.sw64.lib         05/18/2003  IRIX 64bit Libraries

If the output is similar to the above, then libcpr is installed and the
system may be vulnerable.

- ----------------------------
- --- Temporary Workaround ---
- ----------------------------

SGI understands that there are times when upgrading the operating system or
installing patches are inconvenient or not possible.  In those instances, we
recommend the following workaround:

Remove the checkpoint / restart system by doing "versions remove eoe.sw.cpr"
If the eoe.sw64.lib package is installed, it should be removed with
"versions remove eoe.sw64.lib"

Of course after doing that, cpr services will no longer be available.


- ----------------
- --- Solution ---
- ----------------

SGI has provided a series of patches for these vulnerabilities. Our
recommendation is to upgrade to IRIX 6.5.22 (when available), or install the
appropriate patch.

   OS Version     Vulnerable?     Patch #      Other Actions
   ----------     -----------     -------      -------------
   IRIX 3.x        unknown                     Note 1
   IRIX 4.x        unknown                     Note 1
   IRIX 5.x        unknown                     Note 1
   IRIX 6.0.x      unknown                     Note 1
   IRIX 6.1        unknown                     Note 1
   IRIX 6.2        unknown                     Note 1
   IRIX 6.3        unknown                     Note 1
   IRIX 6.4        unknown                     Note 1
   IRIX 6.5          yes                       Notes 2 & 3
   IRIX 6.5.1        yes                       Notes 2 & 3
   IRIX 6.5.2        yes                       Notes 2 & 3
   IRIX 6.5.3        yes                       Notes 2 & 3
   IRIX 6.5.4        yes                       Notes 2 & 3
   IRIX 6.5.5        yes                       Notes 2 & 3
   IRIX 6.5.6        yes                       Notes 2 & 3
   IRIX 6.5.7        yes                       Notes 2 & 3
   IRIX 6.5.8        yes                       Notes 2 & 3
   IRIX 6.5.9        yes                       Notes 2 & 3
   IRIX 6.5.10       yes                       Notes 2 & 3
   IRIX 6.5.11       yes                       Notes 2 & 3
   IRIX 6.5.12       yes                       Notes 2 & 3
   IRIX 6.5.13       yes                       Notes 2 & 3
   IRIX 6.5.14       yes                       Notes 2 & 3
   IRIX 6.5.15       yes                       Notes 2 & 3
   IRIX 6.5.16       yes                       Notes 2 & 3
   IRIX 6.5.17m      yes            5264       Notes 2 & 4
   IRIX 6.5.17f      yes            5265       Notes 2 & 4
   IRIX 6.5.18m      yes            5266       Notes 2 & 4
   IRIX 6.5.18f      yes            5267       Notes 2 & 4
   IRIX 6.5.19m      yes            5266       Notes 2 & 4
   IRIX 6.5.19f      yes            5267       Notes 2 & 4
   IRIX 6.5.20m      yes            5268       Notes 2 & 4
   IRIX 6.5.20f      yes            5268       Notes 2 & 4
   IRIX 6.5.21m      yes            5269       Notes 2 & 4
   IRIX 6.5.21f      yes            5269       Notes 2 & 4
   IRIX 6.5.22        no


   NOTES

     1) This version of the IRIX operating has been retired. Upgrade to an
        actively supported IRIX operating system.  See
        http://support.sgi.com for more information.

     2) If you have not received an IRIX 6.5.X CD for IRIX 6.5, contact your
        SGI Support Provider or URL: http://support.sgi.com

     3) Upgrade to IRIX 6.5.22 (when available)

     4) Upgrade to IRIX 6.5.22 (when available), or install the patch

             ##### Patch File Checksums ####
Filename:                 README.patch.5264
Algorithm #1 (sum -r):    20767 8 README.patch.5264
Algorithm #2 (sum):       27308 8 README.patch.5264
MD5 checksum:             1EF8E031DE86F54CBFC37735EB5D9AE4

Filename:                 patchSG0005264
Algorithm #1 (sum -r):    26053 3 patchSG0005264
Algorithm #2 (sum):       29345 3 patchSG0005264
MD5 checksum:             45AF80C35DA53C994AD0CEFF4F76296F

Filename:                 patchSG0005264.eoe_man
Algorithm #1 (sum -r):    19286 27 patchSG0005264.eoe_man
Algorithm #2 (sum):       60606 27 patchSG0005264.eoe_man
MD5 checksum:             FEF41A913435C459FCF267B6C911F41D

Filename:                 patchSG0005264.eoe_sw
Algorithm #1 (sum -r):    19573 1611 patchSG0005264.eoe_sw
Algorithm #2 (sum):       25521 1611 patchSG0005264.eoe_sw
MD5 checksum:             6CBA2D2CDC64F7420CEE046A95330A40

Filename:                 patchSG0005264.eoe_sw64
Algorithm #1 (sum -r):    16141 1619 patchSG0005264.eoe_sw64
Algorithm #2 (sum):       25242 1619 patchSG0005264.eoe_sw64
MD5 checksum:             B0F17952BC0B17870157BFF07AAB0C42

Filename:                 patchSG0005264.idb
Algorithm #1 (sum -r):    19936 3 patchSG0005264.idb
Algorithm #2 (sum):       45364 3 patchSG0005264.idb
MD5 checksum:             2162254536CD958B21F6353F2EEFA8A5

Filename:                 README.patch.5265
Algorithm #1 (sum -r):    04261 8 README.patch.5265
Algorithm #2 (sum):       27302 8 README.patch.5265
MD5 checksum:             5DDD240FD555B630B04CEAC0F7AE5282

Filename:                 patchSG0005265
Algorithm #1 (sum -r):    57439 3 patchSG0005265
Algorithm #2 (sum):       31575 3 patchSG0005265
MD5 checksum:             4719B6B46C35566B43DFF8DB23246DA7

Filename:                 patchSG0005265.eoe_man
Algorithm #1 (sum -r):    05671 28 patchSG0005265.eoe_man
Algorithm #2 (sum):       9638 28 patchSG0005265.eoe_man
MD5 checksum:             4E15766E36B097842A0C786A7DDF8B0D

Filename:                 patchSG0005265.eoe_sw
Algorithm #1 (sum -r):    10897 1624 patchSG0005265.eoe_sw
Algorithm #2 (sum):       6529 1624 patchSG0005265.eoe_sw
MD5 checksum:             C9FAB2FED609FC75A2F46DDFA9B67C38

Filename:                 patchSG0005265.eoe_sw64
Algorithm #1 (sum -r):    05404 1644 patchSG0005265.eoe_sw64
Algorithm #2 (sum):       3188 1644 patchSG0005265.eoe_sw64
MD5 checksum:             3B3D64345907908993B044CBF780D8A6

Filename:                 patchSG0005265.idb
Algorithm #1 (sum -r):    21943 3 patchSG0005265.idb
Algorithm #2 (sum):       45308 3 patchSG0005265.idb
MD5 checksum:             936DF09BB37AA603F6B0FA2B28E18B3C

Filename:                 README.patch.5266
Algorithm #1 (sum -r):    08692 8 README.patch.5266
Algorithm #2 (sum):       31072 8 README.patch.5266
MD5 checksum:             FA136463F87C735E702284F75B1938ED

Filename:                 patchSG0005266
Algorithm #1 (sum -r):    17674 4 patchSG0005266
Algorithm #2 (sum):       40321 4 patchSG0005266
MD5 checksum:             08489A011D8F4DA809FF89BE624DA99E

Filename:                 patchSG0005266.eoe_man
Algorithm #1 (sum -r):    12782 27 patchSG0005266.eoe_man
Algorithm #2 (sum):       10895 27 patchSG0005266.eoe_man
MD5 checksum:             69A3E9F0DE805FC0B94A03FF53BFC637

Filename:                 patchSG0005266.eoe_sw
Algorithm #1 (sum -r):    58782 1612 patchSG0005266.eoe_sw
Algorithm #2 (sum):       15296 1612 patchSG0005266.eoe_sw
MD5 checksum:             6061F96E242CF3CEC8D6A037B0F00946

Filename:                 patchSG0005266.eoe_sw64
Algorithm #1 (sum -r):    24657 1622 patchSG0005266.eoe_sw64
Algorithm #2 (sum):       28645 1622 patchSG0005266.eoe_sw64
MD5 checksum:             56C8D4D949023B5A0143FCD0486E7460

Filename:                 patchSG0005266.idb
Algorithm #1 (sum -r):    48937 3 patchSG0005266.idb
Algorithm #2 (sum):       45386 3 patchSG0005266.idb
MD5 checksum:             5CADC70FA36E3D7B815B6F8FBB4F17BF

Filename:                 README.patch.5267
Algorithm #1 (sum -r):    14546 8 README.patch.5267
Algorithm #2 (sum):       31021 8 README.patch.5267
MD5 checksum:             76738A084F513775DD85B81D1BC94008

Filename:                 patchSG0005267
Algorithm #1 (sum -r):    28050 4 patchSG0005267
Algorithm #2 (sum):       45796 4 patchSG0005267
MD5 checksum:             5D6162E6DAA1FD1F28A4F3802BACED10

Filename:                 patchSG0005267.eoe_man
Algorithm #1 (sum -r):    13205 28 patchSG0005267.eoe_man
Algorithm #2 (sum):       31466 28 patchSG0005267.eoe_man
MD5 checksum:             98C7840C7122621251886E3B71A61EF3

Filename:                 patchSG0005267.eoe_sw
Algorithm #1 (sum -r):    05019 1627 patchSG0005267.eoe_sw
Algorithm #2 (sum):       51136 1627 patchSG0005267.eoe_sw
MD5 checksum:             4D5FA1874B547C87628BCBEC2CF79B10

Filename:                 patchSG0005267.eoe_sw64
Algorithm #1 (sum -r):    38088 1667 patchSG0005267.eoe_sw64
Algorithm #2 (sum):       15612 1667 patchSG0005267.eoe_sw64
MD5 checksum:             04EB12BE09E8692C782C2100522312B1

Filename:                 patchSG0005267.idb
Algorithm #1 (sum -r):    50194 3 patchSG0005267.idb
Algorithm #2 (sum):       45355 3 patchSG0005267.idb
MD5 checksum:             94E221BD2655DDB87E0FAB9183BA8F17

Filename:                 README.patch.5268
Algorithm #1 (sum -r):    18037 8 README.patch.5268
Algorithm #2 (sum):       30981 8 README.patch.5268
MD5 checksum:             DD6677BA492188F1B8245A17DB07023C

Filename:                 patchSG0005268
Algorithm #1 (sum -r):    38890 4 patchSG0005268
Algorithm #2 (sum):       40273 4 patchSG0005268
MD5 checksum:             D711BF0308FCAAF521CBE92CD937BFDB

Filename:                 patchSG0005268.eoe_man
Algorithm #1 (sum -r):    37809 29 patchSG0005268.eoe_man
Algorithm #2 (sum):       6758 29 patchSG0005268.eoe_man
MD5 checksum:             0B817D89AE398F9B74A22EBF82FA53D7

Filename:                 patchSG0005268.eoe_sw
Algorithm #1 (sum -r):    55940 1681 patchSG0005268.eoe_sw
Algorithm #2 (sum):       38833 1681 patchSG0005268.eoe_sw
MD5 checksum:             AE134D3E422CD93BB8B48DD21C8D3202

Filename:                 patchSG0005268.eoe_sw64
Algorithm #1 (sum -r):    08461 1720 patchSG0005268.eoe_sw64
Algorithm #2 (sum):       30202 1720 patchSG0005268.eoe_sw64
MD5 checksum:             52152A157A071693552FDDC4D9E9C882

Filename:                 patchSG0005268.idb
Algorithm #1 (sum -r):    22080 3 patchSG0005268.idb
Algorithm #2 (sum):       45392 3 patchSG0005268.idb
MD5 checksum:             7178064E04B990777C76676028EB42DD

Filename:                 README.patch.5269
Algorithm #1 (sum -r):    01513 8 README.patch.5269
Algorithm #2 (sum):       31009 8 README.patch.5269
MD5 checksum:             C67A1BF25201F9214C5970FF161B7903

Filename:                 patchSG0005269
Algorithm #1 (sum -r):    38700 4 patchSG0005269
Algorithm #2 (sum):       41945 4 patchSG0005269
MD5 checksum:             570D8BDD649B8B222E02431D6428BAC8

Filename:                 patchSG0005269.eoe_man
Algorithm #1 (sum -r):    38217 30 patchSG0005269.eoe_man
Algorithm #2 (sum):       34665 30 patchSG0005269.eoe_man
MD5 checksum:             5640D001B448B2A37F2852D299C6D584

Filename:                 patchSG0005269.eoe_sw
Algorithm #1 (sum -r):    25513 1690 patchSG0005269.eoe_sw
Algorithm #2 (sum):       49476 1690 patchSG0005269.eoe_sw
MD5 checksum:             F91B19BCE94CF4195CB89EA23B4120ED

Filename:                 patchSG0005269.eoe_sw64
Algorithm #1 (sum -r):    47527 1724 patchSG0005269.eoe_sw64
Algorithm #2 (sum):       16549 1724 patchSG0005269.eoe_sw64
MD5 checksum:             AC9DA4798C26691B5F78936EC0BE3F92

Filename:                 patchSG0005269.idb
Algorithm #1 (sum -r):    10586 3 patchSG0005269.idb
Algorithm #2 (sum):       45324 3 patchSG0005269.idb
MD5 checksum:             EB3EE4E7651229DB47631B17336B81F6


- -------------
- --- Links ---
- -------------

SGI Security Advisories can be found at:
http://www.sgi.com/support/security/ and
ftp://patches.sgi.com/support/free/security/advisories/

SGI Security Patches can be found at:
http://www.sgi.com/support/security/ and
ftp://patches.sgi.com/support/free/security/patches/

SGI patches for IRIX can be found at the following patch servers:
http://support.sgi.com/ and ftp://patches.sgi.com/

SGI freeware updates for IRIX can be found at:
http://freeware.sgi.com/

SGI patches and RPMs for Linux can be found at:
http://support.sgi.com

SGI patches for Windows NT or 2000 can be found at:
http://support.sgi.com/

IRIX 5.2-6.4 Recommended/Required Patch Sets can be found at:
http://support.sgi.com/ and ftp://patches.sgi.com/support/patchset/

IRIX 6.5 Maintenance Release Streams can be found at:
http://support.sgi.com/

IRIX 6.5 Software Update CDs can be obtained from:
http://support.sgi.com/

The primary SGI anonymous FTP site for security advisories and patches is
patches.sgi.com.  Security advisories and patches are located under the URL
ftp://patches.sgi.com/support/free/security/

For security and patch management reasons, ftp.sgi.com (mirrors
patches.sgi.com security FTP repository) lags behind and does not do a
real-time update.


- -----------------------------------------
- --- SGI Security Information/Contacts ---
- -----------------------------------------

If there are questions about this document, email can be sent to
security-info@....com.

                      ------oOo------

SGI provides security information and patches for use by the entire SGI
community.  This information is freely available to any person needing the
information and is available via anonymous FTP and the Web.

The primary SGI anonymous FTP site for security advisories and patches is
patches.sgi.com.  Security advisories and patches are located under the URL
ftp://patches.sgi.com/support/free/security/

The SGI Security Headquarters Web page is accessible at the URL:
http://www.sgi.com/support/security/

For issues with the patches on the FTP sites, email can be sent to
security-info@....com.

For assistance obtaining or working with security patches, please
contact your SGI support provider.

                      ------oOo------

SGI provides a free security mailing list service called wiretap and
encourages interested parties to self-subscribe to receive (via email) all
SGI Security Advisories when they are released. Subscribing to the mailing
list can be done via the Web
(http://www.sgi.com/support/security/wiretap.html) or by sending email to
SGI as outlined below.

% mail wiretap-request@....com
subscribe wiretap <YourEmailAddress such as midwatch@....com >
end
^d

In the example above, <YourEmailAddress> is the email address that you wish
the mailing list information sent to.  The word end must be on a separate
line to indicate the end of the body of the message. The control-d (^d) is
used to indicate to the mail program that you are finished composing the
mail message.


                      ------oOo------

SGI provides a comprehensive customer World Wide Web site. This site is
located at http://www.sgi.com/support/security/ .

                      ------oOo------

If there are general security questions on SGI systems, email can be sent to
security-info@....com.

For reporting *NEW* SGI security issues, email can be sent to
security-alert@....com or contact your SGI support provider.  A support
contract is not required for submitting a security report.

______________________________________________________________________________
      This information is provided freely to all interested parties
      and may be redistributed provided that it is not altered in any
      way, SGI is appropriately credited and the document retains and
      includes its valid PGP signature.

-----BEGIN PGP SIGNATURE-----
Version: 2.6.2

iQCVAwUBPzwE97Q4cFApAP75AQGKvgQAv7Irio3A1m+1fjgyCU7BRv9d1/mS3HGK
Nc2Z7IHDA7WneKX1LRPJOsyQOn475p5JJbl3IzH4KqxUD4gwXHeO5hJRjn/4wK1B
78838XiLWmUZrAtqEH/L6JDgtVu2787Z+FSJ/vvsid6Ux8dA02HRlurcjP6htrLP
78a4fbkr+ic=
=tYbH
-----END PGP SIGNATURE-----
_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.netsys.com/full-disclosure-charter.html


