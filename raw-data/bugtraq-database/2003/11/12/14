
Date: Wed, 12 Nov 2003 07:26:10 -0800 (PST)
From: security@....com
To: announce@...ts.sco.com, bugtraq@...urityfocus.com,
	full-disclosure@...ts.netsys.com
Subject: UnixWare 7.1.3 Open UNIX 8.0.0 UnixWare 7.1.1 : Insecure handling of procfs descriptors in UnixWare can lead to local privilege escalation.



To:  announce@...ts.sco.com bugtraq@...urityfocus.com full-disclosure@...ts.netsys.com

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


______________________________________________________________________________

			SCO Security Advisory

Subject:		UnixWare 7.1.3 Open UNIX 8.0.0 UnixWare 7.1.1 : Insecure handling of procfs descriptors in UnixWare can lead to local privilege escalation.
Advisory number: 	CSSA-2003-SCO.32
Issue date: 		2003 November 11
Cross reference: 	sr886899 fz528474 erg712482
______________________________________________________________________________


1. Problem Description

	"/proc/$PID/as" Contains the address space image of process
	$PID. It can be opened and accessed like any other file and
	be used to manipulate the process. The process owner also
	owns the "as" file whose file permission is 600. 

	For obvious reasons this doesn't apply to processes spawned 
	from setuid and setgid binaries. This protection can be bypassed by
	first obtaining a descriptor to a process you own then let
	that process execve() a setuid binary. execve() will replace
	the process image, honor the setuid bit and the descriptor
	will remain open. 

	The Common Vulnerabilities and Exposures project (cve.mitre.org) 
	has assigned the name CAN-2003-0937 to this issue.


2. Vulnerable Supported Versions

	System				Binaries
	----------------------------------------------------------------------
	UnixWare 7.1.3 			/etc/conf/pack.d/procfs/Driver_atup.o
				        /etc/conf/pack.d/procfs/Driver_mp.o

	Open UNIX 8.0.0 		/etc/conf/pack.d/procfs/Driver_atup.o
	(aka UnixWare 7.1.2)		/etc/conf/pack.d/procfs/Driver_mp.o

	UnixWare 7.1.1 			/etc/conf/pack.d/procfs/Driver_atup.o
					/etc/conf/pack.d/procfs/Driver_mp.o
					
3. Solution

	The proper solution is to install the latest packages.


4. UnixWare 7.1.3

	4.1 Location of Fixed Binaries

	ftp://ftp.sco.com/pub/updates/UnixWare/CSSA-2003-SCO.32

	erg712482c should only be installed on: UnixWare 7.1.3

	4.2 Verification

	MD5 (erg712482c.Z) = 50c98884a6dcb14ccf57d71aad135045

	md5 is available for download from
		ftp://ftp.sco.com/pub/security/tools

	4.3 Installing Fixed Binaries

	Upgrade the affected binaries with the following sequence:

	1. Download the erg712482c.Z file to the /tmp directory on your machine.

	2. As root, uncompress the file and add the package to your system
	using these commands:

        $ su
        Password: <type your root password>
        # uncompress /tmp/erg712482c.Z
        # pkgadd -d /tmp/erg712482c
        # rm /tmp/erg712482c

	Alternatively, this SLS package may be installed in quiet mode,
	that is, without displaying the release notes and asking for
	confirmation.  To do this, use these commands:

        $ su
        Password: <type your root password>
        # uncompress /tmp/erg712482c.Z
        # pkgadd -qd /tmp/erg712482c all
        # rm /tmp/erg712482c

	3. Reboot the system after installing this package.


	Removal Instructions
	--------------------

	1. As root, remove the package using these commands:

        $ su
        Password: <type your root password>
        # pkgrm erg712482

	2. Reboot the system after removing this package.


5. Open UNIX 8.0.0

	5.1 Location of Fixed Binaries

	ftp://ftp.sco.com/pub/updates/UnixWare/CSSA-2003-SCO.32

	erg712482b should only be installed on: UnixWare 7.1.2 or Open UNIX 8.0.0

	5.2 Verification

	MD5 (erg712482b.Z) = 54d3568e631d4739034815537242dc0d

	md5 is available for download from
		ftp://ftp.sco.com/pub/security/tools

	5.3 Installing Fixed Binaries

	Upgrade the affected binaries with the following sequence:

	1. Download the erg712482b.Z file to the /tmp directory on your machine.

	2. As root, uncompress the file and add the package to your system
	   using these commands:

        $ su
        Password: <type your root password>
        # uncompress /tmp/erg712482b.Z
        # pkgadd -d /tmp/erg712482b
        # rm /tmp/erg712482b

	Alternatively, this SLS package may be installed in quiet mode,
	that is, without displaying the release notes and asking for
	confirmation.  To do this, use these commands:

        $ su
        Password: <type your root password>
        # uncompress /tmp/erg712482b.Z
        # pkgadd -qd /tmp/erg712482b all
        # rm /tmp/erg712482b

	3. Reboot the system after installing this package.

	Removal Instructions
	--------------------

	1. As root, remove the package using these commands:

        $ su
        Password: <type your root password>
        # pkgrm erg712482

	2. Reboot the system after removing this package.


6. UnixWare 7.1.1

	6.1 Location of Fixed Binaries

	ftp://ftp.sco.com/pub/updates/UnixWare/CSSA-2003-SCO.32

	erg712482a should only be installed on: UnixWare 7.1.1

	6.2 Verification

	MD5 (erg712482a.Z) = 15776bcbaf01155eb28087ee213fecf8

	md5 is available for download from
		ftp://ftp.sco.com/pub/security/tools


	6.3 Installing Fixed Binaries

	Upgrade the affected binaries with the following sequence:

	erg712482a should only be installed on: UnixWare 7.1.1

	1. Download the erg712482a.Z file to the /tmp directory on your machine.

	2. As root, uncompress the file and add the package to your system
	   using these commands:

        $ su
        Password: <type your root password>
        # uncompress /tmp/erg712482a.Z
        # pkgadd -d /tmp/erg712482a
        # rm /tmp/erg712482a

	Alternatively, this SLS package may be installed in quiet mode,
	that is, without displaying the release notes and asking for
	confirmation.  To do this, use these commands:

        $ su
        Password: <type your root password>
        # uncompress /tmp/erg712482a.Z
        # pkgadd -qd /tmp/erg712482a all
        # rm /tmp/erg712482a

	3. Reboot the system after installing this package.


	Removal Instructions
	--------------------

	1. As root, remove the package using these commands:

        $ su
        Password: <type your root password>
        # pkgrm erg712482

	2. Reboot the system after removing this package.


7. References

	Specific references for this advisory:
		http://www.texonet.com/advisories/TEXONET-20031024.txt
		http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2003-0937

	SCO security resources:
		http://www.sco.com/support/security/index.html

	This security fix closes SCO incidents sr886899 fz528474
	erg712482.


8. Disclaimer

	SCO is not responsible for the misuse of any of the information
	we provide on this website and/or through our security
	advisories. Our advisories are a service to our customers
	intended to promote secure installation and use of SCO
	products.


9. Acknowledgments

	SCO would like to thank Joel Soderberg and Christer Oberg
	from Texonet. Texonet is a Swedish based security company
	with a focus on penetration testing / security assessments,
	research and development.
______________________________________________________________________________

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3 (SCO/UNIX_SVR5)

iD8DBQE/sVF8aqoBO7ipriERAnHfAJ9MyE3uuzUpvoWxw/ALWgKoF9khmwCgnU2H
n7SUQXgTFmXShKAXoxTN3F0=
=Ow6H
-----END PGP SIGNATURE-----


