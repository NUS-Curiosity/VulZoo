
Date: Tue, 25 Nov 2003 19:24:57 -0500
From: "James C. Slora, Jr." <james.slora@...a.com>
To: "Liu Die Yu" <liudieyuinchina@...oo.com.cn>,
	<bugtraq@...urityfocus.com>
Subject: RE: MHTML Redirection Leads to Downloading EXE and Executing


Liu Die Yu wrote Tuesday, November 25, 2003 4:51 AM

> MHTML Redirection Leads to Downloading EXE and Executing
> http://www.safecenter.net/UMBRELLAWEBV4/MhtRedirLaunchInetExe/MhtRedirLaunchInetExe-Demo.zip

mhtml:res: also seems to work just fine most of the time. It seems to work even better with MS03-048 applied.

Without MS03-048:
--------------------------
CODEBASE='mhtml:file://C:\NO_SUCH_MHT.MHT!etc
CODEBASE='mhtml:res://C:\NO_SUCH_MHT.MHT!etc
within the same file caused both to execute. It also worked if the browser was refreshed to code containing only mhtml:res: if mhtml:file: was opened before the refresh.

I could not get mhtml:mid: to work though.
CODEBASE='mhtml:mid://C:\NO_SUCH_MHT.MHT!etc
added to the same file causes the mhtml:res: to fail even if it precedes the mhtml:mid:. mhtml:file: still works even if mhtml:mid is present too.


With MS03-048:
--------------------------
mhtml:res: works almost all the time (fails just after reboot - mhtml:file: also fails on first IE instance after reboot, even with a refresh)
mhtml:mid: does not work but does not cause mhtml:res: to fail!

Win2K Server US English and IE, up to date 2003-11-25 (and tested without 2003-11 updates)


