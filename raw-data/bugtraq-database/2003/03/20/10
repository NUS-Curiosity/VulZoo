
Date: Thu, 20 Mar 2003 09:04:51 -0700 (MST)
From: Dave Ahmad <da@...urityfocus.com>
To: bugtraq@...urityfocus.com
Subject: Microsoft Security Bulletin MS03-009: Flaw In ISA Server DNS Intrusion
 Detection Filter Can Cause Denial Of Service (331065) (fwd)



David Mirza Ahmad
Symantec

"sabbe dhamma anatta"

0x26005712
8D 9A B1 33 82 3D B3 D0 40 EB  AB F0 1E 67 C6 1A 26 00 57 12

---------- Forwarded message ----------

-----BEGIN PGP SIGNED MESSAGE-----

- -------------------------------------------------------------------
Title:      Flaw In ISA Server DNS Intrusion Detection Filter Can
            Cause Denial Of Service (331065)
Date:       19 March 2003
Software:   Microsoft ISA Server
Impact:     Denial of Service
Max Risk:   Moderate
Bulletin:   MS03-009

Microsoft encourages customers to review the Security Bulletins at:
http://www.microsoft.com/technet/security/bulletin/MS03-009.asp
http://www.microsoft.com/security/security_bulletins/ms03-009.asp
- -------------------------------------------------------------------

Issue:
======
Microsoft Internet Security and Acceleration (ISA) Server 2000
contains the ability to apply application filters to incoming
traffic. Application filters allow ISA Server to analyze a data
stream for a particular application and provide application-
specific processing including inspecting, screening or blocking,
redirecting, or modifying the data as it passes through the
firewall. This mechanism is used to protect against invalid URLs
which may indicate attempted attacks as well as attacks against
internal Domain Name Service (DNS) Servers.

A flaw exists in the ISA Server DNS intrusion detection application
filter, and results because the filter does not properly handle a
specific type of request when scanning incoming DNS requests.

An attacker could exploit the vulnerability by sending a specially
formed request to an ISA Server computer that is publishing a DNS
server, which could then result in a denial of service to the
published DNS server. DNS requests arriving at the ISA Server would
be stopped at the firewall, and not passed through to the internal
DNS server. All other ISA Server functionality would be unaffected.

Mitigating Factors:
====================
 - By default, no DNS servers are published. DNS server publishing

   must be manually enabled.
 - The vulnerability would not enable an attacker to gain any
   privileges on an affected ISA Server or the published DNS server
   or to compromise any cached content on the server. It is
   strictly a denial of service vulnerability.


Risk Rating:
============
 - Moderate

Patch Availability:
===================
 - A patch is available to fix this vulnerability. Please read the
   Security Bulletins at

 http://www.microsoft.com/technet/security/bulletin/ms03-009.asp
 http://www.microsoft.com/security/security_bulletins/ms03-009.asp

   for information on obtaining this patch.


- -------------------------------------------------------------------

THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND. MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.
IN NO EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE
FOR ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES. SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.

-----BEGIN PGP SIGNATURE-----
Version: PGP 7.1

iQEVAwUBPni3qo0ZSRQxA/UrAQGl3gf+LrKTjf5hyCV2b+qkEagre6zgb2CuOP+A
auPp73+kYOHiI5Bd8STtHSdeedevmui5EDWDIkWR9tWm45eDXuy4dLFU8N9qH+id
lVrL/61eJuJz/9W53PxSsCy2wAisYrXcRA9nl0TrBU3/2WApHY2AkcIXWieG/KBS
XIcZQ+1gNb5Go+i/vrhNhsQaJJcWf7ziKLks5SRtWYUPc947DYLGulFhc+FRzwnc
OxSxKVGgncg/nc/86cDLZVM1jGzYao78VloPQoIVNPfsBmjx6s3+x0oGzOKCJwNp
w/GWnDIK8usqPu62pQYsjVDViA7Rz5Piub+73gbwEX1ytri/FHPsgg==
=Uf5c
-----END PGP SIGNATURE-----




