
Date: Tue,  4 Mar 2003 01:37:01 -0500 (EST)
From: NetBSD Security Officer <security-officer@...bsd.org>
To: bugtraq@...urityfocus.com
Subject: NetBSD Security Advisory 2003-002: Malformed header Sendmail Vulnerability


-----BEGIN PGP SIGNED MESSAGE-----


		 NetBSD Security Advisory 2003-002
		 =================================

Topic:		Malformed header Sendmail Vulnerability

Version:	NetBSD-current:	source prior to March 4, 2003
		NetBSD 1.6:	affected
		NetBSD-1.5.3:	affected
		NetBSD-1.5.2:	affected
		NetBSD-1.5.1:	affected
		NetBSD-1.5:	affected
		pkgsrc:		mail/sendmail, mail/sendmail811, and
				mail/sendmail88 are affected.

Severity:	Possible remote root compromise

Fixed:		NetBSD-current:		March 4, 2003
		NetBSD-1.6 branch:	March 4, 2003 (1.6.1 includes the fix)
		NetBSD-1.5 branch:	March 4, 2003
		pkgsrc:			mail/sendmail version 8.12.8
					and mail/sendmail811 version 8.11.6nb3
					fix this issue.  There is currently no
					fix for mail/sendmail88.


Abstract
========

A malformed email message may allow remote attackers to gain the privledge
of the sendmail daemon process.  This is usually root.

Technical Details
=================

Internet Security Systems (ISS) has discovered a remotely exploitable
vulnerability in the mail transfer agent (MTA) sendmail.  The vulnerability
is message-oriented, which means that even sendmail daemons not directly
exposed to the internet can be compromised.

Further, no sendmail logs will indicate anything out of the ordinary in an
unpatched sendmail system.

Solutions and Workarounds
=========================

We advise sites running sendmail to upgrade as soon as possible.  If upgrade
is impossible at this time, we recommend you turn off the sendmail service.

To determine if sendmail is running on your  system, issue the command:

        # /etc/rc.d/sendmail status

To stop currently running sendmail processes, issue the command:

        # /etc/rc.d/sendmail stop

To ensure sendmail does not start after the next reboot, issue the command:

	# echo "sendmail=NO" >>/etc/rc.conf.d/sendmail

To allow sendmail to start once upgraded, please remove the sendmail=NO line
from the end of /etc/rc.conf.d/sendmail.

The following instructions describe how to upgrade your sendmail
binaries by updating your source tree and rebuilding and
installing a new version of sendmail.

* NetBSD-current:

	Systems running NetBSD-current dated from before 2003-03-04
	should be upgraded to NetBSD-current dated 2003-03-04 or later.

	The following directories need to be updated from the
	netbsd-current CVS branch (aka HEAD):
		src/gnu/dist/sendmail/sendmail

	To update from CVS, re-build, and re-install sendmail:
		# cd src
		# cvs update -d -P gnu/dist/sendmail/sendmail
		# cd gnu/usr.sbin/sendmail

		# make USETOOLS=no cleandir dependall
		# cd sendmail
		# make USETOOLS=no install


* NetBSD 1.6:

	Systems running NetBSD 1.6 sources dated from before
	2003-03-04 should be upgraded from NetBSD 1.6 sources dated
	2003-03-04 or later.

	NetBSD 1.6.1 will include the fix.

	The following directories need to be updated from the
	netbsd-1-6 CVS branch:
		src/gnu/dist/sendmail/sendmail

	To update from CVS, re-build, and re-install sendmail:

		# cd src
		# cvs update -d -P -r netbsd-1-6 gnu/dist/sendmail/sendmail
		# cd gnu/usr.sbin/sendmail

                # make USETOOLS=no cleandir dependall
                # cd sendmail
                # make USETOOLS=no install


* NetBSD 1.5, 1.5.1, 1.5.2, 1.5.3:

	Systems running NetBSD 1.5, 1.5.1, 1.5.2, or 1.5.3 sources dated
	from before 2003-03-04 should be upgraded from NetBSD 1.5.*
	sources dated 2003-03-04 or later.

	The following directories need to be updated from the
	netbsd-1-5 CVS branch:
		src/gnu/dist/sendmail

	To update from CVS, re-build, and re-install sendmail:

		# cd src
		# cvs update -d -P -r netbsd-1-5 gnu/dist/sendmail/sendmail
		# cd gnu/usr.sbin/sendmail

                # make USETOOLS=no cleandir dependall
                # cd sendmail
                # make USETOOLS=no install


Thanks To
=========

Andrew Brown for preparing the fixes for the in-tree sendmail.
Stoned Elipot for preparing the fixes for pkgsrc.

Revision History
================

	2003-03-03	Initial release


More Information
================

Advisories may be updated as new information becomes available.
The most recent version of this advisory (PGP signed) can be found at 
  ftp://ftp.netbsd.org/pub/NetBSD/security/advisories/NetBSD-SA2003-002.txt.asc

Information about NetBSD and NetBSD security can be found at
http://www.NetBSD.ORG/ and http://www.NetBSD.ORG/Security/.


Copyright 2003, The NetBSD Foundation, Inc.  All Rights Reserved.

$NetBSD: NetBSD-SA2003-002.txt,v 1.4 2003/03/04 03:34:36 groo Exp $

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.0.6 (NetBSD)
Comment: For info see http://www.gnupg.org

iQCVAwUBPmQ5dz5Ru2/4N2IFAQH6tgP/TJmQYxaGYMdt6vj3TFNauloy5XXAtK1w
GfD1F3qWZaOccJ4IznyuCTaa/4l+KHFNgkV5eYnUKG2c8Ofttckzjk3e0fqQVpQ5
/BQNM0xaz8opcMIwF8t9XXniwUsNaF5UzAExsV1BbrGI4fwwGd7nO+JsoAuQ/hBc
fuSZWmoTawE=
=9gib
-----END PGP SIGNATURE-----


