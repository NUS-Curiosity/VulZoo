
Date: Mon, 16 Jul 2012 01:33:27 +0200
From: Research <research@...nerability-lab.com>
To: bugs@...uritytracker.com, bugtraq@...urityfocus.com
Subject: Event Calendar PHP 1.2 - Multiple Web Vulnerabilites

Title:
======
Event Calendar PHP 1.2 - Multiple Web Vulnerabilites


Date:
=====
2012-06-19


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=607


VL-ID:
=====
607


Common Vulnerability Scoring System:
====================================
7.1


Introduction:
=============
Event Calendar PHP main features:

    simple and user friendly admin area
    any language support
    full control over the CSS of calendar and events style
    one single step installation
    easy to include into your webpage - just drop a single line of code
    create unlimited number of calendars per website
    each event have date, start time, end time, title, price, maximum attendance, description and event photo/image
    different types for showing events on the calendar - in the calendar date cell, with tooltips, with popup window
    option to hide expired events from calendar
    fully readable and simple php source code
    W3C validated events RSS feed

You can see the demo of Event Calendar PHP. Also check the administrator area.
If needed, we can modify your Event Calendar PHP script for a reasonable price.
FREE INSTALLATION - If you are having trouble with the installation, we will do it free for you. Just email us at info@...ntcalendarphp.com
Requirements: PHP 4.3 or higher and MySQL 3 or higher running on your webserver.
Current stable version of Event Calendar PHP is 1.2 

( Copy of the Vendor Homepage: http://www.eventcalendarphp.com )


Abstract:
=========
The Vulnerability Laboratory Research Team discovered multiple web vulnerabilites in Event Calendar PHP 1.2 CMS.


Report-Timeline:
================
2012-06-17:	Public Disclosure


Status:
========
Published


Exploitation-Technique:
=======================
Remote


Severity:
=========
High


Details:
========
1.1
Multiple SQL Injection vulnerabilities  are detected in the Funeral Script PHP Content Management System.
The vulnerability allows an attacker (remote) or local low privileged user account to inject/execute own sql commands 
on the affected application dbms without user inter action. The vulnerabilities are located in the funeral_script.php 
& admin.php files and the bound vulnerable parameters orderBy, orderType & hide_cat. Successful exploitation of the 
vulnerability results in dbms & application compromise. 

Vulnerable File(s):
			[+] admin.php
			[+] preview.php

Vulnerable Parameter(s):
			[+] orderBy
			[+] orderType


1.2
Multiple persistent input validation vulnerabilities are detected in the Funeral Script PHP Content Management System.
The bugs allow remote attackers to implement/inject malicious script code on the application side (persistent). 
The vulnerabilities are located in the 

Successful exploitation of the vulnerability can lead to session hijacking (manager/admin) or stable (persistent) 
context manipulation. Exploitation requires low user inter action & privileged application user account.


Vulnerable Section(s): 
			[+] Event - Input & Listing
			[+] Calender - Input & Listing

Vulnerable Module(s):
			[+] [Calender - Name|Title > Listing]
			[+] [Event - Name|Title > Listing]


Vulnerable Parameter(s):
			[+] newCal - name
			[+] newEvent - title




1.3
Multiple non persistent cross site scripting vulnerabilities are detected on the ME Firewall Analyzer v7.2 Application.
The vulnerability allows remote attackers to hijack website customer, moderator or admin sessions with medium or high 
required user inter action or local low privileged user account. Exploitation requires low user inter action or low 
privileged application user account. The bugs are located in the admin.php & funeral_script.php files with the bound 
vulnreable parameters orderBy, search, orderType, p, hide_cat & obit_id. Successful exploitation can result in account 
steal, phishing & client-side content request manipulation.

Vulnerable File(s):
			[+] admin.php
			[+] preview.php

Vulnerable Parameter(s):
			[+] cal_id, cal_month & cal_year
			[+] act
			[+] search


Proof of Concept:
=================
1.1
The sql injection vulnerabilities can be exploited by remote attackers with privileged user accounts & without required
user inter action. For demonstration or reproduce ...

http://127.0.0.1:80/eventcalendar/admin.php?act=calendars&orderType=DESC&search=&orderBy=-1%27[SQL-INJECTION]cal_name&cal_id=2
http://127.0.0.1:80/eventcalendar/admin.php?act=calendars&orderType=-1%27[SQL-INJECTION]&search=&orderBy=cal_name&cal_id=2
http://127.0.0.1:80/eventcalendar/admin.php?act=events&orderType=ASC-1%27[SQL-INJECTION]&orderBy=event_title&cal_id=2
http://127.0.0.1:80/eventcalendar/admin.php?act=events&orderType=ASC&orderBy=-1%27[SQL-INJECTION]event_title&cal_id=2
http://127.0.0.1:80/preview.php?act=calendars&orderType=DESC&search=&orderBy=-1%27[SQL-INJECTION]cal_name&cal_id=2



1.2
The persistent script code inject vulnerability can be exploited by remote attackers with privileged user acctount & 
low required user inter action. For demonstration or reproduce ...

PoC:
http://127.0.0.1:80/eventcalendar/admin.php?act=newCal&cal_id=2
http://127.0.0.1:80/eventcalendar/admin.php?act=newEvent&cal_id=2

Note: Inject your persistent script code to the title input fields and watch the vulnerable output listing.



1.3
The client side cross site scripting vulnerabilities can be exploited by remote attackers with medium or high required user
inter action. For demonstration or reproduce ...

PoC:
http://127.0.0.1:80/eventcalendar/preview.php?cal_id=%22%3E%3Ciframe%20src=a%20onload=alert%28%22VL%22%29%20%3C&cal_month=1&cal_year=0#oncal
http://127.0.0.1:80/eventcalendar/preview.php?cal_id=2&cal_month=%22%3E%3Ciframe%20src=a%20onload=alert%28%22VL%22%29%20%3C&cal_year=0#oncal
http://127.0.0.1:80/eventcalendar/preview.php?cal_id=2&cal_month=1&cal_year=%22%3E%3Ciframe%20src=a%20onload=alert%28%22VL%22%29%20%3C#oncal
http://127.0.0.1:80/eventcalendar/admin.php?act=%22%3E%3Ciframe%20src=a%20onload=alert%28%22VL%22%29%20%3C


Risk:
=====
1.1
The security risk of the sql injection vulnerabilities are estimated as high(+).

1.2
The security risk of the persistent input validation vulnerabilities are estiamted as medium(-).

1.3
The security risk of the non-persistent cross  site scripting vulnerabilities are estiamted as medium(-).


Credits:
========
Vulnerability Laboratory [Research Team]  -    snup (snup@...nerability-lab.com) [http://snup1.blogspot.com]



Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. 

Domains:	www.vulnerability-lab.com   	- www.vuln-lab.com
Contact:	admin@...nerability-lab.com 	- support@...nerability-lab.com 	- research@...nerability-lab.com
Section:	video.vulnerability-lab.com 	- forum.vulnerability-lab.com 		- news.vulnerability-lab.com
Social:		twitter.com/#!/vuln_lab 	- facebook.com/VulnerabilityLab 	- youtube.com/user/vulnerability0lab

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other 
media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, sourcecode, videos and 
other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), 
modify, use or edit our material contact (admin@...nerability-lab.com or support@...nerability-lab.com) to get a permission.

    						Copyright Â© 2012 Vulnerability-Lab



-- 
VULNERABILITY RESEARCH LABORATORY TEAM
Website: www.vulnerability-lab.com
Mail: research@...nerability-lab.com


