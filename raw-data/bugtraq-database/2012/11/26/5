
Date: Mon, 26 Nov 2012 20:43:47 +0100
From: DefenseCode <defensecode@...ensecode.com>
To: bugtraq@...urityfocus.com
Subject: [DC-2012-11-002] DefenseCode ThunderScan ASP.Net C# Advisory: BugTracker.Net
 Multiple Security Vulnerabilities

DefenseCode ThunderScan ASP.Net C# Advisory: BugTracker.Net Multiple
Security Vulnerabilities


Advisory ID: DC-2012-11-002
Advisory Title: BugTracker.Net Multiple Security Vulnerabilities
Advisory URL:
http://www.defensecode.com/article/bugtracker.net_multiple_security_vulnerabilities-31 

Software: BugTracker.Net
Software Language: ASP.Net C#
Version: 3.5.8 and below
Vendor Status: Vendor contacted
Release Date: 2012-11-15
Risk: High



1. General Overview
===================
During the security audit of BugTracker.Net, multiple vulnerabilities
were discovered using DefenseCode ThunderScan ASP.Net C# web application
source code security analysis platform.
More information about ThunderScan ASP.Net C# is available at URL:
http://www.defensecode.com/subcategory/thunderscan-8


2. Software Overview
===================
BugTracker.NET is a free, open-source, web-based bug tracking and
general purpose issue tracking application. It is in daily use by
thousands of development, customer support, and help desk teams around
the world.
Homepage:
http://sourceforge.net/projects/btnet/
http://ifdefined.com/bugtrackernet.html


3. Brief Vulnerability Description
============================
During the security analysis, ThunderScan ASP.Net C# discovered multiple
SQL Injection, Cross Site Scripting and other vulnerabilities in
BugTracker.Net. Some of vulnerabilities are:

3.1 Cross Site Scripting through msg.InnerHtml()
File: default.aspx
Line: 88
Input variable: Request.QueryString["msg"]
Call stack (function line file)
   msg.InnerHtml() 87 default.aspx

3.2 SQL Injection through SqlCommand()
File: dbutil.cs
Line: 57
Input variable: row_id.Value
Call stack (function line file)
   SqlCommand() 56 dbutil.cs
   execute_nonquery() 66 delete_customfield.aspx

3.3 SQL Injection through SqlDataAdapter()
File: dbutil.cs
Line: 141
Input variable: row_id.Value
Call stack (function line file):
   SqlDataAdapter() 140 dbutil.cs
   get_dataset() 174 dbutil.cs
  get_datarow() 56 delete_report.aspx

3.4  File Disclosure through Response.WriteFile()
File: view_web_config.aspx
Line: 27
Input variable: Request
Call stack (function line file):
   Response.WriteFile() 26 view_web_config.aspx

3.5 File Disclosure through System.IO.File.OpenText()
File: edit_custom_html.aspx
Line: 84
Input variable: Request["which"]
Stack (function line file):
   System.IO.File.OpenText() 83 edit_custom_html.aspx
   load_file_into_control() 73 edit_custom_html.aspx

3.6 Cross Site Scripting through Response.Write()
File: bug_list.cs
Line: 438
Input variable: Request["tags"]
Stack (function line file):
   Response.Write() 437 bug_list.cs

3.7 Cross Site Scripting through Response.Write()
File: git_diff.aspx
Line: 92
Input variable: Request["rev_1"]
Stack (function line file):
   Response.Write() 91 git_diff.aspx

Detailed report for each vulnerability can be found in the following PDF
report:
http://www.defensecode.com/public/BugTrackerNet_Security_Audit_Final_Report.pdf 


Report has been generated by ThunderScan ASP.Net C# Web Application
Source Code Security Analysis.


4. Solution
=========
Vendor resolved security issues in latest BugTracker.Net release. All
users are strongly advised to update BugTracker.Net to the latest
available version 3.5.9.


5. About DefenseCode ThunderScan
================================
DefenseCode ThunderScan products are designed for comprehensive security
assessment of web application source code. ThunderScan products are
static source code analysis products for comprehensive security audit of
web applications.
Audit your web applications for SQL Injections, Cross Site Scripting,
Code Execution, File Inclusion, and much more.
Supported web application languages: ASP.Net C#, VB.Net, Classic ASP,
PHP and Java/JSP.
See ThunderScan in action:
http://www.youtube.com/watch?v=dcml2stPYNM&hd=1

ThunderScan: http://www.defensecode.com/subcategory/thunderscan-8
E-mail: defensecode[at]defensecode.com
Website: http://www.defensecode.com
