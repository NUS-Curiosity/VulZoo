
Date: Tue, 31 Jan 2012 23:38:51 GMT
From: LpSolit@...il.com
To: bugtraq@...urityfocus.com
Subject: Security advisory for Bugzilla 4.2rc2, 4.0.4, 3.6.8 and 3.4.14

Summary
=======

Bugzilla is a Web-based bug-tracking system used by a large number of
software projects. The following security issues have been discovered
in Bugzilla:

* When a user creates a new account, Bugzilla doesn't correctly
  reject email addresses containing non-ASCII characters, which
  could be used to impersonate another user account.

* A CSRF vulnerability in the implementation of the JSON-RPC API
  could be used to make changes to bugs or execute some admin tasks
  without the victim's knowledge.

All affected installations are encouraged to upgrade as soon as
possible.


Vulnerability Details
=====================

Class:       Account Impersonation 
Versions:    2.0 to 3.4.13, 3.5.1 to 3.6.7, 3.7.1 to 4.0.3,
             4.1.1 to 4.2rc1
Fixed In:    3.4.14, 3.6.8, 4.0.4, 4.2rc2
Description: When a user creates a new account, Bugzilla doesn't
             correctly reject email addresses containing non-ASCII
             characters, which could be used to impersonate another
             user account. Such email addresses could look visually
             identical to other valid email addresses, and an attacker
             could try to confuse other users and be added to bugs he
             shouldn't have access to.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=714472
CVE Number:  CVE-2012-0448

Class:       Cross-Site Request Forgery
Versions:    3.5.1 to 3.6.7, 3.7.1 to 4.0.3, 4.1.1 to 4.2rc1
Fixed In:    3.6.8, 4.0.4, 4.2rc2
Description: Due to a lack of validation of the Content-Type header
             when making POST requests to jsonrpc.cgi, a possible
             CSRF vulnerability was discovered. If a user visits an
             HTML page with some malicious JS code in it, an attacker
             could make changes to a remote Bugzilla installation on
             behalf of the victim's account by using the JSON-RPC API.
             The user would have had to be already logged in to the
             target site for the vulnerability to work.

References:  https://bugzilla.mozilla.org/show_bug.cgi?id=718319
CVE Number:  CVE-2012-0440

Vulnerability Solutions
=======================

The fixes for these issues are included in the 3.4.14, 3.6.8, 4.0.4,
and 4.2rc2 releases. Upgrading to a release with the relevant fixes will
protect your installation from possible exploits of these issues.

If you are unable to upgrade but would like to patch just the
individual security vulnerabilities, there are patches available for
each issue at the "References" URL for each vulnerability.

Full release downloads, patches to upgrade Bugzilla from previous
versions, and CVS/bzr upgrade instructions are available at:

  http://www.bugzilla.org/download/


Credits
=======

The Bugzilla team wish to thank the following people/organizations for
their assistance in locating, advising us of, and assisting us to fix
this issue:

Fr�d�ric Buclin
Max Kanat-Alexander
Byron Jones
Mario Gomes
James Kettle

General information about the Bugzilla bug-tracking system can be found
at:

  http://www.bugzilla.org/

Comments and follow-ups can be directed to the mozilla.support.bugzilla
newsgroup or the support-bugzilla mailing list.
http://www.bugzilla.org/support/ has directions for accessing these
forums.
