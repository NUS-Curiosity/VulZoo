
Date: Mon, 19 Mar 2012 11:14:36 -0400 (EDT)
From: security-alert@...com
To: bugtraq@...urityfocus.com
Subject: [security bulletin] HPSBPI02728 SSRT100692 rev.5 - Certain HP Printers and HP Digital Senders, Remote Firmware Update Enabled by Default

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

SUPPORT COMMUNICATION - SECURITY BULLETIN

Document ID: c03102449
Version: 5

HPSBPI02728 SSRT100692 rev.5 - Certain HP Printers and HP Digital Senders, Remote Firmware Update Enabled by Default

NOTICE: The information in this Security Bulletin should be acted upon as soon as possible.

Release Date: 2011-11-30
Last Updated: 2012-03-19

Potential Security Impact: Remote firmware update enabled by default

Source: Hewlett-Packard Company, HP Software Security Response Team

VULNERABILITY SUMMARY
A potential security vulnerability has been identified with certain HP printers and HP digital senders. The vulnerability could be exploited remotely to install unauthorized printer firmware.

References: CVE-2011-4161

SUPPORTED SOFTWARE VERSIONS*: ONLY impacted versions are listed.
Please refer to the RESOLUTION
 below for a list of impacted products.

BACKGROUND

CVSS 2.0 Base Metrics
===========================================================
  Reference              Base Vector             Base Score
CVE-2011-4161    (AV:N/AC:L/Au:N/C:C/I:C/A:C)       10.0
===========================================================
             Information on CVSS is documented
            in HP Customer Notice: HPSN-2008-002

Note: For further information on Secure Printing and Imaging please refer to http://www.hp.com/go/secureprinting

Remote Firmware Update (RFU): The Remote Firmware Update (RFU) feature is enabled by default. A firmware update can be sent remotely to port 9100 without authentication. This could allow unauthorized modification of the device firmware. The unauthorized firmware could impact the confidentiality and integrity of data sent to and received from the device. The unauthorized firmware could also cause a Denial of Service (DoS) to the device.

RESOLUTION
The following steps can be taken to avoid unauthorized firmware updates:

Update the firmware to a version that implements code signing
Disable the Remote Firmware Update

The code signing feature verifies that firmware updates are properly signed. This will prevent the installation of invalid firmware updates.

Note: A firmware update may be required to allow the RFU to be disabled or to implement code signing. Code signing is not available on all the affected devices. Please refer to the following table.

Product
 Firmware Update Required to Allow Disabling RFU
 Firmware Update Required for Code Signing

HP LaserJet Pro 100 color MFP M175
 RFU not available
 20111021 or later

HP TopShot LaserJet Pro M275
 RFU not available
 No update required

HP LaserJet Pro 300 color M351
 RFU not available
 No update required

HP LaserJet Pro 300 color M351
 RFU not available
 No update required

HP LaserJet Pro 300 color MFP M375
 RFU not available
 No update required

HP LaserJet Pro 400 color M451
 RFU not available
 No update required

HP LaserJet Pro 400 color MFP M475
 RFU not available
 No update required

HP LaserJet Enterprise 500 color M551
 No update required
 No update required

HP LaserJet Enterprise 600 M601
 No update required
 No update required

HP LaserJet Enterprise 600 M602
 No update required
 No update required

HP LaserJet Enterprise 600 M603
 No update required
 No update required

HP LaserJet Pro CP1025 Color Printer series
 20120130 or later
 20120130 or later

HP LaserJet Pro M1136 Multifunction Printer series
 20120206 or later
 20120206 or later

HP LaserJet Pro P1102 Printer series
 RFU not available
 20100130 or later

HP Color LaserJet CP1210 Printer series
 RFU not available
 20120213 or later

HP LaserJet Pro M1212nf Multifunction Printer series
 20120206 or later
 20120206 or later

HP Color LaserJet CM1312 Multifunction Printer
 20120104 or later
 20120104 or later

HP Color LaserJet CM1312nfi Multifunction Printer
 20120104 or later
 20120104 or later

HP LaserJet M1319 Multifunction Printer series
 RFU not available
 20120302 or later

HP LaserJet Pro CM1415 Color Multifunction Printer
 20111215 or later
 20111215 or later

HP LaserJet P1500 Printer series
 20120201 or later
 20120201 or later

HP Color LaserJet CP1510 Printer series
 20120110 or later
 20120110 or later

HP LaserJet M1522 Multifunction Printer series
 20120123 or later
 20120123 or later

HP LaserJet Pro CP1525 Color Printer
 20111215 or later
 20111215 or later

HP LaserJet Pro M1536 Multifunction Printer
 20221215 or later
 20221215 or later

HP LaserJet Pro P1606dn Printer
 RFU not available
 20120130 or later

HP Color LaserJet CP2025
 20120105 or later
 20120105 or later

HP LaserJet P2035 Printer series
 20120105 or later
 20120105 or later

HP LaserJet P2055 Printer series
 20120131 or later
 20120131 or later

HP Color LaserJet CM2320 Multifunction Printer series
 20120104 or later
 20120104 or later

HP LaserJet M2727 Multifunction Printer series
 20120123 or later
 20120123 or later

HP Color LaserJet 3000
 No update required
 Code signing not available

HP LaserJet P3005
 No update required
 Code signing not available

HP LaserJet Enterprise P3015
 No update required
 20120112 07.130.7 or later

HP LaserJet M3027 Multifunction Printer
 No update required
 20120119 48.241.2 or later

HP LaserJet M3035
 No update required
 20120119 48.241.2 or later

HP Color LaserJet CP3505
 No update required
 Code signing not available

HP Color LaserJet CP3525
 No update required
 20120112 06.130.8 or later

HP Color LaserJet CM3530
 No update required
 20120119 53.171.4 or later

HP Color LaserJet 3800
 No update required
 Code signing not available

HP Color LaserJet CP4005
 No update required
 20120113 46.190.3 or later

HP LaserJet P4014
 No update required
 20120112 4.160.9 or later

HP LaserJet P4015
 No update required
 20120112 4.160.9 or later

HP LaserJet 4240
 No update required
 20120113 08.220.3 or later

HP LaserJet 4250
 No update required
 20120113 08.220.3 or later

HP LaserJet M4345 Multifunction Printer
 No update required
 20120119 48.241.2 or later

HP LaserJet 4350
 No update required
 20120113 08.220.3 or later

HP LaserJet P4515
 No update required
 20120112 4.160.9 or later

HP Color LaserJet Enterprise CP4525
 No update required
 20120112 07.111.0 or later

HP Color LaserJet Enterprise CM4540 Multifunction Printer
 No update required
 No update required

HP LaserJet Enterprise M4555 Multifunction Printer
 No update required
 No update required

HP Color LaserJet 4700
 No update required
 Code signing not available

HP Color LaserJet 4730 Multifunction Printer
 No update required
 Code signing not available

HP Color LaserJet CM4730 Multifunction Printer
 No update required
 20120119 50.221.3 or later

HP LaserJet M5025 Multifunction Printer
 No update required
 20120119 48.241.2 or later

HP LaserJet M5035 Multifunction Printer
 No update required
 20120119 48.241.2 or later

HP LaserJet 5200L
 No update required
 20120119 08.181.1 or later

HP LaserJet 5200N
 No update required
 20120119 08.181.1 or later

HP Color LaserJet Professional CP5225 Printer series
 20111220 or later
 20111220 or later

HP Color LaserJet CP5525
 No update required
 No update required

HP Color LaserJet 5550
 No update required
 20120107 07.200.5 or later

HP Color LaserJet CP6015
 No update required
 20120112 04.151.0 or later

HP Color LaserJet CM6030
 No update required
 20120119 52.191.2 or later

HP Color LaserJet CM6040
 No update required
 20120119 52.191.2 or later

HP CM8060 Color Multifunction Printer with Edgeline
 No update required
 Code signing not available

HP LaserJet 9040
 No update required
 20120119 08.221.5 or later

HP LaserJet M9040 Multifunction Printer
 No update required
 20120119 51.191.3 or later

HP LaserJet 9050
 No update required
 20111213 08.220.1B or later

HP LaserJet M9050 Multifunction Printer
 No update required
 20120119 08.221.5 or later

HP 9200c Digital Sender
 No update required
 Code signing not available

HP 9250c Digital Sender
 No update required
 20120119 48.231.2 or later

HP Color LaserJet 9500
 No update required
 Code signing not available

How to Disable the Remote Firmware Update (RFU)

For instructions about how to disable the RFU please refer to the following document:

Configuring Remote Firmware Update on HP Printers and Multifunction Devices

The document is available here:

http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c03154309&jumpid=em_alerts_us-us_Jan12_xbu_all_all_1590794_104946_printersandmultifunctionscanners-copiers-faxes_routine_002_1

How to Download a Firmware Update

The table above contains links for required firmware updates. Firmware updates for any of the products can also be downloaded as follows.

Browse to www.hp.com/go/support then:

Select "Drivers & Software"
Enter the product name listed in the table above into the search field
Click on "Search"
If the search returns a list of products click on the appropriate product
Under "Select operating system" click on "Cross operating system (BIOS, Firmware, Diagnostics, etc.)"
If the "Cross operating system ..." link is not present, select any Windows operating system from the list.
Select the appropriate firmware update under "Firmware"

HISTORY
Version:1 (rev.1) - 30 November 2011 Initial release
Version:2 (rev.2) - 23 December 2011 Code signing firmware available
Version:3 (rev.3) - 9 January 2012 Combined tables
Version:4 (rev.4) - 17 February 2012 Added printers, updated firmware versions
Version:5 (rev.5) - 19 March 2012 Added printers, updated firmware versions

Third Party Security Patches: Third party security patches that are to be installed on systems running HP software products should be applied in accordance with the customer's patch management policy.

Support: For issues about implementing the recommendations of this Security Bulletin, contact normal HP Services support channel.  For other issues about the content of this Security Bulletin, send e-mail to security-alert@...com.

Report: To report a potential security vulnerability with any HP supported product, send Email to: security-alert@...com

Subscribe: To initiate a subscription to receive future HP Security Bulletin alerts via Email: http://h41183.www4.hp.com/signup_alerts.php?jumpid=hpsc_secbulletins

Security Bulletin List: A list of HP Security Bulletins, updated periodically, is contained in HP Security Notice HPSN-2011-001: https://h20566.www2.hp.com/portal/site/hpsc/public/kb/docDisplay/?docId=emr_na-c02964430

Security Bulletin Archive: A list of recently released Security Bulletins is available here: http://h20566.www2.hp.com/portal/site/hpsc/public/kb/secBullArchive/

Software Product Category: The Software Product Category is represented in the title by the two characters following HPSB.

3C = 3COM
3P = 3rd Party Software
GN = HP General Software
HF = HP Hardware and Firmware
MP = MPE/iX
MU = Multi-Platform Software
NS = NonStop Servers
OV = OpenVMS
PI = Printing and Imaging
PV = ProCurve
ST = Storage Software
TU = Tru64 UNIX
UX = HP-UX

Copyright 2012 Hewlett-Packard Development Company, L.P.
Hewlett-Packard Company shall not be liable for technical or editorial errors or omissions contained herein. The information provided is provided "as is" without warranty of any kind. To the extent permitted by law, neither HP or its affiliates, subcontractors or suppliers will be liable for incidental,special or consequential damages including downtime cost; lost profits;damages relating to the procurement of substitute products or services; or damages for loss of data, or software restoration. The information in this document is subject to change without notice. Hewlett-Packard Company and the names of Hewlett-Packard products referenced herein are trademarks of Hewlett-Packard Company in the United States and other countries. Other product and company names mentioned herein may be trademarks of their respective owners.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)

iEYEARECAAYFAk9nNLoACgkQ4B86/C0qfVld4wCglj4BF8JseI/6CLY0AJ6Bd8iE
PFgAnjK3s01qm7vvv3bF9vFayFpCERmU
=JrGG
-----END PGP SIGNATURE-----
