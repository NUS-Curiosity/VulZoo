
Date: Mon, 12 Mar 2012 12:57:17 +1100
From: Patrick Webster <patrick@...security.com.au>
To: bugtraq@...urityfocus.com
Subject: OSI Security: CheckPoint Firewall VPN - Information Disclosure

CheckPoint Firewall VPN1 - Information Disclosure Vulnerability

http://www.osisecurity.com.au/advisories/checkpoint-firewall-securemote-hostname-information-disclosure

[ Note: this is essentially a feature, but thought it may be useful
for pen testers when deciding which system to attack. ]

Release Date:
12-Mar-2012

Software:
CheckPoint Firewall / VPN-1
http://www.checkpoint.com/

Versions tested:
NGX R65, R71. Other versions untested but likely affected.

Vulnerability discovered:

By sending a pre-authentication topology request to the VPN SecuRemote
service, it is possible to obtain the firewall hostname name and
logging or management station (such as SmartCenter) host name.

Vulnerability impact:

Low - Information disclosure potentially reveals the client naming
scheme and the firewall management station hostname. Allows for
specifically targeting attacks towards the enterprise firewall
management server i.e. SmartCenter.

Vulnerability information:

By sending a certain query to the port 264/TCP on CheckPoint
Firewall-1, the hostname is revealed. A Metasploit module is available
to test for this vulnerability.

Example:

msf auxiliary(checkpoint_hostname) > set RHOST A.B.C.D
msf auxiliary(checkpoint_hostname) > run

[*] Attempting to contact Checkpoint FW1 SecuRemote Topology service...
[+] Appears to be a CheckPoint Firewall...
[+] Firewall Host: CPSYDFW1
[+] SmartCenter Host: CPSYDMGMTSVR
[*] Auxiliary module execution completed

Recommendation:

None at this time.

Workaround:

N/A.

Credit:
This vulnerability was disclosed by Patrick Webster.

Exploit:

A metasploit module is available here:

http://www.metasploit.com/modules/auxiliary/gather/checkpoint_hostname

Disclosure timeline:
14-Dec-2011 - Discovered during audit.
21-Dec-2011 - Added auxiliary module to the Metasploit Framework.
23-Dec-2011 - Notified vendor. No response.
12-Mar-2012 - Disclosure.

About OSI Security:

OSI Security is an independent network and computer security auditing
and consulting company based in Sydney, Australia. We provide internal
and external penetration testing, vulnerability auditing and wireless
site audits, vendor product assessments, secure network design,
forensics and risk mitigation services.

We can be found at http://www.osisecurity.com.au/
