
Date: Sat, 21 Mar 2015 16:38:12 GMT
From: kingkaustubh@...com
To: bugtraq@...urityfocus.com
Subject: Reflected XSS Vulnerability in XSS In Manage Engine Device Expert

===============================================================================
Reflected XSS Vulnerability in XSS In Manage Engine Device Expert
===============================================================================

. contents:: Table Of Content

Overview
========

* Title :Reflected XSS Vulnerability in XSS In Manage Engine Device Expert
* Author: Kaustubh G. Padwad
* Plugin Homepage: http://www.manageengine.com/products/device-expert/
* Severity: Low
* Version Affected: Version 5.9.9.0 Build: 5990
* Version Tested : Version 5.9.9.0 Build: 5990
* version patched: Separate Patch release for all version

Description 
===========

About the Product
=================
DeviceExpert is a web�based, multi vendor network change, configuration and compliance management (NCCCM) solution for switches, routers, firewalls and other network devices. Trusted by thousands of network administrators around the world, DeviceExpert helps automate and take total control of the entire life cycle of device configuration management.



Vulnerable Parameter  
--------------------

* j_username


 	
About Vulnerability
-------------------
This Product is vulnerable to a combination of CSRF/XSS attack meaning that if an admin user can be tricked to visit a crafted URL created by attacker (via spear phishing/social engineering), the attacker can execute arbitrary code into login page. Once exploited, admin�s browser can be made to do almost anything the admin user could typically do by hijacking admin's cookies etc. 

Vulnerability Class
===================     
Cross Site Request Forgery (https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29)
Cross Site Scripting       (https://www.owasp.org/index.php/Top_10_2013-A3-Cross-Site_Scripting_(XSS) 

Steps to Reproduce: (POC)
=========================
1. After Setting up Manage engine navigate to its user interface 

2. Use this payload in Username field 

#####payload To Use#######################
demouser59670';alert(document.cookie)//123 
##########################################

3. And see the XSS in action.

#Live Poc URL
http://demo.deviceexpert.com/j_security_check?username=demouser&j_username=demouser59670';alert(document.cookie)//1234&j_password=demouser&AUTHRULE_NAME=Authenticator
http://demo.deviceexpert.com/j_security_check?username=demouser&j_username=demouser59670';alert("Hacked_BY_S3curityB3ast")//1234&j_password=demouser&AUTHRULE_NAME=Authenticator


. image:: xss.jpeg
   :height: 1000 px
   :width:  1000 px
   :scale: 100 %
   :alt: XSS POC
   :align: center




Mitigation 
==========
Receved from manage engine team

https://uploads.zohocorp.com/Internal_Useruploads/dnd/NetFlow_Analyzer/o_19fo0pejo1mvr1leqltueae1jjf1/DEFIX.zip

1. Stop the Device Expert Service
2. Download and unzip the fix from the above link, it contains a file named deviceexpert.js
3. Copy and replace the deviceexpert.js under DeviceExpert_Home\webapps\ncm\javascript
4. Star the Device Expert service and check.


Change Log
==========


Disclosure 
==========
02-February-2015 Reported to Developer
04-February-2015 Acknodlagement from Developer
11-March-2015    Fixed by developer
16-March-2015    Requested a cve ID    
21-March-2015    Public Disclosed 
credits
=======
* Kaustubh Padwad 
* Information Security Researcher
* kingkaustubh@...com 
* https://twitter.com/s3curityb3ast
* http://breakthesec.com
* https://www.linkedin.com/in/kaustubhpadwad
