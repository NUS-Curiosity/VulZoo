
Date: Thu, 7 May 2015 08:09:44 GMT
From: matthias.deeg@...s.de
To: bugtraq@...urityfocus.com
Subject: [SYSS-2015-017] BullGuard Internet Security - Authentication Bypass

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Advisory ID: SYSS-2015-017
Product: BullGuard Internet Security
Vendor: BullGuard Ltd.
Affected Version(s): 15.0.297
Tested Version(s): 15.0.297
Vulnerability Type: Authentication Bypass Using an Alternate Path or 
                    Channel (CWE-288)
Risk Level: Medium
Solution Status: Not fixed
Vendor Notification: 2015-03-16
Solution Date: -
Public Disclosure: 2015-05-07
CVE Reference: Not yet assigned
Author of Advisory: Matthias Deeg (SySS GmbH)

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Overview:

BullGuard Internet Security is an endpoint protection software with
many features defending users against different threats.

The vendor BullGuard describes the product as follows (see [1]):

"BullGuard Internet Security delivers the best security tools to simply
protect you from all online threats:

* Award-winning technology with multiple protection layers for superior
  virus catch rates - as testified by independent labs
* Elegantly simple interface makes management of your security easy
* Easy-to-use and powerful Parental Control keeps your kids safe from
  cyberbullying and predators
* Free 5GB of advanced backup to keep your most important data, photos,
  music and more, safe and to easily share them
* 3-PC licence and FREE upgrades to new versions
* Safeguard against crashes and keep your computer running smoothly with
  PC tune up
* Stop unwanted applications from taking over your browser, toolbar and
  search engine"

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Vulnerability Details:

The endpoint protection software BullGuard Internet Security offers a
password protection in order to restrict access to the management
console. With an enabled password protection, changing settings or
deactivating the protection features requires the set password.

By analyzing the password-based authentication of the implemented
password protection, the SySS GmbH found out, that the password
comparison is done within the process BullGuard.exe, which can be run
in the context of the current Windows user, who can also be a standard,
limited user.

This fact allows a further analysis and the manipulation of the password
comparison during runtime without administrative privileges, as every 
user is able to debug and manipulate the processes running with her user
privileges, if no further security controls preventing such an analysis
have been implemented.

In order to bypass the password-based authentication, for example to
deactivate the antivirus protection of BullGuard Internet Security in an
unauthorized manner, an attacker only has to patch this password
comparison, so that it always returns true, for example by comparing
the correct unload password with itself or by modifying the program
control flow. For running a new instance of the process BullGuard.exe
besides an already running protected version of this process, that can
neither be debugged nor terminated with low user privileges, an instance
check has to be patched, too.

The SySS GmbH also found out, that the actual set password for the
password protection can be extracted as cleartext during runtime from
the attacker-controlled process BullGuard.exe.

Thus, a limited Windows user or malware running in the context of such a
user is able to deactivate BullGuard Internet Security in an
unauthorized manner and furthermore to extract the actual password as
cleartext.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Proof of Concept (PoC):

The SySS GmbH developed a proof-of-concept software tool named
UnloadBullGuard for deactivating the BullGuard protection in an
unauthorized manner.

The following output exemplarily shows a successful bypass of the
password-based authentication and of the cleartext password extraction:

>UnloadBullguard.exe
                ____________________________________________________________
               /    _____       _____ _____                                 \
              /    /  ___|     /  ___/  ___|                                 \
             |     \ `--. _   _\ `--.\ `--.                                   |
             |      `--. \ | | |`--. \`--. \                                  |
             |     /\__/ / |_| /\__/ /\__/ /                                  |
              \    \____/ \__, \____/\____/   ... unloads BullGuard!         /
               \          __/ |                                             /
               /         |___/    _________________________________________/
              / _________________/
        (__) /_/
        (oo)
  /------\/
 / |____||
*  ||   ||
   ^^   ^^
SySS Unload BullGuard v1.0 by Matthias Deeg - SySS GmbH (c) 2015

[+] Found location of the executable file BullGuard.exe
[+] Created new instance of the process BullGuard.exe
[+] The BullGuard process was patched successfully.
    Now you can unload the BullGuard protection with an arbitrary password.
    After entering an arbitrary password, the correct one will be shown.
[+] The correct password is: S3cret1!

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Solution:

The SySS GmbH is currently not aware of a solution for the reported
security vulnerability.

Please contact the vendor for further information.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclosure Timeline:

2015-03-16: Vulnerability reported to vendor
2015-03-24: Reported vulnerability again as the vendor did not reply to
            to the first e-mail with the SySS security advisory
2015-03-24: Vendor acknowledges e-mail with SySS security advisory
2015-05-07: Public release of security advisory according to the SySS
            Responsible Disclosure Policy         
 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

References:

[1] Product Web site for BullGuard Internet Security
    http://www.bullguard.com/products/bullguard-internet-security.aspx
[2] SySS Security Advisory SYSS-2015-017
    https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2015-017.txt
[3] SySS Responsible Disclosure Policy
    https://www.syss.de/en/news/responsible-disclosure-policy/

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Credits:

This security vulnerability was found by Matthias Deeg of the SySS GmbH.

E-Mail: matthias.deeg (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Matthias_Deeg.asc
Key fingerprint = D1F0 A035 F06C E675 CDB9 0514 D9A4 BF6A 34AD 4DAB

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclaimer:

The information provided in this security advisory is provided "as is" 
and without warranty of any kind. Details of this security advisory may 
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web 
site.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Copyright:

Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iQIcBAEBCgAGBQJVSxR7AAoJENmkv2o0rU2rxJgP/RyWw48bNQWYOTe//m79RVZl
JSK3ZfIIvk2ssVwQNLBgZTMurCyRlPIRKfBpCMKiqdPhJZ3wmrxcx2bMX6UHp/VQ
pdTE/5jHar90UC7bcIjX4sjitiWFQU+6lEE4+HeYFKeaAUzs5JNDl+cksTLp+PxH
F5rZfQ/VMsuGhAQYOHn9ZM2LeAoMoycdRT2YBZePlqCzOd2LY6eJ+WvmRJfumIlm
cW6/urKaf9yPwUPK0F6cEP18tzSylAvLW1pTimFFeHh35H40gFZF6pbcx5PA4jBg
gWwtIfiAC/XrtHhOAgk+bH88D/THpGJI/VjMsPnc5KKDXpjl7f3bqtcRXeJC7ZB+
gjqnbBtNUXE4munS/Xd7kET6AU6TP0SYGT7KaL9Ai6mVvnsK+iTnV9xEM4qtN0Eu
gAAdI4mBaO7sKUnnNbPvtI+Mo3epKx+G+ATRv/kgeekE9zKJAtEMx64BF/6VGU0C
UrNcP7x0GOg4IG8HJDtt5sil2PP0NWqhurz0n2GqlXZrplZZUP01AyZ5LkUUSBX7
niKet00CUGWiZtRspqXfbQBQffF+P4z748SJW0CXFG2E3M4d4UZ4PZlsgpdgGZKD
pvFkpAbk57LRZoUsPXWyzElF1YRSDxyAjxQ9boJYtHr7Ut3QIQHWy0YlHCl2hqZy
MfUzwkVxGZvVscCs54r6
=RHIN
-----END PGP SIGNATURE-----
