
Date: 10 Jun 2006 16:08:38 -0000
From: admin@...orsecurity.de
To: bugtraq@...urityfocus.com
Subject: [MajorSecurity #13]Cabacos Web CMS<= 3.8 - XSS


[MajorSecurity #13]Cabacos Web CMS<= 3.8 - XSS
----------------------------------------------

Software: Cabacos Web CMS

Version: <=3.8.498

Type: Cross site scripting

Date: June, 10th 2006

Vendor: IT-Direkt

Page: http://www.cabacos-web-cms.de


Credits:
----------------------------

Discovered by: David "Aesthetico" Vieira-Kurz
http://www.majorsecurity.de

Original Advisory:
----------------------------
http://www.majorsecurity.de/advisory/major_rls13.txt

Affected Products:
----------------------------

Cabacos Web CMS 3.8.498 and prior

Description:
----------------------------

Cabacos Web CMS is a well known and commercial Content Management System.

Requirements:
----------------------------

register_globals = On

Vulnerability:
----------------------------

Input passed to the searchform input fields is not properly sanitised before being returned to the user.
This can be exploited to execute arbitrary HTML and script code in context of an affected site.


Solution:
----------------------------
Edit the source code to ensure that input is properly sanitised.
You should work with "htmlspecialchars()" or "strip_tags()" php-function to ensure that html tags
are not going to be executed.

Example:
<?php
  echo htmlspecialchars("<script");
?>

Set "register_globals" to "Off".

Exploitation:
---------------------------
Goto the searchform input fields and type in following line as searchword:

<script>alert("MajorSecurity")</script>



