
Date: 5 Jun 2006 17:27:50 -0000
From: omnipresent@...il.it
To: bugtraq@...urityfocus.com
Subject: ASPScriptz Guest Book 2.0 XSS


------------------------------------------------------------------
            - ASPScriptz Guest Book 2.0 Remote XSS -
   -= http://colander.altervista.org/advisory/ASzGB.txt =-
------------------------------------------------------------------

	       -= ASPScriptz Guest Book 2.0 =-



Omnipresent
May 18, 2006


Vunerability(s):
----------------
XSS Attack


Product:
--------
ASPScriptz Guest Book 2.0

Vendor:
--------
http://www.aspscriptz.com


Description of product:
-----------------------

Guesbook is a free open source guestbook.Simply download it and unzip it and upload it into the root directory of your 
server.It is working now.Smilies support it also added in this version.Admin can disable or enable HTML support.Admin 
section is also included.


Vulnerability / Exploit:
------------------------

From line 109 to line 113, there are the vulnerable code:

[...]

GBOOK_UNAME	=	REQUEST.FORM("GBOOK_UNAME")
GBOOK_EMAIL	=	REQUEST.FORM("GBOOK_EMAIL")
GBOOK_CITY	=	REQUEST.FORM("GBOOK_CITY")
GBOOK_COU	=	REQUEST.FORM("GBOOK_COU")
GBOOK_WWW	=	REQUEST.FORM("GBOOK_WWW")

[...]

As you can see, the variables:
GBOOK_UNAME
GBOOK_CITY
GBOOK_COU

are not properly sanitized before being used, so a remote attacker can inject arbitrary HTML code.

So, the programmer for delete the bug can modify the source code with a simple replace().


PoC / Proof of Concept of SQL Injection:
----------------------------------------

Not very hard.. :D Just put <script>alert("XSS")</script> in the Name, City and Country fields.

Vendor Status
-------------

[2006/06/05] Vendor Informed!

Credits:
--------
omnipresent
omnipresent@...il.it


