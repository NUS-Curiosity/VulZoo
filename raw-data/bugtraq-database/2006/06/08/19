
Date: 7 Jun 2006 23:18:35 -0000
From: luny@...fucktard.com
To: bugtraq@...urityfocus.com
Subject: E-Dating System from scriptsez.net - XSS


E-Dating System

Homepage:
http://www.scriptsez.net/

Effected files:
Input boxes.
cindex.php

Description:

A Professional dating system that uses flatfiles instead of MySQL.


XSS Vulnerabilities PoC:

The input boxes of sending a message, and editing your profile do not properally filter user input before generating it. 

The script add's backslashes to ' and " but we can easily get around this by changing ' into &#0000039. forPoC input the 

following in anyof the above boxes mentioned:

<IMG SRC=javascript:alert(&#0000039XSS&#0000039)>


Full path disclosure error by url injection of trying to read a nonexistant message:

http://www.example.comcindex.php?action=dologin&nav=messagebox&do=read&id=999720979&st=1

Warning: rename(files/rofl/999720979&~@...txt,files/rofl/999720979&~@...txt): No such file or directory in /home/www/

domain/demo/dating/gmain.php on line 733

We now know the dir /files/username/ is where we can view users profiles, data and messages, this dir is also said tobe chmoded to 777 in the install instructs. Since none of the data was sanatized by input box before being stored in this flatfile, this data will also create XSS examples, plus also lets us view any users private messages in plain text format as well.

Another XSS Vuln via id:

http://www.example.com/cindex.php?action=dologin&nav=messagebox&do=read&id=<IMG SRC=javascript:alert(&#0000039XSS&#0000039)>&st=1


