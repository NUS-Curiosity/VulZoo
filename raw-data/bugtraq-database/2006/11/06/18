
Date: 6 Nov 2006 15:32:21 -0000
From: admin@...orsecurity.de
To: bugtraq@...urityfocus.com
Subject: MajorSecurity Advisory #32]phpComasy CMS - Multiple Cross Site
 Scripting Issues

MajorSecurity Advisory #32]phpComasy CMS - Multiple Cross Site Scripting Issues

Details
=======
Product: phpComasy CMS
Affected Version: <= 0.7.9 pre
Security-Risk: moderated
Remote-Exploit: yes
Vendor-URL: http://www.phpcomasy.org
Vendor-Status: informed
Advisory-Status: published

Credits
============
Discovered by: David Vieira-Kurz
http://www.majorsecurity.de

Original Advisory:
============
http://www.majorsecurity.de/index_2.php?major_rls=major_rls32

Introduction
============
phpComasy CMS is a Content Management System.

More Details
============
Cross Site Scripting:
Input passed directly to the "username" and "password" parameter in "index.php" is not properly sanitised before being returned to the user.
This can be exploited to execute arbitrary HTML and script code in a user's browser session in context of an affected site.

Fix
===
Version 0.8

Solution
=============
Edit the source code to ensure that input is properly sanitised.
You should work with "htmlspecialchars()" or "htmlentities()" php-function to ensure that html tags
are not going to be executed. Further it is recommend to set off the "register globals" option in the
"php.ini" on your webserver.

Example:
$pass = htmlentities($_POST['pass']);
$test = htmlspecialchars($_GET('test'));
?>

History/Timeline
================
02.11.2006 discovery of the vulnerabilities
02.11.2006 additional tests with other versions
03.11.2006 contacted the vendor
04.11.2006 the vendor contacted me(response)
04.11.2006 vendor confirmed the bugs
05.11.2006 bugs have been fixed
06.11.2006 advisory is written
06.11.2006 advisory released

MajorSecurity
=======
MajorSecurity is a German penetration testing and security research project
which consists of only one person at the present time.
I am looking for a sponsor.
You can find more Information on the MajorSecurity Project at
http://www.majorsecurity.de/
