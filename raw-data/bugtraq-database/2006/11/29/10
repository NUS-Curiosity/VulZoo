
Date: Wed, 29 Nov 2006 10:38:47 -0500
From: iDefense Labs <labs-no-reply@...fense.com>
To: vulnwatch@...nwatch.org, full-disclosure@...ts.grok.org.uk,
	bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 11.29.06: Horde Kronolith Arbitrary Local
 File Inclusion Vulnerability

Horde Kronolith Arbitrary Local File Inclusion Vulnerability

iDefense Security Advisory 11.27.06
http://labs.idefense.com/intelligence/vulnerabilities/
Nov 27, 2006

I. BACKGROUND

Kronolith is a web-based calendar system written in PHP and utilizing the
Horde Application Framework. It is generally installed along side Horde's
IMP web mail product. More information can be obtained at the Kronolith
site at http://www.horde.org/kronolith/

II. DESCRIPTION

Remote exploitation of a design error in Horde's Kronolith could allow an
authenticated web mail user to execute arbitrary PHP code under the
security context of the running Web server.

The vulnerability specifically exists due to a design error in the way it
includes certain files. Specifically, the 'lib/FBView.php' file contains a
function 'Kronolith_FreeBusy_View::factory' which will include local files
that are supplied via the 'view' HTTP GET request parameter. An excerpt
from the code follows:

177      function &factory($view)
178      {
179          $driver = basename($view);
180          require_once dirname(__FILE__) . '/FBView/' . $view . '.php';

As you can see on line 179, input validation was done. However the
resulting string was not used on line 180. Instead the unfiltered variable
coming directly from the attacker is used. By utilizing directory traversal
specifiers and null bytes, an attacker can trivially cause files stored on
the Web server to be parsed as PHP code.

III. ANALYSIS

Successful exploitation could allow an attacker to include an arbitrary
local file on the affected host. Due to the lack of input validation on
$GET_['view'], directory traversal specifiers could be utilized to parse
any file on the system as PHP code.

IV. DETECTION

iDefense has confirmed that versions 2.0.1 through 2.1.3 of Horde Kronolith
are vulnerable to this issue. Other versions are also likely to be
vulnerable.

V. WORKAROUND

iDefense is unaware of any available workarounds for this vulnerability.

VI. VENDOR RESPONSE

The Horde core team has addressed this vulnerability in versions 2.0.7 and
2.1.4 of Kronolith.

VII. CVE INFORMATION

A Mitre Corp. Common Vulnerabilities and Exposures (CVE) number has not
been assigned yet.

VIII. DISCLOSURE TIMELINE

11/21/2006  Initial vendor notification
11/21/2006  Initial vendor response
11/29/2006  Coordinated public disclosure

IX. CREDIT

The discoverer of this vulnerability wishes to remain anonymous.

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2006 iDefense, Inc.

Permission is granted for the redistribution of this alert electronically.
It may not be edited in any way without the express written consent of
iDefense. If you wish to reprint the whole or any part of this alert in
any other medium other than electronically, please e-mail
customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate at
the time of publishing based on currently available information. Use of
the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on, this
information.

