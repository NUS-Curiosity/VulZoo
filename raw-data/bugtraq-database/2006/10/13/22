
Date: 13 Oct 2006 05:21:02 -0000
From: 566d9bfe@...sg.stevenroddis.com.au
To: bugtraq@...urityfocus.com
Subject: TorrentFlux startpop.php torrent Script Insertion

http://www.stevenroddis.com.au/2006/10/13/torrentflux-startpopphp-torrent-script-insertion/

TITLE:
TorrentFlux �startpop.php� �torrent� Script Insertion
CRITICAL:
Not Critical

IMPACT:
Cross Site Scripting

WHERE:
>From remote

SOFTWARE:
TorrentFlux 2.x

DESCRIPTION:
I have discovered a vulnerability in TorrentFlux, which can be exploited by malicious users to conduct script insertion attacks.

Input passed to the �torrent� field of a GET Request (/startpop.php?torrent=%22%3E%3Cscript%3Ealert(document.cookies);%3C/script%3E.torrent) is not properly sanitised before being used. This can be exploited to insert arbitrary HTML and script code, which will be executed in an user�s browser session in context of an affected site if a user clicks on a malicious link.

The vulnerability has been confirmed in version 2.1. Other versions may also be affected.

SOLUTION:
Edit the source code to ensure that input is properly sanitised.

/startpop.php

Line 36: Change to: $displayName = htmlentities($displayName, ENT_QUOTES);

(Line 36 is normally empty)

Grant only trusted users access to the application
