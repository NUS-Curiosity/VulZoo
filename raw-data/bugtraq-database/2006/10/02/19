
Date: Sun, 01 Oct 2006 10:23:15 +0200
From: David Matousek <david@...ousec.com>
To: bugtraq@...urityfocus.com
Subject: Kerio Multiple insufficient argument validation of hooked SSDT function
 Vulnerability

Hello,

I would like to inform you about a vulnerability in Sunbelt Kerio Personal Firewall.


Description:

Sunbelt Kerio Personal Firewall hooks many functions in SSDT and in at least six cases it fails to validate arguments 
that come from user mode. User calls to NtCreateFile, NtDeleteFile, NtLoadDriver, NtMapViewOfSection, NtOpenFile, 
NtSetInformationFile with invalid argument values can cause system crashes because of errors in Kerio drivers fwdrv.sys 
and khips.sys. Further impacts of this bug (like arbitrary code execution in the kernel mode) were not examined.


Vulnerable software:

     * Sunbelt Kerio Personal Firewall 4.3.268
     * Sunbelt Kerio Personal Firewall 4.3.246
     * Sunbelt Kerio Personal Firewall 4.2.3.912
     * probably all versions of Sunbelt Kerio Personal Firewall 4
     * possibly older versions of Sunbelt Kerio Personal Firewall



More details and a proof of concept including source code is available here: 
http://www.matousec.com/info/advisories/Kerio-Multiple-insufficient-argument-validation-of-hooked-SSDT-functions.php

Regards,


-- 
David Matousek

Founder and Chief Representative of Matousec - Transparent security
http://www.matousec.com/

