
Date: Tue, 3 Oct 2006 07:55:39 +1000
From: Paul Szabo <psz@...hs.usyd.edu.au>
To: eaton.lists@...il.com
Cc: bugtraq@...urityfocus.com, full-disclosure@...ts.grok.org.uk
Subject: Re: [Full-disclosure] IE UXSS (Universal XSS in IE, was Re: Microsoft Internet Information Services UTF-7 XSS Vulnerability [MS06-053])

Brian Eaton <eaton.lists@...il.com> wrote:

> ... I just tested Apache 1.3.37 and Apache 2.2.3, and both specified a
> content-type header of "text/html; charset=iso-8859-1" for 404 responses ...

So, how "default" were your servers? On my own server (Debian package
apache2-common version 2.0.54-5sarge1) I see in apache2.conf:

  <IfModule mod_negotiation.c>
  <IfModule mod_include.c>
      Alias /error/ "/usr/share/apache2/error/"
      ...
      ErrorDocument 404 /error/HTTP_NOT_FOUND.html.var
      ...
  </IfModule>
  </IfModule>

but those modules are not mentioned in any LoadModule lines. The attack
worked fine also against a certain "HTTPS server of interest" here at USyd.

Would seem that if Apache is "internationalized" with those error messages
than you are safe, but not if you kept things "simple".

The bug is not in Apache, but in IE. Why would all web servers need to
specify some charset for each and every webpage...

Cheers,

Paul Szabo   psz@...hs.usyd.edu.au   http://www.maths.usyd.edu.au/u/psz/
School of Mathematics and Statistics   University of Sydney    Australia
