
Date: 29 Oct 2006 12:39:14 -0000
From: admin@...orsecurity.de
To: bugtraq@...urityfocus.com
Subject: [MajorSecurity Advisory #29]foresite CMS - Cross Site Scripting Issue

[MajorSecurity Advisory #29]foresite CMS - Cross Site Scripting Issue

Details
=======
Product: ForeSite CMS
Security-Risk: moderated
Remote-Exploit: yes
Vendor-URL: http://www.foresite.ch
Vendor-Status: informed
Advisory-Status: published

Credits
============
Discovered by: David Vieira-Kurz
http://www.majorsecurity.de

Original Advisory:
============
http://www.majorsecurity.de/index_2.php?major_rls=major_rls29

Introduction
============
foresite CMS is a content management system.

More Details
============
XSS:
Input passed directly to the "query" parameter in "search_de.html" is not properly sanitised before being returned to the user.
This can be exploited to execute arbitrary HTML and script code in a user's browser session in context of an affected site.

Fix
===
None

Solution
=============
Edit the source code to ensure that input is properly sanitised.
You should work with "htmlspecialchars()" or "htmlentities()" php-function to ensure that html tags
are not going to be executed. Further it is recommend to set off the "register globals" option in the
"php.ini" on your webserver.

Example:
$pass = htmlentities($_POST['pass']);
$test = htmlspecialchars($_GET('test'));
$id = intval($_POST['id']);
?>

History/Timeline
================
18.08.2006 discovery of the vulnerability
19.08.2006 additional tests with other versions
20.08.2006 contacted the vendor
05.09.2006 after 2 weeks the vendor didn't response
05.09.2006 contacted the vendor again
05.10.2006 vendor didn't response 
27.10.2006 advisory is written
29.10.2006 advisory released

MajorSecurity
=======
MajorSecurity is a German penetration testing and hacking security project
which consists of only one person at the present time.
I am looking for a partnership.
You can find more Information on the MajorSecurity Project at
http://www.majorsecurity.de/
