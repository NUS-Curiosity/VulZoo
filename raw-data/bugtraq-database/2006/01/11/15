
Date: Wed, 11 Jan 2006 09:35:16 -0800
From: "Advisories" <Advisories@...e.com>
To: <full-disclosure@...ts.grok.org.uk>, <ntbugtraq@...ugtraq.com>,
	<bugtraq@...urityfocus.com>, <vulnwatch@...nwatch.org>
Subject: [EEYEB-20051117B] Apple iTunes (QuickTime.qts)
	Heap Overflow


EEYEB-20051117B Apple iTunes (QuickTime.qts) Heap Overflow

Release Date:
January 10, 2006

Date Reported:
November 17, 2005

Patch Development Time (In Days):
54 Days

Severity:
High (Code Execution)

Vendor:
Apple

Systems Affected:
Quicktime on Windows 2000
Quicktime on Windows XP
Quicktime on Mac OS X 10.3.9

Apple iTunes on Windows 2000
Apple iTunes on Windows XP
Apple iTunes on OS X 10.3.9

Overview:
eEye Digital Security has discovered a critical vulnerability in Apple
iTunes. The vulnerability allows an attacker to reliably overwrite heap
memory with user-controlled data and execute arbitrary code in the
context of the user who executed iTunes.

This specific flaw exists within the QuickTime.qts file which many
applications access QuickTime's functionality through. By specially
crafting atoms within a movie file, a direct heap overwrite is
triggered, and reliable code execution is then possible.

Technical Details:
The code in QuickTime.qts responsible for copying Movie Resource atom
type sizes in a QuickTime-format movie into an array allocated on the
heap. According to developer.apple.com, the format of the Movie Resource
atom is as follows:

Field           Description
---------------------------
Atom Size       4 bytes
Atom Type       4 bytes
Data            Variable

By supplying the .MOV file with a large atom size results in a
insufficiently-sized heap block to be allocated, resulting in a complete
heap memory overwrite ultimately failing in the List_Component()
function.  

References
QuickTime: QuickTime File Format
http://developer.apple.com/documentation/QuickTime/QTFF/index.html

Vendor Status:
Apple has released a patch for this vulnerability. The patch is
available via the Updates section of the affected applications.
This vulnerability has been assigned the CVE identifier CAN-2004-0431.

Credit:
Discovery: Karl Lynn

Copyright (c) 1998-2006 eEye Digital Security
Permission is hereby granted for the redistribution of this alert
electronically. It is not to be edited in any way without express
consent of eEye. If you wish to reprint the whole or any part of this
alert in any other medium excluding electronic medium, please email
alert@...e.com for permission.

Disclaimer
The information within this paper may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are no warranties, implied or express, with regard to this information.
In no event shall the author be liable for any direct or indirect
damages whatsoever arising out of or in connection with the use or
spread of this information. Any use of this information is at the user's
own risk.
_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/


