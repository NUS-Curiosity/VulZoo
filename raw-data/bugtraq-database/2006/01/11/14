
Date: Wed, 11 Jan 2006 09:33:18 -0800
From: "Advisories" <Advisories@...e.com>
To: <full-disclosure@...ts.grok.org.uk>, <ntbugtraq@...ugtraq.com>,
	<bugtraq@...urityfocus.com>, <vulnwatch@...nwatch.org>
Subject: [EEYEB-20051220] Apple QuickTime QTIF Stack
	Overflow


EEYEB-20051229 Apple QuickTime QTIF Stack Overflow

Release Date:
January 10, 2006

Date Reported:
December 29, 2005

Patch Development Time (In Days):
12 days    

Severity:
High (Code Execution)

Vendor:
Apple

Systems Affected:
Quicktime on Windows 2000
Quicktime on Windows XP
Quicktime on Mac OS X 10.3.9


Overview:
eEye Digital Security has discovered a critical vulnerability in
QuickTime Player. There is a stack overflow in the way QuickTime
processes qtif format files. An attacker can create a qtif file and send
it to the user via email, web page, or qtif file with activex and can
directy overflow a function pointer immediately used so it can bypass
any stack overflow protection in systems such as xp sp2 and 2003 sp1.

Technical Details:
When Quicktime processes the data field of a qtif format file, it will
copy it to the stack by a byte to a byte , but there is no proper
checking, so it will cause a stack overflow in memory. And in this
stack, there is a function pointer which will be used immediately when
it pre byte copies, so we can use it to bypass any stack overflow
protection, such in xp sp2 and 2003 sp1.

The origin function point value is 0x44332211.  We only need to overflow
it to : 0x08332211, ensuring it didn't cause a crash before the 0x44 has
been overflowed to 0x08.  When it overflows to 0x08332211, we can
execute code to 0x08332211, and can first use javascript to get this
memory and set my code in it.

call    [esp+138h+arg_4] <- call a function point in the stack, but this
point can be overflowed


References
QuickTime: QuickTime File Format
http://developer.apple.com/documentation/QuickTime/QTFF/index.html

Protection:
Retina Network Security Scanner has been updated to identify this
vulnerability.

Vendor Status:
Apple has released a patch for this vulnerability. The patch is
available via the Updates section of the affected applications.
This vulnerability has been assigned the CVE identifier CVE-2005-3713.

Credit:
Discovery: Fang Xing

Greetings:
Thanks to all the guys at eEye, and especially Karl Lynn's help.

Copyright (c) 1998-2006 eEye Digital Security
Permission is hereby granted for the redistribution of this alert
electronically. It is not to be edited in any way without express
consent of eEye. If you wish to reprint the whole or any part of this
alert in any other medium excluding electronic medium, please email
alert@...e.com for permission.

Disclaimer
The information within this paper may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are no warranties, implied or express, with regard to this information.
In no event shall the author be liable for any direct or indirect
damages whatsoever arising out of or in connection with the use or
spread of this information. Any use of this information is at the user's
own risk.
_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/


