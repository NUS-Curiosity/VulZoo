
Date: Fri, 29 Sep 2006 17:09:25 +0200
From: Secunia Research <remove-vuln@...unia.com>
To: vuln@...unia.com
Cc: bugtraq@...urityfocus.com
Subject: Secunia Research: Joomla BSQ Sitestats Component Multiple
	Vulnerabilities

====================================================================== 

                     Secunia Research 29/09/2006

      - Joomla BSQ Sitestats Component Multiple Vulnerabilities -

====================================================================== 
Table of Contents

Affected Software....................................................1
Severity.............................................................2
Vendor's Description of Software.....................................3
Description of Vulnerability.........................................4
Solution.............................................................5
Time Table...........................................................6
Credits..............................................................7
References...........................................................8
About Secunia........................................................9
Verification........................................................10

====================================================================== 
1) Affected Software

BSQ Sitestats (component for Joomla) 1.x

NOTE: Other versions may also be affected.

====================================================================== 
2) Severity 

Rating: Highly critical
Impact: System access
        Manipulation of data
        Cross Site Scripting
Where:  From remote

====================================================================== 
3) Vendor's Description of Software 

"BSQ Sitestats is a site stats module that is lightweight on the front
end but offers both tabular and graphical summaries of site visitors'
sessions on the backend".

Product Link:
http://developer.joomla.org/sf/projects/bsq_sitestats


====================================================================== 
4) Description of Vulnerability

Secunia Research has discovered some vulnerabilities in the BSQ
Sitestats component for Joomla, which can be exploited by malicious
people to conduct cross-site scripting and SQL injection attacks, and
to compromise a vulnerable system.

1) Input passed to the "ip" form field parameter when performing an IP
Address Lookup is not properly sanitised before being returned to the
user. This can be exploited to execute arbitrary HTML and script code
in a logged in administrator's browser session in context of an
affected site.

2) Input passed to multiple parameters when importing the
ip-to-country.csv file is not properly sanitised before being used in a
SQL query. This can be exploited to manipulate SQL queries by injecting
arbitrary SQL code when an administrator is tricked into importing a
malicious ip-to-country.csv file.

3) Input passed via the "HTTP Referer", the "HTTP User Agent", and the
"HTTP Accept Language" Header bsqtemplateinc.php is not properly
sanitised before being used in SQL queries. This can be exploited to
manipulate SQL queries by injecting arbitrary SQL code.

Successful exploitation requires that "magic_quotes_gpc" is disabled.

4) Input passed to the "baseDir" parameter in
components/com_bsq_sitestats/external/rssfeeds.php is not properly
verified before being used to include files. This can be exploited to
execute arbitrary PHP code by including files from local or external
resources.

Successful exploitation requires that "register_globals" is enabled.   

The vulnerabilities have been confirmed in version 1.8.0. Other
versions may also be affected.

====================================================================== 
5) Solution 

The vulnerabilities have been fixed in version 2.2.1.

====================================================================== 
6) Time Table 

14/09/2006 - Vendor notified.
14/09/2006 - Vendor response.
17/09/2006 - Vendor releases fixed version 2.2.1.
29/09/2006 - Public disclosure.

====================================================================== 
7) Credits 

Discovered by Sven Krewitt, Secunia Research.

====================================================================== 
8) References

None assigned.

====================================================================== 
9) About Secunia

Secunia offers vulnerability management solutions to corporate
customers with verified and reliable vulnerability intelligence
relevant to their specific system configuration:

http://corporate.secunia.com/

Secunia also provides a publicly accessible and comprehensive advisory
database as a service to the security community and private 
individuals, who are interested in or concerned about IT-security.

http://secunia.com/

Secunia believes that it is important to support the community and to
do active vulnerability research in order to aid improving the 
security and reliability of software in general:

http://corporate.secunia.com/secunia_research/33/

Secunia regularly hires new skilled team members. Check the URL below to
see currently vacant positions:

http://secunia.com/secunia_vacancies/

Secunia offers a FREE mailing list called Secunia Security Advisories:

http://secunia.com/secunia_security_advisories/ 

====================================================================== 
10) Verification 

Please verify this advisory by visiting the Secunia website:
http://secunia.com/secunia_research/2006-63/

Complete list of vulnerability reports published by Secunia Research:
http://secunia.com/secunia_research/

======================================================================



