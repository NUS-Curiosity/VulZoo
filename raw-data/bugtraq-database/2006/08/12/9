
Date: Sat, 12 Aug 2006 19:23:55 +0200
From: "Benjamin Tobias Franz" <0-1-2-3@....de>
To: <bugtraq@...urityfocus.com>
Subject: Microsoft Help (WINHLP32.EXE) - Multiple Remote Code Execution and Denial Of Service Vulnerabilities

Microsoft Help (WINHLP32.EXE) - Multiple Remote Code Execution and Denial Of
Service Vulnerabilities
... discovered by Benjamin Tobias Franz

Affected Vendor:
Microsoft

Affected Product:
Microsoft Windows - Microsoft Help (WINHLP32.EXE)

Description:
Multiple remote code execution and denial of service vulnerabilities exists
in Microsoft Help (WINHLP32.EXE) because of the way that it handles
Microsoft Windows Help files (*.HLP).
An attacker could exploit this by placing a specially crafted help file on a
webpage, or by sending the file as an attachment in an e-mail. The exploit
is triggered by viewing the specially crafted help file. No user interaction
is required. An attacker who successfully exploited this vulnerability could
take complete control of the affected system.

Workaround:
Do not open any HLP file from untrusted sources with Microsoft Help.

Proof-Of-Concept files (simple demonstration files only):
http://hometown.aol.de/qwertzset/BTFs_MSHelp_WINHLP32.EXE_POCFiles.zip

Date of discovery:
20. - 22. July 2006

Tested software:
Microsoft Help on Windows XP SP2
(WINHLP32.EXE: 5.1.2600.2180 | MSVCRT.DLL: 7.0.2600.2180)

Probably all versions of Microsoft Windows are affected by these bugs.


Regards,

Benjamin Tobias Franz,
Germany 

