
Date: Tue, 16 May 2006 16:14:09 -0400
From: Chris Brenton <cbrenton@...isbrenton.org>
To: sanjaynaik@...e.org
Cc: bugtraq@...urityfocus.com
Subject: Re: Checkpoint SYN DoS Vulnerability


On Tue, 2006-05-16 at 11:09 -0400, sanjay naik wrote:
>
> When a scan is intiated from the Inside interface of Checkpoint firewall, 
> the firewall responds with bogus information intermittently.

Sounds like you are triggering the SYN flood protection. Typically the
firewall will respond with a SYN/ACK to ensure the source is not just
generating a SYN flood. If you close the handshake, the connection is
passed through to the target host if it is permitted in the rules. If
not, the connection is simply deleted from the state table and ignored.

Not sure why you are calling this a DoS as it does not sound like
regular connectivity is being effected. The exception would be if you
generated enough bogus SYN packets to fill up the state table so legit
connections could not get through. I seem to remember Lance posting info
about that to this list 4-5 years ago.

> In both cases, the scans results were inconsistent. Both SYN and ACK 
> scans had similar issues.

IMHO this is a feature. I would certainly rather see a port scanner
receiving bogus results rather than accurate info that would assist in a
compromise. Make them work a bit harder and earn it. ;-)

HTH,
Chris




