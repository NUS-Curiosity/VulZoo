
Date: Fri, 01 Dec 2006 11:12:26 +0100
From: Matousec - Transparent security Research <research@...ousec.com>
To: bugtraq@...urityfocus.com
Subject: Outpost Bypassing Self-Protection via Advanced DLL injection with
 handle stealing Vulnerability

Hello,

We would like to inform you about a vulnerability in Outpost Firewall PRO 4.0.


Description:

The system process services.exe cares about system services. It runs them during the system boot and thus owns full 
access handles to all system services. Outpost protects all processes against common DLL injection and forbids other 
processes to manipulate its own service process. However, it does not protect services.exe against Advanced DLL 
injection that does not rely on writing into the target process memory. It is possible to infect services.exe with a 
malicious DLL and execute an arbitrary code in this system process. It is also possible to find and use its handle of 
the outpost.exe process to infect Outpost service process similarly. As a result, the attacker is able to inject an 
arbitrary code into the Outpost's process and thus bypass any of its security mechanisms.



Vulnerable software:

     * Outpost Firewall PRO 4.0 (971.584.079)
     * Outpost Firewall PRO 4.0 (964.582.059)
     * probably all older versions of Outpost Firewall PRO 4.0
     * possibly older versions of Outpost Firewall PRO




More details and a proof of concept including its source code are available here: 
http://www.matousec.com/info/advisories/Outpost-Bypassing-Self-Protection-via-Advanced-DLL-injection-with-handle-stealing.php


Regards,

-- 
Matousec - Transparent security Research
http://www.matousec.com/
