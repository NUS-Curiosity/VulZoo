
Date: Wed, 21 Feb 2007 18:03:23 -0500
From: iDefense Labs <labs-no-reply@...fense.com>
To: vulnwatch@...nwatch.org, full-disclosure@...ts.grok.org.uk,
	bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 02.16.07: Trend Micro ServerProtect Web
 Interface Authorization Bypass Vulnerability

Trend Micro ServerProtect Web Interface Authorization Bypass Vulnerability

iDefense Security Advisory 02.16.07
http://labs.idefense.com/intelligence/vulnerabilities/
Feb 16, 2007

I. BACKGROUND

Trend ServerProtect is an Anti-virus application designed to run on file
servers to catch viruses before they make it to network users. More
information can be found on the vendors site at:

http://www.trendmicro.com/en/products/file-server/sp-linux/evaluate/overview.htm

II. DESCRIPTION

TrendMicro's ServerProtect product uses a web interface which runs on port
TCP 14942 to configure the product. This interface is protected with a
user configurable password. Upon successful login, a cookie is set with
the name 'splx_2376_info' and a valid session id as its value.

The ServerProtect web application suffers from a design error
vulnerability in its authorization checking routines. Attackers can gain
full access to the web application by requesting any internal page while
supplying their own 'splx_2376_info' cookie with an arbitrary value.

III. ANALYSIS

Exploitation of this vulnerability allows a remote attacker to edit and
disable Anti-Virus features on the server machine.

Cookie values can be easily edited using raw HTTP requests or tools such
as intercept proxies and browser plug-ins. By not checking for a valid
session id and only looking for the cookie name, any value can grant an
attacker full access to the web application.

IV. DETECTION

iDefense has confirmed this vulnerability in Trend ServerProtect v1.3 for
Linux. This vulnerability is not present in the Windows based versions of
Server protect.

V. WORKAROUND

iDefense recommends limiting network access to the ServerProtect web
interface to trusted clients.

VI. VENDOR RESPONSE

Trend Micro has address this vulnerability with a patch release. More
information is available at the Trend Micro Update Center for
ServerProtect for Linux at the following URL.

http://www.trendmicro.com/download/product.asp?productid=20

VII. CVE INFORMATION

A Mitre Corp. Common Vulnerabilities and Exposures (CVE) number has not
been assigned yet.

VIII. DISCLOSURE TIMELINE

01/17/2007  Initial vendor notification
01/24/2007  Initial vendor response
02/16/2007  Coordinated public disclosure

IX. CREDIT

This vulnerability was reported to iDefense by Damian Put.

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2007 iDefense, Inc.

Permission is granted for the redistribution of this alert electronically.
It may not be edited in any way without the express written consent of
iDefense. If you wish to reprint the whole or any part of this alert in
any other medium other than electronically, please e-mail
customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate at
the time of publishing based on currently available information. Use of
the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on, this
information.
