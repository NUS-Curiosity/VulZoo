
Date: Sun, 04 Feb 2007 07:14:39 +0200
From: Amit Klein <aksecurity@...il.com>
To: Michal Zalewski <lcamtuf@...ne.ids.pl>
Cc: bugtraq@...urityfocus.com, full-disclosure@...ts.grok.org.uk,
	websecurity@...appsec.org
Subject: Re: Web 2.0 backdoors made easy with MSIE & XMLHttpRequest

Michal Zalewski wrote:
> On Sat, 3 Feb 2007, Michal Zalewski wrote:
>
>   
>>   xmlhttp.open("GET\thttp://dione.ids.pl/\tHTTP/1.0\n\n", "x",true);
>>     
>
> Funny enough, Paul Szabo was quick to point out that Amit Klein found the
> same vector that I used here for client-side backdoors in May 2006 (still
> not patched?! *shrieks in horror*), but for cache poisoning:
>
>   "IE + some popular forward proxy servers = XSS, defacement (browser cache poisoning)"
>   http://www.securityfocus.com/archive/1/434931
>
> This is getting depressing. May 2006.
>
>   
Much worse. The basic technique already appeared in two of my previous 
write-ups:

"Exploiting the XmlHttpRequest object in IE - Referrer spoofing, and a 
lot more..." (September 2005)
http://www.securityfocus.com/archive/1/411585

"XS(T) attack variants which can, in some cases, eliminate the need for 
TRACE </archive/107/308433/30/0/threaded>" (January 2003)
http://www.securityfocus.com/archive/107/308433

The 2005 text does briefly mention "Accessing content / web-scanning" 
(take a look at Notes 1-3).

So the problem is much older.

Thanks,
-Amit
