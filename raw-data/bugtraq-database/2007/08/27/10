
Date: Mon, 27 Aug 2007 11:01:23 -0400
From: iDefense Labs <labs-no-reply@...fense.com>
To: vulnwatch@...nwatch.org, full-disclosure@...ts.grok.org.uk,
	bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 08.27.07: Motorola Timbuktu Pro Directory
 Traversal Vulnerability

Motorola Timbuktu Pro Directory Traversal Vulnerability

iDefense Security Advisory 08.27.07
http://labs.idefense.com/intelligence/vulnerabilities/
Aug 27, 2007

I. BACKGROUND

Motorola Inc.'s Timbuktu Pro is a remote control software which allows
remote access to a computer's desktop. It is available for Mac OS X and
Windows systems and provides integration with Skype and SSH. More
information is available from the product web site at the following
URL.

http://netopia.com/software/products/tb2/

II. DESCRIPTION

Remote exploitation of a directory traversal vulnerability in Motorola
Inc.'s Timbuktu Pro allows attackers to delete or create files with
SYSTEM privileges.

When handling "Send" requests, Timbuktu does not properly check for
directory traversal specifiers. Therefore, by including a sequence such
as "../../../", an attacker is able to write outside of the intended
location. Additionally, if the file already exists, the file is created
with a new name. However, if the connection is broken before the
transfer completes, Timbuktu will delete the originally specified
file name instead of the new name.

III. ANALYSIS

Exploitation of this vulnerability could allow an attacker to gain
control over the affected machine.

Since the attacker can delete and create arbitrary files with SYSTEM
privileges, they are able to write to important system files such as
libraries, or start up files that will result in arbitrary code
execution.

It is important to note that the evaluation version used for testing
enables "Send" privileges by default for "Guest" users.

IV. DETECTION

iDefense confirmed the existence of this vulnerability in version
8.6.3.1367 of Motorola Inc.'s Timbuktu Pro for Windows. Other versions,
including those for other operating systems are suspected to be
vulnerable.

V. WORKAROUND

Removing the "Send" privilege from all Timbuktu Pro users will prevent
the vulnerability from being exploited.

VI. VENDOR RESPONSE

Motorola Inc. has addressed this vulnerability by releasing version
8.6.5 of Timbuktu Pro for Windows. For more information, consult the
release notes at the following URL.

ftp://ftp-xo.netopia.com/evaluation/docs/timbuktu/win/865/relnotes/TB2Win865Evalrn.pdf

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2007-4220 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org/), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

05/15/2007  Initial vendor response
05/16/2007  Initial vendor notification
08/27/2007  Coordinated public disclosure

IX. CREDIT

This vulnerability was reported to iDefense by Titon of BastardLabs.

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2007 iDefense, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDefense. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically,
please e-mail customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
 There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct,
indirect, or consequential loss or damage arising from use of, or
reliance on, this information.
