
Date: Mon, 10 Dec 2007 22:03:03 +0100
From: Pierre-Yves Rofes <py@...too.org>
To: gentoo-announce@...too.org
Cc: full-disclosure@...ts.grok.org.uk, bugtraq@...urityfocus.com,
	security-alerts@...uxsecurity.com
Subject: [ GLSA 200712-10 ] Samba: Execution of arbitrary code

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Gentoo Linux Security Advisory                           GLSA 200712-10
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
                                            http://security.gentoo.org/
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  Severity: High
     Title: Samba: Execution of arbitrary code
      Date: December 10, 2007
      Bugs: #200773
        ID: 200712-10

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Synopsis
========

Samba contains a buffer overflow vulnerability potentially resulting in
the execution of arbitrary code.

Background
==========

Samba is a suite of SMB and CIFS client/server programs for UNIX.

Affected packages
=================

    -------------------------------------------------------------------
     Package       /  Vulnerable  /                         Unaffected
    -------------------------------------------------------------------
  1  net-fs/samba      < 3.0.28                              >= 3.0.28

Description
===========

Alin Rad Pop (Secunia Research) discovered a boundary checking error in
the send_mailslot() function which could lead to a stack-based buffer
overflow.

Impact
======

A remote attacker could send a specially crafted "SAMLOGON" domain
logon packet, possibly leading to the execution of arbitrary code with
elevated privileges. Note that this vulnerability is exploitable only
when domain logon support is enabled in Samba, which is not the case in
Gentoo's default configuration.

Workaround
==========

Disable domain logon in Samba by setting "domain logons = no" in the
"global" section of your smb.conf and restart Samba.

Resolution
==========

All Samba users should upgrade to the latest version:

    # emerge --sync
    # emerge --ask --oneshot --verbose ">=net-fs/samba-3.0.28"

References
==========

  [ 1 ] CVE-2007-6015
        http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6015

Availability
============

This GLSA and any updates to it are available for viewing at
the Gentoo Security Website:

  http://security.gentoo.org/glsa/glsa-200712-10.xml

Concerns?
=========

Security is a primary focus of Gentoo Linux and ensuring the
confidentiality and security of our users machines is of utmost
importance to us. Any security concerns should be addressed to
security@...too.org or alternatively, you may file a bug at
http://bugs.gentoo.org.

License
=======

Copyright 2007 Gentoo Foundation, Inc; referenced text
belongs to its owner(s).

The contents of this document are licensed under the
Creative Commons - Attribution / Share Alike license.

http://creativecommons.org/licenses/by-sa/2.5
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFHXamHuhJ+ozIKI5gRAk1aAJ9kakUOiNhCjcVKNwGMEoOqFndK5QCfelye
Rkx2F6FEHdWEFt9slV9rTHU=
=H7RY
-----END PGP SIGNATURE-----
