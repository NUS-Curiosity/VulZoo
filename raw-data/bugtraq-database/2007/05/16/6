
Date: Tue, 15 May 2007 23:15:26 +0100
From: David Cantrell <d.cantrell@...cometechnologies.com>
To: bugtraq@...urityfocus.com
Subject: Re: Apple Safari on MacOSX may reveal user's saved passwords

Injecting Javascript into a browser like this does *not* require that 
the attacker be on the local console.  To run Applescript while logged 
inremotely using ssh, you can use the 'osascript' utility.

It works for:
   the same user using ssh as is on the console;
   the root user using ssh (or someone who can sudo) can inject
     Javascript into the console user's browser;
   a different non-root user on the console can do it too

That last one is particularly worrying, although I've not taken the time 
to figure out precisely what works and what doesn't.  My test was to 
simply open a Terminal and 'su - foo' before using osascript, but it 
might, for instance, be exploitable by a setuid application.

At first glance, Firefox doesn't seem to be vulnerable (although I'm far 
from being an Applescript expert) to exactly this attack, but it does 
expose at least *some* functionality to Applescript.

-- 
David Cantrell
