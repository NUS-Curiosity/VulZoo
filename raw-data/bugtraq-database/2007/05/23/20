
Date: Wed, 23 May 2007 14:56:05 -0400
From: "Mark-David McLaughlin (marmclau)" <marmclau@...co.com>
To: <bugtraq@...urityfocus.com>
Subject: RE: Cisco CallManager 4.1 Input Validation Vulnerability

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Hi Stefan,

In their advisory below, Marc and Stefan illustrate how to bypass the
web
application firewall used in Cisco CallManager. This means of bypass can
be
used to display graphics, scripts, or other information downloaded from
an
external web site. This technique may also be used to conduct cross-site
scripting attacks. Cisco confirms that the example the authors provided
bypasses the web application firewall and that there may be other
methods
for bypassing the web application firewall.

Cisco has made improvements to the input validation mechanisms in
CallManager that may mitigate the risks associated with this security
vulnerability. These improvements have been incorporated into 4.2(3)sr2.
Future releases, 3.3(5)sr3, 4.1(3)sr5 and 4.3(1)sr1, will also include
the
improvements made to address this bug. This issue is being tracked by
the
following Cisco Bug ID:

  * CSCsi12374 - Improvements in User Input Validation

Service releases of CallManager software are available at the following
link:

http://www.cisco.com/public/sw-center/sw-voice.shtml

Additional Information
======================

Cisco CallManager is the software-based call-processing component of the
Cisco IP telephony solution that extends enterprise telephony features
and
functions to packet telephony network devices, such as IP phones, media
processing devices, voice-over-IP (VoIP) gateways, and multimedia
applications. The vulnerability described in this response exists in the
web application firewall used in CallManager. This feature is designed
to
prevent users from entering malicious code into the input fields used in
CallManager forms. The vulnerability exists because the web application
firewall fails to properly sanitize some potentially malicious tags.

To exploit these issues an attacker must convince an authenticated user
to
follow a specially crafted, malicious URL. A successful attack may
result
in the execution of arbitrary script code in the user's web browser.

For additional information on cross-site scripting (XSS) attacks and the
methods used to exploit such vulnerabilities, please refer to the Cisco
Applied Intelligence Response "Understanding Cross-Site Scripting (XSS)
Threat Vectors," which is available at the following link:

http://www.cisco.com/en/US/products/ps6120/tsd_products_security_respons
e09
186a008073f7b3.html

The Cisco PSIRT is not aware of any malicious use of the vulnerability
described in this document.

We would like to thank Marc Ruef and Stefan Friedi for bringing this
issue
to our attention and for working with us toward coordinated disclosure
of
the issue. We greatly appreciate the opportunity to work with
researchers
on security vulnerabilities, and welcome the opportunity to review and
assist in product reports.

Cheers,

Mark-David McLaughlin
Product Security Incident Response Team (PSIRT) Cisco Systems, Inc.


- -----Original Message-----
From: Stefan Friedli [mailto:stefan.friedli@...il.com] On Behalf Of
Stefan
Friedli
Sent: Wednesday, May 23, 2007 10:11 AM
To: bugtraq@...urityfocus.com
Cc: full-disclosure@...ts.grok.org.uk; news@...uriteam.com;
support@...unia.com
Subject: Cisco CallManager 4.1 Input Validation Vulnerability

Cisco CallManager 4.1 Input Validation Vulnerability

scip AG Vulnerability ID 2977 (03/13/2007)
http://www.scip.ch/cgi-bin/smss/showadvf.pl?id=2977

I. INTRODUCTION

Cisco CallManager, short CCM, is a professional voice-over-IP solution
that tracks active components, including among others phones, gateways,
conference bridges, transcoding resources and voicemail boxes.

II. DESCRIPTION

Marc Ruef and Stefan Friedli found a web-based vulnerability that was
identified in Cisco CallManager 4.1 and may affect earlier versions as
well.

The web interface of the application fails to properly santisize data
supplied by the search-form before displaying it back to the user.
Though several filters are in place to prevent the injection of <script>
Tags or action handlers such as "onclick" or "onmouseover", it is
possible to inject html-code including common attributes. This allows
the embedding of external references, e.g. images or flash resources.
The vulnerability also allows an attacker to use the "style"-attribute
on any tag to conduct arbitrary web-based attacks.

Example:
https://example.com/CCMAdmin/serverlist.asp?findBy=servername&match=begi
ns&
pattern=<img%20src='http://www.scip.ch/scip.gif'%20style='border:%201px%
20s
olid%20black;'>

IV. IMPACT

This vulnerability may be exploited by tricking authenticated users into
clicking a crafted link in order to conduct arbitrary web-based attacks.

V. DETECTION

Detection of web based attacks requires a specialized web proxy and/or
intrusion detection system. Patterns for detection of basic attacks are
available and easy to implement, though they may possibly fail on more
sophisticated attacks.

VI. SOLUTION

Server-side input validation should be improved to prevent the injection
of unauthorized code. Cisco has taken appropriate steps regarding this
issue, see vendor response (VII) for details.

VII. VENDOR RESPONSE

A representative of the Cisco Product Security Incident Response Team
(PSIRT) stated, that this kind of exploitation is blocked by
improvements to the web application firewall used in CallManager. The
Cisco PSIRT team has issued a formal security response available at:
http://www.cisco.com/warp/public/707/cisco-sr-20070523-ccm.shtml.

VIII. SOURCES

scip AG - Security Consulting Information Process (german)
http://www.scip.ch

scip AG Vulnerability Database (german)
http://www.scip.ch/cgi-bin/smss/showadvf.pl?id=2977

IX. DISCLOSURE TIMELINE

03/13/07        Identification of the vulnerabilities
03/13/07        Notification of the vendor
03/14/07        Response from Mark-David McLaughlin [marmclau@...co.com]
of the PSIRT
03/19/07        Status Notification by PSIRT
03/28/07        Status Notification by PSIRT
04/18/07        Status Notification by PSIRT
04/20/07        Status Notification by PSIRT
05/02/07        Status Notification by PSIRT
05/05/07        Coordination of public release
05/16/07        Final Vendor Response received
05/23/07        Public Release

IX. CREDITS

The vulnerabilities were discovered by Marc Ruef and Stefan Friedli.

     Marc Ruef, scip AG, Zuerich, Switzerland
     maru-at-scip.ch
     http://www.scip.ch

     Stefan Friedli, scip AG, Zuerich, Switzerland
     stfr-at-scip.ch
     http://www.scip.ch

     Thanks to Mark-David McLaughlin (PSIRT) for cooperating.


A2. LEGAL NOTICES

Copyright (c) 2007 scip AG, Switzerland.

Permission is granted for the re-distribution of this alert. It may not
be edited in any way without permission of scip AG.

The information in the advisory is believed to be accurate at the time
of publishing based on currently available information. There are no
warranties with regard to this information. Neither the author nor the
publisher accepts any liability for any direct, indirect or
consequential loss or damage from use of or reliance on this advisory.

-----BEGIN PGP SIGNATURE-----
Version: PGP Desktop 9.6.1 (Build 1012)

wsBVAwUBRlSOB47/e0tttOToAQj9MAgAgFV2Uv9XFfomktJXtG/K/HWpVQ42JbZ9
wXCVwSUZNIJ8/cKhwZ6MwBBtF7V9dKYFhatamB9fXRAAUMWBw/I2rOtybxag7MT2
PE1+NS4FMrBGKo5NZXiHtAwOrF02od73C4tXAVdK3KGTr9PKHIwqJWUsuTEohsZy
XL/LUYV3KI9nWrYV3T0zqezrdcjvfwOBFzNVlYir9DgUeGh6XRZMYpJNhUGQYCpL
yf0YuS41yIbkqSb+2/nvXHrycRqLQV3x0pcQr6gHdwbauHqBmewlPxRzZm0uwZu2
7/fWHDeX0IInAQsT/786HcKI6E3xtYF0TJJUc12pOWlTln9I6kye1A==
=H6vK
-----END PGP SIGNATURE-----
