
Date: 2 May 2007 00:11:20 -0000
From: jcarlos.norte@...il.com
To: bugtraq@...urityfocus.com
Subject: Wordpress All versions XSS

Advisory by Jose Carlos Norte

Wordpress is vulnerable to XSS attacks when custom 404 pages are used by the template.

The problem (sidebar.php):

<form method="get" id="searchform" action="<?php echo $_SERVER['PHP_SELF']; ?>">

if wordpress template use custom 404 pages, like:


<?php get_header(); ?>

        <div id="content" class="narrowcolumn">

                <h2 class="center">Error 404 - Not Found</h2>

        </div>

<?php get_sidebar(); ?>

$_SERVER['PHP_SELF']; can contain special characters to break out html and perform XSS attacks, example:

http://www.example.com/index.php/"><script>alert(document.cookie)</script>

if no custom 404 page set by wordpress theme this attacks is not posible.



