
Date: Fri, 26 Jan 2007 21:46:50 -0800
From: Chris Travers <chris@...atrontech.com>
To: bugtraq@...urityfocus.com
Subject: Full Disclosure:  Arbitrary Code Execution in LedgerSMB CVE-2006-5872

CVE-2006-5872 (filed against SQL-Ledger) also affects LedgerSMB.  This 
was first fixed in LedgerSMB 1.1.5 but due to a number of unrelated 
bugs, we recommend upgrading to 1.1.7.  SQL-Ledger fixed the problem in 
2.6.21.

This occurs due to the improper handling of input handling in the 
redirect function which also allows the user to specify a file with 
arguments to be run via Perl.  However, since one can specify -e as the 
script (making the command line perl -e ....) one can specify whatever 
code to execute one would like.

The following link demonstrates the vulnerability.

http://127.0.0.1/sql-ledger/login.pl?login=demo&script=-e%3fprint%20STDERR%20%27hello%20world%27%3b&action=logout 
<http://127.0.0.1/sql-ledger/login.pl?login=demo&script=-e%3fprint%20STDERR%20%27hello%20world%27%3b&action=logout>

Best Wishes,
Chris Travers
Metatron Technology Consulting

View attachment "chris.vcf" of type "text/x-vcard" (172 bytes)
