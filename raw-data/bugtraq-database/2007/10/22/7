
Date: Sat, 20 Oct 2007 18:52:27 +0200
From: "Michal Bucko" <michal.bucko@...ytt.com>
To: bugtraq@...urityfocus.com
Subject: [ELEYTT] Public Advisory 20-10-2007

Eleytt Research
www.eleytt.com



Overview:
====================
Michal Bucko, Eleytt, http://www.eleytt.com/michal.bucko
Tomasz Polis, Eleytt, http://www.eleytt.com/



Credit:
====================

Michal Bucko, Eleytt, www.eleytt.com/michal.bucko







Vulnerability Table
===================

1. Firefox 2.0.0.7 ParseFTPList Remote Denial of Service Vulnerability
2. Zaptel 1.4.5.1 SetHDLC.c Local Buffer Overflow Vulnerability



Vulnerability Details
=========================
=========================


1. Firefox 2.0.0.7 ParseFTPList Remote Denial of Service Vulnerability
   ===================================================================

Firefox 2.0.0.7 is prone to remote denial of service vulnerability. This
can be achieved via enticing the unaware victim to open a specially
crafted  ftp server. While listing files (ParseFTPList.cpp), reading
from invalid pointer occurs that results in denial of service conditions.


004C848E  |. 8985 5CFFFFFF  |MOV DWORD PTR SS:[EBP-A4],EAX
004C8494  |. 8B00           |MOV EAX,DWORD PTR DS:[EAX]

004C8496  |. 0FBE00         |MOVSX EAX,BYTE PTR DS:[EAX]; here is the crash

In ParseFTPList.cpp 'pos' is not properly sanitized, thus
an out of
bounds array access (on line 1039; 'pos' can be greater than the
number of indices in the 'tokens' array).

The exploitation of the vulnerability has been proven using a FTP
server and a specially crafted file. Firefox failed to handle the
FTP list parsing.

Note that Firefox 2.0.0.8 is not vulnerable. Special thanks to
iDefense and Mozilla community for the cooperation.





2. Zaptel 1.4.5.1 SetHDLC.c Local Buffer Overflow Vulnerability
   ====================================================================

Zaptel 1.4.5.1 is prone to buffer overflow vulnerability when copying
user-supplied device name to req.ifr_name (sethdlc.c), where req is an
object of ifreq (type).

Linux supports some standard ioctls to configure network devices. They
can be used on any socket's file descriptor regardless of the family
or type. They pass an ifreq structure:

struct ifreq {
    char    ifr_name[IFNAMSIZ];/* Interface name */
	..









Meet Our Business Continuity Program!
=====================================

Eleytt offers Eleytt Business Continuity Program. What is it?

- Long-term continous security audits
- Security consulting and training
- Security policy compliance issues

For more information, please refer to eleytt.com, http://www.eleytt.com





Eleytt - Company Information
============================

Eleytt Corporation is specialized in penetration testing, vulnerability
development, advanced reverse engineering and exploitation techniques.
Eleytt provides various security-related services: risk assessment,
security policy, security assurance, incident management, web
application security testing, continuous security assurance programs.
Eleytt provides security audits for financial institutions and e-commerce.
Eleytt provides an in-depth security analysis - experienced security
experts analyze your source code, analyze your application, analyze your
web application. Eleytt runs security programs for financial institutons
and e-commerce.

We have the mission to improve the security level of software and web
applications. It is us who help you implement more secure applications.
We help you understand the risk and deploy security solutions. We help
you avoid costly business disruptions.




These are the questions, which might help you understand how we work:
=====================================================================

Want to get your web site checked for security vulnerabilities?

Your server requires real penetration testing?

Interested in Eleytt Business Continuity Program?

Interested in Eleytt Application Security Program?

For more information, please use:

http://www.eleytt.com








DISCLAIMER
==========

This document and all the information it contains are provided "as is",
for educational purposes only, without warranty of any kind, whether
express or implied.

The authors reserve the right not to be responsible for the topicality,
correctness, completeness or quality of the information provided in
this document. Liability claims regarding damage caused by the use of
any information provided, including any kind of information which is
incomplete or incorrect, will therefore be rejected.

