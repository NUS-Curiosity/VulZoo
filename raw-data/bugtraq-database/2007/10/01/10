
Date: Mon, 1 Oct 2007 17:48:02 +0200
From: "Jerry Illikainen" <jerry@...ork.se>
To: bugtraq@...urityfocus.com
Subject: smbftpd 0.96 format string vulnerability

       smbftpd 0.96 format string vulnerability
	
--------------------------------------------------------------------------
Versions:  0.96
           maybe earlier versions as well

Date:      01 Oct 2007

Author:    Jerry Illikainen
           email:  jerry@...ork.se
           www:    debork.se



Introduction
------------

"SmbFTPD is a FTP daemon for FreeBSD, Linux, and other UNIX like operating
system. It has flexible directory access control facility that could be
combined with Samba's share access right."



Vulnerability
-------------

A format string vulnerability exist in the SMBDirList-function, dirlist.c,
which gets called when a LIST/NLST is issued. It could be triggered by
the way it outputs recursive listing on directories.
It's caused due to misuse of fprintf.

In order for this vulnerability to be exploited, an attacker would need a
valid account (including anonymous) with permission to create directories.
Successful exploitation may allow an attacker to execute arbitrary code.



Proof of concept
----------------

http://debork.se/poc/001_smbftpd.c



Fix
---

Update to version 0.97



---
Jerry Illikainen
