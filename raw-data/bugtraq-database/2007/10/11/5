
Date: Wed, 10 Oct 2007 23:36:17 -0600
From: "M. Burnett" <mb@...o.net>
To: "'Thor (Hammer of God)'" <thor@...merofgod.com>,
	"'pdp (architect)'" <pdp.gnucitizen@...glemail.com>,
	<full-disclosure@...ts.grok.org.uk>, <bugtraq@...urityfocus.com>
Subject: RE: Remote Desktop Command Fixation Attacks

It is important to note that you can block this though a setting in the
Terminal Sevices Configuration admin tool. There is a setting to not allow
initial programs to be launch or to always launch a specific program. This
will always override any program specified by the client. You can also
configure this via group policy.

It is also important to note that if you can get a user to click on an
e-mail attachment you send them, you can probably do anything you want on
their computer anyway.



Mark Burnett
http://xato.net






> -----Original Message-----
> From: Thor (Hammer of God) [mailto:thor@...merofgod.com]
> Sent: Wednesday, October 10, 2007 4:11 PM
> To: pdp (architect); full-disclosure@...ts.grok.org.uk;
> bugtraq@...urityfocus.com
> Subject: RE: Remote Desktop Command Fixation Attacks
> 
> Security in depth is alive and well, thank you.  In fact, it is
> security
> in depth that allows administrators to prevent this type of "attack"
> (if
> we can actually make the stretch to call it that).
> 
> However, for the record, this is not an "attack."  You might as well
> just email the target and ask for their password.  Or if you can get
> them to open files, just send off a rootkit.  But let's ignore that for
> now- let's pretend that somehow this is a magic attack--  This is where
> security-in-depth comes in, and where the overall context of your post
> is incorrect:
> 
> First off, you block .rdp files at the SMTP gateway (that by itself is
> security in depth). Secondly, normal domain users don't RDP to external
> hosts, so there would never be an allow rule for outbound RDP.  Even if
> there was some need for off-lan RDP traffic from users, it would be on
> a
> host-by-host basis and managed by the firewalls.  That, again, is
> security in depth.
> 
> If your users are running XP, then the admin would prevent them from
> updating to the 6.0 client anyway.  All you have to do in this case is
> configure your RDP hosts to require TLS encryption based on a
> certificate, and the client will not be able to connect at all if the
> certificate is not in the trusted root certificates store.  Done.  If
> you've got advanced users or have allowed 6.0 clients, then you ensure
> that the client is set not to connect if authentication fails against
> TLS secured hosts - of course, these people would be educated against
> lame attacks anyway, so, done.  If you are running Win2k8, then you use
> group policy to disable clients opening un-signed RDP files in the
> first
> place, and again, be done.  Or just use TSGateway and require
> certificates to log on - heck, they'd never make it past the gateway if
> you didn't allow them.  Done part IV.  If you've got Vista clients,
> then
> you'd also be using egress firewall rules in the "public" network
> context blocking the outbound traffic, all configured with a single
> GPO.
> I could go on, and on.
> 
> The point is that just because you have (amazingly enough) qualified
> this attack as "highly successful" and "vicious" does not, in any way,
> degrade the value of security in depth.  In fact, it is a perfect
> example *for* security in depth in that regard:  if this "attack"
> succeeds against anyone, it is not because security in depth does not
> exist, it is because security in depth was not practiced.
> 
> t
> 
> 
> 
> 
> 
> -----Original Message-----
> From: pdp (architect) [mailto:pdp.gnucitizen@...glemail.com]
> Sent: Wednesday, October 10, 2007 4:15 AM
> To: full-disclosure@...ts.grok.org.uk; bugtraq@...urityfocus.com
> Subject: Remote Desktop Command Fixation Attacks
> 
> http://www.gnucitizen.org/blog/remote-desktop-command-fixation-attacks
> 
> Security in depth does not exist! No matter what you do, dedicated
> attackers will always be able to penetrate your network. Seriously!
> Information security is mostly about risk assessment and crisis
> management.
> 
> When it comes to exploitative penetration testing, I relay on tactics
> rather then exploits. I've already talked about how insecure Remote
> Desktop service could be. In this post I will show you how easy it is
> to compromise a well protected Windows Terminal or CITRIX server with
> a simple social engineering attack and some knowledge about the
> platform we are about to exploit.
> 
> The attack is rather simple. All the bad guys have to do is to compose
> a malicious RDP (for Windows Terminal Services) or ICA (for CITRIX)
> file and send it to the victim. The victim is persuaded to open the
> file by double clicking on it. When the connection is established, the
> user will enter their credentials to login and as such let the hackers
> in. Vicious!
> 
> I have a more detailed explanation about the tactics behind this
> attack. Because I don't want to spam people with tones of text, I just
> included a link which you can follow. Hope that this is useful and at
> the same time eye opening, not that it is something completely
> amazing. But it does work and it works well.
> 
> cheers.
> 
> --
> pdp (architect) | petko d. petkov
> http://www.gnucitizen.org

