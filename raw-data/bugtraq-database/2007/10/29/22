
Date: Mon, 29 Oct 2007 13:03:14 -0700 (Pacific Daylight Time)
From: NGSSoftware Insight Security Research <nisr@...software.com>
To: bugtraq@...urityfocus.com, full-disclosure@...ts.grok.org.uk,
	vulnwatch@...nwatch.org
Subject: Heap overflow in RealPlayer ID3 tag parser

=======
Summary
=======
Name: Heap overflow in RealPlayer ID3 tag parsing code
Release Date: 29 October 2007
Reference: NGS00432
Discover: John Heasman <john@...software.com>
Vendor: RealNetworks
Systems Affected: Several builds of RealPlayer 10.5,
  All builds of RealPlayer 10.
  For additional affected versions, see the URL below.
Risk: High
Status: Published

========
TimeLine
========
Discovered:  1 August 2006
Released:  1 August 2006
Approved:  1 August 2006
Reported:  1 August 2006
Fixed: 25 October 2007
Published: 29 October 2007

===========
Description
===========
There is a heap overflow in the Realplayer code that parses ID3 tags in
MP3 files.

Impact: attackers could execute code of their choice on susceptible
systems if a user were induced to open a malicious MP3 file.

=================
Technical Details
=================
The problem stems from the parsing of a Lyrics3 v2.00 tag.  The size of
the tag is calculated by reading 5 ASCII characters and calling
pncrt.atoi.  A buffer is then allocated on the heap of size tag length +
1.  Since atoi parses a signed integer, supplying -1, results in a zero
length allocation into which data is copied.

This can be exploited to overwrite a function pointer leading to the
execution of arbitrary attacker-supplied code in the context of the user
under which RealPlayer is running.

===============
Fix Information
===============
This issue has now been resolved.  Steps detailing how to update 
RealPlayer may be obtained from:

http://service.real.com/realplayer/security/10252007_player/en/


NGSSoftware Insight Security Research
http://www.ngssoftware.com/
http://www.databasesecurity.com/
http://www.nextgenss.com/
+44(0)208 401 0070

--
E-MAIL DISCLAIMER

The information contained in this email and any subsequent
correspondence is private, is solely for the intended recipient(s) and
may contain confidential or privileged information. For those other than
the intended recipient(s), any disclosure, copying, distribution, or any
other action taken, or omitted to be taken, in reliance on such
information is prohibited and may be unlawful. If you are not the
intended recipient and have received this message in error, please
inform the sender and delete this mail and any attachments.

The views expressed in this email do not necessarily reflect NGS policy.
NGS accepts no liability or responsibility for any onward transmission
or use of emails and attachments having left the NGS domain.

NGS and NGSSoftware are trading names of Next Generation Security
Software Ltd. Registered office address: 52 Throwley Way, Sutton, SM1
4BF with Company Number 04225835 and VAT Number 783096402
