
Date: Wed, 07 Mar 2007 10:52:57 -0500
From: iDefense Labs <labs-no-reply@...fense.com>
To: vulnwatch@...nwatch.org, full-disclosure@...ts.grok.org.uk,
	bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 03.07.07: Ipswitch IMail Server 2006 Multiple
 ActiveX Control Buffer Overflow Vulnerabilities

Ipswitch IMail Server 2006 Multiple ActiveX Control Buffer Overflow
Vulnerabilities

iDefense Security Advisory 03.07.07
http://labs.idefense.com/intelligence/vulnerabilities/
Mar 07, 2007

I. BACKGROUND

Ipswitch Inc.'s IMail Server is an email server aimed at providing easy to
configure and maintain email services for for small organizations. More
information can be found on the vendors site at the following URL.

http://www.ipswitch.com/products/messaging.asp

II. DESCRIPTION

Remote exploitation of several ActiveX control buffer overflow
vulnerabilities in Ipswitch Inc.'s IMail Server 2006 could allow attackers
to execute arbitrary code with the credentials of the user visiting a
malicious website.

Multiple stack and heap based buffer overflows caused be unsafe strcpy and
wsprintf calls could corrupt memory in a way that leads to code execution.
Details for the vulnerable controls follow:

ProgID: IMAILAPILib.IMailServer
CLSID: 302397C2-8501-11D4-8D29-00010245C51E
targetFile: C:\Program Files\Ipswitch\IMail\IMailAPI.dll
memberName: WebConnect
memberName: Connect

ProgID: IMAILAPILib.IMailLDAPService
CLSID: 889558D4-CE9A-4A1B-B88A-AF7774A80E25
targetFile: C:\Program Files\Ipswitch\IMail\IMailAPI.dll
memberName: Sync3
memberName: Init3

ProgID: IMAILAPILib.IMailUserCollection
CLSID: 302397D6-8501-11D4-8D29-00010245C51E
targetFile: C:\Program Files\Ipswitch\IMail\IMailAPI.dll
memberName: SetReplyTo

III. ANALYSIS

To exploit this issue, a user would have to visit a malicious website from
a computer with IMail Server installed on it.

The vulnerable component is also likely installed with any IPSwitch
product that includes the IMail Server. This includes products such as its
Collaboration Suite packages.

IV. DETECTION

iDefense has confirmed this vulnerability in IMail Server 2006.

V. WORKAROUND

Setting the the kill-bit for the following CLSIDs will prevent
exploitation of
these vulnerabilities within Internet Explorer.

302397C2-8501-11D4-8D29-00010245C51E
302397D6-8501-11D4-8D29-00010245C51E
889558D4-CE9A-4A1B-B88A-AF7774A80E25

VI. VENDOR RESPONSE

Ipswitch has addressed the aforementioned vulnerabilities within version
2006.2 of IMail Server. More information can be found from their release
notes at the following URL.

http://support.ipswitch.com/kb/IM-20070305-JH01.htm

VII. CVE INFORMATION

A Mitre Corp. Common Vulnerabilities and Exposures (CVE) number has not
been assigned yet.

VIII. DISCLOSURE TIMELINE

01/22/2007  Initial vendor notification
03/05/2007  Vendor publicly disclosed issues
03/07/2007  iDefense public disclosure

IX. CREDIT

The discoverer of this vulnerability wishes to remain anonymous.

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2007 iDefense, Inc.

Permission is granted for the redistribution of this alert electronically.
It may not be edited in any way without the express written consent of
iDefense. If you wish to reprint the whole or any part of this alert in
any other medium other than electronically, please e-mail
customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate at
the time of publishing based on currently available information. Use of
the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on, this
information.
