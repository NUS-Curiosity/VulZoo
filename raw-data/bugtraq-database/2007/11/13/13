
Date: Tue, 13 Nov 2007 15:20:14 -0500
From: iDefense Labs <labs-no-reply@...fense.com>
To: vulnwatch@...nwatch.org, full-disclosure@...ts.grok.org.uk,
	bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 11.12.07: Novell NetWare Client Local
 Privilege Escalation Vulnerability

iDefense Security Advisory 11.12.07
http://labs.idefense.com/intelligence/vulnerabilities/
Nov 12, 2007

I. BACKGROUND

The Novell Client software provides a workstation with access to Novell
NetWare networks as well as Novell Open Enterprise Server (OES)
services. Novell Clients can access the full range of Novell services
such as authentication via Novell eDirectory, network browsing and
service resolution, and secure and reliable file system access. More
information about the Novel Client can be found on the vendor's site at
the following URL.

http://www.novell.com/products/clients/

II. DESCRIPTION

Local exploitation of an input validation error vulnerability within
Novell NetWare Client could allow an unprivileged attacker to execute
arbitrary code within the kernel.

When the Novell NetWare Client is installed on a Windows based operating
system, the driver nwfilter.sys will be loaded at system startup. This
driver allows any user to open the device "\.\nwfilter" and issue
IOCTLs with a buffering mode of METHOD_NEITHER.

The problem specifically exists because the driver allows untrusted user
mode code to pass kernel addresses as arguments to the driver. With
specially constructed input, a malicious user can use functionality
within the driver to patch kernel addresses and execute arbitrary code
within kernel mode.

III. ANALYSIS

Exploitation of this vulnerability allows an unprivileged local user to
patch and execute arbitrary code within the kernel. In order to exploit
the vulnerability, an attacker needs to be able to log in to the target
machine and execute a specially crafted executable.

IV. DETECTION

iDefense has confirmed the existence of this vulnerability in
nwfilter.sys, file version 4.91.1.1, as included with Novell's NetWare
Client 4.91 SP4. Other versions are suspected vulnerable as well.

V. WORKAROUND

iDefense is currently unaware of any workaround for this issue.

VI. VENDOR RESPONSE

Novell has addressed this vulnerability by releasing patches that remove
the "nwfilter.sys" driver. For more information, consult Novell's
advisory at the following URL.

https://secure-support.novell.com/KanisaPlatform/Publishing/98/3260263_f.SAL_Public.html

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2007-5667 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org/), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

09/25/2007  Initial vendor notification
09/25/2007  Initial vendor response
11/12/2007  Coordinated public disclosure

IX. CREDIT

This vulnerability was reported to iDefense by Stephen Fewer of Harmony
Security (www.harmonysecurity.com).

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2007 iDefense, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDefense. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically,
please e-mail customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
 There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct,
indirect, or consequential loss or damage arising from use of, or
reliance on, this information.
