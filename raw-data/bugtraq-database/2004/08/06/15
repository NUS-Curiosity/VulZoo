
Date: Fri, 6 Aug 2004 09:53:02 -0400
From: "Uday Moorjani" <umoorjani@...adoo.fr>
To: "Robillard, Nicolas" <nicolas.robillard@...lavalin.com>
Cc: <bugtraq@...urityfocus.com>
Subject: Re: Microsoft Internet Explorer 6 Protocol Handler Vulnerability


Mr.Robillard,

Works fine with IE 6.0.2800.1106.xpsp2.030422-1633IS
With the following pathches :

SP1
Q828750
Q330994
Q824145
Q820223
Q832894
Q837009
Q831167
Q823353
Q867801

Uday K. MOORAJANI



----- Original Message ----- 
From: "Robillard, Nicolas" <nicolas.robillard@...lavalin.com>
To: <bugtraq@...urityfocus.com>; <cert@...t.org>; <news@...uriteam.com>;
<vuln@...urity.nnov.ru>
Sent: Thursday, August 05, 2004 3:33 PM
Subject: Microsoft Internet Explorer 6 Protocol Handler Vulnerability


Description : Protocol Handler allow arbitrary switch to be passed to the
associated program.<BR>

Exploit :

The protocol handler are defined in HKEY_CLASSES_ROOT. We will use the MMS
protocol for this exemple. In the HKEY_CLASSES_ROOT\MMS\SHELL\OPEN\COMMAND
Registry key you can see that the program associated with the MMS protocol
is called through "C:\Program Files\Windows Media Player\wmplayer.exe" "%L".
(In this cases, this is windows media player).

Now if we pass in to IE this string mms:\\."%20/layout%20c , the "%L" in the
handler will now be  "." /layout c".
The /layout switch will open windows media player in Skin Mode.


        <A HREF=mms:\\."%20/layout%20c>TRY IT</A>

Of course, the vulnerability is not to open WMP in Skin Mode but it reside
in the hability to pass extra command line switches where only one should be
accepted.


Nicolas Robillard, GSEC
Information Security Advisor, Systems Security Group
Global Information Technologies, SNC-LAVALIN INC.
Tel : (514) 393-8000 Ext. 6289
455 René-Lévesque Blvd. West, Montreal  (QC), Canada  H2Z 1Z3



---
avast! Antivirus: Inbound message clean.
Virus Database (VPS): 0432-2, 04/08/2004
Tested on: 05/08/2004 17:32:06
avast! is copyright (c) 2000-2003 ALWIL Software.
http://www.avast.com






---
avast! Antivirus: Outbound message clean.
Virus Database (VPS): 0432-2, 04/08/2004
Tested on: 06/08/2004 09:53:04
avast! is copyright (c) 2000-2003 ALWIL Software.
http://www.avast.com





