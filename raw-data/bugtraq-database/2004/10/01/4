
Date: Wed, 29 Sep 2004 17:10:06 -0400
From: "customer service mailbox" <customerservice@...fense.com>
To: <bugtraq@...urityfocus.com>, <vulnwatch@...nwatch.org>
Subject: iDEFENSE Security Advisory 09.29.04 - Macromedia JRun 4 mod_jrun Apache Module Buffer Overflow Vulnerability


Macromedia JRun 4 mod_jrun Apache Module Buffer Overflow Vulnerability 

iDEFENSE Security Advisory 09.29.04
www.idefense.com/application/poi/display?id=145&type=vulnerabilities
September 29, 2004

I. BACKGROUND

Macromedia JRun 4 is a full Java 2 Enterprise Edition (J2EE) compatible
application server.

Further details are available at:

   http://www.macromedia.com/software/jrun/

II. DESCRIPTION

Remote exploitation of a buffer overflow vulnerability in Macromedia's
JRun 4 mod_jrun Apache module could allow execution of arbitrary code.

The problem specifically exists in the WriteToLog function of mod_jrun
and mod_jrun20, where a fixed size buffer is allocated on the stack. No
bounds checking is performed on the input. When the Verbose logging
option is set, this function may be called with user-supplied data. If
this data is longer than the space which has been allocated, a buffer
overflow may occur. Specially formed input may allow execution of
arbitrary commands.

III. ANALYSIS

Successful exploitation allows execution of arbitrary code with the
permissions of the user of the httpd process, typically 'nobody' or
'apache'.

As the Verbose option is not set by default, most installs will not be
vulnerable. An overly long Content-Type field, among other header
fields, can be used to trigger this buffer overflow.

IV. DETECTION

iDEFENSE has confirmed that JRun 4.0 SP1a is vulnerable on Apache httpd
1.3.x and 2.0.x platforms. It is suspected that all versions of mod_jrun
are currently affected.

V. WORKAROUNDS

Setting the Verbose option to "false" in the httpd.conf will prevent
this vulnerability from being exploitable. After editing the httpd.conf,
restart the httpd. This will reduce the amount of data logged by the
server, but will prevent exploitation of this vulnerability.

VI. VENDOR RESPONSE

MPSB04-08 - Cumulative Security Patch available for JRun server
http://www.macromedia.com/devnet/security/security_zone/mpsb04-08.html

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CAN-2004-0646 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

06/18/04  iDEFENSE Clients notified
06/18/04  Initial vendor notification
06/18/04  Initial vendor response
09/29/04  Public disclosure

IX. CREDIT

The discoverer wishes to remain anonymous.

Get paid for vulnerability research
http://www.idefense.com/poi/teams/vcp.jsp

X. LEGAL NOTICES

Copyright (c) 2004 iDEFENSE, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDEFENSE. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically, please
email customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.


