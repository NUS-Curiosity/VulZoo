
Date: 11 Apr 2004 06:07:58 -0000
From: Arman Nayyeri <arman-n@...eaker.net>
To: bugtraq@...urityfocus.com
Subject: Microsoft Outlook Express EML file Crash vulnerability




Microsoft Outlook Express EML file Crash vulnerability
======================================================
Title:     Microsoft Outlook Express EML file Crash vulnerability
HappyName: Who Send?
Date:      Sunday, April 11, 2004
Software:  Outlook Express 6.0 (i guess perior versions are vulnerable too)
Vendor:    Microsoft Corporation
Patch:     N/A (Look at "Vendor Status" section)
Author:    Arman Nayyeri, arman-n[at]phreaker.net, http://www.4rman.com
Severity:  Low (High if exploitable)


Description:
============
The OE crashes when we open an EML file that contains "Sender: some chars" and does
not have "From:" or have an empty one ("From: ").
When I found this, I think that it's a buffer overflow, but after notifing microsoft
they tell me that it's an invalid data pointer and not a buffer overflow and does
not appear exploitable.
I don't know how I can be sure that it's not exploitable, but if you can find it
exploitable post a message in BUGTRAQ.
This exploit is also possible through email, but the user must double click email
and in some conditions it is not possible because the From field will be added/filled
automatically by some servers.


Exploit:
========
The exploit that I provided is an small EML file with "Sender:" and without
"From:", so it will crash OE.
Download and run eml file until it crashes.

Here is the zip file containing .eml file:
http://www.4rman.com/exploits/whosendthis.zip

please, take a look at my website too!
http://www.4rman.com

Exploit Tested On
=================
Outlook Express 6.0
			on
			Microsoft Windows XP
			Microsoft Windows XP SP1
			Microsoft Windows 2003 Enterprise

Vendor Status
=============
Microsoft notified about 3 month ago.
The bug will be fixed as part of the next possible service pack.

Special Thanks
==============
Special thanks to god.

Do I discover more vulnerabilities?
===================================
take it easy! however I'm trying to do!

Disclaimer:
===========
Arman Nayyeri is not responsible for the misuse of the information 
provided in this advisory. The opinions expressed are my own and not of 
any company. In no event shall the author be liable for any damages 
whatsoever arising out of or in connection with the use or spread of this 
advisory. Any use of the information is at the user's own risk.

~~~~~~~~~~~~~~
and sorry for my bad english,
Arman Nayyeri
		From
			Iran
http://www.4rman.com


