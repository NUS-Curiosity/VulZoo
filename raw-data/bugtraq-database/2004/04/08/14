
Date: Thu, 8 Apr 2004 17:21:07 +0200
From: OpenPKG <openpkg@...npkg.org>
To: bugtraq@...urityfocus.com
Subject: [OpenPKG-SA-2004.012] OpenPKG Security Advisory (fetchmail)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

________________________________________________________________________

OpenPKG Security Advisory                            The OpenPKG Project
http://www.openpkg.org/security.html              http://www.openpkg.org
openpkg-security@...npkg.org                         openpkg@...npkg.org
OpenPKG-SA-2004.012                                          08-Apr-2004
________________________________________________________________________

Package:             fetchmail
Vulnerability:       denial of service
OpenPKG Specific:    no

Affected Releases:   Affected Packages:          Corrected Packages:
OpenPKG CURRENT      <= fetchmail-6.2.4-20031008 >= fetchmail-6.2.5-20031016
OpenPKG 1.3          <= fetchmail-6.2.3-1.3.0    >= fetchmail-6.2.3-1.3.1
OpenPKG 2.0          none                        N.A.

Dependent Packages:  none

Description:
  According to a Mandrake Linux security advisory [0], a denial of
  service (DoS) vulnerability exists in the header rewriting code of
  Fetchmail [1]. The code's intention is to hack message headers so
  replies work properly. However, logic in the reply_hack() function
  fails to allocate enough memory for long lines and may write past a
  memory boundary. This could allow an attacker to cause a denial of
  service by sending a specially crafted email and crashing fetchmail.
  The Common Vulnerabilities and Exposures (CVE) project assigned the id
  CAN-2003-0792 [2] to the problem.

  Please check whether you are affected by running "<prefix>/bin/rpm
  -q fetchmail". If you have the "fetchmail" package installed and its
  version is affected (see above), we recommend that you immediately
  upgrade it (see Solution). [3][4]

Solution:
  Select the updated source RPM appropriate for your OpenPKG release
  [5], fetch it from the OpenPKG FTP service [6] or a mirror location,
  verify its integrity [7], build a corresponding binary RPM from it
  [3] and update your OpenPKG installation by applying the binary RPM
  [4]. For the OpenPKG 1.3 release, perform the following operations to
  permanently fix the security problem.

  $ ftp ftp.openpkg.org
  ftp> bin
  ftp> cd release/1.3/UPD
  ftp> get fetchmail-6.2.3-1.3.1.src.rpm
  ftp> bye
  $ <prefix>/bin/rpm -v --checksig fetchmail-6.2.3-1.3.1.src.rpm
  $ <prefix>/bin/rpm --rebuild fetchmail-6.2.3-1.3.1.src.rpm
  $ su -
  # <prefix>/bin/rpm -Fvh <prefix>/RPM/PKG/fetchmail-6.2.3-1.3.1.*.rpm
________________________________________________________________________

References:
  [0] http://www.mandrakesecure.net/en/advisories/advisory.php?name=MDKSA-2003:101
  [1] http://www.catb.org/~esr/fetchmail/
  [2] http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2003-0792
  [3] http://www.openpkg.org/tutorial.html#regular-source
  [4] http://www.openpkg.org/tutorial.html#regular-binary
  [5] ftp://ftp.openpkg.org/release/1.3/UPD/fetchmail-6.2.3-1.3.1.src.rpm
  [6] ftp://ftp.openpkg.org/release/1.3/UPD/
  [7] http://www.openpkg.org/security.html#signature
________________________________________________________________________

For security reasons, this advisory was digitally signed with the
OpenPGP public key "OpenPKG <openpkg@...npkg.org>" (ID 63C4CB9F) of the
OpenPKG project which you can retrieve from http://pgp.openpkg.org and
hkp://pgp.openpkg.org. Follow the instructions on http://pgp.openpkg.org/
for details on how to verify the integrity of this advisory.
________________________________________________________________________

-----BEGIN PGP SIGNATURE-----
Comment: OpenPKG <openpkg@...npkg.org>

iD8DBQFAdW3RgHWT4GPEy58RAutIAKDLPwHQnlNAhlQmCi1XYEYQryqyCACgn30q
IYKyk6HlwUhG0JOiI615w90=
=muqI
-----END PGP SIGNATURE-----


