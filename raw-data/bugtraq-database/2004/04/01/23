
Date: Thu, 01 Apr 2004 07:07:02 -0500
From: Chris Brenton <cbrenton@...isbrenton.org>
To: bugtraq@...urityfocus.com
Subject: Re: IPv4 fragmentation  --> The Rose Attack


On Tue, 2004-03-30 at 23:18, gandalf@...ital.net wrote:
>
> Since cell phones, IPSec & satellite use fragmented packets this
> attack is pertinent to the Internet of today.

I'm willing to guess that many sites are seeing a lot more fragmented
traffic then they realize. A quick test would be:

tcpdump -nn -v 'ip[6]&32!=0'

under Linux/UNIX or

windump -nn -v "ip[6]&32!=0"

under Windows. If you see normal fragmentation to an internal server
(say a VPN gateway), then this device could be affected.

> Also note the source and destination ports do not matter as the
> packet is never validated at the layer four level, it never gets past layer
> three.  The devices accept the packets no matter what port is used.

This should be in big red letters. Any accessible host is potentially
vulnerable to this attack, regardless of whether any listening ports are
open. Also note that most hosts _will not_ log that this attack took
place. You can get hit and the only clue is interrupted connectivity. 

HTH,
Chris




