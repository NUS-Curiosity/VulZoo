
Date: Fri, 7 May 2004 18:26:39 -0600
From: "Boren, Rich (SSRT)" <rich.boren@...com>
To: "Security Focus" <"DaveAhmad [da@...urityfocus.com]"@domain.omitted>,
	"AtStake" <advisories@...take.com>,
	"ATSTAKE II" <research@...take.com>,
	"Auscert" <auscert@...cert.org.au>,
	"BUGtraq II" <bugtraq@...urityfocus.com>, "CERT" <cert@...t.org>,
	"First Teams" <first-teams@...st.org>, "IT-ISAC" <PAllor@....net>,
	"rich boren" <rich.boren@...com>, "SANS" <intrusion@...s.org>
Subject: FW: [security bulletin] SSRT4717 Management Agents for HP-UX Remote DoS



-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

HP SECURITY BULLETIN


HPSBMA01037     REVISION: 0

SSRT4717 rev.0 Management Agents: remote DoS with OpenSSL SSL/TLS
                                  in HP WBEM Services


 -----------------------------------------------------------------
NOTICE:
 There are no restrictions for distribution of this Bulletin
 provided that it remains complete and intact.

 The information in this Security bulletin should be acted upon
 as soon as possible.

INITIAL RELEASE:    05 May 2004



POTENTIAL SECURITY IMPACT:    Remote Denial of Service (DoS)

SOURCE:    HEWLETT-PACKARD COMPANY
HP Software Security Response Team

REFERENCES:    CAN 2004-079, CAN-2004-0112

VULNERABILITY SUMMARY:

A potential security vulnerability has been identified with
Management Agents using OpenSSL and SSL/TLS which could be
exploited remotely to create a denial of service (DoS) in HP WBEM
Services on HP-UX and RedHat Enterprise Linux (RHEL).

SUPPORTED SOFTWARE VERSIONS*:  ONLY impacted versions are listed.

HP9000 Servers running HP-UX release B.11.00,  B.11.11 and
B.11.23 with versions of the following  products are affected:

- - HP WBEM Services for HP-UX, A.01.05.08 or earlier (B8465BA).
  Version A.01.05.08 of this product includes OpenSSL 0.9.6k.

- - HP WBEM Services for HP-UX, A.02.00.00 (B8465BA).
  This product includes OpenSSL 0.9.6k.

RedHat Enterprise Linux,  RHEL AS 2.1 with the following HP
product numbers/versions are affected:

- - HP WBEM Services for Linux, A.02.00.01

BACKGROUND:

The Common Vulnerabilities and Exposures project has identified
potential vulnerabilities in OpenSSL (CAN-2004-079,
CAN-2004-0112).

1. The do_change_cipher_spec function in OpenSSL allows remote
   attackers to cause a denial of service via a crafted SSL/TLS
   handshake that triggers a null dereference.
   http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-0079

2. The SSL/TLS handshaking, when using Kerberos ciphersuites, does
   not properly check the length of Kerberos tickets during a
   handshake, which allows remote attackers to cause a denial of
   service via a crafted SSL/TLS handshake that causes an
   out-of-bounds read.
   http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-0112

It affects the following HP product numbers/versions on HP-UX
releases B.11.00, B.11.11, and B.11.23:

 - HP WBEM Services for HP-UX, A.01.05.08 or earlier (B8465BA)

 - HP WBEM Services for HP-UX, A.02.00.00 (B8465BA)

It also affects the following HP product numbers/versions on
RHEL AS 2.1:

 - HP WBEM Services for Linux, A.02.00.01

AFFECTED VERSIONS

The following is a list of affected filesets or patches and fix
information.

On HP-UX, to determine if a system has an affected version,
search the output of "swlist -a revision -l fileset" for an
affected fileset or patch, then determine if a fixed  revision or
applicable patch is installed.

HP-UX B.11.00

HP-UX B.11.11

HP-UX B.11.23

============

WBEMServices.WBEM-CORE

HP WBEM Services

action: install revision A.01.05.09 or subsequent

WBEMServices.WBEM-CORE

HP WBEM Services

action: install revision A.02.00.02 or subsequent

END AFFECTED VERSIONS

On Linux, to determine if a system has an affected version, search
the output of "rpm -qa | grep wbem" for an affected fileset or
patch, then determine if a fixed revision or applicable patch is
installed.

hp.com-wbem-2.0.1-rhas2_1


RESOLUTION:

The OpenSSL group has released patches to fix the vulnerabilities
in OpenSSL 0.9.7d.  For customers using HP WBEM Services, HP has
incorporated  OpenSSL 0.9.7d in the following product:

- - HP WBEM Services for HP-UX, A.01.05.09 or later

- - HP WBEM Services for HP-UX, A.02.00.02 or later

- - HP WBEM Services for Linux, A.02.00.02 or later

System: hprc.external.hp.com (192.170.19.51)

Login: wbem123

Password: wbem123

FTP Access: ftp://wbem123:wbem123@...c.external.hp.com/ or:
            ftp://wbem123:wbem123@....170.19.51/ or:
            ftp://hprc.external.hp.com

Note: There is an ftp defect in IE5 that may result in a browser
 hang. To work around this:

- - Select Tools -> Internet Options -> Advanced

- - Un-check the option:

[ ] Enable folder view for FTP sites

==================================================

To fix the problem:

1. Determine the affected version.

2. Download and verify the cksum or md5 sum.

3. Install the appropriate HP WBEM Services depot or rpm.

cksum:

3788678079 131405  B8465-90020.pdf

2299865214 134962  B8465-90021.pdf

1197831072 6060093
  B8465BA_A.01.05.09_HP-UX_B.11.00_32+64.depot.gz

443376171 6059783
  B8465BA_A.01.05.09_HP-UX_B.11.11_32+64.depot.gz

113794493 16947990
  B8465BA_A.01.05.09_HP-UX_B.11.23_IA.depot.gz

1574426678 8734861
  B8465BA_A.02.00.02_HP-UX_B.11.11_32+64.depot.gz

1543241775 5628442   hp.com-wbem-2.0.2-rhas2_1.ia64.rpm.gz

685075578 5438885   hp.com-wbem-2.0.2-rhas2_1.i386.rpm.gz

MD5:

C3300B25F7A62E3442156FBF57FA97FB  B8465-90020.pdf

C2EEFBD4DB4AE2C1E242B5F94112A5DF  B8465-90021.pdf

de76ca4d30641dc7414a2d1a8d630e62
  B8465BA_A.01.05.09_HP-UX_B.11.00_32+64.depot.gz

a87b0345ba7edd258c4b008c37e1550f
  B8465BA_A.01.05.09_HP-UX_B.11.11_32+64.depot.gz

204bdd55be8cf97c6d9f4ea879383ce2
  B8465BA_A.01.05.09_HP-UX_B.11.23_IA.depot.gz


e6c036b0e9b8485265521582be893edc
  B8465BA_A.02.00.02_HP-UX_B.11.11_32+64.depot.gz

529e83d49485a716bae31ce214aa4976
  hp.com-wbem-2.0.2-rhas2_1.ia64.rpm.gz

4a825a3c83597de771eb536ae8821980
  hp.com-wbem-2.0.2-rhas2_1.i386.rpm.gz

Check for HP WBEM Services Installation

- --------------------------------------------

To determine if HP WBEM Services is installed on your system, on
HP-UX, use the Software Distributor's swlist command.

For example, the results of the command

swlist -l product | grep -i WBEM

WBEMServices A.01.05.08 WBEM Services CORE Product

For full information about system requirements and installing
HP WBEM Services, refer to the HP WBEM Services Release Notes.

Installation Steps

- -----------------

for HP WBEM Services for HP-UX

- -------------------------------------

- - Download the depot for HP WBEM Services from the ftp site.

- - To update to the new version, login as root and use the
  swinstall command to install the product:

swinstall -s


for HP WBEM Services for Linux

- -----------------------------------

- - Download the rpm for HP WBEM Services from the ftp site.

- - To update to the new version, login as root and use the rpm
  command to install the product:

rpm -ih

Removing Installation of

- ------------------------

HP WBEM Services for HP-UX

- ----------------------------------

Although not recommended, HP WBEM Services can be removed from
your system using the Software Distributor's "swremove" command.
Removing HP WBEM Services can seriously affect the functionality
of dependent products.

HP WBEM Services for Linux

- -------------------------------

Although not recommended, HP WBEM Services can be removed from
your system using the Software Distributor's "rpm -e" command.
Removing HP WBEM Services can seriously affect the functionality
of dependent products.

On Linux, to determine if a system has an affected version, search
the output of "rpm -qa | grep wbem" for an affected fileset or
patch, then determine if a fixed revision or applicable patch is
installed.

hp.com-wbem-2.0.1-rhas2_1



Please write to security-alert@...com to request a PGP signed
version of this bulletin.


* The software product category that this Security Bulletin
 relates to is represented by the 5th and 6th characters of the
 Bulletin number: GN=General, MA=Management Agents, MI=Misc.
 3rd party, MP=HP-MPE/iX, NS=HP NonStop Servers, OV=HP OpenVMS,
 PI=HP Printing & Imaging, ST=HP Storage, TU=HP Tru64 UNIX,
 TL=Trusted Linux, UX=HP-UX, VV=Virtual Vault


SUPPORT: For further information, contact HP Services support
         channel.

SUBSCRIBE: To initiate a subscription to receive future HP
Security Bulletins via Email:
http://h30046.www3.hp.com/driverAlertProfile.php?regioncode
=NA&langcode=USENG&jumpid=in_SC-GEN__driverITRC&topiccode=ITRC
On the web page:
Driver and Support Alerts/Notifications Sign-up: Product Selection
Under Step1: your products
1. Select product category:
   - a minimum of servers must be selected.
2. Select product family or search:
   - a minimum of one product must be selected.
3. Add a product:
   - a minimum of one product must be added.
In Step 2: your operating system(s)
   - check ALL operating systems for which alerts are required.
Complete the form and Save.

To update an existing subscription:
http://h30046.www3.hp.com/subSignIn.php
Log in on the web page Subscriber's choice for Business: sign-in.
On the Web page: Subscriber's Choice: your profile summary
- - use Edit Profile to update appropriate sections.

Note: In addition to the individual alerts/notifications for the
selected operating systems/products, subscribers will
automatically receive one copy of alerts for non-operating system
categories (i.e., a subscriber who signs up for all six operating
system alerts will only receive one copy of all the non-operating
system alerts).

HP-UX SPECIFIC SECURITY BULLETINS*:
To review previously published Security Bulletins for HP-UX:
 http://itrc.hp.com/cki/bin/doc.pl/screen=ckiSecurityBulletin

The HP-UX Security Patch Matrix is available here:
http://itrc.hp.com/service/cki/docDisplay.do?docId=
hpuxSecurityMatrix
Or via anonymous ftp:
ftp://ftp.itrc.hp.com/export/patches/hp-ux_patch_matrix/

The HP-UX Security Patch Matrix, updated daily, categorizes
security patches by platform/OS release, and by Bulletin topic.
The Security Patch Check tool completely automates the process of
reviewing the Security Patch Matrix for HP-UX 11.XX Versions.
NOTE: Installing patches listed in the Security Patch Matrix will
completely implement the RESOLUTION in the Security Bulletin
_only_ if there are no MANUAL ACTIONS included.

The Security Patch Check tool can also verify that a Security
Bulletin RESOLUTION has been implemented on HP-UX 11.XX Versions
provided that no MANUAL ACTIONS were included. The Security Patch
Check tool cannot verify patches implemented via product upgrade.

For information on the Security Patch Check tool, see:
http://www.software.hp.com/cgi-bin/swdepot_parser.cgi/cgi/
displayProductInfo.pl?productNumber=B6834AA

REPORT: To report a potential security vulnerability with any HP
supported product, send Email to: security-alert@...com. It is
strongly recommended that security related information being
communicated to HP be encrypted using PGP, especially exploit
information. To obtain the security-alert PGP key please send an
e-mail message to security-alert@...com with the Subject of
'get key' (no quotes).

System management and security procedures must be reviewed
frequently to maintain system integrity. HP is continually
reviewing and enhancing the security features of software products
to provide customers with current secure solutions.

"HP is broadly distributing this Security Bulletin in order to
bring to the attention of users of the affected HP products the
important security information contained in this Bulletin. HP
recommends that all users determine the applicability of this
information to their individual situations and take appropriate
action. HP does not warrant that this information is necessarily
accurate or complete for all user situations and, consequently,
HP will not be responsible for any damages resulting from user's
use or disregard of the information provided in this Bulletin.
To the extent permitted by law, HP disclaims all warranties,
either express or implied, including the warranties of
merchantability and fitness for a particular purpose, title
and non-infringement."


(c)Copyright 2004 Hewlett-Packard Development Company, L.P.
Hewlett-Packard Company shall not be liable for technical or
editorial errors or omissions contained herein. The information
provided is provided "as is" without warranty of any kind. To the
extent permitted by law, neither HP or its affiliates,
subcontractors or suppliers will be liable for incidental, special
or consequential damages including downtime cost; lost profits;
damages relating to the procurement of substitute products or
services; or damages for loss of data, or software restoration.
The information in this document is subject to change without
notice. Hewlett-Packard Company and the names of Hewlett-Packard
products referenced herein are trademarks of Hewlett-Packard
Company in the United States and other countries. Other product
and company names mentioned herein may be trademarks of their
respective owners.

-----BEGIN PGP SIGNATURE-----
Version: PGP 8.0.2 

iQA/AwUBQJuNsuAfOvwtKn1ZEQJpPACfbps43oVeKtqdYoyah49dnhr47f4AoJh9
ORAkiGWM/VKbNP8O/lIR/a2x
=b2pQ
-----END PGP SIGNATURE-----


