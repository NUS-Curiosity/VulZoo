
Date: Sun, 09 May 2004 19:36:49 +0200
From: Thierry Carrez <koon@...too.org>
To: gentoo-announce@...too.org
Cc: bugtraq@...urityfocus.com, full-disclosure@...ts.netsys.com,
   security-alerts@...uxsecurity.com
Subject: [ GLSA 200405-02 ] Multiple vulnerabilities in LHa


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Gentoo Linux Security Advisory                           GLSA 200405-02
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
                                            http://security.gentoo.org/
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  Severity: High
     Title: Multiple vulnerabilities in LHa
      Date: May 09, 2004
      Bugs: #49961
        ID: 200405-02

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Synopsis
========

Two stack-based buffer overflows and two directory traversal problems
have been found in LHa. These vulnerabilities can be used to execute
arbitrary code or as a denial of service attack.

Background
==========

LHa is a console-based program for packing and unpacking LHarc
archives.

Affected packages
=================

    -------------------------------------------------------------------
     Package       /   Vulnerable   /                       Unaffected
    -------------------------------------------------------------------
  1  app-arch/lha      <= 114i-r1                           >= 114i-r2

Description
===========

Ulf Harnhammar found two stack overflows and two directory traversal
vulnerabilities in LHa version 1.14 and 1.17. A stack overflow occurs
when testing or extracting archives containing long file or directory
names. Furthermore, LHa doesn't contain sufficient protection against
relative or absolute archive paths.

Impact
======

The stack overflows can be exploited to execute arbitrary code with the
rights of the user testing or extracting the archive. The directory
traversal vulnerabilities can be used to overwrite files in the
filesystem with the rights of the user extracting the archive,
potentially leading to denial of service or privilege escalation. Since
LHa is often interfaced to other software like an email virus scanner,
this attack can be used remotely.

Workaround
==========

There is no known workaround at this time. All users are advised to
upgrade to the latest available version of LHa.

Resolution
==========

All users of LHa should upgrade to the latest stable version:

    # emerge sync

    # emerge -pv ">=app-arch/lha-114i-r2"
    # emerge ">=app-arch/lha-114i-r2"

References
==========

  [ 1 ] CAN-2004-0234
        http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-0234
  [ 2 ] CAN-2004-0235
        http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-0235

Availability
============

This GLSA and any updates to it are available for viewing at
the Gentoo Security Website:

     http://security.gentoo.org/glsa/glsa-200405-02.xml

Concerns?
=========

Security is a primary focus of Gentoo Linux and ensuring the
confidentiality and security of our users machines is of utmost
importance to us. Any security concerns should be addressed to
security@...too.org or alternatively, you may file a bug at
http://bugs.gentoo.org.

License
=======

Copyright 2004 Gentoo Technologies, Inc; referenced text
belongs to its owner(s).

The contents of this document are licensed under the
Creative Commons - Attribution / Share Alike license.

http://creativecommons.org/licenses/by-sa/1.0

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFAnmwwvcL1obalX08RAoGgAJ0bmbmcu7FGXVwnbTLu84nXf4Rv8ACfQvhj
MxOL9Q4B9as0zJ3/L6yFNVY=
=AcdX
-----END PGP SIGNATURE-----

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.netsys.com/full-disclosure-charter.html


