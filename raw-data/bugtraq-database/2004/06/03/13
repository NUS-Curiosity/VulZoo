
Date: Thu, 3 Jun 2004 10:23:31 -0500
From: "Evans, Arian" <Arian.Evans@...hnetsecurity.com>
To: "Byron Pezan" <mbp@...bit.net>
Cc: <bugtraq@...urityfocus.com>
Subject: RE: Remote SMTP authentication audit tool?


Just audit your local Windows accounts (or domain Windows accounts) 
for password strength, if you're still worried about weak accounts. John
the Ripper, LC, etc., are all useful for this.

If you do not use SMTP relaying, then disable "allow authenticated users"
to relay in Exchange. Your internal users connect to Exchange via RPC
and ephemeral ports (or port 80 on E2k3). They don't connect to the SMTP
relay for fat client mail functionality.

If you have internal applications that use your SMTP service as a relay,
they likely do not authenticate. You can still disable authentication and
disable relaying, and allow custom internal applications by IP.

That will solve the SMTP relay abuse problem going forward.

If authenticated user relay is disabled, then weak or non-existent passwords
on your Exchange systems (or domain users) cannot be used for SMTP
abuse due to the fact spammers can't login.

If you want to test your server like a spammer via actual SMTP authentication
brute forcing, there are several scripts out there like Brutus.pl:

http://www.0xdeadbeef.info/

(most the spammer scripts have short dictionary lists that contain your usual
admin\admin, backup\null, backup\backup, etc.)

Arian Evans
Sr. Security Engineer
FishNet Security

Phone:  816.421.6611
Toll Free:  888.732.9406
Fax:  816.421.6677

http://www.fishnetsecurity.com

note: Microsoft Office XP breaks text-based
email by default.

Turn off the "remove extra line breaks" located
at |Tools|Options|Email Options if this formats
incorrectly.


> -----Original Message-----
> From: Byron Pezan [mailto:mbp@...bit.net] 
> Sent: Wednesday, June 02, 2004 1:31 PM
> To: bugtraq@...urityfocus.com
> Subject: Remote SMTP authentication audit tool?
> 
> I have found that several spammers are exploiting weak or 
> non-existent passwords on some MS Exchange servers using 
> external SMTP authentication.  I have also found out (through 
> Tech Net) how to turn on logging for SMTP authentication and 
> see what account is being abused for this purpose.  However, 
> this is too reactive of an approach.  Does anyone know of a 
> way or a tool to audit existing servers for weak or 
> non-existent SMTP passwords?
> 
> byron
> 
> 
> 
> 

The information transmitted in this e-mail is intended only for the addressee and may contain confidential and/or privileged material. 
Any interception, review, retransmission, dissemination, or other use of, or taking of any action upon this information by persons or entities
other than the intended recipient is prohibited by law and may subject them to criminal or civil liability. If you received this communication 
in error, please contact us immediately at 816.421.6611, and delete the communication from any computer or network system.




