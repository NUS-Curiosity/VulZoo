
Date: Thu, 10 Jun 2004 15:23:34 -0700
From: "Derek Soeder" <dsoeder@...e.com>
To: <bugtraq@...urityfocus.com>
Subject: EEYE: RealPlayer embd3260.dll Error Response Heap Overflow


RealPlayer embd3260.dll Error Response Heap Overflow

Release Date:
June 10, 2004

Date Reported:
May 14, 2004

Severity:
High (Remote Code Execution)

Vendor:
RealNetworks

Systems Affected:
RealOne Player 
RealOne Player v2
RealPlayer 10
RealPlayer 8
RealPlayer Enterprise

Description:
eEye Digital Security has discovered a critical vulnerability in
RealPlayer.  The vulnerability allows a remote attacker to reliably
overwrite heap memory with arbitrary data and execute arbitrary code in
the context of the user who executed the player or application hosting
the RealMedia plug-in.

This specific flaw exists within the embd3260.dll file used by
RealPlayer.  By specially crafting a malformed movie file along with an
HTML file, a direct heap overwrite is triggered, and reliable code
execution is then possible.

Technical Description:
The code in embd3260.dll among other things is responsible for crafting
error messages in RealPlayer.  The vulnerability is triggered by
crafting a malformed movie which is then embedded into an HTML page,
causing RealPlayer to generate a error in the form of
"mem://[address]/[movie file name]", resulting in a heap overflow.  A
heap block is allocated to contain the error message, but because of a
flaw in how the buffer size is calculated, an overflow will always
happen.  The following pseudocode represents the vulnerable condition:

char *errormessage = new char[strlen(moviename)+10];
sprintf(errormessage, "mem://%08X/", address);
strcat(errormessage, moviename); 

Protection:
Retina Network Security Scanner has been updated to identify this
vulnerability.

Vendor Status:
RealNetworks has released a patch for this vulnerability. The patch is
available via the "Check for Update" menu item under Tools on the
RealPlayer menu bar.
A link to their advisory can be found here:
http://service.real.com/help/faq/security/040610_player/EN/

Credit:
Discovery: Karl Lynn
Additional Research: Derek Soeder

Related Links:
Retina Network Security Scanner - Free 15 Day Trial
http://www.eeye.com/html/Products/Retina/download.html

Greetings:
HD Moore, Riley Hassell, K2, Bronc Buster, RSnake, Kelly H., and the
entire staff at eEye.

Copyright (c) 1998-2004 eEye Digital Security
Permission is hereby granted for the redistribution of this alert
electronically. It is not to be edited in any way without express
consent of eEye. If you wish to reprint the whole or any part of this
alert in any other medium excluding electronic medium, please email
alert@...e.com for permission.

Disclaimer
The information within this paper may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are no warranties, implied or express, with regard to this information.
In no event shall the author be liable for any direct or indirect
damages whatsoever arising out of or in connection with the use or
spread of this information. Any use of this information is at the user's
own risk.

Feedback
Please send suggestions, updates, and comments to:

eEye Digital Security
http://www.eEye.com
info@...e.com


