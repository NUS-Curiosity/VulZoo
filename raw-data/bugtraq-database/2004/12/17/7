
Date: Fri, 17 Dec 2004 11:23:38 +0100 (CET)
From: Jaroslaw Sajko <sloik@....poznan.pl>
To: bugtraq@...urityfocus.com, <full-disclosure@...ts.netsys.com>
Subject: Gadu-Gadu, another two bugs



Product:	Gadu-Gadu, build 155 and older
Vendor:		SMS-EXPRESS.COM (http://www.gadu-gadu.pl)
Impact:		Script execution in local zone,
		Remote DoS
Severity:	High
Authors: 	Blazej Miga <bla@....poznan.pl>,
		Jaroslaw Sajko <sloik@....poznan.pl>
Date:		17/12/04


[ISSUE]

Gadu-Gadu is the first Polish instant messenger used by ca. 3 millions of
people per month.

In addition to the last vulnerabilities there are two another
vulnerabilities in the build which have been released after our last
advisory.


[DETAILS]

Bug 1.
Parsing error. We can send a malicious string which has an url inside.
This url can be a javascript code for example or reference to such a code.
Code will execute when the window with message pops up. Code will execute
in LOCAL ZONE! Works also with older versions.

Example:

Send such a string to any receipent:
www.po"style=background-image:url(javascript:document.write('%3cscript%3ealert%28%22you%20are%20owned!%22%29%3c%2fscript%3e'));".pl

Bug 2.
Beacause in this build default configuration allows sending of the images
we can send an image. There is some new feature, a loop checking filename
for disallowed characters, but the loop under some circumstances is an
infinite loop. So, if an image name isn't starting with the '..', '/', '\'
or '&#' then Gadu-Gadu applications falls into infinite loop, consumes
resources, and will not receive or send any message anymore. So we have a
simple DoS (livelock).

Example:

Send any image (filename must be a 'normal' filename) to your friend.


[SOLUTION]

Please upgrade to the newest build (build 156).



