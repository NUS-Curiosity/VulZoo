
Date: 16 Dec 2004 02:43:12 -0000
From: <advisory@...security.com>
To: bugtraq@...urityfocus.com
Subject: STG Security Advisory: [SSA-20041215-19] Vulnerability of
    uploading files with multiple extensions in MediaWiki




STG Security Advisory: [SSA-20041215-19] Vulnerability of uploading files
with multiple extensions in MediaWiki

Revision 1.0
Date Published: 2004-12-15 (KST)
Last Update: 2004-12-15 (KST)
Disclosed by SSR Team (advisory@...security.com)

Summary
========
MediaWiki is one of famous wiki web applications. However, an input
validation flaw can cause malicious attackers to run arbitrary commands with
the privilege of the HTTPD process, which is typically run as the nobody
user.

Vulnerability Class
===================
Implementation Error: Input validation flaw

Impact
======
High : arbitrary command execution.

Affected Products
================
MediaWiki 1.3.8 and prior.

Vendor Status: FIXED
====================
2004-12-10 Vulnerability found.
2004-12-10 MediaWiki developer notified.
2004-12-13 Update version released.
2004-12-15 Official release.

Details
=======
MediaWiki doesn't implemented to check multiple extensions of uploaded
files, e.g. attack.php.rar, so malicious attackers can upload arbitrary
script files (php, pl, cgi, etc) to a web server. This is originated from a
feature of Apache MIME module (mod_mime), which regards attack.php.rar as a
normal PHP file and execute the file through mod_php module with the
privilege of the HTTPD process.
cf. http://httpd.apache.org/docs/mod/mod_mime.html - "Files with Multiple
Extensions" : it's a feature, not a bug.

Solution
=========
Update to 1.3.9
http://wikipedia.sourceforge.net/

Vendor URL
==========
http://wikipedia.sourceforge.net/

Credits
======
Jeremy Bae at STG Security


