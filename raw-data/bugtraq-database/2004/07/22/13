
Date: Thu, 22 Jul 2004 13:19:56 -0400
From: "Advisories" <advisories@...take.com>
To: <bugtraq@...urityfocus.com>
Subject: @stake advisory: HP dced Remote Command Execution Multiple OSes


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1



                                @stake, Inc.
                              www.atstake.com

                             Security Advisory

Advisory Name: HP dced Remote Command Execution 
 Release Date: 07/22/2004
  Application: dced
     Platform: HPUX 11
               HP Tru64
               HP OpenVMS
     Severity: A remote attacker can execute arbitrary commands
      Authors: Jeremy Jethro [jjethro@...rr.com]
Vendor Status: Vendor has patches
CVE Candidate: CAN-2004-0716
    Reference: www.atstake.com/research/advisories/2004/a072204-1.txt


Overview:

A buffer overflow vulnerability was discovered in HP's implementation
of the DCE endpoint mapper (epmap) which listens by default on TCP
port 135.  Successful exploitation of this vulnerability may allow
an attacker to execute arbitrary commands on the targeted system
with the privileges of the DCED process which is typically run as
the root user.  


Details:

There is a buffer overflow in HP's DCED implementation that can be
triggered by specifying a small fragment length, and sending a large
amount of stub data. 

A Nessus (NASL) script that can detect vulnerable DCED daemons will
be released 30 days after the publication of this advisory.


Timeline:


Vendor notified on 4/23/2004 via email to security-alert@...com 

Vendor responded on 4/29/2004 that current patched version of 
HP-UX 11 with patches noted in bulletin HPSBUX0311-299 fixed this
issue. However, vendor noted that this issue effected other dced
implementations and suggested notifying US-CERT so all 
vendors may test their code.

US-CERT notified on 5/3/2004

US-CERT responded on 5/7/2004 and issued tracking number VU#259796

HP releases Tru64 security bulletin on 6/21/2004

HP releases OpenVMS security bulletin on 7/14/2004

US-CERT confirms that it knows of no other vendors that were
notified of issue VU#259796 that are vulnerable to same issue on
7/20/2004

Advisory released 7/22/2004



Vendor Response: 

OS: HP HP-UX 11 (Issue fixed prior to notification from @stake)

Bulletin: HPSBUX0311-299: SSRT3660 DCE (Rev.01) 

Patch: B.11.00 - PHSS_29963
       B.11.11 - PHSS_29964
       B.11.23 - PHSS_29966

       The patches are available on <http://itrc.hp.com>


OS: HP Tru64

Bulletin: SSRT4741 rev.0 DCE for HP Tru64 UNIX Potential RPC
          Buffer Overrun Attack 

Patch: http://support.entegrity.com/private/patches/dce/ssrt4741.asp


OS: HP OpenVMS

Bulletin: SSRT4741 Rev.1 DCE for HP OpenVMS Potential RPC Buffer
          Overrun Attack

      HP is releasing the following patch kits to resolve this
      issue and are available from the ITRC at
      http://www2.itrc.hp.com/service/patch/mainPage.do
      Search for the patch kit name as shown.

      HP OpenVMS Alpha Version: Patch Kit name:

      HP OpenVMS Alpha V7.3-2 VMS732_RPC-V0300
      HP OpenVMS Alpha V7.3-1 VMS731_RPC-V0400
      HP OpenVMS Alpha V7.3 VMS73_RPC-V0400 


@stake Recommendation:

Disable dced if not necessary.  If required install vendor patches.


Common Vulnerabilities and Exposures (CVE) Information:

The Common Vulnerabilities and Exposures (CVE) project has assigned 
the following names to these issues.  These are candidates for 
inclusion in the CVE list (http://cve.mitre.org), which standardizes 
names for security problems.

  CAN-2004-0716 HP dced Remote Command Execution

@stake Vulnerability Reporting Policy: 
http://www.atstake.com/research/policy/

@stake Advisory Archive:
http://www.atstake.com/research/advisories/

PGP Key:
http://www.atstake.com/research/pgp_key.asc

Copyright 2004 @stake, Inc. All rights reserved.







-----BEGIN PGP SIGNATURE-----
Version: PGP 8.0.3 - not licensed for commercial use: www.pgp.com

iQA/AwUBQP/3DUe9kNIfAm4yEQLzEwCg60XUutO7NbMPIS3usaKynS806S4AoJtx
ufrEUVgpDaNJsuvh/vK6YBAl
=Vnwi
-----END PGP SIGNATURE-----


