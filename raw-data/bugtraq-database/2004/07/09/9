
Date: Thu, 8 Jul 2004 21:38:32 +0200
From: OpenPKG <openpkg@...npkg.org>
To: bugtraq@...urityfocus.com
Subject: [OpenPKG-SA-2004.031] OpenPKG Security Advisory (dhcpd)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

________________________________________________________________________

OpenPKG Security Advisory                            The OpenPKG Project
http://www.openpkg.org/security.html              http://www.openpkg.org
openpkg-security@...npkg.org                         openpkg@...npkg.org
OpenPKG-SA-2004.031                                          08-Jul-2004
________________________________________________________________________

Package:             dhcpd
Vulnerability:       denial of service, arbitrary code execution
OpenPKG Specific:    no

Affected Releases:   Affected Packages:          Corrected Packages:
OpenPKG CURRENT      <= dhcpd-3.0.1rc13-20040524 >= dhcpd-3.0.1rc14-20040623
OpenPKG 2.0          <= dhcpd-3.0.1rc13-2.0.0    >= dhcpd-3.0.1rc13-2.0.1
OpenPKG 1.3          <= dhcpd-3.0.1rc11-1.3.0    >= dhcpd-3.0.1rc11-1.3.1

Affected Releases:   Dependent Packages: none

Description:
  As reported by US-CERT [0] Gregory Duchemin discovered several
  vulnerabilities in the ISC DHCP Distribution [1].

  Several buffer overflows were closed in logging messages with
  excessively long hostnames provided by the clients. The Common
  Vulnerabilities and Exposures (CVE) project assigned the id
  CAN-2004-0460 [2] to the problem.

  Another issue was evident on some specific platforms where the dhcpd
  build mechanism ignored the existence of [v]snprintf(3) functions
  and used the weaker [v]sprintf(3) which lack boundary checking. The
  RELEASE updates enforce use of the favorable functions after it was
  verified they exist on all platforms supported by OpenPKG. The CURRENT
  update contains a vendor fix explicitly providing a suitable function.
  The Common Vulnerabilities and Exposures (CVE) project assigned the id
  CAN-2004-0461 [3] to the problem.

  Please check whether you are affected by running "<prefix>/bin/rpm
  -q dhcpd". If you have the "dhcpd" package installed and its version
  is affected (see above), we recommend that you immediately upgrade
  it (see Solution) [4][5].

Solution:
  Select the updated source RPM appropriate for your OpenPKG release
  [6][7], fetch it from the OpenPKG FTP service [8][9] or a mirror
  location, verify its integrity [10], build a corresponding binary RPM
  from it [4] and update your OpenPKG installation by applying the
  binary RPM [5]. For the most recent release OpenPKG 2.0, perform the
  following operations to permanently fix the security problem (for
  other releases adjust accordingly).

  $ ftp ftp.openpkg.org
  ftp> bin
  ftp> cd release/2.0/UPD
  ftp> get dhcpd-3.0.1rc13-2.0.1.src.rpm
  ftp> bye
  $ <prefix>/bin/openpkg rpm -v --checksig dhcpd-3.0.1rc13-2.0.1.src.rpm
  $ <prefix>/bin/openpkg rpm --rebuild dhcpd-3.0.1rc13-2.0.1.src.rpm
  $ su -
  # <prefix>/bin/openpkg rpm -Fvh <prefix>/RPM/PKG/dhcpd-3.0.1rc13-2.0.1.*.rpm
________________________________________________________________________

References:
  [0] http://www.us-cert.gov/cas/techalerts/TA04-174A.html
  [1] http://www.isc.org/products/DHCP/dhcp-v3.html
  [2] http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-0460
  [3] http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-0461
  [4] http://www.openpkg.org/tutorial.html#regular-source
  [5] http://www.openpkg.org/tutorial.html#regular-binary
  [6] ftp://ftp.openpkg.org/release/1.3/UPD/dhcpd-3.0.1rc11-1.3.1.src.rpm
  [7] ftp://ftp.openpkg.org/release/2.0/UPD/dhcpd-3.0.1rc13-2.0.1.src.rpm
  [8] ftp://ftp.openpkg.org/release/1.3/UPD/
  [9] ftp://ftp.openpkg.org/release/2.0/UPD/
  [10] http://www.openpkg.org/security.html#signature
________________________________________________________________________

For security reasons, this advisory was digitally signed with the
OpenPGP public key "OpenPKG <openpkg@...npkg.org>" (ID 63C4CB9F) of the
OpenPKG project which you can retrieve from http://pgp.openpkg.org and
hkp://pgp.openpkg.org. Follow the instructions on http://pgp.openpkg.org/
for details on how to verify the integrity of this advisory.
________________________________________________________________________

-----BEGIN PGP SIGNATURE-----
Comment: OpenPKG <openpkg@...npkg.org>

iD8DBQFA7aKWgHWT4GPEy58RAs1iAJ9Uz3GmUXo0npwUKIQ2sWXeFO03tACgk6D4
Nh1gkVYtUUa0/diFjixbv7s=
=NUn4
-----END PGP SIGNATURE-----


