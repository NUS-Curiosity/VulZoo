
Date: Mon, 6 Jun 2016 20:20:41 +0000 (UTC)
From: Gregory Pickett <gpickett71@...oo.com>
To: "fulldisclosure@...lists.org" <fulldisclosure@...lists.org>,
  "bugtraq@...urityfocus.com" <bugtraq@...urityfocus.com>
Cc: "submit@...ec.org" <submit@...ec.org>
Subject: Re: rConfig, the open source network device configuration
 management tool, Vulnerable to Local File Inclusion

rConfig v3.1.1 introduced whitelisting.  This is how to get past that.  :)


Greg



Verification of Vulnerability (for v3.1.1)
===================
The following steps can be carried out in duplicating this vulnerability.

Step 1:
Enter the following into your browser address bar:

http://<SERVER>/lib/crud/downloadFile.php?download_file=/home/rconfig/data/../../../etc/passwd

Step 2:
Confirm that the passwd file is valid

 
---------- 

Gregory Pickett, CISSP, GCIA, GPEN


----- Original Message -----
From: Gregory Pickett <gpickett71@...oo.com>
To: "fulldisclosure@...lists.org" <fulldisclosure@...lists.org>; "bugtraq@...urityfocus.com" <bugtraq@...urityfocus.com>
Sent: Wednesday, June 1, 2016 10:58 AM
Subject: rConfig, the open source network device configuration management tool, Vulnerable to Local File Inclusion

Title
===================
rConfig, the open source network device configuration management tool, Vulnerable to Local File Inclusion

Summary
===================
rConfig, the open source network device configuration management tool, is vulnerable to local file inclusion in /lib/crud/downloadFile.php.  downloadFile.php allows authenticated users to download any file on the server.

Affected Products
===================
rConfig 3.1.1 and earlier 

CVE
===================
N/A

Details
===================
rConfig, the open source network device configuration management tool, is vulnerable to local file inclusion in /lib/crud/downloadFile.php.  downloadFile.php allows authenticated users to download any file on the server.  This is because downloadFile.php does not check the download_file parameter before it uses it.  It merely opens and sends the file in the parameter to the user.  As long as the account running the web server has access to it, rConfig will open it and send it.

Verification of Vulnerability
===================
The following steps can be carried out in duplicating this vulnerability.

Step 1: 
Enter the following into your browser address bar:

  http://<SERVER>/lib/crud/downloadFile.php?download_file=/etc/passwd

Step 2: 
Confirm that the passwd file is valid

Impact
===================
Information Disclosure.  User privileges and unauthorized access to the system.

Credits
===================
Gregory Pickett (@shogun7273), Hellfire Security
