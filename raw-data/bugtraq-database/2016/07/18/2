
Date: Sun, 17 Jul 2016 09:33:25 +0200
From: Tim Schughart <info@...sec-networks.com>
To: fulldisclosure@...lists.org, submissions@...ketstormsecurity.com,
  bugtraq@...urityfocus.com
Cc: S&V Sarah Hennemann <info@...sec-networks.com>
Subject: Multiple vulns in Vodafone EasyBox 804 

Hi@all

#### General Information
## Report history:
Since 01.05. we have contacted the support of Vodafone 3 times. There has been no response until today.
Toady we release the vulnerabilities in hope that Vodafone will react.

## Vendor Information:
Vodafone is worldwide operating ISP.
Quotation of vodafone.com - about us:
"
Today, more than 400 million customers around the world choose us.

In 30 years, a small mobile operator in Newbury has grown into a global business and one of the most valuable brands in the world. We now operate in around 30 countries and partner with networks in over 50 more.
"
## Affected products:
EasyBox 804 in all versions and perhaps other product models. EasyBox 804 is shipped to german private customers default. We were not able to verify other countries and business customers default box.
We were not able to test other models, because vodafone have not shown any reaction.

#### Vuln 1 DoS
Combined with this vulnerability it is possible to disable authentication for Vuln 2. This is a combined attack.
CVSSv3: 6.5 (AV:A,AC:L,PR:N,UI:N,S:U,C:N,I:N,A:H)
Credits: Tim Schughart, ProSec Networks
Affected firmware versions: All
Patch available: No

PoC:
You have to browse to the web interface of the router, default is http://192.168.2.1 - here you just need to click on forgot password. This results, in an factory reset, after you have entered the captcha code. The Box is DoS, because you have to refill all needed data for connecting to Vodafone, but thats not all - here is an problem, you'll find in vuln 2.

#### Vuln 2 (Infected Firmware upload & Authentication Bypass)
For upgrading an Firmware you have to be authenticated - but after exploiting vuln 1, this authentication is disabled - so you are able to upload an modified firmware.
CVSSv3: 8.3 (AV:A,AC:H,PR:N,UI:N,S:C,I:H,A:H)
Credits: Tim Schughart, ProSec Networks
Affected firmware versions: All
Patch available: No

PoC:
You have to exploit Vuln 1 before. After this the authentication for firmware upgrades has been bypassed and you are able to upload any infected firmware you want. Because the code of EasyBox is OpenSource - it's much easier to modify it.
You just need to click on "Firmware update" - thats all.


Best regards / Mit freundlichen Grüßen

Tim Schughart
CEO / Geschäftsführer

--
ProSec Networks
Glogauerstraße 5
56077 Koblenz

Website: https://www.prosec-networks.com
E-Mail: t.schughart@...sec.networks.com
Mobile: +49 (0)157 7901 5826
Phone: +49 (0)2621 9469 252

"This E-Mail communication may contain CONFIDENTIAL, PRIVILEGED and/or LEGALLY PROTECTED information and is intended only for the named recipient(s). Any unauthorized use, dissemination, copying or forwarding is strictly prohibited. If you are not the intended recipient and have received this email communication in error, please notify the sender immediately, delete it and destroy all copies of this E-Mail. VAT ID: DE290654714 legal domicile Koblenz, HRA 21371.“

"Diese E-Mail Mitteilung kann VERTRAULICHE, dem BERUFSGEHEIMNIS UNTERLIEGENDE und/oder RECHTLICH GESCHÜTZTE Informationen enthalten und ist ausschließlich für den/die genannten Adressaten bestimmt. Jede unbefugte Nutzung, Weitergabe, Vervielfältigung oder Versendung ist strengstens verboten. Sollten Sie nicht der angegebene Adressat sein und diese E-Mail Mitteilung irrtümlich erhalten haben, informieren Sie bitte sofort den Absender, löschen diese E-Mail und vernichten alle Kopien. USt-IdNr.:  DE290654714, Amtsgericht Koblenz, HRA 21371."





Download attachment "signature.asc" of type "application/pgp-signature" (843 bytes)
