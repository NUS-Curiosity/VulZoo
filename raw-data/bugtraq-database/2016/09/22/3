
Date: Wed, 21 Sep 2016 13:16:21 -0700 (PDT)
From: security-alert@....com
To: bugtraq@...urityfocus.com
Subject: [security bulletin] HPSBGN03645 rev.2 - HPE Helion OpenStack Glance, Remote Access Restriction Bypass, Unauthorized Access

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Note: the current version of the following document is available here:
https://h20564.www2.hpe.com/hpsc/doc/public/display?docId=emr_na-c05273584

SUPPORT COMMUNICATION - SECURITY BULLETIN

Document ID: c05273584
Version: 2

HPSBGN03645 rev.2 - HPE Helion OpenStack Glance, Remote Access Restriction
Bypass, Unauthorized Access

NOTICE: The information in this Security Bulletin should be acted upon as
soon as possible.

Release Date: 2016-09-15
Last Updated: 2016-09-15

Potential Security Impact: Remote Access Restriction Bypass, Unauthorized
Access

Source: Hewlett Packard Enterprise, Product Security Response Team

VULNERABILITY SUMMARY
Potential vulnerabilities have been identified in HPE Helion OpenStack
Glance. The vulnerabilities can be remotely exploited to allow access
restriction bypass and unauthorized access.

Note:
A malicious tenant is able to reuse deleted Glance image IDs to share
malicious images with other tenants in a manner that is undetectable to the
victim tenant if the Helion OpenStack administrators have both:

  1. Edited the policy.json file to allow non-admin tenants to share images
with other tenants or edited policy.json to allow non-admin tenants to create
public images.
  2. Deleted image IDs from the Glance database, either manually or using the
purge tool ("glance-manage db purge").

    Further details are available in OSSN-0075 here:
https://wiki.openstack.org/wiki/OSSN/OSSN-0075.

References:

  - CVE-2016-4383
  - OSSN-0075
  - PSRT110227, PSRT110231

SUPPORTED SOFTWARE VERSIONS*: ONLY impacted versions are listed.

HPE Helion CloudSystem all
HPE Helion OpenStack all

BACKGROUND

  CVSS Base Metrics
  =================
  Reference, CVSS V3 Score/Vector, CVSS V2 Score/Vector

    CVE-2016-4383
      7.6 CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:H
      9.0 (AV:N/AC:L/Au:S/C:C/I:C/A:C)

    Information on CVSS is documented in
    HPE Customer Notice HPSN-2008-002 here:

https://h20564.www2.hpe.com/hpsc/doc/public/display?docId=emr_na-c01345499

RESOLUTION

HPE has provided the following mitigation instructions for HPE Helion
OpenStack Glance:

 * This procedure ensures that images shared between two tenants who trust
each other are not maliciously replaced by a malicious tenant reusing a
deleted image ID. Perform the following action:

  1. The admin should update the policy.json file so that only admins can
deactivate/reactivate images:
    "deactivate": "role:admin",
    "reactivate": "role:admin",
  2. All public or shared images should be quarantined by marking them as
deactivated using the Glance API.
  3. The admin should inspect all public/shared images to see if they have
been replaced by malicious images.
  4. Any images which cannot be confirmed to be non-malicious should be left
deactivated.
  5. Images which can be confirmed to be non-malicious images can be
reactivated using the Glance API.

    * **Note:** Images can be confirmed to be non-malicious for example by
examining the Glance logs or backup Glance databases to show that the image
ID has not been recycled.

HISTORY

Version:1 (rev.1) - 16 September 2016 Initial release
Version:2 (rev.2) - 15 September 2016 Corrected URL

Third Party Security Patches: Third party security patches that are to be
installed on systems running Hewlett Packard Enterprise (HPE) software
products should be applied in accordance with the customer's patch management
policy.

Support: For issues about implementing the recommendations of this Security
Bulletin, contact normal HPE Services support channel. For other issues about
the content of this Security Bulletin, send e-mail to security-alert@....com.

Report: To report a potential security vulnerability for any HPE supported
product:
  Web form: https://www.hpe.com/info/report-security-vulnerability
  Email: security-alert@....com

Subscribe: To initiate a subscription to receive future HPE Security Bulletin
alerts via Email: http://www.hpe.com/support/Subscriber_Choice

Security Bulletin Archive: A list of recently released Security Bulletins is
available here: http://www.hpe.com/support/Security_Bulletin_Archive

Software Product Category: The Software Product Category is represented in
the title by the two characters following HPSB.

3C = 3COM
3P = 3rd Party Software
GN = HPE General Software
HF = HPE Hardware and Firmware
MU = Multi-Platform Software
NS = NonStop Servers
OV = OpenVMS
PV = ProCurve
ST = Storage Software
UX = HP-UX

Copyright 2016 Hewlett Packard Enterprise

Hewlett Packard Enterprise shall not be liable for technical or editorial
errors or omissions contained herein. The information provided is provided
"as is" without warranty of any kind. To the extent permitted by law, neither
HP or its affiliates, subcontractors or suppliers will be liable for
incidental,special or consequential damages including downtime cost; lost
profits; damages relating to the procurement of substitute products or
services; or damages for loss of data, or software restoration. The
information in this document is subject to change without notice. Hewlett
Packard Enterprise and the names of Hewlett Packard Enterprise products
referenced herein are trademarks of Hewlett Packard Enterprise in the United
States and other countries. Other product and company names mentioned herein
may be trademarks of their respective owners.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQEcBAEBAgAGBQJX2w/XAAoJEGIGBBYqRO9/aDwH/14Z19Dchepbf0hsU/mP/S+F
IjdqmktJA+5+gDMRR0tXbxvaP6uMWmyOINdCeZSbzLD+wzeUJM861k5NuIPbOumV
ysAErrB0xYs3WbSKuvyMEBGk2b2bg7wjjXaq+X01ADJz5PVKoXSy2YPcAl/DBk4+
OTos0rjQ/3b4O1/tRrpuphPkapo+a8Fr5fntKbcyi8IEqCUWy+SafT3JR14x+m8Z
0I67xJXFdqs3m8/GsQqfNk89cXQNf+7xhgtiP4X5KuNSMWxskmS7nkrsFrmq2AM0
gpcUCR4R0w35qStJGVpA121avBpQS4GikApM9FzZ3RVdNuKhYRyiDIEOuR5Pz8g=
=9FUa
-----END PGP SIGNATURE-----
