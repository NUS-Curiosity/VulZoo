
Date: Fri, 19 Feb 2016 12:57:18 GMT
From: erlijn.vangenuchten@...s.de
To: bugtraq@...urityfocus.com
Subject: [SYSS-2015-057] Thru Managed File Transfer Portal 9.0.2 -
 Cross-Site Scripting

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Advisory ID: SYSS-2015-057
Product: Thru Managed File Transfer Portal 
Manufacturer: Thru
Affected Version(s): 9.0.2
Tested Version(s): 9.0.2
Vulnerability Type: Cross-Site Scripting (CWE-79)
Risk Level: Medium
Solution Status: Open
Manufacturer Notification: 2015-10-28
Solution Date: 2016-01-22
Public Disclosure: 2016-02-15
CVE Reference: Not yet assigned
Author of Advisory: Dr. Erlijn van Genuchten (SySS GmbH)

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Overview:

Thru Managed File Transfer Portal is a web based file transfer application. 
According to the Thru website [1], the application aims to offload large 
file transfer to a single platform, to protect files, to replace FTP 
servers and to allow access to files anytime, anywhere.

The Thru Managed File Transfer application is vulnerable to HTML 
injection attacks. This allows users to send e-mails with malicious 
content to another user in the context of a trustworthy Thru e-mail.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Vulnerability Details:

The SySS GmbH identified a vulnerability in the "file upload"
functionality for unauthenticated users. Here, it is possible to add a 
message that accompanies the uploaded file. A notification e-mail is sent 
to the receiving user, including this message. 

The described cross-site scripting vulnerability allows an attacker
to send an e-mail to the victim with malicious content, for example a
download link to a page owned by the attacker, in the context of a
trustworthy Thru e-mail.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Proof of Concept (PoC):

The following HTTP POST request using the HTML code 
<a href="[URL-EVIL-PAGE]">Click here</a> to download your file." as the
value for the parameter "uploadmessage" demonstrates that HTML code can
be injected:

POST /EmailCheck.aspx HTTP/1.1
Host: [HOST]
Referer: https://[host]/Desktop/Dropbox/Create/?
Content-Length: [content length]
Cookie: [COOKIES]

email=[e-mail]&ccEmails=&subjectemail=subject&uploadmessage%3d<a+href%3d"[url-to-evil-page]">Click+here</a>+to+download+your+file.&captcha=DropboxCreateCaptcha&captchaValue=4TH5C&captchaInstanceId=98ba49a8d3e94afe80a0e0dbf6df3e12&uploadprivatemessage=

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Solution:

The reported security vulnerability has been fixed in a new software
release. Update to the new software version.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclosure Timeline:

2015-10-23: Vulnerability discovered
2015-10-28: Vulnerability reported to manufacturer
2016-01-22: Manufacturer announced update
2016-02-15: Public release of security advisory

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

References:

[1] Thru Homepage
    http://www.thruinc.com
[2] SySS Security Advisory SYSS-2015-057
    https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2015-057.txt
[3] SySS Responsible Disclosure Policy
    https://www.syss.de/en/news/responsible-disclosure-policy/

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Credits:

This security vulnerability was found by Dr. Erlijn van Genuchten of the
SySS GmbH.

E-Mail: erlijn.vangenuchten@...s.de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Erlijn_vanGenuchten.asc
Key ID: 0xBD96FF2A
Key Fingerprint: 17BB 4CED 755A CBB3 2D47 C563 0CA5 8637 BD96 FF2A

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclaimer:

The information provided in this security advisory is provided "as is" 
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of  this security advisory is available on the SySS Web
site.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Copyright:

Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCgAGBQJWwbcfAAoJEAylhje9lv8q8jMQAJYZMY88k1KUpy4JAqWbkbj4
/VUmmtzVfTem3QlA0w31dAxg1kBb0guWflwnISb9uRdZ3FimqmHqZlecBzXS/W1Y
UMklyA/stN5m/kTID6NFtxCx11kjja7vn9iW8jkCEG6E/odwSiT8YnnTRKs9hOoZ
tPMUHn9tKNmh+MlYTm4Db4g42v/xL2tjnbZyB/gyuyO0a228BE7rim8BbDIUNUjG
5ocw/3RGp2V9RIBXxAehtoJlyo0y8c7vaHk8/7tA121tepsd31yBbZQ13LPIqrmQ
SpS1f5+h4hcavxlaOOrZ3L2BYlDIUeBmKpFNuvsfEmVVmt0Wfl/PH51VHv4GZXQ7
dG6YcSiqrvx5sNYJn8MMeUHTzP1tqkEarftW5YkclBERLSfqVUs4eOXS19rTYAE4
2GB1VFqT1OdF4/XUuEnNDsaXvastGHemYrlRb8Dvl2M+ynz+I30RVgUIxMMJmD90
y5xo8O14y9d3I9gFgOLCOsaQRrwa7/xUtIW6jTe5uLw+yitNh0TCYe1LP/ti3WSk
mu2bPRluw9Dc1xnBCZjAfHvwKs/lYRWGa5L/8FhtOSkHMYqYJLJGfkLPVKsDnY9W
+4Xt2KJb6ThklkGRFyOFZ7w4K/h+FUBMYrJF5Bc9aayy2UmfXMoVUh5YWMQLixRu
ZS4tT+O5x25sRY0DXdng
=PuaV
-----END PGP SIGNATURE-----
