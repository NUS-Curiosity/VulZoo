
Date: Wed, 3 Feb 2016 04:14:01 GMT
From: hyp3rlinx@...os.com
To: bugtraq@...urityfocus.com
Subject: Mezzanine CMS 4.1.0 Arbitrary File Upload

[+] Credits: hyp3rlinx

[+] Website: hyp3rlinx.altervista.org

[+] Source:  http://hyp3rlinx.altervista.org/advisories/MEZZANINE-CMS-ARBITRARY-FILE-UPLOAD.txt



Vendor:
===================
mezzanine.jupo.org


Product:
================
Mezzanine 4.1.0

Mezzanine is an open source CMS built using the python based Django framework.



Vulnerability Type:
=====================
Arbitrary File Upload



CVE Reference:
==============
N/A



Vulnerability Details:
=====================

Issue is within the`FILEBROWSER_EXTENSIONS` setting. This setting was previously only used client-side
and was not validated server-side, allowing local malicious users ability to bypass file check for uploads
resulting in arbitrary file types like .htaccess, .EXE and .sh being uploaded to the system.



Exploit code(s):
===============

Tested following arbitrary file uploads successfully .htaccess, .sh, .EXE ...

[26/Jan/2016 11:39:24] "GET /asset_proxy/?u=/static/filebrowser/uploadify/uploadify.swf HTTP/1.1" 200 22894
[26/Jan/2016 11:39:28] "POST /admin/media-library/check_file/ HTTP/1.1" 200 2

Resolution:
Upgrade right away (pip install -U filebrowser_safe).

If for some reason you're unable to upgrade seamlessly, here is the fix which you need to apply:
https://github.com/stephenmcd/filebrowser-safe/commit/14b30017d27ca6a952e1578ed8cecbb102979967



Disclosure Timeline:
=====================================
Vendor Notification: January 26, 2016
Feburary 2, 2016  : Public Disclosure



Exploitation Technique:
=======================
Local



Severity Level:
================
Medium



Description:
===================================================
Request Method(s):        [+]  POST


Vulnerable Product:       [+]  Mezzanine 4.1.0

====================================================

[+] Disclaimer
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit is given to the author.
The author is not responsible for any misuse of the information contained herein and prohibits any malicious use of all security related information or exploits by the author or elsewhere.

by hyp3rlinx
