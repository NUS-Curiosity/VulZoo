
Date: Tue, 10 Mar 2009 10:09:14 +0000
From: Bernhard Mueller <research@...-consult.com>
To: Bugtraq <bugtraq@...urityfocus.com>
Subject: SEC Consult SA-20090305-2 :: IBM Director CIM Server Local
 Privilege Escalation Vulnerability

SEC-CONSULT Security Advisory < 20090305-2 >
=========================================================================================
  title: IBM Director CIM Server Local Privilege Escalation
Vulnerability
  program: IBM Director for Windows
  vulnerable version: <= 5.20.3 Service Update 2
  homepage: http://www-03.ibm.com/systems/management/director/
  found: Sept. 2008
  by: Bernhard Mueller / SEC Consult Vulnerability Lab
  permanent link:
http://www.sec-consult.com/files/20090305-2_IBM_director_privilege_escalation.txt
=========================================================================================

Product description:
---------------

IBM Director is an application that can track and view system
configurations of remote computers. It is available for Linux, AIX, and
Windows servers.


Vulnerability overview:
---------------

The CIM server which comes with IBM Director suite for Microsoft Windows
contains a local privilege escalation vulnerability because the
application fails to properly validate incoming indication requests. By
exploiting this vulnerability an attacker can run arbitrary code with
the privileges of the CIM server process (LOCAL SYSTEM in the Windows
version).


Vulnerability details:
--------------- 

The CIM server listens for so-called indication requests which it passes
to local consumers. These consumers are implemented within dynamic link
libraries or shared objects that reside on the system. 
Because the consumer named is not checked for Windows path
metacharacters ("\"), it is possible to traverse the filesystem and
specify any library on the system. CIM server will load the specified
DLL and call its initialization function, PegasusCreateProvider(const
char *).

For example, the following request will load C:\mydll.dll:


M-POST /CIMListener/\..\..\..\..\mydll HTTP/1.1
CIMOperation: MethodCall
CIMExport: MethodRequest
CIMExportMethod: ExportIndication

[some xml]


The vulnerability can be exploited by a local user or an attacker who is
able to upload a file to the target system.


Fix:
---------------

The vendor has adressed this vulnerability in service update 2 for IBM
Director agent 5.20.3. Download link:

https://www14.software.ibm.com/webapp/iwm/web/reg/download.do?source=dmp&S_PKG=director_x_520&S_TACT=sms&lang=en_US&cp=UTF-8


vendor status:
---------------
vendor notified: 2008-11-03
patch available: 2009-03-09

--
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SEC Consult Unternehmensberatung GmbH

Office Vienna
Mooslackengasse 17
A-1190 Vienna
Austria

Tel.: +43 / 1 / 890 30 43 - 0
Fax.: +43 / 1 / 890 30 43 - 25
Mail: research at sec-consult dot com
www.sec-consult.com

# EOF Bernhard Mueller, SEC Consult Vulnerability Lab / @2009

