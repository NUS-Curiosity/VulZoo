
Date: Sun, 04 Jan 2009 22:00:24 +0530
From: Aditya K Sood <0kn0ck@...niche.org>
To: bugtraq@...urityfocus.com, submit@...w0rm.com,
	submit@...unia.com, vuln@...unia.com, bugs@...uritytracker.com,
	cve@...re.org, submissions@...ketstormsecurity.org,
	vuldb@...urityfocus.com
Subject: Google Chrome FTP PASV IP Malicious Port Scanning Vulnerability.

Advisory: Google Chrome FTP PASV IP Malicious Port Scanning Vulnerability.

Version Affected:
Google Chrome: 1.0.154.36

Description:
Google Chrome FTP Client is vulnerable to FTP PASV malicious port
scanning vulnerability. The username in the
FTP (ftp://username:password@...ain.com) can be manipulated by tampering
it with certain IP address with
specification of port as
(ftp://xxx.xxx.xxx.xxx-22:password@...ain.com).The Google Chrome FTP
client make
connection to the rogue FTP server which uses PASV commands to scan
network.Dynamic requests are issued to a
rogue FTP server which accepts connection with different usernames as
the IP address with specified ports to locate
the non existing object on the target domain.

Request 1 : ftp://xxx.xxx.xxx.xxx-21:password@...ain.com
Request 2 : ftp://xxx.xxx.xxx.xxx-22:password@...ain.com
Request 3 : ftp://xxx.xxx.xxx.xxx-23:password@...ain.com
Request 4 : ftp://xxx.xxx.xxx.xxx-25:password@...ain.com

JavaScript Port Scanning is used to exploit this issue. A malicious web
page hosted on a specially-coded FTP server
could use this feature to perform a generic port-scan of machines inside
the firewall of the victim.The generated
fraudulent request helps attacker to exhibit internal network
information through sustainable port scanning through
JavaScript.

Proof of Concept:
http://www.secniche.org/gcfpv

Links:
http://secniche.org/gcfps.html
http://evilfingers.com/advisory/index.php

Detection:
SecNiche confirmed this vulnerability affects Google Chrome on Microsoft
Windows XP SP2 platform.
The versions tested are:

Chrome: 1.0.154.36

Disclosure Timeline:
Disclosed: 1 January 2009
Release Date. 4 January 2009

Vendor Response:
Google acknowledges this vulnerability by reproducing the issue. Views
have been exchanged over the
 severity level of this flaw.The chrome ID of this issue is 5978.

Credit:
Aditya K Sood

Disclaimer:
The information in the advisory is believed to be accurate at the time
of publishing based on currently
available information. Use of the information constitutes acceptance for
use in an AS IS condition. There
is no representation or warranties, either express or implied by or with
respect to anything in this
document, and shall not be liable for a ny implied warranties of
merchantability or fitness for a particular
purpose or for any indirect special or consequential damages.
