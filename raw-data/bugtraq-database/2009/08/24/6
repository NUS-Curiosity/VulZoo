
Date: Tue, 25 Aug 2009 00:25:56 +1200
From: Roberto Suggi Liverani <roberto.suggi@...urity-assessment.com>
To: <bugtraq@...urityfocus.com>
Subject: CoolPreviews - Firefox Extension - Chrome Privileged Code Injection

   (    , )     (,
  .   `.' ) ('.    ',
   ). , ('.   ( ) (
  (_,) .`), ) _ _,
 /  _____/  / _  \    ____  ____   _____  
 \____  \==/ /_\  \ _/ ___\/  _ \ /     \ 
 /       \/   |    \\  \__(  <_> )  Y Y  \
/______  /\___|__  / \___  >____/|__|_|  /
        \/         \/.-.    \/         \/:wq 
                    (x.0)
                  '=.|w|.='
                  _='`"``=.

		presents..

CoolPreviews Chrome Privileged Code Injection

+-----------+
|Description|
+-----------+

Security-Assessment.com discovered that Coolpreviews
stack feature is vulnerable to Cross Site Scripting
injection. The Coolpreviews stack previews link
content within a Chrome window positioned on the right
side of the browser window. A malicious page is then
able to pass arbitrary browser code, such as
JavaScript, via a link that points to a data URI which
embeds the cross site scripting payload. The injected
browser code is rendered and executed in the chrome
privileged Firefox zone.
The code is automatically executed when the user adds
the malicious link to the stack (by default, right
click and then Cool Previews â€“ Add To Stack).


+------------+
|Exploitation|
+------------+

This vulnerability can be exploited in several ways.
As the injection point is in the chrome privileged
browser zone, it is possible to bypass Same Origin
Policy (SOP) protections, and also access Mozilla
built-in XPCOM components. XPCOM components can be
used to read and write from the file system, as well
as execute arbitrary commands, steal stored passwords,
 or modify other Firefox extensions.


+--------+
|Solution|
+--------+

Security-Assessment.com follows responsible disclosure
and promptly contacted the developer after discovering
the issue. The developer was contacted on March 5,
2009, and no response was received. A fix was silently
released on April 20, 2009.

Install the latest CoolPreviews version. This is
available from Mozilla Add-ons website
(https://addons.mozilla.org/en-US/firefox/addon/2207).


+------+
|Credit|
+------+

Discovered and advised to the CoolPreviews vendor
March 2009 by Roberto Suggi Liverani of Security-
Assessment.com. Personal Page: http://malerisch.net/

For full details regarding this vulnerability
(including a detailed proof of concept exploit)
download the PDF from our website:
http://www.security-assessment.com/files/advisories/CoolPreviews_Firefox_Extension_Security_Advisory.pdf

For more details regarding exploitation of Firefox
extensions, refer to our DEFCON 17 presentation at

http://www.security-assessment.com/files/presentations/liverani_freeman_abusing_firefox_extensions_defcon17.pdf

Security-Assessment.com is a New Zealand based world
leader in web application testing, network security
and penetration testing. Security-Assessment.com
services organisations across New Zealand, Australia,
Asia Pacific, the United States and the United
Kingdom.

Roberto Suggi Liverani


