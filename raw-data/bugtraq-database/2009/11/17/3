
Date: 17 Nov 2009 12:09:34 -0000
From: karakorsankara@...mail.com
To: bugtraq@...urityfocus.com
Subject: Hellcode Research: Novell eDirectory HTTPSTK Login Stack Overflow
 Vulnerability

Vendor: Novell

Product: eDirectory for Windows

Version: 8.8 SP5

Vulnerability: Stack Overflow

Description:

Vulnerability is in "/dhost/httpstk"
This vulnerability allows remote attackers to execute arbitrary code
on vulnerable installations of Novell eDirectory. 

The specific flaw exists in the handling of URL parameters 
when posting to the login form of the HTTPSTK web server.
( <FORM method="post" action="/dhost/httpstk;submit"> ) 
Successful exploitation can lead to complete system compromise under the SYSTEM credentials.

Authentication is required to exploit this vulnerability.

Debugger Results:

(ea8.aec): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=41414141 ebx=734c4d90 ecx=035efe24 edx=00000193 esi=035efe24 edi=035efe24
eip=62408f23 esp=035efd20 ebp=035efd6c iopl=0         nv up ei pl nz na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010206
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for C:\Novell\NDS\httpstk.dlm - 
httpstk!HT_RspCCSetNoCache+0x5fb:
62408f23 80b8e500000000  cmp     byte ptr [eax+0E5h],0      ds:0023:41414226=??

0:007> g
(ea8.aec): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=00000000 ebx=00000000 ecx=41414141 edx=77569bad esi=00000000 edi=00000000
eip=41414141 esp=035ef950 ebp=035ef970 iopl=0         nv up ei pl zr na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246
41414141 ??              ???


0:007> !exchain
035ef964: ntdll!RtlRaiseStatus+c8 (77569bad)
035eff34: 41414141
Invalid exception stack at 41414141

Credit to:
karak0rsan and murderkey from Hellcode Research
www.hellcode.net

Proof of Concept:

http://tcc.hellcode.net/sploitz/httpstk.txt

Original Advisory:

http://tcc.hellcode.net/advisories/hellcode-adv005.txt

