
Date: Tue, 10 Nov 2009 15:07:59 +0100
From: Laurent Butti <laurent.butti@...nge-ftgroup.com>
To: bugtraq@...urityfocus.com
Subject: Atheros Driver Reserved Frame Vulnerability

Title:
------
* Atheros Driver Reserved Frame Vulnerability

Summary:
--------
* The wireless driver in some Wi-Fi access points (such as the
ATHEROS-based Netgear WNDAP330) do not correctly parse malformed
reserved management frames.

Assigned CVE:
-------------
* CVE-2009-0052

Details:
--------
* The bug can be triggered by a malicious reserved management frame sent
to the wireless access point (truncated packet). This can be achieved
only after a successful 802.11 authentication (in "Open" mode according
to the configuration of the wireless access point) and a successful
802.11 association with appropriate security parameters (e.g. WPA w/
TKIP unicast, TKIP multicast) which depends on the configuration of the
wireless access point.

Attack Impact:
--------------
* Denial-of-service (reboot or hang-up) and possibly remote arbitrary
code execution

Attack Vector:
--------------
* Unauthenticated wireless device for WPA/WPA2-PSK and EAP-based
authenticated wireless device for WPA/WPA2-EAP

Timeline:
---------
* 2008-09-30 - Vulnerability reported Netgear
* 2008-10-02 - PoC sent to Netgear
* 2009-10-14 - Netgear released a patched firmware (3.0.3)
* 2009-11-10 - Release of this security advisory

Affected Products:
------------------
* Netgear WNDAP330 (firmware 2.1.11) with ATHEROS AR9160-BC1A chipset

Vulnerable Devices:
-------------------
* As it is a wireless driver specific issue, the wireless vendor should
use the latest chipset wireless driver for their access point firmwares.
This security vulnerability was reported to Netgear, updated firmwares
should be available on their web site. Any other wireless device relying
on this vulnerable wireless driver is likely to be vulnerable.

Credits:
--------
* This vulnerability was discovered by Laurent Butti from France Telecom
/ Orange

