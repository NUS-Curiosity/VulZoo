
Date: Fri, 12 Jan 2018 11:50:22 +0100
From: Vulnerability Lab <research@...nerability-lab.com>
To: bugtraq@...urityfocus.com, bugs@...uritytracker.com
Subject: MagicSpam 2.0.13 - Insecure File Permission Vulnerability

Document Title:
===============
MagicSpam 2.0.13 - Insecure File Permission Vulnerability


References (Source):
====================
https://www.vulnerability-lab.com/get_content.php?id=2113


Release Date:
=============
2018-01-12


Vulnerability Laboratory ID (VL-ID):
====================================
2113


Common Vulnerability Scoring System:
====================================
2.8


Vulnerability Class:
====================
Privacy Violation - Information Disclosure


Current Estimated Price:
========================
500€ - 1.000€


Product & Service Introduction:
===============================
MagicSpam comes fully-integrated with any Plesk 12+ package, blocking spam at the edge before it gets a chance to be filtered. 
There’s no need to change DNS or MX records. And your protection comes ready to go with complete logging, statistics, and custom controls.

(Copy of the Homepage: https://www.plesk.com/extensions/magicspam/ )


Abstract Advisory Information:
==============================
An independent vulnerability laboratory researcher discovered a insecure file permission vulnerability in the MagicSpam 2.0.13-1 plesk extension.



Vulnerability Disclosure Timeline:
==================================
2017-01-12: Public Disclosure (Vulnerability Laboratory)


Discovery Status:
=================
Published


Affected Product(s):
====================
LinuxMagic
Product: MagicSpam - Plesk Extension 2.0.13-1


Exploitation Technique:
=======================
Remote


Severity Level:
===============
Low


Technical Details & Description:
================================
An insecure file permission access vulnerability has been discovered in the MagicSpam 2.0.13-1 plesk extension.
The vulnerability allows an attacker to access sensitive information like emails without permission or authentication.


Plesk panel features the freemium extension MagicSpam providing industry-leading spam protection technologies.
MagicSpam is keeping a detailed log of all e-mail messages processed under directory /var/log/magicspam/ in 
Ubuntu installations. A log file is created with the name mslog, with readable permissions for everyone, and rotated daily. 
The file will reveal the full list of mailboxes on the server (provided they received or sent at least one message in the past).

The security risk of the permission vulnerability is estimated as low with a common vulnerability scoring system count of 2.8. 
Successful exploitation of the file permission security vulnerability results in information disclosure of emails.


Proof of Concept (PoC):
=======================
The insecure file permission vulnerability can be exploited by remote attackers without user account or user interaction.
For security demonstration or to reproduce the vulnerability follow the provided information and steps below to continue.

$ id
uid=1002(marco) gid=1011(marco) groups=1011(marco)
$ cd /var/log/magicspam/
$ ls -l
-rw-r--r-- 1 magicspam root 348937 Jan 10 11:50 mslog
$ tail -n1 mslog
2018-01-10 11:51:26 magicspam-daemon[335]: HAM: mua=no,ip=[93.94.32.17:mail15.clab99a.contactlab.it],helo=<mail15.clab99a.contactlab.it>,from=<564020151.35960.1000117@...ontactlab.it>,rcpt=<info@...networksolution.it>


Solution - Fix & Patch:
=======================
The security vulnerability can be resolved byan exclude of the emails in the list of the affected application log files.
Another solution could be to integration an authentication mechanism  for the log file of the magic spam web-application.


Security Risk:
==============
The security risk of the insecure file permission vulnerability in the plesk extension magic spam is estimated as medium (CVSS 2.8).


Credits & Authors:
==================
Marco Marsala [marco@...networksolution.it] - https://www.vulnerability-lab.com/show.php?user=Marco+Marsala


Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either expressed or 
implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers are not liable in any 
case of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability Labs or its 
suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability mainly for incidental
or consequential damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break any licenses, policies, deface 
websites, hack into databases or trade with stolen data. We have no need for criminal activities or membership requests. We do not publish advisories 
or vulnerabilities of religious-, militant- and racist- hacker/analyst/researcher groups or individuals. We do not publish trade researcher mails, 
phone numbers, conversations or anything else to journalists, investigative authorities or private individuals. 

Domains:    www.vulnerability-lab.com		- www.vulnerability-db.com					- www.evolution-sec.com
Programs:   vulnerability-lab.com/submit.php 	- vulnerability-lab.com/list-of-bug-bounty-programs.php 	- vulnerability-lab.com/register.php
Feeds:	    vulnerability-lab.com/rss/rss.php 	- vulnerability-lab.com/rss/rss_upcoming.php 			- vulnerability-lab.com/rss/rss_news.php
Social:	    twitter.com/vuln_lab		- facebook.com/VulnerabilityLab 				- youtube.com/user/vulnerability0lab

Any modified copy or reproduction, including partially usages, of this file, resources or information requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by 
Vulnerability Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and other information on this website is trademark 
of vulnerability-lab team & the specific authors or managers. To record, list, modify, use or edit our material contact (admin@) to get an ask permission.

				    Copyright © 2018 | Vulnerability Laboratory - [Evolution Security GmbH]™



-- 
VULNERABILITY LABORATORY - RESEARCH TEAM
SERVICE: www.vulnerability-lab.com

