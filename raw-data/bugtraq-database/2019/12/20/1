
Date: Fri, 20 Dec 2019 15:10:23 +1100
From: Alexander Minozhenko <aminozhenko@...assian.com>
To: bugtraq@...urityfocus.com
Subject: Confluence Server and Data Center Security Advisory - 2019-12-18 - CVE-2019-15006

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

This email refers to the advisory found at
https://confluence.atlassian.com/doc/confluence-security-advisory-2019-12-18-982324349.html
.


CVE ID:

* CVE-2019-15006.


Product: Confluence Server and Data Center.

Affected Confluence Server and Data Center product versions:

6.11.0 <= version < 6.13.10
6.12.0 <= version < 6.13.10
6.13.0 <= version < 6.13.10
6.14.0 <= version < 6.15.10
6.15.0 <= version < 6.15.10
7.0.1 <= version < 7.0.5
7.1.0 <= version < 7.1.2
version < 7.2.0


Fixed Confluence Server and Data Center product versions:

* for 6.11.x, Confluence Server and Data Center 6.13.10 has been released with a
fix for this issue.
* for 6.12.x, Confluence Server and Data Center 6.13.10 has been released with a
fix for this issue.
* for 6.13.x, Confluence Server and Data Center 6.13.10 has been released with a
fix for this issue.
* for 6.14.x, Confluence Server and Data Center 6.15.10 has been released with a
fix for this issue.
* for 6.15.x, Confluence Server and Data Center 6.15.10 has been released with a
fix for this issue.
* for 7.0.x, Confluence Server and Data Center 7.0.5 has been released with a
fix for this issue.
* for 7.1.x, Confluence Server and Data Center 7.1.2 has been released with a
fix for this issue.
* for 7.2.x, Confluence Server and Data Center 7.2.0 has been released with a
fix for this issue.


Summary:
This advisory discloses a medium severity security vulnerability. Versions of
Confluence Server and Data Center  are affected by this vulnerability.



Customers who have upgraded Confluence Server and Data Center to version 6.13.10
or 6.15.10 or 7.0.5 or 7.1.2 or 7.2.0 are not affected.

Customers who have downloaded and installed Confluence Server and Data Center >=
6.11.0 but less than 6.13.10 (the fixed version for 6.11.x) or who have
downloaded and installed Confluence Server and Data Center >= 6.12.0 but less
than 6.13.10 (the fixed version for 6.12.x) or who have downloaded and installed
Confluence Server and Data Center >= 6.13.0 but less than 6.13.10 (the fixed
version for 6.13.x) or who have downloaded and installed Confluence Server and
Data Center >= 6.14.0 but less than 6.15.10 (the fixed version for 6.14.x) or
who have downloaded and installed Confluence Server and Data Center >= 6.15.0
but less than 6.15.10 (the fixed version for 6.15.x) or who have downloaded and
installed Confluence Server and Data Center >= 7.0.1 but less than 7.0.5 (the
fixed version for 7.0.x) or who have downloaded and installed Confluence Server
and Data Center >= 7.1.0 but less than 7.1.2 (the fixed version for 7.1.x) or
who have downloaded and installed Confluence Server and Data Center less than
7.2.0 (the fixed version for 7.2.x) please upgrade your Confluence Server and
Data Center installations immediately to fix this vulnerability.



Atlassian Companion Man-in-the-Middle - CVE-2019-15006

Severity:
Atlassian rates the severity level of this vulnerability as medium, according
to the scale published in our Atlassian severity levels. The scale allows us to
rank the severity as critical, high, moderate or low.
This is our assessment and you should evaluate its applicability to your own IT
environment.


Description:

There was a man-in-the-middle (MITM) vulnerability present in the Confluence
Previews plugin in Confluence Server and Confluence Data Center. This plugin was
used to facilitate communication with the Atlassian Companion application. The
Confluence Previews plugin in Confluence Server and Confluence Data Center
communicated with the Companion application via the
atlassian-domain-for-localhost-connections-only.com domain name, the DNS A
record of which points at 127.0.0.1. Additionally, a signed certificate for the
domain was publicly distributed with the Companion application. An attacker in
the position to control DNS resolution of their victim could carry out a
man-in-the-middle (MITM) attack between Confluence Server (or Confluence Data
Center) and the atlassian-domain-for-localhost-connections-only.com domain
intended to be used with the Companion application. This certificate has been
revoked, however, usage of the
atlassian-domain-for-localhost-connections-only.com domain name was still
present in Confluence Server and Confluence Data Center. An attacker could
perform the described attack by denying their victim access to certificate
revocation information, and carry out a man-in-the-middle (MITM) attack to
observe files being edited using the Companion application and/or modify them,
and access some limited user information.
Versions of Confluence Server and Data Center from version 6.11.0 before 6.13.10
(the fixed version for 6.13.x), from version 6.14.0 before 6.15.10 (the fixed
version for 6.15.x), from version 7.0.1 before 7.0.5 (the fixed version for
7.0.x), from version 7.1.0 before 7.1.2 (the fixed version for 7.1.x), and from
version 7.2.0-beta1 before 7.2.0 (the fixed version for 7.2.x) are affected by
this vulnerability. This issue can be tracked at:
https://jira.atlassian.com/browse/CONFSERVER-59244 .



Fix:

To address this issue, we've released the following versions containing a fix:

* Confluence Server and Data Center version 6.13.10
* Confluence Server and Data Center version 6.15.10
* Confluence Server and Data Center version 7.0.5
* Confluence Server and Data Center version 7.1.2
* Confluence Server and Data Center version 7.2.0

Remediation:

Upgrade Confluence Server and Data Center to version 7.2.0 or higher.

The vulnerabilities and fix versions are described above. If affected, you
should upgrade to the latest version immediately.

If you are running Confluence Server and Data Center 6.11.x and cannot upgrade
to 7.2.0, upgrade to version 6.13.10.
If you are running Confluence Server and Data Center 6.12.x and cannot upgrade
to 7.2.0, upgrade to version 6.13.10.
If you are running Confluence Server and Data Center 6.13.x and cannot upgrade
to 7.2.0, upgrade to version 6.13.10.
If you are running Confluence Server and Data Center 6.14.x and cannot upgrade
to 7.2.0, upgrade to version 6.15.10.
If you are running Confluence Server and Data Center 6.15.x and cannot upgrade
to 7.2.0, upgrade to version 6.15.10.
If you are running Confluence Server and Data Center 7.0.x and cannot upgrade to
7.2.0, upgrade to version 7.0.5.
If you are running Confluence Server and Data Center 7.1.x and cannot upgrade to
7.2.0, upgrade to version 7.1.2.


For a full description of the latest version of Confluence Server and Data
Center, see
the release notes found at
https://confluence.atlassian.com/display/DOC/Confluence+Release+Notes. You can
download the latest version of Confluence Server and Data Center from the
download centre found at
https://www.atlassian.com/software/confluence/download.



Support:
If you have questions or concerns regarding this advisory, please raise a
support request at https://support.atlassian.com/.


-----BEGIN PGP SIGNATURE-----

iQJLBAEBCgA1FiEEXh3qw5vbMx/VSutRJCCXorxSdqAFAl38SXsXHHNlY3VyaXR5
QGF0bGFzc2lhbi5jb20ACgkQJCCXorxSdqBeEw/7Ba12Tx9Qp55zijweiN0mtXcE
quinn2mWQNzR45e/yruL3JDqcStjThyYL7ahzjlcohdZPq9u23SW27PGWIKln8Yz
VHNjzpATJgpXNmZwtiZfm3xSqnNVnJMwLpVp9Shd/PfckwyciyRbkLClybamYmnd
Tt9XsNbEr/3oba3YwpBDVUwgZZwYtsGCcrOkUp57q4hE0WH5J6fKRmgm7pWP8/Xi
bzlubzp5f8RlL3FICU3xDDLOlJCznOdFdMoNaMnUCyzqISAP1eRWuq8eRVxLlt+C
l/qlXGJ2pAc6tuVRtoTvoEIUAIKWPRiKGwKZN/djXoE5heaABJSwt30ut8UNMNel
Fdy1gPXwDJtk69jZm9rbW3Tcf3lV3oKPktxwkdJYpgDCpk9Tf2zHh3h7yKoCLqAX
IxtHY4WhKXwvoOJCrfJzIpyIZEvAqOBRch/FF/0BFcjUCOHTkQYmfTPyMKBPSM/u
6E/2ZSP1bGiTbLySbho9hKegVxkaU7Yb9FdHMqkeOYizTOmSnp07nqGSFcEmetcw
97SOtBS6JLl7TYBVdbyrocNJZp5qbRcvqnnbKjocRCZC/tdTLLiSMHvQwZjiey5Z
izSq8nR8l1nxQKItY7Jur1WfkKkFoMteVWK/eqDKOYtmUoPqL6wNJpXRnJyu6VPL
GkNBuF6wAq89EpUbIpY=
=FfBs
-----END PGP SIGNATURE-----
