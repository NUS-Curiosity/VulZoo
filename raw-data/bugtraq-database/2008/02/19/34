
Date: Tue, 19 Feb 2008 23:12:29 +0100
From: Luigi Auriemma <aluigi@...istici.org>
To: bugtraq@...urityfocus.com, news@...uriteam.com,
	full-disclosure@...ts.grok.org.uk, vuln@...unia.com,
	packet@...ketstormsecurity.org
Subject: Multiple buffer-overflow in NowSMS v2007.06.27


#######################################################################

                             Luigi Auriemma

Application:  Now SMS/MMS Gateway
              http://www.nowsms.com
Versions:     <= v2007.06.27
Platforms:    Windows
Bugs:         A] web authorization buffer-overflow
              B] SMPP buffer-overflow
Exploitation: remote
Date:         19 Feb 2008
Author:       Luigi Auriemma
              e-mail: aluigi@...istici.org
              web:    aluigi.org


#######################################################################


1) Introduction
2) Bugs
3) The Code
4) Fix


#######################################################################

===============
1) Introduction
===============


NowSMS is a commercial SMS and MMS Content Delivery Solution.


#######################################################################

=======
2) Bugs
=======

------------------------------------
A] web authorization buffer-overflow
------------------------------------

The web interface of NowSMS which listens on port 8800 allows the users
to use the gateway for sending various types of messages (EMS, binary,
WAP, MMS and so on).

The function which handles the base64 password located in the HTTP
Authorization parameter is affected by a stack based buffer-overflow
exploitable with more than 256 bytes.

The server can be exploited both in case it requires and doesn't
require authentication.


-----------------------
B] SMPP buffer-overflow
-----------------------

NowSMS uses a stack buffer of 4 kilobytes for containing the incoming
SMPP packets.
The lack of checks on the real size of these packets (max 0xffffffff
bytes) leads to a buffer-overflow vulnerability which can be exploited
by an attacker to execute malicious code remotely.

The SMPP server is not enabled by default and doesn't have a default
listening port (the admin must decide it).


#######################################################################

===========
3) The Code
===========


http://aluigi.org/poc/nowsmsz.zip


#######################################################################

======
4) Fix
======


No fix


#######################################################################


--- 
Luigi Auriemma
http://aluigi.org
