
Date: Tue, 3 Jun 2008 09:14:26 -0700
From: "Thor (Hammer of God)" <thor@...merofgod.com>
To: <bugtraq@...urityfocus.com>
Subject: RE: Windows Installer msiexec GUID Buffer Overflow

So, the "possible code execution" would run code in the context of the user who was running msiexec.exe?  If you are going to get them to run code to exploit the "vulnerability," wouldn't it be more efficient to just get them to run whatever resultant code you were trying to run in the first place?

t

> -----Original Message-----
> From: Patrick Webster [mailto:patrick@...hack.com]
> Sent: Tuesday, June 03, 2008 3:13 AM
> To: bugtraq@...urityfocus.com
> Subject: Windows Installer msiexec GUID Buffer Overflow
> 
> aushack.com - Vulnerability Advisory
> -----------------------------------------------
> Release Date:
>  03-Jun-2008
> 
> Software:
>  Microsoft Corporation - Windows Installer (msiexec.exe)
>  http://www.microsoft.com/
> 
>  "Microsoft Windows Installer is an installation and configuration
> service that
>   reduces the total cost of ownership. Windows Installer enables
> customers to
>   provide better corporate deployment and provides a standard format
> for
>   component management."
> 
> Versions tested:
>  4.5.6001.22159 and 3.1.4000.1823 are vulnerable.
>  Other versions are untested but assumed.
> 
> Vulnerability discovered:
> 
>  Unicode based stack overflow.
> 
> Vulnerability impact:
> 
>  Moderate - Code execution is possible but difficult due to the unicode
>  	    conversion. Some ActiveX controls pass the GUID, so it may
> 	    be exploited remotely. Other avenues may also be present.
> 
> Vulnerability information:
> 
>  By specifying an overly long Globally Uniquie Identifier (GUID),
>  it is possible to overwrite the stack and SE Handler.
> 
>  Example:
> 
>   msiexec.exe /x {<a few thousand A's>}
> 
> References:
>  aushack.com advisory
>  http://www.aushack.com/200806-msiexec.txt
> 
> Credit:
>  Patrick Webster ( patrick@...hack.com )
> 
> Disclosure timeline:
>  03-Jun-2008 - Disclosure.
> 
> EOF
