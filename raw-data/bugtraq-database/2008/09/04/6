
Date: Thu, 04 Sep 2008 10:37:46 +0200
From: Laurent Butti <laurent.butti@...nge-ftgroup.com>
To: bugtraq@...urityfocus.com
Subject: Marvell Driver EAPoL-Key Length Overflow

Title:
------
* Marvell Driver EAPoL-Key Length Overflow

Summary:
--------
* The wireless drivers in some Wi-Fi access points (such as the
MARVELL-based Netgear WN802T) do not correctly parse malformed EAPoL-Key
packets. This packet is used for unicast/multicast key derivation (which
are called 4-way handshake and group key handshake) of any secure
wireless connection (WPA-PSK, WPA2-PSK, WPA-EAP, WPA2-EAP).

Assigned CVE:
-------------
* CVE-2008-1144

Details:
--------
* The bug can be triggered by a malicious EAPoL-Key packet sent to the
wireless access point (this packet has an advertised length too long
triggering the overflow). This can be achieved only after a successful
802.11 authentication (in "Open" mode according to the configuration of
the wireless access point) and a successful 802.11 association with
appropriate security parameters (e.g. WPA w/ TKIP unicast, TKIP
multicast) which depends on the configuration of the wireless access point.

Attack Impact:
--------------
* Denial-of-service (reboot or hang-up) and possibly remote arbitrary
code execution

Attack Vector:
--------------
* Unauthenticated wireless device for WPA/WPA2-PSK and EAP-based
authenticated wireless device for WPA/WPA2-EAP

Timeline:
---------
* 2008-02-19 - Vulnerability reported Netgear
* 2008-03-06 - PoC sent to Netgear
* 2008-09-04 - Public disclosure

Affected Products:
------------------
* Netgear WN802T (firmware 1.3.16) with MARVELL 88W8361P-BEM1 chipset

Vulnerable Devices:
-------------------
* As it is a wireless driver specific issue, the wireless vendor should
use the latest chipset wireless driver for their access point firmwares.
This security vulnerability was reported to Netgear, updated firmwares
should be available on their web site. Any other wireless device relying
on this vulnerable wireless driver is likely to be vulnerable.

Credits:
--------
* This vulnerability was discovered by Laurent Butti and Julien Tinnes
from France Telecom / Orange
