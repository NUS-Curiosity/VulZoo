
Date: 5 May 2008 21:13:51 -0000
From: mkanat@...zilla.org
To: bugtraq@...urityfocus.com
Subject: Security Advisory for Bugzilla 3.0.3, 3.1.3, 2.22.3, and 2.20.5

Summary
=======

Bugzilla is a Web-based bug-tracking system, used by a large number of
software projects.

This advisory covers three security issues that have recently been
fixed in the Bugzilla code:

* Users without the "canconfirm" privilege could enter a bug as NEW
  or ASSIGNED by using the XML-RPC interface.

* When viewing several bugs at once, there was a Cross-Site Scripting hole.

* The inbound email interface allowed you to set the Reporter via the
  text of the email, instead of just using the From header.

All affected installations are encouraged to upgrade as soon as possible.

Vulnerability Details
=====================

Class:       Unauthorized Bug Change
Versions:    3.1.3
Description: Users normally need the "canconfirm" privilege to put bugs
             in the NEW or ASSIGNED state. However, users were being 
             allowed to create bugs in the NEW or ASSIGNED state if they
             were creating the bug through the XML-RPC interface.
Reference:   https://bugzilla.mozilla.org/show_bug.cgi?id=415471


Class:       Cross-Site Scripting
Versions:    2.17.2 and higher
Description: When using the "Format for Printing" view of a bug (or
             the "Long Format" of a bug list, which is the same thing),
             there was a cross-site scripting hole--arbitrary text
             from a particular URL parameter could be injected into the
             page without filtering.
Reference:   https://bugzilla.mozilla.org/show_bug.cgi?id=425665


Class:       Account Impersonation (Minor)
Versions:    2.23.4 and higher
Description: By design, email_in.pl always believes the "From" header as
             the user making changes or uses that as the reporter of the
             bug. However, you could also specify the changer/reporter in
             the body of the email and override the "From" header, possibly
             bypassing some security checks set up by administrators
             against the "From" header.
             For most installations this is a minor or inconsequential
             issue, as the documentation of email_in.pl already explains
             that it does not do any user authentication (it just
             believes the "From" header), so installations using it should
             not have been expecting user account security (though they
             may have had checks against the "From" header--that is what
             makes this a security issue).
Reference:   https://bugzilla.mozilla.org/show_bug.cgi?id=419188


Vulnerability Solutions
=======================

The fixes for the security bugs mentioned in this advisory are
included in the 3.0.4, 3.1.4, 2.22.4, and 2.20.6 releases. Upgrading
to these releases will protect installations from possible exploits of
these issues.

Full release downloads, patches to upgrade Bugzilla from previous
versions, and CVS upgrade instructions are available at:

  http://www.bugzilla.org/download/


Credits
=======

The Bugzilla team wish to thank the following people for their
assistance in locating, advising us of, and assisting us to fix
these issues:

Fr�d�ric Buclin
Max Kanat-Alexander
Bradley Baetz
Loren Butler
Marc Schumann

General information about the Bugzilla bug-tracking system can be found
at:

  http://www.bugzilla.org/

Comments and follow-ups can be directed to the mozilla.support.bugzilla
newsgroup or the support-bugzilla mailing list.
http://www.bugzilla.org/support/ has directions for accessing these
forums.
