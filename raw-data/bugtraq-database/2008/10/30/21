
Date: Thu, 30 Oct 2008 13:56:30 -0400
From: "labs-no-reply@...fense.com" <labs-no-reply@...fense.com>
To: bugtraq@...urityfocus.com, vulnwatch@...nwatch.org,
	full-disclosure@...ts.grok.org.uk
Subject: iDefense Security Advisory 10.30.08: Novell eDirectory NCP Get Extension
 Information Request Memory Corruption Vulnerability

iDefense Security Advisory 10.03.08
http://labs.idefense.com/intelligence/vulnerabilities/
Oct 03, 2008

I. BACKGROUND

Novell eDirectory is cross platform directory server. NetWare Core
Protocol, commonly referred to as NCP, is used by eDirectory to
synchronize data between servers in the directory tree. NCP supports
various request types, one of which is the 'Get NCP Extension
Information By Name Request.'

For more information, see the vendor's site found at the following link.

http://www.novell.com/products/edirectory/

II. DESCRIPTION

Remote exploitation of a memory corruption vulnerability in Novell
Inc.'s eDirectory could allow an attacker to execute arbitrary code
with the privileges of the affected service.

The vulnerability exists due to an area of heap memory being used after
it has already been freed. By sending malformed data it is possible to
cause an area of heap memory to be freed by one thread, and then reused
after another thread allocates the same area of memory. This results in
the original thread operating on the data changed by the second thread,
which may lead to the execution of arbitrary code.

III. ANALYSIS

Exploitation of this vulnerability results in the execution of arbitrary
code with the privileges of the affected service, usually SYSTEM. In
order to trigger this vulnerability, an attacker needs to send a series
of specifically timed requests and have some degree of control of the
memory layout of the process. In Labs testing, it was often difficult
to reliably trigger the vulnerability. While difficult, the possibility
of executing arbitrary code should not be ruled out.

IV. DETECTION

iDefense has confirmed the existence of this vulnerability in eDirectory
version 8.8 SP2 for Windows. The Linux version does not appear to be
affected. Previous versions may also be affected.

V. WORKAROUND

iDefense is currently unaware of any workarounds for this issue.

VI. VENDOR RESPONSE

Novell has released a patch for this vulnerability and advises that all
users of Novell eDirectory should update.

http://support.novell.com/docs/Readmes/InfoDocument/patchbuilder/readme_5037180.html
http://support.novell.com/docs/Readmes/InfoDocument/patchbuilder/readme_5037181.html

VII. CVE INFORMATION

A Mitre Corp. Common Vulnerabilities and Exposures (CVE) number has not
been assigned yet.

VIII. DISCLOSURE TIMELINE

03/10/2008  Initial vendor notification
03/14/2008  Initial vendor reply
10/03/2008  Public Disclosure

IX. CREDIT

The discoverer of this vulnerability wishes to remain anonymous.

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2008 iDefense, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDefense. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically,
please e-mail customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
  There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct,
indirect, or consequential loss or damage arising from use of, or
reliance on, this information.
