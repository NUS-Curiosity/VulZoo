
Date: Sat, 6 Feb 2010 12:43:46 +0100
From: Thierry Zoller <Thierry@...ler.lu>
To: bugtraq@...urityfocus.com, full-disclosure@...ts.grok.org.uk,
	<kcope2@...glemail.com>
Subject: Re: [Full-disclosure] Samba Remote Zero-Day Exploit

Hi Paul,

Facts :
- Several distributions run with vulnerable settings per default
  if there is a "misconfiguration" it is part of the vendor.
- Your not supposed to be able to traverse dirs.

Consequence it is a vulnerability, whether you can mitigate it is
a different piece of cake.

Next time somebody creates an IE8 0day that relies on javascript,
will  you  scream  "misconfiguration!"  ?  Of course you could disable
javascript  but  is  it  by enabled default ? Yes.

The question for smb is who does restrict this setting?
My tests reveal - not many.

Congrats  Kingcope,  nice  bug. Directory traversal in major daemon in
2010.

Regards,
Thierry


pssea> Dear Kingcope,

pssea> The samba server follows symlinks by default. There are options
pssea> ("follow symlinks", "wide links") for turning it off:

pssea> http://www.samba.org/samba/docs/using_samba/ch08.html#samba2-CHP-8-SECT-1.2
pssea> http://www.samba.org/samba/docs/man/manpages-3/smb.conf.5.html#FOLLOWSYMLINKS
pssea> http://www.samba.org/samba/docs/man/manpages-3/smb.conf.5.html#WIDELINKS

pssea> The "problem" at your installation seems a mis-configuration of
pssea> your server: please ask the admin to set "secure" options.
pssea> (Some samba installations, like mine, wish to allow same access as a
pssea> UNIX login would allow. Some shares like [home] are provided for ease
pssea> of use, users are encouraged to create symlinks to other "interesting"
pssea> places e.g. NFS-mounted directories.)

pssea> Cheers, Paul

pssea> Paul Szabo   psz@...hs.usyd.edu.au  
pssea> http://www.maths.usyd.edu.au/u/psz/
pssea> School of Mathematics and Statistics   University of Sydney    Australia

pssea> _______________________________________________
pssea> Full-Disclosure - We believe in it.
pssea> Charter: http://lists.grok.org.uk/full-disclosure-charter.html
pssea> Hosted and sponsored by Secunia - http://secunia.com/



-- 
http://blog.zoller.lu
Thierry Zoller


