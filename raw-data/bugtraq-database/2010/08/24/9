
Date: Mon, 23 Aug 2010 14:16:09 -0500
From: ZDI Disclosures <zdi-disclosures@...pingpoint.com>
To: "Full Disclosure (full-disclosure@...ts.grok.org.uk)" <full-disclosure@...ts.grok.org.uk>,
	"Bugtraq (bugtraq@...urityfocus.com)" <bugtraq@...urityfocus.com>
Subject: TPTI-10-08: Novell iPrint Client Browser PluginGetDriverFile
 Uninitialized Pointer Remote Code Execution Vulnerability

TPTI-10-08: Novell iPrint Client Browser PluginGetDriverFile Uninitialized Pointer Remote Code Execution Vulnerability
http://dvlabs.tippingpoint.com/advisory/TPTI-10-08
August 23, 2010

-- CVSS:
10, (AV:N/AC:L/Au:N/C:C/I:C/A:C)

-- Affected Vendors:
Novell

-- Affected Products:
Novell iPrint

-- TippingPoint(TM) IPS Customer Protection:
TippingPoint IPS customers have been protected against this
vulnerability by Digital Vaccine protection filter ID 10264. 
For further product information on the TippingPoint IPS, visit:

    http://www.tippingpoint.com

-- Vulnerability Details:
This vulnerability allows remote attackers to execute arbitrary code on
vulnerable installations of the Novell iPrint client. User interaction
is required to exploit this vulnerability in that the target must visit
a malicious page.

The specific flaw exists within the ienipp.ocx ActiveX control with
CLSID 36723f97-7aa0-11d4-8919-FF2D71D0D32C. The function exposes a
GetDriverFile method. When this method is invoked for the first time a
pointer in the .data section is mapped to an external function within
another module. When invoked the second time, the process fails to load
the library and assumes the pointer is still valid. When the
uninitialized pointer is called the process jumps to an address space
easily controlled by an attacker. This can be leveraged to execute
remote code under the context of the user running the browser.

-- Vendor Response:
Novell has issued an update to correct this vulnerability. More
details can be found at:

http://download.novell.com/Download?buildid=H-2-uHNc5-A~

-- Disclosure Timeline:
2010-08-12 - Vulnerability reported to vendor
2010-08-23 - Coordinated public release of advisory

-- Credit:
This vulnerability was discovered by:
    * Aaron Portnoy, TippingPoint DVLabs
