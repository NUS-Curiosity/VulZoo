
Date: Wed,  9 Nov 2011 10:39:16 +0100 (CET)
From: advisory@...ridge.ch
To: bugtraq@...urityfocus.com
Subject: Local file inclusion in VtigerCRM

Vulnerability ID: HTB23054
Reference: https://www.htbridge.ch/advisory/local_file_inclusion_in_vtigercrm.html
Product: VtigerCRM
Vendor: vtiger.com ( http://www.vtiger.com ) 
Vulnerable Version: 5.2.1 and probably prior
Tested Version: 5.2.1
Vendor Notification: 19 October 2011 
Vulnerability Type: Local File Inclusion
Status: Fixed by Vendor
Risk level: High 
Credit: High-Tech Bridge SA Security Research Lab ( https://www.htbridge.ch/advisory/ ) 

Vulnerability Details:
High-Tech Bridge SA Security Research Lab has discovered multiple vulnerabilities in VtigerCRM, which can be exploited to perform local file inclusion attacks.

1) Input passed via the "file" GET parameter to index.php is not properly verified before being used to include files. 
This can be exploited to include previously uploaded files via directory traversal sequences and URL-encoded NULL bytes.

http://[host]/index.php?module=Accounts&action=AccountsAjax&ajax=true&file=AddressChange&file=../../storage/2011/October/week3/UploadedFile.txt%00

Successful exploitation of this vulnerability requires that "magic_quotes_gpc" is disabled.

2) Input passed via the "module" & "action" GET parameters to graph.php is not properly verified before being used to include files. 
This can be exploited to include previously uploaded files via directory traversal sequences and URL-encoded NULL bytes.

http://[host]/graph.php?module=../storage/2011/October/week3/UploadedFile.txt%00
http://[host]/graph.php?module=1&action=../../storage/2011/October/week3/UploadedFile.txt%00

Successful exploitation of this vulnerability requires that "magic_quotes_gpc" is disabled.

Solution: Upgrade to the most recent version

Disclaimer: Details of this Advisory may be updated in order to provide as accurate information as possible. The latest version of the Advisory is available on the web page in Reference field.

