
Date: Wed, 12 Jan 2011 10:42:09 +0100
From: "Spala Ferenc" <spala.ferenc@...cellar.hu>
To: <bugtraq@...urityfocus.com>
Subject: SECURITY ADVISORY IBM Cognos 8 Business Intelligence 8.4.1

1.	Affected software
IBM Cognos 8 Business Intelligence 8.4.1

Prior versions may also be affected.

"IBM Cognos 8 Business Intelligence delivers the complete range of BI
capabilities: Reporting, Analysis, Dashboarding and Scorecards on a single,
service-oriented architecture (SOA). Author, share and use reports that draw
on data across all enterprise sources for better business decisions."

Product link:
http://www-01.ibm.com/software/data/cognos/products/cognos-8-business-intell
igence/capabilities.html

2.	Vulnerability Information
Class: Cross site scripting
Impact: Session hijacking
Rating: Less critical
Remotely Exploitable: Yes
Locally Exploitable: No
Bugtraq ID: N/A
CVE Name: N/A

3.	Description of Vulnerability
3.1.1.	Reflective XSS 
In the pathinfo parameter of the cognos.cgi can be malformed and an attacker
is able to inject Javascript code.
With this vulnerability in hand and attacker can inject any Javascript code
he wants. In this way he can perform a session hijacking attack by sending
the malformed URL to the victim.

4.	Solution
The official solution is: 
Since then there have been two fix packs released - Cognos 8 BI 8.4.1 FP1
and Cognos 8 BI 8.4.1 FP2. Testing of the IBM engineers show that the issue
we identified is fixed in both of these fix packs.

5.	Workaround
Workarounds for this kind of vulnerabilities can be implemented through a
Web Application Firewall, for example ModSecurity with the Core Rule Set
(CRS).
When using ModSecurity make sure you have enabled XSS protection rules.
The session encryption features of suhosin PHP extension can make session
hijacking attacks harder as well.

6.	Timeline
01/10/2010 - Vulnerabilities discovered
09/10/2010 - First attempt to contact vendor
12/01/2011 - Public disclosure

7.	Credits
These vulnerabilities were discovered by Ferenc Spala and Tamás Czigány
(Tamas Czigany).

8.	About us
SecurityAngel is the vulnerability research lab of kancellar.hu.
kancellar.hu is Hungary's market leading information security private
limited company. The company offers full scope information security services
to its customers, performs audits, delivers end-to-end security systems,
tools, and solutions. Since its foundation in 2002, its revenues have
increased by more than tenfold. According to the survey conducted by
Deloitte, kancellar.hu was one of the 50 most dynamically developing Central
European companies for two years in a row in 2008 and 2009, and one of the
500 most quickly growing companies in the EMEA region.

9.	Legal notices
Disclaimer: The information in the advisory is believed to be accurate at
the time of publishing based on currently available information. Use of the
information constitutes acceptance for use in an AS IS condition.  There are
no warranties with regard to this information. Neither the author nor the
publisher accepts any liability for any direct, indirect, or consequential
loss or damage arising from use of, or reliance on, this information.

The product names used in this document are for identification purposes
only. All trademarks and registered trademarks are the property of their
respective owners.

Regards,
Spala Ferenc
Information security consultant
Securityangel.com


