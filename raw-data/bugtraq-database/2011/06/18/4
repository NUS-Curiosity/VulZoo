
Date: Fri, 17 Jun 2011 15:45:48 +0200
From: "VUPEN Security Research" <advisories@...en.com>
To: <bugtraq@...urityfocus.com>
Subject: VUPEN Security Research - Microsoft Windows OLE Automation Integer Underflow Vulnerability (MS11-038)


VUPEN Security Research - Microsoft Windows OLE Automation Integer Underflow 
Vulnerability (MS11-038)

Website : http://www.vupen.com/english/research.php

Twitter : http://twitter.com/vupen


I. BACKGROUND
---------------------

"Microsoft Windows is a series of software operating systems and graphical
user interfaces produced by Microsoft. Windows had approximately 90% of
the market share of the client operating systems." (Wikipedia)


II. DESCRIPTION
---------------------

VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Windows.

The vulnerability is caused by an integer underflow error in the Object
Linking and Embedding (OLE) Automation component when processing malformed
Windows Metafile (WMF) data via the "_PictLoadMetaFileRaw()" function,
which could be exploited by remote attackers to compromise a vulnerable
system by tricking a user into visiting a specially crafted web page.

CVSS Score: 10 (AV:N/AC:L/Au:N/C:C/I:C/A:C)

CVE: CVE-2011-0658


III. AFFECTED PRODUCTS
---------------------------

Microsoft Windows 7 (32-bit)
Microsoft Windows 7 (x64)
Microsoft Windows Server 2003 Service Pack 2
Microsoft Windows Server 2003 SP2 (Itanium)
Microsoft Windows Server 2003 x64 Edition Service Pack 2
Microsoft Windows Server 2008 (32-bit)
Microsoft Windows Server 2008 (32-bit) Service Pack 2
Microsoft Windows Server 2008 (Itanium)
Microsoft Windows Server 2008 (Itanium) Service Pack 2
Microsoft Windows Server 2008 (x64)
Microsoft Windows Server 2008 (x64) Service Pack 2
Microsoft Windows Server 2008 R2 (Itanium)
Microsoft Windows Server 2008 R2 (x64)
Microsoft Windows Vista Service Pack 1
Microsoft Windows Vista Service Pack 2
Microsoft Windows Vista x64 Edition Service Pack 1
Microsoft Windows Vista x64 Edition Service Pack 2
Microsoft Windows XP Professional x64 Edition Service Pack 2
Microsoft Windows XP Service Pack 3


IV. Binary Analysis & Exploits/PoCs
---------------------------------------

In-depth binary analysis of the vulnerability and a proof-of-concept code
are available through the VUPEN Binary Analysis & Exploits Service :

http://www.vupen.com/english/services/ba-index.php


VUPEN Binary Analysis & Exploits Service provides private exploits and
in-depth technical analysis of the most significant public vulnerabilities
based on disassembly, reverse engineering, protocol analysis, and code 
audit.

The service allows governments and major corporations to evaluate risks, and
protect infrastructures and assets against new threats. The service also
allows security vendors (IPS, IDS, AntiVirus) to supplement their internal
research efforts and quickly develop both vulnerability-based and
exploit-based signatures to proactively protect their customers from attacks
and emerging threats.


V. VUPEN Threat Protection Program
-----------------------------------

To proactively protect critical networks and infrastructures against 
unpatched
vulnerabilities and reduce risks related to zero-day attacks, VUPEN shares 
its
vulnerability research with governments and organizations members of the 
VUPEN
Threat Protection Program (TPP).

VUPEN TPP customers receive fully detailed and technical reports about 
security
vulnerabilities discovered by VUPEN and in advance of their public 
disclosure.

http://www.vupen.com/english/services/tpp-index.php


VI. SOLUTION
----------------

Apply MS11-038 security updates.


VII. CREDIT
--------------

This vulnerability was discovered by Nicolas Joly of VUPEN Security


VIII. ABOUT VUPEN Security
---------------------------

VUPEN is the world leader in vulnerability research for defensive and
offensive security. VUPEN solutions enable corporations and governments to
measure and manage risks, eliminate vulnerabilities before they can be
exploited, and protect critical infrastructures and assets against
known and unknown vulnerabilities.

VUPEN has been recently recognized as "Entrepreneurial Company of the Year
in the Vulnerability Research Market (2011)" by Frost & Sullivan.

VUPEN solutions include:

* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php

* VUPEN Threat Protection Program (TPP) :
http://www.vupen.com/english/services/tpp-index.php


IX. REFERENCES
----------------------

http://www.microsoft.com/technet/security/Bulletin/MS11-038.mspx
http://www.vupen.com/english/research.php


X. DISCLOSURE TIMELINE
-----------------------------

2010-08-05 - Vulnerability Discovered by VUPEN and shared with TPP customers
2011-06-14 - Public disclosure




