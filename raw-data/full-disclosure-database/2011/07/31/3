
Date: Sun, 31 Jul 2011 17:03:45 +0300
From: "MustLive" <mustlive@...security.com.ua>
To: <full-disclosure@...ts.grok.org.uk>
Subject: Multiple CSRF and XSS vulnerabilities in ADSL
	modem Callisto 821+

Hello list!

I want to warn you about new multiple security vulnerabilities in ADSL modem
Callisto 821+ (SI2000 Callisto821+ Router). Which I disclosed last week.

These are Cross-Site Request Forgery and Cross-Site Scripting
vulnerabilities. In April I've already drew attention of Ukrtelecom's
representative (and this modem was bough at Ukrtelecom) about multiple
vulnerabilities in this model of Callisto modems (and other models also
could be affected).

SecurityVulns ID: 11700.

-------------------------
Affected products:
-------------------------

Vulnerable is the next model: SI2000 Callisto821+ Router: X7821 Annex A
v1.0.0.0 / Argon 4x1 CSP v1.0 (ISOS 9.0) [4.3.4-5.1]. This model with other
firmware and also other models of Callisto also must be vulnerable.

----------
Details:
----------

These attacks should be conducted on modem owner, which is logged into
control panel. Taking into account that it's unlikely to catch him in this
state, then it's possible to use before-mentioned vulnerabilities
(http://websecurity.com.ua/5161/) for conducting of remote login (for
logining him into control panel). After that it's possible to conduct CSRF
or XSS attack.

CSRF (WASC-09):

In section WAN connections the situation is similar to section LAN
connections. Let's view on example of default connection (RfcData).

This vulnerability allows to delete connections.

http://192.168.1.1/configuration/wan_delete_service.html/delete?EmWeb_ns%3Avim%3A3=%2Fconfiguration%2Fwan_finish.html&EmWeb_ns%3Avim%3A7.ImServices.RfcData=ImServices.RfcData&EmWeb_ns%3Avim%3A7.ImBridge.ImBridgeInterfaces.RfcData=ImBridge.ImBridgeInterfaces.RfcData

In section WAN connection: create service
(http://192.168.1.1/configuration/wan_create_service.html) there 9
subsections for creating connections: RFC 1483 routed, RFC 1483 bridged,
PPPoA routed, PPPoA bridged, IPoA routed, PPPoE routed, Ethernet routed,
Ethernet bridged, PPPoE over Ethernet/Bridge routed. And in all of them via
CSRF it's possible to create connections.

In section Edit connection in subsection Edit Service
(http://192.168.1.1/configuration/edit.html?ImServices.RfcData) via CSRF
it's possible to change settings of connection.

In section Edit connection in subsection Edit RFC1483
(http://192.168.1.1/configuration/edit-form.html?ImServices.RfcData.RfcData)
via CSRF it's possible to change settings of connection.

In section Edit connection in subsection Edit Atm Channel
(http://192.168.1.1/configuration/edit-form.html?ImServices.RfcData.RfcData.ImChannels.item0)
via CSRF it's possible to change settings of connection.

In section Edit connection in subsection Edit Classifier
(http://192.168.1.1/configuration/edit-form.html?ImServices.RfcData.RfcData.ImChannels.item0.Classifier)
via CSRF it's possible to change settings of connection.

In section Edit connection in subsection Edit Bun Vector Attr
(http://192.168.1.1/configuration/edit-form.html?ImServices.RfcData.RfcData.ImChannels.item0.Meter.MeterAppliedProfileName)
via CSRF it's possible to change settings of connection.

In section Edit connection in subsection Edit Scheduler
(http://192.168.1.1/configuration/edit-form.html?ImServices.RfcData.RfcData.ImChannels.item0.Scheduler)
via CSRF it's possible to change settings of connection.

In section Edit connection in subsection Edit Bridge Interface
(http://192.168.1.1/configuration/edit.html?ImBridge.ImBridgeInterfaces.RfcData)
via CSRF it's possible to change settings of connection.

In section Create virtual interface
(http://192.168.1.1/configuration/create_virtual.html?ImRouter.ImIpInterfaces.ethernet-0&/configuration/wan.html)
via CSRF it's possible to create virtual interfaces.

In section Delete virtual interface
(http://192.168.1.1/configuration/delete_virtual.html?ImRouter.ImIpInterfaces.item0)
via CSRF it's possible to delete virtual interfaces.

XSS (WASC-08):

http://192.168.1.1/configuration/wan_delete_service.html/delete?EmWeb_ns%3Avim%3A3=%2Fconfiguration%2Fwan_finish.html&EmWeb_ns%3Avim%3A7.1%3Cscript%3Ealert(document.cookie)%3C/script%3E=

http://192.168.1.1/configuration/virtual.html?&%22%3E%3Cscript%3Ealert(document.cookie)%3C/script%3E

http://192.168.1.1/configuration/create_virtual.html?&%22%3E%3Cscript%3Ealert(document.cookie)%3C/script%3E

There are many persistent XSS vulnerabilities in all above-mentioned
sections.

In 9 subsections of section WAN connection: create service (RFC 1483 routed,
RFC 1483 bridged, PPPoA routed, PPPoA bridged, IPoA routed, PPPoE routed,
Ethernet routed, Ethernet bridged, PPPoE over Ethernet/Bridge routed), in
subsections Edit Service, Edit RFC1483, Edit Atm Channel, Edit Classifier,
Edit Bun Vector Attr, Edit Scheduler, Edit Bridge Interface of section Edit
connection, in section WAN connection: delete, in section Create virtual
interface and in section Delete virtual interface there are persistent XSS
vulnerabilities in all text fields and some hidden fields.

And also attacks via the names of parameters are possible (when XSS code is
setting in the name of parameter), which I wrote about earlier
(http://websecurity.com.ua/5277/).

In this case the code will be executed immediately, and also at visiting of
pages http://192.168.1.1/system/events.html and
http://192.168.1.1/shared/event_log_selection.html. And in subsection Edit
Service at setting XSS code in parameter Creator, it'll execute at pages
http://192.168.1.1/configuration/wan.html and
http://192.168.1.1/configuration/wan_delete_service.html?ImServices.RfcData,
and at setting XSS code in parameter Description, it'll execute also at page
http://192.168.1.1/status.html, which is home page of admin panel. And also
special XSS code in both these parameters will execute in subsection Edit
Service itself.

------------
Timeline:
------------

2011.04.14 - informed Ukrtelecom about multiple vulnerabilities in modems,
which they give (sell) to their clients.
2011.05.26 - first time informed developers about holes in their router.
2011.07.23 - disclosed at my site.
2011.07.25 - informed developers (Iskratel).

I mentioned about these vulnerabilities at my site
(http://websecurity.com.ua/5299/).

Best wishes & regards,
MustLive
Administrator of Websecurity web site
http://websecurity.com.ua


_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
