
Date: Fri, 29 Apr 2011 20:13:47 +0300
From: "MustLive" <mustlive@...security.com.ua>
To: <submissions@...ketstormsecurity.org>, <full-disclosure@...ts.grok.org.uk>
Subject: Code Execution vulnerability Ð² WordPress

Hello list!

I want to warn you about Code Execution vulnerability in WordPress.

SecurityVulns ID: 11622.

-------------------------
Affected products:
-------------------------

Vulnerable are versions WordPress 2.5 - 3.1.1. The new version 3.1.2 which
released at 26th of April just after my disclosure also must be vulnerable.
The attack via double extension will work at Apache with appropriate
configuration.

----------
Details:
----------

Code Execution (WASC-31) attack is possible in WordPress via uploader. The
attack can be conducted by users with roles Author, Editor and
Administrator.

In WordPress 2.5 - 2.8.4 it's possible to upload php scripts (1.php) in
Media Library. In 2.5 - 2.7.1 the attack is possible only for Administrator.
For Author and Editor it's not possible to upload 1.php, nor attack will
work via double extensions.

In version 2.8.5 it was prohibited also for Administrator. And even in 2.8 -
2.8.5 for Author and Editor (and for Administrator in 2.8.5) it's impossible
to upload 1.php, but it's possible to upload 1.php.txt.

At that in WP 2.0 - 2.0.11 (where there were no Media Library) for all roles
were prohibited to upload files with php extension (and bypassing method
didn't work). As in versions 2.1.x, 2.2.x and 2.3.x. Only in WordPress 2.2
(http://websecurity.com.ua/1276/) Alexander Concha found vulnerability,
which allowed to upload files with php extension.

In version 2.8.6 and higher it's already prohibited. The attack via double
extensions (1.php.txt and 1.asp;.txt) will not work, but it's possible to
use 1.phtml.txt (for all three roles) to execute code.

------------
Timeline:
------------

2011.04.26 - disclosed at my site. As I already wrote many times to security
mailing lists (http://www.securityfocus.com/archive/1/510274), starting from
2008 I never more inform WP developers about vulnerabilities in WordPress.

I mentioned about these vulnerabilities at my site
(http://websecurity.com.ua/5108/).

Best wishes & regards,
MustLive
Administrator of Websecurity web site
http://websecurity.com.ua 


_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
