
Date: Wed, 28 Sep 2011 07:08:59 +0200
From: "research@...nerability-lab.com" <research@...nerability-lab.com>
To: full-disclosure@...ts.grok.org.uk, 
 submissions@...ketstormsecurity.org
Subject: Barracuda Backup v2.0 - Multiple Web
	Vulnerabilities

Title:
======
Barracuda Backup v2.0 - Multiple Web Vulnerabilities


Date:
=====
2011-09-28


References:
===========
Barracuda Backup Application v2.0


VL-ID:
=====
31


Introduction:
=============
Barracuda Networks - Worldwide leader in email and Web security.
Barracuda Backup Service is a complete and affordable data backup solution. The Barracuda Backup 
Server provides a full local data backup and is combined with a storage subscription to replicate 
data to two offsite locations. This approach provides the best of both worlds - onsite backups for 
fast restore times and secure, offsite storage for disaster recovery. Block level deduplication is 
applied inline to reduce traditional backup storage requirements by 20 to 50 times while also 
reducing backup windows and bandwidth requirements. Cloud Storage with Deduplication

Barracuda Backup Subscription plans provide diverse offsite storage at affordable monthly fees that 
scale to meet increasing data requirements.

    * Secure backup to two geo-separate data centers
    * Deduplicated efficient backup storage
    * Redundant disk-based storage
    * Best-of-breed data retention policies
    * Web interface multi-location management
    * Restore by Web, FTP and Windows software


(Copy of the Vendor Homepage: http://www.barracudanetworks.com/ns/products/backup_overview.php)


Abstract:
=========
Vulnerability-lab Team discovered multiple Input Validation Vulnerabilities on Barracuda Backup Service v2.0.


Report-Timeline:
================
2011-05-03:	Vendor Notification
2011-06-07:	Vendor Response/Feedback
2011-08-28:	Vendor Fix/Patch
2011-09-28:	Public or Non-Public Disclosure


Status:
========
Published


Affected Products:
==================
Barracuda Networks
Product: Backup Application v2.0


Exploitation-Technique:
=======================
Remote


Severity:
=========
Medium


Details:
========
1.1
Multiple persistent Input Validation vulnerabilities are detected on Barracudas Backup v2.x. Local low privileged user account 
& remote attackers (with user inter action)can implement/inject malicious persistent script code (Java/HTML). When exploited by 
an authenticated user, the identified vulnerabilities can lead to information disclosure, access to intranet available servers, 
manipulated persistent content.

Vulnerable Module(s):	
					[+] E-Mail Message Browser - Filter
					[+] Expressions
					[+] Exclsuion Rules


Pictures:
					../ive1.png
					../ive2.png
					../ive3.png
					../ive4.png


1.2
A Header manipulation vulnerability is detected on  Barracudas Backup v2.0 application.
The Vulnerability can be used by attackers to manipulate the running session cookies by including cross-site requests.


Proof of Concept:
=================
The vulnerabilities can be exploited by local low privileged user accounts or remote attackers with high required user inter action. 
For demonstration or reproduce ...

1.1
Manually reproduce ...
1. Login
2. Switch to the vulnerable module of the barracuda backup application
3. Include your own script code on the vulnerable input section. Save! 
4. Enjoy the persistent output results


1.2
GET https://backup.barracuda.com:443/bbs_1133/status HTTP/1.0
Accept: */*
User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR 1.1.4322)
Host: backup.barracuda.com
Cookie: BACKUPSESSID=29fefd04a0caebd28dc09c35dbc5ca22;backup_ci_session=a%3A4%3A%7Bs%3A10%3A%22session_id%22%3Bs%3A32%3A%22d30734090eaf5f
9b34aa34593587c361%22%3Bs%3A10%3A%22ip_address%22%3Bs%3A14%3A%22112.121.165.99%22%3Bs%3A10%3A%22user_agent%22%3Bs%3A50%3A%22Mozilla%2F4.
0+%28compatible%3B+MSIE+6.0%3B+Windows+NT+5.0%3B%22%3Bs%3A13%3A%22last_activity%22%3Bi%3A1260251514%3B%7D28316719bb797611e774a93af543e3fe;
bbs_list_width=1px%3B%7D%2F%2Astealth%2A%2Fbody%20%7B%20background-image%3Aurl%28%27javascript%3Aalert%28%2Fstealth%20found%20you%2F%29%3B
%27%29%7D%2Esource_list%7Bwidth%3A1
Connection: Close
Pragma: no-cache


Risk:
=====
The security risk of the discovered persistent vulnerabilities are estimated as medium(+).
The security risk of the client-side header vulnerability is estimated as low.


Credits:
========
Vulnerability Research Laboratory - Benjamin Kunz Mejri (Rem0ve)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability-
Lab. Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of 
other media, are reserved by Vulnerability-Lab or its suppliers.

    						Copyright Â© 2011|Vulnerability-Lab




-- 
Website: www.vulnerability-lab.com ; vuln-lab.com or vuln-db.com
Contact: admin@...nerability-lab.com or support@...nerability-lab.com


_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
