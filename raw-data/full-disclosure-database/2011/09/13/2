
Date: Tue, 13 Sep 2011 20:30:17 +0300
From: "Irene Abezgauz" <irene@...kersec.com>
To: <full-disclosure@...ts.grok.org.uk>
Subject: Seeker Advisory Sep11: Reflected Cross Site
	Scripting in Microsoft SharePoint Portal

Seeker Research Center Security Advisory 

This vulnerability was discovered by Seeker® Automatic Run-Time Application Security Testing Solution 
Disclosed By Irene Abezgauz, September 13th, 2011

=========
I. Overview
=========
A Cross Site Scripting vulnerability has been identified in Microsoft SharePoint 2007. This vulnerability allows attackers to gain control over valid user accounts, perform operations on their behalf, redirect them to malicious sites, steal their credentials, and more.

A friendly formatted version of this advisory is available at: http://www.seekersec.com/Advisories/SeekerAdvMS04.html  

=======
II. Details
=======
The Contact Details Tool Pane web part is vulnerable to cross site scripting attacks in the parameter 
ctl00$MSOTlPn_EditorZone$Edit0g_7aaa0c6d_72f5_4717_9b22_80188ffdbcde$peopleEditor$hiddenSpanData=
By manipulating an unsuspecting user into submitting a specially crafted form an attacker causes the victim to send the malicious script to the vulnerable SharePoint 2007 instance. The malicious script is then reflected back to the user and executed on his browser. 
The Contact Details Tool Pane is an out-of-the-box component, accessible from various locations in SharePoint 2007 in which the Contact Details web-part is present. The exploit in this advisory has been produced when editing Report Center.

=======
III. Exploit 
=======
Sample exploitation of this vulnerability would be crafting the following request:  
POST /Reports/Pages/Default.aspx HTTP/1.1
…
ctl00$MSOTlPn_EditorZone$Edit0g_7aaa0c6d_72f5_4717_9b22_80188ffdbcde$peopleEditor$hiddenSpanData=<script>alert(“SeekerSec”)</script>

The request also contains other parameters required by the page, the vulnerable parameter being the parameter noted above. 
It seems that when a script is simply placed into the input field there is a client-side encoding of the parameter value, which is insufficient to prevent attacks as directly (not via client) submitted scripts simply do not undergo such validation. 

================
IV. Affected Systems
================
Microsoft SharePoint 2007

========
V. Solution
========
Microsoft has released a fix for this vulnerability, see http://technet.microsoft.com/security/bulletin/MS11-074 for further information. 

=======
VI. Credit
=======
The vulnerability was automatically discovered by Seeker® - New generation application security testing solution, utilizing ground breaking BRITE™ technology (Behavioral Runtime Intelligent Testing Engine).

Further research and publication was performed by Irene Abezgauz, Product Manager, Seeker Security. 
For more information please visit www.seekersec.com


-----------------
Irene Abezgauz
Product Manager
Seeker Security
www.seekersec.com
 E-Mail:    irene@...kersec.com


_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/