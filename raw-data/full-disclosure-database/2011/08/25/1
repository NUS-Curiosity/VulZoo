
Date: Wed, 24 Aug 2011 08:45:59 -0500
From: Douglas Huff <dhuff@...obdobbs.org>
To: Douglas Huff <dhuff@...obdobbs.org>
Cc: full-disclosure@...ts.grok.org.uk
Subject: Re: Apache Killer

That should say more than 4 not 4 or more. And this will almost definitely break webdav.

-- 
Douglas Huff

On Aug 24, 2011, at 8:40 AM, Douglas Huff wrote:

> I think this is a more complete rule that should be slightly more efficient and thorough even though it's 3 separate matches:
> 
> RewriteEngine On
> RewriteCond %{HTTP:Range} bytes=0-[0-9]+, [NC,OR]
> RewriteCond %{HTTP:Range} bytes=([0-9-],){4,} [NC,OR]
> RewriteCond %{HTTP:Range} bytes=[0-9,-]+,0-(,|$) [NC]
> RewriteRule .? http://%{SERVER_NAME}/ [NS,L,F]
> 
> I cannot remember if the second RewriteCond's syntax is supported by mod_rewrite and don't have a machine handy right this moment to test effectiveness anyhow.
> 
> This should stop any requests with a range starting with 0- specified as a range (first and third rule) or 4 or more ranges included (second rule).
> 
> -- 
> Douglas Huff

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
