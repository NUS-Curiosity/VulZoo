
Date: Fri, 16 Dec 2011 13:02:37 +0100
From: vladz <vladz@...zero.fr>
To: full-disclosure@...ts.grok.org.uk
Subject: X server wrapper permission bypass (CVE-2011-4613)

Hi all,

On Debian systems, the X wrapper (/usr/bin/X) is a setuid-root binary
that checks for some security requirements before launching Xorg with
root privileges.  In its default configuration, it only allows users
whose controlling TTY (console) to start the X server (see
Xwrapper.config(5) for more informations).

I recently found a way to bypass this permission[1] and so, it allows
any user to start the X server.  

This is of course a minor security issue[2], but what is more critical
is that the attack against CVE-2011-4029[3] (which allows any user to
set the read permission on any arbitrary file thanks to a race condition
in Xorg), can now be launched from a remote session and not even from a
real TTY!

I have updated the PoC[4] in consequence. And hope to get this "old"
problem (CVE-2011-4029) fixed in Squeeze.

  [1] http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=652249
  [2] http://security-tracker.debian.org/tracker/CVE-2011-4613
  [3] http://security-tracker.debian.org/tracker/CVE-2011-4029
  [4] http://vladz.devzero.fr/exploits/Xorg-CVE-2011-4029_inotify.c.txt

Regards,
--
http://vladz.devzero.fr
PGP key 8F7E2D3C from pgp.mit.edu

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
