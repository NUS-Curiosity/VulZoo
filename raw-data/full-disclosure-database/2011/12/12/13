
Date: Mon, 12 Dec 2011 11:58:50 -0500 (EST)
From: Ramon de C Valle <rcvalle@...hat.com>
To: Daniel J Walsh <dwalsh@...hat.com>
Cc: "HI-TECH ." <isowarez.isowarez.isowarez@...glemail.com>,
	full-disclosure@...ts.grok.org.uk
Subject: Re: Fwd: VSFTPD Remote Heap Overrun (low severity)



> Ramon, not sure I understand, what are you trying to prevent here?
Hello Dan, vsftpd processes open locale files from the "/usr/share/zoneinfo" directory, which are expected to have the "locale_t" type. A chrooted user can create a specially-crafted locale file in "/home/<user>/usr/share/zoneinfo" directory to try exploiting this glibc vulnerability. However, the specially-crafted locale file created will have the "user_home_t" type and not the "locale_t". SELinux rules for vsftpd (i.e. ftpd_t) allowing only opening locale files from "usr_t" directories with "locale_t" type should have completely mitigated this.

-- 
Ramon de C Valle / Red Hat Security Response Team

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
