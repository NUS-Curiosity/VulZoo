
Date: Mon, 12 Dec 2011 12:13:30 -0500
From: Daniel J Walsh <dwalsh@...hat.com>
To: Ramon de C Valle <rcvalle@...hat.com>
Cc: "HI-TECH ." <isowarez.isowarez.isowarez@...glemail.com>,
	full-disclosure@...ts.grok.org.uk
Subject: Re: Fwd: VSFTPD Remote Heap Overrun (low severity)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 12/12/2011 11:58 AM, Ramon de C Valle wrote:
> 
> 
>> Ramon, not sure I understand, what are you trying to prevent
>> here?
> Hello Dan, vsftpd processes open locale files from the
> "/usr/share/zoneinfo" directory, which are expected to have the
> "locale_t" type. A chrooted user can create a specially-crafted
> locale file in "/home/<user>/usr/share/zoneinfo" directory to try
> exploiting this glibc vulnerability. However, the specially-crafted
> locale file created will have the "user_home_t" type and not the
> "locale_t". SELinux rules for vsftpd (i.e. ftpd_t) allowing only
> opening locale files from "usr_t" directories with "locale_t" type
> should have completely mitigated this.
> 
But how can I state that ftp has access to the users homedir and not
allow access to user_home_t?
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAk7mNjoACgkQrlYvE4MpobNg6gCgr/KHGKC09Li1BwoFthepsEor
KYEAn3/HJ8frW/21GiZfw/tL9waf7Irx
=f5NM
-----END PGP SIGNATURE-----

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
