
Date: Tue, 8 Mar 2011 12:36:01 +1100
From: dave b <db.pub.mail@...il.com>
To: full-disclosure <full-disclosure@...ts.grok.org.uk>
Subject: Mutt: failure to check server certificate in SMTP
	TLS connection

Hi all. It seems that mutt fails to check the validity of a SMTP
servers certificate during a TLS connection. In my mutt configuration
I have

set ssl_starttls = yes
set ssl_force_tls = yes

However, after performing the steps below I found that mutt did not
properly validate the remote servers SMTP tls certificate. This means
that an attacker could potentially MITM a mutt user connecting to
their SMTP server even when the user has forced a TLS connection.

Steps to test this:
1. I set in my hosts file the ip for smtp.gmail.com to be bound to
mail.lolok.com

in /etc/hosts
74.125.127.109 mail.LOLOK.com

2.Then I changed my

set smtp_url = "smtp://MYUSERNAME@...p.gmail.com:587/"
to be
set smtp_url = "smtp://MYUSERNAME@...l.lolok.com:587/"

3. I opened up mutt and emailed my self. I note that I saw mutt say
"connecting to mail.lolok.com".

I feel that this is an issue because mutt _does_ actually perform IMAP
server certificate validation (at least it did when I last tested it
:P).

--
Patch griefs with proverbs.		-- William Shakespeare, "Much Ado About Nothing"

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
