
Date: Mon, 13 Jun 2011 16:22:52 +0300
From: "MustLive" <mustlive@...security.com.ua>
To: <submissions@...ketstormsecurity.org>, <full-disclosure@...ts.grok.org.uk>
Subject: New CSRF and XSS vulnerabilities in ADSL modem
	Callisto 821+

Hello list!

I want to warn you about new security vulnerabilities in ADSL modem Callisto
821+ (SI2000 Callisto821+ Router).

These are Cross-Site Request Forgery and Cross-Site Scripting
vulnerabilities. In April I've already drew attention of Ukrtelecom's
representative (and this modem was bough at Ukrtelecom) about multiple
vulnerabilities in this model of Callisto modems (and other models also
could be affected).

SecurityVulns ID: 11700.

-------------------------
Affected products:
-------------------------

Vulnerable is the next model: SI2000 Callisto821+ Router: X7821 Annex A
v1.0.0.0 / Argon 4x1 CSP v1.0 (ISOS 9.0) [4.3.4-5.1]. This model with other
firmware and also other models of Callisto also must be vulnerable.

----------
Details:
----------

These attacks should be conducted on modem owner, which is logged into control panel. Taking into account that it's unlikely to catch him in this state, then it's possible to use before-mentioned vulnerabilities (http://websecurity.com.ua/5161/) for conducting of remote login (for logining him into control panel). After that it's possible to conduct CSRF or XSS attack.

CSRF (WASC-09):

In section Bridge Interfaces (http://192.168.1.1/configuration/qbridgeinterface.html) via CSRF it's possible to edit and delete interfaces.

In section Priority Map for the bridge interface (http://192.168.1.1/configuration/qbridgeinterfacepri.html?ImBridge.ImBridgeInterfaces.ethernet) there are 3 CSRF vulnerabilities.

As I found some time ago, all functionality in control panel works as with POST, as with GET requests. So all earlier-mentioned and new Ð¡SRF and XSS attacks can be conducted besides POST also via GET.

http://192.168.1.1/configuration/qbridgeinterfacepri.html/edit1?EmWeb_ns%3Avim%3A3=/configuration/qbridgeinterfacepri.html&EmWeb_ns%3Avim%3A6=ImBridge.ImBridgeInterfaces.ethernet&EmWeb_ns%3Avim%3A2.ImBridge.ImBridgeInterfaces.ethernet%3AnumTrafficClasses=8

XSS (WASC-08):

In section Bridge Interfaces (http://192.168.1.1/configuration/qbridgeinterface.html) there are persistent XSS vulnerabilities in all text fields and some hidden fields.

In section Priority Map for the bridge interface (http://192.168.1.1/configuration/qbridgeinterfacepri.html?ImBridge.ImBridgeInterfaces.ethernet) there are persistent XSS vulnerabilities in all text fields and some hidden fields.

Vulnerable is the next model: SI2000 Callisto821+ Router: X7821 Annex A v1.0.0.0 / Argon 4x1 CSP v1.0 (ISOS 9.0) [4.3.4-5.1]. This model with other firmware and also other models of Callisto also must be vulnerable.

I mentioned about these vulnerabilities at my site (http://websecurity.com.ua/5207/).

Best wishes & regards,
MustLive
Administrator of Websecurity web site
http://websecurity.com.ua
Content of type "text/html" skipped

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
