
Date: Thu, 2 Jun 2011 21:16:42 +0300
From: "MustLive" <mustlive@...security.com.ua>
To: <submissions@...ketstormsecurity.org>, <full-disclosure@...ts.grok.org.uk>
Subject: New CSRF and XSS vulnerabilities in ADSL modem
	Callisto 821+

Hello list!

I want to warn you about security vulnerabilities in ADSL modem Callisto
821+ (SI2000 Callisto821+ Router).

These are Cross-Site Request Forgery and Cross-Site Scripting
vulnerabilities. Which I've found in your modem. In April I've already drew
attention of Ukrtelecom's representative (and this modem was bough at
Ukrtelecom) about multiple vulnerabilities in this model of Callisto modems
(and other models also could be affected).

SecurityVulns ID: 11700.

-------------------------
Affected products:
-------------------------

Vulnerable is the next model: SI2000 Callisto821+ Router: X7821 Annex A
v1.0.0.0 / Argon 4x1 CSP v1.0 (ISOS 9.0) [4.3.4-5.1]. This model with other
firmware and also other models of Callisto also must be vulnerable.

----------
Details:
----------

These attacks should be conducted on modem owner, which is logged into
control panel. Taking into account that it's unlikely to catch him in this
state, then it's possible to use before-mentioned vulnerabilities
(http://websecurity.com.ua/5161/) for conducting of remote login (for
logining him into control panel). After that it's possible to conduct CSRF
or XSS attack.

CSRF (WASC-09):

This vulnerability allows to set settings of Default LAN Port. E.g. it's
possible to change current IP of modem or to set secondary IP.

http://websecurity.com.ua/uploads/2011/Callisto%20821+%20CSRF7.html

XSS (WASC-08):

In this form there are also 16 (and per se unlimited number) persistent XSS
vulnerabilities.

http://websecurity.com.ua/uploads/2011/Callisto%20821+%20XSS7.html

In this case the code will be executed immediately, and also at visiting of
pages http://192.168.1.1/system/events.html and
http://192.168.1.1/shared/event_log_selection.html.

Vulnerabilities are in official parameters
EmWeb_ns:vim:12.ImLanReconfig:ipaddress:0 (or 1, 2, 3), and also in
non-existent parameters EmWeb_ns:vim:12.ImLanReconfig:ipaddress:4 (or any
other character) or even without setting of ipaddress -
EmWeb_ns:vim:12.ImLanReconfig.

http://websecurity.com.ua/uploads/2011/Callisto%20821+%20XSS8.html

In this case the code will be executed immediately, and also at visiting of
pages http://192.168.1.1/system/events.html and
http://192.168.1.1/shared/event_log_selection.html.

Vulnerabilities are in official parameters
EmWeb_ns:vim:12.ImLanReconfig:netmask:0 (or 1, 2, 3), and also in
non-existent parameters EmWeb_ns:vim:12.ImLanReconfig:netmask:4 (or any
other character).

http://websecurity.com.ua/uploads/2011/Callisto%20821+%20XSS9.html

In this case the code will be executed immediately, and also at visiting of
pages http://192.168.1.1/system/events.html and
http://192.168.1.1/shared/event_log_selection.html.

Vulnerabilities are in official parameters
EmWeb_ns:vim:12.ImLanReconfig:mgmt_ipaddress:0 (or 1, 2, 3), and also in
non-existent parameters EmWeb_ns:vim:12.ImLanReconfig:mgmt_ipaddress:4 (or
any other character).

About such "unlimited" vulnerabilities I wrote in article How to find
billion of XSS vulnerabilities
(http://lists.webappsec.org/pipermail/websecurity_lists.webappsec.org/2010-November/007233.html).

------------
Timeline:
------------

2011.04.14 - informed Ukrtelecom about multiple vulnerabilities in modems,
which they give (sell) to their clients.
2011.05.30 - disclosed at my site.
2011.05.31 - informed developers (Iskratel).

I mentioned about these vulnerabilities at my site
(http://websecurity.com.ua/5179/).

Best wishes & regards,
MustLive
Administrator of Websecurity web site
http://websecurity.com.ua 


_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
