
Date: Fri, 24 Jun 2011 16:56:37 +0000
From: "Thor (Hammer of God)" <thor@...merofgod.com>
To: Christian Sciberras <uuf6429@...il.com>, Nahuel Grisolia
	<nahuel@...sai-sec.com>
Cc: "full-disclosure@...ts.grok.org.uk" <full-disclosure@...ts.grok.org.uk>,
	"owasp-argentina@...ts.owasp.org" <owasp-argentina@...ts.owasp.org>
Subject: Re: ASHX, ASMX or What?

It all depends on how the files are being validated, but I would guess for IIS6,7 the use of a RegularExpressionValidator would be run against the upload control with whatever ValidationExpression would be in place given how easy it is to implement.  That would ensure the filetype extension was .jpg directly in the upload control.  There wouldn't be any "bypass" via the control - you'd have to go around the control somehow.

t



From: full-disclosure-bounces@...ts.grok.org.uk [mailto:full-disclosure-bounces@...ts.grok.org.uk] On Behalf Of Christian Sciberras
Sent: Friday, June 24, 2011 9:38 AM
To: Nahuel Grisolia
Cc: full-disclosure@...ts.grok.org.uk; owasp-argentina@...ts.owasp.org
Subject: Re: [Full-disclosure] ASHX, ASMX or What?

You shouldn't filter against known files, but do the reverse, you should filter against known good files.

Oh and the medium you decide to throw this data should have special checks against execution etc...


On Fri, Jun 24, 2011 at 6:16 PM, Nahuel Grisolia <nahuel@...sai-sec.com<mailto:nahuel@...sai-sec.com>> wrote:
List,

Imagine that you're in front of an """"insecure"""" file upload in the
context of an IIS6,7 (no ;.jpg :P) and the regex filtering the file is like:

[anything].asp[anything] (yeah, my.aspirator.jpg is filtered hehe)

No .aspx, no .asp and no .aspx;jpg even if the server is vulnerable...

So... is there any way to bypass this control? Like uploading a
malicious Webservice (can we simply upload a Webservice file? I think
they need to be precomplied first) or something like that?

Thanks a lot!

regards,
--
Nahuel Grisolia - C|EH
Information Security Consultant
Bonsai Information Security Project Leader
http://www.bonsai-sec.com/
(+54-11) 4777-3107<tel:%28%2B54-11%29%204777-3107>

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/


Content of type "text/html" skipped

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
