
Date: Wed, 4 Mar 2009 17:27:05 -0500
From: Jeremy Brown <0xjbrown41@...il.com>
To: full-disclosure@...ts.grok.org.uk
Subject: Re: iDefense COMRaider 'DeleteFile()' Method
	Arbitrary File Deletion Vulnerability

That is actually decently accurate. Only thing is that these controls
should always (unless in a specific environment) have checks that
won't allow malicious events to occur. Even if controls aren't marked
as safe for automatic loading and execution, massive social
engineering can make them work still.

Such example would work like so...

A remote code execution exploit is found in non-safe popular
anti-virus component. Attacker sets up a website called
www.freexxxxxantivirusscan.com, convinces user to allow
loading/execution of component. Game over.

On Wed, Mar 4, 2009 at 4:42 PM, iDefense Labs
<labs-no-reply@...fense.com> wrote:
> Amir, et al,
>
> We would not classify this issue as a security vulnerability.  The COM
> object in question is *NOT* loadable in Internet Explorer in a default
> configuration.
>
> CLSID: {9A077D0D-B4A6-4EC0-B6CF-98526DF589E4}
>  ProgId: vbDevKit.CVariantFileSystem
>  Path to binary: C:\WINDOWS\vbDevKit.dll
>  Doesn't implement IObjectSafety
>  Registry settings:
>    Registry: is not safe for initialization
>    Registry: is not safe for scripting
>    Killbit is NOT set
>
> In order to load this control, the particular security setting that
> would need to be modified is "Initialize and script ActiveX controls not
> marked as safe for scripting".  Changing this particular setting to
> "Enable", or even "Prompt", significantly impacts the browser's overall
> security posture.
>
> In short, if your machine allows this control to be loaded, then your
> browser will load controls regardless of safety designations such as
> "Safe for Scripting", "Safe for Initialization", and "IObjectSaftey".
> This includes the ability to load controls such as WScript, which can
> execute arbitrary commands out of the box.
>
> iDefense Labs
>
>
> _______________________________________________
> Full-Disclosure - We believe in it.
> Charter: http://lists.grok.org.uk/full-disclosure-charter.html
> Hosted and sponsored by Secunia - http://secunia.com/
>

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
