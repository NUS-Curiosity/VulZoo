
Date: Sat, 23 Jan 2016 10:13:13 +0100
From: "Securify B.V." <lists@...urify.nl>
To: fulldisclosure@...lists.org
Subject: [FD] HP LaserJet Fax Preview DLL side loading vulnerability

------------------------------------------------------------------------
HP LaserJet Fax Preview DLL side loading vulnerability
------------------------------------------------------------------------
Yorick Koster, September 2015

------------------------------------------------------------------------
Abstract
------------------------------------------------------------------------
A DLL side loading vulnerability was found in the HP LaserJet Fax
Preview Resource DLL. This issue can be exploited by loading the
FaxPreview Class as an embedded OLE object. When instantiating the
object Windows will try to load the DLL MFC80ENU.DLL from the current
working directory. If an attacker convinces the user to open a specially
crafted (Office) document from a directory also containing the
attacker's DLL file, it is possible to execute arbitrary code with the
privileges of the target user. This can potentially result in the
attacker taking complete control of the affected system.

------------------------------------------------------------------------
Affected versions
------------------------------------------------------------------------
This issue was successfully verified on the HP Color LaserJet CM2320 MFP
drivers version 3.1 (CM2320series-win7-full-solution-AM-EMEA1-v3.1.exe).

------------------------------------------------------------------------
Fix
------------------------------------------------------------------------
There is currently no fix available, HP reports: "Unfortunately, the
driver software for these devices can no longer be updated. The devices
have ended support life and the engineering resources are no longer
available to provide any firmware updates.  We do understand the issue,
and current drivers are no longer vulnerable to the OLE side load
issue".

------------------------------------------------------------------------
Details
------------------------------------------------------------------------
https://www.securify.nl/advisory/SFY20150903/hp_laserjet_fax_preview_dll_side_loading_vulnerability.html
https://www.securify.nl/exploit/SFY20150901/hp_laserjet_ole_sideload.html
https://www.securify.nl/blog/SFY20151201/there_s_a_party_in_ole__and_you_are_invited.html

_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/
