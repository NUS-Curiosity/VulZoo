
Date: Fri, 18 Nov 2016 12:55:53 +0300
From: ERPScan inc <erpscan.online@...il.com>
To: submissions@...ketstormsecurity.com, fulldisclosure@...lists.org, 
 pen-test@...urityfocus.com, bugs@...uritytracker.com, 
 bugtraq@...urityfocus.com
Subject: [FD] [ERPSCAN-16-031] SAP NetWeaver AS ABAP – directory traversal using READ DATASET

Application: SAP NetWeaver AS ABAP

Versions Affected: SAP NetWeaver AS ABAP 7.4

Vendor URL: http://SAP.com

Bugs: Directory traversal

Sent: 22.04.2016

Reported: 23.04.2016

Vendor response: 23.04.2016

Date of Public Advisory: 09.08.2016

Reference: SAP Security Note  2312966

Author:  Daria Prosochkina (ERPScan)



Description



1. ADVISORY INFORMATION

Title: [ERPSCAN-16-031] SAP NetWeaver AS ABAP – directory traversal
using READ DATASET

Advisory ID: [ERPSCAN-16-031]

Risk: high

Advisory URL: https://erpscan.com/advisories/erpscan-16-031-sap-netweaver-abap-directory-traversal-via-using-read-dataset/

Date published: 11.11.2016

Vendors contacted: SAP


2. VULNERABILITY INFORMATION

Class: Directory traversal

Impact: read file from system

Remotely Exploitable: yes

Locally Exploitable: yes


CVSS Information

CVSS Base Score v3:   4.3 / 10

CVSS Base Vector:

AV : Attack Vector (Related exploit range) Network (N)

AC : Attack Complexity (Required attack complexity) Low (L)

PR : Privileges Required (Level of privileges needed to exploit) Low (L)

UI : User Interaction (Required user participation) None (N)

S : Scope (Change in scope due to impact caused to components beyond
the vulnerable component) Unchanged (U)

C : Impact to Confidentiality Low (L)

I : Impact to Integrity None (N)

A : Impact to Availability None (N)



3. VULNERABILITY DESCRIPTION

The code provides access to the file specified after the READ DATASET
statement. The variable transmitted to the input of the statement is
entered in it by user input. Thus, the user can access the files
stored on the operating system. This vulnerability is called a
Directory Traversal.

The attack is possible if the application does not check the user data
and does not delete special characters used for a directory traversal
attack from the variable, in which the filename is passed. As a
result, an attacker can read data from all files, to which the
application has access.

To discover this vulnerability, data flow analysis and other unique
techniques are used.


4. VULNERABLE PACKAGES

SAP_ABA 700

SAP_ABA 701

SAP_ABA 702

SAP_ABA 710

SAP_ABA 711

SAP_ABA 730

SAP_ABA 731

SAP_ABA 740

SAP_ABA 750

SAP_ABA 751

SAP_ABA 75A

SAP_ABA 75B


5. SOLUTIONS AND WORKAROUNDS

To correct this vulnerability, install SAP Security Note  2312966



6. AUTHOR

Daria Prosochkina (ERPScan)


7. TECHNICAL DESCRIPTION

Attacker can read any file from OS with use BUPA_BIP_FILE_IMPORT program.

Filename used in statement READ DATASET (line 428) is entered in this
statement by user input. User can pass to input arbitrary filepath,
for example /etc/passwd. As a result of execution of the
BUPA_BIP_FILE_IMPORT program, data from /etc/passwd will be written in
P_FLEN variable in hex format.


Vulnerable code


426.      p_flen = 0.

427.      DO.

428.        READ DATASET p_ifilea INTO lw.

429.*       Exit conditions for accessing in a loop

430.        IF sy-subrc NE 0. EXIT. ENDIF.

431.        APPEND lw TO p_itab .

432.

433.        p_flen = p_flen + XSTRLEN( lw-d ) .

434.      ENDDO.



8. REPORT TIMELINE

Sent: 22.04.2016

Reported: 23.04.2016

Vendor response: 23.04.2016

Date of Public Advisory: 09.08.2016



9. REFERENCES

https://erpscan.com/advisories/erpscan-16-031-sap-netweaver-abap-directory-traversal-via-using-read-dataset/


10. ABOUT ERPScan Research

ERPScan research team specializes in vulnerability research and
analysis of critical enterprise applications. It was acknowledged
multiple times by the largest software vendors like SAP, Oracle,
Microsoft, IBM, VMware, HP for discovering more than 400
vulnerabilities in their solutions (200 of them just in SAP!).

ERPScan researchers are proud of discovering new types of
vulnerabilities (TOP 10 Web Hacking Techniques 2012) and of the "The
Best Server-Side Bug" nomination at BlackHat 2013.

ERPScan experts participated as speakers, presenters, and trainers at
60+ prime international security conferences in 25+ countries across
the continents ( e.g. BlackHat, RSA, HITB) and conducted private
trainings for several Fortune 2000 companies.

ERPScan researchers carry out the EAS-SEC project that is focused on
enterprise application security awareness by issuing annual SAP
security researches.

ERPScan experts were interviewed in specialized info-sec resources and
featured in major media worldwide. Among them, there are Reuters,
Yahoo, SC Magazine, The Register, CIO, PC World, DarkReading, Heise,
Chinabyte, etc.

Our team consists of highly-qualified researchers, specialized in
various fields of cybersecurity (from web application to ICS/SCADA
systems), gathering their experience to conduct the best SAP security
research.



11. ABOUT ERPScan

ERPScan is the most respected and credible Business Application
Cybersecurity provider. Founded in 2010, the company operates globally
and enables large Oil and Gas, Financial, Retail and other
organizations to secure their mission-critical processes. Named as an
‘Emerging Vendor’ in Security by CRN, listed among “TOP 100 SAP
Solution providers” and distinguished by 30+ other awards, ERPScan is
the leading SAP SE partner in discovering and resolving security
vulnerabilities. ERPScan consultants work with SAP SE in Walldorf to
assist in improving the security of their latest solutions.

ERPScan’s primary mission is to close the gap between technical and
business security and provide solutions for CISO's to evaluate and
secure SAP and Oracle ERP systems and business-critical applications
from both cyberattacks and internal fraud. As a rule, our clients are
large enterprises, Fortune 2000 companies and MSPs, whose requirements
are to actively monitor and manage security of vast SAP and Oracle
landscapes on a global scale.

We ‘follow the sun’ and have two hubs, located in Palo Alto and
Amsterdam, to provide threat intelligence services, continuous support
and to operate local offices and partner network spanning 20+
countries around the globe.


Adress USA: 228 Hamilton Avenue, Fl. 3, Palo Alto, CA. 94301

Phone: 650.798.5255

Twitter: @erpscan

_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/