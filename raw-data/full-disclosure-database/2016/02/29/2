
Date: Mon, 29 Feb 2016 17:00:13 +0100
From: Vulnerability Lab <research@...nerability-lab.com>
To: fulldisclosure@...lists.org
Subject: [FD] Fing v3.3.0 iOS - Persistent Mail Encoding Vulnerability

Document Title:
===============
Fing v3.3.0 iOS - Persistent Mail Encoding Vulnerability


References (Source):
====================
http://www.vulnerability-lab.com/get_content.php?id=1772


Release Date:
=============
2016-02-29


Vulnerability Laboratory ID (VL-ID):
====================================
1772


Common Vulnerability Scoring System:
====================================
3.5


Product & Service Introduction:
===============================
Find out which devices are connected to your Wi-Fi network, in just a few seconds. Fast and accurate, Fing is a professional App for network analysis. 
A simple and intuitive interface helps you evaluate security levels, detect intruders and resolve network issues. Discovers all devices connected to 
a Wi-Fi network. Unlimited devices and unlimited networks, for free!

(Copy of the Homepage: https://itunes.apple.com/us/app/fing-network-scanner/id430921107 )


Abstract Advisory Information:
==============================
The Vulnerability Laboratory Core Research Team discovered an application-side mail encoding web vulnerability in the official Fing mobile iOS application.


Vulnerability Disclosure Timeline:
==================================
2016-02-29:	Public Disclosure (Vulnerability Laboratory)


Discovery Status:
=================
Published


Affected Product(s):
====================
Overlook Soft
Product: Fing - iOS (Web-Application) 3.3.0


Exploitation Technique:
=======================
Local


Severity Level:
===============
Medium


Technical Details & Description:
================================
An application-side input validation web vulnerability has been discovered  in the official Fing mobile iOS web-application.
The security web vulnerability allows to inject malicious script codes to the application-side of the vulnerable iOS mobile app.

The vulnerability is located in the encode mechanism of the `Address` input field. Local attackers with restricted or privileged 
web-application user accounts are able to inject the address input to the mail body message context on sharing. The attacker injects 
a new Hostname Address to scan and shares the input context mail mail to the addressbook. The injection point is the Address input 
field and the execution point is the mail message body context.

The security risk of the application-side vulnerability is estimated as medium with a cvss (common vulnerability scoring system) count of 3.5. 
Exploitation of the persistent web vulnerability requires a low privileged ios device account with restricted access and low user interaction. 
Successful exploitation of the vulnerabilities results in persistent phishing mails, session hijacking, persistent external redirect to malicious 
sources and application-side manipulation of affected or connected module context.

Vulnerable Module(s)
				[+] Edit Scan (Add Hostname)
 
Vulnerable Input(s):
				[+] Address

Vulnerable Parameter(s)
				[+] hostname

Affected Module(s)
				[+] Mail Message Body (Share Function)


Proof of Concept (PoC):
=======================
The application-side validation web vulnerability can be exploited by remote attackers with low privileged iOS device user account and without user interaction.
For security demonstration or to reproduce the vulnerability follow the provided information and steps below to continue.


Manual steps to reproduce the vulnerability ...
1. Install the Fing Scanner iOS app
2. Start the app
3. Click the second button in the bottom menu to edit a scan
4. Inject a script code payload to the "Address / Hostname" input field
5. Now click above the share button and choose send by email
Note: The payload of the scan is not getting saved to the mail body message context
6. The execution occurs directly in the mail body of the email context
7. Successful reproduce of the vulnerability!


PoC: Find (Send by Mail to Share)
<table border=0 cellspacing=0 cellpadding=0 width="100%" class="header-part1"><tr><td><b>Betreff: </b>Fing discovery report for &quot;&gt;&lt;img&gt;%20&lt;iframe&gt;%20&lt;iframe src=&quot;x&quot;&gt; (No address)</td></tr><tr><td><b>Von: </b>Benjamin Mejri Kunz &lt;vulnerabilitylab@...oud.com&gt;</td></tr><tr><td><b>Datum: </b>28.02.2016 18:38</td></tr></table><table border=0 cellspacing=0 cellpadding=0 width="100%" class="header-part2"><tr><td><b>An: </b>bkm@...lution-sec.com</td></tr></table><br>
<html><head><meta http-equiv="content-type" content="text/html; "></head><body dir="auto"><div>Host Name: "&gt;<img src="cid:">%20<iframe>%20&amp;lt;iframe src="x"&amp;gt;&amp;lt;br/&amp;gt;State: Device is Up&amp;lt;br/&amp;gt;Type: domain&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;(Sent from &amp;lt;a href='<a href="http://www.fingbox.com'&amp;gt;fing&amp;lt;/a&amp;gt">http://www.fingbox.com'&amp;gt;Fing&amp;lt;/a&amp;gt</a>;)&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;</iframe></div><div><br><br><img src="mailbox-message://bkm%40evolution-sec%2Ecom@...ed1337.evolution-sec.com/Inbox#577964252?header=saveas&part=1.2.2&filename=Image-1.jpg" id="30EDA119-EACA-4BCD-B193-3C0ADA60EE58" style="padding:0px 1px 1px 0px;"></div><div><br><br>Von meinem iPad gesendet</div></body></html>
</body>
</html>


Solution - Fix & Patch:
=======================
The vulnerability can be patched by a secure parse and encode of the vulnerable `Address/Hostname` input field. 
Restrict the input field and disallow usage of special chars.
Encode the mail message body context that is getting transfered of the address input to the email body context.


Security Risk:
==============
The security risk of the persistent mail encoding web vulnerability in the fing scanner iOS app is estimated as medium. (CVSS 3.5)


Credits & Authors:
==================
Vulnerability Laboratory [Research Team] - Benjamin Kunz Mejri (bkm@...lution-sec.com) [www.vulnerability-lab.com]


Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either expressed or implied, 
including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers are not liable in any case of damage, 
including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability-Lab or its suppliers have been advised 
of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing 
limitation may not apply. We do not approve or encourage anybody to break any licenses, policies, deface websites, hack into databases or trade with stolen data.

Domains:    www.vulnerability-lab.com 		- www.vuln-lab.com 						- www.evolution-sec.com
Contact:    admin@...nerability-lab.com 	- research@...nerability-lab.com 				- admin@...lution-sec.com
Section:    magazine.vulnerability-db.com 	- vulnerability-lab.com/contact.php 				- evolution-sec.com/contact
Social:	    twitter.com/#!/vuln_lab		- facebook.com/VulnerabilityLab 				- youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php 	- vulnerability-lab.com/rss/rss_upcoming.php 			- vulnerability-lab.com/rss/rss_news.php
Programs:   vulnerability-lab.com/submit.php 	- vulnerability-lab.com/list-of-bug-bounty-programs.php 	- vulnerability-lab.com/register.php

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. Permission to electronically 
redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by Vulnerability-Lab Research Team or 
its suppliers. All pictures, texts, advisories, source code, videos and other information on this website is trademark of vulnerability-lab team & the specific 
authors or managers. To record, list, modify, use or edit our material contact (admin@ or research@...nerability-lab.com) to get a ask permission.

				    Copyright © 2016 | Vulnerability Laboratory - [Evolution Security GmbH]™



-- 
VULNERABILITY LABORATORY - RESEARCH TEAM
SERVICE: www.vulnerability-lab.com
CONTACT: research@...nerability-lab.com



_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/