
Date: Tue, 29 Nov 2016 14:23:14 +0100
From: Kacper Szurek <kacperszurek@...il.com>
To: fulldisclosure@...lists.org
Subject: [FD] WinPower V4.9.0.4 Privilege Escalation

# Exploit Title: WinPower V4.9.0.4 Privilege Escalation
# Date: 29-11-2016
# Software Link: http://www.ups-software-download.com/
# Exploit Author: Kacper Szurek
# Contact: http://twitter.com/KacperSzurek
# Website: http://security.szurek.pl/
# Category: local

1. Description

UPSmonitor runs as SYSTEM process.

We can communicate with monitor using RMI interface.

In manager app there’s an “Administrator” password check, but the password
isn’t verified inside monitor process.

So we can modify any application settings without knowing administrator
password.

What is more interesting we can set command which will be executed when
monitor get “remote shutdown command”.

Because monitor runs as SYSTEM process, this command is also executed with
SYSTEM privileges.

So using this we can create new administrator account.

http://security.szurek.pl/winpower-v4904-privilege-escalation.html

2. Proof of Concept

https://github.com/kacperszurek/exploits/blob/master/WinPower/WinPowerPrivEscExploit.java
https://github.com/kacperszurek/exploits/raw/master/WinPower/WinPowerPrivEscExploit.class

_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/