
Date: Fri, 2 Sep 2016 15:30:45 +0200
From: Vulnerability Lab <research@...nerability-lab.com>
To: fulldisclosure@...lists.org
Subject: [FD] Kaspersky Company Account - FileManager Vulnerability

Document Title:
===============
Kaspersky Company Account - FileManager Vulnerability


References (Source):
====================
http://www.vulnerability-lab.com/get_content.php?id=1924


Release Date:
=============
2016-08-30


Vulnerability Laboratory ID (VL-ID):
====================================
1924


Common Vulnerability Scoring System:
====================================
3.5


Product & Service Introduction:
===============================
Kaspersky Lab is an international software security group operating in almost 200 countries and territories worldwide. The company is 
headquartered in Moscow, Russia, with its holding company registered in the United Kingdom. Kaspersky Lab currently employs over 2,850 
qualified specialists. It has 31 representative territory offices in 30 countries and its products and technologies provide service 
for over 300 million users and over 250,000 corporate clients worldwide. The company is specially focused on large enterprises, and 
small- and medium-sized businesses.

(Copy of the Homepage: https://en.wikipedia.org/wiki/Kaspersky_Lab )


Abstract Advisory Information:
==============================
The vulnerability laboratory core research team discovered an application-side input validation vulnerability in the official Kaspersky company account FileManager application.


Vulnerability Disclosure Timeline:
==================================
2016-08-30:	Public Disclosure (Vulnerability Laboratory)


Discovery Status:
=================
Published


Affected Product(s):
====================
Kaspersky Labs
Product: Filemanager (Company Account) - Online Service (Web-Application) 2016 Q3


Exploitation Technique:
=======================
Remote


Severity Level:
===============
Medium


Technical Details & Description:
================================
Remote attackers are able to inject malicious java script code in the search query into the main module of file manager in the 
kaspersky company account online web application . The vulnerable module Manage FTP attachment Tool suffer from persistent cross 
site scripting vulnerability that occurs when processing to search or save queries in the application. The request method to 
inject is POST and the attack vector is located on the application-side. Due to our investigation we discovered that attackers 
are able to save and bookmark the malicious java script code by usage of the current option to save the queries on default.


Vulnerable Module(s):
[+] /arsys/forms/cssapp/SRS:Attachments/attachments/

Vulnerable Request(s):
[+] POST / GET 



Proof of Concept (PoC):
=======================
The application-side web vulnerabilities can be exploited by remote attackers with low privileged application user account and low or medium user interaction.
For security demonstration or to reproduce the vulnerability follow the provided information and steps below to continue.


Manual steps to reproduce the vulnerability ...
1. User register at kaspersky company account .
2. User goes to vulnerable module to inject own code :
https://companyaccount.kaspersky.com/arsys/forms/cssapp/SRS:Attachments/attachments/?format=html&cacheid=d700a495
3. Click on advanced search then type this payload : $"><img src="c"
onerror="alert(1)"><script>alert(1)</script> "><img src="c"
onerror="alert(1)"><script>alert(1)</script>$
4. Attacker make a search query . and execution of XSS occurs .
5. Attacker then goes to searches and save it to bookmark it.
6. Successfully reproduce of the vulnerability!


PoC: Video 
https://youtu.be/Qfmg4KrXTdg


Solution - Fix & Patch:
=======================
The vulnerability has been patched  two days after the report has been arrived by the kaspersky service developer group in coordination with the official apt team.


Security Risk:
==============
The security risk of the application-side input validation web vulnerabilities in the kaspersky customer filemanager is estimated as medium. (CVSS 3.5)


Credits & Authors:
==================
Vulnerability Laboratory [Research Team] - Lawrence Amer (http://www.vulnerability-lab.com/show.php?user=Lawrence%20Amer)


Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either expressed 
or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers are not liable 
in any case of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability-Lab 
or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability mainly for 
consequential or incidental damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break any licenses, policies, 
deface websites, hack into databases or trade with stolen data.

Domains:    www.vulnerability-lab.com 		- www.vuln-lab.com 						- www.evolution-sec.com
Section:    magazine.vulnerability-lab.com 	- vulnerability-lab.com/contact.php 				- evolution-sec.com/contact
Social:	    twitter.com/vuln_lab		- facebook.com/VulnerabilityLab 				- youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php 	- vulnerability-lab.com/rss/rss_upcoming.php 			- vulnerability-lab.com/rss/rss_news.php
Programs:   vulnerability-lab.com/submit.php 	- vulnerability-lab.com/list-of-bug-bounty-programs.php 	- vulnerability-lab.com/register.php

Any modified copy or reproduction, including partially usages, of this file, resources or information requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by 
Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and other information on this website is trademark 
of vulnerability-lab team & the specific authors or managers. To record, list, modify, use or edit our material contact (admin@) to get a ask permission.

				    Copyright © 2016 | Vulnerability Laboratory - [Evolution Security GmbH]™



-- 
VULNERABILITY LABORATORY - RESEARCH TEAM
SERVICE: www.vulnerability-lab.com



_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/