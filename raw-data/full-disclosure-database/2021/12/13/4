
Date: Mon, 13 Dec 2021 09:09:22 +0000
From: "., SEC Consult Vulnerability Lab" <security-research@...-consult.com>
To: "fulldisclosure@...lists.org" <fulldisclosure@...lists.org>
Subject: [FD] SEC Consult SA-20211213-0 :: Multiple vulnerabilities in
 AbanteCart e-commerce platform

SEC Consult Vulnerability Lab Security Advisory < 20211213-0 >
=======================================================================
               title: Multiple vulnerabilities
             product: AbanteCart e-commerce platform
  vulnerable version: <1.3.2
       fixed version: 1.3.2
          CVE number: CVE-2021-42050, CVE-2021-42051
              impact: Medium
            homepage: https://www.abantecart.com
               found: 2021-07-19
                  by: Daniel Teo (Office SG)
                      Ian Chong (Office SG)
                      SEC Consult Vulnerability Lab

                      An integrated part of SEC Consult, an Atos company
                      Europe | Asia | North America

                      https://www.sec-consult.com

=======================================================================

Vendor description:
-------------------
"The meaning of the word 'abante' is to move forward or lead.
AbanteCart community stand behind exceptional work quality and dedication to
creating outstanding eCommerce software services. Our inspiration comes from
the developers that like developing with AbanteCart and constantly work to
expand and keep this project alive."

Source: https://www.abantecart.com


Business recommendation:
------------------------
SEC Consult recommends all companies who are using the AbanteCart software, to
upgrade to the latest version which is available at the vendor's official
website.

An in-depth security analysis performed by security professionals is highly
advised, as the software may be affected from further security issues.


Vulnerability overview/description:
-----------------------------------
1) Unrestricted File Upload (CVE-2021-42051)
Any low privileged user with file upload permissions can upload malicious SVG
files that contain a JavaScript payload.

By proceeding to the SVG file location, the payload will be executed on the
client-side.


2) DOM Based Cross-Site Scripting (CVE-2021-42050)
DOM Based XSS is an XSS attack wherein the attack payload is executed as a
result of modifying the DOM "environment" in the victim's browser used by the
original client-side script, so that the client-side code runs in an
"unexpected" manner.

The application was found to have a cross-site scripting vulnerability where
user supplied input is directly reflected in the Document Object Model, leading to
execution of arbitrary code. The vulnerable location is an input form which
allows users to perform search actions.


Proof of concept:
-----------------
1) Unrestricted File Upload (CVE-2021-42051)

A PoC SVG file can be created as follows:

* ************************************************************************** *
<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg">
    <rect width="300" height="100" style="fill:rgb(0,0,255);
stroke-width:3;stroke:rgb(0,0,0)" />
    <script type="text/javascript">
       alert("sectest XSS");
    </script>
</svg>
* ************************************************************************** *

2) DOM Based Cross-Site Scripting (CVE-2021-42050)

A payload was used in the search engine:

* ************************************************************************** *
<script>alert(document.domain)</script>
* ************************************************************************** *

Vulnerable / tested versions:
-----------------------------
The following product version has been tested which was the latest version available
during the time of the test:
* v1.3.0


Vendor contact timeline:
------------------------
2021-08-16: Contacting vendor through help@...ntecart.com
2021-08-27: Vendor responded and indicated that the AbanteCart team have
             scheduled a release on 25 September 2021 to address the issues.
2021-12-07: Multiple emails to check with the vendor on the release date.
             However, no response from the AbanteCart team but noticed that
             they had released the new version on 26 Nov 2021.
2021-12-13: Release of security advisory


Solution:
---------
Upgrade to the latest version available v1.3.2 at the vendor's download page:
https://www.abantecart.com/download


Workaround:
-----------
None


Advisory URL:
-------------
https://sec-consult.com/vulnerability-lab/


~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab

SEC Consult, an Atos company
Europe | Asia | North America

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult, an
Atos company. It ensures the continued knowledge gain of SEC Consult in the
field of network and application security to stay ahead of the attacker. The
SEC Consult Vulnerability Lab supports high-quality penetration testing and
the evaluation of new offensive and defensive technologies for our customers.
Hence our customers obtain the most current information about vulnerabilities
and valid recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application https://sec-consult.com/career/

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices https://sec-consult.com/contact/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: research at sec-consult dot com
Web: https://www.sec-consult.com
Blog: http://blog.sec-consult.com
Twitter: https://twitter.com/sec_consult

EOF Daniel Teo, Ian Chong / @2021

_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/
