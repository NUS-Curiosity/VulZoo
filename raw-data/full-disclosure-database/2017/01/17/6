
Date: Tue, 17 Jan 2017 10:11:30 +0100
From: SEC Consult Vulnerability Lab <research@...-consult.com>
To: <bugtraq@...urityfocus.com>, <fulldisclosure@...lists.org>
Subject: [FD] SEC Consult SA-20170117-0 :: XSS in Recommend Page extension
 for TYPO3 CMS (pb_recommend_page)

SEC Consult Vulnerability Lab Security Advisory < 20170117-0 >
=======================================================================
              title: Cross Site Scripting (XSS)
            product: Recommend Page extension for TYPO3 CMS (pb_recommend_page)
 vulnerable version: <=2.0.3
      fixed version: -
         CVE number: -
             impact: Medium
           homepage: https://typo3.org/
              found: 2016-10-21
                 by: Siddhartha Tripathy (Office Singapore)
                     SEC Consult Vulnerability Lab

                     An integrated part of SEC Consult
                     Bangkok - Berlin - Linz - Luxembourg - Montreal - Moscow
                     Kuala Lumpur - Singapore - Vienna (HQ) - Vilnius - Zurich

                     https://www.sec-consult.com
=======================================================================

Vendor description:
-------------------
"The TYPO3 Universe offers highly flexible, scaleable and customizable products
for Web Content Management, providing the basis for websites, intranets and web &
mobile applications worldwide - always with a focus on the current needs of
businesses and public institutions."

"The Recommend Page extension Generates a form to send a link to a friend
(Recommend page, tip a friend), uses Swift Mailer"

Source: https://typo3.org/about/
        https://typo3.org/extensions/repository/view/pb_recommend_page


Business recommendation:
------------------------
By exploiting the XSS vulnerability, an attacker can include HTML- or
JavaScript code at the affected web page. The code is executed in the
browser of users if they visit the manipulated site. The vulnerability
can be used to change the contents of the displayed site, redirect to
other sites or steal user credentials. Additionally, users are potential
victims of browser exploits and JavaScript Trojan Horses.

SEC Consult recommends not to use the extension until a thorough security
review has been performed by security professionals. Furthermore it seems
that the extension is not maintained anymore.


Vulnerability overview/description:
-----------------------------------
1) Cross Site Scripting (XSS)
The "Recommend page" extension for the TYPO3 CMS has a parameter
"tx_pbrecommendpage_pi1[url]" which is not properly sanitized. An attacker can
inject malicious HTML/JavaScript content which can cause harm to the users.


Proof of concept:
-----------------
1) Cross Site Scripting (XSS)
The "Recommend Page" extension generates a form to send a link to a friend,
where a user can add a link to send to other users. There an attacker can
inject a malicious JavaScript to harm other users.

The proof of concept URL as been removed as the vendor did not provide a patch yet.


Vulnerable / tested versions:
-----------------------------
The XSS vulnerability exists within the "pb_recommend_page" extension for the
TYPO3 CMS. The version of the extension could not be verified during the crash test.

It is assumed that the latest version v2.0.3 from November 2014 is affected as
well as all previous versions.


Vendor contact timeline:
------------------------
2016-10-26: Contacting vendor via security@...o3.org
2016-11-10: Response from TYPO3 Security team that they will investigate and get
            it fixed upon confirmation
2016-11-26: Requesting status update from TYPO3 security team, no answer
2016-12-05: Requesting status update again, no answer
2016-12-22: Requesting status update again, no answer
2017-01-11: Contacted TYPO3 security team again, no answer
2017-01-17: Public release of advisory


Solution:
---------
There is no patch from the vendor available. It is recommended not to use this
extension until a thorough audit has been performed and the issues are fixed.


Workaround:
-----------
Sanitize user supplied content or create only one static pages to recommend.


Advisory URL:
-------------
https://www.sec-consult.com/en/Vulnerability-Lab/Advisories.htm


~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab

SEC Consult
Bangkok - Berlin - Linz - Luxembourg - Montreal - Moscow
Kuala Lumpur - Singapore - Vienna (HQ) - Vilnius - Zurich

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult. It
ensures the continued knowledge gain of SEC Consult in the field of network
and application security to stay ahead of the attacker. The SEC Consult
Vulnerability Lab supports high-quality penetration testing and the evaluation
of new offensive and defensive technologies for our customers. Hence our
customers obtain the most current information about vulnerabilities and valid
recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application https://www.sec-consult.com/en/Career.htm

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices https://www.sec-consult.com/en/About/Contact.htm
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: research at sec-consult dot com
Web: https://www.sec-consult.com
Blog: http://blog.sec-consult.com
Twitter: https://twitter.com/sec_consult

S. Tripathy / @2017


Download attachment "smime.p7s" of type "application/pkcs7-signature" (3993 bytes)


_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/
