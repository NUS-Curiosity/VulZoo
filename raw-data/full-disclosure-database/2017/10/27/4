
Date: Fri, 27 Oct 2017 15:01:32 +0000
From: "Stevie Lamb (WLT GB)" <stevie.lamb@....com>
To: "fulldisclosure@...lists.org" <fulldisclosure@...lists.org>
Subject: [FD] Windows Attachment Manager *potential* feature bypass

*First ever post, so apologies for any associated naiveté*

 

Scenario:

The Windows Attachment Manager does not correctly handle JAR files marked as
high risk when accessed via Internet Explorer 11.

This leads to direct execution of any JAR file when a user clicks Open
rather than Save or Save as, when the expected behaviour would be a nag
dialog.

 

Other files added to the same high risk category behave as expected,
regardless of whether they are directly launched or first saved.

Currently neither Chrome, Edge nor Firefox browsers provide an Open option
for such files, and so are unaffected.

 

With some social engineering this behaviour may be exploited to gain code
execution at the privilege level of the affected user.

This is most likely to be successful when the user has been conditioned to
expect warnings from the Attachment Manager about potentially unsafe files.

 

MS Security decided this wasnt a security issue  and by their published
definitions I accept that assertion.

But sharings caring, this issue can and therefore probably will be abused,
if it hasnt already.

 

To reproduce:

 

Client OS  Windows 10 Pro (version 10.0.14393)

Browser  IE11 (version 11.00.14393.0) *supplied with OS for backwards
compatibility

 

Sample Attachment Manager configuration


Setting

State

Attribute : Value


Trust logic for file attachments

Enabled

Determine risk by : Preferring the file handler


Default risk level for file attachments

Enabled

Set the default risk level : High risk


Inclusion list for high-risk file types

Enabled

.com;.bat;.exe;.pif;.scr;.msi;.ps1;.jar;.sh;.py;.Zip;.Rar;.7z;.gz;.tar;.vbs;
.js;.wsf


Inclusion list for low file types

Enabled

	

Inclusion list for moderate risk file types

Enabled

.doc;.xlsx;.docx;

 

1.       Download any JAR file using the built-in IE11 (x64 or x86) and opt
to open it.

2.       The file opens without any nag dialog indicating the file type is
potentially harmful.

 

Hope its useful.

 

Kind regards,

 

Stevie


Download attachment "smime.p7s" of type "application/pkcs7-signature" (11464 bytes)


_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/
