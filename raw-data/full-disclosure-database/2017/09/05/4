
Date: Fri, 01 Sep 2017 22:52:41 +1000
From: Joseph Harris <j@...r>
To: fulldisclosure@...lists.org
Subject: [FD] Hijacking .uk domains with eNom

the m group security advisory [2017090100]:
Zero-confirmation inter-account transfers of .uk domains with eNom

* Discovery date: 2017-05-02
* Publish date: 2017-09-01 (+122 days)
* Product: https://www.enom.com/, the website for eNom Inc. and their
APIs, all eNom resellers
* Vulnerable: yes, as of publication date 2017-09-01
* Impact: critical
* Homepage: https://www.enom.com
* Errata by: the m group, Sydney office, <hi@...r>
* Reported by: the m group
* URL: https://m.pr/enom-advisory-20170901.html


Vendor description
------------------

eNom is one of the world's largest domain registrars holding over 15
million domain names as well as offering a host of domain and hosting
related services. eNom are also a large internet reseller, powering at
least part of the domain name registration systems for many registrars
including NameCheap.

Website: https://www.enom.com

eNom were recently acquired by Tucows.


Vulnerability & description
---------------------------

eNom allows zero-confirmation .uk domain transfers between reseller
accounts. This bypasses all account security and usual domain transfer
authorization. Combined with instant IPS tag changes at Nominet, the .uk
regional registrar, .uk domains can be hijacked within minutes and
placed into a state where only a manual access restoration procedure
with Nominet can recover the domains.

This vulnerability is accessible to and impacts anyone with an eNom
account or anyone with an account with an eNom reseller which provides
automated domain transfers.

The vulnerability is within eNom's .uk transfer system and impacts .uk
domains only. It does not impact second level .??.uk domains such as
.co.uk and .org.uk.


Steps to reproduce
------------------

1. Open an account with eNom or with an eNom reseller with integrates
with eNom over their APIs, for example NameCheap.
2. Identify a .uk domain managed by eNom. Any .uk domain with an IPS tag
set to ENOM is vulnerable.
3. Issue an inbound transfer request from the reseller.
4. Within a few minutes the .uk domain will "successfully complete"
transfer to your reseller account with no notice given to the original
owner and no confirmation of any kind required.
5. (optional) Immediately transfer the domain elsewhere by changing the
IPS tag and registrant email address making the domain extremely
difficult if not impossible to recover without a manual intervention by
Nominet.


Testing
-------

Confirmed with domain hijacking between NameCheap and eNom using test
domains. The eNom platform and all eNom resellers are assumed to be
vulnerable.


Solution
--------

This vulnerability is with a remote hosted platform there is no
available local solution until eNom resolve the security issue.


Work-around
-----------

Transfer all .uk domains away from eNom. Any .uk domains with the IPS
tag set to ENOM should be transferred away from eNom immediately.

NOTE: during our own domain migrations away from eNom it was discovered
that eNom to not update .uk contact details in certain instances in
their own control panel. This can cause domains to appear to have valid
registrant contact email addresses but they actually have incorrect
details stored at Nominet. Domains which have their IPS tags changed to
push them away from eNom can then be left in a permanently locked and
useless state as authorisation emails sent to invalid registrant contact
addresses can never be authorized.

It is critical that registrant contact details be force-updated from
eNom's control panel before you change the IPS tags even if the contact
details look correct or you may be required to manually contact Nominet
(and pay a fee) to restore your domain. You can verify your .uk
registrant contact details directly with Nominet by opening a Nominet
Online Services account for free.


Vendor contact timeline
-----------------------

Extensive, see the full summary for details.

2017-05-02 (initial report)
2017-05-02 to 2017-08-29 - Significant contact with multiple eNom
representatives.
2017-09-01 (+122 days) - Errata made public.

_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/
