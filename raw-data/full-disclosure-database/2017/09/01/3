
Date: Fri, 1 Sep 2017 05:06:36 +0530
From: Karn Ganeshen <karnganeshen@...il.com>
To: fulldisclosure@...lists.org
Subject: [FD] [ICS] Schneider Electric Pro-Face WinGP – Insecure Library Loading Allows Code Execution

Vendor: Schneider Electric
Equipment: Pro-Face WinGP
Vulnerability: Uncontrolled Search Path Element (DLL side-loading)

Advisory URL:
https://ipositivesecurity.com/2017/06/28/ics-schneider-electric-pro-face-wingp-insecure-library-loading-allows-code-execution/

ICS-CERT Advisory
https://ics-cert.us-cert.gov/advisories/ICSA-17-215-01

------------------------
AFFECTED PRODUCTS
------------------------
The following versions of Pro-face GP-Pro EX software, an HMI management
platform, are affected:

GP Pro EX version 4.07.000

------------------------
BACKGROUND
------------------------
Critical Infrastructure Sector: Energy
Countries/Areas Deployed: Worldwide
Company Headquarters Location: Paris, France

------------------------
IMPACT
------------------------
Successful exploitation of this vulnerability may allow arbitrary code
execution.

------------------------
VULNERABILITY OVERVIEW
------------------------

UNCONTROLLED SEARCH PATH ELEMENT CWE-427
An attacker is able to force the process to load an arbitrary DLL and
execute arbitrary code in the context of the process.

CVE-2017-9961 has been assigned to this vulnerability. A CVSS v3 base score
of 7.2 has been assigned; the CVSS vector string is
(AV:L/AC:H/PR:L/UI:R/S:C/C:N/I:H/A:H).

------------------------
Missing Libraries
------------------------
i2capi.dll


------------------------
Application Executables (that look for missing DLL)
------------------------
Runtime.exe


------------------------
Steps to reproduce
------------------------
1. Generate a dll payload
msfvenom –p windows/exec cmd=calc.exe –f dll –o i2capi.dll

2. Place this dll in any directory defined in the PATH environment variable
C:\Pro-face\WinGP\

3. Run Runtime.exe -> calc.exe
​
executes


+++++
Best Regards,
Karn Ganeshen

_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/