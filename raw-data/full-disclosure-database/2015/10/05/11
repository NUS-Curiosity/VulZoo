
Date: Sun, 4 Oct 2015 10:19:55 +0200
From: Tim Schughart <t.schughart@...sec-networks.com>
To: fulldisclosure@...lists.org
Subject: [FD] Persistent XSS - Liferay Portal Enterprise Edition

Hey guys,

during a penatrationtest I have found an unknown persistent xss in liferay portal backend.

##################
#General Information#
##################


Manufacture description:
Liferay Portal is an enterprise-web-platform for the development of business solutions, which provides quick results and long-term values.


########
#Details#
########
·         Product: 				 	Liferay Portal Enterprise Edition (6.2 EE SP13)
·         Affected versions :	 		All <= 6.2 EE SP13
·         Type of attack:				Persistent  Cross Site Scripting
·         Proof Of Concept:	 			Yes, 6.2 EE SP13
·         Authentication required:		Yes
·         Reason: 					Missing input validation
·         Impact: 						Injection of malicious  JavaScript code

######
#PoC#
######
You have to be authenticated in the administrator backend.
Here you have to browse to the control center:
- In configuration click on portal settings
- Select authentication
- Select ldap
- select add server
- input following code in server name

Value for ldap server name field:
Name_of_ldap_server<script>alert("XSS")</script>

The script is inserted to the configuration page persistent until the ldap server is deleted from database again.

Best regards / Mit freundlichen Grüßen

Tim Schughart
CEO | IT Security specialist



ProSec Networks
Website: http://www.prosec-networks.com <http://www.prosec-networks.com/>
E-Mail: info@...sec.networks.com <mailto:info@...sec.networks.com>
Phone: +49(0) 2621 9469 252

"This E-Mail communication may contain CONFIDENTIAL, PRIVILEGED and/or LEGALLY PROTECTED information and is intended only for the named recipient(s). Any unauthorized use, dissemination, copying or forwarding is strictly prohibited. If you are not the intended recipient and have received this email communication in error, please notify the sender immediately, delete it and destroy all copies of this E-Mail. VAT ID: DE290654714 legal domicile Koblenz.“

"Diese E-Mail Mitteilung kann VERTRAULICHE, dem BERUFSGEHEIMNIS UNTERLIEGENDE und/oder RECHTLICH GESCHÜTZTE Informationen enthalten und ist ausschließlich für den/die genannten Adressaten bestimmt. Jede unbefugte Nutzung, Weitergabe, Vervielfältigung oder Versendung ist strengstens verboten. Sollten Sie nicht der angegebene Adressat sein und diese E-Mail Mitteilung irrtümlich erhalten haben, informieren Sie bitte sofort den Absender, löschen diese E-Mail und vernichten alle Kopien. USt-IdNr.:  DE290654714, Amtsgericht Koblenz."

Download attachment "signature.asc" of type "application/pgp-signature" (497 bytes)


_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/
