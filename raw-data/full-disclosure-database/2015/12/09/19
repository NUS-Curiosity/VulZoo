
Date: Mon, 07 Dec 2015 18:14:31 +0100
From: "Curesec Research Team (CRT)" <crt@...esec.com>
To: fulldisclosure@...lists.org
Subject: [FD] redaxscript 2.5.0: Code Execution

Security Advisory - Curesec Research Team

1. Introduction

Affected Product:    redaxscript 2.5.0
Fixed in:            module has been removed in version 2.6.0
Fixed Version Link:  n/a
Vendor Contact:      info@...axmedia.com
Vulnerability Type:  Code Execution
Remote Exploitable:  Yes
Reported to vendor:  10/02/2015
Disclosed to public: 12/02/2015
Release mode:        Coordinated release
CVE:                 n/a
Credits              Tim Coen of Curesec GmbH

2. Overview

CVSS

High 9.0 AV:N/AC:L/Au:S/C:C/I:C/A:C

Description

The module file_manager allows for file uploads, and uses exif_imagetype to
check the validity of the file.

By setting the first bytes of the uploaded file to that of a valid image type,
an attacker can easily bypass this check and thus upload files of dangerous
type.

It should be noted that only files with the name index.php will be executed, as
access to all other PHP files is forbidden by a htaccess file.

An account that has access to the module "File manager" is needed to exploit
this issue.

3. Code


/modules/file_manager/index.php
function file_manager_upload($directory = '')
{
        $file = $_FILES['file']['tmp_name'];
        $file_name = file_manager_clean_file_name($_FILES['file']['name']);
        $file_size = $_FILES['file']['size'];

        /* validate post */

        if (function_exists('exif_imagetype'))
        {
                if (exif_imagetype($file) == '')
                {
                        $error = l('file_type_limit', '_file_manager') . l('point');
                }
        }

4. Solution

To mitigate this issue please remove the file_manager module.

5. Report Timeline

10/02/2015 Informed Vendor about Issue
11/15/2015 Vendor removes affected module
12/02/2015 Disclosed to public


Blog Reference:
https://blog.curesec.com/article/blog/redaxscript-250-Code-Execution-116.html
 
--
blog:  https://blog.curesec.com
tweet: https://twitter.com/curesec

Curesec GmbH
Curesec Research Team
Romain-Rolland-Str 14-24
13089 Berlin, Germany

_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/
