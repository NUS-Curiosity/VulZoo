
Date: Wed, 16 Dec 2015 19:25:52 +0100
From: "Securify B.V." <lists@...urify.nl>
To: fulldisclosure@...lists.org
Subject: [FD] Shockwave Flash Object DLL side loading vulnerability

------------------------------------------------------------------------
Shockwave Flash Object DLL side loading vulnerability
------------------------------------------------------------------------
Yorick Koster, August 2015

------------------------------------------------------------------------
Abstract
------------------------------------------------------------------------
A DLL side loading vulnerability was found in the Flash version that
ships with Windows. This issue can be exploited by loading the Shockwave
Flash object as an embedded OLE object. When instantiating the object
Windows will try to load the DLL spframe.dll from the current working
directory. If an attacker convinces the user to open a specially crafted
(Office) document from a directory also containing the attacker's DLL
file, it is possible to execute arbitrary code with the privileges of
the target user. This can potentially result in the attacker taking
complete control of the affected system.

------------------------------------------------------------------------
See also
------------------------------------------------------------------------
https://advisory.securify.nl/blog/SFY20151201/there_s_a_party_in_ole__and_you_are_invited.html

------------------------------------------------------------------------
Tested versions
------------------------------------------------------------------------
This issue was successfully verified on Windows 10 + Office 2013 32-bit.

------------------------------------------------------------------------
Fix
------------------------------------------------------------------------
It appears that this issue has been resolved by the security updates for
Adobe Flash Player of November 2015 (version 19.0.0.245 or later,
APSB15-28 [3]). The initialization code has been changed in this
version. Currently, the DLL spframe.dll is only loaded if Flash is
started from Microsoft Edge. In all other cases, Flash tries to load
ieframe.dll instead of spframe.dll. ieframe.dll is located in System32,
which is searched before the current working directory, preventing side
loading of this DLL.

------------------------------------------------------------------------
Details
------------------------------------------------------------------------
https://www.securify.nl/advisory/SFY20150802/shockwave_flash_object_dll_side_loading_vulnerability.html

_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/
