
Date: Tue, 17 Nov 2015 14:18:10 +0100
From: Vulnerability Lab <research@...nerability-lab.com>
To: fulldisclosure@...lists.org
Subject: [FD] LineNity WP Premium Theme - File Include Vulnerability

Document Title:
===============
LineNity WP Premium Theme - File Include Vulnerability


References (Source):
====================
http://www.vulnerability-lab.com/get_content.php?id=1645


Release Date:
=============
2015-11-15


Vulnerability Laboratory ID (VL-ID):
====================================
1645


Common Vulnerability Scoring System:
====================================
6.8


Product & Service Introduction:
===============================
Linenity wordpress theme is a that features a clean and flexible design which suitable for wide variety of websites. Linenity wp theme includes a huge 
theme control panel that help user to develop or customize the theme. It also includes different kind of homepage style, widget, footer, post type, 
shortcode and many others. Linenity also Cross-Browser and Responsive theme, has clean style and well-documented.

(Copy of the Homepage: http://themeforest.net/item/linenity-clean-responsive-wordpress-magazine/4417803 )


Abstract Advisory Information:
==============================
An independent vulnerability laboratory researcher discovered a file include web vulnerability in the official WordPress LineNity Premium Theme in 2015Q4.


Vulnerability Disclosure Timeline:
==================================
2015-11-13: Report to Vulnerability Lab (Sajjad Sotoudeh - White-hg)
2015-11-15: Public Disclosure (Vulnerability Laboratory)


Discovery Status:
=================
Published


Affected Product(s):
====================
Wordpress Premium Themes
Product: LineNity - (WordPress Responsive Magazine Theme) 1.20


Exploitation Technique:
=======================
Remote


Severity Level:
===============
High


Technical Details & Description:
================================
A local file include web vulnerability has been discovered  in the official WordPress LineNity Premium Theme in 2015Q4.
The local file include web vulnerability allows remote attackers to unauthorized include local file/path requests or system 
specific path commands to compromise the web-application.

The web vulnerability is located in the `imgurl` value of the `download.php` file. Remote attackers are able to inject own files with malicious 
`imgurl` value in the `download.php` file GET method request to compromise the web-application. The local file/path include execution occcurs in 
the download.php. The request method to inject is GET and the attack vector is located on the client-side of the wordpress theme web-application.

The security risk of the local file include vulnerability is estimated as high with a cvss (common vulnerability scoring system) count of 6.8. 
Exploitation of the file include web vulnerability requires no user interaction and no privileged web-application user account. 
Successful exploitation of the local file include vulnerability results in web-application, dbms and connected account system -compromise.

Request Method(s):
				[+] [GET]

Vulnerable Module(s):
				[+] ./wp-content/themes/linenity/functions/

Vulnerable File(s):
				[+] download.php

Vulnerable Parameter(s):
				[+] imgurl


Proof of Concept (PoC):
=======================
The file include web vulnerability can be exploited by remote attackers with low privilege web-application user account and without user interaction.
For security demonstration or to reproduce the vulnerability follow the provided information and steps below to continue.


Google Dork(s): 
index of: /wp-content/themes/linenity

Exploit: 
http://localhost:8080/wp-content/themes/linenity/functions/download.php?imgurl=[ Local File Inclusion ]

PoC: 
http://localhost:8080/wp-content/themes/linenity/functions/download.php?imgurl=../../../../index.php
http://localhost:8080/wordpress/wp-content/themes/linenity/functions/download.php?imgurl=../../../../../../../../../../../../../../../etc/passwd


Solution - Fix & Patch:
=======================
The vulnerability can be patched by a secure restriction of the requested path value in the imgurl value of the vulnerable download.php file.
Restrict the requests by a whitelist of accessable web-server path.


Security Risk:
==============
The security risk of the file include web vulnerability in the web application is estimated as high. (CVSS 6.8)


Credits & Authors:
==================
Sajjad Sotoudeh - [sajjadsotoudeh@...oo.com] (http://www.y-r-s.net & www.white-hg.com) [http://www.vulnerability-lab.com/show.php?user=white-hg]
We are: KamraN HellisH - Dr.RooT - Dr.Repermind - Milad_Inj3ct0r - 4li-3ndG & All white-hg members


Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either expressed 
or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers are not liable 
in any case of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability-Lab 
or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for 
consequential or incidental damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break any vendor licenses, 
policies, deface websites, hack into databases or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       		- www.evolution-sec.com
Contact:    admin@...nerability-lab.com 	- research@...nerability-lab.com 	       		- admin@...lution-sec.com
Section:    magazine.vulnerability-db.com	- vulnerability-lab.com/contact.php		       	- evolution-sec.com/contact
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       		- youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   		- vulnerability-lab.com/rss/rss_news.php
Programs:   vulnerability-lab.com/submit.php  	- vulnerability-lab.com/list-of-bug-bounty-programs.php	- vulnerability-lab.com/register/

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. Permission to 
electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by 
Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and other information on this website 
is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), modify, use or edit our material contact 
(admin@...nerability-lab.com or research@...nerability-lab.com) to get a permission.

				Copyright © 2015 | Vulnerability Laboratory - [Evolution Security GmbH]™



-- 
VULNERABILITY LABORATORY - RESEARCH TEAM
SERVICE: www.vulnerability-lab.com
CONTACT: research@...nerability-lab.com
PGP KEY: http://www.vulnerability-lab.com/keys/admin@vulnerability-lab.com%280x198E9928%29.txt



_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/