
Date: Tue, 17 Nov 2015 14:11:43 +0100
From: Vulnerability Lab <research@...nerability-lab.com>
To: fulldisclosure@...lists.org
Subject: [FD] Port Scan v2.0 iOS - Command Inject Vulnerability

Document Title:
===============
Port Scan v2.0 iOS - Command Inject Vulnerability


References (Source):
====================
http://www.vulnerability-lab.com/get_content.php?id=1619


Release Date:
=============
2015-11-02


Vulnerability Laboratory ID (VL-ID):
====================================
1619


Common Vulnerability Scoring System:
====================================
5.6


Product & Service Introduction:
===============================
Port Scanning is a essential network utility for every IT professional and this is the best scanner available for your iOS device. 
This utility application lets you check what services are listening on a network and is useful for making sure no service ports are 
open that shouldn`t be. Use this security tool as a conveinant portable app to check on open ports behind your corporate firewall 
via connection through the WiFi network or from the Internet through the cellular network. This app is a must have for every 
network/system administrator but simple enough for the non-professional to use and understand.

(Copy of the Product Homepage: https://itunes.apple.com/us/app/port-scan-ultra-fast-tcp-port/id638292293 )


Abstract Advisory Information:
==============================
The Vulnerability Laboratory Core Research Team discovered a local command inject vulnerability in the official Port Scan v2.0 iOS mobile application.


Vulnerability Disclosure Timeline:
==================================
2015-11-02:	Public Disclosure (Vulnerability Laboratory)


Discovery Status:
=================
Published


Affected Product(s):
====================

Exploitation Technique:
=======================
Local


Severity Level:
===============
Medium


Technical Details & Description:
================================
A local command inject web vulnerability has been discovered in the official Port Scan v2.0 iOS mobile web-application.
The web vulnerability allows to inject malicious script codes to the application-side of the vulnerable iOS mobile app.

The security vulnerability is located in the device name value of the `Start Quick Scan` module. Local attackers are able 
to manipulate the url value to compromise the mail function of the Port Scan mobile app. The html encoding is broken in the 
`Email Results` export function. Local attackers are able to manipulate the url port scan input field to compromise the 
application internal validation via the `Email Results` (html). The attack vector of the vulnerability is located on the 
application-side and the injection point is the browse url input field.

The security risk of the local commandpath inject vulnerability is estimated as medium with a cvss (common vulnerability 
scoring system) count of 3.7. Exploitation of the local command  inject vulnerability requires a low privilege iOS system 
device user account with restricted access and no user interaction. Successful exploitation of the vulnerability results in 
unauthorized execution of system specific commands and unauthorized path value requests to compromise the mobile iOS 
application and connected device components.

Vulnerable Module(s)
				[+] Start Quick Scan
 
Vulnerable Parameter(s)
				[+] URL

Affected Module(s)
				[+] Email Results - Mail


Proof of Concept (PoC):
=======================
The vulnerability can be exploited by local attackers with restricted iOS device user account and without user interaction.
For security demonstration or to reproduce the vulnerability follow the provided information and steps below to continue.

Manual steps to reproduce the vulnerability ...
1.  Start your iOS device (iPhone or iPad)
2.  Install the Port Scan application to your iOS device
3.  Open Port Scan application
6.  Include above a payload to the URL input field
7.  Click to perform a quick port scan
7.  After the scan has been performed successful you click on top right the menu button
8.  Push the Email Results button to export the scan results
9.  Now, the execution occurs in the email section were the checked URL value is included!
10. Successful reproduce of the remote vulnerability!


PoC: Port Scan Results from  17.10.2015, 19 50.html
<tr><td width="100"><div align="right"><strong>Address:</strong></div></td>
    <td width="185"><strong>www.>''<./[LOCAL COMMAND INJECT VULNERABILITY VIA DEVICE NAME VALUE!]></strong></td>
  </tr>
  <tr>
    <td><div align="right"><strong>on Date:</strong></div></td>
    <td><strong>17.10.2015, 19:50</strong></td>
  </tr>
  <tr>
    <td><div align="right"><strong>Open Ports:</strong></div></td>
    <td><strong>1</td>
  </tr>
</table>
<p></p> <table width=600 cellspacing=3><tr><td width=50><div align=right><strong>Port - </strong></div></td><td width=550><strong>Description</strong></td></tr></table> <tr><td width=60><div align=right><strong>80 :</strong>
</div></td><td width=550><span class=Blue> HTTP - World Wide Web</span></td></tr></iframe></strong></td></tr>


Solution - Fix & Patch:
=======================
The vulnerability can be patched by a secure parse and encode of the vulnerable device name value in the export function.
Restrict the input and disallow usage of special chars in names. Filter by an exception handling that prevents the execution of malicious local stored device values.


Security Risk:
==============
The security risk of the local command inject web vulnerability in the Port Scan web-application is estimated as medium. (CVSS 5.6)


Credits & Authors:
==================
Vulnerability Laboratory [Research Team] - Benjamin Kunz Mejri (bkm@...lution-sec.com) [www.vulnerability-lab.com]


Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either expressed 
or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers are not liable 
in any case of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability-Lab 
or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for 
consequential or incidental damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break any vendor licenses, 
policies, deface websites, hack into databases or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       		- www.evolution-sec.com
Contact:    admin@...nerability-lab.com 	- research@...nerability-lab.com 	       		- admin@...lution-sec.com
Section:    magazine.vulnerability-db.com	- vulnerability-lab.com/contact.php		       	- evolution-sec.com/contact
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       		- youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   		- vulnerability-lab.com/rss/rss_news.php
Programs:   vulnerability-lab.com/submit.php  	- vulnerability-lab.com/list-of-bug-bounty-programs.php	- vulnerability-lab.com/register/

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. Permission to 
electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by 
Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and other information on this website 
is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), modify, use or edit our material contact 
(admin@...nerability-lab.com or research@...nerability-lab.com) to get a permission.

				Copyright © 2015 | Vulnerability Laboratory - [Evolution Security GmbH]™



-- 
VULNERABILITY LABORATORY - RESEARCH TEAM
SERVICE: www.vulnerability-lab.com
CONTACT: research@...nerability-lab.com
PGP KEY: http://www.vulnerability-lab.com/keys/admin@vulnerability-lab.com%280x198E9928%29.txt



_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/