
Date: Tue, 17 Nov 2015 14:13:05 +0100
From: Vulnerability Lab <research@...nerability-lab.com>
To: fulldisclosure@...lists.org
Subject: [FD] LAN Scan HD v1.20 iOS - Command Inject Vulnerability

Document Title:
===============
LAN Scan HD v1.20 iOS - Command Inject Vulnerability


References (Source):
====================
http://www.vulnerability-lab.com/get_content.php?id=1618


Release Date:
=============
2015-11-05


Vulnerability Laboratory ID (VL-ID):
====================================
1618


Common Vulnerability Scoring System:
====================================
5.6


Product & Service Introduction:
===============================
See whats all connect to your favorite public WiFi network or your home network. This all-in-one information appliation is an extremely fast and 
thorough security solution for every user. LAN Scan HD is an application developed for Network Administrators and IT Managers but presented in a 
format targeted for non-professionals. This application allows you to view information about all the devices on a local network. Network devices 
are displayed in a very logical and convenient format for displaying the most pertinent information about each device.

(Copy of the Product Homepage: https://itunes.apple.com/us/app/lan-scan-hd-network-device/id597952879 )


Abstract Advisory Information:
==============================
The Vulnerability Laboratory Core Research Team discovered a local command inject vulnerability in the LAN Scan HD v1.20 iOS mobile application.


Vulnerability Disclosure Timeline:
==================================
2015-11-05:	Public Disclosure (Vulnerability Laboratory)


Discovery Status:
=================
Published


Affected Product(s):
====================
Nutec Apps - LLC
Product: LAN Scan HD - iOS (Web-Application) 1.20


Exploitation Technique:
=======================
Local


Severity Level:
===============
Medium


Technical Details & Description:
================================
A local command inject web vulnerability has been discovered in the official LAN Scan HD v1.20 iOS mobile web-application.
The web vulnerability allows to inject malicious script codes to the application-side of the vulnerable iOS mobile app.

The security vulnerability is located in the device name value of the `Scan Network` module. Local attackers are able to 
manipulate the name value of the device to compromise the mail function of the Lan Scan HD mobile app. The html encoding 
is broken in the `Email Scan` export function. Local attackers are able to manipulate the device name cid name to compromise 
the application internal validation via the `Email Scan` (html). The attack vector of the vulnerability is application-side 
and the injection point is the device name information settings > name > input field.

The security risk of the local commandpath inject vulnerability is estimated as medium with a cvss (common vulnerability 
scoring system) count of 3.6. Exploitation of the local command  inject vulnerability requires a low privilege iOS system 
device user account with restricted access and no user interaction. Successful exploitation of the vulnerability results in 
unauthorized execution of system specific commands and unauthorized path value requests to compromise the mobile iOS 
application and connected device components.

Vulnerable Module(s)
				[+] Scan Network
 
Vulnerable Parameter(s)
				[+] device cell name (cid)

Affected Module(s)
				[+] Email Scan - Mail


Proof of Concept (PoC):
=======================
The vulnerability can be exploited by local attackers with restricted iOS device user account and without user interaction.
For security demonstration or to reproduce the vulnerability follow the provided information and steps below to continue.

Manual steps to reproduce the vulnerability ...
1.  Start your iOS device (iPhone or iPad)
2.  Install the LAN Scan HD application to your iOS device
3.  Open the iOS device settings info menu
4.  Change your device name to a malicious payload with path conditions (command inject)
5.  Save the input and open the LAN Scan HD application
6.  Click the Scan Network button on the bottom of the screen
7.  After the scan has been performed successful you click on top right the menu button
8.  Push the Email Scan button to export the scan results
9.  Now, the execution occurs in the email section were the device value is included!
10. Successful reproduce of the remote vulnerability!


PoC: Scan Results.html

<html><head>
<title>Scan Results</title>
<link rel="important stylesheet" href="chrome://messagebody/skin/messageBody.css">
</head><body><table border=0 cellspacing=0 cellpadding=0 width="100%" class="header-part1"><tr><td><b>Betreff: </b>Scan Results</td></tr>
<tr><td><b>Von: </b>Benjamin Mejri Kunz <vulnerabilitylab@...oud.com></td></tr><tr><td><b>Datum: </b>17.10.2015 19:53</td></tr></table>
<table border=0 cellspacing=0 cellpadding=0 width="100%" class="header-part2"><tr><td><b>An: </b>aki <bkm@...lution-sec.com></td></tr></table><br>
<html><head><meta http-equiv="content-type" content="text/html; "></head><body dir="auto"><div>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Scan PoC</title>
<table width="600" cellspacing="3">
<tbody><tr>
<td width="500"><div align="left"><strong>Network Scanned</strong>: PenTest23-Router</div></td>
<td width="85"></td></tr>
</tbody></table>
<table width="600" cellspacing="3">
<tbody><tr>
    <td><div align="right">on Date:</div></td>
    <td>17.10.2015, 19:52</td>
  </tr>
  <tr>
    <td width="130"><div align="right">Address Range:</div></td>
    <td width="455">192.168.4.2 - 192.168.4.254</td>
  </tr>
</tbody></table>
<br>
<table width="600" cellspacing="3">
  <tbody><tr>
    <td width="501"><div align="left"><strong>Device Information</strong>:</div></td>
    <td width="84"></td>
  </tr>
</tbody></table>
<table width="600" cellspacing="3">
  <tbody><tr>
    <td width="130"><div align="right">Name:</div></td>
    <td width="470">"><-./[LOCAL COMMAND INJECT VULNERABILITY VIA DEVICENAME VALUE!]"></td>
  </tr>
  <tr>
    <td><div align="right">IP Address:</div></td>
    <td>192.168.4.153</td>
  </tr>
  <tr>
    <td><div align="right">MAC:</div></td>
    <td>2:0:0:0:0:0</td>
  </tr>
  <tr>
    <td><div align="right">Vendor:</div></td>
    <td>Apple</td>
  </tr>
</table>
 <p><strong>Gateway Information:<br /></strong><table width="600" cellspacing="3">
  <tr>


Solution - Fix & Patch:
=======================
The vulnerability can be patched by a secure parse and encode of the vulnerable device name value in the export function.
Restrict the input and disallow usage of special chars in names. Filter by an exception handling that prevents the execution of malicious local stored device values.


Security Risk:
==============
The security risk of the local command inject web vulnerability in the LAN Scan HD application is estimated as medium. (CVSS 5.6)


Credits & Authors:
==================
Vulnerability Laboratory [Research Team] - Benjamin Kunz Mejri (bkm@...lution-sec.com) [www.vulnerability-lab.com]


Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either expressed 
or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers are not liable 
in any case of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability-Lab 
or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for 
consequential or incidental damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break any vendor licenses, 
policies, deface websites, hack into databases or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       		- www.evolution-sec.com
Contact:    admin@...nerability-lab.com 	- research@...nerability-lab.com 	       		- admin@...lution-sec.com
Section:    magazine.vulnerability-db.com	- vulnerability-lab.com/contact.php		       	- evolution-sec.com/contact
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       		- youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   		- vulnerability-lab.com/rss/rss_news.php
Programs:   vulnerability-lab.com/submit.php  	- vulnerability-lab.com/list-of-bug-bounty-programs.php	- vulnerability-lab.com/register/

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. Permission to 
electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by 
Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and other information on this website 
is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), modify, use or edit our material contact 
(admin@...nerability-lab.com or research@...nerability-lab.com) to get a permission.

				Copyright © 2015 | Vulnerability Laboratory - [Evolution Security GmbH]™



-- 
VULNERABILITY LABORATORY - RESEARCH TEAM
SERVICE: www.vulnerability-lab.com
CONTACT: research@...nerability-lab.com
PGP KEY: http://www.vulnerability-lab.com/keys/admin@vulnerability-lab.com%280x198E9928%29.txt



_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/