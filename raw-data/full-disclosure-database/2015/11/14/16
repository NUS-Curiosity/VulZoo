
Date: Fri, 13 Nov 2015 17:05:18 +0100
From: "Curesec Research Team (CRT)" <crt@...esec.com>
To: fulldisclosure@...lists.org
Subject: [FD] ClipperCMS 1.3.0: Code Execution

Security Advisory - Curesec Research Team

1. Introduction

Affected Product:    ClipperCMS 1.3.0
Fixed in:            not fixed
Fixed Version Link:  n/a
Vendor Website:      http://www.clippercms.com/
Vulnerability Type:  Code Execution
Remote Exploitable:  Yes
Reported to vendor:  10/02/2015
Disclosed to public: 11/13/2015
Release mode:        Full Disclosure
CVE:                 n/a
Credits              Tim Coen of Curesec GmbH

2. Vulnerability Description

CVSS

High 9.0 AV:N/AC:L/Au:S/C:C/I:C/A:C

Description

The file upload uses a whitelist to only allow non-dangerous file extensions.
However, it does allow the upload of .htaccess files, which means that an
attacker can upload files with any extension and still gain code execution.

An account is required to upload files. The role the account is in needs the
right to upload files. By default, the lowest user role - Editor - has this
right.

3. Proof of Concept


The file upload can be found here:
    http://localhost/ClipperCMS-clipper_1.3.0/manager/index.php?a=31

To gain code execution, upload a .htaccess file with the content:
    AddType application/x-httpd-php .png

Now, any uploaded file containing PHP code with the extension .png will be executed.

3. Solution

This issue has not been fixed by the vendor.

4. Report Timeline

10/02/2015 Informed Vendor about Issue (no reply)
10/21/2015 Reminded Vendor of Disclosure Date (no reply)
11/13/2015 Disclosed to public


Blog Reference:
http://blog.curesec.com/article/blog/ClipperCMS-130-Code-Execution-95.html

_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/
