
Date: Thu, 29 Jan 2015 16:17:22 +1300
From: Denis Andzakovic <denis.andzakovic@...urity-assessment.com>
To: <fulldisclosure@...lists.org>
Subject: [FD] Kaseya BYOD Gateway Multiple Vulnerabilities

(    , )     (,
  .   '.' ) ('.    ',
   ). , ('.   ( ) (
  (_,) .'), ) _ _,
 /  _____/  / _  \    ____  ____   _____
 \____  \==/ /_\  \ _/ ___\/  _ \ /     \
 /       \/   |    \\  \__(  <_> )  Y Y  \
/______  /\___|__  / \___  >____/|__|_|  /
        \/         \/.-.    \/         \/:wq
                    (x.0)
                  '=.|w|.='
                  _=''"''=.

                presents..

Kaseya BYOD Gateway Multiple Vulnerabilities
Affected Versions: Kaseya BYOD Gateway 7.0.2

PDF:
http://www.security-assessment.com/files/documents/advisory/Kaseya_BYOD_Gateway_Multiple_Vulnerabilities.pdf

+-------------+
| Description |
+-------------+

This advisory details multiple vulnerabilities found within the Kaseya BYOD
Gateway software. By chaining a combination of lacking SSL verification, poor
authentication mechanisms and arbitrary redirection vulnerabilities, a
malicious entity may potentially compromise any Kaseya BYOD installation.

The Kaseya BYOD Gateway software uses a redirection feature, wherein users are
redirected to their local Kaseya installation via Kaseya’s hosted servers. The
update request from the BYOD Gateway software to the Kaseya hosted servers was
not found to verify SSL certificates and fails to implement any form of
authentication, instead relying on the length of the gateway identifier to
provide security. Thus, the security of the solution depends on an attacker’s
ability to enumerate the gateway identifier. Once a malicious user enumerates
the Gateway identifier, then they may update the redirect rule for that
customer in Kaseya’s hosted servers, redirecting customers to a malicious
Kaseya BYOD Gateway. 

+--------------+
| Exploitation |
+--------------+

--[ Lack of SSL Certificate Validation

The Kaseya BYOD Gateway was not found to validate SSL certificates when
contacting the Kaseya hosted servers. Requests were found to be made to the
Kaseya hosted servers when updating redirection information (for
local-network-only instances of Kaseya) and when submitting licensing
information. This allows a malicious entity with network access somewhere
between the BYOD Gateway and Kaseya’s servers to perform a Man-In-The-Middle
attack.

--[ Arbitrary Redirection

By intercepting and replaying the request below, a malicious entity may
specify an arbitrary ‘url’ parameter within the ‘siteinfo’ XML tag. The Kaseya
provisioning relay server then updates the BYOD Gateway redirect with the URL
specified. The redirection takes place when a user queries
https://provision.relay.kaseya.net/siteinfo/<code> (where code is the
installation’s 6 digit access code). The
https://provision.relay.kaseya.net/siteinfo/<code> page is queried during the
Kaseya BYOD mobile applications’ start up process in order to determine the
location of the BYOD Gateway.

POST /checkin/gateway/rq-be9781109e7111e3afa822000ab9104f HTTP/1.1
Accept-Encoding: identity
Content-Length: {content length}
Host: provision.relay.kaseya.net
Content-Type: text/xml
Connection: close
User-Agent: Kaseya-Tetra/7.0.2 (CL 7)

<checkin><gateway version="7.0.2" clevel="7" appname="Kaseya-Tetra"/><platform
kind="windows" version="6.2.9200"/><users owner={email address}"
active="3"/><devices active="0"/><siteinfo url={site url}"/><connectors><connector version="1.1" id="ProxyConnector"/><connector version="1.1" id="DirConnector"/><connector version="1.1" id="FileConnector"/><connector version="1.0" id="HomeConnector"/><connector version="1.0" id="LinkConnector"/><connector version="1.1" id="MenuConnector"/><connector version="1.2" id="StaticSiteConnector"/></connectors></checkin>

Once an installation’s Gateway Identifier is known
(rq-be9781109e7111e3afa822000ab9104f in the example above), a malicious entity
may control the redirection and send users to their own malicious Kaseya BYOD
Gateway. This code was found to be disclosed in a number of locations,
including device logs, in the Kaseya BYOD Gateway’s pages or by Kaseya’s
hosted relay servers. The installation gateway identifier is disclosed during
the sign up process. Thus, an attacker that can enumerate the customer's six
digit numeric registration code can step through the registration process,
retrieve the gateway identifier and hijack the installation.

+----------+
| Solution |
+----------+

No official solution is currently available for this issue.

+---------------------+
| Disclosure Timeline |
+---------------------+

03/10/2014 -	Initial contact with Kaseya Support
09/10/2014 -	Established Kaseya security contact
13/10/2014 -	Advisories sent to Kaseya
21/10/2014 -	Additional information sent to Kaseya
22/11/2014 -	Update from Kaseya
29/01/2015 -	Advisory Release	

+-------------------------------+
| About Security-Assessment.com |
+-------------------------------+

Security-Assessment.com is Australasia's leading team of Information Security
consultants specialising in providing high quality Information Security 
services to clients throughout the Asia Pacific region. Our clients include
some of the largest globally recognised companies in areas such as finance,
telecommunications, broadcasting, legal and government. Our aim is to provide
the very best independent advice and a high level of technical expertise while
creating long and lasting professional relationships with our clients.

Security-Assessment.com is committed to security research and development,
and its team continues to identify and responsibly publish vulnerabilities
in public and private software vendor's products. Members of the 
Security-Assessment.com R&D team are globally recognised through their release
of whitepapers and presentations related to new security research.

For further information on this issue or any of our service offerings, 
contact us:

Web www.security-assessment.com
Email info () security-assessment com
Phone +64 4 470 1650




_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/