
Date: Mon, 19 Jan 2015 13:54:59 +0100
From: Vulnerability Lab <research@...nerability-lab.com>
To: fulldisclosure@...lists.org
Subject: [FD] Banana Dance Wiki CMS b2.x - Multiple Web Vulnerabilities

Document Title:
===============
Banana Dance Wiki CMS b2.x - Multiple Web Vulnerabilities


References (Source):
====================
http://www.vulnerability-lab.com/get_content.php?id=1407


Release Date:
=============
2015-01-16


Vulnerability Laboratory ID (VL-ID):
====================================
1407


Common Vulnerability Scoring System:
====================================
8.1


Product & Service Introduction:
===============================
Banana Dance is an open-source PHP/MySQL-based program. It is designed to combine the simplicity of wiki-publishing 
software with the versatility of a CMS. The program also promotes community-building through organized and 
user-rated commenting features. Highly flexible with theme-integration and extension availability Banana Dance 
can be used for all types of purposes, whether it be to create an entire website, a product owner`s manual, or 
an `article`-posting site.

(Copy of the Vendor Homepage: http://www.bananadance.org )


Abstract Advisory Information:
==============================
An independent vulnerability laboratory researcher discovered multiple web vulnerabilities in the official Banana Dance Wiki b v2.x Content Management System.


Vulnerability Disclosure Timeline:
==================================
2015-01-16: Public Disclosure (Vulnerability Laboratory)


Discovery Status:
=================
Published


Affected Product(s):
====================

Exploitation Technique:
=======================
Remote


Severity Level:
===============
High


Technical Details & Description:
================================
1.1
A sql injection web vulnerability has been discovered in the official Lazarus Guestbook v1.22 content management system.
The vulnerability allows an attacker to inject sql commands by usage of a vulnerable value to compromise the application dbms.

The sql injection web vulnerability is located in the `db_prefix` value of the `inserts.php` files. Remote attackers and local low privileged user accounts are 
able to inject own sql commands by usage of vulnerable `db_prefix` value in the insert POST method request. A successful attack requires 
to manipulate a POST method request with vulnerable `db_prefix` value. The injection is a classic order-by sql injection web vulnerability.

The security risk of the sql injection vulnerability is estimated as high with a cvss (common vulnerability scoring system) count of 8.1.
Exploitation of the application-side web vulnerability requires no privileged web-application user account and no user interaction.
Successful exploitation of the security vulnerability results in content management system compromise and database management system compromise.

Request Method(s):
				[+] POST

Vulnerable Module(s):
				[+] Insert

Vulnerable Files(s):
				[+] inserts.php

Vulnerable Parameter(s):
				[+] db_prefix


1.2
A local file include web vulnerability has been discovered in the official iFileExplorer v6.51 iOS mobile web-application.
The local file include web vulnerability allows remote attackers to unauthorized include local file/path requests or system specific 
path commands to compromise the mobile web-application.

The vulnerability is located in the `path` value of the mysql module in the `tables.php` file. Local attackers are able to manipulate 
the `path` value of the `mysql/tables.php` file. The execution of unauthorized local file or path request occurs in the same path 
location of the tables.php file.The request method to inject is POST and the attack vector is located on the application-side of 
the affected content management system.

The security risk of the local file include web vulnerability is estimated as high with a cvss (common vulnerability scoring system) count of 7.3. 
Exploitation of the local file include web vulnerability requires no user interaction and a low privileged web-application user account. 
Successful exploitation of the local file include web vulnerability results in content management system compromise and database management system compromise.

Vulnerable Method(s):
				[+] [POST]

Vulnerable File(s):
				[+] /mysql/tables.php

Vulnerable Module(s):
				[+] /mysql/

Vulnerable Parameter(s):
				[+] path

Affected Module(s):
				[+] /setup/mysql/tables.php


Proof of Concept (PoC):
=======================
1.1 SQL Injection
The sql injection vulnerability can be exploited by remote attackers without privileged application user account and user interaction.
For security demonstration or to reproduce the vulnerability follow the provided information and steps below to continue.

Vulnerable Source:

$q11 = mysql_query("  INSERT INTO `" . $_POST['db_prefix'] . "users`
(`id`, `username`, `password`, `salt`, `email`, `name`, `options`,
`type`, `ip`, `joined`,

`last_updated`, `upvoted`, `downvoted`) VALUES  (1, '" .
addslashes($_POST['username']) . "', '" . $encode_pass . "', '" .
$salt . "', '" . addslashes($_POST['email']) . "',

'Master Administrator', '', 1, '" . $_SERVER['REMOTE_ADDR'] . "', '" .
$date . "', '" . $date . "', 0, 0);  ");  // inserts.php

Note: Execution of the sql command occurs after usage of a send POST method request with the "db_prefix" and payload


1.2 File Inclusion
The local file include vulnerability can be exploited by remote attackers with low privileged application user account and without user interaction.
For security demonstration or to reproduce the vulnerability follow the provided information and steps below to continue.

Vulnerable File(s): /setup/complete.php

Vulnerable Source:
$mysql1 = $_POST['path'] . "/setup/mysql/tables.php";
require $mysql1;  // tables.php

Note: Execution of the payload occurs after the send POST method request called the vulnerable `path` that includes

PoC: /../../../file/we/want/to/include.php%00setup/mysql/tables.php


Security Risk:
==============
1.1
The security risk of the sql injection web vulnerability in the `db_prefix` is estimated as critical.

1.2
The security risk of the local file include web vulnerability in the path value is estimated as high.


Credits & Authors:
==================
Paulos Yibelo (paulosyibelo.com)


Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either 
expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers 
are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even 
if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation 
of liability for consequential or incidental damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break 
any vendor licenses, policies, deface websites, hack into databases or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       		- www.evolution-sec.com
Contact:    admin@...nerability-lab.com 	- research@...nerability-lab.com 	       		- admin@...lution-sec.com
Section:    dev.vulnerability-db.com	 	- forum.vulnerability-db.com 		       		- magazine.vulnerability-db.com
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       		- youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   		- vulnerability-lab.com/rss/rss_news.php
Programs:   vulnerability-lab.com/submit.php  	- vulnerability-lab.com/list-of-bug-bounty-programs.php	- vulnerability-lab.com/register/

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. Permission to 
electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by 
Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and other information on this website 
is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), modify, use or edit our material contact 
(admin@...nerability-lab.com or research@...nerability-lab.com) to get a permission.

				Copyright Â© 2015 | Vulnerability Laboratory [Evolution Security]



-- 
VULNERABILITY LABORATORY - RESEARCH TEAM
SERVICE: www.vulnerability-lab.com
CONTACT: research@...nerability-lab.com
PGP KEY: http://www.vulnerability-lab.com/keys/admin@vulnerability-lab.com%280x198E9928%29.txt



_______________________________________________
Sent through the Full Disclosure mailing list
http://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/