
Date: Wed, 16 Jun 2010 23:00:32 +0000
From: Brandon Enright <bmenrigh@...d.edu>
To: "Thor (Hammer of God)" <Thor@...merofgod.com>
Cc: "<full-disclosure@...ts.grok.org.uk>" <full-disclosure@...ts.grok.org.uk>
Subject: Re: Introducing TGP...

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On Wed, 16 Jun 2010 22:23:04 +0000
"Thor (Hammer of God)" <Thor@...merofgod.com> wrote:

> > You're using a 1024 bit key here which seems a bit gutsy ;-)
> > 
> > Without better attacks, you basically have:
> > 
> > Brute force AES 256 -> O(2^256)
> > Bruce force your 20 char password -> roughly O(2^(20*7)) ==
> > O(2^140) Factor your 1024 bit public modulus -> roughly O(2^80)
> > 
> > Since a 768 bit RSA key has already been factored I'd say you only
> > have a few years before a moderately sized cluster could factor
> > your public key.
> > 
> > Of course, as I write this I realize I'm about to sign this message
> > with a 1024 bit DSA key...
> 
> Actually it's 2048, which I was comfortable with.  And don't forget
> the 16bit salt on that password ;)
> 
> t

- From your message:

<RSAPublicKey>PFJTQUtleVZhbHVlPjxNb2R1bHVzPjJkWVdFWjNNN1R2TXdlV2V4M0ZrWDkxR285bXpWOFp6YkZNQnNVckRtMjNReXZ5dFNhWk0veE5WT3hQTnFwMFhmd0ZZazQvdWpUTnJkOWt0TkRubGN0Y0dFL2hGQ1YzeTJMV0d5L2dTY2hFTUt4bUVjbk80KzVycnJNWnZlaFFmVUE5U1R0bDdWenNOTjJjdnpGOUlRY0lyYzdubHdiZ0JrcnZLNFFIRktVTT08L01vZHVsdXM+PEV4cG9uZW50PkFRQUI8L0V4cG9uZW50PjwvUlNBS2V5VmFsdWU+</RSAPublicKey>

Which decodes to:

<RSAKeyValue><Modulus>2dYWEZ3M7TvMweWex3FkX91Go9mzV8ZzbFMBsUrDm23QyvytSaZM/xNVOxPNqp0XfwFYk4/ujTNrd9ktNDnlctcGE/hFCV3y2LWGy/gSchEMKxmEcnO4+5rrrMZvehQfUA9STtl7VzsNN2cvzF9IQcIrc7nlwbgBkrvK4QHFKUM=</Modulus><Exponent>AQAB</Exponent></RSAKeyValue>

So your encrypting exponent is 65537, pretty standard choice.

And your modulus is:

0xd9d616119dcced3bccc1e59ec771645fdd46a3d9b357c6736c5301b14ac39b6dd0cafcad49a64cff13553b13cdaa9d177f0158938fee8d336b77d92d3439e572d70613f845095df2d8b586cbf81272110c2b19847273b8fb9aebacc66f7a141f500f524ed97b573b0d37672fcc5f4841c22b73b9e5c1b80192bbcae101c52943

Which is a 1024 bit number -- roughly 1.53 * 10^308 or 2^1023.7671


Also, the cipher text of your encrypted AES key is 1024 bits --
consistent with being encrypted with 1024 bit RSA.

Finally, your example KeyNaCl:

<KeyNaCl>d9OkMGXGWswbSqhxw2VsUw==</KeyNaCl>

Is 16 bytes, not 16 bits.

A reasonable assumption is that the attackers already have your private
key fob and so they have the salt.  That is, a salt doesn't add to a
brute force complexity when you are attacking just a single password.

Brandon

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.15 (GNU/Linux)

iEYEARECAAYFAkwZV50ACgkQqaGPzAsl94L0VwCdGH+s4vGTfERg+R6U6H39GB+u
KWwAoMfHmW1g5t4eBUILltBpsC2M70H6
=/CHN
-----END PGP SIGNATURE-----
_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
