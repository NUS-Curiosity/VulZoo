
Date: Thu, 2 Sep 2010 15:23:54 +0800
From: YGN Ethical Hacker Group <lists@...g.net>
To: full-disclosure@...ts.grok.org.uk, bugtraq@...urityfocus.com, 
	bugs@...uritytracker.com, vuln@...unia.com, secalert@...urityreason.com,
	news@...uriteam.com, vuln@...urity.nnov.ru
Subject: Moovida Media Player version 2.0.0.15 Insecure
 DLL Hijacking Vulnerability (libc.dll, quserex.dll)

1. OVERVIEW

The Moovida Media Player application is vulnerable to Insecure DLL
Hijacking Vulnerability. Similar terms that describe this
vulnerability
have been come up with Remote Binary Planting, Unsafe Library Loading,
and Insecure DLL Loading/Injection/Hijacking/Preloading.


2. PRODUCT DESCRIPTION

Moovida Media Player is a free and open source media center that
allows you to enjoy all of your music, video and pictures
in an awsome interface.It allows you to import your media from any of
your local folders, network sources or external devices.
It supports an extensive list of popular file formats and codecs
including the DivX, h264, avi, asf, wmv, mkv, flv, mov, ogg,
so you can play virtually any video in your library, whether film or
tv series. (http://www.moovida.com/features/)


3. VULNERABILITY DESCRIPTION

The Moovida Media Player application passes an insufficiently
qualified path in loading external libraries, "libc.dll"
and "quserex.dll" when a user opens its associated file with
extensions - f4v, flv, img, dv.


4. VERSIONS AFFECTED

2.0.0.15 and lower version family of 2.x.x.x


5. PROOF-OF-CONCEPT/EXPLOIT

http://core.yehg.net/lab/pr0js/advisories/dll_hijacking/moovida/poc/movie/
http://core.yehg.net/lab/pr0js/advisories/dll_hijacking/moovida/poc/moovida.exe_2.0.0.15_[libc.dll,quserex.dll].zip

Tested Platform:
OS: Windows XP Service Pack 3 (Fresh Windows Copy)


6. IMPACT

Attackers can trigger a successful exploit against a victim user in a
number of ways such as placing a malicious external
library file made as hidden attribute and a seemingly interesting file
in network shares, usb drives, file sharing networks,
social networks, ..etc	


7. SOLUTION

Fixed version from the vendor has not been released yet.
However, it is suggested that the following workarounds be deployed by
users to protect increasing mass exploitation of this
vulnerability class:
- Disable loading of libraries from WebDAV and remote network shares
- Disable the WebClient service
Please see workaround solution links in References section.


8. VENDOR

Moovida Developers Team
http://www.moovida.com/



9. CREDIT

This vulnerability was discovered by Aung Khant, http://yehg.net, YGN
Ethical Hacker Group, Myanmar.


10. DISCLOSURE TIME-LINE

08-28-2010: vulnerability discovered
08-28-2010: notified vendor via support ticket
09-02-2010: notified vendor via support forum
09-02-2010: vulnerability disclosed


11. REFERENCES

Original Advisory URL:
http://core.yehg.net/lab/pr0js/advisories/dll_hijacking/[moovida]_2.0.0.15_dll_hijacking(libc.dll,quserex.dll)
Workaround Solution: http://support.microsoft.com/kb/2264107
Workaround Solution:
https://www.microsoft.com/technet/security/advisory/2269637.mspx#EGF
Developer Solution:
http://msdn.microsoft.com/en-us/library/ff919712%28v=VS.85%29.aspx
Unofficial DLL Hijacking List:
http://www.corelan.be:8800/index.php/2010/08/25/dll-hijacking-kb-2269637-the-unofficial-list/


#yehg [09-02-2010]


---------------------------------
Best regards,
YGN Ethical Hacker Group
Yangon, Myanmar
http://yehg.net
Our Lab | http://yehg.net/lab
Our Directory | http://yehg.net/hwd

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
