
Date: Mon, 13 Sep 2010 04:13:05 +0800
From: YGN Ethical Hacker Group <lists@...g.net>
To: full-disclosure@...ts.grok.org.uk, bugtraq@...urityfocus.com, 
	bugs@...uritytracker.com, vuln@...unia.com, secalert@...urityreason.com,
	news@...uriteam.com, vuln@...urity.nnov.ru
Subject: CelFrame Office Suite 2008 <= Insecure DLL
 Hijacking Vulnerability ( java_msci.dll, msci_java.dll, wintab32.dll,
 gswin32c.exe)

1. OVERVIEW

The CelFrame Office Suite application is vulnerable to Insecure DLL
Hijacking Vulnerability. Similar terms that describe this
vulnerability have been come up with Remote Binary Planting, and
Insecure DLL Loading/Injection/Hijacking/Preloading.


2. PRODUCT DESCRIPTION

Celframe Office is a Microsoft and Adobe Photoshop compatible
professional level office & graphic design productivity software. CO
2006 Home boasts of five applications covering every productivity
category. The core programs are not only fully Microsoft & Adobe
compatible, but also with rival programs for ease of use and advanced
features. Celframe Write (MS Word '.doc')--word processor with tables,
frames and grammar checker. Celframe Spreadsheet (MS Excel
'.xls')--with conditional format styles, entry validation messages and
data filtering. Celframe Studio (Adobe Photoshop '.psd')- Photo
editing & vector drawing software for Photoshop users. Celframe Photo
Album - Image organizer for digital photos. Celframe Draw creating
letterheads, logos and insert pictures.


3. VULNERABILITY DESCRIPTION

The CelFrame Office Suite applications pass an insufficiently
qualified path in loading their external libraries
 when a user opens its associated file with extensions.

 Celframe Office Write	
	- affected dll: java_msci.dll, msci_java.dll
	- affected extention: doc

 Celframe Office Spreadsheet
	- affected dll: java_msci.dll, msci_java.dll
	- affected extention: xls
	
 Celframe Office Publisher
	- affected exe: gswin32c.exe
	- affected dll: wintab32.dll
	- affected extention: sla
	
 Celframe Office Draw
	- affected dll: java_msci.dll, msci_java.dll
	- affected extention: odg
	
 Celframe Office Photo Alblum
	- affected dll: wintab32.dll
	- affected extention: plx


4. VERSIONS AFFECTED

2008 and probably lower versions


5. PROOF-OF-CONCEPT/EXPLOIT

http://core.yehg.net/lab/pr0js/advisories/dll_hijacking/celframe-office-2008/poc/movie/celfrme_office_2008-binary-planting-vuln.mp4

Tested Platform: Windows XP Service Pack 3 (Fresh Windows)


6. IMPACT

Attackers can trigger a successful exploit against a victim user in a
number of ways such as placing a malicious external
library file made as hidden attribute and a seemingly interesting file
in network shares, usb drives, file sharing networks,
social networks, ..etc	


7. SOLUTION

Fixed version from the vendor has not been released yet.
However, it is suggested that the following workarounds be deployed by
users to protect increasing mass exploitation of this
vulnerability class:
- Disable loading of libraries from WebDAV and remote network shares
- Disable the WebClient service
Please see workaround solution links in References section.


8. VENDOR

Celframe
http://www.celframe.com/


9. CREDIT

This vulnerability was discovered by Aung Khant, http://yehg.net, YGN
Ethical Hacker Group, Myanmar.


10. DISCLOSURE TIME-LINE

09-11-2010: notified vendor
09-13-2010: vulnerability disclosed


11. REFERENCES

Original Advisory URL:
http://core.yehg.net/lab/pr0js/advisories/dll_hijacking/[celframe_office]_2008_insecure_dll_hijacking
Workaround Solution: http://support.microsoft.com/kb/2264107
Workaround Solution:
https://www.microsoft.com/technet/security/advisory/2269637.mspx#EGF
Developer Solution:
http://msdn.microsoft.com/en-us/library/ff919712%28v=VS.85%29.aspx
Unofficial DLL Hijacking List:
http://www.corelan.be:8800/index.php/2010/08/25/dll-hijacking-kb-2269637-the-unofficial-list/
Testing for DLL Hijacking:
http://core.yehg.net/lab/pr0js/view.php/when_testing_for_dll_hijacking.txt

#yehg [09-13-2010]

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
