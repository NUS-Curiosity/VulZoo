
Date: Wed, 25 Aug 2010 10:58:27 +0100
From: Tim Brown <tmb@...35.com>
To: full-disclosure@...ts.grok.org.uk
Subject: Re: DLL hijacking on Linux

On Wednesday 25 August 2010 10:38:37 Mihai DonÈ›u wrote:

> man sudo(8):
> "Note that the dynamic linker on most operating systems will remove
> variables that can control dynamic linking from the environment of setuid
> executables, including sudo. Depending on the operating system this may
> include _RLD*, DYLD_*, LD_*, LDR_*, LIBPATH, SHLIB_PATH, and others. These
> type of variables are removed from the environment before sudo even begins
> execution and, as such, it is not possible for sudo to preserve them."

Absolutely, but in the case I gave, the path is set /by the script/, not 
inherited from the original user.  The script sets the dangerous path, but 
since sudo hasn't changed the CWD it points at the directory the user running 
sudo was in.

Tim
-- 
Tim Brown
<mailto:tmb@...35.com>

Download attachment "signature.asc " of type "application/pgp-signature" (837 bytes)

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
