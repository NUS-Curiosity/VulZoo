
Date: Sat, 9 Mar 2019 11:40:11 +0100
From: Sebastian Neef <fulldisclosure@...y.work>
To: fulldisclosure@...lists.org
Subject: [FD] CVE-2019-6726: Arbitrary File Deletion in WP fastest Cache <=
	0.8.9.0

The wordpress plugin "WP Fastest Cache" [0] suffered from an arbitrary file deletion bug. 

# Description

A successful attack allows an unauthenticated attacker to specify a path to a directory from which files and directories will be deleted recursively. The vulnerable code path extracts the path portion of the referrer header and then uses string concatenation to build an absolute path. This path is then passed to the 'rm_folder_recursively' function which deletes folders and their files in a recursive manner. 

Although a successful exploit leads to data loss and potentially a DoS against the website, because wordpress won't find important files to run, there are several requirements which need to be met:

- WP Fastest Cache is installed and the cache is activated
- Wordpress is configured to use 'pretty' URL schemes, like /<data>/<title> etc.
- WP Postratings [1] is installed
- At least one ratable post or page was published

# PoC / Exploit

A proof of concept and ready-to-use python exploit script exists at [2], but is in general as simple as finding a ratable post/page, extracting the nonce and sending a POST request with the malicious referrer header. 

# Timeline
- 24.01.2019: Reported the vulnerability to the vendor
- 24.01.2019: CVE-2019-6726 assigned by MITRE
- 29.01.2019: Finished communication about possible fixes
- 17.02.2019: Vendor released fixed version
- 09.03.2019: Details published

Best,
Sebastian Neef
https://0day.work

[0] https://vi.wordpress.org/plugins/wp-fastest-cache/
[1] https://vi.wordpress.org/plugins/wp-postratings/
[2] https://0day.work/cve-2019-6726-arbitrary-file-deletion-in-wp-fastest-cache-0-8-8-1/

_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/
