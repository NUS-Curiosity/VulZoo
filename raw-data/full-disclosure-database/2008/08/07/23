
Date: Thu, 07 Aug 2008 17:55:00 -0600
From: security@...driva.com
To: full-disclosure@...ts.grok.org.uk
Subject: [ MDVSA-2008:162 ] qemu


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

 _______________________________________________________________________

 Mandriva Linux Security Advisory                         MDVSA-2008:162
 http://www.mandriva.com/security/
 _______________________________________________________________________

 Package : qemu
 Date    : August 7, 2008
 Affected: 2008.0, 2008.1
 _______________________________________________________________________

 Problem Description:

 Multiple vulnerabilities have been found in Qemu.
 
 Multiple heap-based buffer overflows in the cirrus_invalidate_region
 function in the Cirrus VGA extension in QEMU 0.8.2, as used in Xen and
 possibly other products, might allow local users to execute arbitrary
 code via unspecified vectors related to attempting to mark non-existent
 regions as dirty, aka the bitblt heap overflow. (CVE-2007-1320)
 
 Integer signedness error in the NE2000 emulator in QEMU 0.8.2,
 as used in Xen and possibly other products, allows local users to
 trigger a heap-based buffer overflow via certain register values
 that bypass sanity checks, aka QEMU NE2000 receive integer signedness
 error. (CVE-2007-1321)
 
 QEMU 0.8.2 allows local users to halt a virtual machine by executing
 the icebp instruction. (CVE-2007-1322)
 
 QEMU 0.8.2 allows local users to crash a virtual machine via the
 divisor operand to the aam instruction, as demonstrated by aam 0x0,
 which triggers a divide-by-zero error. (CVE-2007-1366)
 
 The NE2000 emulator in QEMU 0.8.2 allows local users to execute
 arbitrary code by writing Ethernet frames with a size larger than
 the MTU to the EN0_TCNT register, which triggers a heap-based
 buffer overflow in the slirp library, aka NE2000 mtu heap
 overflow. (CVE-2007-5729)
 
 Heap-based buffer overflow in QEMU 0.8.2, as used in Xen and possibly
 other products, allows local users to execute arbitrary code via
 crafted data in the net socket listen option, aka QEMU net socket
 heap overflow. (CVE-2007-5730)
 
 QEMU 0.9.0 allows local users of a Windows XP SP2 guest operating
 system to overwrite the TranslationBlock (code_gen_buffer) buffer,
 and probably have unspecified other impacts related to an overflow,
 via certain Windows executable programs, as demonstrated by
 qemu-dos.com. (CVE-2007-6227)
 
 Qemu 0.9.1 and earlier does not perform range checks for block
 device read or write requests, which allows guest host users with
 root privileges to access arbitrary memory and escape the virtual
 machine. (CVE-2008-0928)
 
 Changing removable media in QEMU could trigger a bug similar to
 CVE-2008-2004, which would allow local guest users to read arbitrary
 files on the host by modifying the header of the image to identify
 a different format. (CVE-2008-1945) See the diskformat: parameter to
 the -usbdevice option.
 
 The drive_init function in QEMU 0.9.1 determines the format of
 a raw disk image based on the header, which allows local guest
 users to read arbitrary files on the host by modifying the header
 to identify a different format, which is used when the guest is
 restarted. (CVE-2008-2004) See the -format option.
 
 The updated packages have been patched to fix these issues.
 _______________________________________________________________________

 References:

 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-1320
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-1321
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-1322
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-1366
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5729
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5730
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6227
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-0928
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-1945
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-2004
 _______________________________________________________________________

 Updated Packages:

 Mandriva Linux 2008.0:
 702e54aaf211941953f9aab4aef4f463  2008.0/i586/dkms-kqemu-1.3.0-0.pre11.13.2mdv2008.0.i586.rpm
 b1d7cb1057953d7c63c528fdf1034b3a  2008.0/i586/qemu-0.9.0-16.2mdv2008.0.i586.rpm
 f1b73fffef10c952f641d922ad626dd4  2008.0/i586/qemu-img-0.9.0-16.2mdv2008.0.i586.rpm 
 396f94f5b918a8a71d3a6575a9f5ca0b  2008.0/SRPMS/qemu-0.9.0-16.2mdv2008.0.src.rpm

 Mandriva Linux 2008.0/X86_64:
 f767f76399a5994234d697dbc3f7926a  2008.0/x86_64/dkms-kqemu-1.3.0-0.pre11.13.2mdv2008.0.x86_64.rpm
 1e2613cc2158e1c30563585e16857e8c  2008.0/x86_64/qemu-0.9.0-16.2mdv2008.0.x86_64.rpm
 63522aa3e6740fbed3b222e71018ffcd  2008.0/x86_64/qemu-img-0.9.0-16.2mdv2008.0.x86_64.rpm 
 396f94f5b918a8a71d3a6575a9f5ca0b  2008.0/SRPMS/qemu-0.9.0-16.2mdv2008.0.src.rpm

 Mandriva Linux 2008.1:
 1079fe4cb3f742411a2593f2aaed799c  2008.1/i586/dkms-kqemu-1.3.0-0.pre11.15.2mdv2008.1.i586.rpm
 7e999da7698373e37e40866b32703a75  2008.1/i586/qemu-0.9.0-18.2mdv2008.1.i586.rpm
 e85fc2c051a7297488fa85d4ec8a7498  2008.1/i586/qemu-img-0.9.0-18.2mdv2008.1.i586.rpm 
 0495e75ea6296856fb24a3eaea8add4b  2008.1/SRPMS/qemu-0.9.0-18.2mdv2008.1.src.rpm

 Mandriva Linux 2008.1/X86_64:
 0a06c81553ad1068570c3e6d12a1d47a  2008.1/x86_64/dkms-kqemu-1.3.0-0.pre11.15.2mdv2008.1.x86_64.rpm
 04579bc4358470ddb829be94dcd39db0  2008.1/x86_64/qemu-0.9.0-18.2mdv2008.1.x86_64.rpm
 c4dd1da01c083fcbb72281e2d37470c4  2008.1/x86_64/qemu-img-0.9.0-18.2mdv2008.1.x86_64.rpm 
 0495e75ea6296856fb24a3eaea8add4b  2008.1/SRPMS/qemu-0.9.0-18.2mdv2008.1.src.rpm
 _______________________________________________________________________

 To upgrade automatically use MandrivaUpdate or urpmi.  The verification
 of md5 checksums and GPG signatures is performed automatically for you.

 All packages are signed by Mandriva for security.  You can obtain the
 GPG public key of the Mandriva Security Team by executing:

  gpg --recv-keys --keyserver pgp.mit.edu 0x22458A98

 You can view other update advisories for Mandriva Linux at:

  http://www.mandriva.com/security/advisories

 If you want to report vulnerabilities, please contact

  security_(at)_mandriva.com
 _______________________________________________________________________

 Type Bits/KeyID     Date       User ID
 pub  1024D/22458A98 2000-07-10 Mandriva Security Team
  <security*mandriva.com>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)

iD8DBQFIm18fmqjQ0CJFipgRAqFxAJ9ff65+SYEZ6E4pctg1SyWqfgakqQCg9JTJ
62TpG1IUfuDqNPJu8t0iRzc=
=bt6K
-----END PGP SIGNATURE-----

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
