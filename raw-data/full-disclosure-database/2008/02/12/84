
Date: Tue, 12 Feb 2008 18:31:55 -0500
From: iDefense Labs <labs-no-reply@...fense.com>
To: vulnwatch@...nwatch.org, full-disclosure@...ts.grok.org.uk, 
	bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 02.12.08: Microsoft
 Office Works Converter Heap Overflow Vulnerability

iDefense Security Advisory 02.12.08
http://labs.idefense.com/intelligence/vulnerabilities/
Feb 12, 2008

I. BACKGROUND

Microsoft Works is a word processor created by Microsoft in the 1980s.
Microsoft Office, a widely use productivity suite, is distributed with
converters for various versions of the Works file format.

II. DESCRIPTION

Remote exploitation of a heap corruption vulnerability in Microsoft
Corp.'s Works Converter, as included with Microsoft Office, could
potentially allow an attacker to execute arbitrary code as the current
user.

This vulnerability stems from improper input validation of OLE
structures within wkcvqd01.dll when converting a Microsoft Works
document (WPS extension) to Rich Text Format (RTF). When certain fields
are modified, such as the length or count values, heap corruption can
occur. This leads to a potentially exploitable condition.

III. ANALYSIS

Exploitation allows attackers to execute arbitrary code as the user that
converts a specially crafted Works document.

Exploitation might require the installation of additional Microsoft
Office components. When installing Microsoft Office, there are several
installation options for converters. In corporate environments, the
required components are usually set to be installed from the hard drive
on first use. However, one of the installation options causes a request
for the installation media. If this option is used, the media prompt
may help mitigate exploitation.

Microsoft first released a fix for this vulnerability as part of Office
2003 SP3. No specific mention was made about this vulnerability at that
time.

IV. DETECTION

iDefense has confirmed that wkcvqd01.dll version 7.03.0616.0, as
included with Microsoft Office 2003, is vulnerable to this issue. Older
versions are assumed to be vulnerable as well. Additionally, Microsoft
Works itself is suspected to be vulnerable.

V. WORKAROUND

User awareness is the best defense against this type of attack. Users
should be reminded not to open attachments or click URLs from untrusted
sources.

VI. VENDOR RESPONSE

Microsoft has officially addressed this vulnerability with Security
Bulletin MS08-011. For more information, consult their bulletin at the
following URL.

http://www.microsoft.com/technet/security/Bulletin/ms08-011.mspx

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2007-0216 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org/), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

11/13/2006  Initial vendor notification
11/14/2006  Initial vendor response
09/17/2007  Office 2003 SP3 released (fix included)
02/12/2008  Coordinated public disclosure

IX. CREDIT

This vulnerability was reported to VeriSign iDefense by Damian Put
(pucik@...rflow.pl).

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2008 iDefense, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDefense. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically,
please e-mail customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
 There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct,
indirect, or consequential loss or damage arising from use of, or
reliance on, this information.

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
