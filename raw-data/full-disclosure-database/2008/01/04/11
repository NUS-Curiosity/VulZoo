
Date: Fri, 04 Jan 2008 16:42:46 -0500
From: iDefense Labs <labs-no-reply@...fense.com>
To: vulnwatch@...nwatch.org, full-disclosure@...ts.grok.org.uk, 
	bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 12.24.07: Novell
 ZENworks Endpoint Security Management Local Privilege Escalation
 Vulnerability

iDefense Security Advisory 12.24.07
http://labs.idefense.com/intelligence/vulnerabilities/
Dec 24, 2007

I. BACKGROUND

Novell ZENworks Endpoint Security Management (ESM) Security Client
provides centrally managed, policy based firewall protection for
clients. It is designed to be installed on all workstations within the
enterprise. More information is available on the vendor's site at the
following URL.

http://www.novell.com/products/zenworks/endpointsecuritymanagement/

II. DESCRIPTION

Local exploitation of a privilege escalation vulnerability in Novell
ZENworks Endpoint Security Management allows attackers to execute
arbitrary code with SYSTEM privileges.

When the ZENworks ESM Security Client is installed on a workstation, the
STEngine service is set to run under the local SYSTEM account. This
service is implemented within the following executable.

  File Name: STEngine.exe (1,847,296 bytes)
  Version: 3.5.0.20
  MD5: B5402A1EC8D04130304EBA89AF843916

The service provides functionality for any user to generate a diagnostic
report in order to aid in product troubleshooting. During report
generation, STEngine attempts to execute various scripts by spawning
command shells to gather system information. These scripts are
dynamically generated in a directory which all users may write to.

STEngine will also attempt to locate a command shell in this directory
and execute it if it is found. If a malicious local user places a
binary named "cmd.exe" in this directory, STEngine will execute it with
SYSTEM level privileges.

III. ANALYSIS

Exploitation allows unprivileged local users to take complete control of
the affected system.

Exploitation is trivial and does not require any special tools or coding
ability. If an attacker desires an interactive command prompt, a small
wrapper application will be required in order to ensure that the
command window is visible after execution.

IV. DETECTION

iDefense has confirmed the existence of this vulnerability in
STEngine.exe version 3.5.0.20 as included with Novell Inc's ZENworks
Endpoint Security Management 3.5. Other versions may also be affected.

V. WORKAROUND

iDefense is unaware of any effective workaround for this issue.

VI. VENDOR RESPONSE

Novell has addressed this vulnerability by releasing version 3.5.0.82 of
Endpoint Security Management. To download this new version, visit the
following URL.

http://download.novell.com/Download?buildid=5Y6xbs-OKLE~

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2007-5665 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org/), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

09/24/2007  Initial vendor notification
09/25/2007  Initial vendor response
12/24/2007  Coordinated public disclosure

IX. CREDIT

This vulnerability was reported to iDefense by Stephen Fewer of Harmony
Security (www.harmonysecurity.com).

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2008 iDefense, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDefense. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically,
please e-mail customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
 There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct,
indirect, or consequential loss or damage arising from use of, or
reliance on, this information.

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
