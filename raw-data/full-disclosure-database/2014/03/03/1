
Date: Mon, 03 Mar 2014 13:48:20 +0000
From: Harry Metcalfe <harry@....com>
To: full-disclosure@...ts.grok.org.uk
Subject: CSRF in WordPress plugin Google Analytics MU 2.3

Details
================
Software: Google Analytics MU
Version: 2.3
Homepage: http://wordpress.org/plugins/google-analytics-mu/
CVSS: 5.8 (Medium; AV:N/AC:M/Au:N/C:P/I:P/A:N)

Description
================
CSRF in Google Analytics MU 2.3

Vulnerability
================
If an admin visits a page of the attacker’s choosing then the plugin’s 
settings can be altered. This could cause a mild disruption by breaking 
analytics until the problem is noticed, or if the attacker substitutes 
an analytics code they own they could gain access to the analytics data 
until the organisation notices the problem.
There should be a nonce check around line 71 of google-analytics-mu.php 
and a nonce around line 86.

Proof of concept
================
A simple form which changes the analytics code to “abc”:
<form method="POST" 
action="http://localhost/wp-admin/network/settings.php?page=google-analytics-mu-network">
<input type="text" name="UAIDsuper" value="abc">
<input type="submit">
</form>

Mitigations
================
Update to version 2.4 or greater.

Timeline
================

2014-02-19: Discovered
2014-02-26: Reported
2014-02-27: Vendor reports fixed

Discovered by:
================
Tom Adams

Disclosure policy
================
dxw believes in responsible disclosure. Your attention is drawn to our 
disclosure policy: https://security.dxw.com/disclosure/


_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
