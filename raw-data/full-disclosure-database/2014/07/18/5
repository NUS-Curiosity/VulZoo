
Date: Fri, 18 Jul 2014 11:12:13 +0200
From: Vulnerability Lab <research@...nerability-lab.com>
To: fulldisclosure@...lists.org, full-disclosure@...ts.grok.org.uk
Subject: [FD] Microsoft MSN HBE - Blind SQL Injection Vulnerability

Document Title:
===============
Microsoft MSN HBE - Blind SQL Injection Vulnerability


References (Source):
====================
http://www.vulnerability-lab.com/get_content.php?id=1183

Video: http://www.vulnerability-lab.com/get_content.php?id=1282

Vulnerability Magazine: http://vulnerability-db.com/magazine/articles/2014/07/17/vl-core-team-published-blind-sql-injection-vulnerability-video-poc-msrc


Release Date:
=============
2014-07-17


Vulnerability Laboratory ID (VL-ID):
====================================
1183


Common Vulnerability Scoring System:
====================================
9.1


Product & Service Introduction:
===============================
MSN (originally The Microsoft Network; stylized as msn) is a collection of Internet sites and services provided by Microsoft. 
The Microsoft Network debuted as an online service and Internet service provider on August 24, 1995, to coincide with the 
release of the Windows 95 operating system. The range of services offered by MSN has changed since its initial release in 1995. 
MSN was once a simple online service for Windows 95, an early experiment at interactive multimedia content on the Internet, 
and one of the most popular dial-up Internet service providers. MSN was primarily a popular Internet portal. Microsoft used 
the MSN brand name to promote numerous popular web-based services in the late 1990s, most notably Hotmail and Microsoft 
Messenger service, before reorganizing many of them in 2005 under another brand name, Windows Live. MSN.com was the 17th most 
visited domain name on the Internet.

(Copy of the Vendor Homepage: http://www.msn.com )


Abstract Advisory Information:
==============================
The vulnerability laboratory research team has discovered a critical blind sql injection vulnerability in one of the official MSN network web-application.


Vulnerability Disclosure Timeline:
==================================
2014-01-27:	Researcher Notification & Coordination (Ateeq ur Rehman Khan)
2014-01-28:	Vendor Notification (Microsoft Security Response Center)
2014-03-13:	Vendor Response/Feedback (Microsoft Security Response Center)
2014-07-16:	Vendor Fix/Patch  (by Vulnerability Laboratory Check)
2014-07-17:	Public Disclosure (Vulnerability Laboratory)


Discovery Status:
=================
Published


Exploitation Technique:
=======================
Remote


Severity Level:
===============
Critical


Technical Details & Description:
================================
A boolean-based blind SQL Injection web vulnerability has been detected in the official MSN (habitos.be.msn.com) web application Service.
The vulnerability allows remote attackers to inject own sql commands to compromise the affected web-application and connected dbms. 

The SQL Injection vulnerability is located in the item.asp file. The vulnerable parameter to inject the sql commands is `item_id`.
Remote attacker are able to inject own sql commands to the item_id value in the item.asp file GET method request. The issue is a 
blind injection and the attack type is boolean based. The security risk of theremote sql injection web vulnerability 
is estimated as critical with a cvss (common vulnerability scoring system) count of 9.1.

The remote sql injection web vulnerability can be exploited by remote attackers without privileged application user account 
and without required user interaction. Successful exploitation of the sql injection vulnerability results in application and 
web-service or dbms compromise.

Vulnerable Domain(s):
				[+] habitos.be.msn.com

Vulnerable file(s):
				[+] item.asp

Vulnerable Parameter(s):
				[+] item_id


Proof of Concept (PoC):
=======================
The remote blind sql injection vulnerability can be exploited by remote attackers without user interaction or 
privileged web-application user account. For security demonstration or to reproduce the vulnerability follow the 
provided steps and information below. 


Request #1
http://habitos.be.msn.com/item.asp?item_id=98%27%20AND%208606=BENCHMARK(1000000,MD5(0x4964554a))%20AND%20%27xPUE%27=%27xPUE


Request #2
http://habitos.be.msn.com/item.asp?item_id=98%27%20AND%208606=BENCHMARK(5000000,MD5(0x4964554a))%20AND%20%27xPUE%27=%27xPUE


Solution - Fix & Patch:
=======================
The vulnerability can be patched by a secure restriction and parse or encode of the vulnerable item_id value GET method request.


Security Risk:
==============
The security risk of the remote blind sql injection web vulnerability is estimated as critical.


Credits & Authors:
==================
Vulnerability Laboratory [Research Team] - Ateeq ur Rehman Khan [ateeq@...lution-sec.com] (@OhTheITGuy) [www.vulnerability-lab.com]


Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either 
expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers 
are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even 
if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation 
of liability for consequential or incidental damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break 
any vendor licenses, policies, deface websites, hack into databases or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       		- www.evolution-sec.com
Contact:    admin@...nerability-lab.com 	- research@...nerability-lab.com 	       		- admin@...lution-sec.com
Section:    dev.vulnerability-db.com	 	- forum.vulnerability-db.com 		       		- magazine.vulnerability-db.com
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       		- youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   		- vulnerability-lab.com/rss/rss_news.php
Programs:   vulnerability-lab.com/submit.php  	- vulnerability-lab.com/list-of-bug-bounty-programs.php	- vulnerability-lab.com/register/

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. Permission to 
electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by 
Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and other information on this website 
is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), modify, use or edit our material contact 
(admin@...nerability-lab.com or research@...nerability-lab.com) to get a permission.

				Copyright Â© 2014 | Vulnerability Laboratory [Evolution Security]



-- 
VULNERABILITY LABORATORY RESEARCH TEAM
DOMAIN: www.vulnerability-lab.com
CONTACT: research@...nerability-lab.com



_______________________________________________
Sent through the Full Disclosure mailing list
http://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/
