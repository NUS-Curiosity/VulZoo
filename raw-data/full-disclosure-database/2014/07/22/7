
Date: Tue, 22 Jul 2014 14:29:48 +0200
From: Vulnerability Lab <research@...nerability-lab.com>
To: fulldisclosure@...lists.org
Subject: [FD] Barracuda Networks Spam&Virus Firewall v6.0.2 (600 & Vx) -
 Client Side Cross Site Vulnerability

Document Title:
===============
Barracuda Networks Spam&Virus Firewall v6.0.2 (600 & Vx) - Client Side Cross Site Vulnerability


References (Source):
====================
http://www.vulnerability-lab.com/get_content.php?id=890

Barracuda Networks Security ID (BNSEC): BNSEC-1176
https://www.barracuda.com/support/knowledgebase/501600000013gvh

Solution #00006521
BNSEC-01176: Authenticated non-persistent XSS in Barracuda Spam and Virus Firewall v6.0.2


Release Date:
=============
2014-07-21


Vulnerability Laboratory ID (VL-ID):
====================================
890


Common Vulnerability Scoring System:
====================================
2.3


Product & Service Introduction:
===============================
Barracuda Networks, Inc. is a privately held company providing security, networking and storage products based on network appliances and 
cloud services. The company’s security products include products for protection against email, web surfing, web hackers and instant messaging 
threats such as spam, spyware, trojans, and viruses. The company`s networking and storage products include web filtering, load balancing, 
application delivery controllers, message archiving, NG firewalls, backup services and data protection.

(Copy of the Vendor Homepage: https://www.barracudanetworks.com/products/spamandvirusfirewall/models)


Abstract Advisory Information:
==============================
An independent researcher (Ebrahim Hegazy) discovered a client side cross site vulnerability in the Barracuda Networks Spam & Virus Firewall 5.1.0.012 Appliance.


Vulnerability Disclosure Timeline:
==================================
2013-10-26:	Researcher Notification & Coordination (Ebrahim Hegazy)
2013-11-27:	Vendor Notification (Barracuda Networks - Bug Bounty Team)
2013-12-03:	Vendor Response/Feedback (Barracuda Networks - Bug Bounty Team)
2014-00-00:	Vendor Fix/Patch (Barracuda Networks - Developer Team)
2014-00-00:	Public Disclosure (Vulnerability Laboratory)


Discovery Status:
=================
Published


Affected Product(s):
====================
Barracuda Networks
Product: Spam & Virus Firewall 5.1.0.012 (Model 600)


Exploitation Technique:
=======================
Remote


Severity Level:
===============
Medium


Technical Details & Description:
================================
A non persistent cross site scripting vulnerability has been discovered in the official Barracuda Networks Spam&Virus Firewall 600 v5.1.0.x Appliance Application.
The vulnerability allows remote attackers to hijack website customer, moderator or admin sessions informaton by client-side cross site scripting requests.

The vulnerability is located in the main `index.cgi` module of the appliance. The vulnerable application GET values are `auth_type`, `primary_tab` and `secoundary_tab`. 
The client-side script code execution occurs in the `index.cgi` after processing to click the client-side manipulated link with the cross site scripting payload. 
The attack vector of the vulnerability is located on the client-side of the appliance service. The request method to inject the script code is `GET`.

The security risk of the non-persistent input validation web vulnerability is estimated as medium with a cvss (common vulnerability scoring system) count of 2.3.
Exploitation of the client-side remote vulnerability requires low or medium user interaction and no privileged application user account. Successful exploitation results 
in client-side account theft by hijacking, client-side phishing, client-side external redirects and non-persistent manipulation of appliance application- or connected modules.

Vulnerable Service(s):
                          [+] Barracuda Networks - Spam & Virus Firewall 600 v5.1.0.x [BUG BOUNTY: http://spam.ptest.cudasvc.com]

Vulnerable Module(s):
                          [+] ../cgi-mod/index.cgi

Vulnerable Parameter(s):
                          [+] auth_type
                          [+] primary_tab
                          [+] secondary_tab

Affected Section(s):
			  [+] Index - Tab Listings


Proof of Concept (PoC):
=======================
The client side cross site scripting web vulnerability can be exploited by remote attackers without privileged application user account and
with low or medium user interaction. For security demonstration or to reproduce the security vulnerability follow the provided information 
and steps below to continue.

Service: Bug Bounty Server (ptest)
Seriennummer: #BAR-SF-362525
Firmware: v5.1.0.012 (2011-10-27 11:34:08)
Modell:V600 

1- primary_tab
2- auth_type
3- secondary_tab

PoC: Service Link with client-side injected Payload
http://spam.ptest.cudasvc.com/cgi-mod/index.cgi?primary_tab=1%27-alert%28document.location%29-%27//&secondary_tab=quarantine_setup&realm=
%0D&auth_type=Local&user=guest&password=0dc15354daf5236353adf547cf675a49&et=1361818196&role=%0D&locale=en_US&q=
%0D&UPDATE_scana_per_user=Yes&save=Save+Changes&UPDATE_scana_quarantine_addr=fdhdf&UPDATE_scana_quarantine_tag=[QUAR]
&UPDATE_scana_quarantine_reply_addr=postmaster@...racudanetworks.com&UPDATE_quarantine_inbox_url=
%0D&UPDATE_quarantine_enable_default=No&UPDATE_scana_use_default_domain=No&UPDATE_scana_quarantine_notify=Daily&UPDATE_notification_time=15%3
a35&UPDATE_outbound_dusage_use_size_limit=No&UPDATE_outbound_dusage_size_limit=1024000&UPDATE_outbound_dusage_use_age_limit=Yes&UPDATE_outbou
nd_dusage_age_limit=30&UPDATE_user_quarantine_notify=Never&UPDATE_outbound_notification_time=15%3a35&UPDATE_user_quarantine_email_address=%0D


Solution - Fix & Patch:
=======================
The vulnerable function and script context should be filtered when processing to encode meta characters in client-side user inputs. 
Especially when the context will be prepared to reflect inside of the main page index.cgi context.


Security Risk:
==============
The security risk of the client-side cross site scripting web vulnerabilities are estimated as medium(-).


Credits & Authors:
==================
Vulnerability Laboratory [Research Team] - Ebrahim Hegazy [ebrahim@...lution-sec.com] (www.vulnerability-lab.com)


Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either 
expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers 
are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even 
if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation 
of liability for consequential or incidental damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break 
any vendor licenses, policies, deface websites, hack into databases or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       		- www.evolution-sec.com
Contact:    admin@...nerability-lab.com 	- research@...nerability-lab.com 	       		- admin@...lution-sec.com
Section:    dev.vulnerability-db.com	 	- forum.vulnerability-db.com 		       		- magazine.vulnerability-db.com
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       		- youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   		- vulnerability-lab.com/rss/rss_news.php
Programs:   vulnerability-lab.com/submit.php  	- vulnerability-lab.com/list-of-bug-bounty-programs.php	- vulnerability-lab.com/register/

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. Permission to 
electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by 
Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and other information on this website 
is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), modify, use or edit our material contact 
(admin@...nerability-lab.com or research@...nerability-lab.com) to get a permission.

				Copyright © 2014 | Vulnerability Laboratory [Evolution Security]

-- 
VULNERABILITY LABORATORY RESEARCH TEAM
DOMAIN: www.vulnerability-lab.com
CONTACT: research@...nerability-lab.com



_______________________________________________
Sent through the Full Disclosure mailing list
http://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/