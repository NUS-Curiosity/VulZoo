
Date: Wed, 23 Apr 2014 12:59:07 +0200
From: Vulnerability Lab <research@...nerability-lab.com>
To: fulldisclosure@...lists.org
Subject: [FD] AirPhoto WebDisk v4.1.0 iOS - Code Execution Vulnerability

Document Title:
===============
AirPhoto WebDisk v4.1.0 iOS - Code Execution Vulnerability


References (Source):
====================
http://www.vulnerability-lab.com/get_content.php?id=1258


Release Date:
=============
2014-04-22


Vulnerability Laboratory ID (VL-ID):
====================================
1258


Common Vulnerability Scoring System:
====================================
8.7


Product & Service Introduction:
===============================
WebDisk lets your iphone/ipad become a file website over wi-fi netwrk.You can upload/download your document to your iphone/ipad 
on your pc browser over wi-fi. It is also a document viewer.let you direct view your document on your iphone/iphone. You can 
upload /download file to iphone/ipad on your pc browser over wi-fi.

(Copy of the Homepage: https://itunes.apple.com/us/app/webdisk/id546221210 )



Abstract Advisory Information:
==============================
The Vulnerability Laboratory Research Team discovered a local file include web vulnerability in the official AirPhoto WebDisk v4.1.0 iOS mobile application.


Vulnerability Disclosure Timeline:
==================================
2014-04-22:	Public Disclosure (Vulnerability Laboratory)


Discovery Status:
=================
Published


Affected Product(s):
====================
AirPhoto
Product: WebDisk 4.1.0


Exploitation Technique:
=======================
Remote


Severity Level:
===============
High


Technical Details & Description:
================================
A code execution web vulnerability has been discovered in the official WebDisk (AirPhoto) v4.1.0 iOS mobile web-application.
The issue allows an attacker to compromise the application and connected device components by exploitation of system specific 
code execution vulnerability in the webdisk interface.

The vulnerability is located in the POST method request of the `upload` module. The main index provides an upload form which is 
not encoding the regular inputs. The context can be implemented to the upload form and the results is the application-side execution 
of system specific malicious codes. The file itself will not be transfered and the input generates the listing context to the index.

The input field of the upload modules executes the input wrong encoded via POST method request as filename value. Remote attackers are 
also able to execute own malicious codes by usage of a script code payload in combination with the affected system device values. The 
execution of the code occurs in the main webdisk file dir listing context. The attack vector is on application-side and the request method 
to attack the service is POST. The security risk of the remote code execution web vulnerability is estimated as critical with a cvss (common 
vulnerability scoring system) count of 8.7

Exploitation of the remote code execution web vulnerability requires no privileged application user account (passwd default blank) or user interaction. 
Successful exploitation of the code execution vulnerability results in mobile application compromise and connected or affected device component compromise.


Request Method(s):
					[+] POST

Vulnerable Module(s):
					[+] upload

Vulnerable Parameter(s):
					[+] tdmid > filename

Affected Module(s):
					[+] WebDisk File Dir Index Listing [http://localhost:1861]


Proof of Concept (PoC):
=======================
The system specific (php) code execution vulnerability can be exploited by remote attackers without required user interaction or privileged web-application user account. 
For security demonstration or to reproduce the critical web vulnerability follow the provided steps and information below to continue.


PoC: Exploit

<tr>
<td class="tdleft"><a href=""><img class="imgthum" src="afico/files_txt.png"></a></td>
<td class="tdmid">>"<.;%5Cvar%5Cmobile%5CApplications%[CODE EXECUTION VULNERABILITY!]test2</td>
<td class="tdright">4-22 10:14<br/><br/>
<a href="afdelete.ma?p=%5Cvar%5Cmobile%5CApplications%5CA97714FF-A3BB-4FE3-ACE6-927930900B91%5CDocuments%5C%7C-%7C451476891.txt">delete</a></td></tr>
<tr><td colspan="3"  height="1"><hr class="spline" /></td>
</tr>


Vulnerable Source: Upload File - Add [POST]

<form action="afupload.ma?p=%5Cvar%5Cmobile%5CApplications%5CA97714FF-A3BB-4FE3-ACE6-927930900B91%5CDocuments%5C" method="post" enctype="multipart/form-data">
        <textarea name="txt" class="textInput" id="Text1">


Solution - Fix & Patch:
=======================
The vulnerability can be patched by a secure encode and parse of the upload form input field.
Secure and filter the upload POST method request to generate a file.
Encode also the vulnerable output name value in the index listing module itself.


Security Risk:
==============
The security risk of the code execution web vulnerability in the webdisk wifi interface is estimated as high.


Credits & Authors:
==================
Vulnerability Laboratory [Research Team] - Benjamin Kunz Mejri (bkm@...lution-sec.com) [www.vulnerability-lab.com]


Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases 
or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       - www.evolution-sec.com
Contact:    admin@...nerability-lab.com 	- research@...nerability-lab.com 	       - admin@...lution-sec.com
Section:    www.vulnerability-lab.com/dev 	- forum.vulnerability-db.com 		       - magazine.vulnerability-db.com
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       - youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   - vulnerability-lab.com/rss/rss_news.php

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other 
media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and 
other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), 
modify, use or edit our material contact (admin@...nerability-lab.com or research@...nerability-lab.com) to get a permission.

				Copyright Â© 2014 | Vulnerability Laboratory [Evolution Security]



-- 
VULNERABILITY LABORATORY RESEARCH TEAM
DOMAIN: www.vulnerability-lab.com
CONTACT: research@...nerability-lab.com



_______________________________________________
Sent through the Full Disclosure mailing list
http://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/
