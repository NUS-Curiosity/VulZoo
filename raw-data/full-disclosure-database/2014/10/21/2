
Date: Tue, 21 Oct 2014 14:43:16 +0200
From: Vulnerability Lab <research@...nerability-lab.com>
To: fulldisclosure@...lists.org
Subject: [FD] FileBug v1.5.1 iOS - Path Traversal Web Vulnerability

Document Title:
===============
FileBug v1.5.1 iOS - Path Traversal Web Vulnerability


References (Source):
====================
http://www.vulnerability-lab.com/get_content.php?id=1342


Release Date:
=============
2014-10-15


Vulnerability Laboratory ID (VL-ID):
====================================
1342


Common Vulnerability Scoring System:
====================================
5.1


Product & Service Introduction:
===============================
FileBug is a file manager and document viewer for iPhone and iPod touch. You can store and view your documents, 
transferring them easily from Mac or PC, reading them anywhere and share with friends. FileBug is so easy to use. 
It can catch documents from many source, computer, web sites, email attachments, Dropbox…etc. It provides high 
quality view and excellent support for PDF. All files are saved to your device locally and them can be 
protected through password.

(Copy of the Homepage: https://itunes.apple.com/de/app/filebug-file-manager-document/id574385365 )


Abstract Advisory Information:
==============================
The Vulnerability Laboratory Research Team discovered a directory traversal vulnerability in the FileBug v1.5.1 iOS mobile application.


Vulnerability Disclosure Timeline:
==================================
2014-10-15: Public Disclosure (Vulnerability Laboratory)


Discovery Status:
=================
Published


Affected Product(s):
====================
Appxy
Product: FileBug - iOS Mobile Web Application (Wifi) 1.5.1 Professional Edition


Exploitation Technique:
=======================
Remote


Severity Level:
===============
Medium


Technical Details & Description:
================================
A local directory traversal web vulnerability has been dsicovered in the official FileBug v1.5.1 iOS mobile application.
The security vulnerability allows a local attacker to unauthorized request local files and device system paths.

The issue is located in the filename to path/folder value validation of the wifi interface web-application. The vulnerability 
allows a local attackers to inject via filename value in the app by a sync unauthorized local path requests to compromise the 
local ios device. The vulnerability is only exploitable by a local app sync without user interaction. The attacker can include 
in the app a file or a folder with the local path value to request. After the attacker opened the application context the service 
executes the payload in the item dir list of the wifi interface. 

The security risk of the local path traversal web vulnerability is estimated as medium with a cvss (common vulnerability scoring 
system) count of 5.1. Exploitation of the directory traversal web vulnerability requires no privileged application user account 
(passwd default blank) or user interaction. Successful exploitation of the vulnerability results in mobile application compromise 
by unauthorized file/path access.

Request Method(s):
				[+] Sync

Vulnerable Module(s):
				[+] Add File
				[+] Add Folder

Vulnerable Parameter(s):
				[+] filename
				[+] foldername

Affected Module(s):
				[+] Files from FileBug - Wifi File Manager & Interface


Proof of Concept (PoC):
=======================
The local path traversal web vulnerability can be exploited by local attackers with low privileged application user account without user interaction.
For security demonstration or to reproduce the security vulnerability follow the provided information and steps below to continue.

PoC: Files from FileBug - Wifi File Manager & Interface

<html><head><title>Files from FileBug</title><style>html {background-color:#eeeeee} body { background-color:#FFFFFF; font-family:Tahoma,Arial,Helvetica,sans-serif; font-size:18x; margin-left:15%; margin-right:15%; border:3px groove #006600; padding:15px; } </style><script type="text/javascript"> function uploadCheck(){document.getElementById("submit").style.display='none';return true;}</script></head><body><h1>Files from FileBug</h1><bq>The following files are hosted live from the iPhone's Docs folder.</bq><p><a href="..">..</a><br />
<a href="BoxCoreDataStore.sqlite">BoxCoreDataStore.sqlite</a>		(    88.0 Kb, 2014-10-14 17:14:53 +0000)<br />
<a href="Documents/">Documents/</a>		(     0.1 Kb, 2014-10-14 17:14:54 +0000)<br />
<a href="Downloads/">Downloads/</a>		(     0.1 Kb, 2014-10-14 17:14:54 +0000)<br />
<a href="Files.sqlite">Files.sqlite</a>		(   140.0 Kb, 2014-10-14 18:03:36 +0000)<br />
<a href="Movies/">Movies/</a>		(     0.1 Kb, 2014-10-14 17:14:54 +0000)<br />
<a href="Photos/">Photos/</a>		(     0.1 Kb, 2014-10-14 17:14:54 +0000)<br />
<a href="SavedFiles/">SavedFiles/</a>		(     0.1 Kb, 2014-10-14 17:14:53 +0000)<br />
<a href="bkm337"><../../[DIRECTORY TRAVERSAL WEB VULNERABILITY!]>.txt</a>		(     0.0 Kb, 2014-10-14 18:01:31 +0000)<br />
<a href="tempToView/">tempToView/</a>		(     0.1 Kb, 2014-10-14 17:14:53 +0000)<br />
</p>


Solution - Fix & Patch:
=======================
The vulnerability can be patched by a secure encode of the filename and foldername after the sync during the add procedure.
Restrict the input of the filename and foldername to prevent the issue and restrict the path folder request to ensure.


Security Risk:
==============
The security risk of the directory traversal web vulnerability in the filename and foldername values by sync is estimated as medium.


Credits & Authors:
==================
Vulnerability Laboratory [Research Team] - Benjamin Kunz Mejri (bkm@...lution-sec.com) [www.vulnerability-lab.com]


Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either 
expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers 
are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even 
if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation 
of liability for consequential or incidental damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break 
any vendor licenses, policies, deface websites, hack into databases or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       		- www.evolution-sec.com
Contact:    admin@...nerability-lab.com 	- research@...nerability-lab.com 	       		- admin@...lution-sec.com
Section:    dev.vulnerability-db.com	 	- forum.vulnerability-db.com 		       		- magazine.vulnerability-db.com
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       		- youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   		- vulnerability-lab.com/rss/rss_news.php
Programs:   vulnerability-lab.com/submit.php  	- vulnerability-lab.com/list-of-bug-bounty-programs.php	- vulnerability-lab.com/register/

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. Permission to 
electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by 
Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and other information on this website 
is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), modify, use or edit our material contact 
(admin@...nerability-lab.com or research@...nerability-lab.com) to get a permission.

				Copyright © 2014 | Vulnerability Laboratory [Evolution Security]



-- 
VULNERABILITY LABORATORY RESEARCH TEAM
DOMAIN: www.vulnerability-lab.com
CONTACT: research@...nerability-lab.com



_______________________________________________
Sent through the Full Disclosure mailing list
http://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/