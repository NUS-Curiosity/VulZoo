
Date: Thu, 15 May 2014 10:53:22 +0200
From: Matteo Beccati <php@...cati.com>
To: bugtraq@...urityfocus.com, fulldisclosure@...lists.org
Subject: [FD] [REVIVE-SA-2014-001] Revive Adserver 3.0.5 fixes CSRF
	vulnerability

========================================================================
Revive Adserver Security Advisory                     REVIVE-SA-2014-001
------------------------------------------------------------------------
Advisory ID:           REVIVE-SA-2014-001
CVE ID:                CVE-2013-5954
Date:                  2014-05-15
Security risk:         Moderate
Applications affected: Revive Adserver
Versions affected:     <= 3.0.4
Versions not affected: >= 3.0.5
Website:               http://www.revive-adserver.com/
========================================================================


========================================================================
Vulnerability: CSRF
========================================================================

Description
-----------
A CSRF vulnerability was recently discovered and reported in OpenX
Source Security Advisory CVE-2013-5954. However, the number of places in
the code which were affected go well beyond those listed in the original
advisory.

The vulnerability allows users who are logged into the Revive Adserver
console to be tricked into deleting data from their Revive Adserver
installation. The vulnerability does not allow remote users to access
the Revive Adserver console or otherwise modify data.

Although the attack can cause loss of data and service disruptions, the
risk is rated to be moderate as the vulnerability requires the victim to
interact with the attack mechanism.

The vulnerability is also present and exploitable in OpenX Source 2.8.11
and earlier versions, potentially back to phpAdsNew 2.0.x.

Details
-------
HTTP GET methods are used extensively in the Revive Adserver web console
for deleting data or unlinking accounts etc. instead of HTTP POST. These
older style calls were not protected to prevent attack via CSRF.

The scripts that have been fixed are:

    www/admin/admin-user-unlink.php
    www/admin/advertiser-delete.php
    www/admin/advertiser-user-unlink.php
    www/admin/affiliate-delete.php
    www/admin/affiliate-user-unlink.php
    www/admin/agency-delete.php
    www/admin/agency-user-unlink.php
    www/admin/banner-delete.php
    www/admin/campaign-delete.php
    www/admin/channel-delete.php
    www/admin/tracker-delete.php,
    www/admin/userlog-delete.php
    www/admin/zone-delete.php

References
----------
http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2013-5954
https://github.com/revive-adserver/revive-adserver/commit/79cb2db05c9849e225885e8a622978da014a98a7

Permalink
---------
http://www.revive-adserver.com/security/revive-sa-2014-001


Solution
========

We strongly advise people to upgrade to the most recent 3.0.5 version of
Revive Adserver, including those running OpenX Source or older versions
of the application.


Contact Information
===================

The security contact for Revive Adserver can be reached at:
<security AT revive-adserver DOT com>


-- 
Matteo Beccati
On behalf of the Revive Adserver Team
http://www.revive-adserver.com/


_______________________________________________
Sent through the Full Disclosure mailing list
http://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/
