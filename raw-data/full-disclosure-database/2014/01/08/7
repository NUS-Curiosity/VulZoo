
Date: Wed,  8 Jan 2014 18:47:22 +0000 (UTC)
From: security-news@...pal.org
To: security-news@...pal.org
Subject: [Security-news] SA-CONTRIB-2014-001 - Entity API
	- Access Bypass

View online: https://drupal.org/node/2169595

   * Advisory ID: DRUPAL-SA-CONTRIB-2014-001
   * Project: Entity API [1] (third-party module)
   * Version: 7.x
   * Date: 2014-January-08
   * Security risk: Moderately critical [2]
   * Exploitable from: Remote
   * Vulnerability: Access bypass

-------- DESCRIPTION
---------------------------------------------------------

The Entity API module extends the entity API of Drupal core in order to
provide a unified way to deal with entities and their properties.

.... Comment, User and Node Statistics property access bypass

The module's entity wrapper access API doesn't sufficiently protect comment,
user and node statistics properties from unprivileged user access.

This vulnerability is mitigated by the fact that a module must be enabled
that relies on the Entity property access API and it must be configured to
expose either comment, user or node statistics properties. One example would
be the RESTful Web Services module (RESTWS) with the permission configured to
access the comment, user or node resource for untrusted web service
consumers.

.... Entity list property access bypass

The module's entity wrapper access API doesn't sufficiently check entity
access on referenced entities such as taxonomy terms.

This vulnerability is mitigated by the fact that a module must be enabled
that uses the access() method of entity metadata wrappers to determine access
to a property which references multiple entities to which access is not
granted. One example would be the RESTful Web Services module (RESTWS) with
respectively configured permissions on an entity property or (entity
reference) field, for example a list of (unaccessible) referenced user
entities on a node entity.

.... Unpublished comments access bypass

The module's entity_access() API doesn't protect unpublished comments from
being viewed by unprivileged users.

This vulnerability is mitigated by the fact a module must be enabled which
uses the provided entity access API on comments and the comment module must
be enabled.


-------- CVE IDENTIFIER(S) ISSUED
--------------------------------------------

   * /A CVE identifier [3] will be requested, and added upon issuance, in
     accordance with Drupal Security Team processes./

-------- VERSIONS AFFECTED
---------------------------------------------------

   * Entity API 7.x-1.x versions prior to 7.x-1.3.

Drupal core is not affected. If you do not use the contributed Entity API [4]
module, there is nothing you need to do.

-------- SOLUTION
------------------------------------------------------------

Install the latest version:

   * If you use the Entity API module for Drupal 7.x, upgrade to Entity API
     7.x-1.3 [5]

Also see the Entity API [6] project page.

-------- REPORTED BY
---------------------------------------------------------

   * The Comment, User and Node Statistics property access bypass was reported
     by Clemens Tolboom [7].
   * The Entity list property access bypass was reported by Neil Drumm [8] of
     the Drupal Security Team.
   * The Unpublished comments access bypass was reported by Ezra Barnett
     Gildesgame [9].

-------- FIXED BY
------------------------------------------------------------

   * The Comment, User and Node Statistics property access bypass was fixed by
     Klaus Purer [10] of the Drupal Security Team, Wolfgang Zieger [11] the
     module maintainer, Clemens Tolboom [12] and Herman van Rink [13].
   * The Entity list property access bypass was fixed by Wolfgang Zieger [14]
     the module maintainer.
   * The Unpublished comments access bypass was fixed by Klaus Purer [15] of
     the Drupal Security Team and Jakob Perry [16].

-------- COORDINATED BY
------------------------------------------------------

   * Klaus Purer [17] of the Drupal Security Team

-------- CONTACT AND MORE INFORMATION
----------------------------------------

The Drupal security team can be reached at security at drupal.org or via the
contact form at http://drupal.org/contact [18].

Learn more about the Drupal Security team and their policies [19], writing
secure code for Drupal [20], and securing your site [21].

Follow the Drupal Security Team on Twitter at
https://twitter.com/drupalsecurity [22]


[1] http://drupal.org/project/entity
[2] http://drupal.org/security-team/risk-levels
[3] http://cve.mitre.org/
[4] http://drupal.org/project/entity
[5] https://drupal.org/node/2169589
[6] http://drupal.org/project/entity
[7] https://drupal.org/user/125814
[8] https://drupal.org/user/3064
[9] https://drupal.org/user/69959
[10] https://drupal.org/user/262198
[11] https://drupal.org/user/16747
[12] https://drupal.org/user/125814
[13] https://drupal.org/user/449000
[14] https://drupal.org/user/16747
[15] https://drupal.org/user/262198
[16] https://drupal.org/user/45640
[17] https://drupal.org/user/262198
[18] http://drupal.org/contact
[19] http://drupal.org/security-team
[20] http://drupal.org/writing-secure-code
[21] http://drupal.org/security/secure-configuration
[22] https://twitter.com/drupalsecurity

_______________________________________________
Security-news mailing list
Security-news@...pal.org
Unsubscribe at http://lists.drupal.org/mailman/listinfo/security-news

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
