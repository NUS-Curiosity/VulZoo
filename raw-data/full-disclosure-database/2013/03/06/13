
Date: Wed, 06 Mar 2013 10:34:33 +0000
From: Mark Thomas <markt@...che.org>
To: users@...mons.apache.org
Cc: full-disclosure@...ts.grok.org.uk,
 Commons Developers List <dev@...mons.apache.org>, bugtraq@...urityfocus.com
Subject: [SECURITY] CVE-2013-0248 Apache Commons
	FileUpload - Insecure examples

CVE-2013-0248 Apache Commons FileUpload - Insecure examples

Severity: Low

Vendor: The Apache Software Foundation

Versions Affected:
- Commons FileUpload 1.0 to 1.2.2

Description:
Commons FileUpload provides file upload capability for Servlets and web
applications. During the upload process, FileUpload may (depending on
configuration) save the uploaded file temporarily on disk. By default
this will be in the system wide tmp directory. Because the temporary
files have predictable file names and are stored in a publicly writeable
location they are vulnerable to a TOCTOU attack.

A successful attack requires that the attacker has write access to the
tmp directory. The attack can be prevented by setting the repository to
a non-publicly writeable location.

The documentation for FileUpload does not highlight the potential
security implications of not setting a repository, nor do the provided
examples set a repository. This may have caused users to use FileUpload
in an insecure manner.

Mitigation:
Setting the repository to a non-publicly writeable location such as that
defined by the ServletContext attribute javax.servlet.context.tempdir
will prevent the TOCTOU attack.

Credit:
This issue was identified by Karl Dyszynski and Hugo Vazquez Carames of
SonicWall

References:
[1] http://commons.apache.org/fileupload/

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
