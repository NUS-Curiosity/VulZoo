
Date: Sun, 04 Aug 2013 13:18:37 +0100
From: Vulnerability Lab <research@...nerability-lab.com>
To: full-disclosure@...ts.grok.org.uk
Subject: withU Music Share v1.3.7 iOS - Command Inject
	Vulnerability

Title:
======
withU Music Share v1.3.7 iOS - Command Inject Vulnerability


Date:
=====
2013-08-03


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=1040


VL-ID:
=====
1040


Common Vulnerability Scoring System:
====================================
6.1


Introduction:
=============
You can use iPhone & iPad as music server. You can also listen music from other media servers. withU is Music Streamer 
& Music Streaming Player over Wi-Fi connection! (UPnP/DLNA compatible) withU lets you stream your iPod Music Library to

- iOS Devices (iPhone, iPad, iPod Touch)
- Gaming Consoles (XBox 360, PS3)
- Web Browsers (Safari, Chrome)
- PC Applications (Windows Media Player , Plex, XBMC, etc.)

withU also helps you listen Music from Windows 7 PC or PC applications such as Plex, XBMC Media Server, PlayStation 
Media Server, MediaTomb.

( Copy of the Homepage: https://itunes.apple.com/us/app/withu-music-share-free-version/id567979632 )


Abstract:
=========
The Vulnerability Laboratory Research Team discovered a command/path inject vulnerability in the withU v1.3.7 Music-Share application (Apple iOS - iPad & iPhone).


Report-Timeline:
================
2013-08-03:    Public Disclosure (Vulnerability Laboratory)


Status:
========
Published


Affected Products:
==================
Apple AppStore
Product: withU - Music Share Application 1.3.7


Exploitation-Technique:
=======================
Local


Severity:
=========
High


Details:
========
A local command/path injection web vulnerability is detected in the withU v1.3.7 Music-Share application (Apple iOS - iPad & iPhone).
The vulnerability allows to inject local commands via vulnerable system values to compromise the apple mobile iOS application.

The vulnerability is located in the index file dir (header) listing module when processing to request and list the ipad or 
iphone devicename. Local attackers can change the name of the device to inject the code and request any local path or inject 
commands on application-side. The malicious context with the path request executes when an user or victim is watching the 
file dir index listing.

Exploitation of the web vulnerability requires a local privilege iOS device account with restricted access and no user interaction.
Successful exploitation of the vulnerability results unauthorized execution of system specific commands and path requests.

Vulnerable Application(s):
				[+] withU v1.3.7  - ITunes or AppStore (Apple)

Vulnerable Module(s):
				[+] Top Bar

Vulnerable Parameter(s):
				[+] device name

Affected Module(s):
				[+] Listing (INDEX & SUB CATEGORIES) - Page Header


Proof of Concept:
=================
The local command/path inject web vulnerability can be exploited by local attackers with physical device access and no user interaction.
For demonstration or reproduce ...

PoC: Header - Device Name as Title

<h1 class="top_bar">withU-Free (iPad ¥337 360* <[LOCAL COMMAND INJECT WEB VULNERABILITY!];)">)</h1>
<div id="contents">
<ul></ul></div>
<div id="free_version_limit">
<p>Free version limits number of displayed items in album list.</p>
</div></body></html></iframe></h1>


Solution:
=========
The local command inject web vulnerability can be patched by a secure encoding of the device name output in the header section of the application.


Risk:
=====
The security risk of the local command/path inject web vulnerability is estimated as high(-).


Credits:
========
Vulnerability Laboratory [Research Team] - Benjamin Kunz Mejri (bkm@...lution-sec.com)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases 
or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       - www.evolution-sec.com
Contact:    admin@...nerability-lab.com 	- research@...nerability-lab.com 	       - admin@...lution-sec.com
Section:    www.vulnerability-lab.com/dev 	- forum.vulnerability-db.com 		       - magazine.vulnerability-db.com
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       - youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   - vulnerability-lab.com/rss/rss_news.php

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other 
media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and 
other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), 
modify, use or edit our material contact (admin@...nerability-lab.com or research@...nerability-lab.com) to get a permission.

				Copyright © 2013 | Vulnerability Laboratory [Evolution Security]



-- 
VULNERABILITY LABORATORY RESEARCH TEAM
DOMAIN: www.vulnerability-lab.com
CONTACT: research@...nerability-lab.com


_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
