
Date: Sun, 19 May 2013 21:00:01 +0300
From: "MustLive" <mustlive@...security.com.ua>
To: <submissions@...ketstormsecurity.org>, <full-disclosure@...ts.grok.org.uk>,
 "1337 Exploit DataBase" <mr.inj3ct0r@...il.com>
Subject: AFU vulnerabilities in MCImageManager for TinyMCE

Hello list!

I want to warn you about vulnerabilities in Moxiecode Image Manager 
(MCImageManager). This is commercial plugin for TinyMCE. It concerns as 
MCImageManager, as all web applications which have MCImageManager in their 
bundle.

These are Arbitrary File Uploading vulnerabilities, which lead to Code 
Execution on IIS and Apache web servers.

-------------------------
Affected products:
-------------------------

Vulnerable are Moxiecode Image Manager 3.1.5 and previous versions.

-------------------------
Affected vendors:
-------------------------

Moxiecode
http://www.moxiecode.com

----------
Details:
----------

Arbitrary File Uploading (WASC-31):

http://site/path/tiny_mce/plugins/imagemanager/pages/im/index.html

Execution of arbitrary code is possible due to bypass of program's security 
filters (on IIS and Apache web servers).

Code will execute via file uploading. Program is vulnerable to two methods 
of code execution:

1. Via using of symbol ";" (1.asp;.txt) in file name (IIS).

2. Via double extension (1.php.txt) (Apache with special configuration).

MCImageManager has only two such holes in comparison with three holes in 
MCFileManager (about which I wrote earlier). The attack via folder name was 
not working already in version 3.1.0.4. Both these web applications have 
other vulnerabilities about which I'll write later.

------------
Timeline:
------------ 

2013.03.31 - briefly informed developer (together with other issues related 
to TinyMCE).
2013.04.01 - informed developer in detail.
2013.04.03 - announced at my site.
2013.04.04 - the developer planned to fix these holes in new version in 
nearest days.
2013.05.18 - disclosed at my site (http://websecurity.com.ua/6416/).

Best wishes & regards,
MustLive
Administrator of Websecurity web site
http://websecurity.com.ua 


_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
