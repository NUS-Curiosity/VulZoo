
Date: Mon, 16 Jul 2012 01:44:30 +0200
From: Research <research@...nerability-lab.com>
To: full-disclosure@...ts.grok.org.uk
Subject: SMF Board v2.0.2 - Multiple Web Vulnerabilities

Title:
======
SMF Board v2.0.2 - Multiple Web Vulnerabilities


Date:
=====
2012-06-25


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=596


VL-ID:
=====
624


Common Vulnerability Scoring System:
====================================
4.1


Introduction:
=============
Simple Machines Forum — SMF in short — is a free, professional grade software package that allows you to set up 
your own online community within minutes. Its powerful custom made template engine puts you in full control of 
the layout of your message board and with our unique SSI - or Server Side Includes - function you can let your 
forum and your website interact with each other. SMF is written in the popular language PHP and uses a MySQL database. 
It is designed to provide you with all the features you need from a bulletin board while having an absolute minimal 
impact on the resources of the server. SMF is the next generation of forum software - and best of all it is and 
will always remain completely free!

(Copy of the Vendor Homepage: http://www.simplemachines.org/ ) 


Abstract:
=========
The Vulnerability Laboratory Research Team discovered multiple web vulnerabilities in the official SMF v2.0.2 (Forum Application).


Report-Timeline:
================
2012-06-23:	Public or Non-Public Disclosure


Status:
========
Published


Affected Products:
==================
SMF
Product: Simple Machines Forum v2.0.2


Exploitation-Technique:
=======================
Remote


Severity:
=========
Medium


Details:
========
Multiple persistent input validation vulnerabilities are detected in the official SMF v2.0.2 (Board|Forum Application) CMS.
The bugs allow remote attackers to implement/inject malicious script code on the application side (persistent). The persistent 
vulnerabilities are located in the package manager, smiley sets, newsletter and edit members or groups with the vulnerable bound
post parameters local path url, username, url, emails & title. Exploitation requires low user inter action & privileged application 
user account. Successful exploitation of the vulnerability can lead to session hijacking (admin/mod/user) or stable (persistent) 
manipulation of the web application context. 

Vulnerable Section(s):
                          [+] Package Manager > Download New Packages > FTP Information Required 
                          [+] Smiley Sets > Add
                          [+] Newsletter > Add
                          [+] My Community > Administration Center > Membergroups > Edit Membergroups


Vulnerable Module(s):
                          [+] Local path to SMF & Username [Packages]
                          [+] URL
                          [+] Name of emails
                          [+] Name & Group Title


Proof of Concept:
=================
The persistent input validation vulnerability can be exploited by remote attacker with local low privileged user account & low required 
user inter action. For demonstration or reproduce ...

Review: Package Manager > Download New Packages > FTP Information Required (Listing)

<dd>
<input size="30" name="ftp_server" id="ftp_server" type="text"><[PERSISTENT SCRIPT CODE]' <"="" class="input_text">
<label for="ftp_port">Port:&nbsp;</label> 
<input type="text" size="3" name="ftp_port" id="ftp_port" value="21" 
class="input_text" />

... or


<dd>
<input size="50" name="ftp_path" id="ftp_path" value="public_html/demo/smf " 
type="text"><[PERSISTENT SCRIPT CODE])' <"="" style="width: 99%;" class="input_text">
</dd>
</dl>
<div class="righttext">


URL: http://127.0.0.1:1339/smf/index.php?action=admin;area=packages;sa=packageget;get;f5073d7837d8=5a2bdd540a245be265f26c102fff9626



Review: Smiley Sets > Add

<tr class="windowbg" id="list_smiley_set_list_0">
<td style="text-align: center;"></td>
<td class="windowbg">Akyhne's Set</td>
<td class="windowbg">"><[PERSISTENT SCRIPT CODE]' <="" <strong="">
akyhne</strong>/...</td>


URL: http://127.0.0.1:1339/smf/index.php?action=admin;area=smileys;sa=modifyset;set=2


Review: Newsletter > Add

<input name="email_force" value="0" type="hidden">
<input name="total_emails" value="1" type="hidden">
<input name="max_id_member" value="13" type="hidden">
<input name="groups" value="0,1,2,3" type="hidden">
<input name="exclude_groups" value="0,1,2,3" type="hidden">
<input name="members" value="" type="hidden">
<input name="exclude_members" value="" type="hidden">
<input name="emails" value="" type="hidden"><[PERSISTENT SCRIPT CODE])' <"="">
		</form>
	</div>
	<br class="clear" />
</div>

URL: http://127.0.0.1:1339/smf/index.php?action=admin;area=news;sa=mailingmembers;b74f235ec=2b30f2b9aad6e26815e1c18594922b37


Review: Edit Membergroups & User/Groups Listing

<h3 class="catbg">Edit Membergroup - "><[PERSISTENT SCRIPT CODE])' <"=""><[PERSISTENT SCRIPT CODE]) <"
><ifram
</h3>
</div>
<div class="windowbg2">
<span class="topslice"><span></span></span>

URL: http://127.0.0.1:1339/smf/index.php?action=admin;area=membergroups;sa=index;b74f235ec=2b30f2b9aad6e26815e1c18594922b37
URL: http://127.0.0.1:1339/smf/index.php?action=admin;area=membergroups;sa=add;b74f235ec=2b30f2b9aad6e26815e1c18594922b37



Risk:
=====
The security risk of the persistent input validation vulnerabilities are estimated as medium(+).


Credits:
========
Vulnerability Laboratory [Research Team]  -    Benjamin Kunz Mejri (bkm@...nerability-lab.com)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. 

Domains:	www.vulnerability-lab.com   	- www.vuln-lab.com
Contact:	admin@...nerability-lab.com 	- support@...nerability-lab.com 	- research@...nerability-lab.com
Section:	video.vulnerability-lab.com 	- forum.vulnerability-lab.com 		- news.vulnerability-lab.com
Social:		twitter.com/#!/vuln_lab 	- facebook.com/VulnerabilityLab 	- youtube.com/user/vulnerability0lab

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other 
media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, sourcecode, videos and 
other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), 
modify, use or edit our material contact (admin@...nerability-lab.com or support@...nerability-lab.com) to get a permission.

    						Copyright © 2012 Vulnerability-Lab



-- 
VULNERABILITY RESEARCH LABORATORY TEAM
Website: www.vulnerability-lab.com
Mail: research@...nerability-lab.com


_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/