
Date: Wed, 15 Aug 2012 14:47:52 -0400
From: "Justin C. Klein Keane" <justin@...irish.net>
To: full-disclosure@...ts.grok.org.uk
Subject: Drupal Custom Publishing Options Module XSS

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Vulnerability Report

Reported:  January 3, 2012
Author: Justin C. Klein Keane <justin@...irish.net>

Description of Vulnerability:
- -----------------------------
Drupal (http://drupal.org) is a robust content management system (CMS)
written in PHP and MySQL.  The Drupal Custom Publishing Options module
(https://drupal.org/project/custom_pub) contains a persistent cross
site scripting (XSS) vulnerability due to the fact that it fails to
sanitize format names before display.

Systems affected:
- -----------------
Drupal 6.22 with Custom Publishing Options 6.x-1.4 was tested and
shown to be vulnerable

Impact
- ------
User could inject arbitrary scripts into pages affecting site users.
This could result in administrative account compromise leading to web
server process compromise.

Mitigating factors:
- -------------------
In order to execute arbitrary script injection malicious users must
have 'Administer nodes' permission.

Proof of Concept:
- -----------------
1.  Install and enable the Custom Publishing Options module
2.  Add a new label at ?q=admin/content/custom_pub inserting arbitrary
HTML in the 'Publishing label' field.
3.  Save the label to view the rendered script or view it on the
create content page for the appropriate content type.

Vendor response:
- ---------------
Upgrade to the latest version

- -- 
Justin C. Klein Keane
http://www.MadIrish.net

The PGP signature on this email can be verified using the public key at
http://www.madirish.net/gpgkey
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iPwEAQECAAYFAlAr7tQACgkQkSlsbLsN1gA+ogb/drMm08BCFHlfKg21hVHtoGjN
bKLX26wErcLfvsIlwfPvCQx3cme8BNoUA7pCyjmYAIQAZBnAlNvXA6fxz4aLuED5
I8zkwWFOYLKHXlsXYI2hnPuf4AVUFE3wPptqSTqONzE3GIWVyIolIOwmYxT1mi8P
7s3bWG/MpKE0owNDYzNkM5qjBULIgMzyX1SIIGkqde8UqZrIJLk0AbKeDtNLeJ5p
yb2WA8eIbkDUTPEPUpAu4fU43ki+dh0BN1b3Xqalrtel12ln1k62jORVqh07TGe/
wj9F9msw4R1wqHEZFlk=
=B/fi
-----END PGP SIGNATURE-----

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
