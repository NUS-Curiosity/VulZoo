
Date: Sun, 26 Aug 2012 00:22:20 +0430
From: Shahriyar Jalayeri <shahriyar.j@...il.com>
To: full-disclosure@...ts.grok.org.uk
Subject: Windows Kernel Intel x64 SYSRET Vulnerability +
 Code Signing Bypass Bonus

Hi
Microsoft Windows Kernel Intel x64 SYSRET Vulnerability (MS12-042) was
only exploited by VUPEN, apparently!, But no PoC or exploit publicly
available. So I decided to work on this challenge just for fun.At first
glance, it was difficult to get Code-Execution but after several times
struggling with Windbg I finally succeeded on triggering the bug and get
code-execution.By the way, Windbg had stupid bug on executing SWAPGS by
single-stepping! I donâ€™t really know why, but the guest VM always
reboots! I managed to get it to work with IDA Pro + GDB remote Debugging
plugin after all!
here is the rest of story + PoC (
http://repret.wordpress.com/2012/08/25/windows-kernel-intel-x64-sysret-vulnerability-code-signing-bypass-bonus/
)

- Shahriyar Jalayeri
twitter.com/ponez

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
