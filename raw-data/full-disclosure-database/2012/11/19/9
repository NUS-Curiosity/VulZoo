
Date: Mon, 19 Nov 2012 13:01:00 +0100
From: Vulnerability Lab <research@...nerability-lab.com>
To: full-disclosure@...ts.grok.org.uk
Subject: Re: XSS,
	LFI and SQL Injection Vulnerabilities in Achievo

Hallo /Netsparker & Henri Solo,
already reported. Greets *Sry
/

Title:
======
Achievo v1.4.3 - Multiple Web Vulnerabilities


Date:
=====
2012-01-30


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=403

http://www.cnnvd.org.cn/vulnerability/show/cv_id/2012020060
ID: CNNVD-201202-060


VL-ID:
=====
403


Common Vulnerability Scoring System:
====================================
8.3


Introduction:
=============
Achievo is a flexible web-based resource management tool for business environments.
Achievo s resource management capabilities will enable organisations to support their business
processes in a simple, but effective manner.

A solution that fits seamlessly to the wishes of every organisation and offers the possibility
and freedom to adapt the functionality to the needs of the organisation. It will fit into every
organisation because Achievo is extremly easy to change to your specific situation.

(Copy of the Vendor Website: http://www.achievo.nl/product/ )


Abstract:
=========
Vulnerability-Lab Team (Chokri B.A.) discovered Multiple Web Vulnerabilities on the resource management tool Achievo v1.4.3.


Report-Timeline:
================
2012-01-30:	Public or Non-Public Disclosure


Status:
========
Published


Exploitation-Technique:
=======================
Remote


Severity:
=========
Critical


Details:
========
1.1
A blind SQL vulnerability is detected in the resource management tool Achievo v1.4.3 Content Management System. 
The sql injection bug allows remote attackers to inject own sql commands on the affected (vulnerable) web application dbms.
The vulnerability is located in every module in the atkstackid (session) module with the bound vulnerable id parameter request.
Exploitation requires no user interaction or privileged application user account. Successful exploitation of the vulnerability 
results in web application and dbms compromise via sql injection attack. 

Vulnerable Module(s): (Example)
				[+] Download vcard
				[+] ... & all -id bound requests


Vulnerable Parameter(s):
				[+] tkstackid session - ID


1.2
Multiple persistent input validation web vulnerabilities are detected in the resource management tool Achievo v1.4.3.
The bug allows remote attacker to implement/ inject own malicious script code on the application side (persistent).

The first vulnerability is located in the user preferences module with the bound vulnerable search all parameter request.
The secound vulnerability is located in the projects module with the bound vulnerable fieldlabel parameter request

Successful exploitation of the vulnerability results in persistent session hijacking (user/mod/admin), persistent phishing, 
persistent redirects or malware loads and persistent web context manipulation. Exploitation requires low privileged 
application user account and low or medium required user interaction.

Vulnerable Module(s):
				[+] Users preferences
				[+] Projects


Vulnerable Parameter(s):
				[+] Search All
				[+] Name


Proof of Concept:
=================
1.1
The sql injection vulnerability can be exploited by remote attackers without user interaction and without privileged application user account. 
For demonstration or reproduce ...

PoC:
http://127.0.0.1:2323/achievo/stable/dispatch.php?atkaction=vcard&atklevel=1&atkprevlevel=0&atkstackid=4f2467eae0518&id=3'-1[SQL INJECTION Vulnerability!]--

--- SQL Exception Logs ---
Critical: Unknown error: 
1064 (You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version 
for the right syntax to use near 'contact') ORDER BY person.role, person.lastname' at line 1).
Halted 
error: [+0.19090s / 0.00036s] Unknown error: 1064 
(You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the 
right syntax to use near 'contact') ORDER BY person.role, person.lastname' at line 1)
Halted...



1.2
The persistent web vulnerabilities can be exploited by remote attackers with low required user inter action. For demonstration or reproduce ...

Review:  Search ALL
<select class="atkManyToOneRelation" name="atksearch_AE_coordinator_AE_coordinator[]"><option value="">Search all
</option><option value="__NONE__">Nothing selected</option><option value="1
" >"><img src=hacker.jpg onerror=alert(vlabs); />	[X]
, test (manager)</option><option value="2" >


Review: Projects Name
<td valign="top" class="fieldlabel"><b>Project:</b> </td>
<td valign="top" class="field" >
"><img src: "><img src=hacker.jpg onerror=alert(vlabs); />    [X]
</td></tr>


Risk:
=====
1.1
The security risk of the persistant xss vulnerabilities are estimated as medium(+).

1.2
The security risk of the blind sql injection vulnerabilities are estimated as high(+).


Credits:
========
Vulnerability Research Laboratory - Chokri B.A (Me!ster)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases 
or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       - www.vulnerability-lab.com/register
Contact:    admin@...nerability-lab.com 	- support@...nerability-lab.com 	       - research@...nerability-lab.com
Section:    video.vulnerability-lab.com 	- forum.vulnerability-lab.com 		       - news.vulnerability-lab.com
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       - youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   - vulnerability-lab.com/rss/rss_news.php

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other 
media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, sourcecode, videos and 
other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), 
modify, use or edit our material contact (admin@...nerability-lab.com or support@...nerability-lab.com) to get a permission.

    				   	Copyright Â© 2012 | Vulnerability Laboratory



/
/

-- 
VULNERABILITY RESEARCH LABORATORY
LABORATORY RESEARCH TEAM
CONTACT: research@...nerability-lab.com


Content of type "text/html" skipped

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
