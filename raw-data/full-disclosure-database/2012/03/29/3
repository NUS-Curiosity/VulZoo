
Date: Thu, 29 Mar 2012 00:58:06 +0200
From: Research <research@...nerability-lab.com>
To: full-disclosure@...ts.grok.org.uk
Subject: B2Evolution CMS 4.1.3 - Multiple Web
	Vulnerabilities

Title:
======
B2Evolution CMS 4.1.3 - Multiple Web Vulnerabilities


Date:
=====
2012-03-29


References:
===========
http://vulnerability-lab.com/get_content.php?id=482


VL-ID:
=====
482


Introduction:
=============
A powerful free blog/CMS engine you can install on your own website. While it already includes more than the 
traditional blog software features by including file & photo management, versatile skins and multiple blogs... 
b2evolution is actually more than a blog! Content management system oriented features include stand alone pages, 
configurable menus and detailed user & group permissions b2evolution is free, open-source software (GPL), runs on 
virtually any web server featuring PHP + MySQL and is available in several languages.

(Copy of the Vendor Homepage: http://b2evolution.net/ )


Abstract:
=========
A Vulnerability Laboratory Researcher discovered multiple Web Vulnerabilities in B2Evolution 4.1.3.


Report-Timeline:
================
2012-03-25:	Vendor Notification
2012-03-26:	Vendor Response/Feedback
2012-03-29:	Public or Non-Public Disclosure
2012-03-31:	Vendor Fix/Patch by E2B


Status:
========
Published


Affected Products:
==================
Evo Factory
Product: B2Evolution CMS v4.1.3


Exploitation-Technique:
=======================
Remote


Severity:
=========
High


Details:
========
1.1
A remote SQL Injection vulnerability is detected on on JPMs Article Script 6 Web Application.
The vulnerability allows an attacker (remote) or local low privileged user account to injectexecute own sql commands 
on the affected application dbms. Successful exploitation of the vulnerability results in dbms & application compromise.

Vulnerable Module(s) 
				[+] viewfile.php [root=shared_1]

1.2
Multiple persistent input validation vulnerabilities are detected in B2Evolution 4.1.3. 
The bugs allow remote attackers to implement/inject malicious script code on the application side (persistent).
Successful exploitation of the vulnerability can lead to session hijacking (manager/admin) or stable (persistent) 
context manipulation. Exploitation requires low user inter action.

Vulnerable Module(s): (Persistent)

				[+] Send Message


Proof of Concept:
=================
The vulnerabilities can be exploited by remote attackers without- & with low required user inter action. For demonstration or reproduce ...

1.1
User dashboard >> The User choose to show files and then he goes to a link like ...
http://127.0.1.1/b2evolution/blogs/htsrv/viewfile.php?path=monument-valley/bus-stop-ahead.jpg&viewtype=image&root=shared_1[SQL-Injection]
... at the end the attacker can inject his sql commands to compromise the application dbms.

Requirements: Registration as user without application user inter action

1.2
The user can choose any other user to send a message i.e
http://127.0.1.1/b2evolution/blogs/blog1.php?disp=user&user_ID=1 (choosing the admin)
The user can inject html code in the msg itself ... <script>alert(vulnerabilitylab)</script> 
... which is getting execute when message arrives.

Requirements: Send Message as registered User to Admin/Mod/User


Solution:
=========
2012-03-31:	Vendor Fix/Patch (B2E)


Risk:
=====
1.1
The security risk of the sql injection vulnerability is estimated as high(+).

1.2
The security risk of the critical input validation vulnerability is estimated as medium(+).


Credits:
========
Vulnerability Research Laboratory   -    the_storm (the_storm@...l.com)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability-
Lab. Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of 
other media, are reserved by Vulnerability-Lab or its suppliers.

    						Copyright Â© 2012Vulnerability-Lab





_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
