
Date: Wed, 11 Apr 2012 15:30:04 -0400
From: Shatter <shatter@...secinc.com>
To: 'Bugtraq' <bugtraq@...urityfocus.com>, 'Full Disclosure'
	<full-disclosure@...ts.grok.org.uk>
Subject: TeamSHATTER Security Advisory: Privilege
 escalation via internal sql injection in RESTORE DATABASE command

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

AppSecInc Team SHATTER Security Advisory

Privilege escalation via internal sql injection in RESTORE DATABASE command.
	
Risk Level:
Medium

Affected versions:
Microsoft SQL Server 2005, 2008, 2008 R2

Remote exploitable:
Yes

Credits:
This vulnerability was discovered and researched by Martin Rakhmanov of
Application Security Inc.

Details:
RESTORE DATABASE command is prone to internal sql injection allowing
malicious users to run SQL code with highest privileges.
To exploit this vulnerability an attacker must possess CREATE DATABASE
privilege to be able to create and restore database.

Impact:
Users having CREATE DATABASE permission can become system administrators.

Vendor Status:
Vendor was contacted and a patch was released for Microsoft SQL Server 2008.

Workaround:
Revoke CREATE DATABASE privilege from untrusted users.

Fix:
Microsoft SQL Server 2005: no fix planned.
Microsoft SQL Server 2008: apply Service Pack 3.
Microsoft SQL Server 2008 R2: no fix planned.

Links:
https://www.teamshatter.com/?p=3373

Timeline:
Vendor Notification - 2011-05-10
Vendor Response - 2011-05-11
Fix - 2011-11-06
Public Disclosure - 2012-04-11


- - -- 
_____________________________________________
Copyright (c) 2012 Application Security, Inc.
http://www.appsecinc.com


Application Security, Inc's database security solutions have helped over
2000 organizations secure their databases from all internal and external
threats while also ensuring that those organizations meet or exceed
regulatory compliance and audit requirements.


Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct,
indirect, or consequential loss or damage arising from use of, or
reliance on, this information.


-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (MingW32)

iEYEARECAAYFAk+F2mcACgkQRx91imnNIgFleQCfdqvrukds6UQOkTUaI1NlVmSM
ZHUAoJRpX6rA+kHKpnhuqvQVYPlfaCoZ
=U5x6
-----END PGP SIGNATURE-----

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
