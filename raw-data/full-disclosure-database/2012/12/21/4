
Date: Thu, 20 Dec 2012 21:42:09 -0500
From: Michael Rash <mbr@...herdyne.org>
To: full-disclosure@...ts.grok.org.uk
Subject: Re: "Topera" The new IPv6 TCP port scanner
 invisible to SNORT...

On Dec 20, 2012, Rafa Sanchez wrote:

> Hi List!!
> 
> @ggdaniel and I (@r_a_ff_a_e_ll_o), we are proud to introduce you...
> 
> Topera!! the brand new TCP port scanner under IPv6 that is invisible to
> SNORT...
> 
> http://code.google.com/p/topera/
> http://www.iniqua.com/labs/topera-invisible-tcp-scanner/?lang=en
> 
> We encourage everybody to test it and send us feedback.
> 
> Topera is currently evolving and new attacks will be presented soon...

Interesting.  It may be worth noting that in some cases there are
alternatives to Snort that do detect Topera scans - psad-2.2 in its
default configuration detects them when an ip6tables LOG rule does not
use the --log-ip-options switch (which isn't commonly used to begin
with).  The scans are detected as "nmap -sS or -sT", but psad-2.2.1 will
be able to differentiate between nmap and Topera when --log-ip-options
is used:

https://github.com/mrash/psad/commit/574d31aff2702412d78016d509beedf8e866b7db

Here is an example of an ip6tables log message that shows the IP options
trickery:

Dec 20 20:10:40 rohan kernel: [  488.495776] DROP IN=eth0 OUT= \
MAC=00:1b:b9:76:9c:e4:00:13:46:3a:41:36:86:dd \
SRC=3012:1234:1234:0000:0000:0000:0000:0001 \
DST=3012:1234:1234:0000:0000:0000:0000:0002 \
LEN=132 TC=0 HOPLIMIT=64 FLOWLBL=0 OPT ( ) OPT ( ) OPT () OPT ( ) \
OPT ( ) OPT ( ) OPT ( ) OPT ( ) OPT ( ) PROTO=TCP SPT=61287 DPT=1 \
WINDOW=8192 RES=0x00 SYN URGP=0

--Mike


> :)
> 
> Best Regards.
> Rafa Sanchez.

> _______________________________________________
> Full-Disclosure - We believe in it.
> Charter: http://lists.grok.org.uk/full-disclosure-charter.html
> Hosted and sponsored by Secunia - http://secunia.com/

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
