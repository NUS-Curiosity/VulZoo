
Date: Wed, 12 Sep 2012 19:28:57 +0200 (CEST)
From: Mattijs van Ommeren <mattijs@...yon.nl>
To: Undisclosed Recipients <info@...yon.nl>
Subject: Security Advisory AA-007: Command Injection
 Vulnerability in Sitecom Home Storage Center

Security Advisory AA-007: Command Injection Vulnerability in Sitecom Home Storage Center

Severity Rating: High
Discovery Date: July 29, 2012
Vendor Notification: July 30, 2012
Disclosure Date: September 12, 2012

Vulnerability Type=
Command injection

Impact=
System access

Severity=
Alcyon rates the severity of this vulnerability as high due to the following properties:
- Ease of exploitation;
- No authentication credentials required;
- No knowledge about individual victims required;
- No interaction with the victim required.

Products and firmware versions affected=
- Sitecom MD-253 firmware version up to and including 2.4.17
- Sitecom MD-254 firmware version up to and including 2.4.17
- Possibly other rebranded Mapower network storage products

Risk Assessment=
An attacker can execute commands as the root user. This allows for the download and execution of arbitrary binaries and shell scripts to gain complete control over the device.

Vulnerability=
The installer.cgi script allows commands to be injected. A limitation exists in the fact that commands can only exist of characters that are not subject to URL-encoding. However, the hexadecimal representation of the space character (%20) gets converted to a space.

Proof of Concept Exploit=
Paste the following line into a browser address bar to display the device's admin credentials:

  http://<victimIP>/cgi-bin/installer.cgi?SetExecTable&cat%20/etc/sysconfig/config/webmaster.conf

PoC code exploiting this and other vulnerabilities to obtain an interactive root shell can be found here:
  - http://www.alcyon.nl/blog/sitecom-poc-exploit

Risk Mitigation=
At the time of disclosure no updated firmware version was available.

We recommend that you limit access to the web management UI of the device by utilizing proper packet filtering and/or NAT on your router in order to limit network access to your NAS. Note that this will not completely eliminate the risk of exploitation, since the product is affected by other vulnerabilities that can be leveraged using client side attacks.

Vendor responses=
None

Fixed Versions=
There is currently no vendor patch available. A third party solution is available on:
- http://www.alcyon.nl/blog/sitecom-nas-md-253-and-md-254-risk-mitigation/

Latest version of this advisory=
- http://www.alcyon.nl/advisories/aa-008

References=
Security Advisory AA-007: Arbitrary File Upload Vulnerability in Sitecom Home Storage Center
- http://www.alcyon.nl/advisories/aa-007

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
