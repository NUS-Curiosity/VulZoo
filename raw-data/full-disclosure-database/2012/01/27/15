
Date: Fri, 27 Jan 2012 14:52:16 +0100
From: "research@...nerability-lab.com" <research@...nerability-lab.com>
To: full-disclosure@...ts.grok.org.uk, 
	submissions@...ketstormsecurity.org, submit@...sec.com
Subject: Fortigate UTM WAF Appliance - Multiple Web
	Vulnerabilities

Title:
======
Fortigate UTM WAF Appliance - Multiple Web Vulnerabilities


Date:
=====
2012-01-27


References:
===========
http://vulnerability-lab.com/get_content.php?id=144


VL-ID:
=====
144


Introduction:
=============
The FortiGate series of multi-threat security systems detect and eliminate the most damaging, content-based threats from email 
and Web traffic such as viruses, worms, intrusions, inappropriate Web content and more in real time - without degrading 
network performance.

Ranging from the FortiGate-30 series for small offices to the FortiGate-5000 series for large enterprises, service providers and 
carriers, the FortiGate line combines the FortiOS™ security operating system with FortiASIC processors and other hardware to provide 
a comprehensive and high-performance array of security and networking functions including:

    * Firewall, VPN, and Traffic Shaping
    * Intrusion Prevention System (IPS)
    * Antivirus/Antispyware/Antimalware
    * Web Filtering
    * Antispam
    * Application Control (e.g., IM and P2P)
    * VoIP Support (H.323. and SCCP)
    * Layer 2/3 routing
    * Multiple WAN interface options

FortiGate appliances provide cost-effective, comprehensive protection against network, content, and application-level threats - including 
complex attacks favored by cybercriminals - without degrading network availability and uptime. FortiGate platforms incorporate sophisticated 
networking features, such as high availability (active/active, active/passive) for maximum network uptime, and virtual domain (VDOM) 
capabilities to separate various networks requiring different security policies.

(Copy from the Vendor Homepage: http://www.fortinet.com/products/fortigate/ && http://www.avfirewalls.com/)


Abstract:
=========
1.1
Vulnerability-Lab Team discovered multiple persistent Web Vulnerabilities on the FortiGate UTM Appliance Application.

1.2
Vulnerability-Lab Team discovered multiple non-persistent Web Vulnerabilities on the FortiGate UTM Appliance Application.


Report-Timeline:
================
2012-01-27:	Public or Non-Public Disclosure


Status:
========
Published


Affected Products:
==================

Exploitation-Technique:
=======================
Remote


Severity:
=========
High


Details:
========
1.1
Multiple input validation vulnerabilities(persistent) are detected on FortGate UTM Appliance Series. Remote attacker can include (persistent) 
malicious script code to manipulate specific customer/admin requests. The vulnerability allows an local low privileged attacker to  manipulate 
the appliance(application) via persistent script code inject. 

It is also possible to hijack customer sessions via persistent script code execution on application side. Successful exploitation can also 
result in content/module request manipulation, execution of persistent malicious script code, session hijacking, account steal & phishing.


Vulnerable Module(s): (Persistent)
						[+] Endpoint => Monitor => Endpoint Monitor
						[+] Dailup List
						[+] Log&Report => Display

Picture(s):
						../ive2.png
						../ive3.png


1.2
Multiple input validation vulnerabilities(non-persistent) are detected on FortGate UTM Appliance Series. The vulnerability allows remote 
attackers to hijack admin/customer sessions with required user inter action (client-side). Successful exploitation allows to phish user accounts,
redirect over client side requests or manipulate website context on client-side browser requests.

Vulnerable Module(s): (Non-Persistent)
						[+] Endpoint -> NAC -> Application Database -> Listings
						[+] List field sorted

		
			
Picture(s):
						../ive1.png


Proof of Concept:
=================
The vulnerabilities can be exploited by remote attackers with or without user inter action. For demonstration or reproduce  ...

poc: => http://www.vulnerability-lab.com/get_content.php?id=144


Solution:
=========
1.1
To fix/patch the persistent input validation vulnerabilities restrict the input fields & parse the input.
Locate the vulnerable area(s) reproduce the bugs &  parse the output after a malicious(test) insert.
Setup a filter or restriction mask to prevent against future persistent input validation attacks.


1.2
To fix the client side input validation vulnerability parse the vulnerable request by filtering the input & cleanup the output.
Set a input restriction or configure whitelist/filter to stop client side requests and form a secure exception-handling around.


Risk:
=====
1.1
The security risk of the persistent vulnerabilities are estimated as high because of multiple persistent input validation vulnerabilities on different modules. 

1.2
The security risk of the non-persistent cross site requests are estimated as low because of required user inter-action to hijack a not expired session.


Credits:
========
Vulnerability Research Laboratory - Benjamin Kunz Mejri (Rem0ve)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability-
Lab. Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of 
other media, are reserved by Vulnerability-Lab or its suppliers.

    						Copyright © 2012|Vulnerability-Lab




-- 
Website: www.vulnerability-lab.com ; vuln-lab.com or vuln-db.com
Contact: admin@...nerability-lab.com or support@...nerability-lab.com


_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/