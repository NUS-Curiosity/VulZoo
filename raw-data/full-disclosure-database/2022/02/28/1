
Date: Fri, 25 Feb 2022 17:02:16 +0800
From: "YEUNG, Tsz Ko" <tkoyeung@...nect.hku.hk>
To: fulldisclosure@...lists.org
Subject: [FD] Dll Hijacking Vulnerability found in Rufus-3.17.1846 from Akeo
	Consulting

Hi all,

I would like to disclose a vulnerability that I just found today.

Details below:

Vulnerable Software and Version:

   1. Rufus 3.17.1846 executable
   2. Rufus 3.17.1846 portable executable

Vulnerable software download link:
https://rufus.ie/en/

https://github.com/pbatard/rufus/releases/tag/v3.17

Date discovered and reported:
25 Feb 2022

Description:
Both Rufus 3.17.1846 executable AND portable executable are suffering from DLL
Hijacking by placing x86 MSASN1.dll or VERSION.dll in the same directory as
the executables, which could cause arbitrary code execution and privilege
escalation.

Taking MSASN1.dll as an example, craft a malicious x86 DLL with an entry
point with DllMain and place in the same directory, once double click the
executable, an x86 admin shell could be obtained as the executable requires
admin right to run by design.

Attack vector:
Taking MSASN1.dll as an example PoC code of dll can be found in my
repository

Attack steps:

   1.

   Craft and drop a malicious DLL named as "MSASN1.dll" with entry point
   DllMain [image: image]
   <https://user-images.githubusercontent.com/21979646/155570972-1ca622d7-f75e-42ba-b9e5-45eace8fd8d3.png>
   2.

   Double click the executable "Rufus", administrator privilege is required
   to run
   3.

   Malicious DLL has been called and an admin shell can be obtained as
PoC [image:
   image]
   <https://user-images.githubusercontent.com/21979646/155571105-aabc503a-47e9-4489-b6f8-df1aad548b70.png>


This issue has been submitted to github as well and is acknowledged by the
owner,
https://github.com/pbatard/rufus/issues/1877

Thanks and regards,
James Tsz Ko Yeung

_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/
