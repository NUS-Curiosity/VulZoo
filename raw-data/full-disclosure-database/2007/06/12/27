
Date: Tue, 12 Jun 2007 18:16:11 -0400
From: iDefense Labs <labs-no-reply@...fense.com>
To: vulnwatch@...nwatch.org,  full-disclosure@...ts.grok.org.uk, 
	bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 06.12.07: YaBB Forum
 member.vars CRLF Injection Privilege Escalation Vulnerability

YaBB Forum member.vars CRLF Injection Privilege Escalation Vulnerability

iDefense Security Advisory 06.12.07
http://labs.idefense.com/intelligence/vulnerabilities/
Jun 12, 2007

I. BACKGROUND

YaBB (Yet another Bulletin Board) is an Open Source community forum
system written in Perl. More information is available at the following
URL.

http://www.yabbforum.com/

II. DESCRIPTION

Remote exploitation of an input validation error within version 2.1 of
YaBB Forum allows attackers to register with forum Administrator
privileges.

The problem specifically exists due to insufficient validation when
writing to the "vars" file for each user. By setting the values of
certain variables to contain certain characters, attackers can elevate
their privileges to that of the forum Administrator.

III. ANALYSIS

Exploitation allows attackers to obtain Administrator privileges, which
include the ability to modify forum templates (i.e., Perl code). This
allows administrators to execute arbitrary commands in the context of
the web server running the forum.

This attack can be performed during registration. This allows
unauthenticated attackers to obtain forum Administrator privileges at
registration time via the register.pl script.

Additionally, once registered, a forum user can modify their profile and
conduct this attack using the profile.pl script.

IV. DETECTION

iDefense confirmed the existence of this vulnerability within version
2.1 of YaBB Forum.

V. WORKAROUND

Disabling the registration feature of the forum mitigates this issue.

VI. VENDOR RESPONSE

The YaBB Forum team has addressed this vulnerability by releasing a
software update. For more information consult the following announce on
their home site.

http://www.yabbforum.com/community/?board=general;action=display;num=1181678785

VII. CVE INFORMATION

A Mitre Corp. Common Vulnerabilities and Exposures (CVE) number has not
been assigned yet.

VIII. DISCLOSURE TIMELINE

05/23/2007  Initial vendor notification
05/23/2007  Initial vendor response
06/12/2007  Coordinated public disclosure

IX. CREDIT

This vulnerability was reported to iDefense by Peter Vreugdenhil.

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2007 iDefense, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDefense. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically,
please e-mail customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
 There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct,
indirect, or consequential loss or damage arising from use of, or
reliance on, this information.

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/