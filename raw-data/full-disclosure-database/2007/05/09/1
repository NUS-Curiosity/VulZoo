
Date: Tue, 08 May 2007 20:15:43 -0400
From: iDefense Labs <labs-no-reply@...fense.com>
To: vulnwatch@...nwatch.org,  full-disclosure@...ts.grok.org.uk, 
	bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 05.08.07: McAfee
 Security Center IsOldAppInstalled ActiveX Buffer Overflow Vulnerability

McAfee Security Center IsOldAppInstalled ActiveX Buffer Overflow
Vulnerability

iDefense Security Advisory 05.08.07
http://labs.idefense.com/intelligence/vulnerabilities/
May 08, 2007

I. BACKGROUND

McAfee Security Center is a centralized configuration GUI utilized to
control and monitor McAfee Security products such as their AntiVirus,
Firewall and AntiSpam products. More information can be found on the
vendor's site at the following URL.

http://us.mcafee.com/root/product.asp?productid=msc

II. DESCRIPTION

Remote exploitation of a buffer overflow in an ActiveX control
distributed with McAfee Security Center could allow for the execution
of arbitrary code.

When McAfee Security products are installed, they register the following
ActiveX control on the system:

  ProgId: McSubMgr.McSubMgr
  ClassId: 9BE8D7B2-329C-442A-A4AC-ABA9D7572602
  File: MCSUBMGR.DLL, (McAfee Subscription manager module 6.0.0.13)

This control is registered as safe for scripting and contains a buffer
overflow in its IsOldAppInstalled() method.

III. ANALYSIS

Exploitation of this vulnerability is trivial and allows for the
execution of arbitrary code as the currently logged in user.

In order to be successful, attackers would need to convince a victim to
go to a malicious web site. Although this attack requires some social
engineering, the level required is considered minimal.

Publicly available COM object fuzzing tools such as COMRaider can find
this vulnerability using default settings.

Note that this vulnerability is similar to "McAfee Subscription Manager
Stack Buffer Overflow" that was published by eEye Digital Security. At
the time of eEye's publishing, iDefense was aware of two additional
vulnerabilities within this control. One, located in the
GetUserRegisteredForBackend method, appears to have been fixed along
with the issue eEye reported. The other is detailed in this advisory.

IV. DETECTION

iDefense confirmed the existence of this vulnerability using McAfee
Virus Scan 10.0.27 running on Windows XP SP2. However, many additional
McAfee products are reported to install this component.

The vulnerable component includes the versions of the McAfee
Subscription manager module listed below.

  Version 6.x prior to 6.0.0.25
  Version 7.x prior to 7.2.147

V. WORKAROUND

The following workarounds are available for this vulnerability:

  Disable Active Scripting
  Unregister the vulnerable control
  Set the killbit for the vulnerable control

While these workarounds may prevent exploitation they may also adversely
affect the operation of the McAfee product and should only be considered
as short-term workarounds.

VI. VENDOR RESPONSE

"Security Center 7.2.147 and 6.0.25 address the risk associated with
this security flaw. These updates were made available for download on
March 22, 2007. Most consumers will receive the updates automatically.

Consumers who have their McAfee products configured to update
automatically should have already received the appropriate update and
therefore will not need to take further action.

Consumers who have configured their McAfee products to update manually
must run an update."

For information regarding the manual update process, refer to McAfee's
Security Bulletin at the following URL.

http://ts.mcafeehelp.com/faq3.asp?docid=419189

VII. CVE INFORMATION

A Mitre Corp. Common Vulnerabilities and Exposures (CVE) number has not
been assigned yet.

VIII. DISCLOSURE TIMELINE

08/14/2006  Initial vendor notification
10/17/2006  Second vendor notification
02/07/2007  Third vendor notification
02/08/2007  Initial vendor response
05/08/2007  Coordinated public disclosure

IX. CREDIT

This vulnerability was discovered by Peter Vreugdenhil.

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2007 iDefense, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDefense. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically,
please e-mail customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
 There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct,
indirect, or consequential loss or damage arising from use of, or
reliance on, this information.

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
