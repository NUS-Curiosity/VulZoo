
Date: Tue, 24 Apr 2007 11:10:27 +0200
From: Stanislaw Klekot <dozzie@...amit.im.pwr.wroc.pl>
To: full-disclosure@...ts.grok.org.uk, rembrandt <rembrandt@...ith.org>
Subject: Re: OpenSSH - System Account Enumeration if S/Key
	is used

On Sat, Apr 21, 2007 at 02:27:17AM +0200, rembrandt wrote:
> As you can see clearly OpenSSH discloses the existence of system accounts.
> A possible solution for this problem would be to print a fake S/Key-Request
> even for non existing users as well as it`s done with the 
> Passwordauthentication.

This issue is known not only for S/Key, but for OPIE (PAM version) as
well, although it's a bit different for the latter.

Look closer to challenge message. There's salt and key number included.
Consider now three logins: first isn't valid account on the target
system, second is valid but without OTP set, and third with OTP set.
First two are indistinguishable for attacker as in these cases system
presents random challenge, but for third account system will present the
same challenge over and over again.

How about that?

-- 
Stanislaw Klekot

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
