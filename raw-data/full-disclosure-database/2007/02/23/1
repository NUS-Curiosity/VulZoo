
Date: Thu, 22 Feb 2007 19:06:03 -0500
From: iDefense Labs <labs-no-reply@...fense.com>
To: vulnwatch@...nwatch.org,  full-disclosure@...ts.grok.org.uk, 
	bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 02.22.07: IBM DB2
 Universal Database DB2INSTANCE File Creation Vulnerability

IBM DB2 Universal Database DB2INSTANCE File Creation Vulnerability

iDefense Security Advisory 02.22.07
http://labs.idefense.com/intelligence/vulnerabilities/
Feb 22, 2007

I. BACKGROUND

IBM Corp.'s DB2 Universal Database product is a large database server
product commonly used for higher end databases. For more information,
visit http://ibm.com/db2/

II. DESCRIPTION

Local exploitation of a file creation vulnerability in IBM Corp.'s DB2
Universal Database could allow attackers to elevate privileges to the
superuser.

This vulnerability exists due to unsafe file access from within several
setuid-root binaries. Specifically, when supplying the DB2INSTANCE
environment variable, the setuid-root DB2 administration binaries will use
the home directory of the specified user for loading configuration data.
This allows attackers create or append to arbitrary files by creating a
specific executing environment. Additionally, the user's umask settings
will be honored allowing the creation of root-owned world-writable files.

III. ANALYSIS

Successful exploitation allows a local attacker to gain root privileges.

It should be noted that the attacker does not appear to have a great deal
of control over the contents of the data written. However, this does not
significantly impact exploitation.

IV. DETECTION

iDefense has confirmed the existence of this vulnerability within IBM
Corp.'s DB2 Universal Database 9.1 release installed on Linux. Other
versions are suspected to be vulnerable as well.

This vulnerability does not affect DB2 Universal Database running on the
windows platform.

V. WORKAROUND

The best defense against this type of vulnerability is to prevent untrusted
users from having code execution abilities on the respective database
server. The following workarounds also have value.

Use a more strict permissions setting for the DB2 instance directory would
prevent non-instance users from accessing the setuid-root binaries.

Remove the setuid bit from all programs included with DB2.

These configuration changes have not been tested and may cause adverse
behavior.

VI. VENDOR RESPONSE

IBM Corp. has addressed this vulnerability within IBM Universal Database
DB2 9 Fixpack 2. For more information, consult the corresponding IBM APAR
#IY94817 by visiting the following URL.

http://www-1.ibm.com/support/docview.wss?uid=swg21255745

VII. CVE INFORMATION

A Mitre Corp. Common Vulnerabilities and Exposures (CVE) number has not
been assigned yet.

VIII. DISCLOSURE TIMELINE

11/15/2006  Initial vendor notification
01/29/2007  Initial vendor response
02/22/2007  Coordinated public disclosure

IX. CREDIT

The discoverer of this vulnerability wishes to remain anonymous.

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2007 iDefense, Inc.

Permission is granted for the redistribution of this alert electronically.
It may not be edited in any way without the express written consent of
iDefense. If you wish to reprint the whole or any part of this alert in
any other medium other than electronically, please e-mail
customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate at
the time of publishing based on currently available information. Use of
the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on, this
information.

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
