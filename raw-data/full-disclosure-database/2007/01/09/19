
Date: Tue, 9 Jan 2007 12:40:47 -0700
From: "Mark Senior" <senatorfrog@...il.com>
To: Gaus <gaus@...co.com>, "Mark Senior" <senatorfrog@...il.com>, 
	full-disclosure@...ts.grok.org.uk, psirt@...co.com
Subject: Re: Cisco Security Advisory: Multiple
	Vulnerabilities in Cisco Clean Access

Hello Gaus

Thanks for the response, it was quite helpful.  I have a few questions &
comments inline below.

Perhaps you can't comment, which I respect, but I wonder - is there a
general Cisco policy on vulnerability announcements being short on technical
detail like this?  This advisory seemed pretty much standard for advisories
coming from Cisco, which is to say that the reader is often left to draw
inferences, which are not always correct (though perhaps mine were more
incorrect than the average reader's).

Regards
Mark


On 1/9/07, Damir Rajnovic wrote:
>
> Hello Mark,
>
> Sorry for this belated response.
>
> On Thu, Jan 04, 2007 at 11:59:34AM -0700, Mark Senior wrote:
> > Well, that sure was informative.
> >
> > My questions to what the advisory means are below.  Can anyone answer or
> > correct this at all?
>
> I am the person who wrote this advisory so maybe I can help here.
>
> > >Unchangeable Shared Secret
> > >+-------------------------
> > >
> > >In order for Cisco Clean Access Manager (CAM) to authenticate to a
> > >Cisco Clean Access Server (CAS), both CAM and CAS must have the same
> > >shared secret. The shared secret is configured during the initial CAM
> > >and CAS setup. Due to this vulnerability the shared secret can not be
> > >properly set nor be changed, and it will be the same across all
> > >affected devices. In order to exploit this vulnerability the
> > >adversary must be able to establish a TCP connection to CAS.
> >
> >
> > So, other than making a TCP connection to the box, what does the
> attacker
> > need?  Do they need to get the shared secret off some other box in the
> same
> > administrative domain?  How is that shared secret protected, is it
> stored
> > anywhere else an attacker might have easier access to (e.g. on Clean
> > Access-managed clients, on the 'readable snapshots' below)?
>
> Being able to establish a TCP connection is the first requirement. After
> doing so the attacker will be able to talk to CAS and instruct it to do
> whatever (s)he wants it to do. Just finishing three way handshake is not
> sufficent to exploit this.


Just to make sure I'm understanding this - would the attacker need the
shared secret in order to get the CAS to do anything - i.e. are we talking
about a compromise of (the shared secret from) one Clean Access box in an
admin domain being expandable to all the Clean Access boxes in that admin
domain?  Or, is the ability to carry on a TCP conversation sufficient, no
prior access to a shared secret required?

I do not have answer if this is also stored in clients. Will verify and
> get back to you later.
>
> >
> > Unchangeable Shared Secret
> > >+-------------------------
> > >
> > >Successful exploitation of the vulnerability may enable a malicious
> > >user to effectively take administrative control of a CAS. After that,
> > >every aspect of CAS can be changed including its configuration and
> > >setup.
> >
> >
> > For "may", presumably we should read "would, unless the he suddenly fell
> > asleep at the last minute"?  Or are there some additional barriers to
> taking
> > advantage of a successful  exploit?
>
> It is "may" because if you run software release 3.6.1 then your passwords
> are encrypted but you are still affected by both of these issues. On the
> other hand, if you are using version 3.5.8 then your passwords are not
> stored encrypted.
>
>
> > >Readable Snapshots
> > >+-----------------
> > >
> > >The snapshot contains sensitive information that can aide in the
> > >attempts, or be used to compromise the CAM. Among other things, the
> > >snapshot can contain passwords in cleartext. Starting with the
> > >release 3.6.0, passwords are no longer stored in cleartext in the
> > >snapshot files.
> >
> >
> > So, I read this to mean, the snapshot files are still downloadable
> without
> > authentication, still have easily guessable names, and still contain
>
> Not quite. You can not read snapshot files without authentication if you
> are running fixed software (3.5.10 and 3.6.2 and onwards).


Ah, that makes more sense!  I'd missed the fact that 3.6.1 and 3.6.2 were
both mentioned.

> sensitive information that can aid in an attack (what sensitive
> > information?), but now the attacker has password hashes against which he
> has
>
> Information like web server version can aide in an attempt to compromise
> a device.
>
> > to do a three hour offline brute force, or perhaps a twenty second
> rainbow
> > table lookup, rather than getting the plaintext straight off.
>
> You are assuming that we are using the same format as LM. If we would do
> so, then you would be correct that the hash can be cracked in few seconds
> by using rainbow tables. We do not use LM format.


Strictly speaking,  I'm only assuming that the hashes are in a format for
which rainbowtables exist or could be pregenerated - essentially, anything
without a salt (rainbowtables.com has an nice collection).

It is alwasy possible to crack the password using brute force but we hope
> that users are using passwords sufficently long to make this process too
> time consuming.


In practice, I suspect that if the attacker has downloaded the hashes, the
damage is done.  The best you can realistically expect of typical ops groups
is that they will make the attacker wait a week or two, instead of half an
hour.  If you're lucky, you might realize that someone has the hashes and
change all the passwords, and pray your folks didn't just increment the
number at the end of their passwords like usual.

Not that that's Cisco's problem...

Regards,
>
> Gaus
>
>
> ==============
> Damir Rajnovic <psirt@...co.com>, PSIRT Incident Manager, Cisco Systems
> <http://www.cisco.com/go/psirt>      Telephone: +44 7715 546 033
> 200 Longwater Avenue, Green Park, Reading, Berkshire RG2 6GB, GB
> ==============
> There are no insolvable problems.
> The question is can you accept the solution?
>
>
>

Content of type "text/html" skipped

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
