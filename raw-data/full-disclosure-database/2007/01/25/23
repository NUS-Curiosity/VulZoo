
Date: Fri, 26 Jan 2007 02:23:51 +0800
From: "Ethan Hunt" <m34r@...kermail.com>
To: full-disclosure@...ts.grok.org.uk
Subject: Earthlink TotalAccess ActiveX Unsafe Methods
	Vulnerability

Title:
-------------------
Earthlink TotalAccess ActiveX Unsafe Methods Vulnerability


Vendor Contacted:
-------------------
now-ish.


Background Info:
-------------------
Earthlink TotalAccess Download Site: http://www.earthlink.net/software/free/totalaccess/highspeed/


Description:
-------------------
Remote exploitation of an unsafe method call allows remote attackers to add entire individual e-mail addresses or entire domains to the spam whitelist.


Analysis:
-------------------
In order to exploit this vulnerability an attacker would have to entice a user to visit a webpage.

The affected DLL is: C:\Program Files\EarthLink TotalAccess\SpamBlocker.dll with CLSID: 3D6A4D0C-66AC-46D4-ACE1-75A1D7E579D8

It is marked safe for scripting:
    RegKey Safe for Script: True
    RegKey Safe for Init: False
    Implements IObjectSafety: True

and has the following interesting methods:

AddDomainToWhitelist
    Sub AddDomainToWhiteList (
     ByVal sDomain  As String ,
     ByVal bShowConfirmation  As Boolean
    )
    
AddSenderToWhitelist
    Sub AddSenderToWhiteList (
     ByVal sEmailList  As String ,
     ByVal sDisplayName  As String ,
     ByVal bShowConfirmation  As Boolean ,
     ByVal sSyncId  As String
    )



Might have some form of validation, but it sure doesn't appear so.

-- 
_______________________________________________
Get your free email from http://www.hackermail.com

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
