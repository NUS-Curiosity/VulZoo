
Date: Tue, 17 Jul 2007 15:41:55 +0200
From: MgpF <mf@...teoflora.com>
To: full-disclosure@...ts.grok.org.uk,  bugtraq@...urityfocus.com
Subject: [0x70xC] Open Redirector ADSERVER.LIBERO.IT



### VULNERABILITY INTERNAL IDENTIFICATION NUMBER: 0x70xC

- - - - - - ---------------------------------------------------
DESCRIPTION
- - - - - - ---------------------------------------------------

An XSS OPEN REDIRECTOR vulnerability  has been found on
Libero's ADServer, the Advertising platform used by the
most important italian portal, which servers millions of
adv each day.

The vulnerability can be found in the "Click" action of Libero's
Advertising system, and the affected functionality an unchecked
parameter named "key" in "adv_clickbanner" page/function.

By changing the "key" parameter it is possible to arbitrarily
redirect a user to any  site the attecher want to use. Affected
payload is:

1) arbitrary redirection for Phishing purpose
2) malicious page cloacking
3) virus/malware diffusion through known pages

The normal URL would be something linked like this:

<http://adserver.libero.it/cgi-bin/adv_clickbanner/id=61452;tf=7;
sid=49098;fill=A;site=IolMainSite;key=?XXX>

where "XXX" is the page to be redirected to.

- - - - - - ---------------------------------------------------
POC
- - - - - - ---------------------------------------------------

By changing the parameter it is possible to alter the drop page.
For example:

<http://adserver.libero.it/cgi-bin/adv_clickbanner/id=61452;tf=7;
sid=49098;fill=A;site=IolMainSite;key=?http:///www.matteoflora.com>

will redirect the user to "http://www.matteoflora.com".

A POC url is available (until not deleted or fixed) here:

<http://adserver.libero.it/cgi-bin/adv_clickbanner/id=61452;tf=7;
sid=49098;fill=A;site=IolMainSite;key=?http:///www.matteoflora.com>

- - - - - - ---------------------------------------------------
SOLUTION
- - - - - - ---------------------------------------------------

Forcibly checking the parameter value to be an internal page can
easly solve the problem, while the better idea is probably to
use a lookup table or URLs used and passing only an ID.
The latter solution is widely used in other adv platforms.

An IN DEPTH review of the code by an Application Security Expert
is STRONGLY suggested.

- - - - - - ---------------------------------------------------
CONCLUSION
- - - - - - ---------------------------------------------------

The impact of this vulnerability is HIGH for PHISHING and
SCAM pourpose and VERY LOW for system integrity.

Greetings,
MgpF

- - - - - - ---------------------------------------------------
TIMELINE
- - - - - - ---------------------------------------------------

Initial Finding   : 2007-04-20
VENDOR DISCLOSURE : 2007-07-05
VENDOR Solving 	  : 2007-07-16
PUBLIC DISCLOSURE : 2007-07-17

- - - - - - --
Matteo G.P. Flora   | mf@...teoflora.com | www.MatteoFlora.com
Sec & Forensics Guy | PGP F3B6BC10       | blog www.LastKnight.com

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
