
Date: Wed, 11 Jul 2007 17:19:41 -0400
From: iDefense Labs <labs-no-reply@...fense.com>
To: vulnwatch@...nwatch.org,  full-disclosure@...ts.grok.org.uk, 
	bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 07.11.07: SquirrelMail
 G/PGP Plugin gpg_help.php Local File Inclusion Vulnerability

SquirrelMail G/PGP Plugin gpg_help.php Local File Inclusion Vulnerability

iDefense Security Advisory 07.11.07
http://labs.idefense.com/intelligence/vulnerabilities/
Jul 11, 2007

I. BACKGROUND

The SquirrelMail G/PGP Encrpytion Plugin is a general purpose
encryption, decryption, and digital signature plug-in for SquirrelMail
that implements the OpenPGP standard using GPG. More information is
available at the following URL.

http://www.squirrelmail.org/plugin_view.php?id=153

II. DESCRIPTION

Remote exploitation of a local file inclusion vulnerability in version
2.0 of the SquirrelMail G/PGP Plugin could allow an authenticated
webmail user to execute arbitrary PHP code under the security context
of the running web server.

Version 2.0 of the SquirrelMail G/PGP Plugin contains an implementation
flaw in the way it includes certain files. Specifically, the
'gpg_help.php' and 'gpg_help_base.php' files will include local files
that are supplied via the 'help' HTTP GET request parameter. An excerpt
from the code follows:

    68  // Help body text is inserted here via GET parameter
    69  require_once (SM_PATH.'plugins/gpg/help/' . $_GET['help'] );

By using directory traversal specifiers, an attacker can trivially cause
files stored on the Web server to be parsed as PHP code.

III. ANALYSIS

Exploitation could allow an attacker to include an arbitrary local file
on the affected host.

Due to the lack of input validation on $GET_['help'], directory
traversal specifiers could be utilized to parse any file on the system
as PHP code.

IV. DETECTION

iDefense has confirmed the existence of this vulnerability in version
2.0 of the G/PGP Encryption Plugin for SquirrelMail. It is suspected
that earlier versions of the plug-in are also affected.

V. WORKAROUND

iDefense is unaware of any available workarounds for this vulnerability.

VI. VENDOR RESPONSE

The maintainers of the SquirrelMail G/PGP plug-in have not responded to
repeated inquires regarding this vulnerability. Versions since
gpg.2.1devbuild14Jun07 appear to include a fix for this problem. This
problem is not present in the recent 2.1 release made on July 7th,
2007.

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2006-4169 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org/), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

08/16/2006  Initial vendor notification
10/06/2006  Second vendor notification
02/16/2007  Third vendor notification
07/11/2007  Public disclosure

IX. CREDIT

The discoverer of this vulnerability wishes to remain anonymous.

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2007 iDefense, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDefense. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically,
please e-mail customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
 There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct,
indirect, or consequential loss or damage arising from use of, or
reliance on, this information.

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
