
Date: Thu, 29 Mar 2007 15:04:01 -0400
From: iDefense Labs <labs-no-reply@...fense.com>
To: vulnwatch@...nwatch.org,  full-disclosure@...ts.grok.org.uk, 
	bugtraq@...urityfocus.com
Subject: iDefense Security Advisory 03.29.07: IBM Lotus
 Sametime JNILoader Arbitrary DLL Load Vulnerability

IBM Lotus Sametime JNILoader Arbitrary DLL Load Vulnerability

iDefense Security Advisory 03.29.07
http://labs.idefense.com/intelligence/vulnerabilities/
Mar 29, 2007

I. BACKGROUND

IBM Corp.'s Lotus Sametime product provides a real-time online conferencing
solution. More information on the product can be found on IBM Corp.'s
website
at the following URL.

http://ibm.com/software/info/lotus/sametime/

II. DESCRIPTION

Remote exploitation of a input validation vulnerability in IBM Corp.'s Lotus
Sametime allows attackers to execute arbitrary code in the context of the
user viewing a malicious web page.

The problem specifically exists in the STJNILoader.ocx component of IBM
Corp.'s Lotus Sametime product. This ActiveX control is safe for scripting
and exports a LoadLibrary function that does not properly sanitize input.

This control uses the following class identifiers:
{7261EE42-318E-490A-AE8F-77649DBA1ECA} and
{0B9C9C7D-ED81-4594-AFCB-FC5588125382}

III. ANALYSIS

Exploitation allows attackers to execute arbitrary code in the context
of the
user viewing a malicious web page.

Varying levels of social engineering are required for successful
exploitation.
The attacker must get a malicious library onto the victims site as well
as get
them to visit a malicious web site.

Any local file name or valid UNC path can be used as a library to be loaded.
The file extension does not have any affect on whether or not this control
will load the specified library.

IV. DETECTION

iDefense has confirmed that this vulnerability is present in IBM Corp.'s
Lotus
Sametime STJNILoader.ocx version 3.1.0.26.

It is important to note that the Lotus Sametime product does not have to be
installed for a system to be vulnerable. Only the STJNILoader.ocx must be
installed. If it is not installed, the user will be prompted to install
it at
the time of exploitation.

V. WORKAROUND

Exploitation can easily be mitigated by disabling active content support
within the browser. Take note that employing this workaround could adversely
affect websites that rely upon the execution of browser-based script code.

Setting the kill-bit for the previously mentioned CLSIDs will prevent this
control from loading within Internet Explorer. Mozilla Firefox does not
contain ActiveX support in it's default configuration.

VI. VENDOR RESPONSE

The IBM Lotus Sametime team has addressed this issue by removing the
affected
ActiveX control from the current version of their product. Additionally they
have provided hotfixes for older versions. More information is available
from
IBM Technote swg21257029 which can be found at the following URL.

http://www-1.ibm.com/support/docview.wss?uid=swg21257029

VII. CVE INFORMATION

A Mitre Corp. Common Vulnerabilities and Exposures (CVE) number has not
been assigned yet.

VIII. DISCLOSURE TIMELINE

08/01/2006  Initial vendor notification
08/01/2006  Initial vendor response
03/29/2007  Coordinated public disclosure

IX. CREDIT

This vulnerability was reported to iDefense by Andrew Christensen of
FortConsult ApS.

Get paid for vulnerability research
http://labs.idefense.com/methodology/vulnerability/vcp.php

Free tools, research and upcoming events
http://labs.idefense.com/

X. LEGAL NOTICES

Copyright Â© 2007 iDefense, Inc.

Permission is granted for the redistribution of this alert electronically.
It may not be edited in any way without the express written consent of
iDefense. If you wish to reprint the whole or any part of this alert in
any other medium other than electronically, please e-mail
customerservice@...fense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate at
the time of publishing based on currently available information. Use of
the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on, this
information.

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
