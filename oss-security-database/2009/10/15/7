
Date: Thu, 15 Oct 2009 15:15:57 +0200
From: Julien Tinnes <jt@....org>
To: oss-security@...ts.openwall.com
Cc: "Steven M. Christey" <coley@...us.mitre.org>
Subject: Re: CVE request: oping allows the disclosure of 
	arbitrary file contents

On Mon, Sep 28, 2009 at 2:45 PM, Steve Kemp <steve@...ve.org.uk> wrote:
>  oping is setuid root application and one of the command line arguments allows
>  a configuration file to be specified.  This file is read and *reported*
>  to the console - Unless the file is lucky enough to look like a list
>  of hostnames.
>
>  Brief details here:
>
>        http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=548684

Hi,

in case anyone cares, oping also attempts to drop privileges with
setuid(getuid()); without checking setuid()'s return value.

It's an obvious vulnerability, because a local attacker can make
setuid() fail by setting a resource limit of 0 for RLIMIT_NPROC with
setrlimit().

Julien
