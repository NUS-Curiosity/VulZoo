
Date: Mon, 09 Nov 2009 12:39:29 +0800
From: Eugene Teo <eugeneteo@...nel.sg>
To: oss-security@...ts.openwall.com
CC: "Steven M. Christey" <coley@...us.mitre.org>
Subject: CVE request - kernel: NOMMU: Dont pass NULL pointers to fput() in
 do_mmap_pgoff()

 From upstream patch:
"Don't pass NULL pointers to fput() in the error handling paths of the 
NOMMU do_mmap_pgoff() as it can't handle it.

The following can be used as a test program:
int main() { static long long a[1024 * 1024 * 20] = { 0 }; return a;}

Without the patch, the code oopses in atomic_long_dec_and_test() as 
called by fput() after the kernel complains that it can't allocate that 
big a chunk of memory.  With the patch, the kernel just complains about 
the allocation size and then the program segfaults during execve() as 
execve() can't complete the allocation of all the new ELF program segments."

http://git.kernel.org/linus/89a8640279f8bb78aaf778d1fc5c4a6778f18064

Doesn't affect if CONFIG_MMU=y.

Thanks, Eugene
