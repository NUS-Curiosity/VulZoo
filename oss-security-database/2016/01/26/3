
Date: Tue, 26 Jan 2016 09:05:46 +0100
From: Sergei Golubchik <serg@...iadb.org>
To: oss-security@...ts.openwall.com
Subject: Flaw in mariadb clients SSL certificate validation

Hi,

MariaDB (as well as MySQL and Percona Server) has an option to validate
server certificate, when establishing an SSL connection. It checks that
the certificate belongs to the host that the client wants to connect to.
This validation, of course, should normally always be enabled to prevent
MITM attacks.

Recently (end of November) two security researchers Paul Kehrer and Alex
Gaynor have found a flaw in this certificate validation code that allows
to trick it into accepting certificate from other hosts. For example,
if the host 'foo.com' has a certificate with the "Organizational Unit"
being, say, "/CN=bar.com", then MariaDB client will see the result as

   /OU=/CN=bar.com/CN=foo.com

and will think that this certificate belongs to bar.com. This bugs is in
15 year old code and is present in all MariaDB/MySQL/Percona Server
versions. 

This vulnerability got CVE-2016-2047.

It is fixed in MariaDB 5.5.47, MariaDB 10.0.23, MariaDB 10.1.10
(all released in December).

Regards,
Sergei
Chief Architect MariaDB
and security@...iadb.org
