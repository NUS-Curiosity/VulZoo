
Date: Wed, 15 Nov 2017 21:30:40 +0100
From: Salvatore Bonaccorso <carnil@...ian.org>
To: OSS Security Mailinglist <oss-security@...ts.openwall.com>
Subject: collectd: CVE-2017-16820: snmp-plugin: double free of request PDU

Hi

Collectd's snmp-plugin is prone to a double free vulneability. This
issue was made aware to the Debian security team, but turned out to be
public already in. MITRE has assigned CVE-2017-16820 for it. The snmp
plugin contains a double-free vulnerability in the
snmp_sess_synch_response() function. Commit message:

>  snmp plugin: Fix double free of request PDU
>
> snmp_sess_synch_response() always frees request PDU, in both case of request
> error and success. If error condition occurs inside of `while (status == 0)`
> loop, double free of `req` happens.

Upstream issue:
https://github.com/collectd/collectd/issues/2291

Fix:
https://github.com/collectd/collectd/commit/d16c24542b2f96a194d43a73c2e5778822b9cb47
(might need the followup commits to clean up)

Regards,
Salvatore
