
Date: Wed, 23 Jun 2010 11:11:19 +0200
From: Ludwig Nussel <ludwig.nussel@...e.de>
To: oss-security@...ts.openwall.com
Cc: Lennart Poettering <lennart@...ttering.net>
Subject: CVE Request: avahi DoS

Hi,

avahi crashes if it receives a bad packet (broken checksum)
immediately followed by a good packet. In that case FIONREAD returns
zero size for the bad packet. avahi doesn't consider that an error
and calls recvmsg() which succeeds and returns the good packet which
has a non-zero length of course. This discrepancy causes an assert()
to fail and avahi terminates.

The problem was acknowledged by upstream (Lennart) but no fix
was commited so far. I've attached my patch proposal.

cu
Ludwig

-- 
 (o_   Ludwig Nussel
 //\   
 V_/_  http://www.suse.de/
SUSE LINUX Products GmbH, GF: Markus Rex, HRB 16746 (AG Nuernberg)

View attachment "0001-ignore-packet-if-FIONREAD-returns-zero.diff" of type "text/x-patch" (1200 bytes)
