
Date: Tue, 16 Jul 2013 01:25:13 +0200
From: Petr Matousek <pmatouse@...hat.com>
To: oss-security@...ts.openwall.com
Subject: CVE Request -- spice: unsafe clients ring access abort

Currently, both red_channel_pipes_add_type() and
red_channel_pipes_add_empty_msg() use plaing RING_FOREACH() which is not
safe versus removals from the ring within the loop body. Yet, when
(network) error does occur, the current item could be removed from the
ring down the road and the assertion in RING_FOREACH()'s ring_next()
could trip, causing the process containing the spice server to abort.

An user able to initiate spice connection to the guest could use this
flaw to crash the guest.

Upstream fix:
http://cgit.freedesktop.org/spice/spice/commit/?id=53488f0275d6c8a121af49f7ac817d09ce68090d

References:
https://bugzilla.redhat.com/show_bug.cgi?id=984769

Thanks,
-- 
Petr Matousek / Red Hat Security Response Team
