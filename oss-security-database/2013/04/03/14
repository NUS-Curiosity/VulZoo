
Date: Wed, 3 Apr 2013 16:43:00 -0600
From: Vincent Danen <vdanen@...hat.com>
To: oss-security@...ts.openwall.com
Subject: CVE request: rpc-gssd is vulnerable to DNS spoofing

This has been discussed on the linux-nfs mailing list, so fully public.
Just cutting and pasting from our bugzilla:

It was reported [1],[2] that rpc.gssd in nfs-utils is vulnerable to DNS
spoofing due to it depending on PTR resolution for GSSAPI
authentication.  Because of this, if a user where able to poison DNS to
a victim's computer, they would be able to trick rpc.gssd into talking
to another server (perhaps with less security) than the intended server
(with stricter security).  If the victim has write access to the second
(less secure) server, and the attacker has read access (when they
normally might not on the secure server), the victim could write files
to that server, which the attacker could obtain (when normally they
would not be able to).  To the victim this is transparent because the
victim's computer asks the KDC for a ticket to the second server due to
reverse DNS resolution; in this case Krb5 authentication does not fail
because the victim is talking to the "correct" server.

A patch that prevents this issue has been posted [3].

To workaround this issue, set the IP/host pair in /etc/hosts so that it
cannot be spoofed.

A good explanation is also available here [4].

[1] http://marc.info/?l=linux-nfs&m=136491998607561&w=2
[2] http://marc.info/?l=linux-nfs&m=136500502805121&w=2
[3] http://marc.info/?l=linux-nfs&m=136493115612397&w=2
[4] http://ssimo.org/blog/id_015.html


https://bugzilla.redhat.com/show_bug.cgi?id=948072


Since this is fairly new, I don't think a CVE would have been requested
already.  Could one be assigned to this?

-- 
Vincent Danen / Red Hat Security Response Team 
