
Date: Wed, 17 Apr 2013 14:32:36 -0400
From: Daniel Kahn Gillmor <dkg@...thhorseman.net>
To: oss-security@...ts.openwall.com
CC: Kurt Seifried <kseifried@...hat.com>, Thomas Biege <thomas@...e.de>
Subject: Re: debian: gpg --verify suggests entire file was
 verified, even if file contains auxiliary data

On 04/17/2013 02:23 PM, Kurt Seifried wrote:
> I've run into this before, sadly enigmail (Thunderbird gpg plugin)
> displays the same green bar for message signed ok, but displays the
> text as "Part of the message signed" so unless you're really paying
> attention, you'll miss it.
> 
> My thinking is this:
> 
> 1) It's pretty easy to find signed content for people using GPG
> 2) It's pretty easy to append/embed signed content into a larger message
> 
> So the attack would be: create malicious content/email, embed/append a
> valid message harvested from somewhere. Send to user. The user
> verifies then reads the message, unless they are really paying
> attention they probably won't notice that the content isn't signed
> properly (e.g. have an email, ton of whitespace, then the signed
> message). Personally I'm inclined to assign a CVE, enigmail for
> example does mostly the right thing (makes a distinction between fully
> signed and partially signed). I think GPG should too.
> Thoughts/comments before I assign this?

A similar attack (related to PGP/MIME) has been under discussion on the
enigmail list last month.  see the thread starting at:

 https://lists.enigmail.net/pipermail/enigmail-users_enigmail.net/2013-March/000721.html

I think the enigmail issues are distinct from the gpg issues, and i
don't think they should be conflated into the same CVE.

In particular, i see the enigmail issues as (security-related) UI/UX
problems, but i see the gpg problems as (security-related)
API/programmatic-use problems.

By comparison with enigmail, thunderbird's native S/MIME verification
routines display no cryptographic indicators at all if only part of a
message is signed.  This means that S/MIME-signed messages sent through
common mailing list software which attaches a text/plain MIME footer
(like mailman) will not indicate that they are verifiable at all.

it's not a pretty set of tradeoffs. :/

	--dkg


Download attachment "signature.asc" of type "application/pgp-signature" (1028 bytes)
