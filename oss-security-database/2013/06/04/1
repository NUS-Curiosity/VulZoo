
Date: Tue, 4 Jun 2013 08:51:05 -0400 (EDT)
From: Jan Lieskovsky <jlieskov@...hat.com>
To: oss-security@...ts.openwall.com
Cc: "Steven M. Christey" <coley@...us.mitre.org>
Subject: CVE Request -- Gallery < 3.0.8 - Improper stripping of URL
 fragments in uploadify and flowplayer SWF files might lead to replay
 attacks

Hello Kurt, Steve, vendors,

  Gallery 3 upstream has released v3.0.8 version:
  [1] http://sourceforge.net/mailarchive/message.php?msg_id=30925931
  [2] http://galleryproject.org/gallery_3_0_8

correcting one security flaw (or two if you would consider uploadify
and flowplayer SWF files as two separate cases):

A security flaw was found in the way uploadify and flowplayer SWF files
handling functionality of Gallery version 3, an open source project with
the goal to develop and support leading photo sharing web application
solutions, processed certain URL fragments passed to these files (certain
URL fragments were not stripped properly when these files were called
via direct URL request(s)). A remote attacker could use this flaw to
conduct replay attacks.

Relevant upstream tickets (and patches):
* uploadify case:
  [3] http://sourceforge.net/apps/trac/gallery/ticket/2068
  [4] https://github.com/gallery/gallery3/commit/80bb0f2222dd99ed2ce59e804b833bab63cc376a

* flowplayer case:
  [5] http://sourceforge.net/apps/trac/gallery/ticket/2070
  [6] https://github.com/gallery/gallery3/commit/3e5bba2cd4febe8331c0158c11ea418f21c72efa
  [7] https://github.com/gallery/gallery3/commit/12e51694fdc39c752cc439424cf309866f9f914a

References:
[8] https://bugzilla.redhat.com/show_bug.cgi?id=970596

Could you allocate a CVE id for this?

Thank you && Regards, Jan.
--
Jan iankko Lieskovsky / Red Hat Security Response Team
