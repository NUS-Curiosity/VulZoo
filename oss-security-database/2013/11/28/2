
Date: Wed, 27 Nov 2013 22:37:57 +0100
From: Manuel Nickschas <sputnick@...ssel-irc.org>
To: oss-security@...ts.openwall.com
Subject: CVE Request: Quassel IRC - manipulated clients can access backlog of all users on a shared core

Hi all,

I'd like to request a CVE for the following vulnerability in Quassel IRC:

Affected versions: all versions prior to 0.9.2 (released 2013-11-26)

Description:

A Quassel core (server daemon) supports being used by multiple users, who all 
have independent settings, backlog and so on. The backlog is stored in a 
database shared by all users on a Quassel core, tagged with a user ID. 
However, some SQL queries didn't check for the correct user ID being provided.

This has the undesired effect that the Quassel core can be tricked into 
providing the backlog for an IRC channel or query that does not belong to the 
user session requesting it. Doing this requires a manipulated client sending 
appropriately crafted requests to the core. This client also needs to be 
properly authenticated, i.e. to have supplied valid user credentials for one 
of the users on the core.

Credit for finding this issue goes to Andrew Hampe.

Fix [1] has been released in 0.9.2 [2].

This patch can be cleanly applied to any version starting from 0.6.0, and 
easily backported to even older versions by adapting the schema version 
number.

Thanks,
~ Manuel Nickschas (Sput)

[1] <https://github.com/quassel/quassel/commit/a1a24da>
[2] <http://quassel-irc.org/pub/quassel-0.9.2.tar.bz2>
