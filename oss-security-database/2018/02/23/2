
Date: Fri, 23 Feb 2018 00:33:21 +0000
From: Mark Thomas <markt@...che.org>
To: oss-security@...ts.openwall.com
Subject: Fwd: [SECURITY] CVE-2018-1304 Security constraints mapped to context
 root are ignored

-------- Forwarded Message --------
Subject: [SECURITY] CVE-2018-1304 Security constraints mapped to context
root are ignored
Date: Fri, 23 Feb 2018 00:27:30 +0000
From: Mark Thomas <markt@...che.org>
Reply-To: announce@...cat.apache.org, announce@...cat.apache.org
To: Tomcat Users List <users@...cat.apache.org>
CC: Tomcat Developers List <dev@...cat.apache.org>, announce@...che.org,
announce@...cat.apache.org <announce@...cat.apache.org>

CVE-2018-1304 Security constraints mapped to context root are ignored

Severity: High

Vendor: The Apache Software Foundation

Versions Affected:
Apache Tomcat 9.0.0.M1 to 9.0.4
Apache Tomcat 8.5.0 to 8.5.27
Apache Tomcat 8.0.0.RC1 to 8.0.49
Apache Tomcat 7.0.0 to 7.0.84

Description:
The URL pattern of "" (the empty string) which exactly maps to the
context root was not correctly handled when used as part of a security
constraint definition. This caused the constraint to be ignored. It was,
therefore, possible for unauthorised users to gain access to web
application resources that should have been protected. Only security
constraints with a URL pattern of the empty string were affected.

Mitigation:
Users of the affected versions should apply one of the following
mitigations:
- Review security constraints and confirm none use a URL patten of ""
  (the empty string)
- Upgrade to Apache Tomcat 9.0.5 or later
- Upgrade to Apache Tomcat 8.5.28 or later
- Upgrade to Apache Tomcat 8.0.50 or later
- Upgrade to Apache Tomcat 7.0.85 or later

Credit:
This issue was reported publicly as bug 62067 and the security
implications identified by the Apache Tomcat Security Team.

History:
2018-02-23 Original advisory

References:
[1] http://tomcat.apache.org/security-9.html
[2] http://tomcat.apache.org/security-8.html
[3] http://tomcat.apache.org/security-7.html

