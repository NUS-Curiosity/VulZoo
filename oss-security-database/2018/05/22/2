
Date: Tue, 22 May 2018 21:06:53 +0200
From: Florian Weimer <fw@...eb.enyo.de>
To: Matthew Fernandez <matthew.fernandez@...il.com>
Cc: oss-security@...ts.openwall.com,  Christian Brabandt <cb@...bit.org>
Subject: Re: PGP/MIME and S/MIME mail clients vulnerabilities

* Matthew Fernandez:

> I presume what Florian is asking about is Content-ID links [0]. One
> purpose of CID links is to include images as a message part and then
> reference them from the HTML email content. I would think a CID URL
> would not be immediately vulnerable to the “direct exfiltration”
> attack because it shouldn’t result in a network fetch; just a lookup
> locally. However, RFC 2392 requires the IDs to be “globally unique”
> and some mail clients (e.g. iOS Mail) take the RFC at its word and
> render images from CID URLs that reference content included in
> entirely distinct emails in your mailbox. Perhaps the attacker can
> hide their payload within a message part with the chosen ID included
> in another email.

Or they can alter the displayed content of a signed message with a
colliding cid: URL, assuming the ones generated by the original client
are not unpredictable (and you might actually have many tries within
the same crafted message).

There could also be some automated exfiltration angles, but those
probably rely on client HTML rendering bugs, so they don't really
count.
