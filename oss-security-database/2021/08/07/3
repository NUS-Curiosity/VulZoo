
Date: Sat, 7 Aug 2021 04:49:39 +0200
From: Axel Beckert <abe@...ian.org>
To: Thorsten Glaser <tg@...bsd.de>
Cc: oss-security@...ts.openwall.com, security@...ian.org
Subject: Re: bug in Lynx' SSL certificate validation -> leaks password in
 clear text via SNI (under some circumstances)

Hi Thorsten,

I'm dropping the lynx-specific recipients, i.e. lynx-dev and the bug
report…

Thorsten Glaser wrote:
> Axel Beckert dixit:
> > This is more severe than it initially looked like: Due to TLS Server
> > Name Indication (SNI) the hostname as parsed by Lynx (i.e with
> > "user:pass@" included) is sent in _clear_ text over the wire even
> 
> I *ALWAYS* SAID SNI IS A SHIT THING […]

Don't blame the messenger. ;-)

> Other browsers also need checking.

Good idea.

I just checked in Debian Unstable those tools I'd mostly expect with
such URLs and commandline usage:

* Axel (sic! :-) 2.17.10-2
* ELinks 0.13.2-1+b1
* LibWWW-Perl (aka LWP) 6.53-1 via /usr/bin/GET
* Links/Links2 2.21-1+b1
* Wget (1.21-1+b1)
* Wget2 (1.99.1-2.2)

I didn't find any such issue in any of these tools. All cases verified
via Wireshark's "follow TCP stream" against an Apache 2.4.48 (from
Debian Unstable as well).

But yeah, there are probably many more to check. But so far it looks
like a lynx-specific issue.

> Thanks for the detective work,

You're welcome. Thanks for stumbling over this issue and triggering my
digging. :-)

		Regards, Axel
-- 
 ,''`.  |  Axel Beckert <abe@...ian.org>, https://people.debian.org/~abe/
: :' :  |  Debian Developer, ftp.ch.debian.org Admin
`. `'   |  4096R: 2517 B724 C5F6 CA99 5329  6E61 2FF9 CD59 6126 16B5
  `-    |  1024D: F067 EA27 26B9 C3FC 1486  202E C09E 1D89 9593 0EDE

Download attachment "signature.asc" of type "application/pgp-signature" (834 bytes)
