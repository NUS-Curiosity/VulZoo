
Date: Mon, 8 Feb 2021 13:28:57 +0100
From: Greg KH <greg@...ah.com>
To: oss-security@...ts.openwall.com
Cc: alex.gaynor@...il.com
Subject: Re: CVE-2021-20226 kernel: use-after-free in io_uring
 feature

On Mon, Feb 08, 2021 at 03:00:18PM +0530, Rohit Keshri wrote:
> Hello,
> 
> The flaw CVE-2021-20226 is identified as a use-after-free problem with
> breach to data integrity, confidentiality and system availability, and
> this may even cause escalated privileges with good troubleshooting
> skills.
> 
> 
> I also wanted to add that the affected souce (as was reported for
> kernel v5.7.0) has been modified from v5.10 kernel version with patch
> 233295130e53 with following cleanup details.
> 
> ~~~
> 
> $ git show 233295130e53
> commit 233295130e53c8dfe6dbef3f52634c3f7e44cd6a
> Author: Pavel Begunkov <asml.silence@...il.com>
> Date:   Sat Oct 10 18:34:06 2020 +0100
> 
>     io_uring: clean up ->files grabbing
> 
>     Move work.files grabbing into io_prep_async_work() to all other work
>     resources initialisation. We don't need to keep it separately now, as
>     ->ring_fd/file are gone. It also allows to not grab it when a request
>     is not going to io-wq.
> ..
> 
> $ git tag --contains 233295130e53
> v5.10
> v5.10-rc1
> v5.10-rc2
> v5.10-rc3
> v5.10-rc4
> v5.10-rc5
> v5.10-rc6
> v5.10-rc7
> v5.11-rc1
> v5.11-rc2
> v5.11-rc3
> v5.11-rc4
> v5.11-rc5
> v5.11-rc6
> v5.11-rc7

That's odd, don't use `git tag --contains`, the better thing to do is:

$ git describes --contains 233295130e53
v5.10-rc1~167^2~10

Which means is showed up in the tree in the 5.10-rc1 release, so
anything newer than that is fine.

Note, this does not include tests for backports to stable kernel
releases or distro kernels.  That kind of query is left as an exercise
for the reader :)

Hope this helps,

greg k-h
