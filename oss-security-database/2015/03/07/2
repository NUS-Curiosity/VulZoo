
Date: Sat, 07 Mar 2015 11:56:42 +0000
From: Jo Shields <directhex@...box.org>
To: oss-security@...ts.openwall.com
Subject: Mono TLS vulnerabilities


Hi

A TLS impersonation attack was discovered in Mono's TLS stack by
researchers at Inria. During checks on our TLS stack, we have
discovered two further issues which we have fixed - SSLv2 support, and
vulnerability to FREAK. These vulnerabilities affect basically every
Mono version ever released.

All three issues should be addressed in the following patches:

https://github.com/mono/mono/commit/1509226c41d74194c146deb173e752b8d3cdeec4
https://github.com/mono/mono/commit/9c38772f094168d8bfd5bc73bf8925cd04faad10
https://github.com/mono/mono/commit/b371da6b2d68b4cdd0f21d6342af6c42794f998b

These patches should apply to all Mono versions from 3.4.0 or so
onwards. The EXPORT cipher removal patch requires slight modification
in order to apply to Mono releases prior to 3.x -
https://gist.github.com/directhex/728af6f96d1b8c976659 should work for
these users. The Impersonation patch requires slight modification to
apply to Mono releases prior to 3.4 -
https://gist.github.com/directhex/f8c6e67f551d8a608154 should work for
these users.

Alternatively, this is fixed in Mono 3.12.1 and higher:
http://download.mono-project.com/sources/mono/mono-3.12.1.tar.bz2

Linux and Mac downloads from www.mono-project.com have been updated to
3.12.1 - the Windows release will take another day or two.

Below is a (non-exhaustive) list of Mono versions in use in supported
distributions, and the patches they require for full coverage.

2.4 branch (Ubuntu 10.04) - SSLv2 patch, Modified Impersonation patch,
Modified FREAK patch
2.6.7 (Debian 6, SLES 11) - SSLv2 patch, Modified Impersonation patch,
Modified FREAK patch
2.10.8 (Fedora 19, 20, 21) - SSLv2 patch, Modified Impersonation
patch, Modified FREAK patch
2.10.8.1 (Debian 7, Ubuntu 12.04) - SSLv2 patch, Modified
Impersonation patch, Modified FREAK patch
3.0.3 (openSUSE 12.3) - SSLv2 patch, Modified Impersonation patch,
FREAK patch
3.0.6 (openSUSE 13.1) - SSLv2 patch, Modified Impersonation patch,
FREAK patch
3.2.8 (Debian 8, Ubuntu 12.10, 14.10, 15.04, Gentoo) - SSLv2 patch,
Modified Impersonation patch, FREAK patch
3.10.0 (Arch) - SSLv2 patch, Impersonation patch, FREAK patch

