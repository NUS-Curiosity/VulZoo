
Date: Thu, 13 Aug 2015 18:05:07 +0100
From: David Meikle <dmeikle@...che.org>
To: user@...a.apache.org,
 dev@...a.apache.org,
 security@...che.org,
 oss-security@...ts.openwall.com,
 bugtraq@...urityfocus.com
Subject: [CVE-2015-3271] Apache Tika information disclosure vulnerability

CVE-2015-3271: Apache Tika information disclosure vulnerability 

Severity: Important

Vendor:
The Apache Software Foundation

Versions Affected:
Apache Tika 1.9

Description:

Apache Tika provides optional functionality to run itself as a web service to allow remote use. When used in this manner, 
it's possible for a 3rd party to pass a 'fileUrl' header to the Apache Tika Server (tika-server). This header lets a remote
client request that the server fetches content from the URL provided, including files from the server's local filesystem.
Depending on the file permissions set on the local filesystem, this could be used to return sensitive content from 
the server machine.

Note this vulnerability only exists if you are running the tika-server version 1.9, and you allow un-trusted access to the tika-server
URL. Usage of Apache Tika as a standard library is not affected.

Mitigation:
Apache Tika 1.9 users should upgrade to Apache Tika 1.10

Example:
wget https://repo1.maven.org/maven2/org/apache/tika/tika-server/1.9/tika-server-1.9.jar <https://repo1.maven.org/maven2/org/apache/tika/tika-server/1.9/tika-server-1.9.jar> && java -jar tika-server-1.9.jar
curl -i -H "fileUrl:file:///etc/passwd" -H "Accept: text/plain" -X PUT http://localhost:9998/tika <http://localhost:9998/tika>

Credit:
This issue was discovered by Tim Allison from the Apache Tika Community.
