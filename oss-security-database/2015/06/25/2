
Date: Wed, 24 Jun 2015 22:32:53 -0300
From: "Ignacio R. Morelle" <shadowm2006@...il.com>
To: oss-security@...ts.openwall.com
Subject: CVE request: Wesnoth authentication information disclosure

Hello,

We've found and fixed a bug in our software, "The Battle for Wesnoth", which 
allowed malicious users to obtain the contents of client-side files containing 
passphrases used for content server authentication.

We would like to have a CVE id assigned to this issue if possible.


Description:

Wesnoth implements a text preprocessing language that is used in conjunction 
with its own game scripting language. It also has a built-in Lua interpreter 
and API. Both the Lua API and the preprocessor make use of the same function 
(filesystem::get_wml_location()) to resolve file paths so that only content 
from the user's data directory can be read.

However, the function did not explicitly disallow files with the .pbl 
extension. The contents of these files could thus be stored in saved game 
files or even transmitted directly to other users in a networked game. Among 
the information that's compromised is a user-defined passphrase used to 
authenticate uploads to the game's content server.

This issue was found by Toom LÃµhmus, then verified and fixed by Ignacio R. 
Morelle.


Bug report:

 * https://gna.org/bugs/?23504 - currently private to project members as it 
   includes a sufficiently elaborate exploit proof of concept.


Affected versions:

 * All existing versions up to and including 1.12.2 and 1.13.0.
 * 1.12.3 (tagged but not officially announced) contains a partial fix that
   only prevents inclusion of files with a lowercase extension.


Patches:

 * Original fix for lowercase extensions only: 
   https://github.com/wesnoth/wesnoth/commit/f8914468182e8d0a1551b430c0879ba236fe4d6d
 * More general, correct fix: 
   https://github.com/wesnoth/wesnoth/commit/b2738ffb2fdd2550ececb74f76f75583c43c8b59

-- 
Regards
  Ignacio R. Morelle, Wesnoth developer and maintainer
