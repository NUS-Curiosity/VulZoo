
Date: Fri, 28 Mar 2014 07:19:13 -0700
From: Chris Steipp <csteipp@...imedia.org>
To: oss-security@...ts.openwall.com
Subject: Re: CVE request: MediaWiki 1.22.5 login csrf

The session-id is renewed when the user successfully logs in with a
password reset. The issue that we patched was that the anti-CSRF token for
non-authenticated users on the password change form was guessable, and
would remain that way even if we regenerated the user's session-id each
time they accessed the password rest / login form.




On Fri, Mar 28, 2014 at 2:23 AM, Florent Daigniere <
florent.daigniere@...stmatta.com> wrote:

> On Thu, 2014-03-27 at 18:37 -0700, Chris Steipp wrote:
> > Hi, we just patched a login CSRF in MediaWiki today. An attacker could
> > login a victim as the attacker. Can we get a cve assigned for this?
> >
> > Patch:
> >
> https://gerrit.wikimedia.org/r/#/c/121517/1/includes/specials/SpecialChangePassword.php
> >
> > Release announcement:
> >
> http://lists.wikimedia.org/pipermail/mediawiki-announce/2014-March/000145.html
> >
> > Wikimedia bug:
> > https://bugzilla.wikimedia.org/show_bug.cgi?id=62497
>
>
> That looks like a session-fixation bug to me; not a CSRF... and
> therefore it's the wrong control: the session-id should be "renewed",
> that's all.
>
> Florent
>

