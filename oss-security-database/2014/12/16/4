
Date: Tue, 16 Dec 2014 17:31:03 +0100
From: Martin Prpic <mprpic@...hat.com>
To: oss-security@...ts.openwall.com
Subject: CVE request: insufficient 'X-Forwarded-For' header validation in rabbitmq-server

Hi, the following issue was fixed in RabbitMQ. I don't see a CVE for to
this anywhere; can one please be assigned?

"""
RabbitMQ 3.3.0 introduced a mechanism (the 'loopback_users'
configuration item) allowing access for some users to be restricted to
only connect via localhost. By default the "guest" user is restricted in
this way.

Unfortunately, the HTTP framework used by the management plugin trusts
the easily-forged "X-Forwarded-For" header when determining the remote
address. It is therefore possible to subvert this access control
mechanism for the HTTP API. Attackers would still need to know or guess
the username and password. 
"""

Upstream patches:

http://hg.rabbitmq.com/rabbitmq-management/rev/c3c41177a11a
http://hg.rabbitmq.com/rabbitmq-management/rev/35e916df027d

References:

https://groups.google.com/forum/#!topic/rabbitmq-users/DMkypbSvIyM
http://www.rabbitmq.com/release-notes/README-3.4.0.txt
https://bugzilla.redhat.com/show_bug.cgi?id=1174872

Thank you!

-- 
Martin Prpiƒç / Red Hat Product Security
