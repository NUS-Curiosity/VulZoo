
Date: Mon,  7 Jul 2014 14:13:58 -0400 (EDT)
From: larry0@...com (Larry W. Cashdollar)
To: <oss-security@...ts.openwall.com>
Subject: Vulnerability Report for Ruby Gem backup_checksum-3.0.23

Title: Vulnerability Report for Ruby Gem backup_checksum-3.0.23

Author: Larry W. Cashdollar, @_larry0

Date: 06/01/2014

OSVDB: 108569

CVE:Please Assign

Download: http://rubygems.org/gems/backup_checksum

Gem Author:  lukasz.kaniowski@...il.com

From: ./backup_checksum-3.0.23/lib/backup/cli/utility.rb

Lines 178 exposes the password to the process table, their is also remote command injection points if this gem is used in the context of a rails application as the user input isn't properly sanitized for #{password}.

0175-          base64   = options[:base64] ? -base64 : 
176-          password = options[:password_file] ? "-pass file:#{options[:password_file]}" : 
177-          salt     = options[:salt] ? -salt : 
178:          %x[openssl aes-256-cbc -d #{base64} #{password} #{salt} -in #{options[:in]} -out #{options[:out]}]
179-        when gpg
180:          %x[gpg -o #{options[:out]} -d #{options[:in]}]
181-        else
182-          puts "Unknown encryptor: #{options[:encryptor]}"
183-          puts "Use either openssl or gpg."
--
220-          puts "Please wait..\n\n"
222-        end
223-      end
224-


Advisory: http://www.vapid.dhs.org/advisories/backup_checksum-3.0.23.html

