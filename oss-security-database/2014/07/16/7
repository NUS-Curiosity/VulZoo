
Date: Wed, 16 Jul 2014 11:33:03 +0200
From: Vasyl Kaigorodov <vkaigoro@...hat.com>
To: oss-security@...ts.openwall.com
Cc: 754899@...s.debian.org
Subject: CVE request: rawstudio: Insecure use of temporary file

Hello,

The following was reported:
...
The function "rs_filter_graph" located in file
./librawstudio/rs-filter.c contains the following code:

         g_string_append_printf(str, "}\n");
         g_file_set_contents("/tmp/rs-filter-graph", str->str, str->len, NULL);

         ignore = system("dot -Tpng >/tmp/rs-filter-graph.png </tmp/rs-filter-graph");
         ignore = system("gnome-open /tmp/rs-filter-graph.png");

This code makes insecure use of two temporary files:

    /tmp/rs-filter-graph.png
    /tmp/rs-filter-graph

This allows the truncation of arbitrary files which are owned by
the user running rawstudio - for example:

    ln -s ~/.important /tmp/rs-filter-graph
    ln -s /etc/shadow /tmp/rs-filter-graph.png

Can CVE be assigned to this?

References:
http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=754899
https://bugzilla.redhat.com/show_bug.cgi?id=1120093

Thanks.
-- 
Vasyl Kaigorodov | Red Hat Product Security Team
PGP:  0xABB6E828 A7E0 87FF 5AB5 48EB 47D0 2868 217B F9FC ABB6 E828

Content of type "application/pgp-signature" skipped
